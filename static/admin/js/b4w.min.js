/**
 * Blend4Web CE 16.09.2
 * Copyright (C) 2014-2016 Triumph LLC
 * 
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 * 
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 * 
 * You should have received a copy of the GNU General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */
var b4w="object"===typeof b4w?b4w:function(a){var q={};a.module=q;var e={};a.cleanup=function(a,b){var n=q[a];n&&(n.ml=null);e[b||"__b4w_default"]=null};a.register=function(a,b){q[a]||(q[a]=b)};a.require=function(a,b){if(!q[a])throw Error('Module "'+a+'" not found');b=b||"__b4w_default";e[b]||(e[b]=function(a){return function(b){var c=q[b];if(!c)throw Error('Module "'+b+'" not found');c.ml||(c.ml={});c.ml[a]||(c.ml[a]={},c(c.ml[a],e[a]));return c.ml[a]}}(b));return e[b](a)};a.module_check=function(a){return q[a]?
!0:!1};a.get_namespace=function(a){for(var b in e)if(e[b]==a)return b;return""};a.worker_listeners=[];a.worker_namespaces=[];return a}({});"object"==typeof module&&module.Au&&(GLOBAL.b4w={module:{}});
b4w.module.__version=function(a){function q(){var a=e,c=a.getDate(),c=10>c?"0"+String(c):String(c),f=a.getMonth()+1,f=10>f?"0"+String(f):String(f),t=String(a.getFullYear()),g=a.getHours(),g=10>g?"0"+String(g):String(g),m=a.getMinutes(),m=10>m?"0"+String(m):String(m),a=a.getSeconds(),a=10>a?"0"+String(a):String(a);return c+"."+f+"."+t+" "+g+":"+m+":"+a}var e=new Date(2016,9,3,14,23,57),c=[16,9,2];a.version=function(){return c};a.version_str=function(){for(var a="",e=0;e<c.length;e++)a=1==e?a+(10>c[e]?
"0"+c[e]:c[e]):a+c[e],e!=c.length-1&&(a+=".");return a};a.type=function(){return"RELEASE"};a.date=function(){return e};a.date_str=q;a.timestamp=function(){var a=q(),a=a.split(" ").join("").split(":").join("").split(".").join("");return"?t="+a}};"object"==typeof module&&module.Au&&b4w.module.__version(exports);b4w.module.__config=function(a,q){function e(){return b4w.module_check(a.Md.hq)}function c(){for(var c=a.Md,e=null,g=document.getElementsByTagName("script"),m=0;m<g.length;m++){for(var v=g[m].src,x=0;x<c.AA.length;x++)if(0<=v.indexOf(c.AA[x])){e=v;break}if(null!==e)break}e||(b.warn("Couldn't determine path to ancillary resources, fallback to the current page directory"),e=document.location.href);c=e.indexOf("?");0<=c&&(e=e.substring(0,c));return e.substring(0,e.lastIndexOf("/")+1)}var b=q("__print"),
n=q("__util");a.P_LOW=1;a.P_HIGH=2;a.P_ULTRA=3;a.P_CUSTOM=4;a.P_AUTO=5;a.context={alpha:!0,antialias:!1,premultipliedAlpha:!0};a.Xy=n.L(a.context);a.v={alpha_sort:!0,alpha_sort_threshold:.1,yk:[6,0],max_fps:1E4,console_verbose:!1,do_not_load_resources:!1,use_min50:!1,Ez:1,nJ:5,background_color:[0,0,0,0],canvas_resolution_factor:1,Im:3,allow_cors:!1,Du:!1,anisotropic_filtering:!0,show_hud_debug_info:!1,AQ:!0,shadows:!0,stereo:"NONE",reflections:!0,refractions:!0,ssao:!0,dof:!0,god_rays:!0,bloom:!0,
motion_blur:!0,ul:!0,antialiasing:!0,smaa:!1,debug_view:!1,rD:!1,Il:!0,Ur:!0,jc:!0,water_dynamic:!0,shore_smoothing:!0,qm:!0,cD:!0,precision:"highp",quality:a.P_HIGH,Wp:!0,FL:!1,rw:!1,tu:!1,kD:!1,is_mobile_device:!1,Yu:!1,Tt:!1,TR:!1,dp:!1,allow_hidpi:!1,cC:!1,vv:!1,enable_selectable:!0,enable_outlining:!0,th:!0,gr:!1,yz:!1,lv:[0,0],$n:!1,AB:!0,vs:!1,url_params:null,Vb:!0,lc:4,MB:!1,NB:!1,gw:!1,Ly:!1,nA:!1,media_auto_activation:!0,TA:4,Cr:!1,gl_debug:!1,Fy:!1,Wx:!1,zt:!1,Pj:"dds",QR:"16x"};a.kz=n.L(a.v);
a.xj={Mq:-1,Gz:!1,bk:1};a.controls={BL:1/120};a.Gd={dir:"ASSETS=../../assets/",vL:15,prevent_caching:!0,uv:!1,pu:!1,es:!1};a.ay=n.L(a.Gd);a.Md={shaders_dir:"",$B:"include/",PR:"postprocessing/",hq:"built_in_data",AA:"b4w.min.js b4w.full.min.js b4w.simple.min.js b4w.whitespace.min.js src/b4w.js USER_DEFINED_MODULE".split(" "),IB:"./",smaa_search_texture_path:"",smaa_area_texture_path:""};a.vK={webvr:{distortion_coefs:[.22,.28],chromatic_aberration_coefs:[-.015,.02,.025,.02]},nonwebvr:{uh:.064,ei:.035,
Yi:.039,distortion_coefs:[.34,.55],chromatic_aberration_coefs:[0,0,0,0],cl:.11,xi:.062,gi:.004}};a.B={enabled:!0,max_fps:60,tp:"",Lt:!1,ping:!1,Ap:!0};a.pB=n.L(a.B);a.Kk={Vq:1024,xl:384,cz:32,zI:128,yI:256,rB:.25,XL:.5,WL:1};a.QB=n.L(a.Kk);a.M={ox:!0,Ir:!1,ey:!1,My:!1,oz:!1};a.YB=n.L(a.M);a.ec={outlining_overview_mode:!1,Eh:[1,.4,.05],Ni:.2,Oi:3.8,Pi:1};a.xq={enabled:!1,UN:0,TN:0,tN:"COLOR"};a.gz=n.L(a.xq);a.jh={tL:8,Fo:64,rv:8,Er:8,sv:15,UA:0,Go:128,Fi:1024,ov:4096,dc:4096,tv:[4096,4096]};a.Wy=n.L(a.jh);
a.apply_quality=function(){var b=a.v,c=a.B,e=a.Kk;switch(b.quality){case a.P_ULTRA:b.shadows=!0;b.shore_smoothing=!0;b.ssao=!0;b.dof=!0;b.god_rays=!0;b.bloom=!0;b.reflections=!0;b.refractions=!0;b.Il=!0;b.Ur=!0;b.jc=!0;e.Vq=2048;b.Im=3;b.anisotropic_filtering=!0;b.use_min50=!1;b.precision="highp";b.water_dynamic=!0;b.qm=!0;b.antialiasing=!0;b.smaa=!1;b.ul=!0;b.motion_blur=!0;b.allow_hidpi=!0;b.enable_outlining=!0;b.th=!0;b.lc=16;c.max_fps=120;break;case a.P_HIGH:b.shadows=!0;b.shore_smoothing=!0;
b.ssao=!0;b.dof=!0;b.god_rays=!0;b.bloom=!0;b.reflections=!0;b.refractions=!0;b.Il=!0;b.Ur=!0;b.jc=!0;e.Vq=1024;b.Im=3;b.anisotropic_filtering=!0;b.use_min50=!1;b.precision="highp";b.water_dynamic=!0;b.qm=!0;b.antialiasing=!0;b.smaa=!1;b.ul=!0;b.motion_blur=!0;b.allow_hidpi=!1;b.enable_outlining=!0;b.th=!0;b.lc=4;c.max_fps=60;break;case a.P_LOW:b.shadows=!1;b.shore_smoothing=!1;b.ssao=!1;b.dof=!1;b.god_rays=!1;b.bloom=!1;b.reflections=!1;b.refractions=!1;b.Il=!1;b.Ur=!1;b.jc=!1;e.Vq=512;b.Im=2;b.anisotropic_filtering=
!1;b.use_min50=!0;b.precision="mediump";b.water_dynamic=!1;b.qm=!1;b.antialiasing=!1;b.smaa=!1;b.ul=!1;b.motion_blur=!1;b.allow_hidpi=!1;b.enable_outlining=!1;b.th=!1;b.lc=1;c.max_fps=60;break;case a.P_AUTO:n.r("Direct AUTO quality profile setting is forbidden")}};a.set=function(c,e){switch(c){case "allow_cors":a.v.allow_cors=e;break;case "allow_hidpi":a.v.allow_hidpi=e;break;case "alpha":a.context.alpha=e;break;case "alpha_sort":a.v.alpha_sort=e;break;case "alpha_sort_threshold":a.v.alpha_sort_threshold=
e;break;case "anaglyph_use":b.YI();a.v.stereo=e?"ANAGLYPH":a.v.stereo;break;case "animation_framerate":a.xj.Mq=e;break;case "anisotropic_filtering":a.v.anisotropic_filtering=e;break;case "antialiasing":a.v.antialiasing=e;break;case "assets_dds_available":a.Gd.pu=e;break;case "assets_pvr_available":a.Gd.es=e;break;case "assets_min50_available":a.Gd.uv=e;break;case "audio":a.M.ox=e;break;case "background_color":a.v.background_color=e;break;case "bloom":a.v.bloom=e;break;case "built_in_module_name":a.Md.hq=
e;break;case "canvas_resolution_factor":a.v.canvas_resolution_factor=e;break;case "console_verbose":a.v.console_verbose=e;break;case "dof":a.v.dof=e;break;case "do_not_load_resources":a.v.do_not_load_resources=e;break;case "god_rays":a.v.god_rays=e;break;case "stereo":a.v.stereo=e;break;case "max_fps":a.v.max_fps=e;break;case "max_fps_physics":a.B.max_fps=e;break;case "media_auto_activation":a.v.media_auto_activation=e;break;case "motion_blur":a.v.motion_blur=e;break;case "physics_enabled":a.B.enabled=
e;break;case "physics_uranium_path":a.B.tp=e;break;case "physics_calc_fps":a.B.Lt=e;break;case "physics_use_workers":a.B.Ap=e;break;case "precision":a.v.precision=e;break;case "prevent_caching":a.Gd.prevent_caching=e;break;case "quality":a.v.quality=e;break;case "reflections":a.v.reflections=e;break;case "refractions":a.v.refractions=e;break;case "sfx_mix_mode":a.M.Ir=e;break;case "shaders_dir":a.Md.shaders_dir=e;break;case "shadows":a.v.shadows=e;break;case "show_hud_debug_info":a.v.show_hud_debug_info=
e;break;case "smaa":a.v.smaa=e;break;case "smaa_search_texture_path":a.Md.smaa_search_texture_path=e;break;case "smaa_area_texture_path":a.Md.smaa_area_texture_path=e;break;case "ssao":a.v.ssao=e;break;case "debug_view":a.v.debug_view=e;break;case "enable_selectable":a.v.enable_selectable=e;break;case "enable_outlining":a.v.enable_outlining=e;break;case "outlining_overview_mode":a.ec.outlining_overview_mode=e;break;case "glow_materials":a.v.th=e;break;case "url_params":a.v.url_params=e;break;case "use_min50":a.v.use_min50=
e;break;case "gl_debug":a.v.gl_debug=e;break;default:b.error("Unknown config property: "+c)}};a.get=function(c){switch(c){case "allow_cors":return a.v.allow_cors;case "allow_hidpi":return a.v.allow_hidpi;case "alpha":return a.context.alpha;case "alpha_sort":return a.v.alpha_sort;case "alpha_sort_threshold":return a.v.alpha_sort_threshold;case "anaglyph_use":return"ANAGLYPH"==a.v.stereo;case "animation_framerate":return a.xj.Mq;case "anisotropic_filtering":return a.v.anisotropic_filtering;case "antialiasing":return a.v.antialiasing;
case "assets_dds_available":return a.Gd.pu;case "assets_pvr_available":return a.Gd.es;case "assets_min50_available":return a.Gd.uv;case "audio":return a.M.ox;case "background_color":return a.v.background_color;case "bloom":return a.v.bloom;case "built_in_module_name":return a.Md.hq;case "canvas_resolution_factor":return a.v.canvas_resolution_factor;case "console_verbose":return a.v.console_verbose;case "dof":return a.v.dof;case "do_not_load_resources":return a.v.do_not_load_resources;case "is_mobile_device":return a.v.is_mobile_device;
case "god_rays":return a.v.god_rays;case "stereo":return a.v.stereo;case "max_fps":return a.v.max_fps;case "max_fps_physics":return a.B.max_fps;case "media_auto_activation":return a.v.media_auto_activation;case "motion_blur":return a.v.motion_blur;case "physics_enabled":return a.B.enabled;case "physics_uranium_path":return a.B.tp;case "physics_calc_fps":return a.B.Lt;case "physics_use_workers":return a.B.Ap;case "precision":return a.v.precision;case "prevent_caching":return a.Gd.prevent_caching;case "quality":return a.v.quality;
case "reflections":return a.v.reflections;case "refractions":return a.v.refractions;case "sfx_mix_mode":return a.M.Ir;case "shaders_dir":return a.Md.shaders_dir;case "shadows":return a.v.shadows;case "show_hud_debug_info":return a.v.show_hud_debug_info;case "smaa":return a.v.smaa;case "smaa_search_texture_path":return a.Md.smaa_search_texture_path;case "smaa_area_texture_path":return a.Md.smaa_area_texture_path;case "ssao":return a.v.ssao;case "debug_view":return a.v.debug_view;case "enable_selectable":return a.v.enable_selectable;
case "enable_outlining":return a.v.enable_outlining;case "outlining_overview_mode":return a.ec.outlining_overview_mode;case "glow_materials":return a.v.th;case "url_params":return a.v.url_params;case "use_min50":return a.v.use_min50;case "gl_debug":return a.v.gl_debug;default:b.error("Unknown config property: "+c)}};a.reset=function(){for(var b in a.Xy)a.context[b]=a.Xy[b];for(b in a.kz)a.v[b]=a.kz[b];for(b in a.ay)a.Gd[b]=a.ay[b];for(b in a.pB)a.B[b]=a.pB[b];for(b in a.QB)a.Kk[b]=a.QB[b];for(b in a.YB)a.M[b]=
a.YB[b];for(b in a.gz)a.xq[b]=a.gz[b]};a.reset_limits=function(){for(var b in a.Wy)a.jh[b]=a.Wy[b]};a.rA=e;a.aN=function(){var b=a.Md,n=a.B;e()||""!=b.shaders_dir||(b.shaders_dir=c()+"../shaders/");if(e())b.smaa_search_texture_path="smaa_search_texture.png",b.smaa_area_texture_path="smaa_area_texture.png";else if(""==b.smaa_search_texture_path||""==b.smaa_area_texture_path){var g=c()+b.IB;b.smaa_search_texture_path=b.smaa_search_texture_path||g+"smaa_search_texture.png";b.smaa_area_texture_path=b.smaa_area_texture_path||
g+"smaa_area_texture.png"}n.enabled&&""==n.tp&&(g=c()+b.IB,n.tp=g+"uranium.js")};a.get_std_assets_path=function(){return a.Gd.dir.replace("ASSETS=","")}};b4w.module.__anchors=function(a,q){function e(){z=!0;C.get_container().addEventListener("mouseup",function(){function a(){return"visible"==h.style.visibility&&!r&&!e}if(!l&&!P){var b=p;if(b)if("visible"==b.lastElementChild.style.visibility)c(),p=null;else if(1==b.style.opacity){var h=b.lastElementChild,d=h.firstElementChild,k=d.innerHTML;h.style.visibility="visible";var u=Math.min(parseInt(h.style.width)||200,t(k)-24),z=g(k,u),r=!1,e=!1,k=b.offsetWidth-24,b=b.offsetHeight-16;z==b&&(h.style.height=
z+"px");u!=k?(l=r=!0,H.animate(k,u,200,function(b){b==u&&(r=!1,e||(l=!1),a&&(d.style.visibility="visible"));h.style.width=b+"px"})):r=!1;z!=b?(l=e=!0,H.animate(b,z,200,function(b){b==z&&(e=!1,r||(l=!1),a&&(d.style.visibility="visible"));h.style.height=b+"px"})):e=!1}}})}function c(){var a=p.lastElementChild;a.style.visibility="hidden";a.firstElementChild.style.visibility="hidden"}function b(a){a.style.cssText+="color:       #fff;font-family: Arial;font-size:   12px;font-weight: bold;line-height: 15px;"}
function n(a){a.style.cssText+="background-color:   #000;border-radius:      20px 20px 20px 0px;bottom:             0;box-shadow:         0px 0px 10px rgb(180, 180, 200);-webkit-box-shadow: 0px 0px 10px rgb(180, 180, 200);font-size:          12px;left:               0;line-height:        15px;opacity:            1.0;overflow:           hidden;padding:            8px 12px;position:           absolute;z-index:            2;"}function f(a,h,d){var k=document.createElement("div"),u=document.createElement("span");
d&&(k.style.width=d+"px");n(k);b(u);u.innerHTML=a;k.style.visibility="hidden";u.style.visibility="hidden";k.appendChild(u);h.appendChild(k);h.addEventListener("mousedown",function(){l||h==p||1!=h.style.opacity||P||(p&&"visible"==p.lastElementChild.style.visibility&&c(),p=h)})}function t(a){var l=document.createElement("div"),c=document.createElement("span");c.innerHTML=a;b(c);n(l);l.appendChild(c);document.body.appendChild(l);a=l.offsetWidth+1;document.body.removeChild(l);return a}function g(a,l){var c=
document.createElement("div"),h=document.createElement("span");h.innerHTML=a;b(h);n(c);c.style.width=l+"px";c.style.display="inline-block";c.appendChild(h);document.body.appendChild(c);h=c.offsetHeight-16;document.body.removeChild(c);return h}function m(){for(var a=0,b=0;b<u.length;b++)u[b].Al&&a++;M=new Float32Array(3*a)}function v(a,b){return b.depth-a.depth}function x(a,b,l){a=a.element;h.nA&&(b=Math.floor(b),l=Math.floor(l));"transform"in a.style?a.style.transform="translate3d("+b+"px, "+l+"px, 0px)":
"webkitTransform"in a.style?a.style.webkitTransform="translate3d("+b+"px, "+l+"px, 0px)":(a.style.left=b+"px",a.style.top=l+"px")}var d=q("__batch"),k=q("__camera"),r=q("__config"),C=q("__container"),B=q("__objects"),F=q("__print"),D=q("__renderer"),y=q("__scenes"),A=q("__subscene"),H=q("__time"),w=q("__tsr"),h=r.v,u=[],P=!1,p=null,z=!1,l=!1,M=new Float32Array(0),E=new Uint8Array(16),W=new Float32Array(2),G=new Float32Array(3);a.append=function(a){var l;a:{for(l=0;l<u.length;l++)if(u[l].obj==a){l=
!0;break a}l=!1}if(!l){l=a.anchor.Al&&Boolean(y.Da(y.jk(),A.fl));l={type:a.anchor.type,obj:a,x:0,y:0,depth:0,yj:"out",Al:l,element:null,em:null,DF:a.anchor.wL,Xp:0,Bt:0,Dq:a.anchor.Dq};switch(l.type){case "ANNOTATION":var c=l.DF,h=document.createElement("div"),d=document.createElement("span"),k="",p=a.name,r=C.get_container();a=B.get_meta_tags(a);h.style.cssText+="background-color:   #000;border-radius:      20px 20px 20px 0px;box-shadow:         0px 0px 10px rgb(180, 180, 200);-webkit-box-shadow: 0px 0px 10px rgb(180, 180, 200);font-size:          12px;line-height:        15px;opacity:            1.0;padding:            8px 12px;position:           absolute;transform-style:    preserve-3d;";
h.style.visibility="hidden";r.appendChild(h);a&&(k=a.description||k,p=a.title||p);d.innerHTML=p;d.style.cssText+="-webkit-touch-callout: none;-webkit-user-select:   none;-khtml-user-select:    none;-moz-user-select:      none;-ms-user-select:       none;user-select:           none;cursor:                default;";b(d);h.appendChild(d);k&&f(k,h,c);l.element=h;l.Xp=l.element.offsetHeight;l.Bt=l.element.offsetWidth;break;case "ELEMENT":l.element=document.getElementById(a.anchor.Dq),l.element?(l.Xp=l.element.offsetHeight,
l.Bt=l.element.offsetWidth):(F.warn("Anchor HTML element was not found, making it generic"),l.type="GENERIC")}u.push(l);m();z||e()}};a.remove=function(a){for(var l=0;l<u.length;l++){var b=u[l];if(b.obj==a){"ANNOTATION"==b.type&&(a=b,C.get_container().removeChild(a.element));u.splice(l,1);m();break}}};a.update=function(){for(var a=0,l=u.length;l--;){var b=u[l];if(b.Al){var c=w.get_trans_view(b.obj.k.n);M.set(c,3*a++)}var h;h=b;var c=G,z=y.hk(y.jk());h=w.get_trans_view(h.obj.k.n);h=c=k.project_point(z,
h,c);c=h[0];z=h[1];h=h[2];if(c!=b.x||z!=b.y||h!=b.depth){switch(b.type){case "ANNOTATION":var r=c,e=z-b.Xp;x(b,r,e);break;case "ELEMENT":e=b.element.getBoundingClientRect(),r=c-e.width/2,e=z-e.height/2,x(b,r,e)}b.x=c;b.y=z;b.depth=h;b.em&&b.em(c,z,b.yj,b.obj,b.element)}}u.sort(v);for(l=0;l<u.length;l++)b=u[l],"GENERIC"!=b.type&&(b.element.style.zIndex=p==b.element?u.length:l);0<a&&(a=y.Da(y.jk(),A.fl),l=a.Ea[0].ka[0],d.hO(l.pa,M),A.rc(a,l))};a.bD=function(){for(var a=C.get_container(),b=u.length;b--;){var l=
u[b],c=l.obj,h=l.x,d=l.y,k=l.depth,k=0>h||0>d||0>k||1<k||y.is_hidden(c)||h>=a.clientWidth||d>=a.clientHeight?"out":"visible";if(l.Al&&"out"!=k){var k=l,z=y.Da(y.jk(),A.fl).p,p=C.jq(k.x,k.y,W,z);D.aw(z.he,p[0],z.height-p[1],2,2,E);k=1020==E[0]+E[4]+E[8]+E[12]?"visible":"out"==k.yj||0==E[0]+E[4]+E[8]+E[12]?"covered":k.yj}if(k!=l.yj){switch(l.type){case "ANNOTATION":case "ELEMENT":var r=l.element;if(!r)break;"out"==k?(r.style.visibility="hidden",r.children.length&&(r.children[0].style.visibility="hidden")):
"visible"==k?(r.style.visibility="visible",r.children.length&&(r.children[0].style.visibility="visible"),r.style.opacity=1):(r.style.visibility="visible",r.style.opacity=.1,r.children.length&&(r.children[0].style.visibility="visible"),"ANNOTATION"==l.type&&1<r.children.length&&(z=r.children[1],z.style.visibility="hidden",z.children.length&&(z.children[0].style.visibility="hidden")))}l.yj=k;l.em&&l.em(h,d,l.yj,c,r)}}};a.attach_move_cb=function(a,l){for(var b=0;b<u.length;b++)u[b].obj==a&&(u[b].em=
l)};a.detach_move_cb=function(a){for(var l=0;l<u.length;l++)u[l].obj==a&&(u[l].em=null)};a.cleanup=function(){for(var a=0;a<u.length;a++){var l=u[a];"ANNOTATION"==l.type&&C.get_container().removeChild(l.element)}u.length=0};a.is_anchor=function(a){for(var l=0;l<u.length;l++)if(u[l].obj==a)return!0;return!1};a.get_element_id=function(a){for(var l=0;l<u.length;l++)if(u[l].obj==a)return u[l].Dq;return!1};a.pause=function(){P=!0};a.resume=function(){P=!1};a.QL=function(a,l){for(var b=-1,c=0;c<u.length;c++){var h;
if(h="visible"==u[c].yj){var d=u[c];h=Math.round(d.Bt);var k=Math.round(d.Xp),z=d.x,d=d.y;h=a>=z&&a<=z+h&&l<d&&l>=d-k?!0:!1}if(h)if(0>b)var r=u[c].depth,b=c;else u[c].depth<r&&(b=c,r=u[c].depth)}return 0>b?null:u[b].obj}};b4w.module.__armature=function(a,q){function e(a){a=a.k;for(var b=a.tm,c=a.Fr,d=0;d<b.length;d++){for(var k=b[d],e=c[d],f=0;f<e.length;f+=2)for(var m=e[f],w=e[f+1],h=0;4>h;h++)k.zd[m+h]=a.zd[w+h],k.Od[m+h]=a.Od[w+h],k.Cd[m+h]=a.Cd[w+h],k.Pd[m+h]=a.Pd[w+h];k.ge=a.ge}}function c(a,b,d,k){var e=a.ax,f=a.hj,g=a.qp,x=a.Ov;x?(x=x.qp,b?n.multiply(x,e,g):(b=v,n.invert(x,b),n.multiply(b,g,e))):b?n.copy(e,g):n.copy(g,e);e=m;n.invert(f,e);n.multiply(g,e,e);f=a.hi;d[4*f]=e[0];d[4*f+1]=e[1];d[4*f+2]=e[2];d[4*
f+3]=e[3];k[4*f]=e[4];k[4*f+1]=e[5];k[4*f+2]=e[6];k[4*f+3]=e[7];a=a.mz;for(f=0;f<a.length;f++)g=a[f],g.Kb||c(g,!0,d,k)}var b=q("__util"),n=q("__tsr"),f=q("__quat"),t=q("__mat4"),g=q("__vec3"),m=n.create(),v=n.create(),x=new Float32Array(4),d=new Float32Array(4),k=new Float32Array(4);a.kj=function(a,c){for(var d=a.data.bones,k=a.pose.bones,e={},f=0;f<k.length;f++){var v=k[f],x=v.bone,w=x.name,h=e[w]={hi:0,lD:-1,Ov:null,mz:[],kq:[],Kb:null,pp:n.create(),ax:n.create(),hj:n.create(),qp:n.create(),Is:n.create(),
bx:n.create(),Js:!1,DC:new Float32Array(3)},w=new Float32Array(x.matrix_local),u=new Float32Array(16);t.invert(w,u);var v=new Float32Array(v.matrix_basis),P=h.DC;g.subtract(b.f32(x.tail_local),b.f32(x.head_local),P);b.cP(P,u,P);n.from_mat4(w,h.hj);n.from_mat4(v,h.Is);n.copy(h.hj,h.qp)}for(f=0;f<d.length;f++){w=d[f].name;v=b.keysearch("name",w,k);h=e[w];x=v.parent_recursive;h.kq.push(h);for(u=0;u<x.length;u++)v=x[u],v=v.name,v=e[v],h.kq.push(v);x.length?(v=x[0],v=v.name,v=e[v],h.Ov=v,n.invert(v.hj,
m),n.multiply(m,h.hj,h.pp),v.mz.push(h)):n.copy(h.hj,h.pp);h.hi=f;h.name=w;n.multiply(h.pp,h.Is,h.ax)}c.k.Zd=e};a.get_bone_tsr=function(a,b,c,e,g){var y=a.k,A=y.ge;b=y.Zd[b];var t=b.hi;a=b.hj;var w=y.Cd,h=y.Pd,u=y.zd,y=y.Od,P=w[4*t+1],p=w[4*t+2],z=w[4*t+3],l=h[4*t+1],M=h[4*t+2],E=h[4*t+3];x[0]=(1-A)*w[4*t]+A*h[4*t];x[1]=(1-A)*P+A*l;x[2]=(1-A)*p+A*M;x[3]=(1-A)*z+A*E;d[0]=u[4*t];d[1]=u[4*t+1];d[2]=u[4*t+2];d[3]=u[4*t+3];k[0]=y[4*t];k[1]=y[4*t+1];k[2]=y[4*t+2];k[3]=y[4*t+3];f.slerp(d,k,A,d);A=m;n.set_transcale(x,
A);n.set_quat(d,A);c?(c=v,n.translate(a,b.DC,c),n.multiply(A,c,A)):n.multiply(A,a,A);if(e){if(e=b.Ov)c=v,n.invert(e.qp,c),n.multiply(c,A,A);e=v;n.invert(b.pp,e);n.multiply(e,A,A)}n.copy(A,g)};a.set_bone_tsr=function(a,b,d,k){var f=a.k;b=f.Zd[b];var m=f.Cd,g=f.zd;k?n.multiply(b.pp,d,b.ax):n.copy(d,b.qp);c(b,k,m,g);f.ge=0;e(a)};a.HO=e;a.oO=c;a.An=function(a,b){return b in a.k.Zd}};b4w.module.__boundings=function(a,q){function e(){return{max_x:0,min_x:0,max_y:0,min_y:0,max_z:0,min_z:0}}function c(a,b){b.min_x=a.min_x;b.max_x=a.max_x;b.min_y=a.min_y;b.max_y=a.max_y;b.min_z=a.min_z;b.max_z=a.max_z;return b}function b(a,b){for(var c=a[0],h=a[1],d=a[2],k=a[0],u=a[1],e=a[2],p=3;p<a.length;p+=3)var f=a[p],r=a[p+1],m=a[p+2],c=Math.max(c,f),h=Math.max(h,r),d=Math.max(d,m),k=Math.min(k,f),u=Math.min(u,r),e=Math.min(e,m);b.max_x=c;b.max_y=h;b.max_z=d;b.min_x=k;b.min_y=u;b.min_z=e;return b}
function n(a,b){b||(b=new Float32Array(24));var c=a.max_x,h=a.max_y,d=a.max_z,k=a.min_x,u=a.min_y,p=a.min_z;b[0]=k;b[1]=u;b[2]=p;b[3]=c;b[4]=u;b[5]=p;b[6]=c;b[7]=h;b[8]=p;b[9]=k;b[10]=h;b[11]=p;b[12]=k;b[13]=u;b[14]=d;b[15]=c;b[16]=u;b[17]=d;b[18]=c;b[19]=h;b[20]=d;b[21]=k;b[22]=h;b[23]=d;return b}function f(){return{I:new Float32Array(3),Ka:0}}function t(a,b){b.I[0]=a.I[0];b.I[1]=a.I[1];b.I[2]=a.I[2];b.Ka=a.Ka}function g(){return{jd:new Float32Array(3),kd:new Float32Array(3),ld:new Float32Array(3),
I:new Float32Array(3)}}function m(a,b){B.copy(a.jd,b.jd);B.copy(a.kd,b.kd);B.copy(a.ld,b.ld);B.copy(a.I,b.I);return b}function v(a){var b=g();m(a,b);return b}function x(a,b,c,h){return{jd:new Float32Array(a),kd:new Float32Array(b),ld:new Float32Array(c),I:new Float32Array([h[0],h[1],h[2]])}}function d(a,b){var c=F.HG(a,h),c=b?F.DG(a,c,P):D.identity(P),c=F.hJ(c,u);B.copy(a,A);B.transformMat3(A,c,A);for(var d=A[0],k=d,e=A[1],f=e,r=A[2],m=r,O=0,g=0,v=0,R=0,ca=0,n=0,y=3;y<a.length;y+=3)A[0]=a[y],A[1]=
a[y+1],A[2]=a[y+2],B.transformMat3(A,c,A),O=A[0],g=A[1],v=A[2],O>d&&(d=O),O<k&&(k=O),g>e&&(e=g),g<f&&(f=g),v>r&&(r=v),v<m&&(m=v);e-=f;r-=m;d=Math.max(d-k,1E-9);e=Math.max(e,1E-9);r=Math.max(r,1E-9);k=D.identity(P);k[0]=0!=d?1/d:1E8;k[4]=0!=e?1/e:1E8;k[8]=0!=r?1/r:1E8;D.transpose(c,p);A[0]=a[0];A[1]=a[1];A[2]=a[2];B.transformMat3(A,c,A);B.transformMat3(A,k,A);B.transformMat3(A,p,A);O=A[0];g=A[0];v=A[1];R=A[1];ca=A[2];n=A[2];for(y=3;y<a.length;y+=3)A[0]=a[y],A[1]=a[y+1],A[2]=a[y+2],B.transformMat3(A,
c,A),B.transformMat3(A,k,A),B.transformMat3(A,p,A),O=Math.max(O,A[0]),g=Math.min(g,A[0]),v=Math.max(v,A[1]),R=Math.min(R,A[1]),ca=Math.max(ca,A[2]),n=Math.min(n,A[2]);y=Math.sqrt((O-g)*(O-g)+(v-R)*(v-R)+(ca-n)*(ca-n))/2;y=Math.min(y,1);w[0]=(O+g)/2;w[1]=(v+R)/2;w[2]=(ca+n)/2;O=w;k=D.identity(P);k[0]=d;k[4]=e;k[8]=r;B.transformMat3(O,c,O);B.transformMat3(O,k,O);B.transformMat3(O,p,O);k=[c[0],c[3],c[6]];g=[c[1],c[4],c[7]];c=[c[2],c[5],c[8]];B.scale(k,d*y,k);B.scale(g,e*y,g);B.scale(c,r*y,c);return x(k,
g,c,O)}function k(a,b,c){B.add(b,c,a.I);B.scale(a.I,.5,a.I);a.Ka=B.distance(a.I,b);return a}var r=q("__tsr"),C=q("__util"),B=q("__vec3"),F=q("__math"),D=q("__mat3"),y=new Float32Array(24),A=new Float32Array(3),H=new Float32Array(3),w=new Float32Array(3),h=new Float32Array(3),u=new Float32Array(9),P=new Float32Array(9),p=new Float32Array(9);new Float32Array(9);a.Mc=e;a.ni=c;a.gQ=function(){return{max_x:1E12,min_x:-1E12,max_y:1E12,min_y:-1E12,max_z:1E12,min_z:-1E12}};a.tP=function(a){a.max_x=0;a.min_x=
0;a.max_y=0;a.min_y=0;a.max_z=0;a.min_z=0};a.tl=function(a){var b=e();c(a,b);return b};a.EG=function(a){var b=a.max_x-a.min_x,c=a.max_y-a.min_y;c<b&&(b=c);a=a.max_z-a.min_z;a<b&&(b=a);return b};a.Gq=function(a,b){var c=a.max_y,h=a.max_z,d=a.min_x,k=a.min_y,u=a.min_z;a.max_x=Math.max(b.max_x,a.max_x);a.max_y=Math.max(b.max_y,c);a.max_z=Math.max(b.max_z,h);a.min_x=Math.min(b.min_x,d);a.min_y=Math.min(b.min_y,k);a.min_z=Math.min(b.min_z,u)};a.pG=b;a.ji=function(a,l,c){c||(c=e());a=n(a,y);r.transform_vectors(a,
l,a);return b(a,c)};a.co=n;a.RR=function(a,b,c){c||(c=e());var h=b.min_x,d=b.max_x,k=b.min_y,u=b.max_y,p=b.min_z;b=b.max_z;if(h>=a.max_x||d<=a.min_x||k>=a.max_y||u<=a.min_y||p>=a.max_z||b<=a.min_z)return c.min_x=-.1,c.max_x=.1,c.min_y=-.1,c.max_y=.1,c.min_z=-.2,c.max_z=-.1,c;c.min_x=Math.max(a.min_x,h);c.max_x=Math.min(a.max_x,d);c.min_y=Math.max(a.min_y,k);c.max_y=Math.min(a.max_y,u);c.min_z=Math.max(a.min_z,p);c.max_z=Math.min(a.max_z,b);return c};a.XR=function(a,b,c){c||(c=e());var h=a.max_x-a.min_x,
d=a.max_y-a.min_y,k=a.max_z-a.min_z;c.min_x=a.min_x-.5*(b-1)*h;c.max_x=a.max_x+.5*(b-1)*h;c.min_y=a.min_y-.5*(b-1)*d;c.max_y=a.max_y+.5*(b-1)*d;c.min_z=a.min_z-.5*(b-1)*k;c.max_z=a.max_z+.5*(b-1)*k;return c};a.sl=function(a,b,c){c||(c=f());r.transform_vec3(a.I,b,c.I);c.Ka=a.Ka*r.get_scale(b);return c};a.rl=function(a,b,c){c||(c=g());r.transform_vec3(a.I,b,c.I);B.copy(a.jd,c.jd);B.copy(a.kd,c.kd);B.copy(a.ld,c.ld);r.transform_dir_vec3(c.jd,b,c.jd);r.transform_dir_vec3(c.kd,b,c.kd);r.transform_dir_vec3(c.ld,
b,c.ld);return c};a.gq=function(a,b){var c=f();B.copy(b,c.I);c.Ka=a;return c};a.oi=f;a.oq=t;a.Ge=g;a.Yy=m;a.En=v;a.Ij=function(a){var b=f();t(a,b);return b};a.sn=x;a.rG=function(){var a;a||(a=f());B.set(0,0,0,a.I);a.Ka=1E12;return a};a.tz=function(a,b){var c=B.subtract(b.I,a.I,B.create());0==B.length(c)&&B.set(1,0,0,c);var h=B.normalize(c,B.create()),c=B.scale(h,a.Ka,B.create());B.add(c,a.I,c);var d=B.scale(h,-a.Ka,B.create());B.add(d,a.I,d);var k=B.scale(h,b.Ka,B.create());B.add(k,b.I,k);var u=B.scale(h,
-b.Ka,B.create());B.add(u,b.I,u);c=[c,d,k,u];h=B.normalize(h,B.create());d=c[0];k=c[0];for(u=1;u<c.length;u++){var e=B.dot(c[u],h);e<B.dot(d,h)&&(d=c[u]);e>B.dot(k,h)&&(k=c[u])}h=[d,k];c=h[0];h=h[1];a.I=B.scale(B.add(c,h,B.create()),.5,B.create());a.Ka=B.length(B.subtract(h,c,B.create()))/2};a.rq=d;a.vl=function(a){var b=f(),c=0,c=B.length(a.jd),h=B.length(a.kd),d=B.length(a.ld),c=c>h?c:h;b.I=a.I;b.Ka=d>c?d:c;return b};a.ty=function(a,b){var c=v(a),d=r.bc(b,h);B.subtract(c.I,d,c.I);return c};a.lr=
function(a,b){var c=B.length(a.jd),h=B.length(a.kd),d=B.length(a.ld);return.75*b.Ka*b.Ka*b.Ka>c*h*d};a.hy=function(a,b){var c=b.max_z,h=b.min_z,d=Math.max(0,c-h-2*a);return{Ka:a,height:d,I:new Float32Array([0,0,(c+h)/2])}};a.jy=function(a,b){var c=b.max_z,h=b.min_z,d=Math.max(0,c-h);return{Ka:a,height:d,I:new Float32Array([0,0,(c+h)/2])}};a.iy=function(a,b){var c=b.max_z,h=b.min_z,d=Math.max(0,c-h);return{Ka:a,height:d,I:new Float32Array([0,0,(c+h)/2])}};a.jQ=function(a,b){return a.min_x>b.max_x||
a.max_x<b.min_x?!1:a.min_y>b.max_y||a.max_y<b.min_y?!1:a.min_z>b.max_z||a.max_z<b.min_z?!1:!0};a.dM=function(a){for(var b=0,c=0,h=0,k=0,u=0,e=0,p=0,r=0,f=0,m=0,g=0,w=0,v=0,x=0,n=0;n<a.submeshes.length;n++){var K=a.submeshes[n];if(K.position.length){b=k=K.position[0];c=u=K.position[1];h=e=K.position[2];break}}for(n=0;n<a.submeshes.length;n++){for(var K=a.submeshes[n],N=K.position,p=m=K.position[0],r=g=K.position[1],f=w=K.position[2],ha=0;ha<N.length/3;ha++)var A=N[3*ha],B=N[3*ha+1],t=N[3*ha+2],b=Math.max(A,
b),c=Math.max(B,c),h=Math.max(t,h),k=Math.min(A,k),u=Math.min(B,u),e=Math.min(t,e),p=Math.max(A,p),r=Math.max(B,r),f=Math.max(t,f),m=Math.min(A,m),g=Math.min(B,g),w=Math.min(t,w),v=Math.max(Math.sqrt(A*A+B*B+t*t),v),x=Math.max(Math.sqrt(A*A+B*B),x);N=K.boundings.bounding_box;N.max_x=p;N.min_x=m;N.max_y=r;N.min_y=g;N.max_z=f;N.min_z=w;N=y;N[0]=m;N[1]=g;N[2]=w;N[3]=p;N[4]=g;N[5]=w;N[6]=p;N[7]=r;N[8]=w;N[9]=m;N[10]=r;N[11]=w;N[12]=m;N[13]=g;N[14]=f;N[15]=p;N[16]=g;N[17]=f;N[18]=p;N[19]=r;N[20]=f;N[21]=
m;N[22]=r;N[23]=f;p=d(N,!1);K.boundings.bounding_ellipsoid_center=p.I;K.boundings.bounding_ellipsoid_axes=[p.jd[0],p.kd[1],p.ld[2]]}a.b4w_bounding_box.max_x=b;a.b4w_bounding_box.min_x=k;a.b4w_bounding_box.max_y=c;a.b4w_bounding_box.min_y=u;a.b4w_bounding_box.max_z=h;a.b4w_bounding_box.min_z=e;a.b4w_bounding_box_source.max_x=b;a.b4w_bounding_box_source.min_x=k;a.b4w_bounding_box_source.max_y=c;a.b4w_bounding_box_source.min_y=u;a.b4w_bounding_box_source.max_z=h;a.b4w_bounding_box_source.min_z=e;a.b4w_bounding_sphere_radius=
v;a.b4w_bounding_cylinder_radius=x;N=y;N[0]=k;N[1]=u;N[2]=e;N[3]=b;N[4]=u;N[5]=e;N[6]=b;N[7]=c;N[8]=e;N[9]=k;N[10]=c;N[11]=e;N[12]=k;N[13]=u;N[14]=h;N[15]=b;N[16]=u;N[17]=h;N[18]=b;N[19]=c;N[20]=h;N[21]=k;N[22]=c;N[23]=h;p=d(N,!1);a.b4w_bounding_ellipsoid_center=p.I;a.b4w_bounding_ellipsoid_axes=[p.jd[0],p.kd[1],p.ld[2]]};a.ZJ=function(a){var b=a.subarray(0,3),c=a.subarray(6,9),h=a.subarray(12,15),d=a.subarray(18,21);a=B.subtract(c,b,A);B.normalize(a,a);var u=C.hK(b,c,h,H),u=B.cross(u,a,u);B.normalize(u,
u);var p=B.create(),e=B.create();B.subtract(c,b,w);e[0]=B.dot(w,a);e[1]=B.dot(w,u);c=B.create();B.subtract(h,b,w);c[0]=B.dot(w,a);c[1]=B.dot(w,u);h=B.create();B.subtract(d,b,w);h[0]=B.dot(w,a);h[1]=B.dot(w,u);d=f();h=[p,e,c,h];p=k(d,h[0],h[1]);for(d=2;d<h.length;d++)if(B.distance(p.I,h[d])>p.Ka){for(var r=p,p=h,e=h[d],c=d-1,r=k(r,e,p[0]),O=1;O<=c;O++)if(B.distance(r.I,p[O])>r.Ka){for(var m=r,r=p,g=e,R=p[O],v=O-1,m=k(m,g,R),x=0;x<=v;x++)if(B.distance(m.I,r[x])>m.Ka){var n=g,K=R,N=r[x],ha=B.subtract(K,
N,w),ha=B.squaredLength(ha),y=B.subtract(n,N,w),t=B.squaredLength(y),y=B.subtract(n,K,w),P=B.squaredLength(y),y=ha*(t+P-ha),sa=t*(P+ha-t),ha=P*(ha+t-P),t=y+sa+ha;B.copy(n,m.I);B.scale(m.I,y/t,m.I);B.scaleAndAdd(m.I,K,sa/t,m.I);B.scaleAndAdd(m.I,N,ha/t,m.I);m.Ka=B.distance(m.I,n)}r=m}p=r}d=p;a=B.scale(a,d.I[0],w);B.scaleAndAdd(a,u,d.I[1],a);B.add(a,b,d.I);return d}};b4w.module.__compat=function(a,q){function e(a){return-1<navigator.userAgent.indexOf(a)?!0:!1}function c(){return navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i)}function b(){return!window.ActiveXObject&&"ActiveXObject"in window}var n=q("__config"),f=q("__debug"),t=q("__extensions"),
g=q("__print"),m=q("__renderer"),v="R600;RV610;RV630;RV620;RV635;RV670;RS780;RS880;RV770;RV730;RV710;RV740;CEDAR;REDWOOD;JUNIPER;CYPRESS;PALM (Wrestler/Ontario);SUMO (Llano);SUMO2 (Llano);ARUBA (Trinity/Richland);BARTS;TURKS;CAICOS;CAYMAN".split(";");a.Ix=256;var x=n.xj,d=n.v,k=n.context,r=n.jh,C=n.Kk,B=n.M,F=n.B,D=n.Gd;a.HI=function(a){a.getError()==a.INVALID_ENUM&&g.warn("Possible Tegra invalid enum issue detected, ignoring")};a.SB=function(y,A){function q(a){A&&g.warn(a)}r.tL=y.getParameter(y.MAX_COMBINED_TEXTURE_IMAGE_UNITS);
r.Fo=y.getParameter(y.MAX_FRAGMENT_UNIFORM_VECTORS);r.rv=y.getParameter(y.MAX_TEXTURE_IMAGE_UNITS);r.Er=y.getParameter(y.MAX_VARYING_VECTORS);r.sv=y.getParameter(y.MAX_VERTEX_ATTRIBS);r.UA=y.getParameter(y.MAX_VERTEX_TEXTURE_IMAGE_UNITS);r.Go=y.getParameter(y.MAX_VERTEX_UNIFORM_VECTORS);r.Fi=y.getParameter(y.MAX_CUBE_MAP_TEXTURE_SIZE);r.ov=y.getParameter(y.MAX_RENDERBUFFER_SIZE);r.dc=y.getParameter(y.MAX_TEXTURE_SIZE);r.tv=y.getParameter(y.MAX_VIEWPORT_DIMS);d.Vb?(d.lc=Math.min(d.lc,y.getParameter(y.MAX_SAMPLES)),
e("Firefox")&&(q("Firefox and WebGL 2 detected, applying framebuffer hack"),d.Fy=!0)):d.lc=1;e("Firefox")&&"NONE"!==d.stereo&&(q("Firefox and Stereo rendering detected, disable texture reusage"),d.yz=!0);if(d.Vb&&f.ZG()||e("Firefox"))q("Firefox detected, disabling multisample"),d.lc=1;m.LM();var w=Boolean(t.UJ());e("Firefox/28.0")&&(e("Linux")||e("Macintosh"))&&(q("Firefox 28 detected, applying depth hack"),w=!1);e("Windows Phone")||(e("iPad")||e("iPhone")?(q("iOS detected, applying alpha hack, applying vertex animation mix normals hack, disable smaa. Disable ssao for performance. Initialize WebAudio context with empty sound. Applying glow hack."),
k.alpha||(d.background_color[3]=1),d.NB=!0,d.kD=!0,d.smaa=!1,d.ssao=!1,d.precision="highp",d.Yu=!0,C.xl=256,Boolean(t.$z())&&D.es&&(d.Pj="pvr")):e("Mac OS X")&&e("Safari")&&!e("Chrome")&&(q("OS X / Safari detected, force to wait complete loading. Applying playback rate hack for video textures. Applying canvas alpha hack."),d.MB=!0,B.ey=!0,B.My=!0));e("Windows")&&(e("Chrome/40")||e("Firefox/33")||e("Firefox/34")||e("Firefox/35")||e("Firefox/36"))&&(q("Windows/Chrome40 or Firefox33-36 detected. Applying clear procedural skydome hack."),
d.Tt=!0);e("Chrome")&&!c()&&n.rA()&&(q('Chrome (non-mobile) was detected for a single HTML-exported file. "Background Music" speakers were changed to "Background Sound".'),d.Ly=!0);e("Mac OS X")&&(d.Cr=!0,q("OS X detected, applying shadows hack."));c()&&(q("Mobile detected, applying various hacks for video textures."),d.is_mobile_device=!0,e("iPad")||e("iPhone")||e("Windows Phone")||(q("Mobile (not iOS) detected, disable playback rate for video textures."),B.oz=!0));(e("Firefox/35.0")||e("Firefox/36.0"))&&
e("Windows")&&(q("Windows/Firefox 35/36 detected, applying shadows slink hack"),d.cC=!0);if(e("iPhone")||b()||e("Edge"))q("iPhone, IE11 or Edge detected. Enable sequential video fallback for video textures."),d.dp=!0;10>r.Er&&(q("Not enough varyings, disable shadows on blend objects"),d.tu=!0);e("Windows Phone")&&(q("Windows Phone detected. Disable debug view mode, glow materials, ssao, smaa, shadows, reflections, refractions."),d.debug_view=!1,d.precision="highp",d.th=!1,d.ssao=!1,d.smaa=!1,d.shadows=
!1,d.reflections=!1,d.refractions=!1,d.AB=!1);if(e("UCBrowser")||e("Firefox")&&d.is_mobile_device)q("Mobile Firefox or UCBrowser detected, disable workers."),F.Ap=!1;var h=t.get_renderer_info();if(h){var u=y.getParameter(h.UNMASKED_VENDOR_WEBGL),h=y.getParameter(h.UNMASKED_RENDERER_WEBGL),P=/\b4\d{2}\b/;e("Macintosh")&&-1<h.indexOf("Intel HD Graphics 3000")&&(q("OS X / Intel HD 3000 detected, applying depth hack"),w=!1);-1<u.indexOf("ARM")&&P.test(h)&&(q("ARM Mali-400 series detected, applying depth and frames blending hacks"),
w=!1,x.Gz=!0);-1<u.indexOf("ARM")&&-1<h.indexOf("Mali-T604")&&(q('ARM Mali-T604 detected, set "highp" precision and disable shadows.'),d.precision="highp",d.shadows=!1);-1<u.indexOf("ARM")&&-1<h.indexOf("Mali-T760")&&(q('ARM Mali-T760 detected, set "highp" precision and disable SSAO.'),d.precision="highp",d.ssao=!1,d.vs=!0,d.Vb&&(d.lc=1,q("ARM Mali-T760 and WebGL 2 detected, switch MSAA samples to 1.")));-1<u.indexOf("Qualcomm")&&-1<h.indexOf("Adreno")&&(q("Qualcomm Adreno detected, applying shader constants hack."),
d.rw=!0,-1<h.indexOf("305")&&(q('Qualcomm Adreno305 detected, set "highp" precision.'),d.precision="highp"),-1<h.indexOf("330")&&(q('Qualcomm Adreno330 detected, set "highp" precision.'),d.precision="highp"),-1<h.indexOf("420")&&(q("Qualcomm Adreno420 detected, setting max cubemap size to 4096, setting max texture size to 4096."),r.dc=4096,r.Fi=4096));-1<u.indexOf("NVIDIA")&&-1<h.indexOf("Tegra 3")&&(q("NVIDIA Tegra 3 detected, force low quality for B4W_LEVELS_OF_QUALITY nodes."),d.Du=!0);e("Windows")&&
e("Chrome")&&!e("Edge")&&(h.match(/NVIDIA GeForce 8..0/)||h.match(/NVIDIA GeForce 9..0/)||h.match(/NVIDIA GeForce( (G|GT|GTS|GTX))? 2../))&&(q("Chrome / Windows / NVIDIA GeForce 8/9/200 series detected, setting max cubemap size to 256, use canvas for resizing."),r.Fi=a.Ix,d.gw=!0);-1<h.indexOf("PowerVR")&&(q("PowerVR series detected, use canvas for resizing. Set sky cubemap texture size to 256 (power of two). Disable shadows. Apply skinning hack, disable skin blending between frames."),d.gw=!0,C.xl=
256,d.vs=!0,d.shadows=!1);u="";for(P=0;P<v.length;P++)if(-1<h.indexOf(v[P])){u=v[P];break}u&&(q("Architecture "+u+" detected. Blending between frames and shadows on blend objects will be disabled."),d.vs=!0,d.tu=!0)}0==r.UA&&(q("Vertex textures are not allowed. Disabling vertex textures"),d.Wp=!1);w||(d.Il=!1,d.jc=!1,d.water_dynamic=!1,d.shore_smoothing=!1,d.qm=!1,d.smaa=!1);d.cD=Boolean(t.aA())||"pvr"==d.Pj;d.Aq=w;if(y.getShaderPrecisionFormat)var p=y.getShaderPrecisionFormat(y.FRAGMENT_SHADER,y.HIGH_FLOAT);
y.getShaderPrecisionFormat&&0!==p.precision||(d.precision="mediump");b()&&(q("IE11 detected. Set sky cubemap texture size to 512 (power of two)."),C.xl=512);if(b()&&e("Touch")||e("Edge"))q("IE11 and touchscreen or Edge detected. Behaviour of the mouse move sensor will be changed."),d.gr=!0;if(b()||e("Edge"))d.nA=!0;128>=r.Fo&&(q("Not enough fragment uniforms, force low quality for B4W_LEVELS_OF_QUALITY nodes."),d.Du=!0);c()&&e("Firefox")&&(g.log("Mobile firefox detected. Applying autoplay media hack.Setting max cubemap size to 4096, setting max texture size to 4096."),
d.vv=!0,r.dc=4096,r.Fi=4096);e("Edge")&&(q("Microsoft Edge detected, set up new minimal texture size."),d.$n=!0)};a.Rt=e;a.detect_mobile=c;a.aG=function(){e("Firefox/35.0")&&e("Windows")&&(g.warn("Windows/Firefox 35 detected, forcing context's alpha"),n.context.alpha=!0)};a.is_ie11=b};b4w.module.__constraints=function(a,q){function e(a){var b={};b.type=a;return b}function c(a,c){a.Kb&&a.Kb.xa&&b(a.Kb.xa,a);if(c.xa){var h=c.xa;-1==h.be.indexOf(a)?h.be.push(a):C.r("Descendant object override is forbidden")}a.Kb=c}function b(a,b){var c=a.be.indexOf(b);-1!=c?a.be.splice(c,1):C.r("No descendant object")}function n(a,b,c){switch(b.type){case 1:var d=r.get_quat_view(a.k.n),e=b.xa.k.n;c=r.get_quat_view(b.xa.k.n);b.Ad?(k.copy(b.Ad,d),k.multiply(c,d,d)):k.copy(c,d);var f=r.transform_vec3(b.offset,
e,y);r.set_trans(f,a.k.n);f=r.get_scale(b.xa.k.n);r.set_scale(b.ap*f,a.k.n);break;case 9:f=r.get_trans_view(a.k.n);d=r.get_quat_view(a.k.n);e=b.xa.k.n;c=r.get_quat_view(b.xa.k.n);k.multiply(k.invert(b.Ek,b.Ek),d,d);k.multiply(c,d,d);r.transform_vec3(b.offset,e,f);k.copy(c,b.Ek);break;case 10:f=r.get_trans_view(a.k.n);d=r.get_quat_view(a.k.n);e=b.xa.k.n;c=r.get_quat_view(b.xa.k.n);k.multiply(k.invert(b.Ek,b.Ek),d,d);k.multiply(c,d,d);r.transform_vec3(b.offset,e,f);k.copy(c,b.Ek);f=r.get_quat_view(a.k.n);
d=r.get_quat_view(b.xa.k.n);d=k.multiply(d,b.Ad,h);d=v.Sz(d,F);f=v.Sz(f,D);v.rotate_eye_camera(a,C.Hj(f[0],d[0]+b.dH,d[0]+b.cH),C.Hj(f[1],d[1]+b.bH,d[1]+b.eH));break;case 13:var f=r.get_trans_view(a.k.n),d=r.get_quat_view(a.k.n),e=b.xa.k.n,w=r.get_trans_view(e),n=b.xN,O=y,A=h;r.transform_vec3(b.offset,e,O);C.smooth_v(O,f,c,n,f);e=y;B.sub(w,f,e);B.normalize(e,e);var q=d,f=u,w=f.subarray(0,3),O=f.subarray(3,6),R=f.subarray(6,9);B.copy(e,R);B.negate(R,R);B.normalize(R,R);Boolean(.999999<Math.abs(B.dot(e,
C.AXIS_Z)))?(e=x.fromQuat(k.normalize(q,A),P),B.copy(e.subarray(0,3),w)):B.cross(C.AXIS_Z,R,w);B.normalize(w,w);B.cross(R,w,O);B.normalize(O,O);k.fromMat3(f,A);k.normalize(A,A);C.iC(A,d,c,.16*n,d);break;case 2:d=r.get_quat_view(a.k.n);c=p;m.get_bone_tsr(b.xa,b.Fj,!0,!1,c);r.multiply(b.xa.k.n,c,c);d[0]=c[4];d[1]=c[5];d[2]=c[6];d[3]=c[7];b.Ad&&(k.copy(b.Ad,d),k.multiply(d,b.Ad,d));r.set_scale(b.ap*c[3],a.k.n);f=r.get_trans_view(a.k.n);r.transform_vec3(b.offset,c,f);break;case 3:f=r.get_trans_view(a.k.n);
d=r.get_quat_view(a.k.n);c=r.get_trans_view(b.xa.k.n);t(f,d,c);break;case 4:f=r.get_trans_view(a.k.n);d=r.get_quat_view(a.k.n);c=b.target;t(f,d,c);break;case 5:f=r.get_trans_view(a.k.n);d=r.get_quat_view(a.k.n);c=r.get_trans_view(b.xa.k.n);t(f,d,c);d=B.dist(f,c);if(d=d>b.dist_max?d-b.dist_max:d<b.Vn?d-b.Vn:0)B.sub(c,f,y),B.normalize(y,y),B.scale(y,d,y),B.add(f,y,f);break;case 6:f=r.get_trans_view(a.k.n);d=r.get_quat_view(a.k.n);c=b.target;t(f,d,c);d=B.dist(f,c);if(d=d>b.dist_max?d-b.dist_max:d<b.Vn?
d-b.Vn:0)B.sub(c,f,y),B.normalize(y,y),B.scale(y,d,y),B.add(f,y,f);break;case 7:e=b.xa.k.n;f=r.get_trans_view(a.k.n);r.transform_vec3(b.offset,e,f);break;case 8:w=r.get_trans_view(b.xa.k.n);f=r.get_trans_view(a.k.n);B.add(w,b.offset,f);break;case 14:d=r.get_quat_view(a.k.n);e=b.xa.k.n;c=r.get_quat_view(b.xa.k.n);b.Ad?(k.copy(b.Ad,d),k.multiply(c,d,d)):k.copy(c,d);f=r.get_trans_view(a.k.n);r.transform_vec3(b.offset,e,f);break;case 11:r.multiply(b.xa.k.n,b.Ks,a.k.n);break;case 12:f=b.Ks;c=p;m.get_bone_tsr(b.xa,
b.Fj,!0,!1,c);r.multiply(b.xa.k.n,c,c);r.multiply(c,f,a.k.n);break;case 15:d=b.xa,c=v.XJ(d),f=r.get_trans_view(a.k.n),e=v.Ml(c,"LEFT"),w=v.Ml(c,"RIGHT"),n=v.Ml(c,"TOP"),A=v.Ml(c,"BOTTOM"),O="heights"==b.hor_units?n-A:w-e,b.JA?(e=v.Ml(c,"LEFT"),f[0]=e+O*b.fv):(w=v.Ml(c,"RIGHT"),f[0]=w-O*b.fv),e="heights"==b.vert_units?n-A:w-e,f[1]=b.MC?n-e*b.Sw:A+e*b.Sw,v.KK(c)?f[2]=-b.distance:(f[2]=-1,B.normalize(f,f),B.scale(f,b.distance/Math.abs(f[2]),f)),r.transform_dir_vec3(f,d.k.n,f),c=r.get_trans_view(d.k.n),
B.add(c,f,f),f=r.get_quat_view(a.k.n),d=r.get_quat_view(d.k.n),b.Ad?(k.copy(b.Ad,f),k.multiply(d,f,f)):k.copy(d,f)}"CAMERA"==a.k.type&&(f=a.k.xe,10==b.type&&(c=r.get_quat_view(b.xa.k.n),f=B.transformQuat(f,c,z)),v.dx(a),g(a,f))}function f(a,b){switch(b.type){case 1:var c=b.target.k.n,h=p;r.invert(a.k.n,h);r.multiply(h,c,h);m.set_bone_tsr(a,b.Fj,h,!1)}a.Gv=!0}function t(a,b,c){var h=y;C.quat_to_dir(b,C.AXIS_MZ,h);B.normalize(h,h);var d=A;B.subtract(c,a,d);B.normalize(d,d);a=C.LB(h,d,w);k.multiply(a,
b,b);k.normalize(b,b)}function g(a,b,c){var d=a.k,u=r.get_quat_view(d.n),e=C.quat_to_dir(u,C.AXIS_Z,y);B.normalize(e,e);if(.999999<Math.abs(B.dot(b,e)))e=k.identity(h);else{var f=B.cross(b,e,A);B.normalize(f,f);d.pb==v.MS_TARGET_CONTROLS?d.Hm&&B.negate(f,f):(d=C.quat_to_dir(u,C.AXIS_MY,H),0<B.dot(d,b)&&B.negate(f,f));d=C.quat_to_dir(u,C.AXIS_X,H);B.normalize(d,d);var p=C.clamp(B.dot(d,f),-1,1),e=-.999999>=p?k.setAxisAngle(e,Math.acos(p),h):k.rotationTo(d,f,h);k.normalize(e,e)}k.multiply(e,u,u);c&&
(c=C.quat_to_dir(u,C.AXIS_Y,y),0>B.dot(b,c)&&k.rotateZ(u,Math.PI,u));v.dx(a)}var m=q("__armature"),v=q("__camera"),x=q("__mat3"),d=q("__print"),k=q("__quat"),r=q("__tsr"),C=q("__util"),B=q("__vec3");a.FP=1;a.EP=2;a.JP=3;a.KP=4;a.zP=5;a.AP=6;a.GP=7;a.yP=8;a.DP=9;a.CP=10;a.wP=11;a.xP=12;a.BP=13;a.HP=14;a.IP=15;a.vP=1;var F=new Float32Array(2),D=new Float32Array(2),y=new Float32Array(3),A=new Float32Array(3),H=new Float32Array(3),w=new Float32Array(4),h=new Float32Array(4),u=new Float32Array(9),P=new Float32Array(9),
p=r.create(),z=new Float32Array(3);a.Zx=function(a,b,d,h,k){var u=e(1);u.xa=b;u.offset=new Float32Array(d);u.Ad=h?new Float32Array(h):null;u.ap=k;c(a,u);n(a,u,0)};a.RF=function(a,b,h,d,k,u){var f=e(2);f.xa=b;f.Fj=h;f.offset=new Float32Array(d);f.Ad=k?new Float32Array(k):null;f.ap=u;c(a,f);n(a,f,0)};a.PF=function(a,b,h,d){var u=e(9),f=r.get_quat_view(a.k.n),p=r.get_quat_view(b.k.n);u.xa=b;u.offset=new Float32Array(h);u.Ek=new Float32Array(p);d&&(k.copy(d,f),k.multiply(p,f,f));c(a,u);n(a,u,0)};a.OF=
function(a,b,d,h,u,f,p,m){var O=e(10),g=r.get_quat_view(a.k.n),z=r.get_quat_view(b.k.n);O.xa=b;O.offset=new Float32Array(d);O.Ek=new Float32Array(z);O.cH=C.angle_wrap_0_2pi(u);O.dH=C.angle_wrap_0_2pi(f);O.eH=C.angle_wrap_periodic(p,-Math.PI,Math.PI);O.bH=C.angle_wrap_periodic(m,-Math.PI,Math.PI);h?(O.Ad=new Float32Array(h),k.copy(h,g),k.multiply(z,g,g)):O.Ad=k.create();c(a,O);n(a,O,0)};a.NF=function(a,b,h,d){var k=e(13);k.xa=b;k.offset=new Float32Array(h);k.xN=d;c(a,k);n(a,k,0)};a.UF=function(a,b,
h,d){var k=e(14);k.xa=b;k.offset=new Float32Array(h);k.ap=1;k.Ad=d?new Float32Array(d):null;c(a,k);n(a,k,0)};a.IR=b;a.XF=function(a,b){var h=e(3);h.xa=b;c(a,h);n(a,h,0)};a.YF=function(a,b){var h=e(4);h.target=new Float32Array(b);c(a,h);n(a,h,0)};a.JF=function(a,b,h,d){var k=e(5);k.xa=b;k.Vn=h;k.dist_max=d;c(a,k);n(a,k,0)};a.KF=function(a,b,h,d){var k=e(6);k.target=new Float32Array(b);k.Vn=h;k.dist_max=d;c(a,k);n(a,k,0)};a.TF=function(a,b,h){var d=e(7);d.xa=b;d.offset=new Float32Array(h);c(a,d);n(a,
d,0)};a.HF=function(a,b,h){var d=e(8);d.xa=b;d.offset=new Float32Array(h);c(a,d);n(a,d,0)};a.FF=function(a,b,h){var d=e(11);d.xa=b;d.Ks=new Float32Array(h);c(a,d);n(a,d,0)};a.GF=function(a,b,d,h){var k=e(12);k.xa=b;k.Fj=d;k.Ks=new Float32Array(h);c(a,k);n(a,k,0)};a.append_stiff_viewport=function(a,b,h){var k=e(15);k.xa=b;if(C.of(h.left))k.JA=!0,k.fv=h.left;else if(C.of(h.right))k.JA=!1,k.fv=h.right;else{d.error("append_stiff_viewport: Wrong positioning params");return}if(C.of(h.top))k.MC=!0,k.Sw=
h.top;else if(C.of(h.bottom))k.MC=!1,k.Sw=h.bottom;else{d.error("append_stiff_viewport: Wrong positioning params");return}C.of(h.distance)?(k.distance=h.distance,k.Ad=C.of(h.rotation)?new Float32Array(h.rotation):null,k.hor_units=C.of(h.hor_units)?h.hor_units:"widths",k.vert_units=C.of(h.vert_units)?h.vert_units:"heights",c(a,k),n(a,k,0)):d.error("append_stiff_viewport: Wrong positioning params")};a.tO=function(a,b){a.Kb&&n(a,a.Kb,b)};a.SF=function(a,b,c,h,d){var k=e(1);k.Fj=c;k.target=b;k.offset=
new Float32Array(h);k.Ad=d?new Float32Array(d):null;k.ap=1;b=k.target;c=k.Fj;h=a.k.Zd[c];d=b.$t;for(var u=0;u<d;u++){var p=d[u];if(p[0]==a&&p[1]==c){d.splice(u,1);break}}b.$t.push([a,c]);h.Kb=k;f(a,k)};a.nO=function(a,b){var c=a.k.Zd[b];c.Kb&&f(a,c.Kb)};a.xM=t;a.correct_up=g;a.TG=function(a){return a.Kb?!0:!1};a.remove=function(a){a.Kb.xa&&b(a.Kb.xa,a);a.Kb=null};a.cR=function(a){return a.Kb?a.Kb.type:null};a.mf=function(a){a=a.Kb;return!a||11!=a.type&&12!=a.type?!1:!0};a.Qq=function(a){if((a=a.Kb)&&
11==a.type)return a.xa.k.n;if(a&&12==a.type){var b=p;m.get_bone_tsr(a.xa,a.Fj,!0,!1,b);r.multiply(a.xa.k.n,b,b);return b}return null};a.lf=function(a){a=a.Kb;return!a||11!=a.type&&12!=a.type?null:a.Ks}};b4w.module.__container=function(a,q){var e,c,b,n,f;function t(a,b){e=a;c=b}function g(){var a=u.getBoundingClientRect();t(a.left,a.top)}function m(){return H.allow_hidpi&&2<=window.devicePixelRatio?!0:!1}function v(b,c,d){if(!b||!c){b=a.jt;c=a.it;var f=p;f.style.width=a.jt+"px";f.style.height=a.it+"px"}var f=u,e=P;!1!==d&&(f.style.width=b+"px",f.style.height=c+"px",e&&(e.style.width=b+"px",e.style.height=c+"px"));e&&(e.width=b,e.height=c,r.sp());d=Math.floor(b*H.canvas_resolution_factor);c=Math.floor(c*
H.canvas_resolution_factor);m()&&(d*=window.devicePixelRatio,c*=window.devicePixelRatio);if(e=F.jk())e=e.q,d=Math.floor(d*e.re),c=Math.floor(c*e.re);f.width=d;f.height=c;var e=Math.min(h.drawingBufferWidth,w.ov,w.tv[0]),g=Math.min(h.drawingBufferHeight,w.ov,w.tv[1]);if(d>e||c>g)B.warn("Canvas size exceeds platform limits, downscaling"),e=Math.min(e/d,g/c),d*=e,c*=e,f.width=d,f.height=c;F.XB(d,c,d/b);F.Ba()&&y.A(F.get_active().ci);k.xO(f.width,f.height);k.is_primary_loaded()&&(x.update(),F.update(D.get_timeline(),
0),x.bD())}var x=q("__anchors"),d=q("__config"),k=q("__data"),r=q("__hud"),C=q("__input"),B=q("__print"),F=q("__scenes"),D=q("__time"),y=q("__transform"),A=q("__util"),H=d.v,w=d.jh,h=null,u=null,P=null,p=null,z=!1;n=b=0;f=1;e=c=0;a.jt=320;a.it=240;a.Ue=function(a){h=a};a.get_canvas=function(){return u};a.get_canvas_hud=function(){return P};a.get_container=function(){return p};a.init=function(a,b){a&&a.parentNode?(u=a,P=b,p=a.parentNode):A.r("canvas container is not available")};a.insert_to_container=
function(a,b){b=b||"LAST";switch(b){case "FIRST":p.insertBefore(a,p.firstElementChild);break;case "JUST_BEFORE_CANVAS":p.insertBefore(a,u);break;case "JUST_AFTER_CANVAS":u.nextElementSibling?p.insertBefore(a,u.nextElementSibling):p.appendChild(a,u);break;case "LAST":p.appendChild(a,u);break;default:B.error(b+" invalid stack order")}};a.fA=function(){return b};a.eA=function(){return n};a.set_canvas_offsets=t;a.update_canvas_offsets=g;a.qN=function(a,c,d){b=a;n=c;f=d;g()};a.force_offsets_updating=function(){z=
!0};a.client_to_canvas_coords=function(a,b,d){d||(d=new Float32Array(2));var h=d;z&&(g(),z=!1);h[0]=a-e;a=d;z&&(g(),z=!1);a[1]=b-c;return d};a.jq=function(a,c,d,h){d||(d=new Float32Array(2));d[0]=a*f;d[1]=c*f;h&&(a=h.width/b,d[0]*=a,d[1]*=a);return d};a.hP=function(a,c,d,h){d||(d=new Float32Array(2));d[0]=a/f;d[1]=c/f;h&&(a=h.width/b,d[0]/=a,d[1]/=a)};a.sA=function(b){return b&&b.parentNode?b.parentNode==p?!0:a.sA(b.parentNode):!1};a.GK=m;a.kJ=function(a){var b=document.getElementsByTagName("script");
a=A.Jo(a);for(var c=0;c<b.length;c++)if(b[c].src==a)return b[c];return null};a.resize=v;a.resize_to_container=function(a){var b=p,c=u,d=b.clientWidth,b=b.clientHeight;if(a||d!=c.clientWidth||b!=c.clientHeight)(a="HMD"===H.stereo&&C.gA())&&a.isPresenting||v(d,b,!0)};a.reset=function(){p=P=u=h=null}};b4w.module.__controls=function(a,q){function e(a,b){b||(b=k.get_container());return{type:a,value:0,la:null,element:b,Ia:!1,key:0,Bb:"",sg:!1,Xt:null,Wt:function(){},Vt:null,Qy:function(){},Pg:null,from:new Float32Array(3),to:new Float32Array(3),qA:!1,hr:!1,Wo:0,DB:function(){},axis:"",Ze:0,Jm:new Float32Array(3),fs:new Float32Array(4),threshold:0,BB:new Float32Array(4),bq:0,aq:0,KB:0,cq:0,Te:0,repeat:!1,sz:!1,fk:0,callback:function(){}}}function c(a){function b(){return{mi:new Float32Array(2),uk:!0,
obj:null,identifier:-1,qr:!0}}a||(a=k.get_container());for(var c=0;c<M.length;c++){var d=M[c];if(a==d.element)return d}d={element:a,Vl:!0,Sl:!1,rr:!0,xv:0,yv:0,cm:0,dm:0,gg:new Float32Array(2),ue:new Float32Array(2),hg:new Float32Array(2),$e:new Float32Array(2),Hs:0,Zw:0,NC:0,td:new Uint8Array(256),at:0,Ru:null,Hg:b(),Qk:Array(10),dv:!1,jA:D.create(),Zq:0,Yq:0,Xq:0,Tu:0,Su:0,Wq:Infinity,Lv:null,Kv:null,Cv:null,wv:null,Av:null,Xw:null,Ww:null,Bv:null,zv:null,tR:null,Yw:null,Vw:null,Uw:null,Hh:{}};
for(c=0;10>c;++c)d.Qk[c]=b();d.Lv=function(a){d.dv||(r.qK(a,d.jA),d.dv=!0)};d.Kv=function(a){a=w.copy(a,G);d.Xq=a[0];d.Yq=a[1];d.Zq=a[2];Infinity==d.Wq&&(d.Wq=a[0],d.Su=a[1],d.Tu=a[2])};d.Cv=function(a){d.at+=a*h.BL};d.wv=function(a){var b=r.get_device_by_type_element(r.DEVICE_MOUSE,d.element),b=r.get_vector_param(b,r.MOUSE_LOCATION,E);d.xv=b[0];d.yv=b[1];d.cm=b[0];d.dm=b[1];d.Sl=!0;d.which=a};d.Av=function(){var a=r.get_device_by_type_element(r.DEVICE_MOUSE,d.element),a=r.get_vector_param(a,r.MOUSE_LOCATION,
E),a=k.client_to_canvas_coords(a[0],a[1],E);d.Hg.uk=!1;d.Hg.mi[0]=a[0];d.Hg.mi[1]=a[1]};d.Xw=function(a){for(var b=0;b<a.length;++b){for(var c=a[b],h=null,u=null,f=0;f<d.Qk.length;f++){var e=d.Qk[f];if(e.identifier==c.identifier){e.qr&&(u=e);break}else!h&&e.qr&&(h=e,h.identifier=c.identifier)}if(c=u||h)h=k.client_to_canvas_coords(a[b].clientX,a[b].clientY,E),c.uk=!1,c.qr=!1,c.mi[0]=h[0],c.mi[1]=h[1]}};d.Ww=function(a){for(var b=0;b<d.Qk.length;++b){for(var c=d.Qk[b],h=!1,k=0;k<a.length;++k)if(a[k].identifier==
c.identifier){h=!0;break}h||(c.uk=!0,c.qr=!0,c.obj=null)}};d.Bv=function(){d.Sl=!1};d.zv=function(a){if(!u.gr||d.Sl)d.cm=a[0],d.dm=a[1]};d.BA=function(a){2!=d.td[a]&&(d.td[a]=1,d.Vl=!1)};d.DA=function(){for(var a=0;a<d.td.length;a++)0!=d.td[a]&&(d.td[a]=3,d.Vl=!1)};d.EA=function(a){1==d.td[a]?d.td[a]=0:(d.Vl&=0,d.td[a]=3)};d.Yw=function(a){d.rr=!1;if(1==a.length)d.gg[0]=a[0].clientX,d.gg[1]=-1,d.hg[0]=a[0].clientY,d.hg[1]=-1;else if(1<a.length){d.Hs=d.Zw=v(a);d.gg[0]=a[0].clientX;d.gg[1]=a[1].clientX;
d.hg[0]=a[0].clientY;d.hg[1]=a[1].clientY;var b=a[0];a=a[1];d.NC=Math.atan2(b.clientY-a.clientY,b.clientX-a.clientX)}d.ue.set(d.gg);d.$e.set(d.hg)};d.Vw=function(a){1===a.length?(d.ue[0]=a[0].clientX,d.ue[1]=-1,d.$e[0]=a[0].clientY,d.$e[1]=-1):1<a.length&&(d.ue[0]=a[0].clientX,d.ue[1]=a[1].clientX,d.$e[0]=a[0].clientY,d.$e[1]=a[1].clientY,d.Hs=v(a))};d.Uw=function(a){0==a.length&&(d.rr=!0)};M.push(d);return d}function b(a,b){if(b in a.Hh&&0<a.Hh[b])a.Hh[b]+=1;else switch(a.Hh[b]=1,b){case "orientation_quat":var c=
r.get_device_by_type_element(r.DEVICE_GYRO);c&&r.attach_param_cb(c,r.GYRO_ORIENTATION_ANGLES,a.Lv);break;case "orientation_angles":(c=r.get_device_by_type_element(r.DEVICE_GYRO))&&r.attach_param_cb(c,r.GYRO_ORIENTATION_ANGLES,a.Kv);break;case "mouse_wheel":(c=r.get_device_by_type_element(r.DEVICE_MOUSE,a.element))&&r.attach_param_cb(c,r.MOUSE_WHEEL,a.Cv);break;case "mouse_down_which":(c=r.get_device_by_type_element(r.DEVICE_MOUSE,a.element))&&r.attach_param_cb(c,r.MOUSE_DOWN_WHICH,a.wv);break;case "mouse_select":(c=
r.get_device_by_type_element(r.DEVICE_MOUSE,a.element))&&r.attach_param_cb(c,r.MOUSE_DOWN_WHICH,a.Av);break;case "touch_select":if(c=r.get_device_by_type_element(r.DEVICE_TOUCH,a.element))r.attach_param_cb(c,r.TOUCH_START,a.Xw),r.attach_param_cb(c,r.TOUCH_END,a.Ww);break;case "mouse_up_which":(c=r.get_device_by_type_element(r.DEVICE_MOUSE,a.element))&&r.attach_param_cb(c,r.MOUSE_UP_WHICH,a.Bv);break;case "mouse_location":(c=r.get_device_by_type_element(r.DEVICE_MOUSE,a.element))&&r.attach_param_cb(c,
r.MOUSE_LOCATION,a.zv);break;case "keyboard_downed_keys":if(c=r.get_device_by_type_element(r.DEVICE_KEYBOARD,a.element))r.attach_param_cb(c,r.KEYBOARD_DOWN,a.BA),r.attach_param_cb(c,r.Bx,a.DA),r.attach_param_cb(c,r.KEYBOARD_UP,a.EA);break;case "touch_start":(c=r.get_device_by_type_element(r.DEVICE_TOUCH,a.element))&&r.attach_param_cb(c,r.TOUCH_START,a.Yw);break;case "touch_move":(c=r.get_device_by_type_element(r.DEVICE_TOUCH,a.element))&&r.attach_param_cb(c,r.TOUCH_MOVE,a.Vw);break;case "touch_end":(c=
r.get_device_by_type_element(r.DEVICE_TOUCH,a.element))&&r.attach_param_cb(c,r.TOUCH_END,a.Uw)}}function n(a,b){if(!(!b in a.Hh)&&0<a.Hh[b]&&(--a.Hh[b],!a.Hh[b]))switch(b){case "orientation_quat":var c=r.get_device_by_type_element(r.DEVICE_GYRO);c&&r.detach_param_cb(c,r.GYRO_ORIENTATION_QUAT,a.Lv);break;case "orientation_angles":(c=r.get_device_by_type_element(r.DEVICE_GYRO))&&r.detach_param_cb(c,r.GYRO_ORIENTATION_ANGLES,a.Kv);break;case "mouse_wheel":(c=r.get_device_by_type_element(r.DEVICE_MOUSE,
a.element))&&r.detach_param_cb(c,r.MOUSE_WHEEL,a.Cv);break;case "mouse_down_which":(c=r.get_device_by_type_element(r.DEVICE_MOUSE,a.element))&&r.detach_param_cb(c,r.MOUSE_DOWN_WHICH,a.wv);break;case "mouse_select":(c=r.get_device_by_type_element(r.DEVICE_MOUSE,a.element))&&r.detach_param_cb(c,r.MOUSE_DOWN_WHICH,a.Av);break;case "touch_select":if(c=r.get_device_by_type_element(r.DEVICE_TOUCH,a.element))r.detach_param_cb(c,r.TOUCH_START,a.Xw),r.detach_param_cb(c,r.TOUCH_END,a.Ww);break;case "mouse_up_which":(c=
r.get_device_by_type_element(r.DEVICE_MOUSE,a.element))&&r.detach_param_cb(c,r.MOUSE_UP_WHICH,a.Bv);break;case "mouse_location":(c=r.get_device_by_type_element(r.DEVICE_MOUSE,a.element))&&r.detach_param_cb(c,r.MOUSE_LOCATION,a.zv);break;case "keyboard_downed_keys":if(c=r.get_device_by_type_element(r.DEVICE_KEYBOARD,a.element))r.detach_param_cb(c,r.KEYBOARD_DOWN,a.BA),r.detach_param_cb(c,r.Bx,a.DA),r.detach_param_cb(c,r.KEYBOARD_UP,a.EA);break;case "touch_start":(c=r.get_device_by_type_element(r.DEVICE_TOUCH,
a.element))&&r.detach_param_cb(c,r.TOUCH_START,a.Yw);break;case "touch_move":(c=r.get_device_by_type_element(r.DEVICE_TOUCH,a.element))&&r.detach_param_cb(c,r.TOUCH_MOVE,a.Vw);break;case "touch_end":(c=r.get_device_by_type_element(r.DEVICE_TOUCH,a.element))&&r.detach_param_cb(c,r.TOUCH_END,a.Uw)}}function f(a,b){a.value=Number(b)}function t(a){for(var b=a.Zi,c=a.DM,d=0;d<b.length;d++)c[d]=b[d].value;return a.mL(c)}function g(a,b){a=a||p;var c=a.eg;if(c){var d=a.Lk;if(b){var h=c[b];if(h){for(var k=
h.Zi,u=0;u<k.length;u++){var K=k[u],f;f=z.indexOf(K);f=-1<f?l[f]:[];1==f.length?(m(K),K=z.indexOf(K),-1<K?(z.splice(K,1),l.splice(K,1)):H.r("Sensors cache is corrupted")):1<f.length&&f.splice(f.indexOf(h),1)}delete c[b];u=d.indexOf(h);-1<u?d.splice(u,1):H.r("Incorrect manifolds array");Object.getOwnPropertyNames(c).length||(c=P.indexOf(a),-1<c?P.splice(c,1):B.error("Wrong object"))}}else{d=[];for(b in c)d.push(b);for(u=0;u<d.length;u++)g(a,d[u])}Z=!0}}function m(a){switch(a.type){case 90:F.remove_collision_test(a.Xt,
a.Bb,a.Wt);a.Ia=!0;break;case 100:F.clear_collision_impulse_test(a.Vt);a.Ia=!0;break;case 110:F.remove_ray_test(a.Wo);a.Ia=!0;break;case 140:a.Ia=!0;break;case 20:var b=c(a.element);n(b,"keyboard_downed_keys");a.Ia=!0;break;case 30:b=c(a.element);n(b,"mouse_wheel");a.Ia=!0;break;case 40:b=c(a.element);n(b,"mouse_down_which");n(b,"mouse_up_which");n(b,"mouse_location");a.Ia=!0;break;case 50:b=c(a.element);n(b,"mouse_down_which");n(b,"mouse_up_which");a.Ia=!0;break;case 60:b=c(a.element);n(b,"touch_start");
n(b,"touch_move");n(b,"touch_end");a.Ia=!0;break;case 70:b=c(a.element);n(b,"touch_start");n(b,"touch_move");a.Ia=!0;break;case 75:b=c(a.element);n(b,"touch_start");n(b,"touch_move");a.Ia=!0;break;case 80:b=c(a.element);n(b,"touch_start");n(b,"touch_end");a.Ia=!0;break;case 170:b=c(a.element);n(b,"mouse_select");n(b,"touch_select");n(b,"touch_start");n(b,"touch_end");n(b,"mouse_down_which");n(b,"mouse_up_which");a.Ia=!0;break;case 180:case 190:b=c(a.element);n(b,"orientation_angles");a.Ia=!0;break;
case 200:b=c(a.element);n(b,"orientation_quat");a.Ia=!0;break;case 210:case 220:a.Ia=!0}}function v(a){var b=a[0],c=a[1];a=b.clientX-c.clientX;b=b.clientY-c.clientY;return Math.sqrt(a*a+b*b)}function x(a){return 0==a?r.get_device_by_type_element(r.Fp):1==a?r.get_device_by_type_element(r.kt):2==a?r.get_device_by_type_element(r.lt):r.get_device_by_type_element(r.mt)}var d=q("__config"),k=q("__container"),r=q("__input"),C=q("__objects"),B=q("__print"),F=q("__physics"),D=q("__quat"),y=q("__time"),A=q("__tsr"),
H=q("__util"),w=q("__vec3");q("__vec4");var h=d.controls,u=d.v,P=[],p={},z=[],l=[],M=[],E=new Float32Array(2),W=new Float32Array(2),G=w.create(),J=D.create(),Z=!1,L=0;a.CT_POSITIVE=10;a.CT_CONTINUOUS=20;a.CT_TRIGGER=30;a.CT_SHOT=40;a.CT_LEVEL=50;a.CT_CHANGE=60;a.PL_SINGLE_TOUCH_MOVE=0;a.PL_MULTITOUCH_MOVE_ZOOM=1;a.PL_MULTITOUCH_MOVE_PAN=2;a.PL_MULTITOUCH_MOVE_ROTATE=3;a.update=function(b,d){for(var h=0;h<M.length;h++){var k=M[h];k.Hg.uk||(k.Hg.obj=C.pick_object(k.Hg.mi[0],k.Hg.mi[1]),k.Hg.uk=!0,k.Ru=
k.Hg.obj);for(var e=0;10>e;++e){var l=k.Qk[e];l.uk||(l.obj=C.pick_object(l.mi[0],l.mi[1]),l.uk=!0,k.Ru=l.obj)}}for(h=0;h<z.length;h++)if(k=z[h],e=b,l=d)switch(k.type){case 120:var m=k.Pg,K=A.bc(m.k.n,G),m=A.ud(m.k.n,J),N=w.dist(k.Jm,K),g=k.BB;D.invert(k.fs,g);D.multiply(m,g,g);D.normalize(g,g);g=Math.abs(2*Math.acos(g[3]));N/=l;k.bq=H.smooth(N,k.bq,l,.3);k.la[0]=N;N=g/l;k.aq=H.smooth(N,k.aq,l,.3);k.la[1]=N;k.bq>=k.threshold||k.aq>=k.KB?f(k,1):f(k,0);w.copy(K,k.Jm);D.copy(m,k.fs);k.Ze=e;break;case 130:m=
k.Pg;K=A.bc(m.k.n,G);m=Math.abs(K[1]-k.Jm[1])/l;k.cq=H.smooth(m,k.cq,l,.3);k.la=m;k.cq>=k.threshold?f(k,1):f(k,0);w.copy(K,k.Jm);k.Ze=e;break;case 140:!k.Ia&&0<=k.Te&&e-k.Ze>=k.Te&&(f(k,1),k.repeat?k.Ze=e:k.Te=-k.Te);break;case 150:k.Ze||(k.Ze=e);f(k,e-k.Ze);k.Ze=e;break;case 160:f(k,e);break;case 180:e=c(k.element);k.la[0]=e.Zq-e.Tu;k.la[1]=e.Yq-e.Su;k.la[2]=e.Xq-e.Wq;break;case 190:e=c(k.element);k.la[0]=e.Zq;k.la[1]=e.Yq;k.la[2]=e.Xq;break;case 200:e=c(k.element);D.copy(e.jA,k.la);break;case 210:e=
r.get_device_by_type_element(r.DEVICE_HMD);r.get_vector_param(e,r.HMD_ORIENTATION_QUAT,k.la);break;case 220:e=r.get_device_by_type_element(r.DEVICE_HMD);r.get_vector_param(e,r.HMD_POSITION,k.la);break;case 240:e=x(k.fk);k.value=r.aK(e,k.key);break;case 250:e=x(k.fk);k.value=r.$J(e,k.key);break;case 230:f(k,k.callback());break;case 30:e=c(k.element);f(k,e.at);break;case 40:e=c(k.element);if(!u.gr||e.Sl)switch(l=e.cm-e.xv,K=e.dm-e.yv,k.axis){case "X":f(k,l);k.la=e.cm;break;case "Y":f(k,K);k.la=e.dm;
break;case "XY":m=Math.sqrt(l*l+K*K),f(k,m),k.la[0]=e.cm,k.la[1]=e.dm}break;case 50:e=c(k.element);f(k,e.Sl);k.la=e.which;break;case 170:e=c(k.element);f(k,0);if(k.sz)e.Ru==k.Pg&&f(k,1);else if(e.Sl&&e.Hg.obj==k.Pg)f(k,1);else if(!e.rr)for(l=0;10>l;++l)if(e.Qk[l].obj==k.Pg){f(k,1);break}break;case 20:e=c(k.element);k.la=e.td[k.key];1==k.la||e.td[0]&&16==k.key?f(k,1):k.la&&3!=k.la||f(k,0);break;case 60:e=c(k.element);-1==e.ue[1]&&-1==e.$e[1]?(l=e.ue[0]-e.gg[0],K=e.$e[0]-e.hg[0],m=Math.sqrt(l*l+K*K),
-1!=e.gg[1]&&-1!=e.hg[1]&&(N=e.ue[0]-e.gg[1],e=e.$e[0]-e.hg[1],g=Math.sqrt(N*N+e*e),g<m&&(l=N,K=e,m=g)),k.la=a.PL_SINGLE_TOUCH_MOVE):(K=E,K[0]=(e.ue[0]+e.ue[1])/2,K[1]=(e.$e[0]+e.$e[1])/2,m=W,m[0]=(e.gg[0]+e.gg[1])/2,m[1]=(e.hg[0]+e.hg[1])/2,l=K[0]-m[0],K=K[1]-m[1],m=Math.sqrt(l*l+K*K),k.la=a.PL_MULTITOUCH_MOVE_PAN);switch(k.axis){case "X":f(k,l);break;case "Y":f(k,K);break;case "XY":f(k,m)}break;case 70:e=c(k.element);e=e.Hs-e.Zw;k.la=a.PL_MULTITOUCH_MOVE_ZOOM;f(k,e);break;case 75:e=c(k.element);
-1!=e.ue[1]&&(l=Math.atan2(e.$e[0]-e.$e[1],e.ue[0]-e.ue[1]),k.la=a.PL_MULTITOUCH_MOVE_ROTATE,f(k,l-e.NC));break;case 80:e=c(k.element),e.rr?f(k,0):f(k,1)}for(h=0;h<P.length;h++)for(l=P[h],k=l.Lk,e=0;e<k.length;e++)if(K=k[e],K.jj!=L){K.jj=L;g=K;m=0;switch(g.type){case a.CT_POSITIVE:m=(N=t(g))?1:0;break;case a.CT_CONTINUOUS:m=g.wh;(N=t(g))?(m=1,g.wh=1):1==m?(m=-1,g.wh=-1):m=0;break;case a.CT_TRIGGER:m=g.wh;(N=t(g))&&-1==m?(m=1,g.wh=1):N||1!=m?m=0:(m=-1,g.wh=-1);break;case a.CT_SHOT:m=g.wh;(N=t(g))&&
-1==m?(m=1,g.wh=1):N||1!=m?m=0:(m=0,g.wh=-1);break;case a.CT_LEVEL:N=t(g);g.GA!=N?(m=1,g.GA=N):m=0;break;case a.CT_CHANGE:for(var N=g.Zi,g=g.RK,v=0;v<N.length;v++){var n=N[v].value;m||n==g[v]||(m=1);g[v]=n}break;default:H.r("Wrong sensor manifold type: "+g.type)}if(m&&(N=l==p?null:l,Z=!1,K.callback(N,K.id,m,K.IG),Z)){h=-1;break}}for(h=0;h<P.length;h++)for(l=P[h],k=l.Lk,e=0;e<k.length;e++)for(K=k[e],l=K.Zi,K=0;K<l.length;K++)switch(m=l[K],m.type){case 30:f(m,0);break;case 40:f(m,0);break;case 60:f(m,
0);break;case 70:f(m,0);break;case 75:f(m,0);break;case 80:f(m,0);break;case 140:f(m,0)}for(h=0;h<M.length;h++){k=M[h];if(!k.Vl){for(e=0;e<k.td.length;e++)1==k.td[e]?k.td[e]=2:3==k.td[e]&&(k.td[e]=0);k.Vl=!0}k.at=0;k.xv=k.cm;k.yv=k.dm;k.td[0]=!1;k.gg.set(k.ue);k.hg.set(k.$e);k.Zw=k.Hs;k.Tu=k.Zq;k.Su=k.Yq;k.Wq=k.Xq;k.dv=!1}L++};a.create_custom_sensor=function(a){var b=e(10);f(b,a);return b};a.create_keyboard_sensor=function(a){var b=e(20,document);b.key=a;b.Ia=!0;return b};a.create_gamepad_btn_sensor=
function(a,b){var c=e(240,document);b=b||r.Wz();c.fk=b;c.key=a;c.Ia=!0;return c};a.create_gamepad_axis_sensor=function(a,b){var c=e(250,document);b=void 0==b?r.Wz():b;c.fk=b;c.key=a;c.Ia=!0;return c};a.create_collision_sensor=function(a,b,c){if(!a||!F.ha(a))return B.error("Wrong collision object"),null;var d=e(90);d.Xt=a;d.Bb=b;d.sg=c;d.la={coll_obj:null,coll_pos:c?new Float32Array(3):null,coll_norm:c?new Float32Array(3):null,coll_dist:0};d.Wt=function(a,b,c,h,k){f(d,a);a=d.la;a.coll_obj=b;d.sg&&
(a.coll_pos.set(c),a.coll_norm.set(h),a.coll_dist=k)};d.Ia=!0;return d};a.create_collision_impulse_sensor=function(a){if(!a||!a.B)return B.error("Wrong collision impulse object"),null;var b=e(100);b.Vt=a;b.Qy=function(a){f(b,a)};b.Ia=!0;return b};a.create_ray_sensor=function(a,b,c,d,h,k,u){var K=e(110);K.Pg=a;K.from=b;K.to=c;K.Bb=d;K.qA=h;K.sg=k;K.hr=u;K.la={hit_fract:0,obj_hit:null,hit_time:0,hit_pos:new Float32Array(3),hit_norm:new Float32Array(3),Wo:0};K.DB=function(a,b,c,d,h,k){K.qA?f(K,-1==b?
0:1):f(K,b);K.la.hit_fract=b;K.la.obj_hit=c;K.la.hit_time=d;K.sg&&(K.la.hit_pos.set(h),K.la.hit_norm.set(k))};K.Ia=!0;return K};a.create_mouse_click_sensor=function(a){a=e(50,a);a.Ia=!0;return a};a.create_mouse_wheel_sensor=function(a){a=e(30,a);a.Ia=!0;return a};a.create_mouse_move_sensor=function(a,b){var c=e(40,b);c.axis=a||"XY";c.la="XY"==c.axis?new Float32Array(2):0;c.Ia=!0;return c};a.create_touch_move_sensor=function(a,b){var c=e(60,b);c.axis=a||"XY";c.la=0;c.Ia=!0;return c};a.create_touch_zoom_sensor=
function(a){a=e(70,a);a.la=0;a.Ia=!0;return a};a.create_touch_rotate_sensor=function(a){a=e(75,a);a.la=0;a.Ia=!0;return a};a.create_touch_click_sensor=function(a){a=e(80,a);a.la=0;a.Ia=!0;return a};a.create_motion_sensor=function(a,b,c){if(!a)return B.error("Wrong collision object"),null;var d=e(120);d.Pg=a;var h=A.get_trans_view(a.k.n);a=A.get_quat_view(a.k.n);d.BB=new Float32Array(4);d.Jm=new Float32Array(h);d.fs=new Float32Array(a);d.bq=0;d.aq=0;d.threshold=b||.1;d.KB=c||.1;d.Ze=0;d.la=new Float32Array([0,
0]);return d};a.create_vertical_velocity_sensor=function(a,b){if(!a)return B.error("Wrong collision object"),null;var c=e(130);c.Pg=a;var d=A.get_trans_view(a.k.n),h=A.get_quat_view(a.k.n);c.Jm=new Float32Array(d);c.fs=new Float32Array(h);c.cq=0;c.threshold=b||1;c.Ze=0;c.la=0;return c};a.create_timer_sensor=function(a,b){var c=e(140);c.Te=a;c.repeat=b;c.Ia=!0;return c};a.reset_timer_sensor=function(a,b,c,d){a=a||p;a=a.eg;if(!a||!a[b])return B.error("reset_timer_sensor(): wrong object"),null;b=a[b].Zi[c];
if(!b)return B.error("reset_timer_sensor(): sensor not found"),null;b.Ze=y.get_timeline();b.Te=d};a.create_elapsed_sensor=function(){var a=e(150);a.Ze=0;return a};a.create_gyro_delta_sensor=function(){var a=e(180,window);a.la=new Float32Array(3);r.get_device_by_type_element(r.DEVICE_GYRO)?f(a,1):f(a,0);a.Ia=!0;return a};a.create_gyro_angles_sensor=function(){var a=e(190,window);a.la=new Float32Array(3);r.get_device_by_type_element(r.DEVICE_GYRO)?f(a,1):f(a,0);a.Ia=!0;return a};a.create_gyro_quat_sensor=
function(){var a=e(200,window);a.la=D.create();r.get_device_by_type_element(r.DEVICE_GYRO)?f(a,1):f(a,0);a.Ia=!0;return a};a.create_hmd_quat_sensor=function(){var a=e(210,window);a.la=D.create();r.get_device_by_type_element(r.DEVICE_HMD)?f(a,1):f(a,0);a.Ia=!0;return a};a.create_hmd_position_sensor=function(){var a=e(220,window);a.la=w.create();r.get_device_by_type_element(r.DEVICE_HMD)?f(a,1):f(a,0);a.Ia=!0;return a};a.create_timeline_sensor=function(){return e(160)};a.create_selection_sensor=function(a,
b){var c=e(170);c.Pg=a;c.sz=b;c.Ia=!0;return c};a.create_callback_sensor=function(a,b){var c=e(230);c.callback=a;f(c,b);return c};a.CM=f;a.get_sensor_value=function(a,b,c){a=a||p;a=a.eg;if(!a||!a[b])return B.error("get_sensor_value(): wrong object"),null;b=a[b].Zi[c];return b?b.value:(B.error("get_sensor_value(): sensor not found"),null)};a.get_sensor_payload=function(a,b,c){a=a||p;a=a.eg;if(!a||!a[b])return B.error("get_sensor_payload(): wrong object"),null;b=a[b].Zi[c];return b?b.la:(B.error("get_sensor_payload(): sensor not found"),
null)};a.cleanup=function(){P=[];p={};for(var a=0;a<z.length;a++)m(z[a]);z.length=0;l.length=0};a.check_sensor_manifold=function(a,b){a=a||p;if(!a.eg)return!1;if(b&&a.eg[b])return!0;if(!b)for(var c in a.eg)return!0;return!1};a.create_sensor_manifold=function(a,d,h,k,e,u,f){a=a||p;a.Lk=a.Lk||[];a.eg=a.eg||{};var K=a.eg,N=a.Lk;K[d]&&g(a,d);h={id:d,type:h,Zi:k.slice(0),mL:e,DM:Array(k.length),callback:u,IG:f,wh:-1,GA:0,RK:Array(k.length),jj:-1};K[d]=h;N.push(h);-1==P.indexOf(a)&&P.push(a);k=h.Zi;for(a=
0;a<k.length;a++){K=d=k[a];if(K.Ia){switch(K.type){case 90:F.append_collision_test(K.Xt,K.Bb,K.Wt,K.sg);break;case 100:F.apply_collision_impulse_test(K.Vt,K.Qy);break;case 110:K.Wo=F.append_ray_test(K.Pg,K.from,K.to,K.Bb,K.DB,!1,!1,K.sg,K.hr);K.la.Wo=K.Wo;break;case 140:K.Ze=y.get_timeline();0>K.Te&&(K.Te=-K.Te);break;case 20:N=c(K.element);b(N,"keyboard_downed_keys");break;case 30:N=c(K.element);b(N,"mouse_wheel");break;case 40:N=c(K.element);b(N,"mouse_down_which");b(N,"mouse_up_which");b(N,"mouse_location");
break;case 50:N=c(K.element);b(N,"mouse_down_which");b(N,"mouse_up_which");break;case 60:N=c(K.element);b(N,"touch_start");b(N,"touch_move");b(N,"touch_end");break;case 70:N=c(K.element);b(N,"touch_start");b(N,"touch_move");break;case 75:N=c(K.element);b(N,"touch_start");b(N,"touch_move");break;case 80:N=c(K.element);b(N,"touch_start");b(N,"touch_end");break;case 170:N=c(K.element);b(N,"mouse_select");b(N,"touch_select");b(N,"touch_start");b(N,"touch_end");b(N,"mouse_down_which");b(N,"mouse_up_which");
break;case 180:case 190:N=c(K.element);b(N,"orientation_angles");break;case 200:N=c(K.element);b(N,"orientation_quat");break;case 240:0==K.fk?r.get_device_by_type_element(r.Fp):1==K.fk?r.get_device_by_type_element(r.kt):2==K.fk?r.get_device_by_type_element(r.lt):r.get_device_by_type_element(r.mt)}K.Ia=!1}K=z.indexOf(d);-1==K?(z.push(d),l.push([h])):l[K].push(h)}Z=!0};a.hz=function(a){for(var b=0;b<a.length;b++)if(!a[b])return a[b];return a[a.length-1]};a.iz=function(a){for(var b=0;b<a.length;b++)if(a[b])return a[b];
return a[a.length-1]};a.remove_sensor_manifold=g;a.reset=function(){for(var a=0;a<P.length;a++){var b=P[a],c=b.eg,b=b.Lk,d;for(d in c)delete c[d];b.length=0}for(a=0;a<z.length;a++)m(z[a]);P.length=0;z.length=0;l.length=0};a.debug=function(){B.log(String(P.length)+" objects with manifolds",P);B.log(String(z.length)+" sensors",z);for(var a=[],b=[],c=0;c<z.length;c++){var d=z[c];90==d.type&&a.push(d);110==d.type&&b.push(d)}B.log(String(a.length)+" collision sensors",a);B.log(String(b.length)+" ray sensors",
b)}};b4w.module.__curve=function(a,q){function e(a,b,c,d,k){var e=d.length;k||(k=new Float32Array(e));for(var f=e+a,g=new Float32Array(f),n=1;n<=f-1;n++)g[n-1]=b>=c[n-1]&&b<c[n+1-1]?1:0;for(var t=2;t<=a;t++)for(n=1;n<=f-t;n++)g[n-1]=(0!=g[n-1]?(b-c[n-1])*g[n-1]/(c[n+t-1-1]-c[n-1]):0)+(0!=g[n+1-1]?(c[n+t-1]-b)*g[n+1-1]/(c[n+t-1]-c[n+1-1]):0);b==c[f-1]&&(g[e-1]=1);a=0;for(n=1;n<=e;n++)a+=g[n-1]*d[n-1];for(n=1;n<=e;n++)k[n-1]=0!=a?g[n-1]*d[n-1]/a:0;return k}function c(a){a=a.vr;return a[a.length-1]}function b(a){a=
a.dz;return a[a.length-1]}function n(a,b,c,d,k,e,g,t){var q=a+(b-a)/2,D=f(q,d,k,e,g)-c;t=t?t:.01;return Math.abs(D)<t?q:0<D?n(a,q,c,d,k,e,g,t):n(q,b,c,d,k,e,g,t)}function f(a,b,c,d,k){var e=1-a;return b*e*e*e+3*c*e*e*a+3*d*e*a*a+k*a*a*a}q("__print");var t=q("__util"),g=q("__vec3");a.SH=function(a){var b={},c=a.data;a=c.splines[0];if(!a||"NURBS"!=a.type||!a.use_endpoint_u)return null;var d=a.order_u;b.Mi=d;a=a.points;var k=a.length/5,f=[],g=k+d,k=k+2;f[0]=0;for(var n=2;n<=g;n++)f[n-1]=n>d&&n<k?f[n-
2]+1:f[n-2];b.vr=f;"2D"==c.dimensions?b.Ai=!1:"3D"==c.dimensions?b.Ai=!0:t.r("Wrong curve dimensions");d=[];f=[];for(c=0;c<a.length;c+=5)d.push(a[c]),d.push(a[c+1]),d.push(a[c+2]),b.Ai&&d.push(a[c+3]),f.push(a[c+4]);b.bu=d;b.px=f;a=[];for(var c=b.bu,d=b.Ai?4:3,f=b.px,g=b.vr,k=b.Mi,n=c.length/d,q=n+k,D=0,y=g[q-1]/999,A=0;1E3>A;A++){5E-6>g[q-1]-D&&(D=g[q-1]);for(var H=e(k,D,g,f),w=0;w<d;w++)for(var h=a[d*A+w]=0;h<n;h++)a[d*A+w]+=H[h]*c[d*h+w];D+=y}d=b.Ai?4:3;f=new Float32Array(1E3);f[0]=0;for(c=1;1E3>
c;c+=1)g=a[(c-1)*d],k=a[(c-1)*d+1],n=a[(c-1)*d+2],q=a[c*d],D=a[c*d+1],y=a[c*d+2],f[c]=f[c-1]+Math.sqrt((q-g)*(q-g)+(D-k)*(D-k)+(y-n)*(y-n));b.dz=f;return b};a.KN=function(a,b,f){f||(f=[]);var d=b,k=Math.max(d,0);b=k=Math.min(d,c(a));var d=a.bu,k=a.Ai?4:3,r=a.px,g=a.vr,n=a.Mi;a=d.length/k;var t=a+n;5E-6>g[t-1]-b&&(b=g[t-1]);t=new Float32Array(a);e(n,b,g,r,t);for(b=0;b<k;b++)for(r=f[b]=0;r<a;r++)f[b]+=t[r]*d[k*r+b]};a.HN=function(a,b,c){c||(c=[]);var d=a.bu,k=a.Ai?4:3,e=a.px,f=a.vr,g=a.Mi;a=d.length/
k;var n=a+g;5E-6>f[n-1]-b&&(b=f[n-1]);var n=new Float32Array(a),t=b;b=n;var y=e.length;b||(b=new Float32Array(y));var A=new Float32Array(y),q=new Float32Array(y),w=A,h=q;w||(w=new Float32Array(y));h||(h=new Float32Array(y));for(var u=y+g,P=new Float32Array(u),p=new Float32Array(u),z=1;z<=u-1;z++)P[z-1]=t>=f[z-1]&&t<f[z+1-1]?1:0;t==f[u-1]&&(P[y-1]=1);for(var l=2;l<=g;l++)for(z=1;z<=u-l;z++){var M=0!=P[z-1]?P[z-1]/(f[z+l-1-1]-f[z-1]):0,E=0!=P[z+1-1]?-P[z+1-1]/(f[z+l-1]-f[z+1-1]):0,W=0!=p[z-1]?(t-f[z-
1])*p[z-1]/(f[z+l-1-1]-f[z-1]):0,G=0!=p[z+1-1]?(f[z+l-1]-t)*p[z+1-1]/(f[z+l-1]-f[z+1-1]):0;P[z-1]=(0!=P[z-1]?(t-f[z-1])*P[z-1]/(f[z+l-1-1]-f[z-1]):0)+(0!=P[z+1-1]?(f[z+l-1]-t)*P[z+1-1]/(f[z+l-1]-f[z+1-1]):0);p[z-1]=M+E+W+G}for(z=1;z<=y;z++)w[z-1]=P[z-1],h[z-1]=p[z-1];f=0;for(g=1;g<=y;g++)f+=A[g-1]*e[g-1];t=0;for(g=1;g<=y;g++)t+=q[g-1]*e[g-1];for(g=1;g<=y;g++)b[g-1]=0!=f?q[g-1]*e[g-1]/f+A[g-1]*e[g-1]*t/(f*f):0;for(e=0;e<k;e++)for(f=c[e]=0;f<a;f++)c[e]+=n[f]*d[k*f+e]};a.UR=c;a.JN=b;a.IN=function(a,
e){if(0>=e)return 0;var f=c(a);if(e>=b(a))return f;var d=a.dz,k=t.dq(d,e,0,d.length-1);return f*(k+(e-d[k])/(d[k+1]-d[k]))/1E3};a.yr=function(a,b,c,d,k){return c+(k-d)*(a-c)/(b-d)};a.LA=function(a,b,c){var d=b[0];b=b[1];c=(c[1]-b)/(c[0]-d);return c*a+(b-c*d)};a.ky=function(a,b,c,d,k,e){return f(n(0,1,a,b[0],c[0],d[0],k[0],e),b[1],c[1],d[1],k[1])};a.Nt=function(a,b,c,d,k){var e=new Float32Array(3),f=new Float32Array(3),n=new Float32Array(3),t=new Float32Array(3),q=new Float32Array(3),y=new Float32Array(3);
g.copy(a[1],f);null==b?(g.copy(c[1],n),e[0]=2*f[0]-n[0],e[1]=2*f[1]-n[1]):g.copy(b[1],e);null==c?(g.copy(b[1],e),n[0]=2*f[0]-e[0],n[1]=2*f[1]-e[1]):g.copy(c[1],n);g.subtract(f,e,t);g.subtract(n,f,q);b=g.length(t);c=g.length(q);0==b&&(b=1);0==c&&(c=1);if("AUTO"==d||"AUTO"==k)y[0]=q[0]/c+t[0]/b,y[1]=q[1]/c+t[1]/b,e=2.5614*g.length(y),0!=e&&("AUTO"==d&&g.scaleAndAdd(f,y,-(b/e),a[0]),"AUTO"==k&&g.scaleAndAdd(f,y,c/e,a[2]));"VECTOR"==d&&g.scaleAndAdd(f,t,-1/3,a[0]);"VECTOR"==k&&g.scaleAndAdd(f,q,1/3,a[2])};
a.oH=function(a,b,c,d){var k=[],e=[],f,g,n;k[0]=a[0]-b[0];k[1]=a[1]-b[1];e[0]=d[0]-c[0];e[1]=d[1]-c[1];n=d[0]-a[0];f=Math.abs(k[0]);g=Math.abs(e[0]);0!=f+g&&f+g>n&&(f=n/(f+g),b[0]=a[0]-f*k[0],b[1]=a[1]-f*k[1],c[0]=d[0]-f*e[0],c[1]=d[1]-f*e[1])}};b4w.module.__debug=function(a,q){function e(a){a=a.split("\n");for(var b=0;b<a.length;b++)a[b]=b+1+" "+a[b];return a=a.join("\n")}function c(){var a=x.Ju();if(a){var b=a.createQueryEXT();a.beginQueryEXT(a.TIME_ELAPSED_EXT,b)}else b=performance.now();return b}function b(){var b=P;return b&&b.debug_view_mode==a.DV_RENDER_TIME}function n(a,b,c){var d=x.Ju(),h=0;if(d)for(c&&d.endQueryEXT(d.TIME_ELAPSED_EXT),c=0;c<a.length;c++){var k=a[c],e=d.getQueryObjectEXT(k,d.QUERY_RESULT_AVAILABLE_EXT),f=A.getParameter(d.GPU_DISJOINT_EXT);
e&&!f&&(h=d.getQueryObjectEXT(k,d.QUERY_RESULT_EXT)/1E6,b&&(h=F.smooth(h,b,1,10)),a.splice(c,1),c--)}else h=performance.now()-a.pop(),b&&(h=F.smooth(h,b,1,10));return h}function f(a,b){t(a)||F.r("Structure assertion failed: invalid first object value");t(b)||F.r("Structure assertion failed: invalid second object value");g(a,b)||F.r("Structure assertion failed: incompatible types");if(!(null==a||null==b||"object"!=typeof a||F.cv(a)||a instanceof Array)){for(var c in a)t(a[c])||F.r("Structure assertion failed: invalid value for key in the first object: "+
c),c in b||F.r("Structure assertion failed: missing key in the first object: "+c);for(c in b)t(b[c])||F.r("Structure assertion failed: invalid value for key in the second object: "+c),c in a||F.r("Structure assertion failed: missing key in the second object: "+c),g(a[c],b[c])||F.r("Structure assertion failed: incompatible types for key "+c)}}function t(a){return"undefined"==typeof a?!1:"number"==typeof a&&isNaN(a)?!1:!0}function g(a,b){if(typeof a!=typeof b)return!1;if(null!=a&&null!=b&&"object"==
typeof a){var c=a instanceof Array,d=b instanceof Array;if(c&&!d||!c&&d)return!1;c=F.cv(a);d=F.cv(b);if(c&&!d||!c&&d)return!1}return!0}var m=q("__compat"),v=q("__config"),x=q("__extensions"),d=q("__graph"),k=q("__print"),r=q("__subscene"),C=q("__textures"),B=q("__time"),F=q("__util"),D=v.v,y={},A=null,H={},w=[],h=-1,u=-1,P=null,p=null,z=!1;a.DV_NONE=0;a.DV_OPAQUE_WIREFRAME=1;a.DV_TRANSPARENT_WIREFRAME=2;a.DV_FRONT_BACK_VIEW=3;a.DV_BOUNDINGS=4;a.DV_CLUSTERS_VIEW=5;a.DV_BATCHES_VIEW=6;a.DV_RENDER_TIME=
7;a.Ue=function(a){var b="INVALID_ENUM INVALID_VALUE INVALID_OPERATION OUT_OF_MEMORY INVALID_FRAMEBUFFER_OPERATION CONTEXT_LOST_WEBGL".split(" "),c;for(c in b){var d=b[c];d in a&&(y[a[d]]=d)}A=a};a.IM=function(a){P=a};a.SQ=function(){return P};a.Qt=function(a){if(D.gl_debug){var b=A.getError();b!=A.NO_ERROR&&(b in y?F.r("GL Error: "+b+", gl."+y[b]+" ("+a+")"):F.r("Unknown GL error: "+b+" ("+a+")"))}};a.QG=function(){if(D.gl_debug||D.Fy)switch(A.checkFramebufferStatus(A.FRAMEBUFFER)){case A.FRAMEBUFFER_COMPLETE:break;
case A.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:k.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_ATTACHMENT");break;case A.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:k.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT");break;case A.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:k.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_DIMENSIONS");break;case A.FRAMEBUFFER_UNSUPPORTED:k.error("Incomplete framebuffer: FRAMEBUFFER_UNSUPPORTED");break;case A.MP:k.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_MULTISAMPLE");
break;default:k.error("FRAMEBUFFER CHECK FAILED")}};a.UG=function(){if(-1!=h)return h;A.bindFramebuffer(A.FRAMEBUFFER,A.createFramebuffer());var a=C.On("DEBUG",C.ll);C.resize(a,1,1);A.framebufferTexture2D(A.FRAMEBUFFER,A.DEPTH_ATTACHMENT,a.Wa,a.Za,0);A.checkFramebufferStatus(A.FRAMEBUFFER)!=A.FRAMEBUFFER_COMPLETE?(h=!0,k.warn("depth-only issue was found")):h=!1;A.bindFramebuffer(A.FRAMEBUFFER,null);return h};a.ZG=function(){if(1==D.lc)return!1;if(-1!=u)return u;A.bindRenderbuffer(A.RENDERBUFFER,A.createRenderbuffer());
A.renderbufferStorageMultisample(A.RENDERBUFFER,D.lc,A.RGBA8,1,1);var a=A.getRenderbufferParameter(A.RENDERBUFFER,A.RENDERBUFFER_SAMPLES);a!=D.lc?(u=!0,k.warn("multisample issue was found: requested "+D.lc+", got "+a),A.getError()==A.INVALID_OPERATION&&k.warn("the error from multisample issue detected, ignoring")):u=!1;A.bindRenderbuffer(A.RENDERBUFFER,null);return u};a.WG=function(){return m.Rt("Firefox")&&A.getError()==A.OUT_OF_MEMORY?(k.warn("Firefox/old GPUs cubemap issue was found."),!0):!1};
a.GB=function(a,b,c){D.gl_debug&&(c=e(c),k.error("shader compilation failed:\n"+c+"\n"+A.getShaderInfoLog(a)+" ("+b+")"))};a.rM=function(a,b,c,d){D.gl_debug&&(c=e(c),d=e(d),k.error("shader linking failed:\n"+c+"\n\n\n"+d+"\n"+A.getProgramInfoLog(a)+" ("+b+")"))};a.dw=function(a){if(D.show_hud_debug_info||a.type==r.an)a.uu||a.Uj.push(c())};a.mM=function(a){"MAIN"==a.type&&b()&&a.Uj.push(c())};a.ew=function(a){if((D.show_hud_debug_info||a.type==r.an)&&!a.uu){var b=n(a.Uj,a.Ie,!0);b&&(a.Ie=b)}};a.nM=
function(a){if("MAIN"==a.type&&b()){var c=n(a.Uj,a.Ie,!0);c&&(a.Ie=c)}};a.uA=b;a.bM=function(a){var b=n(a.Uj,a.Ie,!1);b&&(a.Ie=b)};a.CQ=function(a){H[a]=a in H?H[a]+1:1};a.update=function(){for(var a in H)k.log(a,H[a]),H[a]=0};a.fbmsg=function(){for(var a=[performance.now()],b=0;b<arguments.length;b++){var c=arguments[b];if(F.is_vector(c))for(var d=0;d<c.length;d++)a.push(c[d]);else a.push(arguments[b])}w.push(a)};a.msg=function(){for(var a=1,b=0;b<w.length;b++){var c=w[b];c[1]==arguments[0]&&a++}c=
[a];for(b=0;b<arguments.length;b++)if(a=arguments[b],F.is_vector(a))for(var d=0;d<a.length;d++)c.push(a[d]);else c.push(arguments[b]);w.push(c)};var l=["color: #3366FF","color: #CC33FF","color: #FF3366","color: #33FF66","color: #FFCC33"];a.print_telemetry=function(a){a||(a=1);for(var b=0,c={},d=Math.max(0,performance.now()-1E3*a),h=0;h<w.length;h++){var e=w[h];a=e[0];if(!(a<d)){var f=String(e[1]);c[f]||(c[f]=l[b++%l.length]);a=["%c"+(a/1E3).toFixed(6),c[f],f];for(f=2;f<e.length;f++)a.push(e[f]);k.log.apply(this,
a)}}w.splice(0)};a.plot_telemetry=function(a){a||(a=1);for(var b={},c=Math.max(0,performance.now()-1E3*a),d=0;d<w.length;d++){var h=w[d];a=h[0];if(!(a<c))for(var e=2;e<h.length;e++){var f=String(h[1]);3<h.length&&(f+="_"+String(e-2));b[f]||(b[f]=f+"\n");b[f]+=String(a)+" "+h[e]+"\n"}}a="";for(f in b)a+=b[f]+"\n\n";k.log(a);w.splice(0)};a.kQ=function(a){function b(a){return-1<c.indexOf(a)?!0:!1}var c=navigator.userAgent.toLowerCase();switch(a.toLowerCase()){case "chrome":return b("mozilla")&&b("applewebkit")&&
b("chrome");case "firefox":return b("mozilla")&&b("gecko")&&b("firefox");case "msie":return b("mozilla")&&b("trident")&&b("msie");case "opera":return b("opera")&&b("presto");case "safari":return b("mozilla")&&b("applewebkit")&&b("safari")&&!b("chrome");default:return!1}};a.check_finite=function(a){if(F.is_vector(a)){for(var b=0;b<a.length;b++)if(!isFinite(a[b]))return!1;return Boolean(a.length)}return isFinite(a)?!0:!1};a.$P=function(a,b){a.constructor!=b&&F.r("Type assertion failed: value <"+a+"> has type <"+
a.constructor+">, required <"+b+">")};a.aQ=f;a.bQ=function(a){z?f(a,p):z=!0;p=F.Fn(a)};a.fake_load=function(a,b,c,d,h){(a=a||null)||F.r("Stage load callback is undefined");b=b||5E3;c=c||0;d=d||100;100<d&&F.r("Max percentage must be less than 100");0>c&&F.r("Min percentage must be greater than 0");c>d&&F.r("Max percentage must be greater than min percentage");var k=B.animate(c,d,b,function(b){b=b.toFixed();a(b);100==b&&(B.clear_animation(k),h&&h())})};a.CR=function(a){return d.CI(a,function(a,b){var c=
b.type+"("+b.name+")",d=b.K,c=c+"\n\nINPUTS:";if(d.length)for(var h=0;h<d.length;h++)c+="\n"+d[h].identifier+": ",c=d[h].xc?c+"linked":c+d[h].jb;else c+="\n---";d=b.Ya;c+="\n\nOUTPUTS:";if(d.length)for(h=0;h<d.length;h++)c+="\n"+d[h].identifier+": ",c=d[h].xc?c+("linked(default "+d[h].jb+")"):c+"not used";else c+="\n---";h="";switch(b.type){case "GEOMETRY_UV":h="\nuv_layer: "+b.data.value;break;case "TEXTURE_COLOR":case "TEXTURE_NORMAL":h="\ntexture: "+b.data.value.name+"\n("+b.data.value.kR.zg+")"}""==
h&&(h="\n---");return c=c+"\n\nDATA:"+h},function(b,c,h){b=d.Sa(a,b);c=d.Sa(a,c);return b.Ya[h[0]].identifier+"\n==>\n"+c.K[h[1]].identifier})};a.Rq=function(){return A};a.cleanup=function(){P=null};a.reset=function(){A=null}};b4w.module.__extensions=function(a,q){function e(a){if(a in g)return g[a];var b=t.getExtension(a)||null;g[a]=b;n.log("%cGET EXTENSION","color: #"+(b?"0a0":"a00"),a);return b}function c(a){if(a in g)return g[a];switch(a){case "WEBGL_depth_texture":case "OES_element_index_uint":case "OES_standard_derivatives":var b={};break;case "ANGLE_instanced_arrays":case "OES_vertex_array_object":b=t}g[a]=b;n.log("%cGET EXTENSION (WebGL 2)","color: #"+(b?"0a0":"a00"),a);return b}var b=q("__config"),n=q("__print"),
f=b.v,t=null,g={};a.Ue=function(a){t=a};a.aA=function(){return e("WEBGL_compressed_texture_s3tc")||e("WEBKIT_WEBGL_compressed_texture_s3tc")||e("MOZ_WEBGL_compressed_texture_s3tc")};a.$z=function(){return e("WEBKIT_WEBGL_compressed_texture_pvrtc")||e("WEBGL_compressed_texture_pvrtc")};a.UJ=function(){return f.Vb?c("WEBGL_depth_texture"):e("WEBGL_depth_texture")||e("WEBKIT_WEBGL_depth_texture")||e("MOZ_WEBGL_depth_texture")};a.MJ=function(){return e("EXT_texture_filter_anisotropic")||e("WEBKIT_EXT_texture_filter_anisotropic")||
e("MOZ_EXT_texture_filter_anisotropic")};a.TJ=function(){return e("WEBGL_debug_shaders")};a.get_renderer_info=function(){return e("WEBGL_debug_renderer_info")};a.Vz=function(){return f.Vb?c("OES_element_index_uint"):e("OES_element_index_uint")};a.cA=function(){return f.Vb?c("OES_standard_derivatives"):e("OES_standard_derivatives")};a.Ju=function(){return e("EXT_disjoint_timer_query")};a.dK=function(){if(f.Vb)return c("ANGLE_instanced_arrays");var a=e("ANGLE_instanced_arrays");return null==a?a:{drawElementsInstanced:function(b,
c,d,k,e){a.drawElementsInstancedANGLE(b,c,d,k,e)},vertexAttribDivisor:function(b,c){a.vertexAttribDivisorANGLE(b,c)},drawArraysInstanced:function(b,c,d,k){a.drawArraysInstancedANGLE(b,c,d,k)}}};a.Qu=function(){if(f.Vb)return c("OES_vertex_array_object");var a=e("OES_vertex_array_object");return null==a?a:{bindVertexArray:function(b){a.bindVertexArrayOES(b)},createVertexArray:function(){return a.createVertexArrayOES()},deleteVertexArray:function(b){a.deleteVertexArrayOES(b)},isVertexArray:function(b){return a.isVertexArrayOES(b)}}};
a.cleanup=function(){g={}};a.reset=function(){t=null}};b4w.module.__graph=function(a,q){function e(a,b,d){d||(d=null);c(a,b)?M.r("Graph already has node with given ID"):a.O.push(b,d)}function c(a,b){for(var c=a.O,d=0;d<c.length;d+=2)if(c[d]==b)return!0;return!1}function b(a,b,d,h){h||(h=null);c(a,b)&&c(a,d)?a.Ca.push(b,d,h):M.r("Wrong node IDs")}function n(a,b){c(a,b)||M.r("Node not found");for(var d=a.O,h=0;h<d.length;h+=2)d[h]==b&&(d.splice(h,2),h-=2)}function f(a,b,c,d){P(a,b,c)||M.r("Edge not found");a=a.Ca;for(var h=0,k=0;k<a.length;k+=3)if(a[k]==
b&&a[k+1]==c){if(-1==d)a.splice(k,3);else{if(d==h){a.splice(k,3);break}h++}k-=3}}function t(a){a=a.O;for(var b=-1,c=0;c<a.length;c+=2)b=Math.max(b,a[c]);return++b}function g(a,b){for(var c=a.O,d=0;d<c.length;d+=2)if(c[d+1]==b)return c[d];return-1}function m(a){var b=[],c={};v(a,c);for(var d=a.O,h=0;h<d.length;h+=2)0==w(a,d[h])&&x(a,d[h],c,b);return{O:b,Ca:a.Ca.slice(0)}}function v(a,b){for(var c=a.O,d=0;d<c.length;d+=2)b[c[d]]=!1}function x(a,b,c,d){if(!c[b]){c[b]=!0;for(var k=0;k<H(a,b);k++)x(a,
h(a,b,k),c,d);d.unshift(b,A(a,b))}}function d(a,b,c,k){if(!c[b]){c[b]=!0;if(10==k||30==k)for(var e=0;e<H(a,b);e++){var f=h(a,b,e);d(a,f,c,k)}if(20==k||30==k)for(e=0;e<w(a,b);e++)f=u(a,b,e),d(a,f,c,k)}}function k(a){for(var b=a.Ca,d=0;d<b.length;d+=3){var h=b[d+1];c(a,b[d])&&c(a,h)||(b.splice(d,3),d-=3)}}function r(a){for(var b=[],c=a.O,d=0;d<c.length;d+=2){var h=c[d];H(a,h)||b.push(h)}return b}function C(a){var b=a.O;a=a.Ca;for(var c=[],d=[],h=[],k=0;k<b.length;k++)h[b[2*k]]=k,c.push(k,b[2*k+1]);
for(k=0;k<a.length;k+=3)d.push(h[a[k]],h[a[k+1]],a[k+2]);return{O:c,Ca:d}}function B(a,b,c){if(c.tg==c.Ji){for(var d=0,k=0;d<c.Ji;d++)-1!=c.kh[d]&&(a[k]=d,b[k]=c.kh[d],k++);return!0}if(c.Ji>c.fm||c.ej>c.fj||c.Em>c.Gm||c.Dm>c.Fm)return!1;for(var k=d=-1,e=!1;!e&&F(c,E,d,k);)if(d=E[0],k=E[1],D(c,d,k)){var f;f=c;e={};e.jo=f.jo;e.ko=f.ko;e.Iv=f.Iv;e.Cq=f.Cq;e.Ji=f.Ji;e.fm=f.fm;e.Mi=f.Mi;e.tg=e.Rr=f.tg;e.Dm=f.Dm;e.Em=f.Em;e.ej=f.ej;e.Fm=f.Fm;e.Gm=f.Gm;e.fj=f.fj;e.fn=-1;e.kh=f.kh;e.Qj=f.Qj;e.lk=f.lk;e.mk=
f.mk;e.Bk=f.Bk;e.Ck=f.Ck;e.ts=f.ts;f.ts[0]+=1;var e=f=e,l=d,p=k,g=e.jo,r=e.ko,z=e.Ji,K=e.fm,N=e.kh,m=e.Qj,n=e.lk,v=e.mk,x=e.Bk,A=e.Ck;y(l<z);y(p<K);y(e.tg<z);y(e.tg<K);z=++e.tg;e.fn=l;n[l]||(n[l]=z,e.Dm++,x[l]&&e.ej++);x[l]||(x[l]=z,e.Em++,n[l]&&e.ej++);v[p]||(v[p]=z,e.Fm++,A[p]&&e.fj++);A[p]||(A[p]=z,e.Gm++,v[p]&&e.fj++);N[l]=p;m[p]=l;for(N=0;N<w(g,l);N++)m=u(g,l,N),n[m]||(n[m]=z,e.Dm++,x[m]&&e.ej++);for(N=0;N<H(g,l);N++)m=h(g,l,N),x[m]||(x[m]=z,e.Em++,n[m]&&e.ej++);for(N=0;N<w(r,p);N++)m=u(r,p,
N),v[m]||(v[m]=z,e.Fm++,A[m]&&e.fj++);for(N=0;N<H(r,p);N++)m=h(r,p,N),A[m]||(A[m]=z,e.Gm++,v[m]&&e.fj++);e=B(a,b,f);y(1>=f.tg-f.Rr);y(-1!=f.fn);m=f.jo;l=f.ko;p=f.tg;g=f.fn;r=f.kh;n=f.Qj;z=f.lk;v=f.mk;K=f.Bk;x=f.Ck;if(f.Rr<p){z[g]==p&&(z[g]=0);for(A=0;A<w(m,g);A++)N=u(m,g,A),z[N]==p&&(z[N]=0);K[g]==p&&(K[g]=0);for(A=0;A<H(m,g);A++)N=h(m,g,A),K[N]==p&&(K[N]=0);m=r[g];v[m]==p&&(v[m]=0);for(A=0;A<w(l,m);A++)N=u(l,m,A),v[N]==p&&(v[N]=0);x[m]==p&&(x[m]=0);for(A=0;A<H(l,m);A++)N=h(l,m,A),x[N]==p&&(x[N]=
0);r[g]=-1;n[m]=-1;f.tg=f.Rr;f.fn=-1}}return e}function F(a,b,c,d){-1==c&&(c=0);-1==d?d=0:d++;var h=a.ej,k=a.fj,e=a.Em,f=a.Gm,u=a.Dm,l=a.Fm,p=a.tg,g=a.Ji,K=a.fm,N=a.kh,r=a.Qj,z=a.lk,w=a.mk,m=a.Bk,n=a.Ck;if(h>p&&k>p)for(;c<g&&(-1!=N[c]||0==m[c]||0==z[c]);)c++,d=0;else if(e>p&&f>p)for(;c<g&&(-1!=N[c]||0==m[c]);)c++,d=0;else if(u>p&&l>p)for(;c<g&&(-1!=N[c]||0==z[c]);)c++,d=0;else if(0==c&&0!=a.Mi){for(z=0;z<g&&-1!=N[c=a.Mi[z]];)z++;z==g&&(c=g)}else for(;c<g&&-1!=N[c];)c++,d=0;if(h>p&&k>p)for(;d<K&&(-1!=
r[d]||0==n[d]||0==w[d]);)d++;else if(e>p&&f>p)for(;d<K&&(-1!=r[d]||0==n[d]);)d++;else if(u>p&&l>p)for(;d<K&&(-1!=r[d]||0==w[d]);)d++;else for(;d<K&&-1!=r[d];)d++;return c<g&&d<K?(b[0]=c,b[1]=d,!0):!1}function D(a,b,c){var d=a.jo,k=a.ko,e=a.fm,f=a.kh,l=a.Qj,g=a.lk,r=a.mk,z=a.Bk,m=a.Ck;y(b<a.Ji);y(c<e);y(-1==f[b]);y(-1==l[c]);if(!(0,a.Iv)(A(d,b),A(k,c)))return!1;for(var K=e=0,N=0,n=0,v=0,x=0,t=0;t<H(d,b);t++){var B=h(d,b,t);if(-1!=f[B]){var M=f[B];if(!P(k,c,M)||!p(a.Cq,d,b,B,k,c,M))return!1}else g[B]&&
N++,z[B]&&e++,g[B]||z[B]||v++}for(t=0;t<w(d,b);t++)if(B=u(d,b,t),-1!=f[B]){if(M=f[B],!P(k,M,c)||!p(a.Cq,d,B,b,k,M,c))return!1}else g[B]&&N++,z[B]&&e++,g[B]||z[B]||v++;for(t=0;t<H(k,c);t++)if(M=h(k,c,t),-1!=l[M]){if(B=l[M],!P(d,b,B))return!1}else r[M]&&n++,m[M]&&K++,r[M]||m[M]||x++;for(t=0;t<w(k,c);t++)if(M=u(k,c,t),-1!=l[M]){if(B=l[M],!P(d,B,b))return!1}else r[M]&&n++,m[M]&&K++,r[M]||m[M]||x++;return N<=n&&e<=K&&v<=x}function y(a){a||M.r("Assertion failed")}function A(a,b){for(var c=a.O,d=0;d<c.length;d+=
2)if(c[d]==b)return c[d+1];return null}function H(a,b){for(var c=a.Ca,d=0,h=0;h<c.length;h+=3)c[h]==b&&d++;return d}function w(a,b){for(var c=a.Ca,d=0,h=0;h<c.length;h+=3)c[h+1]==b&&d++;return d}function h(a,b,c){a=a.Ca;for(var d=0,h=0;h<a.length;h+=3)if(a[h]==b){if(d==c)return a[h+1];d++}return-1}function u(a,b,c){a=a.Ca;for(var d=0,h=0;h<a.length;h+=3)if(a[h+1]==b){if(d==c)return a[h];d++}return-1}function P(a,b,c){a=a.Ca;for(var d=0;d<a.length;d+=3)if(a[d]==b&&a[d+1]==c)return!0;return!1}function p(a,
b,c,d,h,k,e){for(var f=z(b,c,d),u=z(h,k,e),p=0;p<f;p++){for(var g=!1,r=0;r<u;r++)if(a(l(b,c,d,p),l(h,k,e,r))){g=!0;break}if(!g)return!1}return!0}function z(a,b,c){var d=0;a=a.Ca;for(var h=0;h<a.length;h+=3)a[h]==b&&a[h+1]==c&&d++;return d}function l(a,b,c,d){a=a.Ca;for(var h=0,k=0;k<a.length;k+=3)if(a[k]==b&&a[k+1]==c){if(h==d)return a[k+2];h++}return null}q("__print");var M=q("__util"),E=[-1,-1];a.qt=-1;a.LP=10;a.Ep=20;a.SP=30;a.create=function(){for(var a=arguments,b=[],c=[],d=0;d<a.length;d++){var h=
a[d];switch(h.length){case 2:b.push(h[0],h[1]);break;case 3:c.push(h[0],h[1],h[2]);break;default:M.r("Wrong graph constructor params")}}return{O:b,Ca:c}};a.clone=function(a,b,c){if(b)for(var d=Array(a.O.length),h=0;h<a.O.length;h+=2)d[h]=a.O[h],d[h+1]=b(a.O[h+1]);else d=M.L(a.O);if(c)for(b=Array(a.Ca.length),h=0;h<a.Ca.length;h+=3)b[h]=a.Ca[h],b[h+1]=a.Ca[h+1],b[h+2]=c(a.Ca[h+2]);else b=M.L(a.Ca);return a={O:d,Ca:b}};a.uQ=function(a,b){for(var c=[],d=[],h=0;h<a.length;h++)c.push(a[h][0],a[h][1]);
for(h=0;h<b.length;h++)d.push(b[h][0],b[h][1],b[h][2]);return{O:c,Ca:d}};a.ol=e;a.gR=c;a.rd=b;a.cg=n;a.Xi=f;a.ls=function(a,b,c,d){P(a,b,c)||M.r("Edge not found");a=a.Ca;for(var h=0;h<a.length;h+=3)if(a[h]==b&&a[h+1]==c&&a[h+2][0]==d[0]&&a[h+2][1]==d[1]){a.splice(h,3);break}};a.H=function(a,b){if(-1==g(a,b)){var c=t(a);e(a,c,b);return c}M.r("Non-unique attribute")};a.pM=function(a,b,c,d,h){a=a.Ca;for(var k=0;k<a.length;k+=3)a[k]==b&&a[k+1]==c&&a[k+2]==d&&(a[k+2]=h)};a.VF=function(a,c,d){var h;d=d||
[];h=h||[];for(var k={},f=0;f<a.O.length;f+=2){var l=a.O[f],u=a.O[f+1],p=t(c);e(c,p,u);k[l]=p}for(f=0;f<a.Ca.length;f+=3)u=k[a.Ca[f]],p=k[a.Ca[f+1]],l=a.Ca[f+2],b(c,u,p,l);for(f=0;f<d.length;f+=3)u=k[d[f]],a=d[f+1],l=d[f+2],b(c,u,a,l);for(f=0;f<h.length;f+=3)d=h[f],p=k[h[f+1]],l=h[f+2],b(c,d,p,l)};a.lo=t;a.Uf=g;a.s=function(a,c,d,h){c=g(a,c);d=g(a,d);-1!=c&&-1!=d?b(a,c,d,h):M.r("Attributes not found")};a.na=function(a,b){for(var c=a.O,d=0;d<c.length&&!b(c[d],c[d+1]);d+=2);};a.ig=function(a,b){for(var c=
a.Ca,d=0;d<c.length&&!b(c[d],c[d+1],c[d+2]);d+=3);};a.Ug=function(a,b,c){for(var d=a.Ca,h=0;h<d.length;h+=3)if(d[h+1]==b){var k=d[h];if(c(k,A(a,k),d[h+2]))break}};a.gj=function(a,b,c){for(var d=a.Ca,h=0;h<d.length;h+=3)if(d[h]==b){var k=d[h+1];if(c(k,A(a,k),d[h+2]))break}};a.Tw=m;a.YN=function(a){a=m(a).O;for(var b=[],c=0;c<a.length;c+=2)b.push(a[c+1]);return b};a.oR=function(){};a.Bs=function(a,b,h){c(a,b)||M.r("No such node");var e={};v(a,e);d(a,b,e,h);b=[];for(var f in e)e[f]&&(f=Number(f),b.push(f,
A(a,f)));a={O:b,Ca:a.Ca.slice(0)};k(a);return a};a.St=k;a.jK=function(a){for(var b=[],c=a.O,d=0;d<c.length;d+=2){var h=c[d];w(a,h)||b.push(h)}return b};a.oo=r;a.match=function(a,b,c,d){var h={};h.jo=C(a);h.ko=C(b);h.Iv=c||function(a,b){return a==b};h.Cq=d||function(a,b){return a==b};d=a.O.length/2;var k=b.O.length/2;h.Ji=d;h.fm=k;h.Mi=0;h.tg=h.Rr=0;h.ej=h.Dm=h.Em=0;h.fj=h.Fm=h.Gm=0;h.fn=-1;h.kh=Array(d);h.Qj=Array(k);h.lk=Array(d);h.mk=Array(k);h.Bk=Array(d);h.Ck=Array(k);h.ts=[1];for(c=0;c<d;c++)h.kh[c]=
-1,h.lk[c]=0,h.Bk[c]=0;for(c=0;c<k;c++)h.Qj[c]=-1,h.mk[c]=0,h.Ck[c]=0;k=Array(d);d=Array(d);if(B(k,d,h)){for(c=0;c<k.length;c++)k[c]=a.O[2*k[c]],d[c]=b.O[2*d[c]];return[k,d]}return null};a.fK=function(a,b){for(var c=a.O,d=1;d<c.length;d+=2)if(c[d]==b)return c[d-1];return null};a.Sa=A;a.Jg=H;a.ir=w;a.Bg=h;a.ik=u;a.TQ=z;a.Oe=l;a.replace=function(a,b,c){for(var d=a.Ca,h=t(a),k=0;k<b.length;k++){var f=b[k];n(a,f);for(var l=0;l<d.length;l+=3)d[l]==f&&(d[l]=h),d[l+1]==f&&(d[l+1]=h),d[l]==d[l+1]&&(d.splice(l,
3),l-=3)}e(a,h,c)};a.eM=function(a,b,c,d,h){P(a,b,c)||M.r("Edge not found");a=a.Ca;for(var k=0;k<a.length;k+=3)a[k]==b&&a[k+1]==c&&(a[k]=d,a[k+1]=h)};a.XI=function(a,b){function c(a,b){if(-1!=l.indexOf(a)){var d=l.slice(l.indexOf(a));if(-1!=h[d[d.length-1]].indexOf(d[0])){u.push([a,d[d.length-1]]);return}}l.push(a);for(d=0;d<b.length;d++)b[d]in h&&c(b[d],h[b[d]])}b||(b=r(a)[0]);var d=a.Ca;if(d.length&&-1!=d.indexOf(b)){for(var h={},k=0,e=0;e<d.length;e+=3)d[e+1]in h?h[d[e+1]].push(d[e]):h[d[e+1]]=
[d[e]],k++;var l=[],u=[];c(b,h[b]);for(e=0;e<u.length;e++)for(var p=k=0;p<d.length;p+=3)u[e][1]==d[p+1]&&u[e][0]==d[p]&&f(a,d[p],d[p+1],k),k++}};a.CI=function(a,b,c){var d=a.O;a=a.Ca;var h;h="digraph debug {\n    node [shape=box];\n";for(var k=0;k<d.length;k+=2){var e=d[k],f=d[k+1],f=b?b(e,f):String(e);h+="    ";h+=String(e)+' [label="'+f.replace(/\"/g,'\\"')+'"];\n'}for(k=0;k<a.length;k+=3)b=a[k],d=a[k+1],f=a[k+2],h+="    ",h+=String(b)+" -> "+String(d),c&&(h+=' [label="'+c(b,d,f)+'"]'),h+=";\n";
return h+="}"}};b4w.module.__ipc=function(a,q){function e(a,b,c){for(var e=0;e<k.length;e+=2)k[e+1]==a&&(d[e+Number(!b)]=c)}function c(a){for(var b=0;b<a.length;b++){var c=a[b],d=0,k;for(k in c){var e=c[k];switch(e.constructor){case Float32Array:d+=e.length;break;case Number:d+=1}}--d;c.len=d}}var b=!0;a.SD=0;var n=a.KD=1,f=a.MD=2;a.LD=3;a.OD=4;a.PD=5;a.QD=6;a.TD=7;var t=a.VD=8,g=a.Ax=9,m=a.WD=10;a.XD=11;var v=a.YD=12;a.ZD=13;a.UD=14;a.RD=15;a.ND=16;a.QE=100;a.rE=101;a.sE=102;a.tE=103;a.uE=104;a.wE=105;a.vE=106;
a.xE=107;a.yE=108;a.zE=109;a.AE=110;a.BE=111;a.CE=112;a.EE=113;a.FE=114;a.TE=115;a.GE=116;a.HE=117;a.IE=118;a.KE=119;a.LE=120;a.ME=121;a.OE=122;a.PE=123;a.RE=124;a.DE=125;a.VE=126;a.JE=127;a.Kx=128;a.UE=129;a.WE=130;a.XE=131;a.YE=132;a.ZE=133;a.$E=134;a.aF=135;a.bF=136;a.cF=137;a.dF=138;a.eF=139;a.Lx=140;var x=a.Kp=141;a.fF=142;a.Jx=143;a.gF=144;a.hF=145;a.SE=146;a.NE=147;a.iF=148;var d=b4w.worker_listeners,k=b4w.worker_namespaces,r={Se:v,N:0,time:0,trans:new Float32Array(3),quat:new Float32Array(4),
Dg:new Float32Array(3),pg:new Float32Array(3),len:0},C={Se:t,Pt:0,Vv:0,trans:new Float32Array(3),quat:new Float32Array(4),len:0},B={Se:g,id:0,ql:0,hit_fract:0,hit_time:0,len:0},F={Se:m,id:0,ql:0,hit_fract:0,hit_time:0,hit_pos:new Float32Array(3),hit_norm:new Float32Array(3),len:0},D={Se:n,Dj:0,Ej:0,result:0,len:0},y={Se:f,Dj:0,Ej:0,result:0,Lj:new Float32Array(3),coll_norm:new Float32Array(3),coll_dist:0,len:0},A={Se:x,N:0,trans:new Float32Array(3),quat:new Float32Array(4),len:0},H=[r,C,B,F,D,y,A];
a.vI=function(a,c){var f={pr:a?!0:!1,qj:null,rg:[],ff:""};if(c)if(f.qj={addEventListener:function(a,b){"message"!=a&&panic("Wrong web worker event");e(f.ff,f.pr,b)},removeEventListener:function(a){"message"!=a&&panic("Wrong web worker event");e(f.ff,f.pr,null)},postMessage:function(a){var b;a:{for(b=0;b<k.length;b+=2)if(k[b+1]==f.ff){b=d[b+Number(!!f.pr)];break a}b=null}b({data:a})},terminate:function(){for(var a=0;a<k.length;a+=2)if(k[a+1]==f.ff){d.splice(a,2);k.splice(a,2);break}}},f.pr){var g=
q("__util"),p=q("__container"),r=b4w.get_namespace(q),g=g.rp(r+"_worker");k.push(r);k.push(g);d.push(null);d.push(null);f.ff=g;(p=p.kJ(a))?b?p.addEventListener("load",function(){b4w.require("__bindings",f.ff)},!1):(b4w.cleanup("__bindings",f.ff),b4w.cleanup("__ipc",f.ff),b4w.require("__bindings",f.ff)):(p=document.createElement("script"),p.src=a,p.defer="defer",p.async="async",p.addEventListener("load",function(){b=!1;b4w.require("__bindings",f.ff)},!1),document.head.appendChild(p))}else f.ff=b4w.get_namespace(q);
else f.qj=a?new Worker(a):self;return f};a.kG=function(a,b){function d(c){if(c.constructor==ArrayBuffer)c=new Float32Array(c);else if(c[0].constructor==ArrayBuffer){for(var k=0;k<c.length;k++)d(c[k]);return}k=c[0]|0;switch(k){case v:var e=r;e.N=c[1]|0;e.time=c[2];e.trans[0]=c[3];e.trans[1]=c[4];e.trans[2]=c[5];e.quat[0]=c[6];e.quat[1]=c[7];e.quat[2]=c[8];e.quat[3]=c[9];e.Dg[0]=c[10];e.Dg[1]=c[11];e.Dg[2]=c[12];e.pg[0]=c[13];e.pg[1]=c[14];e.pg[2]=c[15];break;case t:e=C;e.Pt=c[1]|0;e.Vv=c[2]|0;e.trans[0]=
c[3];e.trans[1]=c[4];e.trans[2]=c[5];e.quat[0]=c[6];e.quat[1]=c[7];e.quat[2]=c[8];e.quat[3]=c[9];break;case g:e=B;e.id=c[1]|0;e.ql=c[2]|0;e.hit_fract=c[3];e.hit_time=c[4];break;case m:e=F;e.id=c[1]|0;e.ql=c[2]|0;e.hit_fract=c[3];e.hit_time=c[4];e.hit_pos[0]=c[5];e.hit_pos[1]=c[6];e.hit_pos[2]=c[7];e.hit_norm[0]=c[8];e.hit_norm[1]=c[9];e.hit_norm[2]=c[10];break;case n:e=D;e.Dj=c[1]|0;e.Ej=c[2]|0;e.result=!!c[3];break;case f:e=y;e.Dj=c[1]|0;e.Ej=c[2]|0;e.result=!!c[3];e.Lj[0]=c[4];e.Lj[1]=c[5];e.Lj[2]=
c[6];e.coll_norm[0]=c[7];e.coll_norm[1]=c[8];e.coll_norm[2]=c[9];e.coll_dist=c[10];break;case x:e=A;e.N=c[1]|0;e.trans[0]=c[2];e.trans[1]=c[3];e.trans[2]=c[4];e.quat[0]=c[5];e.quat[1]=c[6];e.quat[2]=c[7];e.quat[3]=c[8];break;default:e=c}b(a,k,e)}c(H);a.qj.addEventListener("message",function(a){d(a.data)},!1)};a.cleanup=function(){};a.S=function(a,b){if(a)switch(b){case v:var c=r,d=new Float32Array(c.len);d[0]=c.Se;d[1]=c.N;d[2]=c.time;d[3]=c.trans[0];d[4]=c.trans[1];d[5]=c.trans[2];d[6]=c.quat[0];
d[7]=c.quat[1];d[8]=c.quat[2];d[9]=c.quat[3];d[10]=c.Dg[0];d[11]=c.Dg[1];d[12]=c.Dg[2];d[13]=c.pg[0];d[14]=c.pg[1];d[15]=c.pg[2];a.rg.push(d.buffer);break;case t:c=C;d=new Float32Array(c.len);d[0]=c.Se;d[1]=c.Pt;d[2]=c.Vv;d[3]=c.trans[0];d[4]=c.trans[1];d[5]=c.trans[2];d[6]=c.quat[0];d[7]=c.quat[1];d[8]=c.quat[2];d[9]=c.quat[3];a.rg.push(d.buffer);break;case g:c=B;d=new Float32Array(c.len);d[0]=c.Se;d[1]=c.id;d[2]=c.ql;d[3]=c.hit_fract;d[4]=c.hit_time;a.rg.push(d.buffer);break;case m:c=F;d=new Float32Array(c.len);
d[0]=c.Se;d[1]=c.id;d[2]=c.ql;d[3]=c.hit_fract;d[4]=c.hit_time;d[5]=c.hit_pos[0];d[6]=c.hit_pos[1];d[7]=c.hit_pos[2];d[8]=c.hit_norm[0];d[9]=c.hit_norm[1];d[10]=c.hit_norm[2];a.rg.push(d.buffer);break;case n:c=D;d=new Float32Array(c.len);d[0]=c.Se;d[1]=c.Dj;d[2]=c.Ej;d[3]=c.result;a.rg.push(d.buffer);break;case f:c=y;d=new Float32Array(c.len);d[0]=c.Se;d[1]=c.Dj;d[2]=c.Ej;d[3]=c.result;d[4]=c.Lj[0];d[5]=c.Lj[1];d[6]=c.Lj[2];d[7]=c.coll_norm[0];d[8]=c.coll_norm[1];d[9]=c.coll_norm[2];d[10]=c.coll_dist;
a.rg.push(d.buffer);break;case x:c=A;d=new Float32Array(c.len);d[0]=c.Se;d[1]=c.N;d[2]=c.trans[0];d[3]=c.trans[1];d[4]=c.trans[2];d[5]=c.quat[0];d[6]=c.quat[1];d[7]=c.quat[2];d[8]=c.quat[3];a.rg.push(d.buffer);break;default:d=[];for(c=1;c<arguments.length;c++)d.push(arguments[c]);a.qj.postMessage(d)}};a.YL=function(a){a&&a.rg.length&&(a.qj.postMessage(a.rg),a.rg.length=0)};a.Yz=function(a){switch(a){case v:return r;case t:return C;case g:return B;case m:return F;case n:return D;case f:return y;case x:return A;
default:return null}};a.terminate=function(a){a.qj.terminate();a.qj=null};a.kr=function(a){return!!a.qj};a.vA=function(a){return!!a.ff}};b4w.module.__hud=function(a,q){function e(a){a.font="bold 15px Courier New";a.textBaseline="middle";a.shadowBlur=0;a.shadowColor=null}function c(a){b(' SCENE "'+a.name+'"');b(" Active                 Subscene   Lamps   Size   RenderCalls   Time");if(a.q){var c=0,d=0,e=0;g.na(a.q.Pa,function(a,k){if(k.type!=m.kl){for(var f=Math.round(k.p.width)+"x"+Math.round(k.p.height),g=0,n=0;n<k.Ea.length;n++)g+=k.Ea[n].ka.length;n=k.Sn;if(k.type==m.Jc||k.type==m.Vd)g*=6;var w=k.vb,h=w?k.Ie:0;k.enqueue||(k.Ie=
0);var u=w?" (\u2713)":" (\u2715)",v=m.Hw(k);b(u,v,k.Pr,f,n,"of",g,"  ",h.toFixed(3));k.Sn=0;w&&(c+=g,d+=n,e+=h)}});return[c,d,e]}b("No INFO")}function b(){for(var a=80+20*d[0],b=arguments[0],c=1;c<arguments.length;c++){for(var e="",f=0;f<v[c]-String(arguments[c]).length;f++)e+=" ";b+=e+arguments[c]}d[0]++;x.fillText(b,30,a)}function n(a,b,c){b*=a.Ob;c.x=a.x+b;c.y=a.y;c.Ob=a.Ob-2*b;c.Eb=a.Eb}function f(a){return a.x+a.Ob/2}function t(a){var b=x,c={x:0,y:0,Ob:0,Eb:0},d=b.canvas.width,b=b.canvas.height;
c.x=0;c.y=0;c.Ob=d;c.Eb=b;n(c,.01,c);d=.02*c.Eb;c.x=c.x;c.y+=d;c.Ob=c.Ob;c.Eb-=2*d;d=c.Ob/8;c.x+=d*a;c.y=c.y;c.Ob=d;c.Eb=c.Eb;n(c,.02,c);return c}var g=q("__graph");q("__print");var m=q("__subscene"),v=[5,30,4,10,5,3,5],x=null,d=[0,0];a.init=function(a){a=a.getContext("2d");e(a);return x=a};a.sp=function(){x&&e(x)};a.reset=function(){var a=x;a&&(a.clearRect(0,0,a.canvas.width,a.canvas.height),a.fillStyle="rgba(0,0,0,0.5)",a.fillRect(0,0,a.canvas.width,a.canvas.height),d[0]=0,d[1]=0)};a.sN=function(a,
e){var f=x;if(f){f.textAlign="left";f.fillStyle="rgba(0,255,0,255)";b(" FPS",(1/e).toFixed(2));d[0]++;for(var g=f=0,m=0,n=0;n<a.length;n++){var v=c(a[n]),f=f+v[0],g=g+v[1],m=m+v[2];d[0]++}b(" ----------------------------------------------------------------");b("    ","TOTAL ACTIVE","","",g,"of",f,"  ",m.toFixed(3))}};a.print=function(){var a=x;a&&(a.textAlign="left",a.fillStyle="rgba(0,255,0,255)",b.apply(Math,arguments))};a.plot_array=function(a,b,c,d,e,g,m){var n=x;if(n){b=t(b);var v=b.Eb/5;b.x=
b.x;b.y+=4*v;b.Ob=b.Ob;b.Eb=v;n.textAlign="center";n.fillStyle="#00FF00";x.fillText(a,f(b),b.y-10);n.strokeStyle="#00FF00";n.lineWidth=.5;n.beginPath();n.moveTo(b.x,b.y);n.lineTo(b.x+b.Ob,b.y);n.lineTo(b.x+b.Ob,b.y+b.Eb);n.lineTo(b.x,b.y+b.Eb);n.closePath();n.stroke();if(!g&&!m)for(g=1E6,m=-1E6,a=0;a<c.length;a++)g=Math.min(g,c[a]),m=Math.max(m,c[a]);n.textAlign="right";x.fillText(String(g),b.x-10,b.y+b.Eb);x.fillText(String(m),b.x-10,b.y);n.textAlign="center";x.fillText(String(d),b.x,b.y+b.Eb+15);
x.fillText(String(e),b.x+b.Ob,b.y+b.Eb+15);n.strokeStyle="#FF0000";n.lineWidth=1.5;n.beginPath();d=b.Ob/(c.length-1);m=b.Eb/(m-g);for(a=0;a<c.length;a++)e=b.x+d*a,v=b.y+b.Eb-(c[a]-g)*m,0==a?n.moveTo(e,v):n.lineTo(e,v);n.stroke()}};a.draw_mixer_strip=function(a,b,c,d,e,g,m){var n=x;if(n)for(n.textAlign="center",n.fillStyle="#00FF00",n.font="bold 12px Courier",c=t(c),x.fillText(b?"["+a+"]":a,f(c),c.y),0<=g&&x.fillText(g?"[M]":"[ ]",f(c)-15,c.y+30),0<=m&&x.fillText(m?"[S]":"[ ]",f(c)+15,c.y+30),a={x:0,
y:0,Ob:0,Eb:0},b=0;b<d.length;b++){g=d[b];var v="VOLUME"==g[0];if(v){m=c.y+350;var w=c.Ob,h=a;h.x=c.x;h.y=m;h.Ob=w;h.Eb=250}else{m=c.y+50+50*b;var w=c.Ob,h=c.Eb,u=a;u.x=c.x;u.y=m;u.Ob=w;u.Eb=h}m=n;var w=a,u=b==e,q=g[0],h=g[1],p=g[2],z=g[3],l=(z-p)/g[4],l=1>l?Math.floor(1/l-1E-5).toFixed(0).length:0;g=g[5]?Math.log(h/p)/Math.log(z/p):(h-p)/(z-p);m.textAlign="center";u?m.fillText("["+q+"]",f(w),w.y):m.fillText(q,f(w),w.y);m.strokeStyle="#00FF00";m.lineWidth=v?3:1;v?(m.textAlign="right",m.fillText(z.toFixed(l),
f(w)-10,w.y+15),m.textAlign="right",m.fillText(p.toFixed(l),f(w)-10,w.y+w.Eb-15)):(m.textAlign="right",m.fillText(p.toFixed(l),w.x+28,w.y+15),m.textAlign="left",m.fillText(z.toFixed(l),w.x+w.Ob-28,w.y+15));m.beginPath();if(v){var M=w.y+15+(w.Eb-30)*(1-g);m.moveTo(f(w),w.y+15);m.lineTo(f(w),w.y+w.Eb-15);m.moveTo(f(w)-5,w.y+15);m.lineTo(f(w)+5,w.y+15);m.moveTo(f(w)-5,w.y+w.Eb-15);m.lineTo(f(w)+5,w.y+w.Eb-15);m.moveTo(f(w)-5,M);m.lineTo(f(w)+5,M)}else{var E=w.x+30+(w.Ob-60)*g;m.moveTo(w.x+30,w.y+15);
m.lineTo(w.x+w.Ob-30,w.y+15);m.moveTo(w.x+30,w.y+15-5);m.lineTo(w.x+30,w.y+15+5);m.moveTo(w.x+w.Ob-30,w.y+15-5);m.lineTo(w.x+w.Ob-30,w.y+15+5);m.moveTo(E,w.y+15-5);m.lineTo(E,w.y+15+5)}m.stroke();"EQ_Q"==q?(g=Math.log(1+1/(2*h*h)+Math.sqrt((2+1/(h*h))*(2+1/(h*h))/4-1))/Math.log(2),v?(m.textAlign="left",m.fillText(h.toFixed(l),f(w)+10,M),m.textAlign="left",m.fillText("("+g.toFixed(l+1)+")",f(w)+10,M+10)):(m.textAlign="right",m.fillText(h.toFixed(l),E,w.y+30),m.textAlign="left",m.fillText("("+g.toFixed(l+
1)+")",E,w.y+30))):v?(m.textAlign="left",m.fillText(h.toFixed(l),f(w)+10,M)):(m.textAlign="center",m.fillText(h.toFixed(l),E,w.y+30))}}};b4w.module.__renderer=function(a,q){function e(a){for(var c=a.p,d=a.Ea,h=null,e=0;e<d.length;e++){var l=d[e];if(l.vb){var p=l.Qa,l=l.ka;if(p.Lg!=h){w.useProgram(p.Lg);for(var h=a,u=c,g=p,m=g.RC,r=m.length;r--;){var K=m[r];K.Kl(w,K.ke,h,u)}if(g.Io&&!g.Mr)for(g.Qv.length||f(g),g=g.Qv,r=g.length;r--;)K=g[r],K.Kl(w,K.ke,h,u);h=p.Lg}for(u=0;u<l.length;u++)if(r=l[u],r.vb){g=r.Ig;r=r.pa;v.mM(r);v.uA()&&"DEBUG_VIEW"==r.type&&(r.Rn=B.smooth(t.mG(r.zl),r.Rn,1,15));for(var K=a,m=r,N=p,n=N.SC,x=n.length;x--;){var A=
n[x];A.Kl(w,A.ke,g,m)}if(N.Io&&!N.Mr){N.Qo.length||f(N);n=N.Qo;for(x=n.length;x--;)A=n[x],A.Kl(w,A.ke,g,m);N.Io=!1}w.depthMask(m.Ha);m.Ab?w.enable(w.CULL_FACE):w.disable(w.CULL_FACE);x=m.T;A=w;for(n=0;n<x.length;n++){var y=x[n];A.activeTexture(A.TEXTURE0+n);A.bindTexture(y.Wa,y.Za)}if(K.type==k.$h){g=K;N=N.Rk;x=g.p.Zb.Za;A=g.Tj;for(n=0;6>n;n++)if(y=b(n),W.Tt?(w.bindTexture(w.TEXTURE_CUBE_MAP,x),w.texImage2D(y,0,w.RGBA,1,1,0,w.RGBA,w.UNSIGNED_BYTE,H)):(w.uniformMatrix4fv(N.u_cube_view_matrix,!1,A[n]),
w.framebufferTexture2D(w.FRAMEBUFFER,w.COLOR_ATTACHMENT0,y,x,0),z(m,0)),g.Kr&&3!=n){var y=g,M=n,q=E;W.Tt?q.set(H):(w.readPixels(191,191,1,1,w.RGBA,w.UNSIGNED_BYTE,q),255!=q[0]&&255!=q[1]&&255!=q[2]||w.readPixels(191,220,1,1,w.RGBA,w.UNSIGNED_BYTE,q));var C=q[0],pa=q[1],q=q[2],C=C/255,pa=pa/255,q=q/255;2===M?(y.Id[3]=C,y.Id[7]=pa,y.Id[11]=q):2>M?(y.Id[4*M]=C,y.Id[4*M+1]=pa,y.Id[4*M+2]=q):(y.Id[4*(M-2)]=C,y.Id[4*(M-2)+1]=pa,y.Id[4*(M-2)+2]=q)}K.Sn+=6}else z(m,g.Qs),K.Sn++;v.nM(r);v.uA()&&"MAIN"==r.type&&
t.nG(r.id,r.Ie)}}}}function c(a){if(a){var b=(a.$a?w.COLOR_BUFFER_BIT:0)|(a.eb?w.DEPTH_BUFFER_BIT:0);if(!b)return;switch(a.type){case k.qd:a=A;break;case k.Ac:a=F;break;case k.Ce:a=D;break;case k.Ud:case k.$g:case k.fl:a=y;break;case k.mg:case k.bn:case k.Lp:a=A;break;default:a=W.background_color}}else b=w.COLOR_BUFFER_BIT|w.DEPTH_BUFFER_BIT,a=W.background_color;w.colorMask(!0,!0,!0,!0);w.depthMask(!0);w.clearColor(a[0],a[1],a[2],a[3]);w.clear(b)}function b(a){switch(a){case 0:return w.TEXTURE_CUBE_MAP_POSITIVE_X;
case 1:return w.TEXTURE_CUBE_MAP_NEGATIVE_X;case 2:return w.TEXTURE_CUBE_MAP_POSITIVE_Y;case 3:return w.TEXTURE_CUBE_MAP_NEGATIVE_Y;case 4:return w.TEXTURE_CUBE_MAP_POSITIVE_Z;case 5:return w.TEXTURE_CUBE_MAP_NEGATIVE_Z}}function n(a){var b=x.Qu(),c=a.on,d=a.ja,h=d.zb;a.Sd.length=0;var k=1,e;for(e in h)k=Math.max(k,h[e].frames);for(h=0;h<k;h++){e=b.createVertexArray();p(e);w.bindBuffer(w.ARRAY_BUFFER,d.Vh);d.nf&&w.bindBuffer(w.ELEMENT_ARRAY_BUFFER,d.nf);for(var f=0;f<c.length;f++){var l=c[f];w.enableVertexAttribArray(l.ke);
w.vertexAttribPointer(l.ke,l.Lb,w.FLOAT,!1,l.Ve,l.gy+l.Fz*h);u(l.ke,l.xg)}p(null);a.Sd.push(e)}}function f(a){var b=a.Rk,c=a.SC,d=a.Qo,h=a.RC,k=a.Qv;c.length=0;d.length=0;h.length=0;k.length=0;for(var e in b){var f=!1,p=null,u=null;switch(e){case "u_proj_matrix":p=function(a,b,c,d){a.uniformMatrix4fv(b,!1,d.ab)};f=!0;break;case "u_view_refl_matrix":p=function(a,b,c,d){a.uniformMatrix4fv(b,!1,d.lx)};f=!0;break;case "u_view_tsr":case "u_view_tsr_frag":p=function(a,b,c,d){d.Nb?a.uniformMatrix3fv(b,!1,
d.Xo):a.uniformMatrix3fv(b,!1,d.ye)};f=!0;break;case "u_view_tsr_inverse":p=function(a,b,c,d){d.Nb?a.uniformMatrix3fv(b,!1,d.hs):a.uniformMatrix3fv(b,!1,d.Us)};f=!0;break;case "u_shadow_cast_billboard_view_tsr":p=function(a,b,c,d){a.uniformMatrix3fv(b,!1,d.gp)};f=!0;break;case "u_view_proj_prev":p=function(a,b,c,d){a.uniformMatrix4fv(b,!1,d.Uv)};f=!0;break;case "u_view_proj_matrix":p=function(a,b,c,d){a.uniformMatrix4fv(b,!1,d.Ic)};f=!0;break;case "u_view_proj_inverse":p=function(a,b,c,d){a.uniformMatrix4fv(b,
!1,d.Ts)};f=!0;break;case "u_sky_vp_inverse":p=function(a,b,c,d){a.uniformMatrix4fv(b,!1,d.xf)};f=!0;break;case "u_camera_eye":case "u_camera_eye_frag":p=function(a,b,c,d){a.uniform3fv(b,C.bc(d.n,l))};f=!0;break;case "u_camera_quat":p=function(a,b,c,d){a.uniform4fv(b,C.ud(d.n,M))};f=!0;break;case "u_view_max_depth":p=function(a,b,c,d){a.uniform1f(b,d.far)};f=!0;break;case "u_camera_range":p=function(a,b,c,d){a.uniform2f(b,d.near,d.far)};break;case "u_csm_center_dists":p=function(a,b,c,d){a.uniform4fv(b,
d.tq)};break;case "u_height":p=function(a,b,c,d){a.uniform1f(b,d.height)};f=!0;break;case "u_pcf_blur_radii":p=function(a,b,c,d){a.uniform4fv(b,d.lm)};break;case "u_dof_dist":p=function(a,b,c,d){d.dof_on?a.uniform1f(b,d.dof_distance):a.uniform1f(b,0)};f=!0;break;case "u_dof_front_start":p=function(a,b,c,d){a.uniform1f(b,d.dof_front_start)};f=!0;break;case "u_dof_front_end":p=function(a,b,c,d){a.uniform1f(b,d.dof_front_end)};f=!0;break;case "u_dof_rear_start":p=function(a,b,c,d){a.uniform1f(b,d.dof_rear_start)};
f=!0;break;case "u_dof_rear_end":p=function(a,b,c,d){a.uniform1f(b,d.dof_rear_end)};f=!0;break;case "u_dof_bokeh_intensity":p=function(a,b,c,d){a.uniform1f(b,d.Xa)};f=!0;break;case "u_cam_water_depth":p=function(a,b,c){a.uniform1f(b,c.Ot)};f=!0;break;case "u_waves_height":p=function(a,b,c){a.uniform1f(b,c.mx)};break;case "u_waves_length":p=function(a,b,c){a.uniform1f(b,c.nx)};break;case "u_fog_color_density":p=function(a,b,c){a.uniform4fv(b,c.Kd)};break;case "u_fog_params":p=function(a,b,c){a.uniform4fv(b,
c.hf)};break;case "u_underwater_fog_color_density":p=function(a,b,c){a.uniform4fv(b,c.Yg)};break;case "u_bloom_key":p=function(a,b,c){a.uniform1f(b,c.bloom_key)};break;case "u_bloom_edge_lum":p=function(a,b,c){a.uniform1f(b,c.bloom_edge_lum)};break;case "u_time":p=function(a,b,c){a.uniform1f(b,c.time)};f=!0;break;case "u_wind":p=function(a,b,c){a.uniform3fv(b,c.Xh)};f=!0;break;case "u_sky_tex_dvar":p=function(a,b,c){a.uniform1f(b,c.fC)};break;case "u_sky_tex_fac":p=function(a,b,c){a.uniform4fv(b,
c.gC)};break;case "u_sky_tex_color":p=function(a,b,c){a.uniform3fv(b,c.eC)};break;case "u_horizon_color":p=function(a,b,c){a.uniform3fv(b,c.Pe)};break;case "u_zenith_color":p=function(a,b,c){a.uniform3fv(b,c.cf)};break;case "u_environment_energy":p=function(a,b,c){a.uniform1f(b,c.qh)};break;case "u_sky_color":p=function(a,b,c){a.uniform3fv(b,c.um)};break;case "u_rayleigh_brightness":p=function(a,b,c){a.uniform1f(b,c.rayleigh_brightness)};break;case "u_mie_brightness":p=function(a,b,c){a.uniform1f(b,
c.mie_brightness)};break;case "u_spot_brightness":p=function(a,b,c){a.uniform1f(b,c.spot_brightness)};break;case "u_scatter_strength":p=function(a,b,c){a.uniform1f(b,c.scatter_strength)};break;case "u_rayleigh_strength":p=function(a,b,c){a.uniform1f(b,c.rayleigh_strength)};break;case "u_mie_strength":p=function(a,b,c){a.uniform1f(b,c.mie_strength)};break;case "u_rayleigh_collection_power":p=function(a,b,c){a.uniform1f(b,c.rayleigh_collection_power)};break;case "u_mie_collection_power":p=function(a,
b,c){a.uniform1f(b,c.mie_collection_power)};break;case "u_mie_distribution":p=function(a,b,c){a.uniform1f(b,c.mie_distribution)};break;case "u_light_positions":p=function(a,b,c){a.uniform3fv(b,c.xr)};break;case "u_light_directions":p=function(a,b,c){a.uniform3fv(b,c.hv)};break;case "u_light_color_intensities":p=function(a,b,c){a.uniform3fv(b,c.wr)};break;case "u_light_factors":p=function(a,b,c){a.uniform4fv(b,c.iv)};break;case "u_sun_quaternion":p=function(a,b,c){a.uniform4fv(b,c.zC)};break;case "u_sun_intensity":p=
function(a,b,c){a.uniform3fv(b,c.yC)};break;case "u_sun_direction":p=function(a,b,c){a.uniform3fv(b,c.Iw)};break;case "u_debug_view_mode":p=function(a,b,c){a.uniform1i(b,c.debug_view_mode)};break;case "u_debug_colors_seed":p=function(a,b,c){a.uniform1f(b,c.debug_colors_seed)};break;case "u_debug_render_time_threshold":p=function(a,b,c){a.uniform1f(b,c.fz)};break;case "u_subpixel_jitter":p=function(a,b,c){a.uniform2fv(b,c.LK)};f=!0;break;case "u_subsample_indices":p=function(a,b,c){a.uniform4fv(b,
c.MK)};f=!0;break;case "u_radial_blur_step":p=function(a,b,c){a.uniform1f(b,c.gs)};break;case "u_god_rays_intensity":p=function(a,b,c){a.uniform1f(b,c.god_rays_intensity)};break;case "u_ssao_radius_increase":p=function(a,b,c){a.uniform1f(b,c.ym)};break;case "u_ssao_blur_discard_value":p=function(a,b,c){a.uniform1f(b,c.ssao_blur_discard_value)};f=!0;break;case "u_ssao_influence":p=function(a,b,c){a.uniform1f(b,c.xm)};break;case "u_ssao_dist_factor":p=function(a,b,c){a.uniform1f(b,c.wm)};break;case "u_texel_size":p=
function(a,b,c){a.uniform2fv(b,c.Qw)};f=!0;break;case "u_normal_offset":p=function(a,b,c){a.uniform1f(b,c.self_shadow_normal_offset)};break;case "u_v_light_ts":p=function(a,b,c){a.uniform4fv(b,c.Ps)};f=!0;break;case "u_v_light_r":p=function(a,b,c){a.uniform4fv(b,c.Os)};f=!0;break;case "u_v_light_tsr":p=function(a,b,c){a.uniformMatrix3fv(b,!1,c.ix)};f=!0;break;case "u_p_light_matrix0":p=function(a,b,c){a.uniformMatrix4fv(b,!1,c.Dk[0])};f=!0;break;case "u_p_light_matrix1":p=function(a,b,c){a.uniformMatrix4fv(b,
!1,c.Dk[1])};f=!0;break;case "u_p_light_matrix2":p=function(a,b,c){a.uniformMatrix4fv(b,!1,c.Dk[2])};f=!0;break;case "u_p_light_matrix3":p=function(a,b,c){a.uniformMatrix4fv(b,!1,c.Dk[3])};f=!0;break;case "u_outline_color":p=function(a,b,c){a.uniform3fv(b,c.Eh)};break;case "u_draw_outline":p=function(a,b,c){a.uniform1f(b,c.wu)};f=!0;break;case "u_glow_mask_small_coeff":p=function(a,b,c){a.uniform1f(b,c.small_glow_mask_coeff)};f=!0;break;case "u_glow_mask_large_coeff":p=function(a,b,c){a.uniform1f(b,
c.large_glow_mask_coeff)};f=!0;break;case "u_brightness":p=function(a,b,c){a.uniform1f(b,c.brightness)};break;case "u_contrast":p=function(a,b,c){a.uniform1f(b,c.contrast)};break;case "u_exposure":p=function(a,b,c){a.uniform1f(b,c.exposure)};break;case "u_saturation":p=function(a,b,c){a.uniform1f(b,c.saturation)};break;case "u_enable_hmd_stereo":p=function(a,b,c){a.uniform1i(b,c.enable_hmd_stereo)};break;case "u_distortion_params":p=function(a,b,c){a.uniform4fv(b,c.Vj)};break;case "u_chromatic_aberration_coefs":p=
function(a,b,c){a.uniform4fv(b,c.chromatic_aberration_coefs)};break;case "u_motion_blur_exp":p=function(a,b,c){a.uniform1f(b,c.VA)};f=!0;break;case "u_motion_blur_decay_threshold":p=function(a,b,c){a.uniform1f(b,c.mb_decay_threshold)};f=!0;break;case "u_model_tsr":u=function(a,b,c){a.uniformMatrix3fv(b,!1,c.n)};f=!0;break;case "u_model_tsr_inverse":u=function(a,b,c){a.uniformMatrix3fv(b,!1,c.dt)};f=!0;break;case "u_transb":u=function(a,b,c){a.uniform4fv(b,c.Cd)};f=!0;break;case "u_transa":u=function(a,
b,c){a.uniform4fv(b,c.Pd)};f=!0;break;case "u_arm_rel_trans":u=function(a,b,c){a.uniform4fv(b,c.mn)};f=!0;break;case "u_arm_rel_quat":u=function(a,b,c){a.uniform4fv(b,c.ln)};f=!0;break;case "u_quat":u=function(a,b,c){a.uniform4fv(b,C.ud(c.n,M))};f=!0;break;case "u_quatsb":u=function(a,b,c){a.uniform4fv(b,c.zd)};f=!0;break;case "u_quatsa":u=function(a,b,c){a.uniform4fv(b,c.Od)};f=!0;break;case "u_frame_factor":u=function(a,b,c){a.uniform1f(b,c.ge)};f=!0;break;case "au_center_pos":u=function(){};f=
!0;break;case "au_wind_bending_amp":u=function(a,b,c){a.uniform1f(b,c.Cf)};f=!0;break;case "au_wind_bending_freq":u=function(a,b,c){a.uniform1f(b,c.kg)};f=!0;break;case "au_detail_bending_freq":u=function(a,b,c){a.uniform1f(b,c.Kf)};f=!0;break;case "au_detail_bending_amp":u=function(a,b,c){a.uniform1f(b,c.Jf)};f=!0;break;case "au_branch_bending_amp":u=function(a,b,c){a.uniform1f(b,c.Gf)};f=!0;break;case "u_node_values":u=function(a,b,c,d){a.uniform1fv(b,d.Ch)};f=!0;break;case "u_node_rgbs":u=function(a,
b,c,d){a.uniform3fv(b,d.Ld)};f=!0;break;case "u_diffuse_color":u=function(a,b,c,d){a.uniform4fv(b,d.Zc)};f=!0;break;case "u_diffuse_intensity":u=function(a,b,c,d){a.uniform1f(b,d.wg)};f=!0;break;case "u_diffuse_params":u=function(a,b,c,d){a.uniform2fv(b,d.Jd)};f=!0;break;case "u_emit":u=function(a,b,c,d){a.uniform1f(b,d.Mf)};f=!0;break;case "u_ambient":u=function(a,b,c,d){a.uniform1f(b,d.Ff)};f=!0;break;case "u_specular_color":u=function(a,b,c,d){a.uniform3fv(b,d.zf)};f=!0;break;case "u_specular_alpha":u=
function(a,b,c,d){a.uniform1f(b,d.kp)};f=!0;break;case "u_specular_params":u=function(a,b,c,d){a.uniform3fv(b,d.Bd)};f=!0;break;case "u_reflect_factor":u=function(a,b,c,d){a.uniform1f(b,d.reflect_factor)};f=!0;break;case "u_mirror_factor":u=function(a,b,c,d){a.uniform1f(b,d.Ho)};f=!0;break;case "u_grass_map_dim":u=function(a,b,c,d){a.uniform3fv(b,d.wd)};f=!0;break;case "u_grass_size":u=function(a,b,c,d){a.uniform1f(b,d.po)};f=!0;break;case "u_scale_threshold":u=function(a,b,c,d){a.uniform1f(b,d.Uq)};
f=!0;break;case "u_cube_fog":u=function(a,b,c,d){a.uniformMatrix4fv(b,!1,d.Id)};break;case "u_jitter_amp":u=function(a,b,c,d){a.uniform1f(b,d.sr)};f=!0;break;case "u_jitter_freq":u=function(a,b,c,d){a.uniform1f(b,d.ur)};f=!0;break;case "u_wireframe_edge_color":u=function(a,b,c,d){a.uniform3fv(b,d.wireframe_edge_color)};break;case "u_cluster_id":u=function(a,b,c,d){a.uniform1f(b,d.Jj)};f=!0;break;case "u_batch_debug_id_color":u=function(a,b,c,d){a.uniform1f(b,d.vq)};f=!0;break;case "u_batch_debug_main_render_time":u=
function(a,b,c,d){a.uniform1f(b,d.Rn)};f=!0;break;case "u_refr_bump":u=function(a,b,c,d){a.uniform1f(b,d.ks)};f=!0;break;case "u_line_width":u=function(a,b,c,d){a.uniform1f(b,d.Zl)};f=!0;break;case "u_lamp_light_positions":u=function(a,b,c,d){a.uniform3fv(b,d.Wl)};break;case "u_lamp_light_directions":u=function(a,b,c,d){a.uniform3fv(b,d.Co)};break;case "u_lamp_light_color_intensities":u=function(a,b,c,d){a.uniform3fv(b,d.Bo)};break;case "u_lamp_light_factors":u=function(a,b,c,d){a.uniform4fv(b,d.Do)};
break;case "u_halo_size":u=function(a,b,c,d){a.uniform1f(b,d.dr)};f=!0;break;case "u_halo_hardness":u=function(a,b,c,d){a.uniform1f(b,d.ar)};f=!0;break;case "u_halo_rings_color":u=function(a,b,c,d){a.uniform3fv(b,d.cr)};f=!0;break;case "u_halo_lines_color":u=function(a,b,c,d){a.uniform3fv(b,d.br)};f=!0;break;case "u_halo_stars_blend":u=function(a,b,c,d){a.uniform1f(b,d.er)};f=!0;break;case "u_halo_stars_height":u=function(a,b,c,d){a.uniform1f(b,d.fr)};f=!0;break;case "u_fresnel_params":u=function(a,
b,c,d){a.uniform4fv(b,d.Me)};f=!0;break;case "u_texture_scale":u=function(a,b,c,d){a.uniform3fv(b,d.Rg)};f=!0;break;case "u_parallax_scale":u=function(a,b,c,d){a.uniform1f(b,d.parallax_scale)};f=!0;break;case "u_color_id":u=function(a,b,c){a.uniform3fv(b,c.Mj)};f=!0;break;case "u_line_points":u=function(a,b,c,d){a.uniform3fv(b,d.vR)};f=!0;break;case "u_diffuse_color_factor":u=function(a,b,c,d){a.uniform1f(b,d.vg)};f=!0;break;case "u_alpha_factor":u=function(a,b,c,d){a.uniform1f(b,d.og)};f=!0;break;
case "u_specular_color_factor":u=function(a,b,c,d){a.uniform1f(b,d.Mh)};f=!0;break;case "u_normal_factor":u=function(a,b,c,d){a.uniform1f(b,d.Or)};f=!0;break;case "u_normalmap0_scale":u=function(a,b,c,d){a.uniform2fv(b,d.Dh[0])};f=!0;break;case "u_normalmap1_scale":u=function(a,b,c,d){a.uniform2fv(b,d.Dh[1])};f=!0;break;case "u_normalmap2_scale":u=function(a,b,c,d){a.uniform2fv(b,d.Dh[2])};f=!0;break;case "u_normalmap3_scale":u=function(a,b,c,d){a.uniform2fv(b,d.Dh[3])};f=!0;break;case "u_foam_factor":u=
function(a,b,c,d){a.uniform1f(b,d.foam_factor)};f=!0;break;case "u_foam_uv_freq":u=function(a,b,c,d){a.uniform2fv(b,d.Lq)};f=!0;break;case "u_foam_mag":u=function(a,b,c,d){a.uniform2fv(b,d.Kq)};f=!0;break;case "u_foam_scale":u=function(a,b,c,d){a.uniform2fv(b,d.eo)};f=!0;break;case "u_water_norm_uv_velocity":u=function(a,b,c,d){a.uniform1f(b,d.pj)};f=!0;break;case "u_shallow_water_col":u=function(a,b,c,d){a.uniform3fv(b,d.shallow_water_col)};f=!0;break;case "u_shore_water_col":u=function(a,b,c,d){a.uniform3fv(b,
d.shore_water_col)};f=!0;break;case "u_water_shallow_col_fac":u=function(a,b,c,d){a.uniform1f(b,d.shallow_water_col_fac)};f=!0;break;case "u_water_shore_col_fac":u=function(a,b,c,d){a.uniform1f(b,d.shore_water_col_fac)};f=!0;break;case "u_p_length":u=function(a,b,c,d){a.uniform1f(b,d.Ma.KC)};f=!0;break;case "u_p_cyclic":u=function(a,b,c,d){a.uniform1i(b,d.Ma.cyclic)};f=!0;break;case "u_p_max_lifetime":u=function(a,b,c,d){a.uniform1f(b,d.Ma.KA)};f=!0;break;case "u_p_fade_in":u=function(a,b,c,d){a.uniform1f(b,
d.Ma.$j)};f=!0;break;case "u_p_fade_out":u=function(a,b,c,d){a.uniform1f(b,d.Ma.Ke)};f=!0;break;case "u_p_size":u=function(a,b,c,d){a.uniform1f(b,d.Ma.size)};f=!0;break;case "u_p_alpha_start":u=function(a,b,c,d){a.uniform1f(b,d.Ma.Yx)};f=!0;break;case "u_p_alpha_end":u=function(a,b,c,d){a.uniform1f(b,d.Ma.Xx)};f=!0;break;case "u_p_nfactor":u=function(a,b,c,d){a.uniform1f(b,d.Ma.Hv)};f=!0;break;case "u_p_gravity":u=function(a,b,c,d){a.uniform1f(b,d.Ma.iA)};f=!0;break;case "u_p_mass":u=function(a,b,
c,d){a.uniform1f(b,d.Ma.Gg)};f=!0;break;case "u_p_color_ramp":u=function(a,b,c,d){a.uniform4fv(b,d.Ma.Ry)};f=!0;break;case "u_p_wind_fac":u=function(a,b,c,d){a.uniform1f(b,d.Ma.sD)};f=!0;break;case "u_p_time":u=function(a,b,c,d){a.uniform1f(b,d.Ma.time)};f=!0;break;case "u_p_tilt":u=function(a,b,c,d){a.uniform1f(b,d.Ma.IC)};f=!0;break;case "u_p_tilt_rand":u=function(a,b,c,d){a.uniform1f(b,d.Ma.JC)};f=!0;break;case "u_position":u=function(a,b,c,d){a.uniform3fv(b,d.vj)};f=!0;break;case "u_va_frame_factor":u=
function(a,b,c){a.uniform1f(b,c.Rs)};f=!0;break;case "u_refl_plane":u=function(a,b,c){a.uniform4fv(b,c.Nb)};f=!0;break;case "u_outline_intensity":u=function(a,b,c){a.uniform1f(b,c.Zf)},f=!0}u&&(u={name:e,Kl:u,ke:b[e]},f?c.push(u):d.push(u));p&&(u={name:e,Kl:p,ke:b[e]},f?h.push(u):k.push(u))}if(d.length||k.length){a=a.Rv;for(var g in a)delete a[g];for(g=0;g<d.length;g++)u=d[g],a[u.name]=u;for(g=0;g<k.length;g++)u=k[g],a[u.name]=u}else a.Mr=!0}var t=q("__batch"),g=q("__camera"),m=q("__config"),v=q("__debug"),
x=q("__extensions"),d=q("__quat"),k=q("__subscene"),r=q("__textures"),C=q("__tsr"),B=q("__util"),F=[1,1,1,1],D=[1,1,1,1],y=[0,0,0,1],A=[0,0,0,0],H=new Uint8Array([91.8,142.8,.96*255,255]);new Float32Array([.25,-.25]);new Float32Array([-.25,.25]);new Float32Array([1,1,1,0]);new Float32Array([2,2,2,0]);var w=null,h=null,u=null,P=null,p=null,z=null,l=new Float32Array(3),M=d.create(),E=new Uint8Array(4),W=m.v;a.Ue=function(a){var b=W.background_color;a.clearColor(b[0],b[1],b[2],b[3]);a.clearDepth(1);
a.enable(a.DEPTH_TEST);a.depthFunc(a.LEQUAL);a.enable(a.CULL_FACE);a.frontFace(a.CCW);a.cullFace(a.BACK);a.enable(a.BLEND);a.blendFunc(a.ONE,a.ONE_MINUS_SRC_ALPHA);w=a};a.Dl=function(a){if(a.vb)if(a.type==k.jl){v.dw(a);var d=a.p;w.bindFramebuffer(w.READ_FRAMEBUFFER,d.io);w.bindFramebuffer(w.DRAW_FRAMEBUFFER,d.he);var h=0;d.Zb&&(h|=w.COLOR_BUFFER_BIT);d.ee&&(h|=w.DEPTH_BUFFER_BIT);w.blitFramebuffer(0,0,d.width,d.height,0,0,d.width,d.height,h,w.NEAREST);v.ew(a);v.Qt("draw resolve")}else if(a.type==
k.ht)v.dw(a),d=a.p,w.bindFramebuffer(w.FRAMEBUFFER,d.io),w.bindTexture(w.TEXTURE_2D,d.Zb.Za),w.copyTexSubImage2D(w.TEXTURE_2D,0,0,0,0,0,d.width,d.height,0),v.ew(a),v.Qt("draw copy");else{v.dw(a);d=a.p;w.bindFramebuffer(w.FRAMEBUFFER,d.he);a.Dt&&(h=d.Zb,w.framebufferTexture2D(w.FRAMEBUFFER,w.COLOR_ATTACHMENT0,h.Wa,h.Za,0));w.viewport(0,0,d.width,d.height);a.type!=k.Jc&&a.type!=k.Vd&&c(a);a.mb?w.enable(w.BLEND):w.disable(w.BLEND);a.nd?w.enable(w.DEPTH_TEST):w.disable(w.DEPTH_TEST);switch(a.type){case k.Ac:w.enable(w.POLYGON_OFFSET_FILL);
w.polygonOffset(a.self_shadow_polygon_offset,a.self_shadow_polygon_offset);w.cullFace(w.BACK);break;case k.Wc:case k.Ae:w.disable(w.POLYGON_OFFSET_FILL);w.cullFace(w.FRONT);break;case k.ze:w.enable(w.POLYGON_OFFSET_FILL);w.polygonOffset(-4,-4);w.cullFace(w.BACK);break;case k.qd:if(1<W.lc||W.NB){w.enable(w.POLYGON_OFFSET_FILL);w.polygonOffset(-2,-2);break}default:w.disable(w.POLYGON_OFFSET_FILL),w.cullFace(w.BACK)}if(a.type==k.Jc||a.type==k.Vd)for(var d=a.p,h=d.Zb.Za,f=0;6>f;f++){var p=b(f);d.rb=a.Tj[f];
C.from_mat4(d.rb,d.ye);g.Mt(d);w.framebufferTexture2D(w.FRAMEBUFFER,w.COLOR_ATTACHMENT0,p,h,0);c(a);for(var p=a.Ea,l=0;l<p.length;l++)for(var u=0;u<p[l].ka.length;u++){var r=p[l].ka[u];r.vb=r.vu[f]}e(a)}else e(a);v.ew(a);v.Qt("draw subscene: "+k.Hw(a))}};a.clear=function(a){w.bindFramebuffer(w.FRAMEBUFFER,a.p.he);c(a)};a.Ct=function(a){var b=a.on;b.length=0;var c=a.ja.zb,d=a.Qa.attributes,h;for(h in d){var k=c[h];b.push({ke:d[h],gy:4*k.offset,Fz:1<k.frames?4*k.length:0,Lb:k.Lb,Ve:4*k.Ve,xg:k.xg})}W.zt&&
n(a)};a.jG=n;a.iH=function(a){for(var b=x.Qu(),c=0;c<a.Sd.length;c++)b.deleteVertexArray(a.Sd[c]);a.Sd.length=0};a.jH=function(a){for(var b=[],c=0;c<a.length;c++)b.push(a[c]);return b};a.iG=f;a.cy=function(a){var b=a.Qa,c=a.T;a=a.Uc;w.useProgram(b.Lg);for(var d=0;d<c.length;d++)w.uniform1i(b.Rk[a[d]],d)};a.aw=function(a,b,c,d,h,k){d||(d=1);h||(h=1);k||(k=new Uint8Array(4*d*h));k.length!=4*d*h&&B.r("read_pixels(): Wrong storage");w.bindFramebuffer(w.FRAMEBUFFER,a);w.readPixels(b,c,d,h,w.RGBA,w.UNSIGNED_BYTE,
k);w.bindFramebuffer(w.FRAMEBUFFER,null);return k};a.mO=function(a){var b=a.Qa;b.Mr||(w.useProgram(b.Lg),b.Qo.length||f(b),b=b.Rv.u_cube_fog,b.Kl(w,b.ke,null,a))};a.lM=function(a,b){var c=w.createFramebuffer();w.bindFramebuffer(w.FRAMEBUFFER,c);if(r.Tl(a)){var d=a.Td;w.framebufferRenderbuffer(w.FRAMEBUFFER,w.COLOR_ATTACHMENT0,w.RENDERBUFFER,d)}else if(r.Ul(a)){var h=a,d=h.Za,h=h.Wa==w.TEXTURE_CUBE_MAP?w.TEXTURE_CUBE_MAP_NEGATIVE_Z:h.Wa;w.framebufferTexture2D(w.FRAMEBUFFER,w.COLOR_ATTACHMENT0,h,d,
0)}r.Tl(b)?(d=b.Td,w.framebufferRenderbuffer(w.FRAMEBUFFER,w.DEPTH_ATTACHMENT,w.RENDERBUFFER,d)):r.Ul(b)&&(h=b,d=h.Za,h=h.Wa,w.framebufferTexture2D(w.FRAMEBUFFER,w.DEPTH_ATTACHMENT,h,d,0));v.QG();w.bindFramebuffer(w.FRAMEBUFFER,null);return c};a.kM=function(a,b,c,d,h){null==a?(w.bindFramebuffer(w.FRAMEBUFFER,a),w.viewport(0,0,d,h),w.clear(w.COLOR_BUFFER_BIT|w.DEPTH_BUFFER_BIT)):(r.Tl(b)?w.deleteRenderbuffer(b.Td):r.Ul(b)&&w.deleteTexture(b.Za),r.Tl(c)?w.deleteRenderbuffer(c.Td):r.Ul(c)&&w.deleteTexture(c.Za),
w.deleteFramebuffer(a))};a.lR=function(){};a.MI=function(a,b,c,d,h,k){a=a.Za;w.viewport(0,0,c,c);w.framebufferTexture2D(w.FRAMEBUFFER,w.COLOR_ATTACHMENT0,b,a,0);b=t.eu("FLIP_CUBEMAP_COORDS");a=b.Qa;w.activeTexture(w.TEXTURE0);w.bindTexture(w.TEXTURE_2D,h);var e=h=0;c!=d&&(h=1/(6*d),e=1/(4*d));w.uniform1i(a.Rk.u_tex_number,k);w.uniform2fv(a.Rk.u_delta,[h,e]);w.useProgram(a.Lg);z(b,0);w.bindTexture(w.TEXTURE_2D,null)};a.NI=function(a,b,c,d,h){w.bindFramebuffer(w.FRAMEBUFFER,d);d=a.Za;a=a.Wa;w.bindTexture(a,
d);w.viewport(0,0,b,c);w.texImage2D(a,0,w.RGBA,b,c,0,w.RGBA,w.UNSIGNED_BYTE,null);w.framebufferTexture2D(w.FRAMEBUFFER,w.COLOR_ATTACHMENT0,a,d,0);b=t.eu("NONE");c=b.Qa;w.bindTexture(a,null);w.activeTexture(w.TEXTURE0);w.bindTexture(a,h);w.useProgram(c.Lg);z(b,0);w.bindFramebuffer(w.FRAMEBUFFER,null);w.bindTexture(a,null)};a.cleanup=function(){};a.LM=function(){var a=x.dK(),b=x.Qu();W.Wx=a?!0:!1;W.zt=b?!0:!1;a?(h=function(b,c,d,h,k){a.drawElementsInstanced(b,c,d,h,k)},u=function(b,c){a.vertexAttribDivisor(b,
c)},P=function(b,c,d,h){a.drawArraysInstanced(b,c,d,h)}):(h=function(a,b,c,d){w.drawElements(a,b,c,d)},u=function(){},P=function(a,b,c){w.drawArrays(a,b,c)});b?(p=function(a){b.bindVertexArray(a)},z=function(a,b){var c=a.ja;p(a.Sd[b]);c.nf?h(c.mode,c.count,c.kk,0,c.nk):P(c.mode,0,c.count,c.nk);p(null)}):z=function(a,b){var c=w,d=a.ja,k=a.on;c.bindBuffer(c.ARRAY_BUFFER,d.Vh);for(var e=0;e<k.length;e++){var f=k[e];c.enableVertexAttribArray(f.ke);c.vertexAttribPointer(f.ke,f.Lb,c.FLOAT,!1,f.Ve,f.gy+
f.Fz*b);u(f.ke,f.xg)}d.nf?(c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,d.nf),h(d.mode,d.count,d.kk,0,d.nk)):P(d.mode,0,d.count,d.nk);for(e=0;e<k.length;e++)f=k[e],c.disableVertexAttribArray(f.ke)}};a.reset=function(){P=u=h=w=null}};b4w.module.__shaders=function(a,q){function e(a,b,d){var h=a.qi;"string"==typeof d?(a=c(a,d))&&(d=a[1]):d=String(d);for(a=0;a<h.length;a++)if(h[a][0]==b){h[a][1]=d;break}}function c(a,b){for(var c=a.qi,d=0;d<c.length;d++)if(c[d][0]==b)return c[d];return!1}function b(a,b){var c=a+b;if(!(c in Z)){var d=r(E.shaders_dir,a),h=r(E.shaders_dir,b),d=B(d),h=B(h),k;for(k in h)d[k]=h[k];h=[];for(k in d)h.push([k,d[k]]);Z[c]=h}return Z[c]}function n(a,b){return a+b}function f(a,b){return(a.split(";").map(function(a){return(a=
a.match(b))&&(a[3]?parseInt(a[3]):1)}).filter(function(a){return a})||[]).reduce(n,0)}function t(a,b){var c=k(a.type),d=k(b.type),h=a.zj,e=b.zj;return c>d?-1:c<d?1:h>e?-1:h<e?1:0}function g(a){if(l.Vb){a=a.replace(/(.*?)\([^()]*?\)(.*?)/g,"$1$2");var b=ga}else b=R;a=a.split(";").map(function(a){return(a=a.match(b))&&{type:a[2],zj:a[4]?parseInt(a[4]):1}}).filter(function(a){return a});return v(a,Q,M.Er)}function m(a,b,c){a=a.split(";").map(function(a){return(a=a.match(U))&&{type:a[2],zj:a[4]?parseInt(a[4]):
1}}).filter(function(a){return a});return v(a,b,c)}function v(a,b,c){function h(){for(var c=0;g<a.length;){var e=a[g];if(3!=k(e.type))break;c+=d(e.type)*e.zj;g++}l=u+c;if(l>ha)return!1;x(b,u,c,0,3);return!0}function e(){for(var c=ha-l,h=c,f=c;g<a.length;){var p=a[g];if(2!=k(p.type))break;p=d(p.type)*p.zj;if(p<=h)h-=p;else if(p<=f)f-=p;else return!1;g++}f=c-f;x(b,l,c-h,0,2);x(b,ha-f,f,2,2);return!0}function f(){for(;g<a.length;){for(var h=a[g],h=d(h.type)*h.zj,k=-1,e=c+1,p=-1,l=0;4>l;l++){var u=ca;
u[0]=0;u[1]=1;var r;r=b;for(var m=l,n=h,w=u;N<r.length&&15===r[N];)N++;for(;0<ha&&15===r[ha];)ha--;if(ha-N<n)r=!1;else{for(var m=1<<m,z=0,K=-1,v=r.length+1,t=!1,A=N;A<=ha;A++)A<ha&&!(r[A]&m)?t||(z=A,t=!0):(t&&(t=A-z,t>=n&&t<v&&(v=t,K=z)),t=!1);0>K?r=!1:(w[0]=K,w[1]=v,r=!0)}r&&u[1]<e&&(p=u[0],e=u[1],k=l)}if(0>k)return!1;x(b,p,h,k,1);g++}return!0}if(!a.length)return!0;for(var p=0;p<c;p++)b[p]=0;ha=c;a.sort(t);var l=0,u=0,g=0;return function(){for(;g<a.length;){var c=a[g];if(4!=k(c.type))break;u+=d(c.type)*
c.zj;g++}if(u>ha)return!1;N=u;x(b,0,u,0,4);return!0}()&&h()&&e()&&f()}function x(a,b,c,d,h){for(var k=0,e=0;e<h;e++)k|=1<<d+e;for(e=0;e<c;e++)a[b+e]|=k}function d(a){var b=0;switch(a){case "mat4":b=4;break;case "mat3":b=3;break;case "mat2":b=2;break;default:b=1}return b}function k(a){var b=0;switch(a){case "mat4":case "vec4":case "ivec4":case "bvec4":case "mat2":b=4;break;case "mat3":case "vec3":case "ivec3":case "bvec3":b=3;break;case "vec2":case "ivec2":case "bvec2":b=2;break;default:b=1}return b}
function r(a,b){var c=a+b;if(G[c])return G[c];if(J){var d=J[b];if(!d)return null;d=q("__gpp_parser").GR.parse(d)}else if(d=q("shader_texts")[b],!d)return null;return G[c]=d}function C(a,b){for(var c={},d=b.qi||[],h=0;h<d.length;h++)c[d[h][0]]=[d[h][1]];for(h=0;h<b.Vf.length;h++)c["USE_NODE_"+b.Vf[h].id]=["1"];l.Vb?(c.GLSL1=["0"],c.GLSL3=["1"],c.GLSL_VERSION=["300 es"],c.GLSL_IN=["in"],c.GLSL_OUT=["out"],c.GLSL_OUT_FRAG_COLOR=["glsl_out_frag_color"],c.GLSL_TEXTURE=["texture"],c.GLSL_TEXTURE_CUBE=["texture"],
c.GLSL_TEXTURE_PROJ=["textureProj"],c.GLSL_SMPLR2D_SHDW=["sampler2DShadow"]):(c.GLSL1=["1"],c.GLSL3=["0"],c.GLSL_VERSION=["100"],c.GLSL_IN="vert"==a?["attribute"]:["varying"],c.GLSL_OUT="vert"==a?["varying"]:[""],c.GLSL_OUT_FRAG_COLOR=["gl_FragColor"],c.GLSL_TEXTURE=["texture2D"],c.GLSL_TEXTURE_CUBE=["textureCube"],c.GLSL_TEXTURE_PROJ=["texture2DProj"],c.GLSL_SMPLR2D_SHDW=["sampler2D"]);for(var k in c)c[k][0].constructor!=String&&p.warn("Warning! The value of a directive '"+k+"' is not of type string.");
return c}function B(a){function b(a){"var"==a.a?d[a.c]=a.b.join(""):"include"==a.a&&(a=r(E.shaders_dir,E.$B+a.o),c(a,b))}function c(a,b,d){if(a instanceof Array)for(var h=0;h<a.length;h++)c(a[h],b,d);else if(a instanceof Object&&a){b&&b(a);for(h in a)c(a[h],b,d);d&&d(a)}}var d={};c(a,b);return d}function F(a,b,c){function d(b){b=b.d;for(var c=0;c<b.length;c++){var l=b[c];switch(l.a){case "cond":a:for(var l=l.d,ba=0;ba<l.length;ba++){var g=l[ba];switch(g.a){case "if":case "elif":if(h(g.e)){d(g.h);
break a}break;case "else":d(g.h);break a;case "ifdef":g.c in K&&d(g.h);break;case "ifndef":g.c in K||d(g.h)}}break;case "include":l=l.o;ba=r(E.shaders_dir,E.$B+l);x.push("include/"+l);d(ba);x.pop();break;case "var":break;case "define":K[l.c]=l.b;break;case "error":z.r("Shader error: #error "+l.b.join(" "));break;case "line":break;case "pragma":n.push("#pragma "+l.c+" "+l.b.join(" "));break;case "undef":delete K[l.c];break;case "warning":p.warn("Shader warning: #warning "+l.b.join(" "));break;case "extension":l=
u(l.b,K,v,!1);n.push("#extension "+l.join(" "));break;case "version":l=u(l.b,K,v,!1),n.push("#version "+l.join(" "));case "#":break;case "node":t[l.c]=l;break;case "nodes_global":l=m;for(ba=0;ba<l.length;ba++){var g=l[ba],N=t[g.id];if(N)for(var y=0,M=0;M<N.l.length;M++){var B=N.l[M];if("node_param"==B.a){var C;if("PARTICLE_INFO"==g.id&&B.f)if(1==K.PARTICLE_BATCH)switch(C=!1,y){case 0:C=w(g.Rb,"PART_INFO_IND")||w(g.Rb,"PART_INFO_AGE")||w(g.Rb,"PART_INFO_LT")||w(g.Rb,"PART_INFO_SIZE");break;case 1:C=
w(g.Rb,"PART_INFO_LOC");break;case 2:C=w(g.Rb,"PART_INFO_VEL");break;case 3:C=w(g.Rb,"PART_INFO_A_VEL");break;case 4:C=w(g.Rb,"PART_INFO_IND")}else C=!1;else C=!0;C&&(B=B.g.join(" ")+" ","vert"==a?B+=g.nj[y]:"frag"==a&&(B+=g.V[y],null!==g.Vr[y]&&(B+="="+g.Vr[y])),B+=";",f(e(B)));y++}}}break;case "nodes_main":l=m;for(ba=0;ba<l.length;ba++)if(g=l[ba],N=t[g.id]){y={};O=Q=q=0;M=N;B=g;C=M;for(var ca={},X=0;X<C.m.length;X++){var qa=C.m[X];ca[qa.c]=[qa.b.join("")]}C=ca;for(ca=0;ca<B.Rb.length;ca++)X=B.Rb[ca][0],
X in C&&(C[X]=[B.Rb[ca][1]]);for(ca=X=0;ca<M.l.length;ca++)qa=M.l[ca],"node_out"==qa.a&&(C["USE_OUT_"+qa.c]=[-1<A.indexOf(B.Ya[X])|0],X++);M=C;B=g;C=N.l;ca=y;X=M;for(qa=0;qa<C.length;qa++){var R=C[qa];switch(R.a){case "node_in":var P=B.K[q];if(null!==B.Zu[q]){if(("MATERIAL_BEGIN"==B.id&&3===q||!X.MATERIAL_EXT&&("MATERIAL_BEGIN"==B.id&&4===q||"MATERIAL_END"==B.id&&3===q||"MATERIAL_END"==B.id&&4===q||"MATERIAL_END"==B.id&&5===q)||"TEXTURE_COLOR"==B.id||"TEXTURE_NORMAL"==B.id)&&R.f){ca[R.c]=B.Zu[q];
q++;continue}var H=R.g.join(" ")+" ",H=H+(P+"="+B.Zu[q]+";");f(e(H))}ca[R.c]=P;q++;break;case "node_out":P=B.Ya[Q];if(!R.f||-1<A.indexOf(P))H=R.g.join(" ")+" ",H+=P+";",f(e(H)),ca[R.c]=P;Q++;break;case "node_param":"vert"==a?P=B.nj[O]:"frag"==a&&(P=B.V[O]),ca[R.c]=P,O++}}n.push("{");k(g,N.j,y,M);n.push("}")}break;case "txt":f(l.b);break;default:z.r("Unknown element type: "+l.a)}}}function h(a,b){var c;c=u(a,K,v,!0,b);for(var d=[],k=0;k<c.length;k++)if(c[k]instanceof Object)switch(c[k].a){case "conditional_expr":var e=
d.pop(),f=d.pop();d.pop()?d.push(f):d.push(e);break;case "logical_or_expr":for(var f=d.pop(),l=0;l<c[k].i-1;l++)e=d.pop(),f=f||e;d.push(f);break;case "logical_and_expr":f=d.pop();for(l=0;l<c[k].i-1;l++)e=d.pop(),f=f&&e;d.push(f);break;case "logical_bitor_expr":f=d.pop();for(l=0;l<c[k].i-1;l++)f|=d.pop();d.push(f);break;case "logical_bitxor_expr":f=d.pop();for(l=0;l<c[k].i-1;l++)f^=d.pop();d.push(f);break;case "logical_bitand_expr":f=d.pop();for(l=0;l<c[k].i-1;l++)f&=d.pop();d.push(f);break;case "equal_expr":e=
d.pop();f=d.pop();d.push(f==e);break;case "non_equal_expr":e=d.pop();f=d.pop();d.push(f!=e);break;case "le_expr":e=d.pop();f=d.pop();d.push(f<=e);break;case "ge_expr":e=d.pop();f=d.pop();d.push(f>=e);break;case "l_expr":e=d.pop();f=d.pop();d.push(f<e);break;case "g_expr":e=d.pop();f=d.pop();d.push(f>e);break;case "left_shift_expr":f=d.pop();e=d.pop();d.push(f<<e);break;case "right_shift_expr":f=d.pop();e=d.pop();d.push(f>>e);break;case "add_expr":f=d.pop();e=d.pop();d.push(f+e);break;case "sub_expr":f=
d.pop();e=d.pop();d.push(f-e);break;case "mul_expr":f=d.pop();e=d.pop();d.push(f*e);break;case "div_expr":f=d.pop();e=d.pop();d.push(f/e);break;case "mod_expr":f=d.pop();e=d.pop();d.push(f%e);break;case "pre_inc_expr":case "post_inc_expr":e=d.pop();d.push(++e);break;case "pre_dec_expr":case "post_dec_expr":e=d.pop();d.push(--e);break;case "positive_expr":e=d.pop();d.push(+e);break;case "negative_expr":e=d.pop();d.push(-e);break;case "one_compl_expr":e=d.pop();d.push(~e);break;case "logic_negative_expr":e=
d.pop();d.push(!e);break;default:z.r("Unknown operation type: "+c[k].a)}else e=c[k],/^[a-zA-Z_$][a-zA-Z_$0-9]*$/.test(e)?(d.push(0),0!=e.indexOf("USE_NODE_")&&(f=x[x.length-1],f in N||(N[f]=[]),-1==N[f].indexOf(e)&&(N[f].push(e),p.error("Undefined directive '"+e+"' in shader '"+f+"'. Should it be defined with #var/#node_var or #define?")))):d.push(parseFloat(c[k]));1==d.length?c=d[0]:(z.r("Incorrect expression: "+c.join(" ")),c=void 0);return c}function k(a,b,c,d){for(var e=0;e<b.length;e++){var l=
b[e];switch(l.a){case "node_cond":a:for(var p=a,l=l.d,u=c,g=d,r=0;r<l.length;r++){var m=l[r];switch(m.a){case "node_if":case "node_elif":if(h(m.e,g)){k(p,m.j,u,g);break a}break;case "node_else":k(p,m.j,u,g);break a;case "node_ifdef":(m.c in K||m.c in g)&&k(p,m.j,u,g);break;case "node_ifndef":m.c in K||m.c in g||k(p,m.j,u,g)}}break;case "txt":p=[];for(u=0;u<l.b.length;u++)g=l.b[u],g in c?p.push(c[g]):p.push(g);f(p,d)}}}function e(a){return a.match(/([\d]+\.[\d]+|[\w]+|[^\s])/g)}function f(b,c){var d=
b;l.Vb||"frag"!=a||(d=d.join(" "),B&&(d.match(/[^;]*;/)?(d=d.replace(/[^;]*;/,""),B=!1):d=""),d=d.replace(/GLSL_OUT [^;]*;/g,""),d.match(/GLSL_OUT(?:$| [^;]*)/)&&(d=d.replace(/GLSL_OUT(?:$| [^;]*)/,""),B=!0),d=d.replace(/ {2,}/g," "),d=(d=d.trim())?d.split(" "):[]);b=d;b.length&&(d=u(b,K,v,!1,c),n.push(d.join(" ")))}function u(a,b,c,d,h){var e=[];g(a,b,c,d,e,h);return e}function g(a,b,c,d,h,e){for(var k=0;k<a.length;k++){var f=a[k];if(e&&f in e)f=e[f];else if(f in b)f=b[f];else{h.push(f);continue}0==
f.length&&d?h.push(0):g(f,b,c,d,h,e)}}var m=c.Vf,n=[],K=C(a,c),v={},x=[c[a]],N={},t={},A=[],y;for(y in m)for(var M in m[y].K)A.push(m[y].K[M]);var B=!1;d(b);var q=0,Q=0,O=0;return n.join("\n")}function D(a,b,c){c=a.createShader(c);a.shaderSource(c,b);a.compileShader(c);return c}function y(a){na.deleteProgram(a.Lg);na.deleteShader(a.Ws);na.deleteShader(a.Nq);delete W[a.fp]}function A(a,b){!b&&a.length?b=a.length:b||(b=1);switch(b){case 1:return H(a);case 2:return"vec2("+H(a[0])+","+H(a[1])+")";case 3:return"vec3("+
H(a[0])+","+H(a[1])+","+H(a[2])+")";case 4:return"vec4("+H(a[0])+","+H(a[1])+","+H(a[2])+","+H(a[3])+")";case 9:return"mat3("+H(a[0])+","+H(a[1])+","+H(a[2])+","+H(a[3])+","+H(a[4])+","+H(a[5])+","+H(a[6])+","+H(a[7])+","+H(a[8])+")";case 16:return"mat4("+H(a[0])+","+H(a[1])+","+H(a[2])+","+H(a[3])+","+H(a[4])+","+H(a[5])+","+H(a[6])+","+H(a[7])+","+H(a[8])+","+H(a[9])+","+H(a[10])+","+H(a[11])+","+H(a[12])+","+H(a[13])+","+H(a[14])+","+H(a[15])+")";default:z.r("Wrong glsl value dimension")}}function H(a){return a%
1?String(a):String(a)+".0"}function w(a,b){for(var c=0;c<a.length;c++)if(a[c][0]==b)return!0;return!1}var h=q("__assets"),u=q("__config"),P=q("__debug"),p=q("__print"),z=q("__util"),l=u.v,M=u.jh,E=u.Md,W={},G={},J=null,Z={},L="anchors.glslf anchors.glslv color_id.glslf color_id.glslv shadow.glslf shadow.glslv error.glslf error.glslv grass_map.glslf grass_map.glslv halo.glslf halo.glslv line.glslf line.glslv main.glslf main.glslv main_stack.glslf particle_system.glslf particle_system_stack.glslf particle_system.glslv procedural_skydome.glslf procedural_skydome.glslv special_lens_flares.glslf special_lens_flares.glslv special_skydome.glslf special_skydome.glslv special_water.glslf special_water.glslv debug_view.glslf debug_view.glslv postprocessing/antialiasing.glslf postprocessing/bloom_combine.glslf postprocessing/coc.glslf postprocessing/compositing.glslf postprocessing/depth_pack.glslf postprocessing/dof.glslf postprocessing/glow.glslf postprocessing/bloom_blur.glslf postprocessing/god_rays.glslf postprocessing/god_rays.glslv postprocessing/god_rays_combine.glslf postprocessing/luminance.glslf postprocessing/luminance_av.glslf postprocessing/luminance_trunced.glslf postprocessing/luminance_trunced.glslv postprocessing/motion_blur.glslf postprocessing/outline.glslf postprocessing/performance.glslf postprocessing/postprocessing.glslf postprocessing/postprocessing.glslv postprocessing/smaa.glslf postprocessing/smaa.glslv postprocessing/ssao.glslf postprocessing/ssao_blur.glslf postprocessing/stereo.glslf include/blending.glslf include/caustics.glslf include/color_util.glslf include/depth_fetch.glslf include/dynamic_grass.glslv include/environment.glslf include/fog.glslf include/fxaa.glslf include/halo_color.glslf include/lighting_nodes.glslf include/math.glslv include/mirror.glslf include/nodes.glslf include/nodes.glslv include/pack.glslf include/particles.glslv include/particles_nodes.glslf include/particles_nodes.glslv include/precision_statement.glslf include/procedural.glslf include/refraction.glslf include/scale_texcoord.glslv include/shadow.glslf include/shadow.glslv include/skin.glslv include/std.glsl include/to_world.glslv include/wind_bending.glslv".split(" ");
a.ut=0;a.FD=1;a.ED=2;a.ID=4;a.HD=8;a.GD=16;a.yD=32;var O=/(?:^|[^a-zA-Z_])uniform.*?(sampler2D|samplerCube)(?=\s)(.*?\[\s*([0-9]*)\s*\])?/,U=/(?:^|[^a-zA-Z_])(uniform)(?=\s)\s*(float|vec2|vec3|vec4|ivec2|ivec3|ivec4|bvec2|bvec3|bvec4|mat2|mat3|mat4|sampler2D|samplerCube)\s*(.*?\[\s*([0-9]*)\s*\])?/,ga=/(?:^|[^a-zA-Z_])(in)(?=\s)\s*(float|vec2|vec3|vec4|mat2|mat3|mat4)\s*(.*?\[\s*([0-9]*)\s*\])?/,R=/(?:^|[^a-zA-Z_])(varying)(?=\s)\s*(float|vec2|vec3|vec4|mat2|mat3|mat4)\s*(.*?\[\s*([0-9]*)\s*\])?/,
ca=new Int16Array(2),Q=null,ta=null,K=null,N=0,ha=0,qa=[],na=null,ra=!1;a.Ue=function(a){na=a};a.W=e;a.VJ=c;a.JM=function(a){a.qi=z.ih(b(a.Wg,a.kf));e(a,"PRECISION",u.v.precision);"highp"==u.v.precision?e(a,"EPSILON",A(1E-6)):e(a,"EPSILON",A(1E-4));e(a,"CONSTANTS_HACK",l.rw|0)};a.dR=function(a){return a.Wg};a.VQ=function(a){return a.kf};a.QJ=function(a){var b=JSON.stringify(a.Wg)+JSON.stringify(a.kf)+JSON.stringify(a.qi)+JSON.stringify(a.Vf),c=W[b];if(c)return c;var d=a.kf,h=r(E.shaders_dir,a.Wg),
d=r(E.shaders_dir,d);if(!h||!d)return null;var h=F("vert",h,a),d=F("frag",d,a),c=0,e=f(d,O);a.GC=e;e>M.rv&&(c|=1);Q||(Q=new Uint32Array(M.Er));ta||(ta=new Uint32Array(M.Fo));K||(K=new Uint32Array(M.Go));m(d,ta,M.Fo)||(c|=2);m(h,K,M.Go)||(c|=4);e=l.Vb?(h.replace(/(.*?)\([^()]*?\)(.*?)/g,"$1$2").match(/(?:^|[^a-zA-Z_])in(?=\s)/g)||[]).length:(h.match(/(?:^|[^a-zA-Z_])attribute(?=\s)/g)||[]).length;a.dy=e;e>M.sv&&(c|=8);g(d)||(c|=16);a.status=c;if(0===a.status){var c=na,k=D(c,h,c.VERTEX_SHADER),p=D(c,
d,c.FRAGMENT_SHADER),e=c.createProgram();c.attachShader(e,k);c.attachShader(e,p);c.linkProgram(e);for(var k={Ws:k,Nq:p,Lg:e,attributes:{},Rk:{},Qo:z.pi(),Qv:z.pi(),Rv:{},Io:!0,Mr:!1,SC:z.pi(),RC:z.pi(),qb:z.ih(a),fp:b,md:!0},u=c.getProgramParameter(e,c.ACTIVE_ATTRIBUTES),p=0;p<u;p++){var n=c.getActiveAttrib(e,p).name;k.attributes[n]=c.getAttribLocation(e,n)}u=c.getProgramParameter(e,c.ACTIVE_UNIFORMS);for(p=0;p<u;p++)n=c.getActiveUniform(e,p).name.split("[0]").join(""),k.Rk[n]=c.getUniformLocation(e,
n);W[b]=c=k;e=!na.getShaderParameter(c.Nq,na.COMPILE_STATUS);k=!na.getShaderParameter(c.Ws,na.COMPILE_STATUS);p=!na.getProgramParameter(c.Lg,na.LINK_STATUS);e?P.GB(c.Nq,b,d):k?P.GB(c.Ws,b,h):p&&P.rM(c.Lg,b,h,d);if(e||k||p)a.status|=32,c=null}else c=null;return c};a.fL=function(){ra=!1;if(b4w.module_check("shader_texts"))ra=!0;else{for(var a=[],b=h.AT_TEXT,c=0;c<L.length;c++){var d=z.Jo(E.shaders_dir+L[c]);a.push({id:L[c],type:b,url:d})}b=function(a,b){J||(J={});J[b]=a};a.length?h.enqueue(a,b,function(){ra=
!0}):p.error("Shaders have not been found.")}};a.Jy=function(){return ra};a.yQ=function(){return qa};a.Tz=function(){return W};a.cleanup=function(){for(var a in W)y(W[a]);for(var b in G)delete G[b];for(var c in qa)delete qa[c];K=ta=Q=null;Z={}};a.hH=y;a.zQ=function(a){var b=a.qi;p.log("Shader: "+a.Wg+" "+a.kf+", "+String(b.length)+" directives: ");for(a=0;a<b.length;a++)p.log("  "+b[a][0],b[a][1])};a.F=A;a.Ky=function(a,b){return b in a.Rk?!0:!1};a.reset=function(){na=null}};b4w.module.__geometry=function(a,q){function e(a,b){for(var c=b.a_tbn_quat,d=b.a_position,h=c.length,e=d.length,k=1;k<a.La.length;k++)for(var f=a.La[k].Ne,p=a.La[k].vo,f=f.a_position,u=0;u<e;u++)d[u]+=p*f[u];d=L;for(k=0;k<h;k+=4){e=c.subarray(k,k+4);d.set(E.il);for(u=1;u<a.La.length;u++)f=a.La[u].Ne,p=a.La[u].vo,p=l.slerp(E.il,f.a_tbn_quat,p,O),l.normalize(p,p),l.multiply(p,d,d);l.multiply(d,e,e)}}function c(a){return 65536<a.sa?p.Vz()?!1:!0:!1}function b(a){return 0<a.lb.length?!0:!1}function n(a,
c,d){if(!b(a))return a;d||z.log('%cDEBUG max vertices exceeded for indexed submesh "'+a.name+'": '+a.sa*(c||1)+", will use drawArrays","color: #aa0");c=a.lb;d=a.sa;var h=a.aa,e=a.P,k;for(k in h){var p=h[k],l=D(p,d);h[k]=f(c,p,l)}for(h=0;h<e.length;h++){var u=e[h];for(k in u)p=u[k],l=D(p,d),u[k]=f(c,p,l)}for(h=0;h<a.La.length;h++){k=a.La[h].Ne;for(var g in k)p=k[g],l=D(p,d),k[g]=f(c,p,l)}a.sa=c.length;a.lb=new Uint16Array(0);return a}function f(a,b,c){if(0==b.length)return new Float32Array(0);for(var d=
new Float32Array(a.length*c),h=0;h<a.length;h++)for(var e=a[h],k=0;k<c;k++)d[c*h+k]=b[c*e+k];return d}function t(){return{ie:null,Hc:null,kk:0,count:0,zb:{},mode:0,Sk:0,yl:0,yq:0,Vh:null,nf:null,Pl:null,La:null,nk:1,md:!0}}function g(a,b){var c=a.Hc,d=a.zb[b];if(d)return c.subarray(d.offset,d.offset+d.length);E.r("extract_array() failed; invalid name: "+b)}function m(b,c){var d,h;switch(c){case a.Ym:case a.Hp:d=R.TRIANGLES;h=R.STATIC_DRAW;break;case a.zx:d=R.POINTS;h=R.STATIC_DRAW;break;case a.Gp:d=
R.TRIANGLES;h=R.DYNAMIC_DRAW;break;case a.zD:d=R.POINTS;h=R.DYNAMIC_DRAW;break;case a.AD:d=R.LINES;h=R.STATIC_DRAW;break;default:E.r("Wrong draw_mode")}b.mode=d;b.Sk=h}function v(a){a.ie?(a.nf||(a.nf=R.createBuffer()),R.bindBuffer(R.ELEMENT_ARRAY_BUFFER,a.nf),R.bufferData(R.ELEMENT_ARRAY_BUFFER,a.ie,a.Sk),a.yl=a.ie.byteLength):a.yl=0;a.Vh||(a.Vh=R.createBuffer());R.bindBuffer(R.ARRAY_BUFFER,a.Vh);R.bufferData(R.ARRAY_BUFFER,a.Hc,a.Sk);a.yq=a.Hc.byteLength}function x(a,b){a.J=P.ji(a.J,b);a.Z=P.rl(a.Z,
b);a.da=P.sl(a.da,b)}function d(a){var b=a[0],c;c=a[0];if(c.Qf){var d=E.L(c);d.name="INSTANCED_ARRAY_SUBMESH"}else{for(var d=u("JOIN_"+a.length+"_SUBMESHES"),h=0,e=0;e<a.length;e++)h+=a[e].lb.length;d.lb=new Uint32Array(h);var k=h=0;if(0<a[0].La.length)for(var f=0;f<a[0].La.length;f++){for(e=0;e<a.length;e++)h+=a[e].La[f].Ne.a_position.length,k+=a[e].La[f].Ne.a_tbn_quat.length;e={a_position:new Float32Array(h),a_tbn_quat:new Float32Array(k)};d.La.push({vo:a[0].La[f].vo,Ne:e})}for(e=h=0;e<a.length;e++)h+=
a[e].sa;d.sa=h;for(var p in c.aa){for(e=h=0;e<a.length;e++)h+=a[e].aa[p].length;d.aa[p]=new Float32Array(h)}for(p in c.P[0]){for(e=h=0;e<a.length;e++)h+=a[e].P[0][p].length;for(e=0;e<c.P.length;e++)d.P[e]=d.P[e]||{},d.P[e][p]=new Float32Array(h)}}c=d;k=c.Xe;k.J=P.tl(b.Xe.J);var l=f=0,g=[],d=[];p={};e={};for(h=0;h<a.length;h++){var r=a[h],m=r.lb,n=r.sa,w=r.aa,z=r.Xe.J,v=r.Xe.da;P.co(z,ga);P.Gq(k.J,z);P.tz(k.da,v);for(z=0;z<ga.length;z++)g.push(ga[z]);if(v=a[h].Qf){r=v.Km;n=v.As;for(z=0;z<r.length;z++)w=
r[z],v.Yn||(w=M.multiply(n,r[z],M.create())),d.push(w);var z=v.op,x;for(x in z)x in p||(p[x]=[z[x][0]]);r=v.Fk;for(x in r)for((x in e)||(e[x]={Lb:r[x].Lb,data:[]}),n=r[x].data,w=e[x].data,z=0;z<n.length;z++)w.push(n[z])}else{for(z=0;z<m.length;z++)c.lb[f+z]=m[z]+l;var f=f+m.length,t;for(t in w)v=w[t],m=l*D(v,n),c.aa[t].set(v,m);for(z=0;z<r.P.length;z++){var w=r.P[z],A=c.P[z];for(t in w)v=w[t],m=l*D(v,n),A[t].set(v,m)}l+=n}}k.Z=P.rq(E.f32(g),!0);if(0<c.La.length)for(h=0;h<c.La.length;h++)for(x=c.La[h].Ne,
z=k=t=0;z<a.length;z++)f=a[z].La[h].Ne,x.a_position.set(f.a_position,t),x.a_tbn_quat.set(f.a_tbn_quat,k),t+=f.a_position.length,k+=f.a_tbn_quat.length;d.length&&(c.Qf={Km:d,As:null,qC:!0,op:p,Fk:e,Yn:b.Qf.Yn});return c}function k(a,b,c){b=b.Xe;for(var d=P.Mc(),h=[],e=0;e<c.length;e++){P.ji(a.Xe.J,c[e],d);P.Gq(b.J,d);P.co(d,ga);for(var k=0;k<ga.length;k++)h.push(ga[k])}b.Z=P.rq(E.f32(h),!0);b.da=P.vl(b.Z)}function r(a,b,c,d,h,e){var k=a.submeshes[b],f=k.base_length,p=u("SUBMESH_"+a.name+"_"+a.materials[b].name);
p.sa=f;var l=!1;if(B(c,"a_texcoord")){var g=null,r=a.materials[b];b=a.submeshes[b];if(r.texture_slots.length)switch(r=r.texture_slots[0],r.texture_coords){case "UV":r=a.uv_textures.indexOf(r.uv_layer);0==r?g=new Float32Array(b.texcoord):1==r&&(g=new Float32Array(b.texcoord2));break;case "ORCO":for(var m=a.b4w_bounding_box_source,g=new Float32Array(2*b.base_length),r=(m.max_x+m.min_x)/2,v=(m.max_y+m.min_y)/2,x=m.max_x-m.min_x,m=m.max_y-m.min_y,t=0,A=0;A<b.position.length;A+=3)g[t++]=(b.position[A]-
r)/x+.5,g[t++]=(b.position[A+1]-v)/m+.5}null===g&&(g=new Float32Array(2*b.base_length));b=g}else b=new Float32Array(0);if(B(c,"a_orco_tex_coord")){g=a.b4w_bounding_box_source;r=new Float32Array(3*k.base_length);v=g.max_x-g.min_x;x=g.max_y-g.min_y;m=g.max_z-g.min_z;for(A=t=0;A<k.position.length;A+=3)0==v?r[t++]=.5:r[t++]=E.clamp(parseFloat(((k.position[A]-g.min_x)/v).toFixed(5)),0,1),0==x?r[t++]=.5:r[t++]=E.clamp(parseFloat(((k.position[A+1]-g.min_y)/x).toFixed(5)),0,1),0==m?r[t++]=.5:r[t++]=E.clamp(parseFloat(((k.position[A+
2]-g.min_z)/m).toFixed(5)),0,1);g=r}else g=new Float32Array(0);var y,r=k.group;if(B(c,"a_influence")&&d){v=new Float32Array(4*f);x=r.length/f;m=new Float32Array(x);for(t=0;t<x;t++)for(y in m[t]=-1,d)if(A=d[y],A.lD===t){m[t]=A.qu;break}var M=3<x?x:4;d=new Float32Array(M);y=new Uint32Array(M);for(var t=new Float32Array(4),A=new Float32Array(M),M=new Uint32Array(M),q=new Float32Array(4),O=0;O<f;O++)d.set(A),y.set(M),t.set(q),v.set(F(r,x,O,f,m,d,y,t),4*O)}else v=new Float32Array(0);y=v;d=h?E.L(h):{};
d.a_color={gk:!0};d.a_color.src=B(c,"a_color")&&a.active_vcol_name?[{name:a.active_vcol_name,pf:7}]:[];h={a_texcoord:b,a_influence:y,a_orco_tex_coord:g};y=k.vertex_colors;b=k.color;g=a.name;r=[];for(v=0;v<y.length;v++)r.push(y[v].name);for(var aa in d)if(v=d[aa].src,v.length){for(m=x=0;m<v.length;m++)x+=E.Jk(v[m].pf);h[aa]=new Float32Array(x*f);for(m=t=0;m<v.length;m++){var T=v[m].name,A=v[m].pf,M=E.JB(A),xa=r.indexOf(T);-1==xa&&E.r('vertex color "'+T+'" for mesh "'+g+'" not found.');q=y[xa].mask;
O=E.Jk(q);(A&q)!==A&&z.error("Wrong color extraction from "+T+" to "+aa+".");for(var R=T=0;R<xa;R++)T+=E.Jk(y[R].mask);xa=T*f;for(T=0;T<f;T++)for(R=0;3>R;R++)M[R]&&(h[aa][T*x+(t+E.om(A,R))]=b[xa+T*O+E.om(q,R)]);t+=O}}else h[aa]=new Float32Array(0);aa=a.uv_textures;d=k.texcoord;y=k.texcoord2;if(e)for(var ma in e){b=aa.indexOf(ma);if(0==b)var va=new Float32Array(d);else 1==b&&(va=new Float32Array(y));h[e[ma]]=va}p.aa=h;p.lb=new Uint32Array(k.indices);ma=k.position.length/f/3;va=B(c,"a_tbn_quat")&&k.tbn_quat.length?
!0:!1;aa=B(c,"a_shade_tangs")&&k.shade_tangs.length?!0:!1;0<a.b4w_shape_keys.length&&(l=!0);for(h=0;h<ma;h++){e=C(k,f,va,aa,h);if(l)if(d={},d.name=a.b4w_shape_keys[h].name,p.La.push(d),0!=h){d.Ne=e;d.vo=a.b4w_shape_keys[h].value;continue}else d.Ne=C(k,f,va,aa,h),d.vo=1;p.P.push(e)}if(1<ma&&!l){a=p.P[0];e={};for(var X in a)e[X]=new Float32Array(a[X]);p.P.push(e)}B(c,"a_polyindex")&&(n(p,1,!0),p.aa.a_polyindex=w(p));c=k.boundings;k=p.Xe;k.J=P.Mc();k.J.max_x=c.bounding_box.max_x;k.J.max_y=c.bounding_box.max_y;
k.J.max_z=c.bounding_box.max_z;k.J.min_x=c.bounding_box.min_x;k.J.min_y=c.bounding_box.min_y;k.J.min_z=c.bounding_box.min_z;X=c.bounding_ellipsoid_axes;k.Z=P.sn([X[0],0,0],[0,X[1],0],[0,0,X[2]],c.bounding_ellipsoid_center,[0,0,0,1]);k.da=P.vl(k.Z);return p}function C(a,b,c,d,h){var e={},k=new Float32Array(3*b),f=new Float32Array(c?4*b:0),p=h*b*3;k.set(a.position.subarray(p,p+3*b),0);c&&(p=h*b*4,f.set(a.tbn_quat.subarray(p,p+4*b),0));d&&(c=new Float32Array(3*b),c.set(a.shade_tangs.subarray(0,3*b),
0),e.a_shade_tangs=c);e.a_position=k;e.a_tbn_quat=f;return e}function B(a,b){return-1<a.indexOf(b)?!0:!1}function F(b,c,d,h,e,k,f,p){for(var l=!0,u=0;u<c;u++){var g=b[u*h+d];if(-1!==g){var r=e[u];-1!==r&&(k[u]=g,f[u]=r,l=!1)}}if(l)return p;y(k,f,a.st,!1);for(u=b=0;4>u;u++)b+=k[u];if(.01>b)return p;for(u=0;4>u;u++)k[u]/=b;if(.01>Math.abs(k[0]-1))p[0]=f[0]+1;else for(u=0;4>u;u++)p[u]=f[u]+k[u];return p}function D(a,b){if(0==b)return 0;var c=a.length,d=c/b;d!=Math.floor(d)&&E.r("Array size mismatch during geometry calculation: array length="+
c+", base length="+b);return d}function y(b,c,d,h){for(var e=b.length,k=e,f=!1,p=h?-1:1;1<k||f;){1<k&&(k=Math.floor(k/1.247330950103979));for(var f=!1,l=0;k+l<e;l++)if(d==a.st?0>p*(b[l]-b[l+k]):b[l]<b[l+k]&&h)f=b[l],b[l]=b[l+k],b[l+k]=f,f=c[l],c[l]=c[l+k],c[l+k]=f,f=!0}}function A(a,b,c){var d=[],h=[];W.subtract(b,a,d);W.subtract(c,a,h);W.normalize(d,d);W.normalize(h,h);return Math.acos(W.dot(d,h))}function H(a,c,d){if(b(c)){c=c.lb;for(var h=c.length/3,k=0;k<h;k++){var e=new Float32Array(9),f=c[3*
k];e[0]=a[3*f];e[1]=a[3*f+1];e[2]=a[3*f+2];f=c[3*k+1];e[3]=a[3*f];e[4]=a[3*f+1];e[5]=a[3*f+2];f=c[3*k+2];e[6]=a[3*f];e[7]=a[3*f+1];e[8]=a[3*f+2];d[k]=e}}else for(k=0;k<a.length;k++)e=new Float32Array(9),e[0]=a[9*k],e[1]=a[9*k+1],e[2]=a[9*k+2],e[3]=a[9*k+3],e[4]=a[9*k+4],e[5]=a[9*k+5],e[6]=a[9*k+6],e[7]=a[9*k+7],e[8]=a[9*k+8],d[k]=e;return d}function w(a){for(var b=new Float32Array(a.sa),c=0;c<a.sa;c++)b[c]=c%3;return b}function h(a,b,c){var d=W.dist(a,b);a=W.dist(a,c);b=W.dist(b,c);c=(d+a+b)/2;return c*
(c-d)*(c-a)*(c-b)}function u(a){var b={a_influence:new Float32Array(0),a_color:new Float32Array(0),a_texcoord:new Float32Array(0)};return{name:a,sa:0,lb:null,P:[],aa:b,La:[],Xe:{J:P.Mc(),Z:P.Ge(),da:P.oi()},Qf:null}}var P=q("__boundings"),p=q("__extensions"),z=q("__print"),l=q("__quat"),M=q("__tsr"),E=q("__util"),W=q("__vec3");new Float32Array(2);var G=new Float32Array(3),J=new Float32Array(3),Z=new Float32Array(3),L=new Float32Array(4),O=new Float32Array(4),U=new Float32Array(8),ga=new Float32Array(24);
a.Hp=10;a.zx=20;a.Gp=30;a.zD=40;a.AD=50;a.st=0;a.jF=1;a.Ym=a.Hp;var R=null;a.Ue=function(a){R=a};a.SN=function(a,d,h,k){c(a)&&n(a);var f=a.lb,p=a.sa,l=a.P,u={},g;for(g in a.aa)g in k&&!k[g].gk||(u[g]=a.aa[g]);k=t();0<a.La.length&&e(a,l[0]);g=a.Qf;if(f.length){var r=f.length;if(65536>=p)var z=new Uint16Array(f),w=R.UNSIGNED_SHORT;else z=new Uint32Array(f),w=R.UNSIGNED_INT}else r=p,z=null;var x,A=0,y=l.length;for(x in l[0])var B=l[0][x],A=A+B.length*y;for(x in u)B=u[x],A+=B.length;x=A;A=0;if(g){var y=
g.Km.length,A=A+8*y,B=g.Fk,q;for(q in B)A+=B[q].Lb*y;B=g.op;for(q in B)A+=y}q=new Float32Array(x+A);var y=0,A={},V;for(V in u){var O=u[V];if(B=O.length)q.set(O,y),A[V]={cQ:V,Lb:D(O,p),offset:y,frames:1,length:B,Ve:0,xg:0},y+=B}u=l.length;for(V in l[0])if(O=l[0][V],B=O.length,O=D(O,p),B){A[V]={Lb:O,offset:y,frames:u,length:B,Ve:0,xg:0};1<u&&(A[V+"_next"]={Lb:O,offset:y+B,frames:u,length:B,Ve:0,xg:0});for(var C=0;C<u;C++)O=l[C][V],q.set(O,y),y+=B}if(g){y=g.Km;u=[];B=g.As;p=g.Fk;l=g.op;y=g.Km;B=g.As;
p=g.Fk;l=g.op;O=g.qC;for(C=0;C<y.length;C++){V=y[C];O&&B&&!g.Yn&&(V=M.multiply(B,y[C],U));!O&&g.Yn&&W.subtract(y[C],B,y[C]);u.push(V[0],V[1],V[2],V[3],V[4],V[5],V[6],V[7]);for(var E in p){V=p[E].Lb;for(var aa=0;aa<V;aa++)u.push(p[E].data[C*V+aa])}for(E in l)u.push(l[E][0])}y=8;for(E in p)y+=p[E].Lb;for(E in l)y++;q.set(u,x);V={xg:1,Lb:4,Ve:y,offset:x+4,frames:1,length:0};A.a_part_ts={xg:1,Lb:4,Ve:y,offset:x,frames:1,length:0};A.a_part_r=V;u=8;for(E in p)V=p[E].Lb,B={xg:1,Lb:V,Ve:y,offset:x+u,frames:1,
length:0},A[E]=B,u+=V;for(E in l)B={xg:1,Lb:1,Ve:y,offset:x+u,frames:1,length:0},A[E]=B,u++;k.nk=g.Km.length}k.count=r;k.ie=z;k.Hc=q;k.kk=w;k.zb=A;m(k,h);v(k);d&&b(a)&&(k.Pl={yL:new Float32Array(f.length),zL:new Float32Array(f.length),JI:new Float32Array(f.length/3),vD:new Float32Array(3),qG:P.EG(a.Xe.J)});k.La=a.La;return k};a.QN=e;a.IK=c;a.HK=b;a.Ds=n;a.UC=function(a,b,c){m(a,b);a.count=c.length;a.ie=c;a.kk=c instanceof Uint16Array?R.UNSIGNED_SHORT:R.UNSIGNED_INT};a.TC=function(a,b,c,d){var h=a.Hc,
k=a.zb,e=k[b];e?(c&&e.Lb!=c&&E.r('invalid num_comp for "'+b+'"'),h.set(d,e.offset)):(h=h.length,e=new Float32Array(h+d.length),e.set(a.Hc),e.set(d,h),a.Hc=e,k[b]={Lb:c,offset:h});v(a)};a.bJ=g;a.zR=function(a){a.Sk=R.STATIC_DRAW};a.pL=function(a){a.Sk=R.DYNAMIC_DRAW};a.ex=v;a.fH=function(a){a.nf&&R.deleteBuffer(a.nf);a.Vh&&R.deleteBuffer(a.Vh)};a.lA=function(a,b){return a.submeshes[b].base_length?!1:!0};a.Cs=function(a,b){for(var c=0;c<a.P.length;c++){var d=a.P[c].a_position;M.transform_vectors(d,
b,d,0);d=a.P[c].a_tbn_quat;0<d.length&&M.QC(d,b,d,0);(d=a.P[c].a_shade_tangs)&&0<d.length&&M.transform_dir_vectors(d,b,d,0)}(c=a.aa.au_center_pos)&&c.length&&M.transform_vectors(c,b,c,0);x(a.Xe,b);return a};a.PN=function(a,b){var c=a.aa.au_center_pos;if(c&&c.length){var d=new Float32Array(c);M.transform_vectors(d,b,d,0);for(var h=0;h<a.P.length;h++)for(var k=0;k<d.length;k++)a.P[h].a_position[k]+=d[k]-c[k];c.set(d)}else E.r('Attribute "au_center_pos" is missing in particle submesh');x(a.Xe,b)};a.xG=
x;a.ON=function(a,b){var c=a.sa,d;for(d in b){var h=b[d].length;a.aa[d]=new Float32Array(h*c);for(var k=0;k<c;k++)for(var e=0;e<h;e++)a.aa[d][k*h+e]=b[d][e]}};a.RN=d;a.oL=function(a,b,c){if(!a.sa)return u("EMPTY");var d=c.length;65536<a.sa*d&&!p.Vz()&&n(a,d);var h=a.lb,e=a.sa,f=a.aa,l=a.P,g;for(g in b){var r=b[g].length,m=r*e;f[g]=new Float32Array(m);for(var z=0;z<e;z++)for(m=0;m<r;m++)f[g][z*r+m]=b[g][m]}b=u("CLONE_"+d+"_SUBMESHES");b.sa=e*d;b.lb=new Uint32Array(h.length*d);for(z=0;z<d;z++)for(r=
h.length*z,g=e*z,m=0;m<h.length;m++)b.lb[r+m]=h[m]+g;for(var w in f)for(h=f[w],m=h.length*d,r=D(h,e),b.aa[w]=new Float32Array(m),z=0;z<d;z++)g=e*r*z,b.aa[w].set(h,g);for(w in l[0])for(z=0;z<l.length;z++)for(h=l[z][w],m=h.length*d,r=D(h,e),b.P[z]=b.P[z]||{},b.P[z][w]=new Float32Array(m),m=0;m<d;m++)switch(f=c[m],g=e*r*m,w){case "a_position":M.transform_vectors(h,f,b.P[z][w],g);break;case "a_tbn_quat":M.QC(h,f,b.P[z][w],g);break;case "a_shade_tangs":M.transform_tangents(h,f,b.P[z][w],g);break;default:E.r("Wrong attribute name: "+
w)}k(a,b,c);return b};a.wy=k;a.wz=r;a.dJ=function(a){var b=a.sa,c=a.P[0].a_position,d=new Float32Array(12*b),h=new Float32Array(8*b);a=new Uint32Array(4*a.lb.length);for(var k=new Float32Array(4*b),e=0;e<b;e++){d[12*e]=c[3*e];d[12*e+1]=c[3*e+1];d[12*e+2]=c[3*e+2];d[12*e+3]=c[3*e];d[12*e+4]=c[3*e+1];d[12*e+5]=c[3*e+2];d[12*e+6]=c[3*e];d[12*e+7]=c[3*e+1];d[12*e+8]=c[3*e+2];d[12*e+9]=c[3*e];d[12*e+10]=c[3*e+1];d[12*e+11]=c[3*e+2];h[8*e]=-.5;h[8*e+1]=-.5;h[8*e+2]=-.5;h[8*e+3]=.5;h[8*e+4]=.5;h[8*e+5]=
.5;h[8*e+6]=.5;h[8*e+7]=-.5;a[6*e]=4*e+2;a[6*e+1]=4*e+1;a[6*e+2]=4*e;a[6*e+3]=4*e+2;a[6*e+4]=4*e;a[6*e+5]=4*e+3;var f=Math.random();k[4*e]=f;k[4*e+1]=f;k[4*e+2]=f;k[4*e+3]=f}c=u("HALO");c.P[0]={};c.sa=4*b;c.P[0].a_position=d;c.aa.a_halo_bb_vertex=h;c.aa.a_random_vals=k;c.lb=a;return c};a.rK=B;a.xz=function(a,b,c){for(var h=[],e=0;e<a.submeshes.length;e++){var k=r(a,e,b,null,c,null);k.sa&&h.push(k)}return 0==h.length?u("EMPTY"):1==h.length?h[0]:d(h)};a.pO=function(a,b,c){for(var d=a.ie,h=g(a,"a_position"),
e=a.Pl,k=e.yL,f=e.zL,e=e.JI,p=d,l=p.length/3,u=0;u<l;u++){var r=p[3*u],m=p[3*u+1],n=p[3*u+2],z=h[3*r+1],w=h[3*r+2],v=h[3*m+1],x=h[3*m+2],A=h[3*n+1],t=h[3*n+2];k[3*u]=(h[3*r]+h[3*m]+h[3*n])/3;k[3*u+1]=(z+v+A)/3;k[3*u+2]=(w+x+t)/3}M.transform_vectors(k,b,f);b=f.length/3;for(h=0;h<b;h++)k=f[3*h]-c[0],p=f[3*h+1]-c[1],l=f[3*h+2]-c[2],e[h]=k*k+p*p+l*l;c=d;d=e.length;if(!(2>d))for(f=d,h=!1;1<f||h;)for(1<f&&(f=Math.floor(f/1.247330950103979)),h=!1,b=0;f+b<d;b++)0>e[b]-e[b+f]&&(h=e[b],e[b]=e[b+f],e[b+f]=h,
h=c,k=b,p=b+f,l=h[3*k],u=h[3*k+1],r=h[3*k+2],h[3*k]=h[3*p],h[3*k+1]=h[3*p+1],h[3*k+2]=h[3*p+2],h[3*p]=l,h[3*p+1]=u,h[3*p+2]=r,h=!0);d=c;R.bindBuffer(R.ELEMENT_ARRAY_BUFFER,a.nf);R.bufferData(R.ELEMENT_ARRAY_BUFFER,d,R.DYNAMIC_DRAW)};a.jC=y;a.uy=function(a,b,c){for(var d=b.length/3,h=a.length/3,e=[],k=Array(3),f=Array(3),p=Array(3),l=0;l<h;l++){for(var u=a[3*l],g=a[3*l+1],r=a[3*l+2],m=0;3>m;m++)k[m]=b[3*u+m],f[m]=b[3*g+m],p[m]=b[3*r+m];if(c)var m=A(k,f,p),n=A(f,p,k),z=Math.PI-m-n;else z=n=m=1;var w=
e,v;v=k;var x=p,t=[],y=[],aa=[];W.subtract(f,v,t);W.subtract(x,v,y);W.cross(t,y,aa);W.normalize(aa,aa);v=aa;for(x=0;3>x;x++)t=3*g+x,y=3*r+x,w[3*u+x]=m*v[x],w[t]=n*v[x],w[y]=z*v[x]}if(c)for(var B in c)for(l=c[B],a=0;3>a;a++){b=3*l[0]+a;for(h=1;h<l.length;h++)k=3*l[h]+a,e[b]+=e[k];for(h=1;h<l.length;h++)k=3*l[h]+a,e[k]=e[b]}for(l=0;l<d;l++){c=l;B=e;a=new Float32Array(3);for(b=0;3>b;b++)h=3*c+b,a[b]=B[h];W.normalize(a,a);for(b=0;3>b;b++)h=3*c+b,B[h]=a[b]}return e};a.vy=function(a,b,c){for(var d={},h=
b.length/3,e=0;e<h;e++){var k=String(b[3*e])+String(b[3*e+1])+String(b[3*e+2]);d[k]=[]}h=a.length;for(e=0;e<h;e++)b=a[e],k=String(c[3*b])+String(c[3*b+1])+String(c[3*b+2]),k in d&&d[k].push(b);return d};a.Gu=function(a,b,c,d){var e;e=null;e=[];e=H(a.P[0].a_position,a,e);if(c){var k;k=null;k=[];for(var f=a.P[0].a_tbn_quat,p=f.length/4,u=new Float32Array(3*p),g=0;g<p;g++){var m=L;m[0]=f[4*g];m[1]=f[4*g+1];m[2]=f[4*g+2];m[3]=f[4*g+3];m=W.transformQuat(E.AXIS_Y,m,G);u[3*g]=m[0];u[3*g+1]=m[1];u[3*g+2]=
m[2]}k=H(u,a,k)}p=e.length;u=new Float32Array(p);for(a=0;a<p;a++)g=e[a],G.set(g.subarray(0,3)),J.set(g.subarray(3,6)),Z.set(g.subarray(6)),u[a]=Math.sqrt(h(G,J,Z));f=new Float32Array(p);f[0]=u[0];for(a=1;a<p;a++)f[a]=f[a-1]+u[a];p=f[u.length-1];u=[];for(a=0;a<b;a++){var g=p*E.vf(d),g=E.dq(f,g,0,f.length-1),r=g=c?k[g]:e[g],n=d;(g=G)||(g=new Float32Array(3));var m=r[0],z=r[1],w=r[2],v=r[3],x=r[4],A=r[5],t=r[6],y=r[7],B=r[8],r=E.vf(n),n=E.vf(n);1<r+n&&(r=1-r,n=1-n);var aa=1-r-n,z=aa*z+r*x+n*y,w=aa*w+
r*A+n*B;g[0]=aa*m+r*v+n*t;g[1]=z;g[2]=w;c?(u[a]=new Float32Array(4),W.normalize(g,g),g=l.rotationTo(E.AXIS_Y,g,L),u[a][0]=g[0],u[a][1]=g[1],u[a][2]=g[2],u[a][3]=g[3]):(u[a]=new Float32Array(3),u[a][0]=g[0],u[a][1]=g[1],u[a][2]=g[2])}return u};a.Hq=w;a.cS=h;a.OB=function(a,b,c){a=a.P[0].a_position;for(var d=0;d<a.length;d+=3)a[d]=(a[d]-c[0])*b[0]+c[0],a[d+1]=(a[d+1]-c[1])*b[1]+c[1],a[d+2]=(a[d+2]-c[2])*b[2]+c[2]};a.$x=function(a,b,c){var d=a.D[0].U;a=a.k.Og;for(var h=1;h<a.length;h++)a[h].name==b&&
(a[h].value=c);for(h=0;h<d.length;h++)if(!d[h].jf&&d[h].Rd&&!d[h].nh){b=d[h].ja.zb;c=d[h].ja.Hc;R.bindBuffer(R.ARRAY_BUFFER,d[h].ja.Vh);var e=b.a_position,k=d[h],f=c,p=a;if(e){for(var u=e.offset,e=e.length+u,g=k.ja.La[0].Ne.a_position,m=u;m<e;m++)f[m]=g[m-u];for(m=1;m<k.ja.La.length;m++){var g=k.ja.La[m].Ne.a_position,r=p[m].value;if(r)for(var n=u;n<e;n++)f[n]+=r*g[n-u]}R.bufferSubData(R.ARRAY_BUFFER,4*u,f.subarray(u))}p=b.a_tbn_quat;b=d[h];k=a;if(p){f=p.offset;p=p.length+f;u=b.ja.La[0].Ne.a_tbn_quat;
e=L;for(m=f;m<p;m+=4){e[0]=0;e[1]=0;e[2]=0;for(g=e[3]=1;g<b.ja.La.length;g++)if(r=b.ja.La[g].Ne.a_tbn_quat,n=k[g].value){var z=O;z[0]=r[m-f];z[1]=r[m+1-f];z[2]=r[m+2-f];z[3]=r[m+3-f];r=l.slerp(E.il,z,n,O);l.multiply(r,e,e)}g=O;g[0]=u[m-f];g[1]=u[m-f+1];g[2]=u[m-f+2];g[3]=u[m-f+3];r=0<g[3];l.multiply(e,g,g);(0<g[3]&&!r||0>g[3]&&r)&&l.scale(g,-1,g);c[m]=g[0];c[m+1]=g[1];c[m+2]=g[2];c[m+3]=g[3]}R.bufferSubData(R.ARRAY_BUFFER,4*f,c.subarray(f))}}};a.check_shape_keys=function(a){return a.k.Rd};a.get_shape_keys_names=
function(a){var b=[];if(a.k)for(var c=1;c<a.k.Og.length;c++)b.push(a.k.Og[c].name);return b};a.get_shape_key_value=function(a,b){if(a.k)for(var c=1;c<a.k.Og.length;c++)if(b==a.k.Og[c].name)return a.k.Og[c].value;return 0};a.Vu=function(a,b){var c=a.k.Og;if(c)for(var d=1;d<c.length;d++)if(c[d].name==b)return!0;return!1};a.Ol=function(a){return a&&a.k&&a.k.fe?!0:!1};a.draw_line=function(b,c,d){var h=b.ja;if(h){for(var e=d?c.length/3/2:c.length/3-1,k=new Float32Array(12*e),f=new Float32Array(12*e),p=
new Uint16Array(6*e),l=0;l<e;l++){if(d)var u=6*l,g=6*l+3;else u=3*l,g=3*(l+1);var m=c[u],r=c[u+1],u=c[u+2],n=c[g],z=c[g+1],g=c[g+2],w=n-m,x=z-r,A=g-u;k[12*l]=m;k[12*l+1]=r;k[12*l+2]=u;f[12*l]=w;f[12*l+1]=x;f[12*l+2]=A;k[12*l+3]=n;k[12*l+4]=z;k[12*l+5]=g;f[12*l+3]=-w;f[12*l+4]=-x;f[12*l+5]=-A;k[12*l+6]=m;k[12*l+7]=r;k[12*l+8]=u;f[12*l+6]=-w;f[12*l+7]=-x;f[12*l+8]=-A;k[12*l+9]=n;k[12*l+10]=z;k[12*l+11]=g;f[12*l+9]=w;f[12*l+10]=x;f[12*l+11]=A;p[6*l]=4*l;p[6*l+1]=4*l+1;p[6*l+2]=4*l+2;p[6*l+3]=4*l;p[6*
l+4]=4*l+3;p[6*l+5]=4*l+1}d=0;for(var t in h.zb)c=h.zb[t],d+=k.length/3*c.Lb;h.Hc=new Float32Array(d);d=h.Hc;a.UC(h,b.Lf,p);b=0;for(t in h.zb)switch(c=h.zb[t],t){case "a_position":d.set(k,b);c.offset=b;c.length=k.length;b+=c.length;break;case "a_direction":d.set(f,b);c.offset=b;c.length=f.length;b+=c.length;break;default:c.offset=b,c.length=k.length/3*c.Lb,p=new Float32Array(c.length),d.set(p,b),b+=c.length}v(h)}};a.kH=function(a){var b=t();if(a.ie)switch(a.kk){case R.UNSIGNED_SHORT:b.ie=new Uint16Array(a.ie);
break;case R.UNSIGNED_INT:b.ie=new Uint32Array(a.ie)}else b.ie=null;b.Hc=a.Hc?new Float32Array(a.Hc):null;b.kk=a.kk;b.count=a.count;b.zb=E.L(a.zb);b.mode=a.mode;b.Sk=a.Sk;b.yl=a.yl;b.yq=a.yq;b.Vh=null;b.nf=null;b.Pl=E.L(a.Pl);b.La=E.L(a.La);b.nk=a.nk;b.md=a.md;return b};a.Re=u;a.reset=function(){R=null}};b4w.module.__objects=function(a,q){function e(a){var b=a.D;a=a.k;for(var c=0;c<b.length;c++){var d=b[c].Ua;d.q.outline&&a.Zf&&M.sM(d)}}function c(a){a.k.Zf=0;a=qa.indexOf(a);-1!=a&&qa.splice(a,1)}function b(a){if(a.Gl)for(var b=a.D,c=0;c<b.length;c++)M.WC(b[c].Ua,a)}function n(a,b){for(var c=a.D,d=b.D,e=0;e<c.length;e++){for(var k=!1,l=0;l<d.length;l++)if(c[e].Ua==d[l].Ua){k=!0;break}k||f(b,c[e].Ua)&&h.kn(b,c[e].Ua)}}function f(a,b){return!b.Px&&"SPEAKER"==a.type||!b.xF&&("LAMP"==a.type||"CAMERA"==
a.type)?!1:!0}function t(a,b){if(a.b4w_hidden_on_load||a.dg_parent&&a.dg_parent.wt||a.parent&&a.parent.wt)return!0;switch(a.type){case "MESH":var c=a.b4w_do_not_batch,d=a.b4w_collision,h=a.b4w_vehicle,e=a.b4w_floating,f=a.b4w_character,l=u.tK(a),p=H.ry(a),m=0<a.data.b4w_shape_keys.length,r=a.b4w_dynamic_geometry;if(!(c=k.sy(a,b)||c||d||h||m||e||l||f||p||r))a:{c=a.data;for(d=0;d<c.materials.length;d++)if(h=c.materials[d],h.b4w_lens_flares||g(h.node_tree)){c=!0;break a}c=!1}return c;case "EMPTY":return c=
H.ry(a),d=a.b4w_do_not_batch,h=Boolean(a.b4w_anchor),k.sy(a,b)||c||d||h;default:return!0}}function g(a){if(!a)return!1;a=a.nodes;for(var b=0;b<a.length;b++){var c=a[b];if("VECT_TRANSFORM"==c.type){var d=c.convert_from,h=c.convert_to,e=c.outputs[0];if(!(!e.is_linked||"WORLD"==d&&"CAMERA"==h||"CAMERA"==d&&"WORLD"==h||"OBJECT"==d&&"OBJECT"==h))return!0}if("NORMAL_MAP"==c.type&&(d=c.space,e=c.outputs[0],e.is_linked&&("OBJECT"==d||"BLENDER_OBJECT"==d)))return!0}return!1}function m(a,b){var c=a.animation_data,
d=a.data?a.data.animation_data:null;c&&c.action&&(c=c.action,(c.q.type==k.OBJ_ANIM_TYPE_OBJECT||c.q.type==k.OBJ_ANIM_TYPE_ARMATURE&&"ARMATURE"==b.type||c.q.type==k.qE&&"LAMP"==b.type||c.q.type==k.pE&&"WORLD"==b.type)&&b.oh.push(k.oA(null,c)));d&&d.action&&("SPEAKER"==b.type||"LAMP"==b.type)&&b.oh.push(k.oA(null,d.action));"MESH"==b.type&&b.oh.push.apply(b.oh,k.OJ(a))}function v(a,b,c){b=Q[b]||[];for(var d=[],h=0;h<b.length;h++){var e=b[h];if(e.k.sd==c||-1==c)for(var k=e.D,f=0;f<k.length;f++)k[f].Ua==
a&&d.push(e)}return d}function x(a,b,c,d){for(var e=null,k=0;k<b.length;k++){var f=b[k];if((c?f.Ak:f.name)==a&&(f.k.sd==d||-1==d)&&(e=f,!h.get_dg_parent(e)))break}return e}function d(a){Q.ALL.push(a);Q[a.type]||(Q[a.type]=[]);Q[a.type].push(a);var b=a.k.Nd;if(null!=b)for(var c=0;c<ha.length;c++){var d=ha[c];d.k.Nd==b&&d.Zo.push(a)}}var k=q("__animation"),r=q("__batch"),C=q("__boundings"),B=q("__camera"),F=q("__config"),D=q("__constraints"),y=q("__geometry"),A=q("__lights"),H=q("__nla"),w=q("__nodemat"),
h=q("__obj_util"),u=q("__particles"),P=q("__physics"),p=q("__print"),z=q("__primitives"),l=q("__quat"),M=q("__scenes"),E=q("__sfx"),W=q("__transform"),G=q("__textures"),J=q("__tsr"),Z=q("__util"),L=q("__vec3"),O=q("__armature"),U=q("__anchors"),ga=q("__renderer"),R=F.v,ca=F.ec,Q={ALL:[]},ta=new Float32Array(24),K=0,N=0,ha=[],qa=[],na=new Float32Array(3),ra=new Float32Array(4);a.ot=0;a.nt=1;a.Vc=2;a.DATA_ID_ALL=-1;a.update=function(a){for(var b=Q.ARMATURE,d=0;d<qa.length;d++){var h=qa[d],k=h,f=a,l=
0,p=k.jB;0==p.Fs&&(p.Fs=f);f-=p.Fs;if(p.cw&&f/p.Te>=p.cw)c(k);else{f%=p.Te;if(f<p.Mv)switch(p=f/(p.Mv/5),f=Math.floor(p),f){case 0:l=(p-f)/2;break;case 1:l=(p-f)/2+.5;break;case 2:l=1;break;case 3:l=1-(p-f)/2;break;case 4:l=.5-(p-f)/2}k.k.Zf=l}h.k.Zf&&e(h)}if(b)for(d=0;d<b.length;d++)a=b[d],a.Gv&&(W.A(a),a.Gv=!1)};a.set_outline_intensity=function(a,b){a.k.Zf=b;e(a)};a.apply_outline_anim=function(a,b,c,d){var h=a.jB;h.Fs=0;h.Mv=b;h.Te=c;h.cw=d;-1==qa.indexOf(a)&&qa.push(a)};a.clear_outline_anim=c;
a.kj=function(a,b){b.lj=a.uuid;b.Gj=!0;m(a,b);a.wt=b.Fa=t(a,b);a.yF=!0;b.je=a.b4w_vehicle;b.is_character=a.b4w_character;b.rk=a.b4w_floating;b.Tk=a.b4w_collision;b.Bb=a.b4w_collision_id;b.qq=a.b4w_correct_bounding_offset;var c=a.game;b.$f={Yr:c.physics_type,zp:c.use_ghost,eD:c.use_sleep,Gg:c.mass,iD:c.velocity_min,hD:c.velocity_max,ou:c.damping,kw:c.rotation_damping,gL:c.lock_location_x,hL:c.lock_location_y,iL:c.lock_location_z,jL:c.lock_rotation_x,kL:c.lock_rotation_y,lL:c.lock_rotation_z,In:c.collision_margin,
Gn:c.collision_group,Jn:c.collision_mask,gx:c.use_collision_bounds,lq:c.collision_bounds_type,wp:c.use_collision_compound};if(c=a.b4w_vehicle_settings)b.we={name:c.name,ne:c.part,VN:c.suspension_rest_length,Jw:c.suspension_compression,Lw:c.suspension_stiffness,Kw:c.suspension_damping,qx:c.wheel_friction,iw:c.roll_influence,qv:c.max_suspension_travel_cm,fo:c.force_max,vn:c.brake_max,Am:c.steering_max,am:c.max_speed_angle,Tn:c.delta_tach_angle,lp:c.speed_ratio,np:c.steering_ratio,xo:c.inverse_control,
ak:c.floating_factor,al:c.water_lin_damp,bl:c.water_rot_damp,AC:c.synchronize_position};if(c=a.b4w_floating_settings)b.Hl={name:c.name,ne:c.part,ak:c.floating_factor,al:c.water_lin_damp,bl:c.water_rot_damp,AC:c.synchronize_position};if(c=a.b4w_character_settings)b.Ey={mP:c.walk_speed,zM:c.run_speed,NN:c.step_height,OK:c.jump_strength,oP:c.waterline};for(c=0;c<a.constraints.length;c++){var e=a.constraints[c];"RIGID_BODY_JOINT"==e.type&&b.Sv.push({target:e.target.Ga,SL:e.pivot_type,TL:e.pivot_x,UL:e.pivot_y,
VL:e.pivot_z,jd:e.axis_x,kd:e.axis_y,ld:e.axis_z,RO:e.use_limit_x,SO:e.use_limit_y,TO:e.use_limit_z,NO:e.use_angular_limit_x,OO:e.use_angular_limit_y,PO:e.use_angular_limit_z,YK:e.limit_max_x,ZK:e.limit_max_y,$K:e.limit_max_z,aL:e.limit_min_x,bL:e.limit_min_y,cL:e.limit_min_z,SK:e.limit_angle_max_x,TK:e.limit_angle_max_y,UK:e.limit_angle_max_z,VK:e.limit_angle_min_x,WK:e.limit_angle_min_y,XK:e.limit_angle_min_z})}c=b.k=h.wl("MESH"===b.type?b.Fa?"DYNAMIC":"STATIC":b.type);a.parent?(b.parent=a.parent.Ga,
"BONE"==a.parent_type&&"ARMATURE"==a.parent.type&&(b.No=a.parent_bone),a.pinverse_tsr&&(b.Zr=J.create(),J.copy(a.pinverse_tsr,b.Zr))):a.dg_parent&&(b.parent=a.dg_parent.Ga,b.Si=!0);var e=a.location,f=a.scale[0];Z.Xv(a.rotation_quaternion,ra);W.set_translation(b,e);W.set_rotation(b,ra);W.set_scale(b,f);b.yp=a.b4w_use_default_animation;b.wj=k.At(a.b4w_anim_behavior);a.b4w_object_tags&&(b.Hr={title:a.b4w_object_tags.title,description:a.b4w_object_tags.description,category:a.b4w_object_tags.category});
a.b4w_viewport_alignment&&(b.Vs={AF:a.b4w_viewport_alignment.alignment,distance:a.b4w_viewport_alignment.distance});switch(a.type){case "ARMATURE":O.kj(a,b);e=c.Zd;f=k.FG(e);a.b4w_animation_mixing?(c.zd=new Float32Array(f.hb),c.Od=new Float32Array(f.hb),c.Cd=new Float32Array(f.trans),c.Pd=new Float32Array(f.trans)):(c.zd=f.hb,c.Od=f.hb,c.Cd=f.trans,c.Pd=f.trans);for(var p in e){var l=e[p];1==l.kq.length&&O.oO(l,!0,f.trans,f.hb)}c.So=f;c.ge=0;c.dh=a.b4w_animation_mixing;break;case "MESH":c.ri=a.b4w_do_not_render;
c.fi=r.oG(a.data.b4w_bounding_box);c.Ng=ca.outlining_overview_mode||a.b4w_selectable;c.km=a.b4w_selectable;c.ec=ca.outlining_overview_mode||a.b4w_outlining;c.jm=a.b4w_outlining;c.Sr=ca.outlining_overview_mode||a.b4w_outline_on_select;c.Fe=a.b4w_billboard;c.tn=a.b4w_pres_glob_orientation;c.Cj="BASIC";c.Bj="SPHERICAL"==a.b4w_billboard_geometry;p=c.uf;p.Ni=a.b4w_outline_settings.outline_duration;p.Oi=a.b4w_outline_settings.outline_period;p.Pi=a.b4w_outline_settings.outline_relapses;c.Ng&&(c.Mj=Z.Jz(K),
K++);for(p=0;p<a.data.b4w_vertex_anim.length;p++)e=a.data.b4w_vertex_anim[p],b.yc.push({name:e.name,ma:e.frame_start,Oa:e.frame_end,eQ:e.averaging,fQ:e.averaging_interval,BF:e.allow_nla});b.k.yc=b.yc.length?!0:!1;"MESH"!=a.type&&Z.r("Wrong object type: "+a.name);p=b.k;if(a.data.b4w_shape_keys.length)for(p.Rd=!0,e=0;e<a.data.b4w_shape_keys.length;e++)f={},f.value=a.data.b4w_shape_keys[e].value,f.name=a.data.b4w_shape_keys[e].name,p.Og.push(f);else p.Rd=!1;c.pd=a.b4w_shadow_cast;c.Tc=a.b4w_shadow_receive;
c.fd=a.b4w_shadow_cast_only&&c.pd;c.Qc=a.b4w_reflexible;c.Gc=a.b4w_reflexible_only&&c.Qc;c.dd=a.b4w_reflective;c.wf=a.b4w_reflection_type;c.Hf=a.b4w_caustics;c.Dd=a.b4w_wind_bending;c.el=a.b4w_wind_bending_angle;p=r.pP(a.b4w_wind_bending_angle,c.fi,a.scale[0]);c.Cf=p;c.kg=a.b4w_wind_bending_freq;c.Kf=a.b4w_detail_bending_freq;c.Jf=a.b4w_detail_bending_amp;c.Gf=a.b4w_branch_bending_amp;c.hide=a.b4w_hidden_on_load;c.Sf=a.b4w_main_bend_stiffness_col;p=a.b4w_detail_bend_colors;c.Yc={};c.Yc.IA=p.leaves_stiffness_col;
c.Yc.HA=p.leaves_phase_col;c.Yc.kB=p.overall_stiffness_col;c.ph=a.b4w_do_not_cull;c.Bl=a.b4w_disable_fogging;c.fe=a.b4w_dynamic_geometry;"MESH"!==a.type&&Z.r("Wrong object");p=a.data.materials[0];c.dk=p.physics.friction;c.Xj=p.physics.elasticity;c.xk=0;c.Fg=h.pt;c.Ei=a.b4w_lod_transition;c.Xl=!0;break;case "LINE":c.ph=!0;c.J=C.Mc();c.Z=C.Ge();c.Y=C.Mc();c.va=C.Ge();break;case "CAMERA":B.JG(a,b);B.fG(b);break;case "LAMP":A.PK(a,b);break;case "SPEAKER":b.M=E.PH();c=!1;for(p=0;p<b.D.length;p++)if(b.D[p].Ua.qc){c=
!0;break}c&&E.kj(a,b);break;case "EMPTY":p=C.Mc(),c.J=p,p=C.oi(),c.da=p,a.field&&(b.Gl={type:a.field.type,uC:a.field.strength}),a.b4w_anchor&&(b.anchor={type:a.b4w_anchor.type,Al:a.b4w_anchor.detect_visibility,Dq:a.b4w_anchor.element_id,wL:a.b4w_anchor.max_width})}d(b)};a.KO=function(a,b){b.lj=a.uuid;b.Gj=!0;m(a,b);a.wt=b.Fa=t(a,b);a.yF=!0;b.k=h.wl(b.type);b.yp=a.b4w_use_default_animation;b.wj=k.At(a.b4w_anim_behavior);d(b)};a.zO=function(a,b){var c=b.k;if(b.parent){!b.Si&&b.$f.wp&&b.parent.$f.wp&&
(b.Tk=!1);for(var e=!1,f=0;f<b.D.length;f++)if(b.D[f].Ua.Wb){e=!0;break}if(f=e)f=b.$f,f=b.je||b.rk||P.is_character(b)||b.Tk&&!f.zp&&0<f.Gg&&("DYNAMIC"==f.Yr||"RIGID_BODY"==f.Yr);if(f)f=b.Si?J.copy(c.n,J.create()):c.n,J.multiply(b.parent.k.n,f,c.n),W.set_translation(b,J.get_trans_view(c.n)),W.set_scale(b,J.get_scale(c.n)),W.set_rotation(b,J.get_quat_view(c.n));else if(b.Si||!b.No)if(f=J.copy(c.n,J.create()),b.Vs&&"CAMERA"==b.parent.type){f={distance:b.Vs.distance,rotation:J.get_quat_view(f)};switch(b.Vs.AF){case "TOP_LEFT":f.top=
0;f.left=0;break;case "TOP":f.top=0;f.left=.5;break;case "TOP_RIGHT":f.top=0;f.right=0;break;case "LEFT":f.top=.5;f.left=0;break;case "CENTER":f.top=.5;f.left=.5;break;case "RIGHT":f.top=.5;f.right=0;break;case "BOTTOM_LEFT":f.bottom=0;f.left=0;break;case "BOTTOM":f.bottom=0;f.left=.5;break;case "BOTTOM_RIGHT":f.bottom=0,f.right=0}D.append_stiff_viewport(b,b.parent,f)}else D.FF(b,b.parent,f);else f=J.copy(c.n,J.create()),D.GF(b,b.parent,b.No,f)}if("ARMATURE"==b.type)for(e=a.pose.bones,f=0;f<e.length;f++){var u=
e[f],g=u.constraints;if(g)for(var m=0;m<g.length;m++){var r=g[m];"COPY_TRANSFORMS"!=r.type||r.subtarget||r.mute||D.SF(b,r.target.Ga,u.name,Z.Nx,Z.il)}}if("MESH"==b.type)var z=k.Rz(a);if(z){g=z.Ga;f=g.k.So;e=b.k;u=a.data;b.$p=g;u=u.vertex_groups;if(u.length){var g=g.k.Zd,m=0,r={},w;for(w in g){var v=Z.keysearch("name",w,u);v&&(r[w]={lD:v.index,hi:g[w].hi,qu:m++})}e.ii=r;w=m;u=k.Xz();e.Tf=w;w>2*u?(e.Bi=!1,p.error('too many bones for "'+a.name+'" / '+e.Tf+" bones (max "+u+" with blending, "+2*u+" without blending). Skinning will be disabled.")):
e.Bi=!0}w=k.eJ(f.trans,f.hb,c.ii);z.b4w_animation_mixing?(c.zd=new Float32Array(w.hb),c.Od=new Float32Array(w.hb),c.Cd=new Float32Array(w.trans),c.Pd=new Float32Array(w.trans)):(c.zd=w.hb,c.Od=w.hb,c.Cd=w.trans,c.Pd=w.trans);c.mn=new Float32Array(4);c.ln=l.create();c.So=w;c.ge=0}if(c.dd)if(c=b.k,"CUBE"==c.wf)c.ce=N++;else if("PLANE"==c.wf){a:{z=a.constraints;for(w=0;w<z.length;w++)if(f=z[w],"LOCKED_TRACK"==f.type&&"REFLECTION PLANE"==f.name){if(f.target.Ga){z=f.target.Ga;break a}p.warn('Reflection plane target "'+
f.target.name+'" for object: "'+b.name+"\" is not present on the scene. Using object's Z-axis.")}z=null}z||(z=Z.rp("%reflection%"),z=h.Nn(z,"EMPTY"),w=h.wl("EMPTY"),z.k=w,n(b,z),D.Zx(z,b,[0,0,0],null,1),d(z));w=null;for(f=0;f<ha.length;f++)if(ha[f]==z){w=f;break}null==w&&(w=ha.length,ha.push(z));z.k.Nd=w;c.Nd=w;z.Zo.push(b)}};a.uO=b;a.sQ=n;a.SG=f;a.AO=function(a){for(var b=0;b<a.length;b++){var c=a[b];!c.k||"DYNAMIC"!=c.k.type&&"CAMERA"!=c.k.type||W.A(c);c.yp&&k.iB(c)&&(k.apply_def(c),c.X.length&&
k.play(c,null,k.SLOT_ALL))}};a.get_meta_tags=function(a){return Z.L(a.Hr)};a.cleanup=function(){N=K=0;ha.length=0;qa.length=0;Q={ALL:[]}};a.copy=function(a,b,c){var e=b,f=h.get_dg_parent(a);b=f?h.Kz(f.name,b):b;if(x(b,Q.ALL,!1,-1)){for(var f=1,k;;){k="."+(3>String(f).length?("000"+String(f)).slice(-3):String(f));if(!x(b+k,Q.ALL,!1,-1))break;f++}p.error('Object "'+b+'" already exists. Name was replaced by "'+b+k+'".');e+=k;b+=k}e=h.Nn(b,a.type,e);e.Gj=a.Gj;e.Fa=a.Fa;e.zo=a.zo;e.yp=a.yp;e.k=h.Ut(a.k);
e.Hr=h.pq(a.Hr);n(a,e);e.Up=h.au(a.Up);e.parent=h.au(a.parent);e.Si=a.Si;e.No=a.No;e.yc=h.au(a.yc);e.wj=a.wj;!a.B||a.je||a.is_character||a.rk||(e.Tk=a.Tk,e.B=null);e.Bb=a.Bb;e.qq=a.qq;e.$f=h.pq(a.$f);b=[];for(f=0;f<a.D.length;f++){var l=e.D[f];k=a.D[f].U;if(c){for(var l=l.U,u=0;u<k.length;u++)if(!k[u].jf){var g=h.pq(k[u]);g.ja=y.kH(k[u].ja);l.push(g);b.push(k[u].ja)}for(u=0;u<k.length;u++)if(k[u].jf){g=h.pq(k[u]);l.push(g);for(var m=0;m<b.length;m++)b[m]==k[u].ja&&(g.ja=l[m].ja)}for(u=0;u<l.length;u++)l[u].ja&&
y.ex(l[u].ja),R.zt&&ga.jG(l[u]),l[u].Li=e.lj,r.jO(l[u],r.GG(e.k));G.rN(l)}else l.U=k}c||(e.k.vp=!1);h.mw(e,!1);d(e);e.k.mr=!0;e.k.nr=c;e.k.Mj=Z.Jz(K);K++;return e};a.update_boundings=function(a){for(var b=a.k,c=a.D[0].U,d,h,e,f,k,p,l,u,g,m,n,w,v=[],x=0;x<c.length;x++){var A=c[x];if("MAIN"==A.type){var t=c[0].ja.Hc,K=c[0].ja.zb.a_position.offset;d=f=t[K];h=k=t[K+1];e=p=t[K+2]}}for(x=0;x<c.length;x++)if(A=c[x],A.ja&&A.va&&A.Y){var t=A.ja.Hc,K=A.ja.zb.a_position.offset,B=A.ja.zb.a_position.length+K;
l=m=t[K];u=n=t[K+1];g=w=t[K+2];for(var M=K;M<B;M+=3){var K=t[M],q=t[M+1],N=t[M+2];l=Math.max(K,l);u=Math.max(q,u);g=Math.max(N,g);m=Math.min(K,m);n=Math.min(q,n);w=Math.min(N,w)}A.J.max_x=l.toFixed(3);A.J.max_y=u.toFixed(3);A.J.max_z=g.toFixed(3);A.J.min_x=m.toFixed(3);A.J.min_y=n.toFixed(3);A.J.min_z=w.toFixed(3);C.ji(A.J,b.n,A.Y);C.co(A.Y,ta);for(t=v.length=0;t<ta.length;t++)v.push(ta[t]);A.va=C.rq(v,!0);A.Z=C.ty(A.va,b.n);A.da=C.vl(A.Z);A.Aa=C.vl(A.va);A.Bf=C.lr(A.Z,A.da);"MAIN"==A.type&&(d=Math.max(l,
d),h=Math.max(u,h),e=Math.max(g,e),f=Math.min(m,f),k=Math.min(n,k),p=Math.min(w,p))}l={max_x:parseFloat(d.toFixed(3)),max_y:parseFloat(h.toFixed(3)),max_z:parseFloat(e.toFixed(3)),min_x:parseFloat(f.toFixed(3)),min_y:parseFloat(k.toFixed(3)),min_z:parseFloat(p.toFixed(3))};n=d-f;g=h-k;u=e-p;f=.5*(d+f);m=.5*(h+k);w=.5*(e+p);var O=f,E=w;k=Math.max(n,Math.max(g,u))/2;p=Math.max(n,u)/2;var da=[f/(n?n:1),m/(g?g:1),w/(u?u:1)],v=.5;if(b.Fe)K=Math.max(Math.abs(l.max_x),Math.abs(l.min_x)),q=Math.max(Math.abs(l.max_y),
Math.abs(l.min_y)),N=Math.max(Math.abs(l.max_z),Math.abs(l.min_z)),e=Math.sqrt(K*K+q*q+N*N),x=Math.sqrt(K*K+q*q),l.max_x=l.max_y=l.max_z=e,l.min_x=l.min_y=l.min_z=-e,p=x,k=e,K=new Float32Array([0,0,0]),d=new Float32Array([k,k,k]),e=new Float32Array([0,0,0]);else{for(x=0;x<c.length;x++)if(A=c[x],"MAIN"==A.type)for(t=A.ja.Hc,B=c[x].ja.zb,K=B.a_position.offset,B=B.a_position.length+K,M=K;M<B;M+=3){var K=t[M],q=t[M+1],N=t[M+2],ba=Math.sqrt((f-K)*(f-K)+(m-q)*(m-q)+(w-N)*(w-N));if(ba>k){var A=f-k*(K-f)/
ba,Oa=m-k*(q-m)/ba,ba=w-k*(N-w)/ba;f=(A+K)/2;m=(Oa+q)/2;w=(ba+N)/2;k=Math.sqrt((f-K)*(f-K)+(m-q)*(m-q)+(w-N)*(w-N))}Oa=Math.sqrt((O-K)*(O-K)+(E-N)*(E-N));Oa>p&&(A=O-p*(K-O)/Oa,ba=E-p*(N-E)/Oa,O=(A+K)/2,E=(ba+N)/2,p=Math.sqrt((O-K)*(O-K)+(E-N)*(E-N)));K/=n?n:1;q/=g?g:1;N/=u?u:1;ba=Math.sqrt((da[0]-K)*(da[0]-K)+(da[1]-q)*(da[1]-q)+(da[2]-N)*(da[2]-N));ba>v&&(A=da[0]-v*(K-da[0])/ba,Oa=da[1]-v*(q-da[1])/ba,ba=da[2]-v*(N-da[2])/ba,da[0]=(A+K)/2,da[1]=(Oa+q)/2,da[2]=(ba+N)/2,v=Math.sqrt((da[0]-K)*(da[0]-
K)+(da[1]-q)*(da[1]-q)+(da[2]-N)*(da[2]-N)))}x=n?n*da[0]:d;h=g?g*da[1]:h;e=u?u*da[2]:e;d=v*n;t=v*g;B=v*u;K=new Float32Array([f,m,w]);d=new Float32Array([d,t,B]);e=new Float32Array([x,h,e]);p=parseFloat(p.toFixed(3))}b.J=l;r.YM(b,p,p,l);l=C.gq(k,K);b.da=l;l=C.sn([d[0],0,0],[0,d[1],0],[0,0,d[2]],e);b.Z=l;W.A(a);if(R.debug_view)for(x=0;x<c.length;x++)if("DEBUG_VIEW"===c[x].type&&c[x].nh){a=z.Pq(1,l.I);y.OB(a,[l.jd[0],l.kd[1],l.ld[2]],l.I);y.Ds(a,1,!0);a.aa.a_polyindex=y.Hq(a);r.iO(c[x],a);break}};a.xb=
v;a.iK=function(a,b){for(var c=Q.ALL||[],d=[],h=0;h<c.length;h++){var e=c[h];if((e.k.sd==b||-1==b)&&e.Gj)for(var f=e.D,k=0;k<f.length;k++)f[k].Ua==a&&d.push(e)}return d};a.get_all_objects=function(a){var b=Q.ALL;if(-1==a)return b;for(var c=[],d=0;d<b.length;d++){var h=b[d];h.k.sd==a&&c.push(h)}return c};a.get_first_character=function(a){for(var b=Q.MESH,c=0;c<b.length;c++){var d=b[c];if(P.is_character(d))for(var h=d.D,e=0;e<h.length;e++)if(h[e].Ua==a)return d}return null};a.AN=function(a){var b=v(a,
"LAMP",-1);if(b.length==a.q.DR){for(var c=[],d=0;d<b.length;d++){var e=b[d],e=h.ga(e,a);c[e.vk]=d}for(d=0;d<c.length-1;d++)for(e=d+1;e<c.length;e++){var f=b[c[d]].Ta,k=b[c[e]].Ta;if(k.Om&&k.Uk&&(!f.Om||!f.Uk)||!f.Om&&(k.Om||!f.Uk&&k.Uk))f=c[d],c[d]=c[e],c[e]=f}for(d=0;d<c.length;d++)e=b[c[d]],h.ga(e,a).vk=d,M.Nm(b[c[d]],a)}};a.Qr=function(a,b,c,d,h){for(var e=0;e<a.D.length;e++)for(var f=a.D[e].U,k=0;k<f.length;k++){for(var p=f[k],l=0;l<p.T.length;l++)p.T[l].md=b;p.ja.md=c;p.md=c;p.Qa.md=d;""!==p.Ki&&
(p=w.Zz(p.Ki))&&(p.Ny=h)}};a.get_selectable_objects=function(){for(var a=[],b=Q.MESH,c=0;c<b.length;c++){var d=b[c];d.k.Ng&&d.Gj&&a.push(d)}return a};a.get_outlining_objects=function(){for(var a=[],b=Q.MESH,c=0;c<b.length;c++){var d=b[c];d.k.ec&&d.Gj&&a.push(d)}return a};a.wc=function(b,c,d,e){var f=null,k=Q.ALL;switch(b){case a.ot:f=x(c,k,!0,d);break;case a.nt:a:{for(b=0;b<k.length;b++)if(f=k[b],f.Ak==d&&(f.k.sd==e||-1==e)){var p=h.get_dg_parent(f);if(p&&p.Ak==c)break a}f=null}break;case a.Vc:a:{for(e=
0;e<k.length;e++){b=k[e];for(var f=c.length-1,p=b,l=!0;0<=f&&l;)l=p&&p.Ak==c[f]&&(p.k.sd==d||-1==d),p&&(p=h.get_dg_parent(p)),f--;if(l&&!p){f=b;break a}}f=null}}return f};a.get_world_by_name=function(a,b){return x("%meta_world%"+a,Q.WORLD,!0,b)};a.pick_object=function(b,c){var d=M.jk();if(!d)return p.error("No active scene"),null;var h=U.QL(b,c);if(h)return h;h=M.RL(d,b,c);if(!h)return null;for(var d=v(d,"MESH",-1),e=0;e<d.length;e++){var f=d[e].k,k=f.Mj;if(k&&3>Math.abs(255*k[0]-h[0])&&3>Math.abs(255*
k[1]-h[1])&&3>Math.abs(255*k[2]-h[2]))return f.ec&&f.Sr&&(ca.outlining_overview_mode?a.apply_outline_anim(d[e],ca.Ni,ca.Oi,ca.Pi):(h=f.uf,a.apply_outline_anim(d[e],h.Ni,h.Oi,h.Pi))),d[e]}return null};a.set_wind_params=function(a,c){for(var d=v(a,"EMPTY",-1),h=0;h<d.length;h++){var e=d[h];if(e.Gl&&"WIND"===e.Gl.type){var f=e;break}}if(!f)return p.error("There is no wind on the scene"),0;"number"==typeof c.wind_dir&&(d=Z.deg_to_rad(c.wind_dir),L.set(Math.sin(d),-Math.cos(d),0,na),Z.dir_to_quat(na,Z.AXIS_Z,
ra),W.set_rotation(f,ra));"number"==typeof c.wind_strength&&(f.Gl.uC=c.wind_strength);b(f)};a.remove_object=function(a){D.TG(a)&&D.remove(a);var b=Q.ALL,c=Q[a.type],d=b.indexOf(a);a=c.indexOf(a);-1!=d&&b.splice(d,1);-1!=a&&c.splice(a,1)};a.JL=d;a.KL=function(a){return Q[a.type]&&-1<Q[a.type].indexOf(a)}};b4w.module.__obj_util=function(a,q){function e(a){a={type:a,id:0,sd:0,n:g.Rj(),dt:g.Rj(),pivot:new Float32Array(3),yb:new Float32Array(3),yi:0,zi:0,mr:!1,nr:!1,Mj:null,Zf:0,Hm:!1,xe:v.create(),use_panning:!1,pb:0,Xk:1,Wk:1,Yk:1,dof_distance:0,dof_front_start:0,dof_front_end:0,dof_rear_start:0,dof_rear_end:0,dof_power:0,Xa:0,Nc:!1,$c:!1,tc:null,dS:!1,gb:null,oa:null,kb:null,Fc:null,Ec:null,oe:null,Zj:!0,uf:{Ni:1,Oi:1,Pi:0},ce:-1,Nd:-1,Nb:new Float32Array(4),dk:0,Xj:0,Fg:-1,xk:0,Ei:0,ri:!1,pd:!1,Tc:!1,
fd:!1,Qc:!1,Gc:!1,dd:!1,wf:"",Hf:!1,Dd:!1,Bl:!1,fe:!1,jc:!1,ph:!1,hide:!1,Xl:!1,Ng:!1,km:!1,ec:!1,jm:!1,Sr:!1,Ql:!1,is_visible:!1,ho:!1,el:0,Cf:0,kg:0,Kf:0,Jf:0,Gf:0,Sf:"",Yc:null,Aj:!1,Fe:!1,tn:!1,Cj:"",Bj:!1,ge:0,time:0,Qs:0,Rs:0,Tf:0,ck:!1,yc:!1,Rd:!1,Og:[],Bi:!1,dh:!1,qg:1,hn:0,gn:1,Lm:new Int8Array([-1,-1]),tm:[],Fr:[],us:[],zd:null,Od:null,Cd:null,Pd:null,Zd:null,ii:null,So:null,mn:null,ln:null,fi:null,J:f.Mc(),Y:f.Mc(),da:f.oi(),Aa:f.oi(),Z:f.Ge(),va:f.Ge(),rn:null,pn:null,qn:null,vp:!0,Bf:!1};
v.copy(m.AXIS_Z,a.xe);return a}function c(a){if(!(a instanceof Object))return a;var b=null,d=null,e=null,f=null,g=null;a.T&&(b=a.T,a.T=null);a.Uc&&(d=a.Uc,a.Uc=null);a.La&&(e=a.La,a.La=null);a.Qa&&(f=a.Qa,a.Qa=null);a.Sd&&(g=a.Sd,a.Sd=null);var n;n=a.constructor;switch(n){case Int8Array:case Uint8Array:case Int16Array:case Uint16Array:case Int32Array:case Uint32Array:case Float32Array:case Float64Array:n=new n(a);break;case Array:n=new n(a.length);for(var v=0;v<a.length;v++)n[v]=c(a[v]);break;case WebGLUniformLocation:case WebGLProgram:case WebGLShader:n=
a;break;case WebGLFramebuffer:case WebGLTexture:case WebGLBuffer:n=null;break;case Function:n=a;break;default:for(v in n=new n,a)n[v]=c(a[v])}b&&(n.T=b,a.T=b);d&&(n.Uc=d,a.Uc=d);e&&(n.La=e,a.La=e);f&&(n.Qa=f,a.Qa=f);g&&(n.Sd=m.pi(),a.Sd=g);return n}function b(a,b){for(var c=a.D,d=0;d<c.length;d++){var e=c[d];if(e.Ua==b)return e}return null}function n(a){return a.Si?a.parent:a.parent?n(a.parent):null}var f=q("__boundings"),t=q("__config"),g=q("__tsr"),m=q("__util"),v=q("__vec3"),x=q("__vec4"),d=t.v;
new Float32Array(4);new Float32Array(4);new Float32Array(4);g.create();g.create();a.pt=-1;a.wl=e;a.Ut=function(a){var b=e(a.type);b.id=a.id;b.sd=a.sd;g.copy(a.n,b.n);g.copy(a.dt,b.dt);v.copy(a.pivot,b.pivot);v.copy(a.yb,b.yb);b.yi=a.yi;b.zi=a.zi;b.mr=a.mr;b.nr=a.nr;a.Mj&&(b.Mj=v.clone(a.Mj));b.Zf=a.Zf;b.Hm=a.Hm;v.copy(a.xe,b.xe);b.use_panning=a.use_panning;b.pb=a.pb;b.Xk=a.Xk;b.Wk=a.Wk;b.Yk=a.Yk;b.dof_distance=a.dof_distance;b.dof_front_start=a.dof_front_start;b.dof_front_end=a.dof_front_end;b.dof_rear_start=
a.dof_rear_start;b.dof_rear_end=a.dof_rear_end;b.dof_power=a.dof_power;b.Xa=a.Xa;b.Nc=a.Nc;b.$c=a.$c;b.tc=a.tc;b.gb=m.L(a.gb);b.oa=m.L(a.oa);b.kb=m.L(a.kb);b.Fc=m.L(a.Fc);b.Ec=m.L(a.Ec);b.oe=a.oe;b.Zj=a.Zj;b.uf.Ni=a.uf.Ni;b.uf.Oi=a.uf.Oi;b.uf.Pi=a.uf.Pi;b.ce=a.ce;b.Nd=a.Nd;b.Nb=a.Nb;b.dk=a.dk;b.Xj=a.Xj;b.Fg=a.Fg;b.xk=a.xk;b.Ei=a.Ei;b.ri=a.ri;b.pd=a.pd;b.Tc=a.Tc;b.fd=a.fd;b.Qc=a.Qc;b.Gc=a.Gc;b.dd=a.dd;b.wf=a.wf;b.Hf=a.Hf;b.Dd=a.Dd;b.Bl=a.Bl;b.fe=a.fe;b.jc=a.jc;b.ph=a.ph;b.hide=a.hide;b.Xl=a.Xl;b.Ng=
a.Ng;b.km=a.km;b.ec=a.ec;b.jm=a.jm;b.Sr=a.Sr;b.Ql=a.Ql;b.is_visible=a.is_visible;b.ho=a.ho;b.el=a.el;b.Cf=a.Cf;b.kg=a.kg;b.Kf=a.Kf;b.Jf=a.Jf;b.Gf=a.Gf;b.Sf=a.Sf;b.Yc=a.Yc;b.Aj=a.Aj;b.Fe=a.Fe;b.tn=a.tn;b.Cj=a.Cj;b.Bj=a.Bj;b.ge=a.ge;b.time=a.time;b.Qs=a.Qs;b.Rs=a.Rs;b.Tf=a.Tf;b.ck=a.ck;b.yc=a.yc;b.Rd=a.Rd;b.Og=m.L(a.Og);b.Bi=a.Bi;b.dh=a.dh;b.qg=a.qg;b.hn=a.hn;b.gn=a.gn;b.Lm.set(a.Lm);b.tm=m.L(a.tm);b.Fr=m.L(a.Fr);b.us=m.L(a.us);b.zd=m.L(a.zd);b.Od=m.L(a.Od);b.Cd=m.L(a.Cd);b.Pd=m.L(a.Pd);b.Zd=m.L(a.Zd);
b.ii=m.L(a.ii);b.So=m.L(a.So);b.mn=m.L(a.mn);b.ln=m.L(a.ln);b.fi=m.L(a.fi);f.ni(a.J,b.J);f.ni(a.Y,b.Y);f.oq(a.da,b.da);f.oq(a.Aa,b.Aa);f.Yy(a.Z,b.Z);f.Yy(a.va,b.va);b.rn=m.L(a.rn);b.pn=m.L(a.pn);b.qn=m.L(a.qn);b.vp=a.vp;return b};a.Nn=function(a,b,c){c||(c=a);return{name:a,lj:m.Fu(),Ak:c,type:b,Gj:!1,Fa:!1,zo:!1,yp:!1,k:null,Kb:null,M:null,Ta:null,$p:null,anchor:null,Gl:null,Hr:null,D:[],yc:[],be:m.pi(),$t:m.pi(),X:[],Zo:[],rf:[],Up:[],eg:null,Lk:[],parent:null,Si:!1,No:"",Vs:null,Zr:null,Tk:!1,Bb:"",
qq:"AUTO",je:!1,is_character:!1,rk:!1,qy:!1,B:null,u:null,gf:null,we:null,Hl:null,Ey:null,Sv:[],$f:{Yr:"NO_COLLISION",zp:!1,eD:!1,Gg:0,iD:0,hD:0,ou:0,kw:0,gL:!1,hL:!1,iL:!1,jL:!1,kL:!1,lL:!1,In:0,Gn:0,Jn:0,gx:!1,lq:"BOX",wp:!1},jB:{Fs:0,Mv:0,Te:0,cw:0},wj:0,oh:[],Gv:!1,YA:!1,Gr:[]}};a.au=function(a){return a instanceof Array?a.slice():a};a.rQ=function(a){for(var b=[],d=0;d<a.length;d++){var e=a[d],f={},g;for(g in e)e[g]==e.Y?f.Y=c(e.Y):e[g]==e.va?f.va=c(e.va):f[g]=e[g];b.push(f)}return b};a.pq=c;
a.Fa=function(a){return a.Fa};a.pk=function(a){return"MESH"==a.type&&a.Fa};a.kn=function(a,b){a.D.push({Ua:b,kr:!1,U:[],Kg:[],lh:null,sw:[],vk:0,hB:!1,R:[],aC:[]})};a.Yp=function(a,c,d){b(a,c).U.push(d)};a.JR=function(a,b){for(var c=a.D,d=0;d<c.length;d++)if(c[d].Ua==b){c.splice(d,1);break}};a.ga=b;a.YC=function(a,b){for(var c=0;c<a.length;c++)x.copy(b,a[c].k.Nb)};a.mw=function(a,b,c){for(var d=0;d<a.D.length;d++){var e=a.D[d];c&&e.Ua!=c||(e.kr=b)}};a.Sq=function(a,b){for(var c=[],e=b?d.TA-1:d.TA,
f=0;f<a.length;f++){var g=a[f];g.Ta.Oz&&c.length<e&&c.push(g)}return c.length?c:a[0]?[a[0]]:[]};a.Hy=function(a,b){if(b.b4w_enable_soft_particles&&0<b.b4w_particles_softness){var c=b.material-1,d=a.data.materials;if(0<=c&&c<d.length&&("ADD"==d[c].game_settings.alpha_blend||"ALPHA"==d[c].game_settings.alpha_blend||"ALPHA_SORT"==d[c].game_settings.alpha_blend))return!0}return!1};a.YG=function(a){a=a.D;for(var b=0;b<a.length;b++)for(var c=a[b].U,d=0;d<c.length;d++)for(var e=c[d].qb.qi,f=0;f<e.length;f++){var g=
e[f];if("USE_MODEL_MATRIX_INVERSE"==g[0]&&"1"==g[1])return!0}return!1};a.Kz=function(a,b){return a+"*"+b};a.get_parent=function(a){return a.Si?null:a.parent};a.get_dg_parent=n;a.Iu=function(a,b){for(var c=[],d=0;d<b.length;d++){var e=b[d];n(e)==a&&c.push(e)}return c};a.get_object_data_id=function(a){return a.k.sd};a.is_mesh=function(a){return"MESH"===a.type};a.is_armature=function(a){return"ARMATURE"===a.type};a.is_speaker=function(a){return"SPEAKER"===a.type};a.is_camera=function(a){return"CAMERA"===
a.type};a.is_lamp=function(a){return"LAMP"===a.type};a.is_empty=function(a){return"EMPTY"===a.type};a.is_line=function(a){return"LINE"===a.type};a.is_world=function(a){return"WORLD"===a.type}};b4w.module.__particles=function(a,q){function e(){x.r("_rand() undefined")}function c(a,b,c,d,e,h){var f=a.zq,k=a.Nf,p=a.time;a=a.xB;for(var g=0;g<f.length;g+=4){var l=f[g];if(p>a&&p>=l&&l>a||p<a&&(l>a||p>=l))for(l=0;8>l;l++)k[8*g+l]=d[l],C[l]=d[l];else for(l=0;8>l;l++)C[l]=k[8*g+l];l=B;l[0]=b[3*g];l[1]=b[3*g+1];l[2]=b[3*g+2];v.transform_vec3(l,C,l);e[3*g]=l[0];e[3*g+1]=l[1];e[3*g+2]=l[2];var m=r;m[0]=c[4*g];m[1]=c[4*g+1];m[2]=c[4*g+2];m[3]=c[4*g+3];v.cO(m,C,m);h[4*g]=m[0];h[4*g+1]=m[1];h[4*g+2]=
m[2];h[4*g+3]=m[3];for(l=1;4>l;l++)e[3*(g+l)]=e[3*g],e[3*(g+l)+1]=e[3*g+1],e[3*(g+l)+2]=e[3*g+2],h[4*(g+l)]=m[0],h[4*(g+l)+1]=m[1],h[4*(g+l)+2]=m[2],h[4*(g+l)+3]=m[3]}}function b(a){a?(x.LN(a),e=function(){return x.cM()}):e=function(){return Math.random()}}var n=q("__config"),f=q("__batch"),t=q("__geometry"),g=q("__textures"),m=q("__time"),v=q("__tsr"),x=q("__util"),d=q("__vec3"),k=n.v,r=new Float32Array(4),C=new Float32Array(8),B=new Float32Array(3),F=[];a.update=function(){for(var a=0;a<F.length;a++)for(var b=
F[a],d=b.D,e=0;e<d.length;e++)for(var f=b,h=d[e].U,k=0;k<h.length;k++){var g=h[k],p=g.Ma;p&&p.Ns&&!g.jf&&(c(p,p.uB,p.FC,f.k.n,p.Tv,p.Ow),p.XA=!0)}};a.hm=function(a){a=a.D;for(var b=0;b<a.length;b++)for(var c=a[b].U,d=0;d<c.length;d++)if(c[d].Ma)return!0;return!1};a.gB=function(a){a=a.D;for(var b=0;b<a.length;b++)for(var c=a[b].U,d=0;d<c.length;d++){var e=c[d].Ma;if(e&&"EMITTER"==e.Tr)return!0}return!1};a.zG=function(a){return 0<a.particle_systems.length};a.yG=function(a){for(var b=0;b<a.particle_systems.length;b++)if("EMITTER"==
a.particle_systems[b].settings.type)return!0;return!1};a.tK=function(a){for(var b=0;b<a.particle_systems.length;b++){var c=a.particle_systems[b].settings;if("HAIR"==c.type&&c.b4w_dynamic_grass)return!0}return!1};a.yK=function(a,b,c){var d=a.Ma={name:b.name,Tr:b.settings.type,time:0,xB:-1,Ns:!1,ma:0,Oa:0,KC:0,gv:0,KA:0,cyclic:0,Gg:0,Hv:0,iA:0,$j:0,Ke:0,sD:0,size:0,Yx:0,Xx:0,Sy:0,Ry:new Float32Array(16),XA:!1,uB:null,Tv:null,FC:null,Ow:null,zq:null,ru:null,Nf:null,lB:null,IC:0,JC:0};d.ma=b.settings.frame_start;
d.Oa=b.settings.frame_end;d.KC=(d.Oa-d.ma)/m.Pc();d.gv=b.settings.lifetime;d.KA=d.gv/m.Pc();d.cyclic=b.settings.b4w_cyclic?1:0;d.Gg=b.settings.mass;d.Hv=b.settings.normal_factor;d.iA=9.81*b.settings.effector_weights.gravity;d.$j=b.settings.b4w_fade_in/m.Pc();d.Ke=b.settings.b4w_fade_out/m.Pc();d.sD=b.settings.effector_weights.wind;d.Ns="WORLD"==b.settings.b4w_coordinate_system?!0:!1;var e,h,u;a.qo?(e=c.halo.size,h=c.halo.hardness,30>h?(h=.5,u=.9):40>h?(h=.1,u=1):50>h?(h=0,u=.8):(h=0,u=.5)):(e=b.settings.particle_size,
u=h=1);d.size=e;d.Yx=h;d.Xx=u;c.use_nodes&&"BILLBOARD"==b.settings.render_type&&(f.Va(a,"NODES",1),f.Va(a,"PARTICLE_BATCH",1),a.hS=!0,a.wi=!0);b=b.settings.texture_slots;b[0]&&b[0].use_map_size&&b[0].texture&&"BLEND"==b[0].texture.type&&b[0].texture.use_color_ramp&&k.Wp&&(e=[],g.CG(b[0].texture.color_ramp,g.Mx,e),e=new Uint8Array(e.map(function(a){return x.clamp(255*a,0,255)})),f.WF(a,e,g.Mx),f.Va(a,"USE_COLOR_RAMP",1));c=c.texture_slots;a=[-1,0,0,0,-1,0,0,0,-1,0,0,0,-1,0,0,0];if(c[0]&&"STRAND"==
c[0].texture_coords&&c[0].texture&&"BLEND"==c[0].texture.type&&c[0].texture.use_color_ramp){c=c[0].texture.color_ramp.elements;b=Math.min(4*c.length,a.length);for(e=0;e<b;e+=4)h=c[e/4],a[e]=h.position,a[e+1]=h.color[0],a[e+2]=h.color[1],a[e+3]=h.color[2];d.Sy=c.length}d.Ry.set(a)};a.BJ=function(a,f,k,g){var n=a.Ma,h=g.n;g=k.settings.count;var u=k.settings.frame_start/m.Pc(),r=k.settings.frame_end/m.Pc(),p=k.settings.lifetime/m.Pc(),z=k.settings.lifetime_random,l=k.settings.emit_from,v=k.settings.factor_random;
if(k.settings.use_rotations)var B=k.settings.angular_velocity_mode,q=k.settings.angular_velocity_factor;else B="NONE",q=0;var C=k.settings.b4w_randomize_emission,J=k.settings.b4w_cyclic;n.IC=k.settings.billboard_tilt;n.JC=k.settings.billboard_tilt_random;b(k.seed);var F;f=t.xz(f,["a_position","a_tbn_quat"],null);switch(l){case "VERT":var L=f.P[0].a_position;F=f.P[0].a_tbn_quat;k=L.length/3;f=[];for(l=0;l<g;l++){var O=Math.round((k-1)*e());f.push(O);f.push(O);f.push(O);f.push(O)}k=[];for(l=0;l<f.length;l++)k.push(L[3*
f[l]]),k.push(L[3*f[l]+1]),k.push(L[3*f[l]+2]);L=new Float32Array(k);k=[];for(l=0;l<f.length;l++)k.push(F[4*f[l]]),k.push(F[4*f[l]+1]),k.push(F[4*f[l]+2]),k.push(F[4*f[l]+3]);F=new Float32Array(k);break;case "FACE":L=[];F=[];l=[];x.jr(0,l);k=t.Gu(f,g,!1,l);x.jr(0,l);f=t.Gu(f,g,!0,l);for(l=0;l<k.length;l++)L.push(k[l][0],k[l][1],k[l][2]),L.push(k[l][0],k[l][1],k[l][2]),L.push(k[l][0],k[l][1],k[l][2]),L.push(k[l][0],k[l][1],k[l][2]),F.push(f[l][0],f[l][1],f[l][2],f[l][3]),F.push(f[l][0],f[l][1],f[l][2],
f[l][3]),F.push(f[l][0],f[l][1],f[l][2],f[l][3]),F.push(f[l][0],f[l][1],f[l][2],f[l][3]);L=new Float32Array(L);F=new Float32Array(F);break;case "VOLUME":x.r("Particle emission from volume is not supported");break;default:x.r("Wrong emit from option")}F=[L,F];L=F[0];F=F[1];n.uB=new Float32Array(L);n.FC=new Float32Array(F);n.Tv=new Float32Array(L.length);n.Ow=new Float32Array(F.length);f=[];r=(r-u)/g;for(k=0;k<g;k++)l=C?r*k+10*r*(.5-e()):r*k,J||(l+=u),f.push(l),f.push(l),f.push(l),f.push(l);u=new Float32Array(f);
n.zq=new Float32Array(u);n.ru=new Float32Array(u);if(n.Ns){n.Nf=new Float32Array(8*u.length);for(C=0;C<8*u.length;C++)for(J=0;8>J;J++)n.Nf[8*C+J]=h[J];c(n,L,F,h,L,F)}h=t.Re("EMITTER_PARTICLES");C=x.If();C.a_position=L;C.a_tbn_quat=F;h.P[0]=C;a.Lf=t.Gp;a=[];for(C=0;C<g;C++)a.push(4*C,4*C+2,4*C+1,4*C,4*C+3,4*C+2);a=new Uint16Array(a);h.lb=a;a=h.aa;C=[];for(J=0;J<g;J++)C.push(-.5,-.5,-.5,.5,.5,.5,.5,-.5);C=new Float32Array(C);a.a_p_bb_vertex=C;h.sa=L.length/3;a=[];z*=p;for(C=0;C<g;C++)J=z*e(),a.push(p-
J),a.push(p-J),a.push(p-J),a.push(p-J);p=h.aa;z=[];for(C=0;C<g;C++)J=Math.random(),z.push(a[4*C],u[4*C],J),z.push(a[4*C+1],u[4*C+1],J),z.push(a[4*C+2],u[4*C+2],J),z.push(a[4*C+3],u[4*C+3],J);z=new Float32Array(z);p.a_p_data=z;p=h.aa;z=[];for(a=0;a<g;a++){u=[e()-.5,e()-.5,e()-.5];d.normalize(u,u);z.push(v*u[0]);z.push(v*u[1]);z.push(v*u[2]);switch(B){case "NONE":z.push(0);break;case "SPIN":case "VELOCITY":z.push(q);break;case "RAND":z.push(2*q*(e()-.5));break;default:x.r("Undefined velocity factor")}u=
z.slice(-4);for(C=0;12>C;C++)z.push(u[C%4])}g=new Float32Array(z);p.a_p_vels=g;n.lB=new Float32Array(h.aa.a_p_data);return h};a.hN=function(a,b,c){a=a.D;for(var d=0;d<a.length;d++)for(var e=a[d].U,h=0;h<e.length;h++){var f=e[h].Ma;f&&f.name==b&&!e[h].jf&&(f.xB=f.time,f.time=c)}};a.ZL=function(a){for(var b=a.sa,c=a.P[0].a_position,d=a.aa.a_texcoord,e=[],h=[],f=0;f<b;f++)h.push(c[3*f]),e.push(c[3*f+1]),h.push(c[3*f+2]);e=new Float32Array(e);h=new Float32Array(h);a.aa.a_lf_dist=e;a.aa.a_lf_bb_vertex=
h;a.aa.a_texcoord=d;return a};a.set_size=function(a,b,c){a=a.D;for(var d=0;d<a.length;d++)for(var e=a[d].U,h=0;h<e.length;h++){var f=e[h].Ma;f&&f.name==b&&(f.size=c)}};a.set_normal_factor=function(a,b,c){a=a.D;for(var d=0;d<a.length;d++)for(var e=a[d].U,h=0;h<e.length;h++){var f=e[h].Ma;f&&f.name==b&&(f.Hv=c)}};a.set_factor=function(a,b,c){a=a.D;for(var d=0;d<a.length;d++)for(var e=a[d].U,h=0;h<e.length;h++){var f=e[h],k=f.Ma;if(k&&k.name==b){var p=k.zq;if(1==c)var g=p;else if(0==c)for(var g=k.ru,
l=0;l<g.length;l+=4)g[l]=1E4,g[l+1]=g[l],g[l+2]=g[l],g[l+3]=g[l];else for(var m=4/c,g=k.ru,n=0,l=0;l<g.length;l+=4)l>=n?(g[l]=p[l],n+=m):g[l]=1E4,g[l+1]=g[l],g[l+2]=g[l],g[l+3]=g[l];f=f.ja;if(f.zb.a_p_data){k=k.lB;for(l=0;l<k.length;l+=3)k[l+1]=g[Math.round(l/3)];t.TC(f,"a_p_data",3,k)}}}};a.JO=function(a,b,c){a=a.D;for(var d=0;d<a.length;d++)for(var e=a[d].U,h=0;h<e.length;h++){var f=e[h].Ma;if(f&&f.Ns)for(var k=0;k<8*f.zq.length;k++)f.Nf[8*k]=b[0],f.Nf[8*k+1]=b[1],f.Nf[8*k+2]=b[2],f.Nf[8*k+3]=b[3],
f.Nf[8*k+4]=c[0],f.Nf[8*k+5]=c[1],f.Nf[8*k+6]=c[2],f.Nf[8*k+7]=c[3]}};a.DO=function(a,b,c){for(var d=[],e=0;e<c;e++)d.push(0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1);a.aa.a_tbn_quat=new Float32Array(d);if(b.Po){d=[];for(e=0;e<c;e++)d.push(e,e,e,e);a.aa[b.Po.name]=new Float32Array(d)}};a.CO=function(a){-1==F.indexOf(a)&&F.push(a)};a.hM=function(a){a=F.indexOf(a);-1!=a&&F.splice(a,1)};a.cleanup=function(){F.length=0}};b4w.module.__primitives=function(a,q){function e(a,b,c,e){for(var f=[],m=[],n=[],q=[],D=2*c/(a-1),y=2*e/(b-1),A=0;A<a;A++)for(var H=-c+A*D,w=0;w<b;w++)if(m.push(H,-e+w*y,0),q.push(0,0,0,1),n.push(A/(a-1),w/(b-1)),A&&w){var h=A*b+w,u=h-1,P=(A-1)*b+w,p=P-1;f.push(h,u,P);f.push(u,p,P)}a=g.If();a.a_position=new Float32Array(m);a.a_tbn_quat=new Float32Array(q);q=t.Re("GRID_PLANE");q.P[0]=a;q.aa.a_texcoord=new Float32Array(n);q.lb=new Uint32Array(f);q.sa=m.length/3;return q}function c(a){var b=a.length;
b%4&&g.r("Wrong array");for(var c=[],e=[],f=0;f<b;f+=4){var m=a[f+1],B=a[f+2],q=a[f+3];n(a[f],e);n(m,e);n(B,e);n(q,e);c.push(f,f+1,f+2);c.push(f,f+2,f+3)}a=g.If();a.a_position=new Float32Array(e);b=t.Re("FROM_QUADS");b.P[0]=a;b.lb=new Uint32Array(c);b.sa=e.length/3;return b}function b(a,b){var c=3*b;return[a[c],a[c+1],a[c+2]]}function n(a,b){b.push(a[0],a[1],a[2])}var f=q("__config"),t=q("__geometry");q("__print");var g=q("__util"),m=f.v;a.FJ=function(){var a=t.Re("LINE"),b=g.If();b.a_position=new Float32Array(3);
b.a_direction=new Float32Array(3);a.P[0]=b;a.lb=new Uint32Array(1);a.sa=1;return a};a.PQ=function(a,b){var c=e(2,2,a,b);c.name="PLANE";return c};a.OQ=e;a.yJ=function(a,b,c){function e(a,b){return 1==a%2&&(0==b||b==q-1)||1==b%2&&(0==a||a==B-1)?!0:!1}var f=c/=Math.pow(2,a-1),n=c,B=b+1,q=b+1;b=[];c=[];for(var D=[],y=0,A=0,H=-1,w=[],h=0;h<a;h++){for(var u=2*f/(B-1),P=2*n/(q-1),p=[],z=[],l=0,M=0;M<B;M++){for(var E=-f+M*u,W=[],G=0;G<q;G++){var J=-n+G*P;if(E>-y&&E<y&&J>-A&&J<A)W.push(-1),l++;else{for(var Z=
null,L=0;L<w.length;L+=3)if(E==w[L]&&J==w[L+1]){Z=w[L+2];break}L=null!==Z?Z:H+1;e(M,G)?(W.push(-2),l++):(null==Z&&(0==G||G==q-1||0==M||M==B-1?(Z=h==a-1?u:2*u,p.push(E,J,L)):Z=u,c.push(E,J,Z),D.push(.707,0,0,.707),H++),W.push(L));if(M&&G)if(1==M)if(e(M-1,G)){if(1<G){var J=L-1,Z=z[M-1][G+1],O=Z-1;b.push(O,J,L)}else Z=z[M-1][G+1],O=Z-1;b.push(Z,O,L)}else e(M,G)||(J=L-1,Z=z[M-1][G],b.push(Z,J,L));else if(M==B-1){if(!e(M,G))if(G==q-1)J=L-1,Z=z[M-1][G-1],O=z[M-2][G],b.push(Z,J,L),b.push(O,Z,L);else{var J=
L-1,Z=z[M-1][G],O=Z-1,U=Z+1;b.push(O,J,L);b.push(Z,O,L);b.push(U,Z,L);2==G&&(U=z[M-2][G-2],b.push(O,U,J))}}else 1==G?e(M,G-1)?(J=z[M-1][G],Z=z[M-1][G-1],b.push(J,Z,L)):(J=W[G-1],Z=z[M-1][G],O=z[M-2][G-1],b.push(Z,J,L),b.push(Z,O,J)):G==q-1?e(M,G)||(J=W[G-1],Z=z[M-1][G-1],O=z[M-2][G],b.push(Z,J,L),b.push(O,Z,L)):-1!=z[M-1][G]&&-1!=z[M-1][G-1]&&-1!=W[G-1]?(J=W[G-1],Z=z[M-1][G],O=z[M-1][G-1],b.push(Z,J,L),b.push(Z,O,J),G==q-2&&e(M,G+1)&&(U=z[M-1][G+1],b.push(U,Z,L))):G==q-2&&e(M,G+1)&&(Z=z[M-1][G],U=
z[M-1][G+1],b.push(U,Z,L))}}z.push(W)}w=p;y=f;A=n;f*=2;n*=2}if(2E4>y)for(a=-(2*y)/(B-1),c.push(-2E4,-2E4,a),c.push(-2E4,2E4,a),c.push(-y,-A,a),c.push(-y,A,a),c.push(2E4,-2E4,a),c.push(2E4,2E4,a),c.push(y,-A,a),c.push(y,A,a),L=H+1,b.push(L+1,L+2,L+3,L+1,L+0,L+2,L+2,L+4,L+6,L+2,L+0,L+4,L+1,L+7,L+5,L+1,L+3,L+7,L+7,L+4,L+5,L+6,L+4,L+7),M=0;8>M;M++)D.push(.707,0,0,.707);a=g.If();a.a_position=new Float32Array(c);a.a_tbn_quat=new Float32Array(D);f=t.Re("MULTIGRID_PLANE");f.P[0]=a;f.lb=new Uint32Array(b);
f.sa=c.length/3;m.rD&&(t.Ds(f,1,!0),a.a_polyindex=t.Hq(f));return f};a.NQ=function(a){var b=a.length;b%3&&g.r("Wrong array");for(var c=[],e=[],f=0;f<b;f+=3){var m=a[f+1],q=a[f+2];n(a[f],e);n(m,e);n(q,e);c.push(f,f+1,f+2)}a=g.If();a.a_position=new Float32Array(e);b=t.Re("FROM_TRIANGLES");b.P[0]=a;b.lb=new Uint32Array(c);b.sa=e.length/3;return b};a.MQ=c;a.CJ=function(a){a=g.dP(a);var b=[];b.push(a[0],a[1],a[2],a[3]);b.push(a[0],a[3],a[5],a[4]);b.push(a[3],a[2],a[6],a[5]);b.push(a[1],a[7],a[6],a[2]);
b.push(a[0],a[4],a[7],a[1]);b.push(a[4],a[5],a[6],a[7]);a=c(b);a.name="FRUSTUM";return a};a.vc=function(){var a=t.Re("FULLSCREEN_TRI"),b=g.If();b.a_position=new Float32Array([0,0,1,0,0,1]);a.P[0]=b;a.lb=new Uint32Array([0,1,2]);a.sa=3;return a};a.DJ=function(){var a=t.Re("FULLSCREEN_QUAD"),b=g.If();b.a_position=new Float32Array([-1,1,1,1,-1,-1,1,-1]);a.P[0]=b;a.lb=new Uint32Array([0,2,1,1,2,3]);a.sa=4;return a};a.xJ=function(){var a=t.Re("BILLBOARD"),b=g.If();b.a_bb_vertex=new Float32Array([-.5,-.5,
-.5,.5,.5,.5,.5,-.5]);a.P[0]=b;a.lb=new Uint32Array([0,2,1,0,3,2]);a.sa=4;return a};a.zJ=function(){var a=t.Re("CUBEMAP_BOARD"),b=g.If();b.a_position=new Float32Array([-1,-1,-1,1,1,1,1,-1]);a.P[0]=b;a.lb=new Uint32Array([0,2,1,0,3,2]);a.sa=4;return a};a.Pq=function(a,c){var d=t.Re("UV_SPHERE"),e,f,m=[],q=[],F=[];for(f=0;8>=f;f++)for(e=0;16>=e;e++){var D=e/16,y=f/8;q.push(-a*Math.cos(2*D*Math.PI)*Math.sin(y*Math.PI)+c[0],a*Math.cos(y*Math.PI)+c[1],a*Math.sin(2*D*Math.PI)*Math.sin(y*Math.PI)+c[2])}for(f=
D=0;8>f;f++)for(e=0;16>e;e++){var y=b(q,17*f+e+1),A=b(q,17*f+e),H=b(q,17*(f+1)+e),w=b(q,17*(f+1)+e+1);Math.abs(y[1])==a+c[1]?(n(y,m),n(H,m),n(w,m),F.push(D,D+1,D+2),D+=3):Math.abs(H[1])==a+c[1]?(n(y,m),n(A,m),n(H,m),F.push(D,D+1,D+2),D+=3):(n(y,m),n(A,m),n(H,m),n(w,m),F.push(D,D+1,D+2),F.push(D,D+2,D+3),D+=4)}e={};e.a_position=m;q=t.vy(F,q,m);q=t.uy(F,m,q);e.a_tbn_quat=g.gen_tbn_quats(q);d.aa.a_influence=[];d.aa.a_color=[];d.aa.a_texcoord=[];d.P[0]=e;d.lb=F;d.sa=m.length/3;return d};a.Nz=function(a){var b=
t.Re("INDEX"),c=g.If();c.a_index=new Float32Array(a);for(var e=0;e<a;e++)c.a_index[e]=e;b.P[0]=c;b.lb=new Uint16Array(0);b.sa=a;return b}};b4w.module.__prerender=function(a,q){function e(a,b){var c=a.Ig;c.is_visible=!1;if(c.hide)return!1;var e=b.p,f=b.type==m.Ac?e.Ar:v.bc(e.n,C),k=c.xk,g=c.Fg,f=d.dist(c.Aa.I,f);if(!(f<k?0:g==t.pt||f<g+c.Ei*c.Aa.Ka))return!1;c.is_visible=!0;f=a.pa;if(b.type==m.ze)return b.debug_view_mode==n.DV_BOUNDINGS?f.nh:!f.nh;if(b.type==m.mg&&0==c.Zf)return!1;c.vp?(k=f.Aa,g=f.va,f=f.Bf):(k=c.Aa,g=c.va,f=c.Bf);if(c=!c.ph)e=e.Ag,c=g,g=f,f=k.I,x.GN(f,e,k.Ka)?c=!0:g?(f=c.I,c=x.UI(f,e,c.jd,c.kd,c.ld)):c=!1;return c?!1:
!0}function c(a){var b=a.Ma;if(b&&b.XA){a=a.ja;f.pL(a);var c=a.Hc,d=a.zb,e=d.a_tbn_quat;c.set(b.Tv,d.a_position.offset);c.set(b.Ow,e.offset);f.ex(a)}}var b=q("__config"),n=q("__debug"),f=q("__geometry"),t=q("__obj_util"),g=q("__renderer"),m=q("__subscene"),v=q("__tsr"),x=q("__util"),d=q("__vec3"),k=b.v,r=[m.sb,m.gc,m.Wc,m.Jc,m.Ae,m.Vd,m.qd,m.Be,m.Ac,m.Ce,m.mg,m.ze,m.Ud,m.$g],C=new Float32Array(3);a.bs=function(a){if(-1<r.indexOf(a.type)){for(var b=!1,n=a.type==m.Jc||a.type==m.Vd,t=a.Ea,x=0;x<t.length;x++){for(var q=
t[x],w=q.ka,h=!1,u=0;u<w.length;u++){var P=w[u],p=P.pa;if(n)for(var z=0;6>z;z++)a.p.Ag=a.Qn[z],P.vu[z]=e(P,a),P.vu[z]&&(h=b=!0,c(p));else P.vb=e(P,a),P.vb&&(h=b=!0,c(p));a.wa&&(p.Qa.Io=!0)}q.vb=h}a.wa=!1;switch(a.type){case m.ze:break;default:a.type==m.sb||a.type==m.Ce||a.type==m.qd||a.type==m.Wc||a.type==m.Jc||b?a.vb=!0:(a.vb&&g.clear(a),a.vb=!1)}if((a.type==m.gc||a.type==m.Be)&&k.alpha_sort)for(b=v.bc(a.p.n,C),n=a.Ea,t=0;t<n.length;t++)for(x=n[t].ka,q=0;q<x.length;q++)if(h=x[q],h.vb){w=h.Ig;if((h=
h.pa)&&h.bf){h=h.ja;if(!h)continue;u=h.Pl;P=d.dist(b,u.vD);p=k.alpha_sort_threshold*Math.min(u.qG,1);if(!(P>p||w.ho))continue;f.pO(h,w.n,b);d.copy(b,u.vD)}w.ho=!1}}else if(a.wa){t=a.Ea;for(x=0;x<t.length;x++)for(w=t[x].ka,u=0;u<w.length;u++)P=w[u],p=P.pa,p.Qa.Io=!0;a.wa=!1}a.Dv&&m.zN(a)}};b4w.module.__print=function(a){function q(a,b){var c=[];-1<a[0].indexOf("%c")?c.push(a[0].replace("%c","%c"+b+": ")):c.push(b+": "+a[0]);for(var d=1;d<a.length;d++)c.push(a[d]);return c}function e(){f++;var a=q(arguments,"B4W ERROR");console.error.apply(console,a)}function c(a){a in g||(g[a]=a,e([a]))}function b(a,b){c(a+"() is deprecated, use "+b+"() instead.")}var n=!1,f=0,t=0,g={};a.iN=function(a){n=a};a.le=function(){console.log.apply(console,arguments)};a.log=function(){if(n){var a=q(arguments,
"B4W LOG");console.log.apply(console,a)}};a.error=e;a.uc=c;a.tb=b;a.yg=function(a,e){switch(1<e.length){case !0:c(a+"() is deprecated, use "+e.slice(0,-1).join("(), ")+"() or "+e[e.length-1]+"() instead.");break;case !1:b(a,e[0])}};a.YI=function(){c('Config option "anaglyph_use" is deprecated, use "stereo" instead.')};a.warn=function(){t++;var a=q(arguments,"B4W WARN");console.warn.apply(console,a)};a.info=function(){var a=q(arguments,"B4W INFO");console.info.apply(console,a)};a.$I=function(){f++;
var a=q(arguments,"B4W EXPORT ERROR");console.error.apply(console,a)};a.aJ=function(){t++;var a=q(arguments,"B4W EXPORT WARNING");console.warn.apply(console,a)};a.time=function(){n&&console.time.apply(console,arguments)};a.timeEnd=function(){n&&console.timeEnd.apply(console,arguments)};a.group=function(){console.group.apply(console,arguments)};a.groupCollapsed=function(){console.groupCollapsed.apply(console,arguments)};a.groupEnd=function(){console.groupEnd.apply(console,arguments)};a.clear=function(){"function"==
typeof console.clear&&console.clear.apply(console,arguments)};a.nK=function(){return t};a.WJ=function(){return f};a.clear_errors_warnings=function(){f=t=0}};b4w.module.print=b4w.module.__print;b4w.module.__reformer=function(a,q){function e(a){switch(a.type){case "VALTORGB":a.color_ramp||(a.color_ramp={elements:[{position:.5,color:[1,1,1,1]}]},b("node Color Ramp",a,"color_ramp"));break;case "CURVE_RGB":a.curve_mapping||(a.curve_mapping={curves_data:[[[0,0],[1,1]],[[0,0],[1,1]],[[0,0],[1,1]],[[0,0],[1,1]]],curves_handle_types:["EXTRAPOLATED","EXTRAPOLATED","EXTRAPOLATED","EXTRAPOLATED"],curve_extend:[["AUTO","AUTO"],["AUTO","AUTO"],["AUTO","AUTO"],["AUTO","AUTO"]]},b("node RGB Curves",a,
"curve_mapping"));break;case "CURVE_VEC":a.curve_mapping||(a.curve_mapping={curves_data:[[[0,0],[1,1]],[[0,0],[1,1]],[[0,0],[1,1]]],curves_handle_types:["EXTRAPOLATED","EXTRAPOLATED","EXTRAPOLATED"],curve_extend:[["AUTO","AUTO"],["AUTO","AUTO"],["AUTO","AUTO"]]},b("node Vector Curves",a,"curve_mapping"));break;case "MAPPING":a.vector_type||(a.vector_type="POINT",b("node Mapping",a,"vector_type"));break;case "MATERIAL":case "MATERIAL_EXT":"alpha"in a||(a.alpha=1,b("node material",a,"alpha"));"darkness"in
a||(a.darkness=1,b("node material",a,"darkness"));"diffuse_toon_size"in a||(a.diffuse_toon_size=.5,b("node material",a,"diffuse_toon_size"));"diffuse_toon_smooth"in a||(a.diffuse_toon_smooth=.1,b("node material",a,"diffuse_toon_smooth"));"diffuse_intensity"in a||(a.diffuse_intensity=1,b("node material",a,"diffuse_intensity"));"use_tangent_shading"in a||(a.use_tangent_shading=!1,b("node material",a,"use_tangent_shading"));"specular_shader"in a||(a.specular_shader="COOKTORR",b("node material",a,"specular_shader"));
"specular_ior"in a||(a.specular_ior=4,b("node material",a,"specular_ior"));"specular_hardness"in a||(a.specular_hardness=50,b("node material",a,"specular_hardness"));"specular_slope"in a||(a.specular_slope=.1,b("node material",a,"specular_slope"));"specular_toon_size"in a||(a.specular_toon_size=.5,b("node material",a,"specular_toon_size"));"specular_toon_smooth"in a||(a.specular_toon_smooth=.1,b("node material",a,"specular_toon_smooth"));"specular_intensity"in a||(a.specular_intensity=.5,b("node material",
a,"specular_intensity"));"diffuse_shader"in a||(a.diffuse_shader="LAMBERT",b("node material",a,"diffuse_shader"));"roughness"in a||(a.roughness=.5,b("node material",a,"roughness"));"diffuse_fresnel"in a||(a.diffuse_fresnel=.1,b("node material",a,"diffuse_fresnel"));"diffuse_fresnel_factor"in a||(a.diffuse_fresnel_factor=.5,b("node material",a,"diffuse_fresnel_factor"));break;case "MATH":case "MIX_RGB":"use_clamp"in a||(a.use_clamp=!1,b("node "+a.type,a,"use_clamp"));break;case "GROUP":a.node_tree_name=
a.node_tree_name.replace(/\.[0-9]{3,}$/g,"");switch(a.node_tree_name){case "CLAMP":case "LEVELS_OF_QUALITY":case "LINEAR_TO_SRGB":case "NORMAL_VIEW":case "PARALLAX":case "REFLECT":case "REFRACTION":case "REPLACE":case "SMOOTHSTEP":case "SRGB_TO_LINEAR":case "TIME":case "TRANSLUCENCY":case "VECTOR_VIEW":a.node_tree_name="B4W_"+a.node_tree_name}break;case "VECT_TRANSFORM":"convert_from"in a||(a.convert_from="WORLD",b("node "+a.type,a,"convert_from")),"convert_to"in a||(a.convert_to="WORLD",b("node "+
a.type,a,"convert_to")),"vector_type"in a||(a.vector_type="POINT",b("node "+a.type,a,"vector_type"))}}function c(a){if(a=a.nla_tracks)for(var c=0;c<a.length;c++)for(var d=a[c],e=0;e<d.strips.length;e++){var f=d.strips[e];"action"in f||(f.action=null,b("strip",f,"action"));"action_frame_start"in f||(f.action_frame_start=0,b("strip",f,"action_frame_start"));"action_frame_end"in f||(f.action_frame_end=f.frame_end-f.frame_start,b("strip",f,"action_frame_end"));"repeat"in f||(f.repeat=1,b("strip",f,"repeat"));
"use_reverse"in f||(f.use_reverse=!1,b("strip",f,"use_reverse"));"scale"in f||(f.scale=1,b("strip",f,"scale"))}}function b(a,b,c){c=c+">>"+a;c in y||(y[c]={Ew:[],HB:"undefined",type:a});y[c].Ew.push(b.name)}function n(a,b,c){c=c+">>"+a;c in y||(y[c]={Ew:[],HB:"deprecated",type:a});y[c].Ew.push(b.name)}function f(a){x.warn(a)}function t(a,b){b||(b=a.name+"_COPY");var c=a.materials,d=a.submeshes;a.materials=null;a.submeshes=null;var e=k.ih(a);a.materials=c;a.submeshes=d;e.name=b;e.materials=a.materials.slice(0);
e.submeshes=[];for(c=0;c<d.length;c++){var f=k.Fn(d[c]);e.submeshes.push(f)}return e}var g=q("__boundings"),m=q("__curve"),v=q("__mat4"),x=q("__print"),d=q("__quat"),k=q("__util"),r=q("__vec3");q("__vec4");var C=q("__mat3"),B=q("__logic_nodes"),F=q("__animation"),D=[5,4],y={},A=C.create(),H=d.create();a.Iy=function(a){return-1!=k.jD(a,D)};a.RG=function(a){y={};var d=a.worlds;if(0==d.length){x.warn('WARNING Datablock world is missing, reexport "'+a.b4w_filepath_blend+'" scene');var g={name:"DEFAULT",
horizon_color:new Float32Array([0,0,0]),zenith_color:new Float32Array([0,0,0]),light_settings:{use_environment_light:!1,environment_energy:1,environment_color:"PLAIN"},fog_settings:{use_fog:!1,intensity:0,depth:25,start:5,height:0,falloff:"INVERSE_QUADRATIC",use_custom_color:!0,color:[.5,.5,.5]},use_sky_paper:!1,use_sky_blend:!1,use_sky_real:!1,texture_slots:[]};d.push(g)}for(var d=a.worlds,m=0;m<d.length;m++){g=d[m];"use_sky_blend"in g||(b("world",g,"use_sky_blend"),g.use_sky_blend=!1);"use_sky_paper"in
g||(b("world",g,"use_sky_paper"),g.use_sky_paper=!1);"use_sky_real"in g||(b("world",g,"use_sky_real"),g.use_sky_real=!1);"b4w_sky_settings"in g&&"rayleigh_brightness"in g.b4w_sky_settings||(b("world",g,"rayleigh_brightness"),g.b4w_sky_settings={render_sky:!1,procedural_skydome:!1,use_as_enviroment_map:!1,color:[.24,.43,.75],rayleigh_brightness:3.3,mie_brightness:.1,spot_brightness:10,scatter_strength:.2,rayleigh_strength:.2,mie_strength:.006,rayleigh_collection_power:.5,mie_collection_power:.5,mie_distribution:.4});
"fog_settings"in g||(b("world",g,"fog_settings"),g.fog_settings={use_fog:!1,intensity:0,depth:25,start:0,height:0,falloff:"QUADRATIC",use_custom_color:!0,color:[.5,.5,.5]},"b4w_fog_color"in g&&(g.fog_settings.use_custom_color=!0,g.fog_settings.color=g.b4w_fog_color),"b4w_fog_density"in g&&0<g.b4w_fog_density&&(g.fog_settings.depth=1/g.b4w_fog_density));"render_sky"in g.b4w_sky_settings||(b("world",g,"render_sky"),g.b4w_sky_settings.render_sky=!1);for(var p=g.texture_slots,z=0;z<p.length;z++){var l=
p[z];"blend_type"in l||(l.blend_type="MIX",b("world_texture_slot",l,"blend_type"));"use_map_blend"in l||(l.use_map_blend=!1,b("world_texture_slot",l,"use_map_blend"));"use_map_horizon"in l||(l.use_map_horizon=!0,b("world_texture_slot",l,"use_map_horizon"));"use_map_zenith_up"in l||(l.use_map_zenith_up=!1,b("world_texture_slot",l,"use_map_zenith_up"));"use_rgb_to_intensity"in l||(l.use_rgb_to_intensity=!1,b("world_texture_slot",l,"use_rgb_to_intensity"));"invert"in l||(l.invert=!1,b("world_texture_slot",
l,"invert"));"color"in l||(l.color=[1,0,1],b("world_texture_slot",l,"color"));"blend_factor"in l||(l.blend_factor=0,b("world_texture_slot",l,"blend_factor"));"horizon_factor"in l||(l.horizon_factor=1,b("world_texture_slot",l,"horizon_factor"));"zenith_up_factor"in l||(l.zenith_up_factor=0,b("world_texture_slot",l,"zenith_up_factor"));"zenith_down_factor"in l||(l.zenith_down_factor=0,b("world_texture_slot",l,"zenith_down_factor"));"default_value"in l||(l.default_value=1,b("world_texture_slot",l,"default_value"))}"b4w_use_default_animation"in
g||(b("world",g,"b4w_use_default_animation"),g.b4w_use_default_animation=!1);"b4w_anim_behavior"in g||(b("world",g,"b4w_anim_behavior"),g.b4w_anim_behavior="CYCLIC")}z=a.scenes;for(m=0;m<z.length;m++)p=z[m],l=p.world,"timeline_markers"in p||(p.timeline_markers=null,b("scene",p,"timeline_markers")),"b4w_reflection_quality"in p||(p.b4w_reflection_quality="MEDIUM",b("scene",p,"b4w_reflection_quality")),"b4w_use_nla"in p||(p.b4w_use_nla=!1,b("scene",p,"b4w_use_nla")),"fps"in p||(p.fps=24,b("scene",p,
"fps")),"b4w_nla_cyclic"in p||(p.b4w_nla_cyclic=!1,b("scene",p,"b4w_nla_cyclic")),"b4w_logic_nodes"in p||(p.b4w_logic_nodes=[],b("scene",p,"b4w_logic_nodes")),"b4w_detect_collisions"in p&&(n("scene",p,"b4w_detect_collisions"),delete p.b4w_detect_collisions),"audio_doppler_speed"in p||(p.audio_doppler_speed=343.3),"audio_doppler_factor"in p||(p.audio_doppler_factor=1),"b4w_dynamic_compressor_settings"in p||(p.b4w_dynamic_compressor_settings={threshold:-24,knee:30,ratio:12,attack:.003,release:.25},
b("scene",p,"b4w_dynamic_compressor_settings")),"b4w_enable_convolution_engine"in p||(p.b4w_enable_convolution_engine=!1),"b4w_enable_bloom"in p||(p.b4w_enable_bloom=!1,b("scene",p,"b4w_enable_bloom")),"b4w_enable_motion_blur"in p||(p.b4w_enable_motion_blur=!1,b("scene",p,"b4w_enable_motion_blur")),"b4w_enable_color_correction"in p||(p.b4w_enable_color_correction=!1,b("scene",p,"b4w_enable_color_correction")),"b4w_antialiasing_quality"in p||(p.b4w_antialiasing_quality="MEDIUM",b("scene",p,"b4w_antialiasing_quality")),
"b4w_tags"in p||(p.b4w_tags={title:"",description:""},b("scene",p,"b4w_tags")),"b4w_enable_object_selection"in p||(p.b4w_enable_object_selection="AUTO",b("scene",p,"b4w_enable_object_selection")),"b4w_enable_outlining"in p||(p.b4w_enable_outlining="AUTO",b("scene",p,"b4w_enable_outlining")),"b4w_enable_glow_materials"in p||(p.b4w_enable_glow_materials="AUTO",b("scene",p,"b4w_enable_glow_materials")),"b4w_enable_anchors_visibility"in p||(p.b4w_enable_anchors_visibility="AUTO",b("scene",p,"b4w_enable_anchors_visibility")),
"b4w_outline_color"in p||(p.b4w_outline_color=[1,1,1],b("scene",p,"b4w_outline_color")),"b4w_outline_factor"in p||(p.b4w_outline_factor="b4w_glow_factor"in p?p.b4w_glow_factor:1,b("scene",p,"b4w_outline_factor")),"b4w_shadow_settings"in p||(b("scene",p,"b4w_shadow_settings"),d=l.b4w_shadow_settings,p.b4w_shadow_settings=d?d:{csm_resolution:2048,blur_samples:"16x",self_shadow_polygon_offset:1,b4w_enable_csm:!1,csm_num:1,csm_first_cascade_border:10,first_cascade_blur_radius:3,csm_last_cascade_border:100,
last_cascade_blur_radius:1.5,fade_last_cascade:!0,blend_between_cascades:!0}),d=p.b4w_shadow_settings,"csm_resolution"in d||(b("scene",p,"b4w_shadow_settings.csm_resolution"),d.csm_resolution=2048),"blur_samples"in d||(b("scene",p,"b4w_shadow_settings.blur_samples"),d.blur_samples="16x"),"soft_shadows"in d||(b("scene",p,"b4w_shadow_settings.soft_shadows"),d.soft_shadows=!0),"self_shadow_polygon_offset"in d||(b("scene",p,"b4w_shadow_settings.self_shadow_polygon_offset"),d.self_shadow_polygon_offset=
1),"self_shadow_normal_offset"in d||(b("scene",p,"b4w_shadow_settings.self_shadow_normal_offset"),d.self_shadow_normal_offset=.01),"b4w_enable_csm"in d||(b("scene",p,"b4w_shadow_settings.b4w_enable_csm"),d.b4w_enable_csm=!1),"csm_num"in d||(b("scene",p,"b4w_shadow_settings.csm_num"),d.csm_num=1),"csm_first_cascade_border"in d||(b("scene",p,"b4w_shadow_settings.csm_first_cascade_border"),d.csm_first_cascade_border=10),"first_cascade_blur_radius"in d||(b("scene",p,"b4w_shadow_settings.first_cascade_blur_radius"),
d.first_cascade_blur_radius=3),"csm_last_cascade_border"in d||(b("scene",p,"b4w_shadow_settings.csm_last_cascade_border"),d.csm_last_cascade_border=100),"last_cascade_blur_radius"in d||(b("scene",p,"b4w_shadow_settings.last_cascade_blur_radius"),d.last_cascade_blur_radius=1.5),"fade_last_cascade"in d||(b("scene",p,"b4w_shadow_settings.fade_last_cascade"),d.fade_last_cascade=!0),"blend_between_cascades"in d||(b("scene",p,"b4w_shadow_settings.blend_between_cascades"),d.blend_between_cascades=!0),"b4w_ssao_settings"in
p||(b("scene",p,"b4w_ssao_settings"),d=l.b4w_ssao_settings,p.b4w_ssao_settings=d?d:{dist_factor:0,samples:16,hemisphere:!1,blur_depth:!1,blur_discard_value:1}),d=p.b4w_ssao_settings,"dist_factor"in d||(b("scene",p,"b4w_ssao_settings.dist_factor"),d.dist_factor=0),"samples"in d||(b("scene",p,"b4w_ssao_settings.samples"),d.samples=16),"hemisphere"in d||(b("scene",p,"b4w_ssao_settings.hemisphere"),d.hemisphere=!1),"blur_depth"in d||(b("scene",p,"b4w_ssao_settings.blur_depth"),d.blur_depth=!1),"blur_discard_value"in
d||(b("scene",p,"b4w_ssao_settings.blur_discard_value"),d.blur_discard_value=1),"b4w_bloom_settings"in p||(b("scene",p,"b4w_bloom_settings"),d=l.b4w_bloom_settings,p.b4w_bloom_settings=d?d:{key:.2,blur:4,edge_lum:1}),"key"in p.b4w_bloom_settings||(b("scene",p,"b4w_bloom_settings.key"),p.b4w_bloom_settings.key=.2),"blur"in p.b4w_bloom_settings||(b("scene",p,"b4w_bloom_settings.blur"),p.b4w_bloom_settings.blur=4),"edge_lum"in p.b4w_bloom_settings||(b("scene",p,"b4w_bloom_settings.edge_lum"),p.b4w_bloom_settings.edge_lum=
1),"b4w_motion_blur_settings"in p||(b("scene",p,"b4w_motion_blur_settings"),d=l.b4w_motion_blur_settings,p.b4w_motion_blur_settings=d?d:{motion_blur_factor:.01,motion_blur_decay_threshold:.01}),"motion_blur_factor"in p.b4w_motion_blur_settings||(b("scene",p,"b4w_motion_blur_settings.motion_blur_factor"),p.b4w_motion_blur_settings.motion_blur_factor=.01),"motion_blur_decay_threshold"in p.b4w_motion_blur_settings||(b("scene",p,"b4w_motion_blur_settings.motion_blur_decay_threshold"),p.b4w_motion_blur_settings.motion_blur_decay_threshold=
.01),"b4w_color_correction_settings"in p||(b("scene",p,"b4w_color_correction_settings"),d=l.b4w_color_correction_settings,p.b4w_color_correction_settings=d?d:{brightness:0,contrast:0,exposure:1,saturation:1}),"b4w_god_rays_settings"in p||(b("scene",p,"b4w_god_rays_settings"),d=l.b4w_god_rays_settings,p.b4w_god_rays_settings=d?d:{intensity:.7,max_ray_length:1,steps_per_pass:10}),"steps_per_pass"in p.b4w_god_rays_settings||(b("scene",p,"b4w_god_rays_settings.steps_per_pass"),p.b4w_god_rays_settings.steps_per_pass=
10),"b4w_glow_settings"in p||(b("scene",p,"b4w_glow_settings"),p.b4w_glow_settings={render_glow_over_blend:!1,small_glow_mask_coeff:2,large_glow_mask_coeff:2,small_glow_mask_width:2,large_glow_mask_width:6},d=p.b4w_glow_settings,"b4w_render_glow_over_blend"in l&&(d.render_glow_over_blend=l.b4w_render_glow_over_blend),"b4w_small_glow_mask_coeff"in l&&(d.small_glow_mask_coeff=l.b4w_small_glow_mask_coeff),"b4w_large_glow_mask_coeff"in l&&(d.large_glow_mask_coeff=l.b4w_large_glow_mask_coeff),"b4w_small_glow_mask_width"in
l&&(d.small_glow_mask_width=l.b4w_small_glow_mask_width),"b4w_large_glow_mask_width"in l&&(d.large_glow_mask_width=l.b4w_large_glow_mask_width)),l=p.b4w_render_shadows,"AUTO"!=l&&"OFF"!=l&&"ON"!=l&&(p.b4w_render_shadows=l?"ON":"OFF"),l=p.b4w_render_reflections,"OFF"!=l&&"ON"!=l&&(p.b4w_render_reflections=l?"ON":"OFF"),l=p.b4w_render_refractions,"AUTO"!=l&&"OFF"!=l&&"ON"!=l&&(p.b4w_render_refractions=l?"ON":"OFF"),"b4w_render_dynamic_grass"in p||(b("scene",p,"b4w_render_dynamic_grass"),p.b4w_render_dynamic_grass=
"AUTO"),p.b4w_nla_script&&n("scene",p,"b4w_nla_script"),"audio_distance_model"in p||(b("scene",p,"audio_distance_model"),p.audio_distance_model="INVERSE_CLAMPED");p=a.meshes;for(m=0;m<p.length;m++){l=p[m];l.b4w_bounding_box||(b("mesh",l,"b4w_bounding_box"),l.b4w_bounding_box={max_x:0,max_y:0,max_z:0,min_x:0,min_y:0,min_z:0});l.b4w_bounding_box_source||(b("mesh",l,"b4w_bounding_box_source"),l.b4w_bounding_box_source=l.b4w_bounding_box);l.uv_textures||(b("mesh",l,"uv_textures"),l.uv_textures=[]);l.b4w_bounding_sphere_center||
(l.b4w_bounding_sphere_center=[0,0,0]);l.b4w_bounding_cylinder_center||(l.b4w_bounding_cylinder_center=[0,0,0]);l.b4w_bounding_ellipsoid_center||(l.b4w_bounding_ellipsoid_center=[0,0,0]);l.b4w_bounding_ellipsoid_axes||(z=l.b4w_bounding_box,l.b4w_bounding_ellipsoid_axes=[(z.max_x-z.min_x)/2,(z.max_y-z.min_y)/2,(z.max_z-z.min_z)/2]);"b4w_shape_keys"in l||(l.b4w_shape_keys=[],b("mesh",l,"b4w_shape_keys"));z=!0;for(d=0;d<l.submeshes.length;d++)g=l.submeshes[d],"boundings"in g||(z=!1,g.boundings={bounding_ellipsoid_axes:l.b4w_bounding_ellipsoid_axes,
bounding_ellipsoid_center:l.b4w_bounding_ellipsoid_center,bounding_box:{max_x:l.b4w_bounding_box.max_x,max_y:l.b4w_bounding_box.max_y,max_z:l.b4w_bounding_box.max_z,min_x:l.b4w_bounding_box.min_x,min_y:l.b4w_bounding_box.min_y,min_z:l.b4w_bounding_box.min_z}});z||b("mesh",l,"submesh_bd");for(var z=l,d=["b4w_apply_scale","b4w_apply_modifiers","b4w_export_edited_normals","b4w_loc_export_vertex_anim","b4w_shape_keys"],g=null,r=0;r<d.length;r++)z[d[r]]&&(g?(z[d[r]]=!1,x.warn('WARNING property "'+d[r]+
'" of object "'+z.name+'" has been set to "false". Foreground property "'+g+'" already exists.')):g=d[r]);for(z=0;z<l.b4w_vertex_anim.length;z++)d=l.b4w_vertex_anim[z],"allow_nla"in d||(b('mesh["b4w_vertex_anim"]',l,"allow_nla"),d.allow_nla=!0)}z=a.cameras;for(m=0;m<z.length;m++)p=z[m],p.type||(p.type="PERSP",b("camera",p,"type")),"b4w_eye_target_dist"in p&&(delete p.b4w_eye_target_dist,n("camera",p,"b4w_eye_target_dist")),"b4w_hover_zero_level"in p||(p.b4w_hover_zero_level=0,b("camera",p,"b4w_hover_zero_level")),
"b4w_trans_velocity"in p||(p.b4w_trans_velocity=1,b("camera",p,"b4w_trans_velocity")),"b4w_rot_velocity"in p||(p.b4w_rot_velocity=1,b("camera",p,"b4w_rot_velocity")),"b4w_zoom_velocity"in p||(p.b4w_zoom_velocity=.1,b("camera",p,"b4w_zoom_velocity")),"b4w_use_target_distance_limits"in p||(p.b4w_use_target_distance_limits=p.b4w_use_distance_limits||!1,b("camera",p,"b4w_use_target_distance_limits")),"b4w_use_zooming"in p||(p.b4w_use_zooming=p.b4w_use_distance_limits||!1,b("camera",p,"b4w_use_zooming")),
"b4w_distance_min"in p||(p.b4w_distance_min=1,b("camera",p,"b4w_distance_min")),"b4w_distance_max"in p||(p.b4w_distance_max=100,b("camera",p,"b4w_distance_max")),"b4w_horizontal_translation_min"in p||(p.b4w_horizontal_translation_min=-100,b("camera",p,"b4w_horizontal_translation_min")),"b4w_horizontal_translation_max"in p||(p.b4w_horizontal_translation_max=100,b("camera",p,"b4w_horizontal_translation_max")),"b4w_vertical_translation_min"in p||(p.b4w_vertical_translation_min=-100,b("camera",p,"b4w_vertical_translation_min")),
"b4w_vertical_translation_max"in p||(p.b4w_vertical_translation_max=100,b("camera",p,"b4w_vertical_translation_max")),"b4w_use_horizontal_clamping"in p||(p.b4w_use_horizontal_clamping=!1,b("camera",p,"b4w_use_horizontal_clamping")),"b4w_rotation_left_limit"in p||(p.b4w_rotation_left_limit=-Math.PI,b("camera",p,"b4w_rotation_left_limit")),"b4w_rotation_right_limit"in p||(p.b4w_rotation_right_limit=Math.PI,b("camera",p,"b4w_rotation_right_limit")),"b4w_horizontal_clamping_type"in p||(p.b4w_horizontal_clamping_type=
"LOCAL",b("camera",p,"b4w_horizontal_clamping_type")),"b4w_use_vertical_clamping"in p||(p.b4w_use_vertical_clamping=!1,b("camera",p,"b4w_use_vertical_clamping")),"b4w_rotation_down_limit"in p||(p.b4w_rotation_down_limit=-Math.PI/2,b("camera",p,"b4w_rotation_down_limit")),"b4w_rotation_up_limit"in p||(p.b4w_rotation_up_limit=Math.PI/2,b("camera",p,"b4w_rotation_up_limit")),"b4w_vertical_clamping_type"in p||(p.b4w_vertical_clamping_type="LOCAL",b("camera",p,"b4w_vertical_clamping_type")),"b4w_hover_angle_min"in
p||(p.b4w_hover_angle_min=Math.PI/6,b("camera",p,"b4w_hover_angle_min")),"b4w_hover_angle_max"in p||(p.b4w_hover_angle_max=Math.PI/6,b("camera",p,"b4w_hover_angle_max")),"b4w_enable_hover_hor_rotation"in p||(p.b4w_enable_hover_hor_rotation=!0,b("camera",p,"b4w_enable_hover_hor_rotation")),"b4w_use_panning"in p||(p.b4w_use_panning=!0,b("camera",p,"b4w_use_panning")),"b4w_use_pivot_limits"in p||(p.b4w_use_pivot_limits=!1,p.b4w_pivot_z_min=0,p.b4w_pivot_z_max=10,b("camera",p,"b4w_use_pivot_limits")),
"b4w_dof_bokeh"in p||(p.b4w_dof_bokeh=!1,b("camera",p,"b4w_dof_bokeh")),"b4w_dof_bokeh_intensity"in p||(p.b4w_dof_bokeh_intensity=.3,b("camera",p,"b4w_dof_bokeh_intensity")),"b4w_dof_foreground_blur"in p||(p.b4w_dof_foreground_blur=!1,b("camera",p,"b4w_dof_foreground_blur")),"b4w_dof_front_start"in p||(p.b4w_dof_front_start=0,b("camera",p,"b4w_dof_front_start")),"b4w_dof_front_end"in p||(p.b4w_dof_front_end=p.b4w_dof_front,b("camera",p,"b4w_dof_front_end")),"b4w_dof_rear_start"in p||(p.b4w_dof_rear_start=
0,b("camera",p,"b4w_dof_rear_start")),"b4w_dof_rear_end"in p||(p.b4w_dof_rear_end=p.b4w_dof_rear,b("camera",p,"b4w_dof_rear_end"));z=a.lamps;for(m=0;m<z.length;m++)p=z[m],"b4w_generate_shadows"in p||(p.b4w_generate_shadows=!1,b("lamp",p,"b4w_generate_shadows")),"b4w_dynamic_intensity"in p||(p.b4w_dynamic_intensity=!1,b("lamp",p,"b4w_dynamic_intensity")),"use_diffuse"in p||(p.use_diffuse=!0,b("lamp",p,"use_diffuse")),"use_specular"in p||(p.use_specular=!0,b("lamp",p,"use_specular")),"clip_start"in
p||(p.clip_start=.1,b("lamp",p,"clip_start")),"clip_end"in p||(p.clip_end=30,b("lamp",p,"clip_end"));z=a.speakers;for(m=0;m<z.length;m++)p=z[m],"b4w_behavior"in p||(p.b4w_behavior=p.b4w_background_music?"BACKGROUND_SOUND":"POSITIONAL"),"b4w_auto_play"in p||(p.b4w_auto_play=!1,b("speaker",p,"b4w_auto_play")),"b4w_enable_doppler"in p||(p.b4w_enable_doppler=!1,b("speaker",p,"b4w_enable_doppler")),"b4w_delay"in p||(p.b4w_delay=0),"b4w_delay_random"in p||(p.b4w_delay_random=0),"b4w_volume_random"in p||
(p.b4w_volume_random=0),"b4w_pitch_random"in p||(p.b4w_pitch_random=0),"b4w_fade_in"in p||(p.b4w_fade_in=0),"b4w_fade_out"in p||(p.b4w_fade_out=0),"b4w_loop"in p||(p.b4w_loop=!1),"b4w_loop_start"in p||(p.b4w_loop_start=0,b("speaker",p,"b4w_loop_start")),"b4w_loop_end"in p||(p.b4w_loop_end=0,b("speaker",p,"b4w_loop_end")),p.animation_data&&c(p.animation_data);z=a.textures;for(m=0;m<z.length;m++)p=z[m],"b4w_anisotropic_filtering"in p||(p.b4w_anisotropic_filtering="OFF",b("texture",p,"b4w_anisotropic_filtering")),
"b4w_water_foam"in p||(p.b4w_water_foam=!1,b("texture",p,"b4w_water_foam")),"b4w_foam_uv_freq"in p||(p.b4w_foam_uv_freq=[1,1],b("texture",p,"b4w_foam_uv_freq")),"b4w_foam_uv_magnitude"in p||(p.b4w_foam_uv_magnitude=[1,1],b("texture",p,"b4w_foam_uv_magnitude")),"b4w_parallax_steps"in p||(p.b4w_parallax_steps=5,b("material",p,"b4w_parallax_steps")),"b4w_parallax_lod_dist"in p||(p.b4w_parallax_lod_dist=10,b("material",p,"b4w_parallax_lod_dist")),"b4w_shore_dist_map"in p||(p.b4w_shore_dist_map=!1,b("texture",
p,"b4w_shore_dist_map")),"b4w_shore_boundings"in p||(p.b4w_shore_boundings=[1E3,-1E3,1E3,-1E3],b("texture",p,"b4w_shore_boundings")),"b4w_max_shore_dist"in p||(p.b4w_max_shore_dist=100,b("texture",p,"b4w_max_shore_dist")),"b4w_disable_compression"in p||(p.b4w_disable_compression=!1,b("texture",p,"b4w_disable_compression")),"b4w_source_type"in p||(p.b4w_source_type="",b("texture",p,"b4w_source_type")),"b4w_source_id"in p||(p.b4w_source_id="",b("texture",p,"b4w_source_id")),"b4w_source_size"in p||(p.b4w_source_size=
1024,b("texture",p,"b4w_source_size")),"b4w_enable_canvas_mipmapping"in p||(p.b4w_enable_canvas_mipmapping=!0,b("texture",p,"b4w_enable_canvas_mipmapping")),"b4w_nla_video"in p||(p.b4w_nla_video=!1,b("texture",p,"b4w_nla_video"));z=a.images;for(m=0;m<z.length;m++)p=z[m],"colorspace_settings_name"in p||(p.colorspace_settings_name="sRGB",b("image",p,"colorspace_settings_name"));d=a.materials;for(m=0;m<d.length;m++){g=d[m];"ALPHA_ANTIALIASING"==g.game_settings.alpha_blend&&(g.game_settings.alpha_blend=
"CLIP");"use_tangent_shading"in g||(g.use_tangent_shading=!1,b("material",g,"use_tangent_shading"));"b4w_node_mat_type"in g&&n("material",g,"b4w_node_mat_type");"b4w_skydome"in g&&n("material",g,"b4w_skydome");"b4w_procedural_skydome"in g&&n("material",g,"b4w_procedural_skydome");"b4w_lens_flares"in g||(g.b4w_lens_flares=!1,b("material",g,"b4w_lens_flares"));"LENS_FLARES"===g.name&&(g.b4w_lens_flares||x.warn('"LENS_FLARES" material name has been found. Enable the "Lens Flare" property for this material.'),
g.b4w_lens_flares=!0);g.b4w_water&&("b4w_water_shore_smoothing"in g||(g.b4w_water_shore_smoothing=!1,b("material",g,"b4w_water_shore_smoothing")),"b4w_water_dynamic"in g||(g.b4w_water_dynamic=!1,b("material",g,"b4w_water_dynamic")),"b4w_waves_height"in g||(g.b4w_waves_height=1,b("material",g,"b4w_waves_height")),"b4w_waves_length"in g||(g.b4w_waves_length=1,b("material",g,"b4w_waves_length")),"b4w_water_dst_noise_scale0"in g||(g.b4w_water_dst_noise_scale0=.05,b("material",g,"b4w_water_dst_noise_scale0")),
"b4w_water_dst_noise_scale1"in g||(g.b4w_water_dst_noise_scale1=.03,b("material",g,"b4w_water_dst_noise_scale1")),"b4w_water_dst_noise_freq0"in g||(g.b4w_water_dst_noise_freq0=1.3,b("material",g,"b4w_water_dst_noise_freq0")),"b4w_water_dst_noise_freq1"in g||(g.b4w_water_dst_noise_freq1=1,b("material",g,"b4w_water_dst_noise_freq1")),"b4w_water_dir_min_shore_fac"in g||(g.b4w_water_dir_min_shore_fac=.4,b("material",g,"b4w_water_dir_min_shore_fac")),"b4w_water_dir_freq"in g||(g.b4w_water_dir_freq=.5,
b("material",g,"b4w_water_dir_freq")),"b4w_water_dir_noise_scale"in g||(g.b4w_water_dir_noise_scale=.05,b("material",g,"b4w_water_dir_noise_scale")),"b4w_water_dir_noise_freq"in g||(g.b4w_water_dir_noise_freq=.07,b("material",g,"b4w_water_dir_noise_freq")),"b4w_water_dir_min_noise_fac"in g||(g.b4w_water_dir_min_noise_fac=.5,b("material",g,"b4w_water_dir_min_noise_fac")),"b4w_water_dst_min_fac"in g||(g.b4w_water_dst_min_fac=.2,b("material",g,"b4w_water_dst_min_fac")),"b4w_water_waves_hor_fac"in g||
(g.b4w_water_waves_hor_fac=5,b("material",g,"b4w_water_waves_hor_fac")),"b4w_water_absorb_factor"in g||(g.b4w_water_absorb_factor=6,b("material",g,"b4w_water_absorb_factor")),"b4w_water_fog_color"in g||(g.b4w_water_fog_color=[.5,.7,.7],b("material",g,"b4w_water_fog_color")),"b4w_foam_factor"in g||(g.b4w_foam_factor=5,b("material",g,"b4w_foam_factor")),"b4w_generated_mesh"in g||(g.b4w_generated_mesh=!1,b("material",g,"b4w_generated_mesh")),"b4w_water_num_cascads"in g||(g.b4w_water_num_cascads=5,b("material",
g,"b4w_water_num_cascads")),"b4w_water_subdivs"in g||(g.b4w_water_subdivs=64,b("material",g,"b4w_water_subdivs")),"b4w_water_detailed_dist"in g||(g.b4w_water_detailed_dist=1E3,b("material",g,"b4w_water_detailed_dist")),"b4w_water_enable_caust"in g||(g.b4w_water_enable_caust=!1,b("material",g,"b4w_water_enable_caust")),"b4w_water_caust_scale"in g||(g.b4w_water_caust_scale=.25,b("material",g,"b4w_water_caust_scale")),"b4w_water_caust_brightness"in g||(g.b4w_water_caust_brightness=.5,b("material",g,
"b4w_water_caust_brightness")));"b4w_dynamic_grass_size"in g||(g.b4w_dynamic_grass_size="");"b4w_dynamic_grass_color"in g||(g.b4w_dynamic_grass_color="");"diffuse_intensity"in g||(g.diffuse_intensity=1,b("material",g,"diffuse_intensity"));"b4w_use_ghost"in g||(g.b4w_use_ghost=!1);"b4w_collision_margin"in g||(g.b4w_collision_margin=.04,b("material",g,"b4w_collision_margin"));"b4w_collision_group"in g||(g.b4w_collision_group=128,b("material",g,"b4w_collision_group"));"b4w_collision_mask"in g||(g.b4w_collision_mask=
127,b("material",g,"b4w_collision_mask"));"b4w_do_not_render"in g||(g.b4w_do_not_render=!1,b("material",g,"b4w_do_not_render"));"HALO"!=g.type||"b4w_halo_sky_stars"in g||(g.b4w_halo_sky_stars=!1,b("material",g,"b4w_halo_sky_stars"));"HALO"!=g.type||"b4w_halo_stars_blend_height"in g||(g.b4w_halo_stars_blend_height=10,b("material",g,"b4w_halo_stars_blend_height"));"HALO"!=g.type||"b4w_halo_stars_min_height"in g||(g.b4w_halo_stars_min_height=0,b("material",g,"b4w_halo_stars_min_height"));"specular_shader"in
g||(g.specular_shader="COOKTORR",b("material",g,"specular_shader"));"diffuse_shader"in g||(g.diffuse_shader="LAMBERT",b("material",g,"diffuse_shader"));"roughness"in g||(g.roughness=.5,b("material",g,"roughness"));"diffuse_fresnel"in g||(g.diffuse_fresnel=.1,b("material",g,"diffuse_fresnel"));"diffuse_fresnel_factor"in g||(g.diffuse_fresnel_factor=.5,b("material",g,"diffuse_fresnel_factor"));"specular_slope"in g||(g.specular_slope=.2,b("material",g,"specular_slope"));"specular_toon_size"in g||(g.specular_toon_size=
.5,b("material",g,"specular_toon_size"));"specular_toon_smooth"in g||(g.specular_toon_smooth=.1,b("material",g,"specular_toon_smooth"));"specular_alpha"in g||(g.specular_alpha=1,b("material",g,"specular_alpha"));"b4w_wettable"in g||(g.b4w_wettable=!1,b("material",g,"b4w_wettable"));"b4w_refractive"in g||(g.b4w_refractive=!1,b("material",g,"b4w_refractive"));"b4w_refr_bump"in g||(g.b4w_refr_bump=0,b("material",g,"b4w_refr_bump"));"b4w_shallow_water_col"in g||(g.b4w_shallow_water_col=[0,.8,.3],b("material",
g,"b4w_shallow_water_col"));"b4w_shore_water_col"in g||(g.b4w_shore_water_col=[0,.9,.2],b("material",g,"b4w_shore_water_col"));"b4w_shallow_water_col_fac"in g||(g.b4w_shallow_water_col_fac=1,b("material",g,"b4w_shallow_water_col_fac"));"b4w_shore_water_col_fac"in g||(g.b4w_shore_water_col_fac=.5,b("material",g,"b4w_shore_water_col_fac"));"b4w_water_sss_strength"in g||(g.b4w_water_sss_strength=5.9,b("material",g,"b4w_water_sss_strength"));"b4w_water_sss_width"in g||(g.b4w_water_sss_width=.45,b("material",
g,"b4w_water_sss_width"));"b4w_render_above_all"in g||(g.b4w_render_above_all=!1,b("material",g,"b4w_render_above_all"));"b4w_water_norm_uv_velocity"in g||(g.b4w_water_norm_uv_velocity=.05,b("material",g,"b4w_water_norm_uv_velocity"));"specular_ior"in g||(g.specular_ior=1,b("material",g,"specular_ior"));"darkness"in g||(g.darkness=0,b("material",g,"darkness"));"diffuse_toon_size"in g||(g.diffuse_toon_size=0,b("material",g,"diffuse_toon_size"));"diffuse_toon_smooth"in g||(g.diffuse_toon_smooth=0,b("material",
g,"diffuse_toon_smooth"));p=g.texture_slots;for(z=0;z<p.length;z++)l=p[z],"blend_type"in l||(l.blend_type="MIX",b("texture_slot",l,"blend_type"));if(g.node_tree){p=g.node_tree.nodes;for(z=0;z<p.length;z++)e(p[z]);g.node_tree.animation_data&&c(g.node_tree.animation_data)}}l=a.node_groups;for(m=0;m<l.length;m++)for(p=l[m].node_tree.nodes,z=0;z<p.length;z++)e(p[z]);p=a.objects;for(m=0;m<p.length;m++){l=p[m];switch(l.type){case "MESH":"b4w_dynamic_geometry"in l||(l.b4w_dynamic_geometry=!1);"b4w_reflexible"in
l||(l.b4w_reflexible=!1);"b4w_reflexible_only"in l||(l.b4w_reflexible_only=!1);"b4w_reflective"in l||(l.b4w_reflective=!1);"b4w_reflection_type"in l||(l.b4w_reflection_type="PLANE",b("object",l,"b4w_reflection_type"));"b4w_wind_bending"in l||(l.b4w_wind_bending=!1,b("object",l,"b4w_wind_bending"));"b4w_wind_bending_angle"in l||(l.b4w_wind_bending_angle=10,l.b4w_wind_bending_freq=.25,b("object",l,"wind bending params"));"b4w_detail_bending_amp"in l||(l.b4w_detail_bending_amp=.1,l.b4w_branch_bending_amp=
.3,b("object",l,"detail bending params"));"b4w_detail_bending_freq"in l||(l.b4w_detail_bending_freq=1,b("object",l,"b4w_detail_bending_freq"));"b4w_main_bend_stiffness_col"in l||(l.b4w_main_bend_stiffness_col="",b("object",l,"b4w_main_bend_stiffness_col"));"b4w_detail_bend_colors"in l||(l.b4w_detail_bend_colors={leaves_stiffness_col:"",leaves_phase_col:"",overall_stiffness_col:""},b("object",l,"b4w_detail_bend_colors"));"b4w_caustics"in l||(l.b4w_caustics=!1);"vertex_groups"in l&&l.vertex_groups.length&&
l.data&&0==l.data.vertex_groups.length&&(l.data.vertex_groups=l.vertex_groups,delete l.vertex_groups,b("object",l,"vertex_groups"));"b4w_vertex_anim"in l&&l.b4w_vertex_anim.length&&l.data&&0==l.data.b4w_vertex_anim.length&&(l.data.b4w_vertex_anim=l.b4w_vertex_anim,delete l.b4w_vertex_anim,b("object",l,"b4w_vertex_anim"));"b4w_do_not_render"in l||(l.b4w_do_not_render=!1);"b4w_hidden_on_load"in l||(l.b4w_hidden_on_load=!1);"use_ghost"in l.game||(l.game.use_ghost=!1);"use_sleep"in l.game||(l.game.use_sleep=
!1);"velocity_min"in l.game||(l.game.velocity_min=0);"velocity_max"in l.game||(l.game.velocity_max=0);"collision_group"in l.game||(l.game.collision_group=1);"collision_mask"in l.game||(l.game.collision_mask=255);z=l;d=z.game;g=d.collision_bounds_type;d.use_collision_bounds&&"BOX"!=g&&"CYLINDER"!=g&&"CONE"!=g&&"SPHERE"!=g&&"CAPSULE"!=g&&"EMPTY"!=g&&(x.error("Wrong collision bounds type "+g+". Disable physics for object "+z.name),z.b4w_collision=!1,z.b4w_floating=!1,z.b4w_vehicle=!1,z.b4w_character=
!1);"b4w_vehicle_settings"in l?l.b4w_vehicle_settings&&("steering_ratio"in l.b4w_vehicle_settings||(l.b4w_vehicle_settings.steering_ratio=10),"steering_max"in l.b4w_vehicle_settings||(l.b4w_vehicle_settings.steering_max=1),"inverse_control"in l.b4w_vehicle_settings||(l.b4w_vehicle_settings.inverse_control=!1),"force_max"in l.b4w_vehicle_settings||(l.b4w_vehicle_settings.force_max=1500),"brake_max"in l.b4w_vehicle_settings||(l.b4w_vehicle_settings.brake_max=100),"speed_ratio"in l.b4w_vehicle_settings||
(l.b4w_vehicle_settings.speed_ratio=.027),"max_speed_angle"in l.b4w_vehicle_settings||(l.b4w_vehicle_settings.max_speed_angle=Math.PI),"delta_tach_angle"in l.b4w_vehicle_settings||(l.b4w_vehicle_settings.delta_tach_angle=4.43),"suspension_compression"in l.b4w_vehicle_settings||(l.b4w_vehicle_settings.suspension_compression=4.4),"suspension_stiffness"in l.b4w_vehicle_settings||(l.b4w_vehicle_settings.suspension_stiffness=20),"suspension_damping"in l.b4w_vehicle_settings||(l.b4w_vehicle_settings.suspension_damping=
2.3),"wheel_friction"in l.b4w_vehicle_settings||(l.b4w_vehicle_settings.wheel_friction=1E3),"roll_influence"in l.b4w_vehicle_settings||(l.b4w_vehicle_settings.roll_influence=.1),"max_suspension_travel_cm"in l.b4w_vehicle_settings||(l.b4w_vehicle_settings.max_suspension_travel_cm=30),"floating_factor"in l.b4w_vehicle_settings||(l.b4w_vehicle_settings.floating_factor=3),"floating_factor"in l.b4w_vehicle_settings||(l.b4w_vehicle_settings.floating_factor=3),"water_lin_damp"in l.b4w_vehicle_settings||
(l.b4w_vehicle_settings.water_lin_damp=.9),"water_rot_damp"in l.b4w_vehicle_settings||(l.b4w_vehicle_settings.water_rot_damp=.9)):(l.b4w_vehicle_settings=null,b("object",l,"b4w_vehicle_settings"));"b4w_floating_settings"in l?l.b4w_floating_settings&&("floating_factor"in l.b4w_floating_settings||(l.b4w_floating_settings.floating_factor=3),"water_lin_damp"in l.b4w_floating_settings||(l.b4w_floating_settings.water_lin_damp=.8),"water_rot_damp"in l.b4w_floating_settings||(l.b4w_floating_settings.water_rot_damp=
.8)):(l.b4w_floating_settings=null,b("object",l,"b4w_floating_settings"));"b4w_character_settings"in l?l.b4w_character_settings&&("walk_speed"in l.b4w_character_settings||(l.b4w_character_settings.walk_speed=4),"run_speed"in l.b4w_character_settings||(l.b4w_character_settings.run_speed=8),"step_height"in l.b4w_character_settings||(l.b4w_character_settings.step_height=.25),"jump_strength"in l.b4w_character_settings||(l.b4w_character_settings.jump_strength=5),"waterline"in l.b4w_character_settings||
(l.b4w_character_settings.waterline=0)):(l.b4w_character_settings=null,b("object",l,"b4w_character_settings"));"b4w_selectable"in l||(l.b4w_selectable=!1,b("object",l,"b4w_selectable"));"b4w_outlining"in l||(l.b4w_outlining=!1,b("object",l,"b4w_outlining"));"b4w_outline_on_select"in l||(l.b4w_outline_on_select=!1,b("object",l,"b4w_outline_on_select"));"b4w_billboard"in l||(l.b4w_billboard=!1,b("object",l,"b4w_billboard"));"b4w_billboard_geometry"in l||(l.b4w_billboard_geometry="SPHERICAL",b("object",
l,"b4w_billboard_geometry"));"b4w_pres_glob_orientation"in l||(l.b4w_pres_glob_orientation=!1,b("object",l,"b4w_pres_glob_orientation"));"b4w_outline_settings"in l||("b4w_glow_settings"in l?l.b4w_outline_settings=l.b4w_glow_settings:(l.b4w_outline_settings={},l.b4w_outline_settings.outline_duration=1,l.b4w_outline_settings.outline_period=1,l.b4w_outline_settings.outline_relapses=0),b("object",l,"b4w_outline_settings"));"b4w_lod_transition"in l||(l.b4w_lod_transition=.01,b("object",l,"b4w_lod_transition"));
"lod_levels"in l||(l.lod_levels=[],b("object",l,"lod_levels"));"b4w_animation_mixing"in l||(l.b4w_animation_mixing=!1,b("object",l,"b4w_animation_mixing"));break;case "EMPTY":"b4w_anchor"in l||(l.b4w_anchor=null,b("object",l,"b4w_anchor")),!l.b4w_anchor||"max_width"in l.b4w_anchor||(l.b4w_anchor.max_width=250)}"collision_margin"in l.game||(l.game.collision_margin=.04,b("object",l,"collision_margin"));"b4w_anim_behavior"in l||(l.b4w_anim_behavior=l.b4w_cyclic_animation?"CYCLIC":"FINISH_STOP",b("object",
l,"b4w_anim_behavior"));if(!("rotation_quaternion"in l)){z=[0,0,0,1];k.euler_to_quat(l.rotation_euler,z);var d=z,g=z[0],r=z[1],t=z[2];d[0]=z[3];d[1]=g;d[2]=r;d[3]=t;l.rotation_quaternion=z;b("object",l,"rotation_quaternion")}"webgl_do_not_batch"in l&&(l.b4w_do_not_batch=l.webgl_do_not_batch)&&n("object",l,"webgl_do_not_batch");"b4w_shadow_cast_only"in l||(l.b4w_shadow_cast_only=!1,b("object",l,"b4w_shadow_cast_only"));"b4w_correct_bounding_offset"in l||(l.b4w_correct_bounding_offset="AUTO",b("object",
l,"b4w_correct_bounding_offset"));d=l.particle_systems;for(z=0;z<d.length;z++)g=d[z],r=g.settings,"use_rotation_dupli"in r||(r.use_rotation_dupli=!1,b("particle_settings",r,"use_rotation_dupli")),"use_whole_group"in r||(r.use_whole_group=!1,b("particle_settings",r,"use_whole_group")),g.transforms||(g.transforms=new Float32Array,b("particle_system",g,"transforms")),"b4w_billboard_align"in r||(r.b4w_billboard_align="VIEW",b("particle_settings",r,"b4w_billboard_align")),"b4w_dynamic_grass"in r||(r.b4w_dynamic_grass=
!1,b("object",r,"b4w_dynamic_grass")),"b4w_dynamic_grass_scale_threshold"in r||(r.b4w_dynamic_grass_scale_threshold=.01,b("object",r,"b4w_dynamic_grass_scale_threshold")),"b4w_initial_rand_rotation"in r||(r.b4w_initial_rand_rotation=!1,b("particle_settings",r,"b4w_initial_rand_rotation")),"b4w_rotation_type"in r||(r.b4w_rotation_type="Z",b("particle_settings",r,"b4w_rotation_type")),"b4w_rand_rotation_strength"in r||(r.b4w_rand_rotation_strength=1,b("particle_settings",r,"b4w_rand_rotation_strength")),
"b4w_hair_billboard"in r||(r.b4w_hair_billboard=!1,b("particle_settings",r,"b4w_hair_billboard")),"b4w_hair_billboard_type"in r||(r.b4w_hair_billboard_type="BASIC",b("particle_settings",r,"b4w_hair_billboard_type")),"b4w_hair_billboard_jitter_amp"in r||(r.b4w_hair_billboard_jitter_amp=0,b("particle_settings",r,"b4w_hair_billboard_jitter_amp")),"b4w_hair_billboard_jitter_freq"in r||(r.b4w_hair_billboard_jitter_freq=0,b("particle_settings",r,"b4w_hair_billboard_jitter_freq")),"b4w_hair_billboard_geometry"in
r||(r.b4w_hair_billboard_geometry="SPHERICAL",b("particle_settings",r,"b4w_hair_billboard_geometry")),"b4w_wind_bend_inheritance"in r||(r.b4w_wind_bend_inheritance="PARENT",b("particle_settings",r,"b4w_wind_bend_inheritance")),"b4w_shadow_inheritance"in r||(r.b4w_shadow_inheritance="PARENT",b("particle_settings",r,"b4w_shadow_inheritance")),"b4w_reflection_inheritance"in r||(r.b4w_reflection_inheritance="PARENT",b("particle_settings",r,"b4w_reflection_inheritance")),"b4w_vcol_from_name"in r||(r.b4w_vcol_from_name=
"",b("particle_settings",r,"b4w_vcol_from_name")),"b4w_vcol_to_name"in r||(r.b4w_vcol_to_name="",b("particle_settings",r,"b4w_vcol_to_name")),"b4w_coordinate_system"in r||(r.b4w_coordinate_system="LOCAL",b("particle_settings",r,"b4w_coordinate_system")),"b4w_allow_nla"in r||(r.b4w_allow_nla=!0,b("particle_settings",r,"b4w_allow_nla")),"b4w_enable_soft_particles"in r||(r.b4w_enable_soft_particles=!1,b("particle_settings",r,"b4w_enable_soft_particles")),"b4w_particles_softness"in r||(r.b4w_particles_softness=
1,b("particle_settings",r,"b4w_particles_softness")),"billboard_tilt"in r||(r.billboard_tilt=0,b("particle_settings",r,"billboard_tilt")),"billboard_tilt_random"in r||(r.billboard_tilt_random=0,b("particle_settings",r,"billboard_tilt_random")),"use_rotations"in r||(r.use_rotations=!1,b("particle_settings",r,"use_rotations"));"constraints"in l||(l.constraints=[],b("object",l,"constraints"));d=l.modifiers;for(z=0;z<d.length;z++){a:{g=d[z];switch(g.type){case "ARRAY":if(!("fit_type"in g)){x.error("WARNING Incomplete modifier "+
String(g.type)+' for "'+l.name+'", reexport "'+a.b4w_filepath_blend+'" scene');g=!1;break a}}g=!0}g||(d.splice(z,1),z--)}"animation_data"in l||(l.animation_data={action:null,nla_tracks:[]},b("object",l,"animation_data"));l.animation_data&&("action"in l.animation_data||(l.animation_data.action=null,f("no action in animation data "+l.name)),"nla_tracks"in l.animation_data||(l.animation_data.nla_tracks=[],f("no NLA in animation data "+l.name)),c(l.animation_data));"b4w_collision_id"in l||(l.b4w_collision_id=
"",b("object",l,"b4w_collision_id"));"b4w_viewport_alignment"in l||(l.b4w_viewport_alignment=null,b("object",l,"b4w_viewport_alignment"));"pinverse_tsr"in l||(l.pinverse_tsr=null,b("object",l,"pinverse_tsr"));"b4w_cluster_data"in l||(l.b4w_cluster_data={cluster_id:-1},b("object",l,"b4w_cluster_data"));(0>l.scale[0]||0>l.scale[1]||0>l.scale[2])&&f('negative scale for object "'+l.name+'", can lead to some errors');z=l.scale;0==z[0]&&0==z[1]&&0==z[2]?z=!0:(d=Math.abs((z[1]-z[2])/z[1]),z=.005>Math.abs((z[0]-
z[1])/z[0])&&.005>d);z||f("non-uniform scale for object "+l.name)}for(var v in y)m=y[v],z=v.match(/.*?(?=>>|$)/i)[0],x.warn('Property "'+String(z)+'" is '+m.HB+' for "'+m.type+'". To fix this, reexport '+a.b4w_filepath_blend)};a.OG=function(a,b){"num_channels"in a||(a.num_channels=1,f('B4W Warning: no channels number in animation fcurve for "'+b.name+'" action, reexport scene'))};a.bG=function(a){var b;a:{b=a.modifiers;for(var c=0;c<b.length;c++){var e=b[c].type;if("ARRAY"==e||"CURVE"==e){b=!0;break a}}b=
!1}if(!b)return null;b=t(a.data,a.data.name+"_MOD");a=a.modifiers;for(c=0;c<a.length;c++){var f=a[c];switch(f.type){case "ARRAY":for(var e=b,n=f,l=0,x=0,q=0,y=new Float32Array(16),f=[],B=1;B<n.count;B++){n.use_constant_offset&&(l+=n.constant_offset_displace[0],x+=n.constant_offset_displace[1],q+=n.constant_offset_displace[2]);if(n.use_relative_offset)var J=e.b4w_bounding_box,l=l+(J.max_x-J.min_x)*n.relative_offset_displace[0],x=x+(J.max_y-J.min_y)*n.relative_offset_displace[1],q=q+(J.max_z-J.min_z)*
n.relative_offset_displace[2];k.ZN(l,x,q,y);for(var F=J=t(e),L=y,O=C.fromMat4(L,A),O=d.fromMat3(O,H),U=0;U<F.submeshes.length;U++){var D=F.submeshes[U];k.nm(D.position,L,D.position,0);k.WN(D.tbn_quat,O,D.tbn_quat)}f.push(J)}for(B=0;B<f.length;B++)for(n=e,l=f[B],x=0;x<n.submeshes.length;x++){q=n.submeshes[x];y=l.submeshes[x];J=q.base_length;F=q.indices.length;q.base_length+=y.base_length;for(var R in q)if("base_length"!=R&&"boundings"!=R)if("indices"==R)for(q[R]=k.eO(q[R],y[R]),L=F;L<q.indices.length;L++)q.indices[L]+=
J;else"vertex_colors"!=R&&(q[R]=k.lJ(q[R],y[R]))}break;case "CURVE":for(e=b,B=m.SH(f.object),n=new Float32Array(16),x=B.Ai?4:3,l=new Float32Array(x),x=new Float32Array(x),q=new Float32Array(3),y=new Float32Array(4),J=new Float32Array(4),F=new Float32Array(3),L=new Float32Array(3),O=new Float32Array(3),new Float32Array(4),new Float32Array(4),U=0;U<e.submeshes.length;U++){var ca=e.submeshes[U],D=ca.position,ca=ca.tbn_quat,Q;a:{Q=f.deform_axis;switch(Q){case "POS_X":case "NEG_X":Q=0;break a;case "POS_Y":case "NEG_Y":Q=
1;break a;case "POS_Z":case "NEG_Z":Q=2;break a;default:k.r("Wrong deform axis value "+Q)}Q=void 0}F[0]=0;F[1]=0;F[2]=0;F[Q]=1;for(var ta=m.JN(B),K=0;K<D.length/3;K++){O[0]=D[3*K];O[1]=D[3*K+1];O[2]=D[3*K+2];var N=O[Q],ha=m.IN(B,N);m.KN(B,ha,l);q[0]=l[0];q[1]=l[1];q[2]=l[2];m.HN(B,ha,x);L[0]=x[0];L[1]=0;L[2]=x[2];r.normalize(L,L);d.rotationTo(F,L,y);0>N?(l[0]=L[0],l[1]=L[1],l[2]=L[2],r.scale(l,N,l),r.add(q,l,q)):N>ta&&(l[0]=L[0],l[1]=L[1],l[2]=L[2],r.scale(l,N-ta,l),r.add(q,l,q));v.fromRotationTranslation(y,
q,n);B.Ai&&(d.setAxisAngle(F,l[3],J),r.transformQuat(O,J,O));O[Q]=0;r.transformMat4(O,n,O);D[3*K]=O[0];D[3*K+1]=O[1];D[3*K+2]=O[2];ca.length&&(H[0]=ca[4*K],H[1]=ca[4*K+1],H[2]=ca[4*K+2],H[3]=ca[4*K+3],d.multiply(H,y,H),ca[4*K]=H[0],ca[4*K+1]=H[1],ca[4*K+2]=H[2],ca[4*K+3]=H[3])}}}g.dM(b)}return b};a.GH=function(){return{name:"DEFAULT",uuid:k.Fu(),use_nodes:!1,diffuse_shader:"LAMBERT",diffuse_color:[.8,.8,.8],diffuse_intensity:.8,alpha:1,raytrace_transparency:{fresnel:0,fresnel_factor:1.25},raytrace_mirror:{reflect_factor:0,
fresnel:0,fresnel_factor:1.25},specular_alpha:1,specular_color:[1,1,1],specular_intensity:.5,specular_shader:"COOKTORR",specular_hardness:50,specular_slope:.2,emit:0,ambient:1,use_vertex_color_paint:!1,b4w_water:!1,b4w_water_shore_smoothing:!1,b4w_water_dynamic:!1,b4w_generated_mesh:!1,b4w_refr_bump:0,b4w_refractive:!1,b4w_waves_height:1,b4w_water_fog_color:[.5,.5,.5],b4w_water_fog_density:.06,b4w_water_num_cascads:5,b4w_water_subdivs:64,b4w_water_detailed_dist:1E3,b4w_terrain:!1,b4w_collision:!1,
b4w_collision_id:"",b4w_double_sided_lighting:!1,b4w_water_enable_caust:!1,b4w_water_caust_scale:.25,b4w_water_caust_brightness:.5,physics:{friction:.5,elasticity:0},type:"SURFACE",use_transparency:!1,use_shadeless:!1,offset_z:0,b4w_render_above_all:!1,game_settings:{alpha_blend:"OPAQUE",use_backface_culling:!0},halo:{size:.5,hardness:50,b4w_halo_rings_color:[1,1,1],b4w_halo_lines_color:[1,1,1],b4w_halo_stars_blend_height:10,b4w_halo_stars_min_height:0},node_tree:null,texture_slots:[]}};a.gG=function(a,
b){function c(b,d){for(var e in b){var f=b[e],h=f[0];if(1<f.length)for(var k=1;k<f.length;k++)h+="*"+f[k];for(k=0;k<a.length;k++)if(f=a[k],f.name==h)for(var g in d)f[g]=d[g]}}for(var d=b.b4w_logic_nodes,e=0;e<d.length;e++)for(var k=d[e],g=0;g<k.length;g++){var m=k[g],n={register1:"variable1",register2:"variable2",registerd:"variabled"},r;for(r in n)r in m&&(m[n[r]]=m[r]);for(var x in m.variables)"boolean"!=typeof m.variables[x][0]&&(m.variables[x]=[!1,m.variables[x]]);0<=["MATH","CONDJUMP","PAGEPARAM",
"REGSTORE"].indexOf(m.type)&&("variable1"in m&&(m.variables.v1=[!1,m.variable1]),"variable2"in m&&(m.variables.v2=[!1,m.variable2]),"variabled"in m&&(m.variables.vd=[!1,m.variabled]));switch(m.type){case "SELECT":for(var t=0;t<a.length;t++)n=a[t],n.name==m.object&&(n.b4w_selectable=!0);m.bools||(m.bools={});m.bools.not_wait||(m.bools.not_wait=!1);f('Logic nodes type "SELECT" is deprecated');break;case "SWITCH_SELECT":c(m.objects_paths,{b4w_selectable:!0});if(m.links instanceof Array){f('Format of a "SWITCH_SELECT" node is outdated. It is recommended to reexport the scene "'+
b.name+'"');var n={},v=0;for(t in m.objects_paths)n[t]=m.links[v],v++;m.links=n}break;case "SELECT_PLAY":f('Logic nodes type "SELECT_PLAY" is deprecated, node will be muted. To fix this, reexport the scene "'+b.name+'"');m.mute=!0;break;case "SELECT_PLAY_ANIM":f('Logic nodes type "SELECT_PLAY_ANIM" is deprecated');break;case "SHOW":case "HIDE":case "SET_SHADER_NODE_PARAM":case "INHERIT_MAT":c(m.objects_paths,{b4w_do_not_batch:!0});break;case "PLAY":b.b4w_use_nla=!0;break;case "MOVE_TO":c(m.objects_paths,
{b4w_do_not_batch:!0});break;case "TRANSFORM_OBJECT":c(m.objects_paths,{b4w_do_not_batch:!0});switch(m.common_usage_names.space_type){case "WORLD":m.common_usage_names.space_type=B.mE;break;case "PARENT":m.common_usage_names.space_type=B.lE;break;case "LOCAL":m.common_usage_names.space_type=B.kE}break;case "OUTLINE":c(m.objects_paths,{b4w_outlining:!0});break;case "CONDJUMP":m.condition&&(m.common_usage_names.condition=m.condition);if("cnd"in m.floats)m.common_usage_names.condition=m.floats.cnd;else switch(m.common_usage_names.condition){case "GEQUAL":m.common_usage_names.condition=
B.Dx;break;case "LEQUAL":m.common_usage_names.condition=B.Fx;break;case "GREATER":m.common_usage_names.condition=B.Ex;break;case "LESS":m.common_usage_names.condition=B.Gx;break;case "NOTEQUAL":m.common_usage_names.condition=B.Hx;break;case "EQUAL":m.common_usage_names.condition=B.Cx}void 0!=m.number1&&(m.input1=m.number1);void 0!=m.number2&&(m.input2=m.number2);m.bools||(m.bools={});void 0===m.bools.str&&(m.bools.str=!1,m.floats.inp1=m.input1,m.floats.inp2=m.input2);break;case "SEND_REQ":m.bools||
(m.bools={});m.strings||(m.strings={});void 0===m.bools.ct&&(m.bools.ct=!1);void 0!=m.url&&(m.bools.url=!1,m.strings.url=m.url);break;case "MATH":void 0!=m.number1&&(m.input1=m.number1);void 0!=m.number2&&(m.input2=m.number2);void 0!=m.input1&&(m.floats.inp1=m.input1);void 0!=m.input2&&(m.floats.inp2=m.input2);break;case "REGSTORE":m.floats||(m.floats={});m.strings||(m.strings={});void 0!=m.number1&&(m.input1=m.number1);if(void 0!=m.input1)switch(typeof m.input1){case "number":m.floats.inp1=m.input1;
m.common_usage_names.variable_type="NUMBER";break;default:m.strings.inp1=m.input1,m.common_usage_names.variable_type="STRING"}switch(m.common_usage_names.variable_type){case "NUMBER":m.common_usage_names.variable_type=B.nE;break;case "STRING":m.common_usage_names.variable_type=B.oE}break;case "PAGEPARAM":m.bools||(m.bools={});void 0===m.bools.hsh&&(m.bools.hsh=!1);m.floats||(m.floats={});void 0===m.floats.ptp&&(m.floats.ptp=0);break;case "PLAY_ANIM":c(m.objects_paths,{b4w_do_not_batch:!0});m.bools||
(m.bools={});void 0===m.bools.env&&(m.bools.env=!1);(n=m.common_usage_names.param_anim_behavior)||(n="FINISH_STOP");m.common_usage_names.param_anim_behavior=F.At(n);break;case "STOP_ANIM":m.bools||(m.bools={});void 0===m.bools.env&&(m.bools.env=!1);break;case "STRING":switch(m.common_usage_names.string_operation){case "JOIN":m.common_usage_names.string_operation=B.hE;break;case "FIND":m.common_usage_names.string_operation=B.gE;break;case "REPLACE":m.common_usage_names.string_operation=B.iE;break;
case "SPLIT":m.common_usage_names.string_operation=B.jE;break;case "COMPARE":m.common_usage_names.string_operation=B.fE}if("cnd"in m.floats)m.common_usage_names.condition=m.floats.cnd;else switch(m.common_usage_names.condition){case "GEQUAL":m.common_usage_names.condition=B.Dx;break;case "LEQUAL":m.common_usage_names.condition=B.Fx;break;case "GREATER":m.common_usage_names.condition=B.Ex;break;case "LESS":m.common_usage_names.condition=B.Gx;break;case "NOTEQUAL":m.common_usage_names.condition=B.Hx;
break;case "EQUAL":m.common_usage_names.condition=B.Cx}break;case "REDIRECT":void 0!=m.url&&(m.bools.url=!1,m.strings.url=m.url);break;case "ENTRYPOINT":m.bools||(m.bools={});void 0===m.bools.js&&(m.bools.js=!1);m.bools.js&&(m.mute=!0);break;case "JS_CALLBACK":for(r in m=m.common_usage_names.js_cb_params,m)switch(m[r]){case "OBJECT":m[r]=B.aE;break;case "VARIABLE":m[r]=B.bE}}}}};b4w.module.__scenegraph=function(a,q){function e(a,b){var c=[];E.ig(a,function(b,d,e){-1<c.indexOf(e)?E.pM(a,b,d,e,A(e)):c.push(e)});E.na(a,function(a,d){for(var e=0;e<d.Ja.length;e++){var f=d.Ja[e];b||d.type!=G.Wc&&d.type!=G.Jc&&d.type!=G.Be||(f.ve=!0);-1<c.indexOf(f)?d.Ja[e]=A(f):c.push(f)}})}function c(a,c){E.na(a,function(b,d){d.type==G.sx&&E.Ug(a,b,function(a,b){if(b.type==G.Zh)for(var c=0;c<b.Ja.length;c++){var d=b.Ja[c];d.ra=J.G;d.qa=J.G}});c||E.Ug(a,b,function(a,b,c){"DEPTH"==c.from&&(c.ve=
!0)})});E.na(a,function(c){var d={};b(a,c,d);for(var e in d){c=d[e];for(var f=c[0],h=0;h<c.length;h++)if(c[h].ra==J.G){f=c[h];break}for(var k=c[0],h=0;h<c.length;h++)if(c[h].qa==J.G){k=c[h];break}for(var g=c[0],h=0;h<c.length;h++)if(!c[h].ve){g=c[h];break}for(h=0;h<c.length;h++)c[h].ra=f.ra,c[h].qa=k.qa,c[h].ve=g.ve}})}function b(a,c,d){E.Ug(a,c,function(c,e,f){f.hc&&f.from==f.to&&(d[f.from]=d[f.from]||[],-1==d[f.from].indexOf(f)&&d[f.from].push(f),b(a,c,d))});E.gj(a,c,function(a,b,c){c.hc&&(d[c.from]=
d[c.from]||[],-1==d[c.from].indexOf(c)&&d[c.from].push(c))});c=E.Sa(a,c);if(c.type==G.Zh)for(var e=0;e<c.Ja.length;e++){var f=c.Ja[e];d[f.from].push(f)}}function n(a){var b=[G.Zh,G.rt,G.Mp,G.Wc,G.Jc,G.an],c=E.Tw(a),d=[];E.na(c,function(a,e){for(var h=0;h<e.Ja.length;h++){var k=e.Ja[h];-1<b.indexOf(e.type)&&(k.Ls=!0);var l=v(d,k,f(k));k.Na=l;e.Sg[h]=l}for(h=0;h<e.Sg.length;h++)l=e.Sg[h],m(d,l);E.gj(c,a,function(h,k,l){-1<b.indexOf(e.type)&&(l.Ls=!0);l.Na||((h=t(c,a,l.from))&&l.hc&&!l.Na?g(d,h):h=v(d,
l,f(l)),l.Na=h)});E.Ug(c,a,function(a,b,c){m(d,c.Na)});E.gj(c,a,function(a,b,c){c.Na&&"NONE"==c.to&&m(d,c.Na)})})}function f(a){a=Z.ih(a);delete a.to;delete a.hc;delete a.Na;return JSON.stringify(a)}function t(a,b,c){var d=null;E.Ug(a,b,function(a,b,e){if(e.hc&&e.from==e.to&&e.from==c&&e.Na)return d=e.Na,!0});E.gj(a,b,function(a,b,e){if(e.hc&&e.from==c&&e.Na)return d=e.Na,!0});return d}function g(a,b){for(var c=0;c<a.length;c++){var d=a[c];d.Pw===b&&d.Yo++}}function m(a,b){for(var c=0;c<a.length;c++){var d=
a[c];d.Pw===b&&d.Yo&&d.Yo--}}function v(a,b,c){if(b.Oo)return g(a,b.Oo.Na),b.Oo.Na;if(b.Ls)return x(b);for(var d=null,e=0;e<a.length;e++){var f=a[e];if(f.id==c&&0===f.Yo){d=f;break}}if(d&&!O.yz)return d.Yo++,d.Pw;b=x(b);a.push({id:c,Yo:1,Pw:b});return b}function x(a){var b=a.Mk*a.size,c=a.Nk*a.size;switch(a.from){case "COLOR":if(a.ve){var d=J.On("COLOR_RB",a.Ii?J.Rp:J.Qp,a.xp);J.resize(d,b,c)}else d=J.On("COLOR",J.sj,a.xp),J.resize(d,b,c),J.ow(d,a.ra,a.qa);return d;case "DEPTH":return a.ve?(d=J.On("DEPTH_RB",
a.Ii?J.Pp:J.Op,a.xp),J.resize(d,b,c)):(d=J.On("DEPTH_TEX",J.ll,a.xp),J.resize(d,b,c),J.ow(d,a.ra,a.qa)),d;case "CUBEMAP":return d=J.xH(b);case "SCREEN":case "NONE":return null;default:Z.r("Wrong slink param: "+a.from)}}function d(a,b){var c=!1;E.ig(a,function(d,e,f){if(f&&(d=E.Sa(a,d),e=E.Sa(a,e),b(f,!1,d,e)))return c=!0});c||E.na(a,function(a,c){for(var d=0;d<c.Ja.length;d++)if(b(c.Ja[d],!0,c,null))return!0})}function k(a){E.na(a,function(b,c){if(c.type!=G.kl){var d=c.p;E.gj(a,b,function(a,b,c){c.hc&&
c.Na&&(z.qs(d,c.from,c.Na),c.from==c.to&&b.p&&z.qs(b.p,c.from,c.Na))});for(var e=0;e<c.Ja.length;e++){var f=c.Ja[e];f.hc&&f.from==f.to&&z.qs(d,f.from,c.Sg[e])}!d.Zb&&!d.ee||d.he||(d.he=W.lM(d.Zb,d.ee))}});E.na(a,function(b,c){if(c.type==G.jl||c.type==G.ht){var d=h(a,c);c.p.io=d[0].p.he}})}function r(a){var b=null,c=0;E.na(a,function(a,d){if(d.type==L.UN){if(c==L.TN)return b=d,!0;c++}});return b}function C(a,b){var c=E.Uf(a,b),d=G.Xc("NONE"),e=E.H(a,d),f=E.oo(a)[0];E.ig(a,function(b,c){c==f&&E.eM(a,
b,f,b,e)});var h=B(b,a);E.ig(a,function(e,f,k){if(e==c){if(h){e=G.sq();E.H(a,e);f=y("COLOR","RESOLVE",1,1,1,!0);f.Ii=!0;f.ve=!0;var g=y("DEPTH","RESOLVE",1,1,1,!0);g.Ii=!0;g.ve=!0;E.s(a,b,e,f);E.s(a,b,e,g);b=e}E.s(a,b,d,y(L.tN,"u_color",k.size,k.Mk,k.Nk,k.sp));return!0}});E.rd(a,e,f,y("SCREEN","NONE",.5,.5,.5,!0))}function B(a,b){var c=!1,d=E.Uf(b,a);E.Jg(b,d)&&(c=E.Bg(b,d,0),d=E.Oe(b,d,c,0),"COLOR"==d.from&&"COLOR"==d.to||"DEPTH"==d.from&&"DEPTH"==d.to?(d=E.Sa(b,c),c=B(d,b)):c="RESOLVE"==d.to);return c}
function F(a,b,c,d){for(var e=c.R,f=b.ro,h=b.Mg.Kg,k=b.Mg.$r,g=E.Bs(a,E.fK(a,d),E.Ep),l=[],p=[],m=[],g=E.clone(g,function(b){var d;if(-1<ga.indexOf(b.type))p.push(b),d=b;else{d=G.lH(b);if(d.type==G.Wc)for(var g=0;g<h.length;g++)if(h[g][0]==b){h[g]=[b,d];d.p.Nb=b.p.Nb;c.R.push(d.p);break}if(b.type==G.Ae)for(g=0;g<h.length;g++){if(k[g][0]==b){k[g]=[b,d];d.p=h[g][1].p;break}}else-1<e.indexOf(b.p)&&(f?(z.Dr(b.p,z.Wd),z.Dr(d.p,z.Xd)):(z.Dr(b.p,z.pc),z.Dr(d.p,z.Bc)),e.push(d.p));var u=E.Uf(a,b);E.Ug(a,
u,function(a,b,c){-1<ga.indexOf(b.type)&&l.push([b,d,c])});for(g=0;g<b.Ja.length;g++)d.Ja[g].Oo=b.Ja[g];b=!0;for(g=0;g<E.ir(a,u);g++){var n=E.ik(a,u,g),n=E.Sa(a,n);-1==ga.indexOf(n.type)&&(b=!1)}b&&m.push(d)}return d},function(a){var b=A(a,!0);b.Oo=a;return b}),u=0;u<p.length;u++)E.cg(g,E.Uf(g,p[u]));E.St(g);b=G.qI(f);var u=E.H(a,b),n=G.gu();E.H(a,n);var r=y("COLOR","COPY",1,1,1,!0);E.s(a,d,n,r);var x=y("COLOR","u_sampler_left",1,1,1,!0);x.Ls=!0;x.ra=J.G;x.qa=J.G;E.s(a,n,b,x);d.Sb||(d=G.gu(),E.H(g,
d),x=y("COLOR","COPY",1,1,1,!0),x.Oo=r,r=E.oo(g)[0],r=E.Sa(g,r),E.s(g,r,d,x));d=y("COLOR","u_sampler_right",1,1,1,!0);d.ra=J.G;d.qa=J.G;E.VF(g,a,[E.oo(g)[0],u,d]);for(u=0;u<l.length;u++)E.s(a,l[u][0],l[u][1],l[u][2]);g=y("SCREEN","NONE",0,0,0,!1);for(u=0;u<m.length;u++)E.s(a,n,m[u],g);f&&D(a,.5,1);return b}function D(a,b,c){var d=[];E.na(a,function(b,c){if(-1==ga.indexOf(c.type)&&c.Ja.length&&H(a,c,G.ai))for(var e=0;e<c.Ja.length;e++){var f=c.Ja[e];-1==d.indexOf(f)&&d.push(f)}});E.ig(a,function(b,
c,e){b=E.Sa(a,b);c=E.Sa(a,c);-1==ga.indexOf(b.type)&&H(a,c,G.ai)&&-1==d.indexOf(e)&&d.push(e)});for(var e=0;e<d.length;e++)d[e].Mk*=b,d[e].Nk*=c}function y(a,b,c,d,e,f){return{from:a,to:b,size:c,Mk:d,Nk:e,sp:f,hc:!0,Na:null,Ii:!1,ve:!1,ra:J.Fd,qa:J.Fd,Ls:!1,xp:!1}}function A(a,b){if(b){var c=a.Na;a.Na=null}a.Na&&Z.r("Failed to clone slink with attached texture");var d=Z.ih(a);b&&(a.Na=c,d.Na=c);return d}function H(a,b,c){if(b.type==c)return!0;b=u(a,b);for(var d=0;d<b.length;d++)if(H(a,b[d],c))return!0;
return!1}function w(a,b,c){if(b.type==c)return!0;b=h(a,b);for(var d=0;d<b.length;d++)if(w(a,b[d],c))return!0;return!1}function h(a,b){var c=E.Uf(a,b);c==E.qt&&Z.r("Subscene not in graph");for(var d=[],e=E.ir(a,c),f=0;f<e;f++){var h=E.ik(a,c,f);h!=c&&d.push(E.Sa(a,h))}return d}function u(a,b){var c=E.Uf(a,b);c==E.qt&&Z.r("Subscene not in graph");for(var d=[],e=E.Jg(a,c),f=0;f<e;f++){var h=E.Bg(a,c,f);h!=c&&d.push(E.Sa(a,h))}return d}function P(a){var b=[],c=[];d(a,function(a){a.Na&&-1==b.indexOf(a.Na)&&
(b.push(a.Na),c.push(a.Na,b.length-1))});return c}function p(a,b){var c;c=""+(a.from+"\\n");c+="NONE"!=a.to?a.to+"\\n":"";c+="(";if(a.sp){var d=a.Mk,e=a.Nk;Math.round(d)!=d&&(d=d.toFixed(2));Math.round(e)!=e&&(e=e.toFixed(2));c+=(1==d?"":d)+"Sx"+((1==e?"":e)+"S")}else d=a.Mk,e=a.Nk,c+=a.size*d+"x"+a.size*e;if("SCREEN"!=a.from){c+=" ";if(a.ve)c+="RR";else{var d=a.ra,e=a.qa,f="";d==J.G?f+="L":d==J.Fd&&(f+="N");e==J.G?f+="L":e==J.Fd&&(f+="N");c+=f}for(d=0;d<b.length;d+=2)b[d]==a.Na&&(c+=" "+b[d+1])}return c+
")\\n"}var z=q("__camera"),l=q("__config"),M=q("__debug"),E=q("__graph"),W=q("__renderer"),G=q("__subscene"),J=q("__textures"),Z=q("__util"),L=l.xq,O=l.v,U=l.Kk,ga=[G.ah,G.Ac,G.Jc,G.Vd];a.$G=function(a){switch(a.to){case "COLOR":case "CUBEMAP":case "DEPTH":case "SCREEN":case "OFFSCREEN":case "RESOLVE":case "COPY":case "NONE":return!1;default:return!0}};a.dO=d;a.MH=function(a,b,d,f){function g(c){var d=z.ic(Ra,!0);b.R.push(d);d=G.Sj(c,d,!1,P,I,va,ma,X,a.Ph);E.H(l,d);c==G.Be?(E.s(l,p[0],d,y("COLOR",
"COLOR",1,1,1,!0)),d.Ja.push(y("DEPTH","DEPTH",1,1,1,!0))):(c=ba&&p[0].type==G.jl?ob:p[0],E.s(l,c,d,Ca),E.s(l,c,d,Oa));Qa&&(E.s(l,Qa,d,gb),E.s(l,Qa,d,La));for(c=0;c<x.length;c++)E.s(l,x[c],d,t[c]);Ib&&E.s(l,Ib,d,dd);if(v.length){var e=v.length;for(c=0;c<e;c++)E.s(l,v[c],d,w[c])}if(q.length)for(c=0;c<q.length;c++)E.s(l,q[c],d,B[c]);Zb&&E.s(l,Zb,d,Dc);return d}var l=E.create(),p=[],m=[],x=[],t=[],v=[],w=[],q=[],B=[],I=a.QK,P=a.oc,ka=a.shore_smoothing,H=a.vN,V=a.ssao,ua=a.god_rays,D=a.Mg,ga=a.QA,aa=
a.uG,T=a.motion_blur,xa=a.ul,la=a.antialiasing,ma=a.rx,va=a.uD,X=a.Sc,ya=a.xL,W=a.NG,Ha=a.oK,za=a.ML,Ga=a.dof,Sa=a.GI,Ba=a.refractions,da=Boolean(f.length),ba=1<O.lc,Oa=y("COLOR","COLOR",1,1,1,!0),Ca=y("DEPTH","DEPTH",1,1,1,!0);if(ba){A(Ca);var Ia=A(Ca);Oa.Ii=!0;Oa.ve=!0;Ca.Ii=!0;Ca.ve=!0}var Ra=b.R[0];if(X){z.cx(Ra,X);for(var fa=0;fa<X.Rf.length;fa++)for(var Nb=X.csm_num,ja=0;ja<Nb;ja++){var S=G.lI(ja,fa,X,I);E.H(l,S);x.push(S);var Wa=X.csm_resolution,Da=S.p;b.aC.push(Da);Da.width=Wa;Da.height=Wa;
S.$a=!1;var Ja=y("DEPTH","u_shadow_map"+(0<fa?fa:ja),Wa,1,1,!1);O.Vb&&(Ja.ra=J.G,Ja.qa=J.G,Ja.xp=!0);t.push(Ja);(M.UG()||O.cC)&&S.Ja.push(y("COLOR","COLOR",Wa,1,1,!1))}}if(D&&D.eB&&!da)for(ja=0;ja<D.eB;ja++){Da=z.Dc(z.hd);Da.width=a.mh;Da.height=a.mh;z.rs(Da,90,.1,100);z.aj(Da,Da.bb);var Ka=G.Sj(G.Jc,Da,!1,P,I,va,ma,null,a.Ph);Ka.Tj=Z.EJ();for(fa=0;6>fa;fa++)Ka.Qn.push(z.AH());E.H(l,Ka);var pb=y("CUBEMAP","u_cube_reflection",a.mh,1,1,!1);pb.ra=J.G;pb.qa=J.G;B.push(pb);if(D.kA){var Na=G.Sj(G.Vd,Da,
!1,P,I,va,ma,null,a.Ph);Na.Tj=Ka.Tj;Na.Qn=Ka.Qn;E.H(l,Na);var wa=y("DEPTH","DEPTH",a.mh,1,1,!1),qb=y("COLOR","COLOR",a.mh,1,1,!1);E.s(l,Ka,Na,wa);E.s(l,Ka,Na,qb);q.push(Na);D.ku.push(Na)}else{var Bb=y("DEPTH","DEPTH",a.mh,1,1,!1);Ka.Ja.push(Bb);q.push(Ka)}D.lh.push(Ka)}if(D&&0<D.FB.length&&!da)for(fa=0;fa<D.FB.length;fa++)Da=z.ic(Ra,!0),Da.Nb=new Float32Array(4),b.R.push(Da),Ka=G.Sj(G.Wc,Da,!1,P,I,va,ma,null,a.Ph),E.H(l,Ka),pb=y("COLOR","u_plane_reflection",1,a.ag,a.ag,!0),pb.ra=J.G,pb.qa=J.G,w.push(pb),
D.kA?(Na=G.Sj(G.Ae,Da,!1,P,I,va,ma,null,a.Ph),E.H(l,Na),wa=y("DEPTH","DEPTH",1,a.ag,a.ag,!0),qb=y("COLOR","COLOR",1,a.ag,a.ag,!0),qb.ra=J.Fd,qb.qa=J.Fd,E.s(l,Ka,Na,wa),E.s(l,Ka,Na,qb),D.$r.push([Na]),v.push(Na)):(Bb=y("DEPTH","DEPTH",1,a.ag,a.ag,!0),Ka.Ja.push(Bb),v.push(Ka)),D.Kg.push([Ka]);if(a.jc){var Qa=G.eI();E.H(l,Qa);Wa=U.Vq;Qa.p.width=Wa;Qa.p.height=Wa;var gb=y("DEPTH","u_grass_map_depth",Wa,1,1,!1);gb.ra=J.G;gb.qa=J.G;var La=y("COLOR","u_grass_map_color",Wa,1,1,!1);La.ra=J.G;La.qa=J.G}else La=
gb=Qa=null;if(Sa&&X){var Ta=z.ic(Ra,!0);b.R.push(Ta);var bb=G.mI(Ta,I);E.H(l,bb);bb.self_shadow_normal_offset=X.self_shadow_normal_offset;for(ja=0;ja<x.length;ja++)S=x[ja],E.s(l,S,bb,t[ja]);var Ub=y("COLOR","u_color",1,1,1,!0),ic=y("DEPTH","u_depth",1,1,1,!0);if(V){var jb=z.ic(Ra,!0);b.R.push(jb);var Pa=a.MN,Vb=G.oI(jb,va,Pa);E.H(l,Vb);var ed=y("COLOR","u_ssao_mask",1,1,1,!0);E.s(l,bb,Vb,Ub);E.s(l,bb,Vb,ic);var Tc=z.ic(Ra,!0);b.R.push(Tc);var pc=G.pI(Tc,Pa);E.H(l,pc);var md=y("COLOR","u_shadow_mask",
1,1,1,!0);E.s(l,Vb,pc,ed);E.s(l,bb,pc,ic)}ba?bb.Ja.push(y("DEPTH","DEPTH",1,1,1,!0)):bb.Ja.push(Ca);Qa&&(E.s(l,Qa,bb,gb),E.s(l,Qa,bb,La))}else bb=null;var ob=G.Sj(G.sb,Ra,!0,P,I,va,ma,null,a.Ph);E.H(l,ob);if(ba){var Ob=G.sq();E.H(l,Ob);m.push(Ob);var xc=y("COLOR","RESOLVE",1,1,1,!0);xc.Ii=!0;xc.ve=!0;var ec=y("DEPTH","RESOLVE",1,1,1,!0);ec.Ii=!0;ec.ve=!0;E.s(l,ob,Ob,xc);E.s(l,ob,Ob,ec)}else m.push(ob);bb&&(ed?E.s(l,pc,ob,md):X?E.s(l,bb,ob,y("COLOR","u_shadow_mask",1,1,1,!0)):Z.r("Internal error"));
Qa&&(E.s(l,Qa,ob,gb),E.s(l,Qa,ob,La));if(v.length)for(var fc=v.length,fa=0;fa<fc;fa++)E.s(l,v[fa],ob,w[fa]);if(q.length)for(fa=0;fa<q.length;fa++)E.s(l,q[fa],ob,B[fa]);p=m;m=[];if(!da&&a.mH){Da=z.ic(Ra,!0);Da.width=1;Da.height=1;b.R.push(Da);var jc=G.$y(Da,!1,I);E.H(l,jc);if(a.lg){Da=z.ic(Ra,!0);Da.width=1;Da.height=1;b.R.push(Da);var Ec=G.$y(Da,!0,I);E.H(l,Ec);E.s(l,jc,Ec,y("COLOR","COLOR",1,1,1,!1));E.s(l,jc,Ec,y("DEPTH","DEPTH",1,1,1,!1))}}else jc=null;if(!ga.refractions&&!Ba||da)Zb=null;else{if(ba)Zb=
Ob;else{var Zb=G.gu();E.H(l,Zb);E.s(l,p[0],Zb,y("COLOR","COPY",1,1,1,!0))}var Dc=y("COLOR","u_refractmap",1,1,1,!0)}if(Sa&&(Ba||ka||H)){var nd=z.ic(Ra,!0);b.R.push(nd);var Ib=G.bI(nd);E.H(l,Ib);E.s(l,ba?Ob:ob,Ib,y("DEPTH","u_depth",1,1,1,!0));var dd=y("COLOR","u_scene_depth",1,1,1,!0);dd.ra=J.Fd;dd.qa=J.Fd}else Ib=null;if(a.Tq){var Fc=g(G.gc);m.push(Fc);p=m;m=[]}if(a.th){var qc=z.ic(Ra,!0);b.R.push(qc);var wb=G.Sj(G.qd,qc,!1,P,I,va,ma);E.H(l,wb);Ib&&E.s(l,Ib,wb,dd);Zb&&E.s(l,Zb,wb,Dc);Qa&&(E.s(l,
Qa,wb,gb),E.s(l,Qa,wb,La));if(v.length)for(fc=v.length,fa=0;fa<fc;fa++)E.s(l,v[fa],wb,w[fa]);if(q.length)for(fa=0;fa<q.length;fa++)E.s(l,q[fa],wb,B[fa]);E.s(l,ba?Ob:ob,wb,ba?Ia:Ca);var yc=G.Xc("X_GLOW_BLUR");yc.ub="GLOW_MASK_SMALL";yc.Af=a.vi.small_glow_mask_width;var hd=y("COLOR","u_color",1,1,1,!0);hd.ra=J.G;hd.qa=J.G;E.H(l,yc);E.s(l,wb,yc,hd);var kc=G.Xc("Y_GLOW_BLUR");kc.ub="GLOW_MASK_SMALL";kc.Af=a.vi.small_glow_mask_width;var od=y("COLOR","u_color",1,.5,.5,!0);od.ra=J.G;od.qa=J.G;E.H(l,kc);
E.s(l,yc,kc,od);var Gc=G.Xc("X_GLOW_BLUR");Gc.ub="GLOW_MASK_LARGE";Gc.Af=a.vi.large_glow_mask_width;var zc=y("COLOR","u_color",1,.5,.5,!0);zc.ra=J.G;zc.qa=J.G;E.H(l,Gc);E.s(l,kc,Gc,zc);var lc=G.Xc("Y_GLOW_BLUR");lc.ub="GLOW_MASK_LARGE";lc.Af=a.vi.large_glow_mask_width;var Jb=y("COLOR","u_color",1,.25,.25,!0);Jb.ra=J.G;Jb.qa=J.G;E.H(l,lc);E.s(l,Gc,lc,Jb);var Pb=z.ic(Ra,!0);b.R.push(Pb);var $b=G.cI(Pb,a);E.H(l,$b);var hb=y("COLOR","u_src_color",1,1,1,!0);if(a.Tq)if(ba){var rc=G.sq();E.H(l,rc);E.s(l,
Fc,rc,xc);E.s(l,Fc,rc,ec);E.s(l,rc,$b,hb)}else E.s(l,Fc,$b,hb);else E.s(l,ba?Ob:ob,$b,hb);E.s(l,a.Tq?Fc:ob,$b,Ca);var Ac=y("COLOR","u_glow_mask_small",1,.5,.5,!0);Ac.ra=J.G;Ac.qa=J.G;E.s(l,kc,$b,Ac);var ac=y("COLOR","u_glow_mask_large",1,.25,.25,!0);ac.ra=J.G;ac.qa=J.G;E.s(l,lc,$b,ac);p=[$b];m=[]}a.Tq||(Fc=g(G.gc),m.push(Fc),p=m,m=[]);if(O.debug_view){Da=z.ic(Ra,!0);b.R.push(Da);var Cb=G.aI(Da);m.push(Cb);E.H(l,Cb);E.s(l,p[0],Cb,Oa);E.s(l,p[0],Cb,Ca);Qa&&(E.s(l,Qa,Cb,gb),E.s(l,Qa,Cb,La));M.IM(Cb);
p=m;m=[]}if(ba){var mc=G.sq();E.H(l,mc);m.push(mc);E.s(l,p[0],mc,xc);E.s(l,p[0],mc,ec);p=m;m=[]}var gc=p.slice(0);if(!da&&a.CF){Da=z.ic(Ra,!0);b.R.push(Da);var hc=G.XH(Da);E.H(l,hc);E.s(l,p[0],hc,ba?Ia:Ca)}if(ua&&Sa&&!da){var xb=Ha.$l,Hc=Ha.$u,yb=Ha.Cm,Za=p[0],Uc=P?!0:!1,Vc=y("DEPTH","u_input",1,1,1,!0);Vc.ra=J.G;Vc.qa=J.G;var rb=y("COLOR","u_input",1,.25,.25,!0);rb.ra=J.G;rb.qa=J.G;var Ab=xb/yb,kb=z.ic(Ra,!0);b.R.push(kb);var sb=G.hu(kb,Uc,xb,!0,Ab,I,yb);E.H(l,sb);E.s(l,Za,sb,Vc);var Ab=xb/yb*.5,
sc=z.ic(Ra,!0);b.R.push(sc);var tc=G.hu(sc,Uc,xb,!1,Ab,I,yb);E.H(l,tc);E.s(l,sb,tc,rb);var Ab=xb/yb*.25,cb=z.ic(Ra,!0);b.R.push(cb);var Db=G.hu(cb,Uc,xb,!1,Ab,I,yb);E.H(l,Db);E.s(l,tc,Db,rb);var Eb=G.dI(Hc,I);m.push(Eb);E.H(l,Eb);E.s(l,Za,Eb,y("COLOR","u_main",1,1,1,!0));E.s(l,Db,Eb,y("COLOR","u_god_rays",1,1,1,!0));p=m;m=[]}if(aa&&!da){var Za=p[0],tb=G.fI();E.H(l,tb);E.s(l,Za,tb,y("COLOR","u_input",1,1,1,!0));var Mb=G.YH();E.H(l,Mb);Mb.p.width=O.$n?2:1;Mb.p.height=O.$n?2:1;var Wb=y("COLOR","u_input",
1,.25,.25,!0);Wb.ra=J.G;Wb.qa=J.G;var uc=y("COLOR","u_luminance",1,.25,.25,!0);uc.ra=J.G;uc.qa=J.G;E.s(l,tb,Mb,Wb);var Oc=aa.key,nc=aa.QI,bc=z.ic(Ra,!0);b.R.push(bc);var Qb=G.gI(Oc,nc,I,bc);E.H(l,Qb);E.s(l,Za,Qb,y("COLOR","u_main",1,1,1,!0));E.s(l,tb,Qb,uc);E.s(l,Mb,Qb,y("COLOR","u_average_lum",1,1,1,!1));var $a=y("COLOR","u_color",1,.25,.25,!0);$a.ra=J.G;$a.qa=J.G;yc=G.Zy("X_BLUR");E.H(l,yc);E.s(l,Qb,yc,$a);kc=G.Zy("Y_BLUR");E.H(l,kc);E.s(l,yc,kc,$a);var Fb=G.ZH(aa.blur);E.H(l,Fb);var Bc=y("COLOR",
"u_bloom",1,.25,.25,!0);Bc.ra=J.G;Bc.qa=J.G;E.s(l,kc,Fb,Bc);E.s(l,Za,Fb,y("COLOR","u_main",1,1,1,!0));m.push(Fb);p=m;m=[]}if(Ga&&Sa&&!da){var Za=p[0],Ua=z.ic(Ra,!0);b.R.push(Ua);if(d.Nc){var vc=y("COLOR","u_color",1,1,1,!0);vc.ra=J.G;vc.qa=J.G;var Kb=y("DEPTH","u_depth",1,1,1,!0);Kb.ra=J.G;Kb.qa=J.G;var lb=y("COLOR","u_color",1,.5,.5,!0);lb.ra=J.Fd;lb.qa=J.Fd;$a=y("COLOR","u_color",1,.5,.5,!0);$a.ra=J.Fd;$a.qa=J.Fd;var ib=y("COLOR","u_blurred1",1,.5,.5,!0);ib.ra=J.G;ib.qa=J.G;var ub=y("COLOR","u_blurred2",
1,.5,.5,!0);ub.ra=J.G;ub.qa=J.G;var Ma=gc[0];if(d.$c){var fb=z.ic(Ra,!0);b.R.push(fb);var db=G.fu(fb,"COC_FOREGROUND");fb.dof_distance=d.dof_distance;fb.tc=d.tc;fb.dof_front_start=d.dof_front_start;fb.dof_front_end=d.dof_front_end;fb.dof_rear_start=d.dof_rear_start;fb.dof_rear_end=d.dof_rear_end;fb.dof_power=d.dof_power;fb.Nc=d.Nc;fb.Xa=d.Xa;fb.$c=d.$c;fb.dof_on=!0;E.H(l,db);E.s(l,Za,db,vc);E.s(l,Ma,db,Kb);var Pc=G.Xc("X_ALPHA_BLUR");E.H(l,Pc);E.s(l,db,Pc,lb);var mb=G.Xc("Y_ALPHA_BLUR");E.H(l,mb);
E.s(l,Pc,mb,$a);var Xa=z.ic(Ra,!0),Gb=G.fu(Xa,"COC_COMBINE");b.R.push(Xa);Xa.dof_distance=d.dof_distance;Xa.tc=d.tc;Xa.dof_front_start=d.dof_front_start;Xa.dof_front_end=d.dof_front_end;Xa.dof_rear_start=d.dof_rear_start;Xa.dof_rear_end=d.dof_rear_end;Xa.dof_power=d.dof_power;Xa.Nc=d.Nc;Xa.Xa=d.Xa;Xa.$c=d.$c;Xa.dof_on=!0;E.H(l,Gb);E.s(l,Za,Gb,vc);E.s(l,Ma,Gb,Kb);E.s(l,mb,Gb,y("COLOR","u_coc_fg",1,.5,.5,!0))}else Xa=z.ic(Ra,!0),b.R.push(Xa),Gb=G.fu(Xa,"COC_ALL"),Xa.dof_distance=d.dof_distance,Xa.tc=
d.tc,Xa.dof_front_start=d.dof_front_start,Xa.dof_front_end=d.dof_front_end,Xa.dof_rear_start=d.dof_rear_start,Xa.dof_rear_end=d.dof_rear_end,Xa.dof_power=d.dof_power,Xa.Nc=d.Nc,Xa.Xa=d.Xa,Xa.$c=d.$c,Xa.dof_on=!0,E.H(l,Gb),E.s(l,Za,Gb,vc),E.s(l,Ma,Gb,Kb);var ab=G.Xc("X_DOF_BLUR");ab.p.Xa=d.Xa;E.H(l,ab);E.s(l,Gb,ab,lb);var Ya=G.Xc("Y_DOF_BLUR");Ya.p.Xa=d.Xa;E.H(l,Ya);E.s(l,ab,Ya,$a);var Hb=G.Xc("Y_DOF_BLUR");Hb.p.Xa=d.Xa;E.H(l,Hb);E.s(l,ab,Hb,$a);var Rb=G.az(Ua);Ua.dof_distance=d.dof_distance;Ua.tc=
d.tc;Ua.dof_front_start=d.dof_front_start;Ua.dof_front_end=d.dof_front_end;Ua.dof_rear_start=d.dof_rear_start;Ua.dof_rear_end=d.dof_rear_end;Ua.dof_power=d.dof_power;Ua.Nc=d.Nc;Ua.Xa=d.Xa;Ua.$c=d.$c;Ua.dof_on=!0;m.push(Rb);E.H(l,Rb);E.s(l,Za,Rb,y("COLOR","u_sharp",1,1,1,!0));E.s(l,Ya,Rb,ib);E.s(l,Hb,Rb,ub)}else{var Qc=y("COLOR","u_color",1,1,1,!0);Qc.ra=J.G;Qc.qa=J.G;var Ic=y("COLOR","u_color",1,1,1,!0);Ic.ra=J.G;Ic.qa=J.G;ab=G.Xc("X_BLUR");E.H(l,ab);E.s(l,Za,ab,Qc);var Sb=G.Xc("Y_BLUR");E.H(l,Sb);
E.s(l,ab,Sb,Ic);var vb=gc[0],Rb=G.az(Ua);Ua.dof_distance=d.dof_distance;Ua.tc=d.tc;Ua.dof_front_start=d.dof_front_start;Ua.dof_front_end=d.dof_front_end;Ua.dof_rear_start=d.dof_rear_start;Ua.dof_rear_end=d.dof_rear_end;Ua.dof_power=d.dof_power;Ua.Nc=d.Nc;Ua.Xa=d.Xa;Ua.$c=d.$c;Ua.dof_on=!0;m.push(Rb);E.H(l,Rb);E.s(l,Za,Rb,y("COLOR","u_sharp",1,1,1,!0));E.s(l,Sb,Rb,y("COLOR","u_blurred",1,1,1,!0));E.s(l,vb,Rb,y("DEPTH","u_depth",1,1,1,!0))}p=m;m=[]}if(a.lg){var Wc=g(G.Be);m.push(Wc);p=m;m=[]}if(T&&
!da){var Tb=p[0],cc=G.hI(ya.mb_decay_threshold,ya.mb_factor);m.push(cc);E.H(l,cc);E.s(l,Tb,cc,y("COLOR","u_mb_tex_curr",1,1,1,!0));cc.Ja.push(y("COLOR","u_mb_tex_accum",1,1,1,!0));p=m;m=[]}if(!da&&a.outline){var Za=p[0],oc=z.ic(Ra,!0);b.R.push(oc);var Jc=G.jI(oc,I);E.H(l,Jc);var Va=G.Xc("X_EXTEND"),eb=y("COLOR","u_color",1,1,1,!0),Kc=y("COLOR","u_outline_mask",1,1,1,!0);Va.yo=!0;E.H(l,Va);E.s(l,Jc,Va,eb);var Xb=y("COLOR","u_color",1,.5,.5,!0);Xb.ra=J.G;Xb.qa=J.G;var Lb=G.Xc("Y_EXTEND");Lb.yo=!0;E.H(l,
Lb);E.s(l,Va,Lb,Xb);ab=G.Xc("X_BLUR");ab.yo=!0;E.H(l,ab);E.s(l,Lb,ab,Xb);var Xc=y("COLOR","u_color",1,.25,.25,!0);Xc.ra=J.G;Xc.qa=J.G;var Lc=y("COLOR","u_outline_mask_blurred",1,.25,.25,!0);Lc.ra=J.G;Lc.qa=J.G;Sb=G.Xc("Y_BLUR");Sb.yo=!0;E.H(l,Sb);E.s(l,ab,Sb,Xc);var Rc=G.iI(za);E.H(l,Rc);E.s(l,Za,Rc,y("COLOR","u_outline_src",1,1,1,!0));E.s(l,Jc,Rc,Kc);E.s(l,Sb,Rc,Lc);m.push(Rc);p=m;m=[]}e(l,Sa);if((a.anaglyph_use||a.ro)&&!da){var Sc=F(l,a,b,p[0]);m.push(Sc);p=m;m=[]}if(xa&&!da){var Za=p[0],dc=G.$H(W.brightness,
W.contrast,W.exposure,W.saturation);E.H(l,dc);E.s(l,Za,dc,y("COLOR","u_color",1,1,1,!0));m.push(dc);p=m;m=[]}if(la){Za=p[0];if(O.smaa){var Yb=y("COLOR","u_color",1,1,1,!0);Yb.ra=J.G;Yb.qa=J.G;var Yc=G.iu(G.Lp,a);E.H(l,Yc);E.s(l,Za,Yc,Yb);var wc=G.iu(G.bn,a);E.H(l,wc);E.s(l,Yc,wc,Yb);var Zc=y("COLOR","u_search_tex",1,1,1,!1),nb=y("COLOR","u_area_tex",1,1,1,!1);Zc.ra=J.G;Zc.qa=J.G;nb.ra=J.G;nb.qa=J.G;wc.Ja.push(Zc);wc.Ja.push(nb);var Mc=G.iu(G.Mp,a);E.H(l,Mc);E.s(l,Za,Mc,Yb);var fd=y("COLOR","u_blend",
1,1,1,!0);fd.ra=J.G;fd.qa=J.G;E.s(l,wc,Mc,fd);m.push(Mc)}else{var $c=G.WH(a);E.H(l,$c);var jd=y("COLOR","u_color",1,1,1,!0);jd.ra=J.G;jd.qa=J.G;E.s(l,Za,$c,jd);m.push($c)}p=m;m=[]}var pd=E.Uf(l,p[0]);if(p[0].type==G.Zh||p[0].type==G.jl)var ad=!0;else ad=!1,E.Ug(l,pd,function(a,b,c){if(c.from==c.to)return ad=!0});if(ad){var bd=G.Xc("NONE");E.H(l,bd);E.s(l,p[0],bd,y("COLOR","u_color",1,1,1,!0));m.push(bd);p=m;m=[]}m.push(p[0]);jc&&(Ec?m.push(Ec):m.push(jc));hc&&m.push(hc);if(!da&&a.xs.procedural_skydome){var qd=
G.nI(I,a.xs);E.H(l,qd);m.push(qd)}var Cc=G.bz();E.H(l,Cc);for(ja=0;ja<m.length;ja++){var cd=m[ja];switch(cd.type){case G.Ud:case G.$g:E.s(l,cd,Cc,y("COLOR","NONE",1,1,1,!1));E.s(l,cd,Cc,y("DEPTH","NONE",1,1,1,!1));break;case G.$h:E.s(l,cd,Cc,y("CUBEMAP","u_sky",U.xl,1,1,!1));break;case G.fl:E.s(l,cd,Cc,y("COLOR","NONE",1,1,1,!0));break;default:if(da){var kd=f[0].q,zb=y("COLOR","OFFSCREEN",1,1,1,!0);zb.Na=kd;E.s(l,m[ja],Cc,zb);for(fa=1;fa<f.length;fa++){var rd=f[fa].q,Nc=G.Xc("NONE");E.H(l,Nc);E.s(l,
m[ja],Nc,y("COLOR","SCALE",1,1,1,!0));var sd=rd.Kh/kd.Kh,zb=y("COLOR","OFFSCREEN",1,sd,sd,!0);zb.Na=rd;E.s(l,Nc,Cc,zb)}}else E.s(l,m[ja],Cc,y("SCREEN","NONE",1,1,1,!0))}}Ob&&!u(l,Ob).length&&(E.cg(l,E.Uf(l,Ob)),E.St(l));e(l,Sa);c(l,Sa);if(L.enabled){var ld=r(l);ld&&C(l,ld)}n(l);k(l);X&&E.na(l,function(a,b){if(b.type==G.Ce||b.type==G.gc||b.type==G.Be){for(var c=0,d=h(l,b),e=0,f=0;f<d.length;f++){var k=d[f];k.type==G.Ac&&(e++,b.Dk=b.Dk||[],b.Dk[0<k.fg?k.fg:c]=k.p.ab,c++)}b.Ps&&b.Os||(O.Cr?b.ix=new Float32Array(9*
e):(b.Ps=new Float32Array(4*e),b.Os=new Float32Array(4*e)))}});return l};a.DL=D;a.ed=function(a,b,c){var d=a.Af;a.Qw[0]=b*a.ib[0]*d;a.Qw[1]=c*a.ib[1]*d};a.nc=function(a,b){a.Af=b};a.KH=function(){var a=E.create(),b=G.kI(),c=z.Dc(z.Kc);c.width=512;c.height=512;b.p=c;E.H(a,b);b.Ja.push(y("COLOR","u_color",512,1,1,!1));c=G.bz();E.H(a,c);E.s(a,b,c,y("COLOR","NONE",512,1,1,!1));n(a);k(a);return a};a.jJ=function(a){var b=null;E.na(a,function(a,c){return c.p&&null===c.p.he?(b=c,!0):!1});return b};a.fb=function(a,
b,c){a=h(a,b);for(b=0;b<a.length;b++)if(a[b].type==c)return a[b];return null};a.Nu=function(a,b,c){a=h(a,b);b=[];for(var d=0;d<a.length;d++)a[d].type==c&&b.push(a[d]);return b};a.fR=H;a.hR=w;a.cK=h;a.gK=u;a.$b=function(a,b){var c=null;E.na(a,function(a,d){return d.type==b?(c=d,!0):!1});return c};a.BI=function(a){var b="digraph scenegraph {\n",b=b+"    ",b=b+'size="11.7,16.5";\n',b=b+"    ",b=b+'ratio="fill";\n',b=b+"    ",b=b+'node [shape=box margin="0.25,0.055"];\n',c=P(a);E.na(a,function(a,d){var e=
b+="    ",f=G.Hw(d);if(d.p){for(var f=f+"\\n",h=0;h<c.length;h+=2){var k=d.p.Zb;c[h]==k&&(f=J.Tl(k)?f+("CR"+c[h+1]+" "):f+("C"+c[h+1]+" "))}for(h=0;h<c.length;h+=2)k=d.p.ee,c[h]==k&&(f=J.Tl(k)?f+("DR"+c[h+1]):f+("D"+c[h+1]))}d.Ja.length&&(f+="\\n-----\\n");for(h=0;h<d.Ja.length;h++)f+=p(d.Ja[h],c);h=d.type==G.kl?"dotted":d.enqueue?"solid":"dashed";b=e+(String(a)+' [label="'+f+'" color="black" style="'+(h+",bold")+'"];\n')});E.ig(a,function(a,d,e){b+="    ";b+=String(a)+" -> "+String(d)+' [label="'+
p(e,c)+'" style="'+(e.hc?"solid":"dotted")+'"];\n'});return b+="}"};a.NH=function(a){a=E.YN(a);for(var b=[],c=0;c<a.length;c++){var d=a[c];d.enqueue&&b.push(d)}return b}};b4w.module.__subscene=function(a,q){function e(a,b){a.Pr=b;a.hv=new Float32Array(3*b);a.xr=new Float32Array(3*b);a.wr=new Float32Array(3*b);a.iv=new Float32Array(0==b%2?2*b:2*b+2)}function c(a){a={type:a,ub:"",mb:!1,mB:!1,Dt:!1,Kr:!1,Sn:0,Ie:0,Uj:[],debug_view_mode:0,debug_colors_seed:0,fz:1,uu:!1,time:0,p:null,Tj:null,Qn:[],Ea:[],Ja:[],Sg:[],Xh:new Float32Array(3),wd:new Float32Array(3),Kd:new Float32Array(4),hf:new Float32Array(4),Id:new Float32Array(16),fC:0,qh:0,Pr:0,hv:null,xr:null,wr:null,iv:null,
Pe:new Float32Array(3),cf:new Float32Array(3),gC:new Float32Array(4),yC:new Float32Array([0,0,0]),Iw:new Float32Array(3),zC:new Float32Array(4),eC:new Float32Array(3),Lo:0,wu:0,yo:!1,Eh:new Float32Array(3),Xg:!1,Ot:0,Yg:null,mx:0,nx:0,oj:0,oc:null,Hf:!1,Ay:0,By:new Float32Array(2),zy:0,procedural_skydome:!1,use_as_environment_lighting:!1,mie_brightness:0,rayleigh_brightness:0,spot_brightness:0,mie_strength:0,rayleigh_strength:0,scatter_strength:0,mie_collection_power:0,rayleigh_collection_power:0,
mie_distribution:0,um:new Float32Array(3),ssao_hemisphere:0,ssao_blur_depth:0,ssao_blur_discard_value:0,ym:0,xm:0,wm:0,pC:0,ssao_only:0,ssao_white:0,brightness:0,contrast:0,exposure:0,saturation:0,god_rays_intensity:0,$l:0,gs:0,Cm:0,ju:0,self_shadow_polygon_offset:0,self_shadow_normal_offset:0,Ps:null,Os:null,ix:null,Dk:null,Sb:!1,Hz:"",bloom_key:0,bloom_blur:0,bloom_edge_lum:0,Ht:0,Bu:0,mb_decay_threshold:0,mb_factor:0,VA:0,as:"",Py:"",LK:new Float32Array(2),small_glow_mask_width:0,large_glow_mask_width:0,
small_glow_mask_coeff:0,large_glow_mask_coeff:0,Qw:new Float32Array(2),ib:new Float32Array(2),Vj:new Float32Array(4),chromatic_aberration_coefs:new Float32Array(4),enable_hmd_stereo:!1,fg:0,Dv:!0,vb:!0,enqueue:!0,$a:!0,eb:!0,nd:!0,wa:!0,Af:1};a.ib[0]=1;a.ib[1]=1;a.Vj[2]=.5;a.Vj[3]=.5;return a}function b(a,b){return a==b?0:a>b?1:-1}function n(a,c){return-b(a.Ef,c.Ef)||b(a.sf,c.sf)||b(a.Qa.fp,c.Qa.fp)}var f=q("__camera"),t=q("__config"),g=q("__util"),m=t.ec,v=t.Kk;a.sb=0;a.gc=1;a.Be=2;a.Wc=3;a.Jc=4;
a.Ae=5;a.Vd=6;a.qd=7;a.Ac=8;a.Ce=9;a.ah=10;a.Db=11;a.Xm=12;a.$m=13;a.jl=14;a.Ud=15;a.$g=16;a.ze=17;a.fl=18;a.yx=19;a.Np=20;a.tt=21;a.sx=22;a.bn=23;a.Lp=24;a.rt=25;a.Mp=26;a.gt=27;a.Zh=28;a.ft=29;a.Zm=30;a.mg=31;a.hl=32;a.Yh=33;a.Ip=34;a.$h=35;a.ht=36;a.ai=37;a.LUMINANCE=38;a.wD=39;a.Jp=40;a.Wm=41;a.oF=42;a.kl=43;a.an=44;a.lI=function(a,b,k,m){var n=c(8);n.ju=a;n.self_shadow_polygon_offset=k.self_shadow_polygon_offset;n.fg=b;switch(k.Rf[b]){case "SPOT":case "POINT":n.p=f.Dc(f.hd);a=g.rad_to_deg(k.nC[b]);
f.rs(n.p,a,k.Dn[b],k.Cn[b]);break;default:n.p=f.Dc(f.bi)}e(n,m);return n};a.lH=function(a){var b=a.p;a.p=null;var c=g.L(a);a.p=b;c.p=f.ic(b,!0);return c};a.eI=function(){var a=c(10);a.p=f.Dc(f.bh);return a};a.Xc=function(a){var b=c(11);b.$a=!1;b.eb=!1;b.nd=!1;b.Sb=!0;b.p=f.Dc(f.Kc);b.as=a;switch(a){case "NONE":b.ib[0]=1;b.ib[1]=1;break;case "GRAYSCALE":b.ib[0]=1;b.ib[1]=1;break;case "X_BLUR":b.ib[0]=1;b.ib[1]=0;break;case "Y_BLUR":b.ib[0]=0;b.ib[1]=1;break;case "X_GLOW_BLUR":b.ib[0]=1;b.ib[1]=0;break;
case "Y_GLOW_BLUR":b.ib[0]=0;b.ib[1]=1;break;case "X_DOF_BLUR":b.ib[0]=1;b.ib[1]=1;break;case "Y_DOF_BLUR":b.ib[0]=1;b.ib[1]=1;break;case "X_ALPHA_BLUR":b.ib[0]=1;b.ib[1]=0;b.Af=3;break;case "Y_ALPHA_BLUR":b.ib[0]=0;b.ib[1]=1;b.Af=3;break;case "X_EXTEND":b.ib[0]=1;b.ib[1]=0;break;case "Y_EXTEND":b.ib[0]=0;b.ib[1]=1;break;default:g.r("Wrong postprocessing effect: "+a)}return b};a.Zy=function(a){var b=c(12);b.$a=!1;b.eb=!1;b.nd=!1;b.p=f.Dc(f.Kc);b.as=a;b.Sb=!0;switch(a){case "X_BLUR":b.ib[0]=1;b.ib[1]=
0;break;case "Y_BLUR":b.ib[0]=0;b.ib[1]=1;break;default:g.r("Wrong postprocessing effect for bloom blur: "+a)}return b};a.cI=function(a,b){var e=c(13);e.$a=!1;e.eb=!1;e.nd=!1;e.small_glow_mask_coeff=b.vi.small_glow_mask_coeff;e.large_glow_mask_coeff=b.vi.large_glow_mask_coeff;e.small_glow_mask_width=b.vi.small_glow_mask_width;e.large_glow_mask_width=b.vi.large_glow_mask_width;e.p=a;e.Sb=!0;return e};a.Sj=function(a,b,f,m,n,t,v,q,y){var A=c(a);0==a?(A.$a=!0,A.eb=f,A.mb=!1):1==a?(A.$a=!1,A.eb=!1,A.mb=
!0):2==a?(A.$a=!1,A.eb=!0,A.mb=!0):3==a||4==a?(A.$a=!0,A.eb=!0,A.mb=!1):5==a||6==a?(A.$a=!1,A.eb=!1,A.mb=!0):7==a?(A.$a=!0,A.eb=!1,A.mb=!0):g.r("wrong main subscene type");A.mb&&q&&(A.self_shadow_normal_offset=q.self_shadow_normal_offset);A.p=b;if(a=v.xw)A.gC.set([a.sG,a.wK,a.sP,a.rP]),A.eC.set(a.color),A.fC=a.jb;A.Pe.set(v.Pe);A.cf.set(v.cf);A.qh=v.qh;A.Kd=t.Kd;A.hf=t.hf;m&&(A.oc=m,m.Kd&&(A.Yg=new Float32Array(m.Kd)),A.mx=m.waves_height,A.nx=m.waves_length,A.oj=m.oj,m.Hf&&y&&(A.Hf=!0,A.Ay=m.LG,A.zy=
m.KG,A.By.set(m.MG)));e(A,n);return A};a.sq=function(){var a=c(14);a.Sb=!0;a.p=f.Dc(f.Kc);return a};a.$y=function(a,b,f){var g=c(15);b&&(g.type=16,g.$a=!1,g.eb=!0);g.enqueue=!1;g.p=a;e(g,f);return g};a.aI=function(a){var b=c(17);b.vb=!1;b.$a=!1;b.eb=!1;b.p=a;return b};a.XH=function(a){var b=c(18);b.$a=!0;b.eb=!1;b.p=a;return b};a.mI=function(a,b){var f=c(9);f.p=a;e(f,b);return f};a.bI=function(a){var b=c(19);b.$a=!1;b.eb=!1;b.p=a;b.Sb=!0;return b};a.oI=function(a,b,e){var f=c(20);f.$a=!1;f.eb=!1;
f.nd=!1;f.p=a;f.Kd=b.Kd;f.Yg=new Float32Array(b.Kd);f.ym=e.radius_increase;f.ssao_hemisphere=e.uK;f.xm=e.influence;f.wm=e.dist_factor;f.pC=e.AM;f.Sb=!0;return f};a.pI=function(a,b){var e=c(21);e.$a=!1;e.eb=!1;e.nd=!1;e.p=a;e.ssao_blur_depth=b.vG;e.ssao_blur_discard_value=b.py;e.Sb=!0;return e};a.WH=function(a){var b=c(22);b.$a=!1;b.eb=!1;b.nd=!1;b.Af=1/a.re;b.Hz=a.Qx;b.p=f.Dc(f.Kc);b.Sb=!0;return b};a.iu=function(a,b){var e=c(a);e.$a=23==a||24==a?!0:!1;e.eb=!1;e.nd=!1;e.Af=1/b.re;e.p=f.Dc(f.Kc);23==
a&&(e.MK=new Float32Array(4));e.Sb=!0;return e};a.$H=function(a,b,e,g){var m=c(27);m.$a=!1;m.eb=!1;m.nd=!1;m.p=f.Dc(f.Kc);m.brightness=a;m.contrast=b;m.exposure=e;m.saturation=g;m.Sb=!0;return m};a.hI=function(a,b){var e=c(28);e.$a=!1;e.eb=!1;e.nd=!1;e.p=f.Dc(f.Kc);e.Dt=!0;e.mb_decay_threshold=a;e.mb_factor=b;e.Sb=!0;return e};a.fu=function(a,b){var e=c(29);e.$a=!1;e.eb=!1;e.nd=!1;e.p=a;e.Af=e.p.dof_power;e.Py=b;e.Sb=!0;return e};a.az=function(a){var b=c(30);b.$a=!1;b.eb=!1;b.nd=!1;b.p=a;b.Af=b.p.dof_power;
b.Sb=!0;return b};a.jI=function(a,b){var f=c(31);f.nd=!1;f.p=a;e(f,b);return f};a.iI=function(a){var b=c(32);m.outlining_overview_mode?b.Eh.set(m.Eh):b.Eh.set(a.Eh);b.Lo=a.Lo;b.Bu=5;b.Ht=3;b.nd=!1;b.p=f.Dc(f.Kc);b.Sb=!0;return b};a.hu=function(a,b,f,g,m,n,t){var v=c(33);v.$a=!1;v.eb=!1;v.nd=!1;v.Pe=new Float32Array([1,1,1]);v.cf=new Float32Array([1,1,1]);v.qh=1;v.mB=g;v.Xg=b;v.gs=m;v.$l=f;v.Cm=t;v.p=a;e(v,n);return v};a.dI=function(a,b){var g=c(34);g.$a=!1;g.eb=!1;g.nd=!1;g.p=f.Dc(f.Kc);g.god_rays_intensity=
a;e(g,b);g.Sb=!0;return g};a.nI=function(a,b){var k=c(35);k.enqueue=!1;k.$a=!1;k.eb=!1;k.nd=!1;var m=f.Dc(f.Kc);m.width=v.xl;m.height=v.xl;k.p=m;k.Tj=g.AJ();e(k,a);k.Pe=new Float32Array([1,1,1]);k.cf=new Float32Array([1,1,1]);k.qh=1;k.um.set(b.um);k.procedural_skydome=b.procedural_skydome;k.use_as_environment_lighting=b.use_as_environment_lighting;k.rayleigh_brightness=b.rayleigh_brightness;k.mie_brightness=b.mie_brightness;k.spot_brightness=b.spot_brightness;k.scatter_strength=b.scatter_strength;
k.rayleigh_strength=b.rayleigh_strength;k.mie_strength=b.mie_strength;k.rayleigh_collection_power=b.rayleigh_collection_power;k.mie_collection_power=b.mie_collection_power;k.mie_distribution=b.mie_distribution;return k};a.gu=function(){var a=c(36);a.$a=!1;a.eb=!1;a.p=f.Dc(f.Kc);a.Sb=!0;return a};a.qI=function(a){var b=c(37);b.$a=!1;b.eb=!1;b.ub=a?"HMD":"ANAGLYPH";b.p=f.Dc(f.Kc);b.Sb=!0;return b};a.fI=function(){var a=c(38);a.$a=!1;a.eb=!1;a.p=f.Dc(f.Kc);a.Sb=!0;return a};a.YH=function(){var a=c(39);
a.$a=!1;a.eb=!1;a.p=f.Dc(f.Kc);a.Sb=!0;return a};a.gI=function(a,b,f,g){var m=c(40);m.$a=!1;m.eb=!1;m.bloom_key=a;m.bloom_edge_lum=b;m.p=g;e(m,f);m.Sb=!0;return m};a.ZH=function(a){var b=c(41);b.$a=!1;b.eb=!1;b.p=f.Dc(f.Kc);b.bloom_blur=a;b.Sb=!0;return b};a.wQ=function(a){var b=c(42);b.$a=!1;b.eb=!1;b.p=a;b.Sb=!0;return b};a.bz=function(){var a=c(43);a.enqueue=!1;return a};a.kI=function(){var a=c(44);a.Sb=!0;return a};a.Hw=function(a){switch(a.type){case 0:return"MAIN OPAQUE";case 1:return"MAIN BLEND";
case 2:return"MAIN XRAY";case 3:return"MAIN PLANE REFLECT";case 4:return"MAIN CUBE REFLECT";case 5:return"MAIN PLANE REFLECT BLEND";case 6:return"MAIN CUBE REFLECT BLEND";case 7:return"MAIN GLOW";case 8:return"SHADOW CAST";case 9:return"SHADOW RECEIVE";case 10:return"GRASS MAP";case 11:return"POSTPROCESSING ("+a.as.replace(/_/g," ")+")";case 12:return"BLOOM BLUR";case 13:return"GLOW COMBINE";case 14:return"RESOLVE";case 15:return"COLOR PICKING";case 16:return"COLOR PICKING XRAY";case 17:return"DEBUG VIEW";
case 18:return"ANCHOR VISIBILITY";case 19:return"DEPTH PACK";case 20:return"SSAO";case 21:return"SSAO BLUR";case 22:return"ANTIALIASING";case 23:return"SMAA BLENDING WEIGHT CALCULATION";case 24:return"SMAA EDGE DETECTION";case 25:return"SMAA RESOLVE";case 26:return"SMAA NEIGHBORHOOD BLENDING";case 27:return"COMPOSITING";case 28:return"MOTION BLUR";case 29:return"COC";case 30:return"DOF";case 31:return"OUTLINE MASK";case 32:return"OUTLINE";case 33:return"GOD RAYS";case 34:return"GOD RAYS COMBINE";
case 35:return"SKY";case 36:return"COPY";case 37:return"STEREO";case 38:return"LUMINANCE";case 39:return"AVERAGE LUMINANCE";case 40:return"LUMINANCE TRUNCED";case 41:return"BLOOM";case 42:return"VELOCITY";case 44:return"PERFORMANCE";case 43:return"SINK";default:return"UNKNOWN"}};a.rc=function(a,b){var c=b.pa,e=c.Qa;c.ss=!1;for(var f=0;f<a.Ea.length;f++){var g=a.Ea[f].ka,m=g.indexOf(b);-1!=m&&(g.splice(m,1),g.length||a.Ea.splice(f,1))}f=a.mb?c.sf:0;a:{g=a.Ea;for(m=0;m<g.length;m++){var n=g[m];if(n.Qa==
e&&f==n.sf){g=n;break a}}g=null}g?g.ka.push(b):(a.Ea.push({Qa:e,ka:[b],Ef:c.Ef,sf:f,vb:!0}),a.Dv=!0)};a.Cg=function(a,b){return{vb:!0,vu:[!0,!0,!0,!0,!0,!0],Ig:b,pa:a}};a.zN=function(a){a.Ea.sort(n);a.Dv=!1}};b4w.module.__texcomp=function(a,q){function e(a,b,c,e){var t=new Int32Array(c,0,31),q,F,D,y,A,H;if(542327876!=t[0])return f.error("Invalid magic number in DDS header"),0;if(!t[20]&4)return f.error("Unsupported format, must contain a FourCC code"),0;q=t[21];switch(q){case g:F=8;D=b?b.COMPRESSED_RGB_S3TC_DXT1_EXT:null;break;case m:F=16;D=b?b.COMPRESSED_RGBA_S3TC_DXT3_EXT:null;break;case v:F=16;D=b?b.COMPRESSED_RGBA_S3TC_DXT5_EXT:null;break;default:return f.error("Unsupported FourCC code:",n(q)),null}H=
1;t[2]&131072&&!1!==e&&(H=Math.max(1,t[7]));y=t[4];A=t[3];t=t[1]+4;if(b)for(q=0;q<H;++q)e=Math.max(4,y)/4*Math.max(4,A)/4*F,b=new Uint8Array(c,t,e),a.compressedTexImage2D(a.TEXTURE_2D,q,D,y,A,0,b),t+=e,y=Math.max(.5*y,1),A=Math.max(.5*A,1);else if(q==g){Math.max(4,y);Math.max(4,A);c=b=new Uint16Array(c);F=t/2;D=y;var w=A,t=new Uint16Array(4);b=new Uint16Array(D*w);for(var h=0,u=0,P=u=h=q=0,p=0,z=0,l=0,M=D/4,w=w/4,E=0;E<w;E++)for(var W=0;W<M;W++)q=F+4*(E*M+W),t[0]=c[q],t[1]=c[q+1],h=t[0]&31,u=t[0]&
2016,P=t[0]&63488,p=t[1]&31,z=t[1]&2016,l=t[1]&63488,t[2]=5*h+3*p>>3|5*u+3*z>>3&2016|5*P+3*l>>3&63488,t[3]=5*p+3*h>>3|5*z+3*u>>3&2016|5*l+3*P>>3&63488,h=c[q+2],u=4*E*D+4*W,b[u]=t[h&3],b[u+1]=t[h>>2&3],b[u+2]=t[h>>4&3],b[u+3]=t[h>>6&3],u+=D,b[u]=t[h>>8&3],b[u+1]=t[h>>10&3],b[u+2]=t[h>>12&3],b[u+3]=t[h>>14],h=c[q+3],u+=D,b[u]=t[h&3],b[u+1]=t[h>>2&3],b[u+2]=t[h>>4&3],b[u+3]=t[h>>6&3],u+=D,b[u]=t[h>>8&3],b[u+1]=t[h>>10&3],b[u+2]=t[h>>12&3],b[u+3]=t[h>>14];a.texImage2D(a.TEXTURE_2D,0,a.RGB,y,A,0,a.RGB,
a.UNSIGNED_SHORT_5_6_5,b);e&&a.generateMipmap(a.TEXTURE_2D)}else return f.error("No manual decoder for",n(q),"and no native support"),0;return H}function c(a,b,c,f,g){var m=new XMLHttpRequest;m.open("GET",c,!0);m.responseType="arraybuffer";m.onload=function(){if(200==m.status){a.bindTexture(a.TEXTURE_2D,f);var c=e(a,b,m.response,!0);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,1<c?a.LINEAR_MIPMAP_LINEAR:a.LINEAR)}g&&g(f)};m.send(null)}
function b(a){return a.charCodeAt(0)+(a.charCodeAt(1)<<8)+(a.charCodeAt(2)<<16)+(a.charCodeAt(3)<<24)}function n(a){return String.fromCharCode(a&255,a>>8&255,a>>16&255,a>>24&255)}var f=q("__print"),t=q("__util"),g=b("DXT1"),m=b("DXT3"),v=b("DXT5");a.LO=e;a.MO=function(a,b,c){var e=new Uint32Array(c,0,13);if(55727696==e[0]){var f=e[7],g=e[6],m=e[11],n=52+e[12];switch(e[2]){case 0:var v=2,q=1;break;case 1:v=2;q=3;break;case 2:v=4;q=0;break;case 3:v=4;q=2;break;default:t.r("Unsupported PVR V3 format.")}}else if(559044176==
e[11]){f=e[2];g=e[1];m=e[3];n=e[0];m++;var H=e[4]&255,e=0<e[10];25==H?(v=4,q=e?2:0):24==H?(v=2,q=e?3:1):t.r("Unsupported PVR V2 format.")}else t.r("Unsupported PVR version.");H=2==v?8:4;e=4;switch(q){case 0:var w=b.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;break;case 1:w=b.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;break;case 2:w=b.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;break;case 3:w=b.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}b=H*e*v/8;for(v=0;v<m;v++){var q=Math.max(f>>v,1),h=Math.max(g>>v,1),u=q/H,P=h/e;2>u&&(u=2);2>P&&(P=2);u=
u*P*b;P=new Uint8Array(c,n,u);a.compressedTexImage2D(a.TEXTURE_2D,v,w,q,h,0,P);n+=u}};a.hA=function(a,b){switch(b){case "dds":var c=new Int32Array(a,0,31);return{width:c[4],height:c[3]};case "pvr":c=new Uint32Array(a,0,13);if(55727696==c[0])var e=c[7],c=c[6];else e=c[2],c=c[1];return{width:e,height:c}}};a.RJ=function(a,b){var c=1;if("dds"==b){var e=new Int32Array(a,0,31),t=e[21];switch(t){case g:c=6;break;case m:case v:c=4;break;default:f.error("Unsupported FourCC code:",n(t))}}else if("pvr"==b)if(e=
new Uint32Array(a,0,13),55727696==e[0])switch(e[2]){case 0:c=12;break;case 1:c=16;break;case 2:c=6;break;case 3:c=8}else t=e[4]&255,e=0<e[10],25==t?c=e?8:6:24==t&&(c=e?16:12);return c};a.wR=function(a,b,e,f){var g=a.createTexture();c(a,b,e,g,f);return g}};b4w.module.__textures=function(a,q){function e(){return{name:"",type:0,source:"",jp:"",width:0,height:0,Ln:1,zw:!1,nl:!0,Kh:1024,Yj:!1,Hd:null,Wa:0,Za:null,Td:null,tk:!1,jg:-1,ya:null,Hi:0,Pf:0,ma:0,wb:0,ti:0,qf:!1,dg:1,Rc:null,cp:0,bp:0,Jh:-1,ep:!1,$i:-1,Tm:!1,fx:!1,Th:!1,Pm:!1,repeat:!0,md:!0}}function c(c,d,f,h){var g=c.type,l=new Uint8Array([204,204,204,255]),k=e();switch(g){case "DATA_TEX2D":case "IMAGE":var p=I.createTexture(),m=I.TEXTURE_2D;I.bindTexture(m,p);I.texImage2D(m,0,I.RGBA,1,1,0,
I.RGBA,I.UNSIGNED_BYTE,l);c.image&&("Non-Color"==c.image.colorspace_settings_name&&(k.zw=!0),"MOVIE"==c.image.source&&(k.tk=!0,k.ma=c.frame_start,k.wb=c.frame_offset,k.ti=c.frame_duration,k.fx=c.use_auto_refresh,k.Th=c.use_cyclic,k.Hi=c.movie_length,k.Pm=c.b4w_nla_video,0!=k.wb&&U.warn('Frame offset for texture "'+c.name+'" has a nonzero value. Can lead to undefined behaviour for mobile devices.')));break;case "NONE":p=I.createTexture();m=I.TEXTURE_2D;I.bindTexture(m,p);if("NONE"==c.b4w_source_type)return null;
if("SCENE"==c.b4w_source_type)if(c.b4w_source_id&&(f=R.keysearch("name",c.b4w_source_id,f)))k.Kh=c.b4w_source_size,f.df=f.df||[],f.df.push(c),I.texImage2D(m,0,I.RGBA,1,1,0,I.RGBA,I.UNSIGNED_BYTE,l);else return null;break;case "ENVIRONMENT_MAP":p=I.createTexture();m=I.TEXTURE_CUBE_MAP;I.bindTexture(m,p);f="POSITIVE_X NEGATIVE_X POSITIVE_Y NEGATIVE_Y POSITIVE_Z NEGATIVE_Z".split(" ");for(var u=0;6>u;u++)I.texImage2D(I["TEXTURE_CUBE_MAP_"+f[u]],0,I.RGBA,1,1,0,I.RGBA,I.UNSIGNED_BYTE,l);break;case "BLEND":return null;
case "NODE_TEX":p=I.createTexture();m=I.TEXTURE_2D;I.bindTexture(m,p);I.texImage2D(m,0,I.RGBA,1,1,0,I.RGBA,I.UNSIGNED_BYTE,l);break;default:return U.error('texture "'+c.name+'" has unsupported type "'+g+'"'),null}"NONE"==g&&(!c.b4w_enable_canvas_mipmapping||"CANVAS"!=c.b4w_source_type)||"DATA_TEX2D"==g||"IMAGE"==g&&"MOVIE"==c.image.source||"NODE_TEX"==g?I.texParameteri(m,I.TEXTURE_MIN_FILTER,I.LINEAR):I.texParameteri(m,I.TEXTURE_MIN_FILTER,Ea[N.Im]);I.texParameteri(m,I.TEXTURE_MAG_FILTER,I.LINEAR);
l=m;f=c.b4w_anisotropic_filtering;"DEFAULT"===f&&(f=d);"OFF"!==f&&N.anisotropic_filtering&&(d=O.MJ())&&(f=parseFloat(f.split("x")[0]),I.texParameterf(l,d.TEXTURE_MAX_ANISOTROPY_EXT,f));"REPEAT"!=c.extension||c.b4w_shore_dist_map?(k.repeat=!1,I.texParameteri(m,I.TEXTURE_WRAP_S,I.CLAMP_TO_EDGE),I.texParameteri(m,I.TEXTURE_WRAP_T,I.CLAMP_TO_EDGE)):(I.texParameteri(m,I.TEXTURE_WRAP_S,I.REPEAT),I.texParameteri(m,I.TEXTURE_WRAP_T,I.REPEAT));k.type=a.sj;k.width=1;k.height=1;k.Za=p;k.Wa=m;"CANVAS"==c.b4w_source_type&&
"NONE"==g?(g=c.b4w_source_id,p=c.b4w_source_size,k.Yj=c.b4w_enable_canvas_mipmapping,k.jp=g,k.source="CANVAS",m=document.createElement("canvas"),m.width=p,m.height=p,k.Hd=m.getContext("2d"),h in oa||(oa[h]={}),oa[h][g]=k,b(k)):"SCENE"==c.b4w_source_type&&"NONE"==g?(k.jp=c.b4w_source_id,k.source="SCENE"):(k.source=g,I.generateMipmap(m),I.bindTexture(m,null));k.name=c.name;return c.q=k}function b(a){"CANVAS"!=a.source&&R.r("Wrong texture");var b=a.Wa;I.bindTexture(b,a.Za);var c=r(a),d=C(a),e=B(a),f=
a.Hd.canvas;I.pixelStorei(I.UNPACK_FLIP_Y_WEBGL,!0);I.texImage2D(b,0,d,c,e,f);I.pixelStorei(I.UNPACK_FLIP_Y_WEBGL,!1);a.Yj&&I.generateMipmap(b);I.bindTexture(b,null);a.width=f.width;a.height=f.height}function n(a){var b=a.Wa;I.bindTexture(b,a.Za);I.pixelStorei(I.UNPACK_FLIP_Y_WEBGL,!0);4!=a.ya.length?a.qf?g(a,a.ya,a.width*a.dg,a.height*a.dg,!1):I.texImage2D(b,0,I.RGBA,I.RGBA,I.UNSIGNED_BYTE,a.ya):I.texImage2D(b,0,I.RGBA,1,1,0,I.RGBA,I.UNSIGNED_BYTE,a.ya);I.bindTexture(b,null)}function f(a){var b=
a.Wa;I.bindTexture(b,a.Za);I.pixelStorei(I.UNPACK_FLIP_Y_WEBGL,!0);a.qf?g(a,a.Rc[a.Jh],a.width*a.dg,a.height*a.dg,!1):I.texImage2D(b,0,I.RGBA,I.RGBA,I.UNSIGNED_BYTE,a.Rc[a.Jh]);I.bindTexture(b,null)}function t(){na||(na=document.createElement("canvas"));return na}function g(a,b,c,d,e){e||(v(I.TEXTURE_2D),I.texImage2D(I.TEXTURE_2D,0,I.RGBA,I.RGBA,I.UNSIGNED_BYTE,b));I.bindTexture(I.TEXTURE_2D,null);ca.NI(a,c,d,sa,ra)}function m(a,b,c,d){for(var e=0;6>e;e++){var f=d[e],h=t();h.width=c;h.height=c;var g=
h.getContext("2d");"POSITIVE_Y"==f[0]||"NEGATIVE_Y"==f[0]?(g.translate(0,c),g.scale(1,-1)):(g.translate(c,0),g.scale(-1,1));g.drawImage(a,f[1]*b,f[2]*b,b,b,0,0,c,c);I.texImage2D(I["TEXTURE_CUBE_MAP_"+f[0]],0,I.RGBA,I.RGBA,I.UNSIGNED_BYTE,h)}}function v(a){sa||(sa=I.createFramebuffer());I.bindTexture(a,null);ra||(ra=I.createTexture());I.bindTexture(a,ra);I.texParameteri(a,I.TEXTURE_WRAP_S,I.CLAMP_TO_EDGE);I.texParameteri(a,I.TEXTURE_WRAP_T,I.CLAMP_TO_EDGE);I.texParameteri(a,I.TEXTURE_MAG_FILTER,I.LINEAR);
I.texParameteri(a,I.TEXTURE_MIN_FILTER,I.LINEAR)}function x(a,b,c,e,f){var h=a.source,l=a.Za,p=a.Wa,u=1,n=1;I.bindTexture(p,l);if(4==b.length){var r=!0;b=new Uint8Array([255*b[0],255*b[1],255*b[2],255*b[3]])}if("IMAGE"==h)if(r)I.texImage2D(p,0,I.RGBA,1,1,0,I.RGBA,I.UNSIGNED_BYTE,b),a.width=1,a.height=1;else if(c){n=Z.hA(b,c);r=R.Bn(n.width)||R.Bn(n.height);if(n.width>ha.dc||n.height>ha.dc){U.error('Texture "'+e+'" has unsupported size: '+n.width+"x"+n.height+". Max available: "+ha.dc+"x"+ha.dc+".");
return}u=n.width;n=n.height;if(r||"pvr"==c)a.qf=!0,v(p),u=k(u*a.dg),n=k(n*a.dg);"dds"==c?Z.LO(I,O.aA(),b,!0):"pvr"==c&&Z.MO(I,O.$z(),b);a.qf&&(g(a,null,u,n,!0),I.bindTexture(p,l),I.generateMipmap(p));a.width=u;a.height=n;a.Ln=Z.RJ(b,c)}else{I.pixelStorei(I.UNPACK_FLIP_Y_WEBGL,!0);a.tk?N.dp?(u=b[0].width,n=b[0].height):(u=b.videoWidth,n=b.videoHeight):(u=b.width,n=b.height);a.width=u;a.height=n;if(u>ha.dc||u>ha.dc)U.warn('Texture "'+e+'" has unsupported size: '+u+"x"+n+". Max available: "+ha.dc+"x"+
ha.dc+". Reduced image size will be used."),a.dg=Math.min(ha.dc/u,ha.dc/n),a.qf=!0;a.tk&&(N.dp?(f in pa||(pa[f]={}),pa[f][a.name]=a,a.Rc=b,a.cp=b.length,a.Pf=a.bp*a.Hi/b.length,b=b[0]):(f in pa||(pa[f]={}),pa[f][a.name]=a,a.ya=b,a.ya.loop=a.Th,a.Pf=b.duration?a.Hi/b.duration:ga.Pc(),qa.oz||(b.playbackRate=ga.Pc()/a.Pf,qa.My&&2<b.playbackRate&&(b.playbackRate=2)),d(a)));u=k(a.width*a.dg);n=k(a.height*a.dg);a.qf?(e=t(),c=e.getContext("2d"),e.width=u,e.height=n,c.drawImage(b,0,0,a.width,a.height,0,0,
u,n),I.texImage2D(p,0,I.RGBA,I.RGBA,I.UNSIGNED_BYTE,e)):R.Bn(a.width)||R.Bn(a.height)?(g(a,b,u,n,!1),a.qf=!0):I.texImage2D(p,0,I.RGBA,I.RGBA,I.UNSIGNED_BYTE,b);l=a.Za;I.bindTexture(p,l);a.tk||I.generateMipmap(p);I.bindTexture(p,null);a.width=u;a.height=n}else if("ENVIRONMENT_MAP"==h)if(u=[["POSITIVE_X",2,0],["NEGATIVE_X",0,0],["POSITIVE_Y",1,1],["NEGATIVE_Y",0,1],["POSITIVE_Z",1,0],["NEGATIVE_Z",2,1]],r){for(e=0;6>e;e++)I.texImage2D(I["TEXTURE_CUBE_MAP_"+u[e][0]],0,I.RGBA,1,1,0,I.RGBA,I.UNSIGNED_BYTE,
b);a.width=3;a.height=2}else{I.pixelStorei(I.UNPACK_FLIP_Y_WEBGL,!1);if(b.width%3||b.height%2){U.error('Cubemap texture "'+e+'" has unsupported size: '+b.width+"x"+b.height+". The width must be multiple of three and the height - multiple of two.");return}n=b.width/3;if(n>ha.Fi)U.warn('Cubemap texture "'+e+'" has unsupported size: '+b.width+"x"+b.height+". Max available: "+3*ha.Fi+"x"+2*ha.Fi+". Reduced image size will be used."),e=k(ha.Fi/n*n),a.qf=!0;else if(e=k(n),3*e>ha.dc||2*e>ha.dc)a.qf=!0;if(a.qf||
N.gw)m(b,n,e,u);else{l=b;c=e;v(I.TEXTURE_2D);I.texImage2D(I.TEXTURE_2D,0,I.RGBA,I.RGBA,I.UNSIGNED_BYTE,l);I.bindTexture(I.TEXTURE_2D,null);for(l=0;6>l;l++)I.texImage2D(I.TEXTURE_CUBE_MAP_POSITIVE_X+l,0,I.RGBA,c,c,0,I.RGBA,I.UNSIGNED_BYTE,null);I.bindTexture(a.Wa,null);I.bindFramebuffer(I.FRAMEBUFFER,sa);for(l=0;6>l;l++)ca.MI(a,I.TEXTURE_CUBE_MAP_POSITIVE_X+l,c,n,ra,l);I.bindFramebuffer(I.FRAMEBUFFER,null);I.bindTexture(a.Wa,a.Za);I.texParameteri(a.Wa,I.TEXTURE_MIN_FILTER,Ea[N.Im]);I.texParameteri(a.Wa,
I.TEXTURE_MAG_FILTER,I.LINEAR)}L.WG()&&(U.warn("Firefox detected, setting max cubemap size to 256, use canvas for resizing."),m(b,n,G.Ix,u));a.width=3*e;a.height=2*e;I.generateMipmap(p)}else if("DATA_TEX2D"==h||"NODE_TEX"==h)I.texImage2D(p,0,I.RGBA,b.width,b.height,0,I.RGBA,I.UNSIGNED_BYTE,b.data),a.width=b.width,a.height=b.height;I.bindTexture(p,null)}function d(a){a.ya.ER=function(){n(a)}}function k(a){return R.Bn(a)?R.clamp(Math.pow(2,parseInt(a).toString(2).length),2,ha.dc):a}function r(b){var c;
switch(b.type){case a.sj:c=I.RGBA;break;case a.Sp:c=I.RGB;break;case a.cn:c=I.RGBA;break;case a.dn:c=I.RGB;break;case a.ll:c=I.DEPTH_COMPONENT;break;default:R.r("Wrong texture type")}return c}function C(b){var c;switch(b.type){case a.sj:c=N.Vb?I.RGBA8:I.RGBA;break;case a.Sp:c=N.Vb?I.RGB8:I.RGB;break;case a.cn:c=N.Vb?I.RGBA8:I.RGBA;break;case a.dn:c=N.Vb?I.RGB8:I.RGB;break;case a.ll:c=N.Vb?I.DEPTH_COMPONENT24:I.DEPTH_COMPONENT;break;default:R.r("Wrong texture type")}return c}function B(b){var c;switch(b.type){case a.sj:c=
I.UNSIGNED_BYTE;break;case a.Sp:c=I.UNSIGNED_BYTE;break;case a.cn:c=I.FLOAT;break;case a.dn:c=I.FLOAT;break;case a.ll:c=I.UNSIGNED_INT;break;default:R.r("Wrong texture type")}return c}function F(a){return a&&a.name&&a.Td?!0:!1}function D(a,b){var d=null;switch(a){case "SSAO_TEXTURE":d={name:"special_ssao_texture",type:"DATA_TEX2D",extension:"REPEAT",b4w_anisotropic_filtering:"OFF"};c(d,null,b,0);d.image={filepath:null};break;case "NODE_TEX":d={name:"",type:"NODE_TEX",extension:"CLIP",b4w_anisotropic_filtering:"OFF"},
c(d,null,b,0),d.image={filepath:null}}return d}function y(a,b){if(b in pa&&a in pa[b]){var c=pa[b][a];c.ya?c.ya.play():c.Rc&&(c.ep=!0);return!0}return!1}function A(a,b){if(b in pa&&a in pa[b]){var c=pa[b][a];c.ya?c.ya.pause():c.Rc&&(c.ep=!1);return!0}return!1}function H(a,b){if(b in pa&&a in pa[b]){var c=pa[b][a];c.ya?c.ya.currentTime=c.wb/c.Pf:c.Rc&&(c.Jh=h(c,c.wb),f(c));return!0}return!1}function w(a){return a.ya?!a.ya.paused:a.Rc?a.ep:!1}function h(a,b){return Math.round(b*a.cp/a.Hi)}function u(a,
b){if(Q.Fa(a))return P(a,b);for(var c=a.Gr,d=0;d<c.length;d++){var e=P(c[d],b);if(e)return e}return null}function P(a,b){var c=a.D;if(c.length)for(var c=c[0].U,d=0;d<c.length;d++){var e=c[d];if("MAIN"==e.type)for(var f=0;f<e.T.length;f++)if(e.T[f].name==b)return e.T[f]}return null}function p(a,b,c){a=a.D;if(a.length){a=a[0].U;for(var d=0;d<a.length;d++){var e=a[d];if("MAIN"==e.type)for(var f=0;f<e.T.length;f++)if(e.T[f].name==b)return e.T[f]=c,!0}}return!1}function z(a,b){var c=a.D;if(c.length)for(var c=
c[0].U,d=0;d<c.length;d++){var e=c[d];if("MAIN"==e.type)for(var f=0;f<e.T.length;f++){var h=e.T[f];-1==ea.indexOf(h.source)&&-1==b.indexOf(h.name)&&b.push(h.name)}}}function l(a,b,c){var d=a.elements;a=a.interpolation;for(var e=0;e<b;e++){var f=e/(b-1),h=M(d,f,!0),g=E(d,f,!0);if(h&&g)if("CONSTANT"==a)c.push.apply(c,h.color);else{var l=c,k=h,p=g;k==p?l.push.apply(l,k.color):(l.push(ta.yr(p.color[0],p.position,k.color[0],k.position,f)),l.push(ta.yr(p.color[1],p.position,k.color[1],k.position,f)),l.push(ta.yr(p.color[2],
p.position,k.color[2],k.position,f)),l.push(ta.yr(p.color[3],p.position,k.color[3],k.position,f)))}g&&!h&&c.push.apply(c,g.color);h&&!g&&c.push.apply(c,h.color)}}function M(a,b,c){for(var d=null,e=0;e<a.length;e++){var f=c?b-a[e].position:b-a[e][1][0];0<=f&&(d?f<=(c?b-d.position:b-a[e][1][0])&&(d=a[e]):d=a[e])}return d}function E(a,b,c){for(var d=null,e=0;e<a.length;e++){var f=c?a[e].position-b:a[e][1][0]-b;0<=f&&(d?f<=(c?d.position-b:d[1][0]-b)&&(d=a[e]):d=a[e])}return d}function W(a,b){var c=a.texture,
d=c.q,c=c.image;d&&b&&c&&x(d,b,c.Df,c.filepath);return d}var G=q("__compat"),J=q("__config"),Z=q("__texcomp"),L=q("__debug"),O=q("__extensions"),U=q("__print"),ga=q("__time"),R=q("__util"),ca=q("__renderer"),Q=q("__obj_util"),ta=q("__curve"),K=q("__vec3"),N=J.v,ha=J.jh,qa=J.M,na=null,ra=null,sa=null;a.Fd=0;a.G=0;a.nF=0;a.lF=0;a.mF=0;a.kF=0;a.sj=10;a.Sp=20;a.cn=30;a.dn=40;a.ll=50;a.Qp=60;a.Op=70;a.Rp=80;a.Pp=90;a.xx=128;a.xD=128;a.Mx=128;var ea=["NONE","NODE_TEX","SSAO_TEXTURE"],oa={},pa={},I=null,
Ea;a.Ue=function(b){Ea=[b.NEAREST_MIPMAP_NEAREST,b.NEAREST_MIPMAP_LINEAR,b.LINEAR_MIPMAP_NEAREST,b.LINEAR_MIPMAP_LINEAR];a.Fd=b.NEAREST;a.G=b.LINEAR;a.nF=b.NEAREST_MIPMAP_NEAREST;a.lF=b.LINEAR_MIPMAP_NEAREST;a.mF=b.NEAREST_MIPMAP_LINEAR;a.kF=b.LINEAR_MIPMAP_LINEAR;I=b};a.RQ=function(a,b){return b in oa&&a in oa[b]?oa[b][a].Hd:null};a.fS=function(a,c){return c in oa&&a in oa[c]?(b(oa[c][a]),!0):!1};a.On=function(b,c,d){var f=e();f.name=b;f.type=c;f.source="NONE";c==a.Qp||c==a.Op||c==a.Rp||c==a.Pp?
f.Td=I.createRenderbuffer():(b=I.TEXTURE_2D,c=I.createTexture(),I.bindTexture(b,c),I.texParameteri(b,I.TEXTURE_MAG_FILTER,I.LINEAR),I.texParameteri(b,I.TEXTURE_MIN_FILTER,I.LINEAR),I.texParameteri(b,I.TEXTURE_WRAP_S,I.CLAMP_TO_EDGE),I.texParameteri(b,I.TEXTURE_WRAP_T,I.CLAMP_TO_EDGE),N.Vb&&d&&I.texParameterf(b,I.TEXTURE_COMPARE_MODE,I.COMPARE_REF_TO_TEXTURE),I.bindTexture(b,null),f.Wa=b,f.Za=c);return f};a.xH=function(b){var c=I.createTexture(),d=I.TEXTURE_CUBE_MAP;I.bindTexture(d,c);I.texParameteri(d,
I.TEXTURE_MAG_FILTER,I.LINEAR);I.texParameteri(d,I.TEXTURE_MIN_FILTER,I.LINEAR);I.texParameteri(d,I.TEXTURE_WRAP_S,I.CLAMP_TO_EDGE);I.texParameteri(d,I.TEXTURE_WRAP_T,I.CLAMP_TO_EDGE);for(var f="TEXTURE_CUBE_MAP_POSITIVE_X TEXTURE_CUBE_MAP_NEGATIVE_X TEXTURE_CUBE_MAP_POSITIVE_Y TEXTURE_CUBE_MAP_NEGATIVE_Y TEXTURE_CUBE_MAP_POSITIVE_Z TEXTURE_CUBE_MAP_NEGATIVE_Z".split(" "),h=0;6>h;h++)I.texImage2D(I[f[h]],0,I.RGBA,b,b,0,I.RGBA,I.UNSIGNED_BYTE,null);I.bindTexture(d,null);d=e();d.name="CUBEMAP";d.type=
a.sj;d.source="NONE";d.width=3*b;d.height=2*b;d.Ln=1;d.Za=c;d.Wa=I.TEXTURE_CUBE_MAP;return d};a.ow=function(a,b,c){if(!F(a)){var d=a.Wa;I.bindTexture(d,a.Za);b&&I.texParameteri(d,I.TEXTURE_MIN_FILTER,b);c&&I.texParameteri(d,I.TEXTURE_MAG_FILTER,c);I.bindTexture(d,null)}};a.UQ=function(b){if(F(b))return{min:a.Fd,nL:a.Fd};var c=b.Wa;I.bindTexture(c,b.Za);b=I.getTexParameter(c,I.TEXTURE_MIN_FILTER);var d=I.getTexParameter(c,I.TEXTURE_MAG_FILTER);I.bindTexture(c,null);return{min:b,nL:d}};a.resize=function(b,
c,d){c=Math.max(c,N.$n?2:1);d=Math.max(d,N.$n?2:1);if(b.width!=c||b.height!=d){switch(b.type){case a.Qp:I.bindRenderbuffer(I.RENDERBUFFER,b.Td);I.renderbufferStorage(I.RENDERBUFFER,I.RGB565,c,d);I.bindRenderbuffer(I.RENDERBUFFER,null);break;case a.Op:I.bindRenderbuffer(I.RENDERBUFFER,b.Td);I.renderbufferStorage(I.RENDERBUFFER,I.DEPTH_COMPONENT16,c,d);I.bindRenderbuffer(I.RENDERBUFFER,null);break;case a.Rp:I.bindRenderbuffer(I.RENDERBUFFER,b.Td);I.renderbufferStorageMultisample(I.RENDERBUFFER,N.lc,
I.RGBA8,c,d);I.bindRenderbuffer(I.RENDERBUFFER,null);break;case a.Pp:I.bindRenderbuffer(I.RENDERBUFFER,b.Td);I.renderbufferStorageMultisample(I.RENDERBUFFER,N.lc,I.DEPTH_COMPONENT24,c,d);I.bindRenderbuffer(I.RENDERBUFFER,null);break;default:var e=b.Wa;I.bindTexture(e,b.Za);var f=r(b),h=C(b),g=B(b);I.texImage2D(e,0,h,c,d,0,f,g,null);I.bindTexture(e,null)}c>ha.dc||d>ha.dc?R.r('Slink texture "'+b.name+'" has unsupported size: '+c+"x"+d+". Max available: "+ha.dc+"x"+ha.dc+"."):(b.width=c,b.height=d)}};
a.rI=c;a.aD=n;a.$C=f;a.Ms=x;a.FI=function(a){I.deleteTexture(a)};a.Ul=function(a){return a&&a.name&&(a.Za||a.Td)?!0:!1};a.Tl=F;a.pR=function(b){return b.type==a.cn||b.type==a.dn?!0:!1};a.lK=function(b){var c=0;switch(b.type){case a.sj:case a.Sp:c=4;break;case a.cn:case a.dn:c=16;break;case a.ll:c=3;break;case a.Qp:case a.Op:c=2;break;case a.Rp:c=4*N.lc;break;case a.Pp:c=3*N.lc}return c};a.IJ=D;a.cleanup=function(){if(!N.dp)for(var a in pa)for(var b in pa[a])pa[a][b].ya.pause(),pa[a][b].ya.src="",
pa[a][b].ya.load();oa={};pa={}};a.pause=function(){for(var a in pa)for(var b in pa[a]){var c=pa[a][b];w(c)&&(A(b,a),c.Tm=!0)}};a.reset=function(){for(var a in pa)for(var b in pa[a])H(b,a),pa[a][b].Tm=!1};a.play=function(a){for(var b in pa)for(var c in pa[b]){var d=pa[b][c];if(!a||d.Tm)y(c,b),d.Tm=!1}};a.kx=function(a,b){return b in pa&&a in pa[b]?pa[b][a].Pm:!1};a.play_video=y;a.pause_video=A;a.reset_video=H;a.QM=function(a,b,c){c in pa&&a in pa[c]&&(a=pa[c][a],a.ya?a.ya.currentTime=b/a.Pf:a.Rc&&
(a.Jh=b,f(a)))};a.pD=w;a.qD=function(a){return a.ya||a.Rc?a.ya?2<=a.ya.readyState:!0:0};a.mD=function(a){return a.ya||a.Rc?a.ya?Math.round(a.ya.currentTime*a.Pf):a.Jh:0};a.oD=function(a){return a.ya||a.Rc?a.ya?a.wb:h(a,a.wb):0};a.gP=function(a){if(!a.ya&&!a.Rc)return 0;var b=Math.min(a.ti,a.Hi-a.wb);return a.ya?a.wb+b:h(a,a.wb+b)};a.ps=function(a,b){return Math.round(b*a.bp*(ga.Pc()/a.Pf))};a.nD=function(a){return Math.min(a.ti,a.Hi-a.wb)};a.fP=h;a.PJ=function(a,b){var c=u(a,b);return c&&"CANVAS"==
c.source?c.Hd:null};a.sO=function(a,c){var d=u(a,c);return d&&"CANVAS"==d.source?(b(d),!0):!1};a.get_texture_names=function(a){var b=[];if(Q.Fa(a))z(a,b);else{a=a.Gr;for(var c=0;c<a.length;c++)z(a[c],b)}return b};a.rN=function(a){for(var c={},d=0;d<a.length;d++){for(var f=a[d].T,h=[],g=0;g<f.length;g++){var l=f[g];if("CANVAS"==l.source)if(l.name in c)l=c[l.name];else{var k=f[g],l=e();l.name=k.name;l.source="CANVAS";l.width=k.width;l.height=k.height;l.Yj=k.Yj;l.type=k.type;k=document.createElement("canvas");
k.width=l.width;k.height=l.height;l.Hd=k.getContext("2d");l.Wa=I.TEXTURE_2D;l.Za=I.createTexture();I.bindTexture(I.TEXTURE_2D,l.Za);l.Yj?I.texParameteri(I.TEXTURE_2D,I.TEXTURE_MIN_FILTER,Ea[N.Im]):I.texParameteri(I.TEXTURE_2D,I.TEXTURE_MIN_FILTER,I.LINEAR);I.texParameteri(I.TEXTURE_2D,I.TEXTURE_MAG_FILTER,I.LINEAR);I.bindTexture(I.TEXTURE_2D,null);k=l;k.Hd.drawImage(f[g].Hd.canvas,0,0);b(k);c[l.name]=l}h.push(l)}a[d].T=h}};a.vH=function(a,b){for(var c=[],d=0;d<a.length;d++)l(a[d].data.value.color_ramp,
b,c);return new Uint8Array(c.map(function(a){return R.clamp(255*a,0,255)}))};a.CG=l;a.tI=function(a,b){for(var c=new Float32Array(3),d=new Float32Array(3),e=[],f=0;f<a.length;f++){for(var h=a[f].data.value,g=[],l=h.curve_mapping.curves_data,k=h.curve_mapping.curve_extend,p=h.curve_mapping.curves_handle_types,h=0;h<l.length;h++){for(var m=k[h],u=l[h],n=[],r=p[h],z=0;z<u.length;z++)n.push([new Float32Array(3),new Float32Array(u[z].concat(0)),new Float32Array(3)]);ta.Nt(n[0],null,n[1],r[0],r[0]);for(z=
1;z<n.length-1;z++)ta.Nt(n[z],n[z-1],n[z+1],r[z],r[z]);ta.Nt(n[n.length-1],n[n.length-2],null,r[n.length-1],r[n.length-1]);if(2<n.length){if("AUTO"==r[0]){K.subtract(n[0][2],n[0][1],c);z=K.length(c);K.copy(n[1][0],d);d[0]<n[0][1][0]&&(d[0]=n[0][1][0]);K.subtract(d,n[0][1],d);var t=K.length(d);1E-8<t&&(K.scale(d,z/t,d),K.add(n[0][1],d,n[0][2]),K.subtract(n[0][1],d,n[0][0]))}u=n.length-1;"AUTO"==r[0]&&(K.subtract(n[u][0],n[u][1],c),z=K.length(c),K.copy(n[u-1][2],d),d[0]>n[u][1][0]&&(d[0]=n[u][1][0]),
K.subtract(d,n[u][1],d),t=K.length(d),1E-8<t&&(K.scale(d,z/t,d),K.add(n[u][1],d,n[u][0]),K.subtract(n[u][1],d,n[u][2])))}for(u=0;u<n.length-1;u++)ta.oH(n[u][1],n[u][2],n[u+1][0],n[u+1][1]);u=[];3>=l.length?(z=Math.round(-b/2),r=Math.round(b/2)):(z=0,r=b);for(;z<r;z++){var t=z/(r-1),v=M(n,t,!1),w=E(n,t,!1);v&&w?u.push(ta.ky(t,v[1],v[2],w[0],w[1],.001)):w&&!v?"EXTRAPOLATED"==m?(t=w[1][0]==w[2][0]?w[1][1]:ta.LA(t,w[1],w[2]),u.push(t)):u.push(w[1][1]):v&&!w&&("EXTRAPOLATED"==m?(t=v[0][0]==v[1][0]?v[1][1]:
ta.LA(t,v[0],v[1]),u.push(t)):u.push(v[1][1]))}g.push(u)}e.push(g)}c=[];for(z=0;z<e.length;z++)for(g=e[z],h=0;h<g[0].length;h++)3>=g.length?(d=R.clamp(127.5*(g[0][h]+1),0,255),f=R.clamp(127.5*(g[1][h]+1),0,255),l=R.clamp(127.5*(g[2][h]+1),0,255),u=255):(d=R.clamp(255*g[0][h],0,255),f=R.clamp(255*g[1][h],0,255),l=R.clamp(255*g[2][h],0,255),u=R.clamp(255*g[3][h],0,255)),c.push(d,f,l,u);return new Uint8Array(c)};a.change_image=function(a,b,c){var d=u(a,b);if(d){if("WORLD"!=a.type){var f;f=e();f.name=
d.name;f.type=d.type;f.source=d.source;f.jp=d.jp;f.width=d.width;f.height=d.height;f.Ln=d.Ln;f.zw=d.zw;f.nl=d.nl;f.Kh=d.Kh;f.Yj=d.Yj;f.Hd=d.Hd;f.Wa=d.Wa;f.Za=d.Za;f.Td=d.Td;f.tk=d.tk;f.jg=d.jg;f.ya=d.ya;f.Hi=d.Hi;f.Pf=d.Pf;f.ma=d.ma;f.wb=d.wb;f.ti=d.ti;f.qf=d.qf;f.dg=d.dg;f.Rc=d.Rc;f.cp=d.cp;f.bp=d.bp;f.Jh=d.Jh;f.ep=d.ep;f.$i=d.$i;f.Tm=d.Tm;f.fx=d.fx;f.Th=d.Th;f.Pm=d.Pm;f.repeat=d.repeat;f.md=d.md;var h=f;I.bindTexture(d.Wa,d.Za);var g=I.getTexParameter(d.Wa,I.TEXTURE_MAG_FILTER),l=I.getTexParameter(d.Wa,
I.TEXTURE_MIN_FILTER),k=I.getTexParameter(d.Wa,I.TEXTURE_WRAP_S),d=I.getTexParameter(d.Wa,I.TEXTURE_WRAP_T);h.Za=I.createTexture();I.bindTexture(h.Wa,h.Za);I.texParameteri(h.Wa,I.TEXTURE_MAG_FILTER,g);I.texParameteri(h.Wa,I.TEXTURE_MIN_FILTER,l);I.texParameteri(h.Wa,I.TEXTURE_WRAP_S,k);I.texParameteri(h.Wa,I.TEXTURE_WRAP_T,d);I.bindTexture(h.Wa,null);d=f;if(Q.Fa(a))p(a,b,d);else for(a=a.Gr,h=0;h<a.length&&!p(a[h],b,d);h++);}else f=d;x(f,c,!1,c.src,0);return!0}return!1};a.Oc=W;a.Mz=function(a,b){var c=
{texture:D("NODE_TEX",null)};return W(c,{width:b,height:a.length/(4*b),data:a})};a.tM=function(){I=null}};b4w.module.__assets=function(a,q){function e(){return C.rA()?q(C.Md.hq).data:null}function c(){var a={Tp:null,zF:function(b){switch(a.responseType){case "json":case "text":return b;case "arraybuffer":b=atob(b);for(var c=b.length,d=new Int8Array(c),e=0;e<c;e++)d[e]=b.charCodeAt(e);return d.buffer;default:return b}},status:0,readyState:0,response:"",responseType:"",onreadystatechange:null,overrideMimeType:function(){},addEventListener:function(){},open:function(b,c){a.Tp=c;a.readyState=1},send:function(){a.status=
404;a.readyState=4;var b=e();b&&a.Tp in b&&(a.status=200,b[a.Tp]&&(a.response=a.zF(b[a.Tp])));if("[object Function]"==={}.toString.call(a.onreadystatechange))a.onreadystatechange()}};return a}function b(b){for(var c=0,d=0;d<b.length;d++){var e=b[d];20===e.state&&c++;if(c>=w.vL)break;if(10===e.state)switch(e.state=20,c++,e.type){case a.AT_ARRAYBUFFER:n(e,"arraybuffer");break;case a.AT_JSON:n(e,"json");break;case a.AT_TEXT:n(e,"text");break;case a.AT_AUDIOBUFFER:f(e);break;case a.AT_IMAGE_ELEMENT:t(e);
break;case a.AT_AUDIO_ELEMENT:g(e);break;case a.Dp:m(e);break;case a.Cp:v(e);break;default:y.r("Wrong asset type: "+e.type)}}}function n(b,d){var f=e(),h=f&&b.url in f?new c:new XMLHttpRequest,f=null;if("GET"==b.qe)h.open("GET",b.url,!0);else if("POST"==b.qe)switch(h.open("POST",b.url,!0),b.Ti){case a.ux:f="text/plain";break;case a.tx:f="application/json"}if(b.Qi)for(var g in b.Qi)"Content-Type"==g?f=b.Qi[g]:h.setRequestHeader(g,b.Qi[g]);f&&h.setRequestHeader("Content-Type",f);"text"==d?(h.overrideMimeType("text/plain"),
h.responseType="text"):"json"==d?(h.overrideMimeType("application/json"),h.responseType="text"):h.responseType=d;h.onreadystatechange=function(){if(40!=b.state&&4==h.readyState){if(200==h.status||0==h.status){var a=h.response;if(a){if("json"==d&&"string"==typeof a)try{a=JSON.parse(a,b.NK)}catch(c){F.error(c+" (parsing JSON "+b.url+")");b.Cc(null,b.id,b.type,b.url,b.Mb);return}b.Cc(a,b.id,b.type,b.url,b.Mb)}else F.error("empty responce when trying to get "+b.url),b.Cc(null,b.id,b.type,b.url,b.Mb)}else F.error(h.status+
" when trying to get "+b.url),b.Cc(null,b.id,b.type,b.url,b.Mb);b.state=30}};h.addEventListener("progress",function(a){a.lengthComputable&&b.zB(a.loaded/a.total)},!1);h.send(b.Fh)}function f(a){"GET"!=a.qe&&y.r("Unsupported request type for audio buffer");var b=e(),d=b&&a.url in b?new c:new XMLHttpRequest;d.open("GET",a.url,!0);d.responseType="arraybuffer";d.onreadystatechange=function(){if(40!=a.state&&4==d.readyState)if(200==d.status||0==d.status){var b=d.response;b?D.EI(b,function(b){a.Cc(b,a.id,
a.type,a.url,a.Mb);a.state=30},function(){a.Cc(null,a.id,a.type,a.url,a.Mb);F.error("failed to decode "+a.url);a.state=30}):(a.Cc(null,a.id,a.type,a.url,a.Mb),F.error("empty responce when trying to get "+a.url),a.state=30)}else a.Cc(null,a.id,a.type,a.url,a.Mb),F.error(d.status+" when trying to get "+a.url),a.state=30};d.send(a.Fh)}function t(a){"GET"!=a.qe&&y.r("Unsupported request type for image element");var b=document.createElement("img");H.allow_cors&&(b.crossOrigin="Anonymous");b.onload=function(){40!=
a.state&&(a.Cc(b,a.id,a.type,a.url,a.Mb),a.state=30)};b.addEventListener("error",function(){40!=a.state&&(a.Cc(null,a.id,a.type,a.url,a.Mb),F.error("could not load image: "+a.url),a.state=30)},!1);var c=e();if(c&&a.url in c)if(c[a.url]){var f=d(a.url);b.src="data:"+f+";base64,"+c[a.url]}else B.is_ie11()?(c=document.createEvent("CustomEvent"),c.initCustomEvent("error",!1,!1,null)):c=new CustomEvent("error"),b.dispatchEvent(c);else b.src=a.url}function g(a){"GET"!=a.qe&&y.r("Unsupported request type for audio element");
var b=document.createElement("audio");H.allow_cors&&(b.crossOrigin="Anonymous");b.addEventListener("loadeddata",function(){40!=a.state&&(a.Cc(b,a.id,a.type,a.url,a.Mb),a.state=30)},!1);b.addEventListener("error",function(){40!=a.state&&(a.Cc(null,a.id,a.type,a.url,a.Mb),F.error("could not load sound: "+a.url),a.state=30)},!1);b.addEventListener("stalled",function(){40!=a.state&&(a.Cc(null,a.id,a.type,a.url,a.Mb),F.error("could not load sound: "+a.url),a.state=30)},!1);var c=e();if(c&&a.url in c)if(c[a.url]){var d=
k(a.url);b.src="data:"+d+";base64,"+c[a.url];40!=a.state&&(a.Cc(b,a.id,a.type,a.url,a.Mb),a.state=30)}else B.is_ie11()?(c=document.createEvent("CustomEvent"),c.initCustomEvent("error",!1,!1,null)):c=new CustomEvent("error"),b.dispatchEvent(c);else b.src=a.url,H.is_mobile_device&&b.load();H.vv&&(b.autoplay=!0,b.pause());setTimeout(function(){b.yN=1},5E3)}function m(a){function b(){40!=a.state&&(a.Cc(null,a.id,a.type,a.url),F.error("could not load video: "+a.url,a.Mb),a.state=30)}"GET"!=a.qe&&y.r("Unsupported request type for video element");
var c=document.createElement("video");c.muted=!0;if(H.allow_cors||H.is_mobile_device)c.crossOrigin="Anonymous";c.addEventListener("loadeddata",function(){c.removeEventListener("error",b,!1);40!=a.state&&(a.Cc(c,a.id,a.type,a.url,a.Mb),a.state=30)},!1);c.addEventListener("error",b,!1);var d=e();if(d&&a.url in d)if(d[a.url]){var f=r(a.url);c.src="data:"+f+";base64,"+d[a.url];40!=a.state&&c.addEventListener("loadeddata",function(){a.Cc(c,a.id,a.type,a.url,a.Mb);a.state=30},!1)}else B.is_ie11()?(d=document.createEvent("CustomEvent"),
d.initCustomEvent("error",!1,!1,null)):d=new CustomEvent("error"),c.dispatchEvent(d);else c.src=a.url,H.is_mobile_device&&c.load();H.vv&&(c.autoplay=!0,c.pause());setTimeout(function(){c.yN=1},1E4)}function v(b){function d(a){b.Cc(a,b.id,b.type,b.url,b.Mb);b.state=30}"GET"!=b.qe&&y.r("Unsupported request type for seq video element");var f=e(),h=f&&b.url in f?new c:new XMLHttpRequest;if(null==b.Ti&&null==b.Fh)h.open("GET",b.url,!0);else switch(h.open("POST",b.url,!0),b.Ti){case a.ux:h.setRequestHeader("Content-type",
"text/plain");break;case a.tx:h.setRequestHeader("Content-type","application/json")}h.responseType="arraybuffer";h.onreadystatechange=function(){if(40!=b.state&&4==h.readyState)if(200==h.status||0==h.status){var a=h.response;a?x(a,d):(b.Cc(null,b.id,b.type,b.url,b.Mb),F.error("empty responce when trying to get "+b.url),b.state=30)}else b.Cc(null,b.id,b.type,b.url,b.Mb),F.error(h.status+" when trying to get "+b.url),b.state=30};h.addEventListener("progress",function(a){a.lengthComputable&&b.zB(a.loaded/
a.total)},!1);h.send(b.Fh)}function x(a,b){for(var c=new Int32Array(a),d=new Int8Array(a),e=c[3],f={images:[],oy:[],Pf:c[4]},h=20,g=0;g<e;g++){var k=c[h/4],m=new Blob([d.subarray(h+4,h+4+k)],{type:"image/jpg"}),n=document.createElement("img");n.src=window.URL.createObjectURL(m);f.images.push(n);f.oy.push(m);h+=k+8-k%4}n.onload=function(){for(var a=0;a<f.images.length;a++)window.URL.revokeObjectURL(f.images[a].src);delete f.oy;b(f)}}function d(a){var b="image";switch(y.Ku(a).toLowerCase()){case "jpeg":case "jpg":b+=
"/jpeg";break;case "png":b+="/png"}return b}function k(a){var b="audio";switch(y.Ku(a).toLowerCase()){case "ogv":case "ogg":b+="/ogg";break;case "mp3":b+="/mpeg";break;case "m4v":case "mp4":b+="/mp4";break;case "webm":b+="/webm"}return b}function r(a){var b="video";switch(y.Ku(a).toLowerCase()){case "ogv":b+="/ogg";break;case "webm":b+="/webm";break;case "m4v":b+="/mp4"}return b}var C=q("__config"),B=q("__compat"),F=q("__print"),D=q("__sfx"),y=q("__util"),A=q("__version"),H=C.v,w=C.Gd;a.AT_ARRAYBUFFER=
10;a.AT_JSON=20;a.AT_TEXT=30;a.AT_AUDIOBUFFER=40;a.AT_IMAGE_ELEMENT=50;a.AT_AUDIO_ELEMENT=60;a.Dp=70;a.Cp=80;a.tx=a.AT_JSON;a.ux=a.AT_TEXT;var h=[],u=0,P={};a.Ok=function(a){a=a.split(".");var b=Array(2);b[0]=a.slice(0,-1).join(".");b[1]=String(a.slice(-1));return b};a.bR=function(a){if(P[a])return P[a];var b=w.prevent_caching?a+A.timestamp():a,c=new XMLHttpRequest;c.overrideMimeType("text/plain");c.open("GET",b,!1);c.send(null);if(200==c.status||0==c.status){b=c.responseText;if(b.length)return P[a]=
b;y.r("Error XHR: responce is empty, GET "+a)}else y.r("Error XHR: "+c.status+", GET "+a)};a.cleanup=function(){for(var a=0;a<h.length;a++)h[a].state=40;h=[];u=0;P={}};a.enqueue=function(a,c,d,f,g){for(var k=0;k<a.length;k++){var m=a[k],m={id:m.id,type:m.type,url:m.url,qe:m.qe?m.qe:"GET",Ti:m.Ti?m.Ti:null,Qi:m.Qi?m.Qi:null,Fh:m.Fh?m.Fh:null,Mb:m.Mb?m.Mb:null,state:10,Cc:c||function(){},nB:d||function(){},zB:f||function(){},NK:g||null,oB:u};if(w.prevent_caching){var n=e();n&&m.url in n||(m.url+=A.timestamp())}h.push(m)}b(h);
u++};a.update=function(){b(h);for(var a=h,c=0,d=!0,e=0;e<a.length;e++){var f=a[e];f.oB===a[c].oB?30!==f.state&&(d=!1):(d&&(a[e-1].nB(),d=e-c,a.splice(c,d),e-=d),c=e,d=30===a[e].state?!0:!1);e===a.length-1&&d&&(a[e].nB(),a.splice(c))}};a.XG=function(a){return"png"==a||"jpg"==a||"jpeg"==a||"gif"==a||"bmp"==a||"dds"==a||"pvr"==a?!0:!1}};b4w.module.__loader=function(a,q){function e(b,e,f,h){var g=y,k=B.create(),m;for(m in e){var n=c(e[m]);(h&&n.Tb||!b&&n.mc)&&d(n);B.H(k,n)}for(m in e)for(n=e[m],n.name=m,b=0;b<n.K.length;b++)B.s(k,e[n.K[b]],n,null);e=c({name:"out",Hb:a.BD,Yb:function(a,b,c,d,e){b.nb&&(g.Cw=!0);C(b)||(b.status=2);b.NA(b.id,!0);e(b,c);F.log("%cTHREAD "+b.id+": LOADED CALLBACK","color: #f0f;")},Ub:5});if(f)f=B.oo(k);else{m=B.clone(k);do{f=B.oo(m);n=[];for(b=0;b<f.length;b++){h=f[b];var l=B.Sa(m,h);l.Pb&&n.push(h)}for(b=
0;b<n.length;b++)B.cg(m,n[b]);n.length&&B.St(m)}while(n.length)}B.H(k,e);for(b=0;b<f.length;b++)h=f[b],l=B.Sa(k,h),e.K.push(l.name),B.s(k,l,e,null);return k}function c(a){a.Pb=a.Pb||!1;a.Hb||0===a.Hb||(a.Hb=a.Ed);a.K=a.K||[];a.qk=a.qk||!1;a.ww=a.ww||!1;a.Ub=a.Ub||0;a.Tb=a.Tb||!1;a.mc=a.mc||!1;a.status=0;a.xR=0;a.kv=0;a.yn=a.yn||null;return a}function b(a,b){for(var c=[],d=[],e=0;e<b.length;e++){var f=b[e];B.Sa(a.Qg,f).qk&&(B.gj(a.Qg,f,function(d){var e=!0;B.Ug(a.Qg,d,function(a,b){if(!b.qk)return e=
!1,1});e&&-1==c.indexOf(d)&&-1==b.indexOf(d)&&c.push(d)}),d.push(e))}for(e=d.length-1;0<=e;e--)b.splice(d[e],1);return c}function n(a){function c(b,d){var e=B.Sa(a.Qg,b),f=B.Sa(a.Qg,d),h=f.Hb-e.Hb;0==h&&(h=e.Pb-f.Pb);return h}var d=[],e=a.Nh,f=!1;do{var g=b(a,e);d.push.apply(d,e);0<g.length&&(f=!0);e=g}while(0<g.length);f&&d.sort(c);a.Nh=d;return a.Nh.length}function f(a,b,c){if(b.ww)return b.qk=!0,g(a,b),!1;if(!b.Yb&&!b.ki&&!b.xn)return g(a,b),!1;if(0==b.status&&(b.status++,b.Yb))return b.Yb(c,a,
b,b.yn,g,m),!0;if(1==b.status){if(b.ki)return b.ki(c,a,b,b.yn,g,m),!0;b.status++}return 2==b.status&&(b.status++,b.xn)?(b.xn(c,a,b,b.yn,g,m),!0):!1}function t(a){if(0==a.zs)return 100;var b=0;B.na(a.Qg,function(c,d){a.do_not_load_resources&&d.Tb||(b+=d.kv*d.Ub)});return D.trunc(100*b/a.zs)}function g(a,b){b.qk=!0;b.status=3;v(a,b,1)}function m(a,b,c){1>c?v(a,b,c):b.status++}function v(a,b,c){var d=y;if(b.Yb||b.ki||b.xn)if(b.kv=c,b=t(a),a.ez!=b||1==c)a.Bw(b,performance.now()-a.LC),a.ez=b,d.mv=!0}function x(a,
b){var c=null;B.na(a.Qg,function(a,d){if(d.name==b)return c=d,1});return c}function d(a){a.ww=!0;a.kv=1}function k(a){a.Bw=null;a.Zt=null;a.Qg=null;a.Nh=null}function r(){return 0==y.Vp}function C(a){return a&&(3==a.status||4==a.status)}var B=q("__graph"),F=q("__print"),D=q("__util");a.Ed=0;a.rj=1;a.BD=2;var y=null;a.bA=function(){return y};a.OH=function(){var a={Tg:[],nu:0,Vp:0,Cw:!1,mv:!1};return y=a};a.sI=function(a,b,c,d,f,g,k,m){var l=y,n=l.Tg.length,r={id:n,nb:0==n,status:0,zg:b,my:"",NA:c||
function(){},MA:m||!1,jS:g,LC:0,ez:0,zs:0,fw:!1,Bw:d||function(){},Zt:f||function(){},Qg:null,Nh:null,Wu:!1,Uu:!1,Xu:!1};a=e(r.nb,a,g,k);r.Qg=a;b=[];c=B.jK(a);for(d=0;d<c.length;d++)b.push(c[d]);r.Nh=b;B.na(a,function(a,b){!(b.Yb||b.ki||b.xn)||r.do_not_load_resources&&b.Tb||(r.zs+=b.Ub)});l.Tg.push(r);l.Vp++;return r.id};a.FO=function(b){var c=y;if(c&&!r())if(c.mv)c.mv=!1;else{var d=performance.now();do{var e=c.Tg[c.nu],g=b[e.id];if(!C(e))if(0==e.status&&(e.status=1,e.LC=performance.now(),e.Bw(0,
0)),n(e)){var m=e,p=m.Nh.length;do{var t=B.Sa(m.Qg,m.Nh[0]),l=f(m,t,g);t.Hb==a.rj&&(m.fw=!0);t=m.Nh.shift();m.Nh.push(t);p--}while(!l&&0!=p)}else m=c,p=e,p.Zt(g,p),p.status=3,m.Vp--,k(p);c.Cw&&(c.nu=(c.nu+1)%c.Tg.length);if(e.fw){e.fw=!1;break}}while(16>performance.now()-d)}};a.Rx=function(a){var b=y;a.Zt(null,a);a.status=3;b.Vp--;k(a);a.status=4;a.nb&&(b.Cw=!0);a.NA(a.id,!1)};a.WR=m;a.ws=function(a,b){var c=x(a,b);null!==c&&d(c)};a.qk=r;a.XN=C;a.is_primary_loaded=function(a){var b=y;if(!b)return!1;
a|=0;return b.Tg[a]&&(3==b.Tg[a].status||2==b.Tg[a].status)};a.pK=function(){F.error("Debug mode isn't enabled. Can not retrieve the graph.")};a.cleanup=function(){y=null}};b4w.module.__logic_nodes=function(a,q){function e(){return function(a,b,c,d){c=d[0];var e=d[1];d=d[2];if(-2==c.state){for(var f=0;f<c.os;f++)if(H.get_sensor_value(a,b,f))for(var h=0;h<c.ns.length;h++)if(c.ns[h]==f){e.zk==c.HC?(B.is_play(e.ia)&&(c.state=-1),d.Ye.Qe||(c.state=1,c.hp=c.zr[h])):(c.state=1,c.hp=c.zr[h]);return}c.state=0}}}function c(){return function(a,b,c,d){c=d[0];var e=d[1];d=d[2];for(var f=0;f<c.os;f++)if(H.get_sensor_value(a,b,f)&&f==c.RB){if(B.is_play(e.ia)&&e.zk==c.HC)c.state=-1;
else if(!d.Ye.Qe||c.fa.no_wait)c.state=1;return}c.state=0}}function b(a,b){return{name:a.name,type:a.type,label:a.label,za:a.slot_idx_order,hp:a.slot_idx_jump,ma:a.frame_range[0],Oa:a.frame_range[1],qJ:a.frame_range_mask?a.frame_range_mask[0]:!0,pJ:a.frame_range_mask?a.frame_range_mask[1]:!0,state:-1,os:-1,RB:-1,NL:a.param_name,LL:a.operation,mute:a.mute,Xn:a.object,obj:null,Fb:null,Qb:null,Gb:{},ef:a.anim_name,Xb:k.SLOT_0,PL:a.parse_json_vars,OL:a.parse_json_paths,bd:a.objects_paths,dB:a.nodes_paths,
kc:a.floats,fa:a.bools,ba:a.variables,Oh:a.strings,nv:a.materials_names,ZB:a.shader_nd_type,ae:a.common_usage_names,WI:a.encode_json_vars,VI:a.encode_json_paths,HC:b,yB:ta[a.type]?ta[a.type]:g,ds:!1,Gs:0,ns:null,dL:a.links,zr:[]}}function n(a,b,c){return a[0]?b[a[1]]:c[a[1]]}function f(a,b,c,d){a[0]?b[a[1]]=d:c[a[1]]=d}function t(a,b,c){switch(b.state){case 2:c.ea=a.za}}function g(a,b,c){switch(b.state){case 1:D.error("Unknown node type: "+a.type);break;case 2:c.ea=a.za}}function m(a){return F.wc(F.Vc,
a.Xn||[],0)}function v(a,c){var d=a.b4w_logic_nodes,e=c.yd;c.state=1;for(var f=0;f<d.length;f++){var h={O:[],Ye:{Ua:a,ea:0,Qe:!1,Rw:f,C:{R1:0,R2:0,R3:0,R4:0,R5:0,R6:0,R7:0,R8:0}}};e.push(h);for(var g=e[e.length-1],k=d[f],l=0;l<k.length;l++){var m=b(k[l],g);g.O.push(m)}for(k=0;k<g.O.length;k++)m=g.O[k],m.yB(m,c,h.Ye,0,0)}var d=a.timeline_markers,p;for(p in d)c.ip.push(d[p]);c.ip.sort(function(a,b){return a-b});c.state=2;Z.push(c)}function x(a,b){switch(b){case 0:return Boolean(Number(a))?Number(a):
0;case 1:return String(a);default:return null}}function d(a){switch(typeof a){case "string":return x(a,1);case "number":return x(a,0);default:return x(a,1)}}var k=q("__animation"),r=q("__assets"),C=q("__camera"),B=q("__nla"),F=q("__objects"),D=q("__print"),y=q("__scenes"),A=q("__config"),H=q("__controls"),w=q("__batch"),h=q("__geometry"),u=q("__mat3"),P=q("__mat4"),p=q("__physics"),z=q("__quat"),l=q("__sfx"),M=q("__time"),E=q("__transform"),W=q("__tsr"),G=q("__util"),J=q("__vec3"),Z=[],L={},O=new Float32Array(4);
new Float32Array(4);var U=new Float32Array(3),ga=new Float32Array(3),R=new Float32Array(2),ca=new Float32Array(9),Q=new Float32Array(16);a.nE=0;a.oE=1;a.hE=0;a.gE=1;a.iE=2;a.jE=3;a.fE=4;a.Dx=0;a.Fx=1;a.Ex=2;a.Gx=3;a.Hx=4;a.Cx=5;a.mE=0;a.lE=1;a.kE=2;a.aE=0;a.bE=1;var ta={ENTRYPOINT:function(a,b,c){switch(b.state){case 2:c.ea=a.za}},HIDE:function(a,b,c){switch(b.state){case 1:a.obj=m(a);break;case 2:y.zn(a.obj,!0),c.ea=a.za}},SHOW:function(a,b,c){switch(b.state){case 1:a.obj=m(a);break;case 2:y.zn(a.obj,
!1),c.ea=a.za}},PAGEPARAM:function(a,b,c){switch(b.state){case 2:var d=a.ba.vd;b=b.C;var e=c.C,h;a:{h=a.NL;var g=a.kc.ptp,k=a.fa.hsh,l=A.get("url_params");if(l&&h in l)h=Number(l[h]);else{if(k=k?location.hash:location.search)for(k=k.slice(1).split("&"),l=0;l<k.length;l++){var m=k[l].split("=");if(1<m.length&&m[0]==h){h=x(m[1],g);break a}}h=0}}f(d,b,e,h);c.ea=a.za}},SWITCH_SELECT:function(a,b,c){switch(b.state){case 1:a:{c=b.yd[c.Rw];var d=F.get_selectable_objects();a.ns=[];a.zr=[];for(var f in a.bd){var h=
F.wc(F.Vc,a.bd[f],0),g=d.indexOf(h);if(-1==g){D.error("logic script error: non-selectable object:",a.bd[f][a.bd[f].length-1]);break a}a.ns.push(g);a.zr.push(a.dL[f])}a.state=-1;a.os=d.length;f=[];for(g=0;g<d.length;g++)f.push(H.create_selection_sensor(d[g],!1));H.create_sensor_manifold(h,"LOGIC_NODES_SWITCH_SELECT_"+a.label,H.CT_SHOT,f,H.iz,e(),[a,b,c])}break;case 2:if(-1==a.state){b=b.yd[c.Rw].O;for(h=0;h<b.length;h++)d=b[h],"SWITCH_SELECT"==d.type&&(d.state=-1);a.state=-2}-1<a.state&&(c.ea=a.state?
a.hp:a.za,a.state=-1)}},SELECT:function(a,b,d){switch(b.state){case 1:d=b.yd[d.Rw];var e=m(a),f=F.get_selectable_objects(),h=f.indexOf(e);if(-1==h)D.error("logic script error: non-selectable object:",a.Xn[a.Xn.length-1]);else{a.state=-1;a.os=f.length;a.RB=h;for(var h=[],g=0;g<f.length;g++)h.push(H.create_selection_sensor(f[g],!1));H.create_sensor_manifold(e,"LOGIC_NODES_SELECT_"+a.label,H.CT_SHOT,h,H.iz,c(),[a,b,d])}break;case 2:if(-1<a.state){d.ea=a.state?a.hp:a.za;a.state=-1;break}a.fa.not_wait&&
(d.ea=a.za)}},PLAY:function(a,b,c,d){switch(b.state){case 1:B.Dw();a.state=-1;a.fa.not_wait||(a.fa.not_wait=!1);break;case 2:switch(a.state){case -1:if(B.is_play(b.ia))if(b.lu==b.zk&&c.Qe)break;else{var e=b.zk;if(e){e.Ye.ea=e.O[e.Ye.ea].za;e.O[e.Ye.ea].state=-1;for(var e=b.zk.O,f=0;f<e.length;f++){var h=e[f];"PLAY"==h.type&&(h.state=-1)}}}c.Qe=!a.fa.not_wait;b.zk=b.lu;a.state=0;a.qJ&&(B.dN(a.ma),B.UB(d));if(a.pJ)B.pw(a.Oa);else{d=B.get_frame(d);var e=-1,g;for(g in b.ip)if(d<b.ip[g]){e=g;break}0<=
e?B.pw(b.ip[e]):B.pw(B.get_frame_end())}B.tB(null);a.fa.not_wait&&(c.ea=a.za,a.state=-1,c.Qe=!1);break;case 0:B.is_play()||(c.ea=a.za,a.state=-1,c.Qe=!1);break;case 1:c.ea=a.za;a.state=-1;b.zk=null;c.Qe=!1;break;default:G.r("Unknown state of "+a.name),a.state=-1}}},REDIRECT:function(a,b,c){switch(b.state){case 2:window.location.href=a.fa.url?x(n(a.ba.url,b.C,c.C),1):a.Oh.url,b.state=3}},MATH:function(a,b,c){switch(b.state){case 2:var d=-1==a.ba.v1[1]?a.kc.inp1:x(n(a.ba.v1,b.C,c.C),0),e=-1==a.ba.v2[1]?
a.kc.inp2:x(n(a.ba.v2,b.C,c.C),0),h=0;switch(a.LL){case "ADD":h=d+e;break;case "MUL":h=d*e;break;case "SUB":h=d-e;break;case "DIV":0==e&&G.r("Division by zero in Logic script");h=d/e;break;case "RAND":h=Math.random()*(e-d)+d}f(a.ba.vd,b.C,c.C,h);c.ea=a.za}},CONDJUMP:function(a,b,c){switch(b.state){case 2:var d=a.fa.str?1:0,e=a.fa.str?a.Oh:a.kc,f=-1==a.ba.v1[1]?e.inp1:x(n(a.ba.v1,b.C,c.C),d);b=-1==a.ba.v2[1]?e.inp2:x(n(a.ba.v2,b.C,c.C),d);d=!1;switch(a.ae.condition){case 5:f==b&&(d=!0);break;case 4:f!=
b&&(d=!0);break;case 3:f<b&&(d=!0);break;case 2:f>b&&(d=!0);break;case 1:f<=b&&(d=!0);break;case 0:f>=b&&(d=!0)}c.ea=d?a.hp:a.za}},REGSTORE:function(a,b,c){switch(b.state){case 2:f([a.fa.gl||a.ba.vd[0],a.ba.vd[1]],b.C,c.C,(1==a.ae.variable_type?a.Oh:a.kc).inp1),c.ea=a.za}},PLAY_ANIM:function(a,b,c){switch(b.state){case 1:a.obj=a.fa.env?F.get_world_by_name(a.Xn[0],0):m(a);break;case 2:switch(0!=a.state||k.is_play(a.obj,a.Xb)||(a.state=1),a.state){case -1:for(var d in b.yd){var e=b.yd[d].Ye.ea;-1!=
e&&(e=b.yd[d].O[e],"PLAY_ANIM"==e.type&&e!=a&&0==e.state&&e.obj==a.obj&&(e.state=1))}b=a.ae.param_anim_behavior;if(""==a.ef)k.apply_def(a.obj),k.set_behavior(a.obj,b,a.Xb);else{a:{d=a.obj;for(var e=a.ef,f=0,h=0;8>h;h++){var g=d.X[h];if(g&&g.eh&&k.wC(g.eh)==k.wC(e))if(0==f)f=1;else{d=!1;break a}}d=1==f?!0:!1}d||(a.Xb=k.uN(a.obj,a.ef),k.apply(a.obj,null,a.ef,a.Xb),k.set_behavior(a.obj,b,a.Xb))}a.fa.not_wait||(c.Qe=!0);k.play(a.obj,null,a.Xb);a.state=0;a.fa.not_wait&&(c.ea=a.za,a.state=-1);break;case 0:break;
case 1:a.fa.not_wait||(c.Qe=!1);c.ea=a.za;a.state=-1;break;default:G.r("Unknown state of "+a.name),a.state=-1}}},SELECT_PLAY:t,SEND_REQ:function(a,b,c){function d(a,e,h,g,k){a=JSON.stringify(a);f(k[0].ba.dst,b.C,c.C,a);k[0].state=1}switch(b.state){case 2:switch(a.state){case -1:a.state=0;var e=a.fa.url?x(n(a.ba.url,b.C,c.C),1):a.Oh.url,h={};a.fa.ct&&(h["Content-Type"]=a.Oh.ct);"GET"==a.ae.request_type?r.enqueue([{id:e,type:r.AT_JSON,url:e,Qi:h,Mb:[a,c.C]}],d,null,null,null):"POST"==a.ae.request_type&&
r.enqueue([{id:e,type:r.AT_JSON,url:e,Qi:h,qe:"POST",Ti:r.AT_JSON,Fh:x(n(a.ba.dst1,b.C,c.C),1),Mb:[a,c.C]}],d,null,null,null);break;case 1:a.state=-1,c.ea=a.za}}},INHERIT_MAT:function(a,b,c){switch(b.state){case 1:for(b=0;2>b;b++)a.Gb["id"+b]=F.wc(F.Vc,a.bd["id"+b],0);break;case 2:w.inherit_material(a.Gb.id0,a.nv.id0,a.Gb.id1,a.nv.id1),c.ea=a.za}},SET_SHADER_NODE_PARAM:function(a,b,c){switch(b.state){case 1:a.bd.id0&&(a.Gb.id0=F.wc(F.Vc,a.bd.id0,0),a.dB.id0.unshift(a.nv.id0));break;case 2:var d=a.Gb.id0,
e=a.dB.id0,f=e[0],h=w.Ra(d,f,"MAIN");c.ea=a.za;if(null===h){D.error('Material "'+f+'" was not found in the object "'+d.name+'".');break}if("ShaderNodeRGB"==a.ZB){var g=w.Nl(h.Wf,e);w.set_nodemat_rgb(d,f,g,a.fa.id0?x(n(a.ba.id0,b.C,c.C),0):a.kc.id0,a.fa.id1?x(n(a.ba.id1,b.C,c.C),0):a.kc.id1,a.fa.id2?x(n(a.ba.id2,b.C,c.C),0):a.kc.id2)}"ShaderNodeValue"==a.ZB&&(g=w.Nl(h.Xf,e),w.set_nodemat_value(d,f,g,a.fa.id0?x(n(a.ba.id0,b.C,c.C),0):a.kc.id0))}},DELAY:function(a,b,c,d,e){switch(b.state){case 2:-1==
a.state?(a.state=0,a.Gs=0,c.Qe=!0):0==a.state&&(a.Gs+=e,(a.fa.dl?x(n(a.ba.dl,b.C,c.C),0):a.kc.dl)<a.Gs&&(a.state=-1,c.ea=a.za,c.Qe=!1))}},APPLY_SHAPE_KEY:function(a,b,c){switch(b.state){case 1:b=a.Gb.id0=F.wc(F.Vc,a.bd.id0,0);c=a.ae.sk;h.check_shape_keys(b)?h.Vu(b,c)||(D.error("Wrong key name:",c),a.mute=!0):(D.error("No shape keys in object:",b.name),a.mute=!0);break;case 2:h.$x(a.Gb.id0,a.ae.sk,a.fa.skv?x(n(a.ba.skv,b.C,c.C),0):a.kc.skv),c.ea=a.za}},OUTLINE:function(a,b,c){switch(b.state){case 1:var d=
a.Gb.id0=F.wc(F.Vc,a.bd.id0,0);d&&d.k&&d.k.ec||(D.error("Can't evaluate 'Outline' logic node: wrong object"),a.mute=!0);break;case 2:d=a.Gb.id0;switch(a.ae.outline_operation){case "PLAY":b=d.k.uf;F.apply_outline_anim(d,b.Ni,b.Oi,b.Pi);break;case "STOP":F.clear_outline_anim(d);break;case "INTENSITY":d.k.Zf=a.fa["in"]?x(n(a.ba["in"],b.C,c.C),0):a.kc["in"]}c.ea=a.za}},MOVE_CAMERA:function(a,b,c){function d(a,b,c,e){switch(C.get_move_style(a)){case C.MS_TARGET_CONTROLS:C.set_trans_pivot(a,b,c);break;
case C.MS_EYE_CONTROLS:case C.MS_STATIC:E.set_tsr(a,e);break;case C.MS_HOVER_CONTROLS:J.sub(c,b,U),J.normalize(U,U),C.set_hover_pivot(a,c),c=b=0,ga[0]=U[0],ga[1]=0,ga[2]=U[2],b=J.dot(ga,U),c=Math.acos(b/(J.length(ga)*J.length(U))),b=U[2]?Math.atan(U[0]/U[2]):0<U[0]?0:Math.PI,0<U[2]&&0<U[0]?R[1]=-(Math.PI+R[1]):0<U[2]&&0>U[0]?R[1]=-(Math.PI+R[1]):0>U[2]&&0>U[0]?(R[0]+=Math.PI,b=-(Math.PI-b)):0>U[2]&&0<U[0]&&(R[0]+=Math.PI,b-=Math.PI),C.rotate_hover_camera(a,b+Math.PI,-c,!0,!0)}E.A(a);p.sync_transform(a)}
function e(a,b,c,d){P.lookAt(b,c,G.AXIS_Z,Q);P.invert(Q,Q);u.fromMat4(Q,ca);z.fromMat3(ca,O);z.normalize(O,O);a=W.get_scale(a.k.n);W.set_sep(b,a,O,d)}switch(b.state){case 1:a.Gb.ca=F.wc(F.Vc,a.bd.id0,0);a.Gb.tr=F.wc(F.Vc,a.bd.id1,0);a.Gb.ta=F.wc(F.Vc,a.bd.id2,0);a.state=-1;a.Qb={PC:new Float32Array(3),OC:new Float32Array(3),bv:new Float32Array(3),Nw:new Float32Array(3),EC:new Float32Array(3),av:new Float32Array(3),ij:new Float32Array(8),Vg:new Float32Array(8),wo:new Float32Array(8)};break;case 2:var f=
a.Gb.ca,h=W.get_trans_view(a.Gb.tr.k.n),g=W.get_trans_view(a.Gb.ta.k.n);switch(a.state){case -1:b=a.fa.dur?x(n(a.ba.dur,b.C,c.C),0):a.kc.dur;if(0==b){e(f,h,g,a.Qb.Vg);d(f,h,g,a.Qb.Vg);c.ea=a.za;break}c=W.get_trans_view(f.k.n);J.copy(c,a.Qb.PC);var k=C.get_move_style(f);k==C.MS_HOVER_CONTROLS?J.copy(f.k.yb,a.Qb.Nw):k==C.MS_STATIC||k==C.MS_EYE_CONTROLS?(W.copy(f.k.n,a.Qb.ij),e(f,h,g,a.Qb.Vg)):J.copy(f.k.pivot,a.Qb.Nw);J.copy(h,a.Qb.OC);J.copy(g,a.Qb.EC);a.state=0;var l=M.animate(0,1,1E3*b,function(b){y.Ba()&&
(k==C.MS_STATIC||k==C.MS_EYE_CONTROLS?W.interpolate(a.Qb.ij,a.Qb.Vg,G.smooth_step(b),a.Qb.wo):(a.Qb.av=J.lerp(a.Qb.Nw,a.Qb.EC,G.smooth_step(b),a.Qb.av),a.Qb.bv=J.lerp(a.Qb.PC,a.Qb.OC,G.smooth_step(b),a.Qb.bv)),d(f,a.Qb.bv,a.Qb.av,a.Qb.wo),1==b&&(a.state=1))});break;case 1:M.clear_animation(l),a.state=-1,c.ea=a.za}}},SET_CAMERA_MOVE_STYLE:function(a,b,c){switch(b.state){case 2:b=y.hk(c.Ua),E.A(b),p.sync_transform(b),c.ea=a.za}},MOVE_TO:function(a,b,c){function d(a,b){E.set_tsr(a,b);E.A(a);p.sync_transform(a)}
switch(b.state){case 1:a.Gb.ob=F.wc(F.Vc,a.bd.id0,0);a.Gb.de=F.wc(F.Vc,a.bd.id1,0);a.state=-1;a.Fb={nz:new Float32Array(8),su:new Float32Array(8),pA:new Float32Array(8)};break;case 2:var e=a.Gb.ob;W.copy(a.Gb.ob.k.n,a.Fb.nz);W.copy(a.Gb.de.k.n,a.Fb.su);switch(a.state){case -1:b=a.fa.dur?x(n(a.ba.dur,b.C,c.C),0):a.kc.dur;if(0==b){d(e,a.Fb.su);c.ea=a.za;break}a.state=0;var f=M.animate(0,1,1E3*b,function(b){y.Ba()&&(a.Fb.mR=W.interpolate(a.Fb.nz,a.Fb.su,G.smooth_step(b),a.Fb.pA),d(e,a.Fb.pA),1==b&&(a.state=
1))});break;case 1:M.clear_animation(f),a.state=-1,c.ea=a.za}}},TRANSFORM_OBJECT:function(a,b,c){function d(a,b,c){0==c?E.set_tsr(a,b):E.set_tsr_rel(a,b);E.A(a);p.sync_transform(a)}switch(b.state){case 1:a.Gb.ob=F.wc(F.Vc,a.bd.id0,0);a.state=-1;a.Fb={ys:0,ij:new Float32Array(8),Vg:new Float32Array(8),wo:new Float32Array(8)};break;case 2:var e=a.Gb.ob;switch(a.state){case -1:ga[0]=a.fa.trx?x(n(a.ba.trx,b.C,c.C),0):a.kc.trx;ga[1]=a.fa["try"]?x(n(a.ba["try"],b.C,c.C),0):a.kc["try"];ga[2]=a.fa.trz?x(n(a.ba.trz,
b.C,c.C),0):a.kc.trz;U[0]=a.fa.rox?x(n(a.ba.rox,b.C,c.C),0)*Math.PI/180:a.kc.rox;U[1]=a.fa.roy?x(n(a.ba.roy,b.C,c.C),0)*Math.PI/180:a.kc.roy;U[2]=a.fa.roz?x(n(a.ba.roz,b.C,c.C),0)*Math.PI/180:a.kc.roz;var f=a.fa.sc?n(a.ba.sc,b.C,c.C):a.kc.sc;G.euler_to_quat(U,O);W.set_sep(ga,f,O,a.Fb.Vg);a.Fb.ys=a.ae.space_type;switch(a.Fb.ys){case 0:E.get_tsr(e,a.Fb.ij);break;case 1:E.get_tsr_rel(e,a.Fb.ij);break;case 2:E.get_tsr_rel(e,a.Fb.ij),W.multiply(a.Fb.ij,a.Fb.Vg,a.Fb.Vg)}b=a.fa.dur?x(n(a.ba.dur,b.C,c.C),
0):a.kc.dur;if(0==b){d(e,a.Fb.Vg,a.Fb.ys);c.ea=a.za;break}a.state=0;f=M.animate(0,1,1E3*b,function(b){y.Ba()&&(W.interpolate(a.Fb.ij,a.Fb.Vg,G.smooth_step(b),a.Fb.wo),d(e,a.Fb.wo,a.Fb.ys),1==b&&(a.state=1))});break;case 1:M.clear_animation(f),a.state=-1,c.ea=a.za}}},SPEAKER_PLAY:function(a,b,c){switch(b.state){case 1:a.obj=F.wc(F.Vc,a.bd.id0,0);void 0==a.fa.not_wait&&(a.fa.not_wait=!0);break;case 2:switch(l.is_playing(a.obj)||0!=a.state||(a.state=1),a.state){case -1:for(var d in b.yd){var e=b.yd[d].Ye.ea;
-1!=e&&(e=b.yd[d].O[e],"SPEAKER_PLAY"==e.type&&e!=a&&0==e.state&&e.obj==a.obj&&(e.state=1))}a.fa.not_wait||(c.Qe=!0);l.play_def(a.obj);a.state=0;break;case 0:a.fa.not_wait&&(c.ea=a.za,a.state=-1);break;case 1:a.fa.not_wait||(c.Qe=!1);c.ea=a.za;a.state=-1;break;default:G.r("Unknown state of "+a.name),a.state=-1}}},SPEAKER_STOP:function(a,b,c){switch(b.state){case 1:a.obj=F.wc(F.Vc,a.bd.id0,0);break;case 2:l.stop(a.obj),c.ea=a.za}},STOP_ANIM:function(a,b,c){switch(b.state){case 1:a.obj=a.fa.env?F.get_world_by_name(a.Xn[0],
0):m(a);break;case 2:k.stop(a.obj,k.SLOT_ALL),a.fa.rst&&k.set_first_frame(a.obj,k.SLOT_ALL),c.ea=a.za}},STOP_TIMELINE:function(a,b,c,d){switch(b.state){case 2:a.fa.rst&&B.UB(d),B.Dw(),c.ea=a.za}},CONSOLE_PRINT:function(a,b,c){switch(b.state){case 2:var d={},e;for(e in a.ba)d[a.ba[e][1]]=n(a.ba[e],b.C,c.C);D.log(a.ae.msg,JSON.stringify(d));c.ea=a.za}},STRING:function(a,b,c){switch(b.state){case 2:var d=a.fa.id0?x(n(a.ba.id0,b.C,c.C),1):a.Oh.id0,e=a.fa.id1?x(n(a.ba.id1,b.C,c.C),1):a.Oh.id1,h=0;switch(a.ae.string_operation){case 0:h=
d+e;break;case 1:h=d.indexOf(e);break;case 2:h=d.replace(e,a.fa.id2?x(n(a.ba.id2,b.C,c.C),1):a.Oh.id2);break;case 3:var g=a.ba,h=d.substring(0,d.indexOf(e));f(g.dst1,b.C,c.C,d.substring(d.indexOf(e)+1,d.length));""==n(g.dst,b.C,c.C)&&(h=n(g.dst1,b.C,c.C),f(g.dst1,b.C,c.C,""));break;case 4:switch(a.ae.condition){case 5:h=d==e?1:0;break;case 4:h=d!=e?1:0;break;case 3:h=d<e?1:0;break;case 2:h=d>e?1:0;break;case 1:h=d<=e?1:0;break;case 0:h=d>=e?1:0}}f(a.ba.dst,b.C,c.C,h);c.ea=a.za}},GET_TIMELINE:function(a,
b,c,d){switch(b.state){case 2:d=a.fa.nla?x(B.get_frame(d),0):x(M.get_frame(d),0),f(a.ba.vd,b.C,c.C,d),c.ea=a.za}},JSON:function(a,b,c){function e(a,b,c,f){for(var h=0;h<b.length;h++){for(var g=b[h].split("."),k=a,l=c[h],m=0;m<g.length&&(k=k[g[m]],void 0!==k&&null!==k);m++);k=d(k);f[l]=k}}function h(a,b,c,e){e||(e={});for(var f=0;f<b.length;f++){var g=b[f].split("."),k=e,l=c[f];if(!(!l in a)){for(var m=0;m<g.length-1;m++)void 0===k[g[m]]&&(k[g[m]]=isNaN(g[m+1])?{}:[]),k=k[g[m]];k[g[g.length-1]]=d(a[l])}}}
switch(b.state){case 2:switch(a.ae.json_operation){case "PARSE":try{var g=JSON.parse(x(n(a.ba.jsn,b.C,c.C),1));e(g,a.OL,a.PL,c.C)}catch(k){D.error("logic script error: non valid JSON string")}break;case "ENCODE":g={},h(c.C,a.VI,a.WI,g),g=x(JSON.stringify(g),1),f(a.ba.jsn,b.C,c.C,g)}c.ea=a.za}},JS_CALLBACK:function(a,b,c){switch(b.state){case 2:for(var e=a.fa.cb?x(n(a.ba.cb,b.C,c.C),1):a.Oh.cb,h=[],g=0,k="id"+g,l=a.ae.js_cb_params;k in l;)k=0==l[k]?F.wc(F.Vc,a.bd[k],0):n(a.ba[k],b.C,c.C),h.push(k),
g++,k="id"+g;l=[];g=0;for(k="out"+g;k in a.ba;)k=n(a.ba[k],b.C,c.C),l.push(k),g++,k="out"+g;if(e in L)for(L[e](h,l),e=0;e<l.length;e++)k="out"+e,k in a.ba&&f(a.ba[k],b.C,c.C,d(l[e]));else D.error("logic script error: no custom callback with id "+e);c.ea=a.za}},EMPTY:t};a.xK=function(a,b){var c={sd:b,PB:a.name,state:0,zk:null,Ua:a,lu:null,yd:[],ip:[],C:{}};a.WP=c;v(a,c)};a.update=function(a,b){var c=B.kK();if(!(0>=c))for(var d=0;d<Z.length;d++)for(var e=d,f=a,h=b,g=c,k=Z[e],l=0;l<Z[e].yd.length;l++){k.lu=
Z[e].yd[l];var m=Z[e].yd[l],p=k,n=f,u=h,r=g,t=m.O;if(t.length){for(var v=0;v<t.length;v++)t[v].ds=!1;for(v=0;v<t.length;v++){if(0<=m.Ye.ea)var z=t[m.Ye.ea];else break;if(z.ds)break;if(z.mute)if("ENTRYPOINT"==z.type)break;else m.Ye.ea=z.za,z.ds=!0;else z.yB(z,p,m.Ye,n,u,r),z.ds=!0}}}};a.IF=function(a,b){L[a]=b};a.gM=function(a){delete L[a]};a.yM=function(a,b){for(var c=0;c<Z.length;c++)if(Z[c].PB==a){for(var c=Z[c],d=0;d<c.yd.length;d++){var e=c.yd[d].O[0];if(e.name==b){e.fa.js&&(e.mute=!1);c.yd[d].Ye.ea=
0;break}}break}};a.cleanup=function(){Z.length=0;L={}}};b4w.module.__math=function(a,q){function e(a,b){for(var c=a[1],e=1,f=2;f<a.length;f++)4!=f&&8!=f&&Math.abs(a[f])>Math.abs(c)&&(c=a[f],e=f);for(var g=Math.floor(e/3),e=e%3,c=.5*Math.atan(2*c/(a[3*g+g]-a[3*e+e])),f=0;f<b.length;f++)b[f]=0==f||4==f||8==f?1:0;b[e+3*g]=-Math.sin(c);b[g+3*e]=Math.sin(c);b[g+3*g]=Math.cos(c);b[e+3*e]=Math.cos(c);return b}function c(a){return Math.sqrt(a[1]*a[1]+a[2]*a[2]+a[5]*a[5])}var b=q("__mat3"),n=q("__vec3"),f=new Float32Array(3),t=new Float32Array(9),g=new Float32Array(9),
m=new Float32Array(9),v=new Float32Array(9);a.get_pline_directional_vec=function(a,b){b=b||new Float32Array(3);b[0]=a[3];b[1]=a[4];b[2]=a[5];return b};a.get_pline_initial_point=function(a,b){b=b||new Float32Array(3);return n.copy(a,b)};a.set_pline_initial_point=function(a,b){n.copy(b,a)};a.set_pline_directional_vec=function(a,b){n.normalize(b,f);a[3]=f[0];a[4]=f[1];a[5]=f[2]};a.calc_pline_point=function(a,b,c){c=c||new Float32Array(3);c[0]=a[0]+a[3]*b;c[1]=a[1]+a[4]*b;c[2]=a[2]+a[5]*b};a.HG=function(a,
b){b[0]=0;b[1]=0;for(var c=b[2]=0;c<a.length;c+=3)b[0]+=a[c],b[1]+=a[c+1],b[2]+=a[c+2];return n.scale(b,3/a.length,b)};a.DG=function(a,b,c){for(var e=0;e<c.length;e++)c[e]=0;for(e=0;e<a.length;e+=3){var f=a[e]-b[0],g=a[e+1]-b[1],m=a[e+2]-b[2];c[0]+=f*f;c[1]+=f*g;c[2]+=f*m;c[4]+=g*g;c[5]+=g*m;c[8]+=m*m}c[3]=c[1];c[6]=c[2];c[7]=c[5];for(e=0;e<c.length;e++)c[e]*=3/a.length;return c};a.hJ=function(a,d){var f=b.copy(a,t);if(5E-4>c(f))return b.identity(d);var n=e(f,g),q=b.transpose(n,m);b.multiply(f,q,
v);b.multiply(n,v,f);for(var B=b.copy(n,d),F=1;5E-4<=c(f)&&100>F;)n=e(f,g),q=b.transpose(n,m),b.multiply(f,q,v),b.multiply(n,v,f),b.multiply(n,B,B),F++;return B};a.point_plane_dist=function(a,b){return b[0]*a[0]+b[1]*a[1]+b[2]*a[2]+b[3]}};b4w.module.__nla=function(a,q){function e(){return{type:"CLIP",ma:0,Oa:0,Ih:!1,paused:!1,ef:"",jn:"",Xb:0,gm:null,di:0,tj:0,vz:0,uz:0,dD:!1,scale:1,repeat:1,Tx:0}}function c(a,b,d){if(a.animation_data){var e=a.animation_data.nla_tracks;if(e)for(var f=0;f<e.length;f++)e[f].gm=d,b.push(e[f])}a=a.nodes;for(f=0;f<a.length;f++)if(e=a[f],e.node_group){var g=e.node_group.node_tree;if(g){var k=d.slice();k.push(e.name);c(g,b,k)}}}function b(a,b){var c=Math.round(a)-b.ma;b.Th&&(c%=b.ti,0>c&&(c+=b.ti));return b.wb+
c}function n(a,b){var c=(b-H)*D.Pc()+a.wb;c>a.ma?(c-=a.ma,a.cyclic&&(c%=a.Oa-a.ma+1),c+=a.ma):c=a.ma;return c}function f(a,b){a=y.clamp(a,b.ma,b.Oa);var c=a==b.Oa?b.Tx:b.di+(a-b.ma)/b.scale%(b.tj-b.di);b.dD&&(c=b.tj-c+b.di);return c}function t(a,b){for(var c=[],d=0;d<a.length;d++){var f=a[d],g=f.strips;if(g)for(var k=0;k<g.length;k++){var m=g[k],n=e();n.type=m.type;n.ma=m.frame_start;n.Oa=m.frame_end;n.Xb=b;n.di=m.action_frame_start;n.tj=m.action_frame_end;n.dD=m.use_reverse;n.scale=m.scale;n.repeat=
m.repeat;m.action&&(n.ef=m.action.name,n.jn=m.action.uuid,n.gm=f.gm);c.push(n)}}return c}function g(a){return("SPEAKER"==a.type||"LAMP"==a.type)&&a.data.animation_data&&a.data.animation_data.nla_tracks.length?!0:!1}function m(a){if("MESH"!=a.type||!a.data)return!1;a=a.data.materials;if(!a)return!1;for(var b=0;b<a.length;b++){var c=a[b],d=c.node_tree;if(c=c.use_nodes&&d)a:{if(d.animation_data&&(c=d.animation_data.nla_tracks)&&c.length){c=!0;break a}d=d.nodes;for(c=0;c<d.length;c++);c=!1}if(c)return!0}return!1}
function v(a,b){var c=C.get_active();if(c.ia){var d=n(c.ia,b);c.ia.wb-=d-a;c.ia.Jl=!0}}var x=q("__animation");q("__config");var d=q("__objects"),k=q("__obj_util"),r=q("__print"),C=q("__scenes"),B=q("__sfx"),F=q("__textures"),D=q("__time"),y=q("__util"),A=[],H=-1;a.kj=function(a,b){var d;d=null;for(var f=b.D.length-1;0<=f;f--){var m=b.D[f];if(m.Ua.b4w_use_nla&&(d=m,m.Ua.Px))break}if(d){d.hB=!0;var n=0;if((f=a.animation_data)&&f.nla_tracks.length){var l=f.nla_tracks;if(k.is_armature(b)||k.is_camera(b)||
k.is_mesh(b)||k.is_empty(b)||k.is_lamp(b)||k.is_speaker(b)||k.is_world(b))l=t(l,n),l.length&&(b.rf=b.rf.concat(l),n++)}g(a)&&(l=a.data.animation_data.nla_tracks,l=t(l,n),l.length&&(b.rf=b.rf.concat(l),n++));if(k.is_mesh(b))for(m=a.data.materials,f=0;f<m.length;f++){var r=m[f];if(r.use_nodes&&r.node_tree&&(l=[],c(r.node_tree,l,[r.name]),l=t(l,n),l.length)){for(var r=n,v=l,q=x.KJ(),A=[],B=0,C=0;C<v.length;C++){var L=v[C];""!=L.jn?L=y.keysearch("uuid",L.jn,q):(L=L.ef,L=y.keysearch("name",L,q)||y.keysearch("name",
L+"_B4W_BAKED",q));if(L){var L=L.fcurves,O=[],U;for(U in L)O.push(U);A.push(O)}}for(C=0;C<A.length;C++){q=!1;for(L=0;L<C;L++)if(y.eG(A[C],A[L])){v[C].Xb=v[L].Xb;q=!0;break}q||(v[C].Xb=n+B++)}n=r+B;b.rf=b.rf.concat(l)}}if(!k.is_world(b)){for(f=0;f<a.particle_systems.length;f++)m=a.particle_systems[f],U=m.settings,"EMITTER"==U.type&&U.b4w_allow_nla&&(U=e(),U.type="CLIP",U.ma=d.Ua.frame_start,U.Oa=d.Ua.frame_end+1,U.ef=m.name,U.Xb=n,U.di=U.ma,U.tj=U.Oa,b.rf.push(U),n++);m=n+1;for(f=0;f<b.yc.length;f++)l=
b.yc[f],l.BF&&(n=m,U=e(),U.type="CLIP",U.ma=d.Ua.frame_start,U.Oa=d.Ua.frame_end+1,U.ef=l.name,U.Xb=n,U.di=U.ma,U.tj=U.Oa,b.rf.push(U))}}};a.EO=function(a,b,c){a.ia||(a.ia={ma:a.frame_start,Oa:a.frame_end,wb:0,Eo:-1,Uo:a.frame_end,Vo:a.frame_start,Qm:null,cyclic:b,Gb:[],T:[],PB:a.name,Ci:!1,Jl:!1,hw:!0},A.push(a.ia));b=a.ia;for(var f=d.iK(a,c),g=0;g<f.length;g++){var k=f[g];if(k.rf.length){for(var l=0;l<k.D.length;l++){var m=k.D[l];m.Ua==a&&m.hB&&b.Gb.push(k)}for(var l=k.rf,m=b,n=k.name,t=0;t<l.length;t++){var v=
l[t];m.ma>v.Oa||m.Oa<v.ma?(r.warn("NLA: Strip is out of scene range: "+(n+" ["+v.ma+":"+v.Oa+"]")),l.splice(t,1),t--):v.ef||"CLIP"!=v.type||(r.warn('NLA: no action in strip for object "'+n+'".'),l.splice(t,1),t--)}k=k.rf;l=b;for(m=0;m<k.length;m++){for(var n=k[m],t=l.ma,v=l.Oa+1,q=0;q<k.length;q++){var x=k[q];n.Xb==x.Xb&&(x.Oa<=n.ma&&(t=n.ma),x.ma>=n.Oa&&(v=Math.min(v,x.ma)))}n.vz=t;n.uz=v;n.Tx=0===n.repeat%1?n.tj:n.di+n.repeat%1*(n.tj-n.di)}}}a=a.q.Sm;for(g=0;g<a.length;g++)f=a[g].q,f.Pm&&(f.ya||
f.Rc)&&f.jg==c&&(k=e(),k.type="VIDEO",f.Th?(k.ma=0,k.Oa=b.Oa):(k.ma=y.clamp(f.ma,0,b.Oa),k.Oa=y.clamp(f.ma+f.ti,0,b.Oa)),k.ef=a[g].name,b.T.push(f))};a.start=function(){H=0};a.kK=function(){return H};a.$Q=function(a){return a.ia?a.ia.wb:null};a.LR=function(a,b){return a.ia?(a.ia.wb=b,!0):!1};a.update=function(a,c){if(!(0>H)){0==H&&(H=a);for(var d=0;d<A.length;d++){var e=A[d];e.Ci&&(e.wb-=D.Pc()*c);var g=n(e,a);if((!e.Ci||e.Jl)&&g>=e.Uo)if(e.cyclic){var g=e,k=a;g.Qm&&g.Qm();v(g.Vo,k);g.hw=!0;g=n(g,
k)}else{var k=e,l=g;k.Ci=!0;k.wb-=l-k.Uo;k.Qm&&k.Qm()}if(!e.Ci||e.Jl){for(var k=e,l=g,m=0;m<k.Gb.length;m++){for(var r=k.Gb[m],t=r.rf,q=0;q<t.length;q++){var C=t[q];"SOUND"==C.type&&l<k.Eo-1E-6&&(C.Ih=!1)}for(q=0;q<t.length;q++)switch(C=t[q],C.type){case "CLIP":if(C.vz<=l&&l<C.uz&&!C.Ih){var Z=r,L=C,O=L.gm;""!=L.jn?x.$F(Z,O,L.jn,L.Xb):x.apply(Z,O,L.ef,L.Xb);x.set_behavior(Z,x.AB_FINISH_STOP,L.Xb);O=f(L.ma,L);x.set_frame(Z,O,L.Xb);for(Z=0;Z<t.length;Z++)t[Z]!=C&&t[Z].Xb==C.Xb&&(t[Z].Ih=!1);C.Ih=!0}C.Ih&&
(Z=r,L=f(l,C),1E-6<Math.abs(L-x.Uz(Z,C.Xb))&&x.set_frame(Z,L,C.Xb));break;case "SOUND":(l<k.Eo-1E-6||k.Eo<C.ma)&&C.ma<=l&&l<C.Oa&&!C.Ih&&(Z=r,O=C,L=(O.ma-l)/D.Pc(),O=(O.Oa-O.ma)/D.Pc(),B.play(Z,L,O),C.Ih=!0),k.Eo<C.Oa&&C.Oa<=l&&C.Ih&&(C.Ih=!1)}}k=a;l=e;m=g;for(r=0;r<l.T.length;r++)if(t=l.T[r],t.ya||t.Rc){q=F.mD(t);C=t;Z=y.clamp(b(m,C),C.wb,C.wb+F.nD(C)-1);C.Rc&&(Z=F.fP(C,Z),Z==C.cp&&Z--);C=Z;Z=F.oD(t);O=L=!1;if(l.Jl||l.hw)O=!0;if(!l.Ci){var U;U=b(m,t);U=t.wb<=U&&U<=t.wb+F.nD(t);var ga=F.pD(t);t.Th&&
C==Z&&(O=!0);ga||q==C||(O=!0);U&&!ga?F.play_video(t.name,t.jg):U&&ga?L=!0:!U&&ga&&(t.ya&&q<C?L=!0:F.pause_video(t.name,t.jg))}O?(F.QM(t.name,C,t.jg),t.Rc&&(t.$i=F.ps(t,k))):L&&F.qD(t)&&(t.ya?F.aD(t):(q=F.ps(t,k),q!=t.$i&&(t.Jh=C,F.$C(t)),t.$i=q))}e.Eo=g}e.Jl=!1;e.hw=!1}}};a.cleanup=function(){A.length=0;H=-1};a.ry=function(a){var b=a.animation_data;return b&&b.nla_tracks.length||g(a)||m(a)?!0:!1};a.set_frame=v;a.get_frame=function(a){var b=C.get_active();return b.ia?n(b.ia,a):-1};a.Dw=function(){var a=
C.get_active();if(a.ia){a.ia.Ci=!0;for(var a=a.ia.T,b=0;b<a.length;b++){var c=a[b];F.pause_video(c.name,c.jg)}}};a.tB=function(a){var b=C.get_active();b.ia&&(b.ia.Ci=!1,b.ia.Qm=a?a:null)};a.get_frame_start=function(){var a=C.get_active();return a.ia?a.ia.ma:-1};a.get_frame_end=function(){var a=C.get_active();return a.ia?a.ia.Oa:-1};a.is_play=function(){var a=C.get_active();return a.ia?!a.ia.Ci:!1};a.check_nla=function(){var a=C.get_active();return a.ia?a.b4w_use_nla:!1};a.check_logic_nodes=function(){var a=
C.get_active();return a.ia?0<a.b4w_logic_nodes.length:!1};a.set_range=function(a,b){var c=C.get_active();if(c.ia)c.ia.Vo=a,c.ia.Uo=b;else return!1};a.pw=function(a){var b=C.get_active();b.ia&&(b.ia.Uo=a)};a.dN=function(a){var b=C.get_active();b.ia&&(b.ia.Vo=a)};a.reset_range=function(){var a=C.get_active();if(a.ia)a=a.ia,a.Vo=a.ma,a.Uo=a.Oa;else return!1};a.set_cyclic=function(a){var b=C.get_active();if(b.ia)b.ia.cyclic=a;else return!1};a.clear_callback=function(){var a=C.get_active();a.ia&&(a.ia.Qm=
null)};a.UB=function(a){var b=C.get_active().ia;b&&(b.wb=-(a-H)*D.Pc()+b.Vo,b.Jl=!0)};a.get_frame_end=function(){var a=C.get_active().ia;return a?a.Oa:null}};b4w.module.__camera=function(a,q){function e(a,b,c,d,e){ua.set_translation(a,b);c&&y(a,b,c);h(a,d);u(a,e)}function c(a,b,c,d,e,f,g,k){var m=a.k;ua.set_translation(a,b);m.pivot.set(c);y(a,b,c);h(a,d);u(a,e);l(a,f);M(a,g);m.use_panning=k}function b(a,b,c,d,e,f,h,g){var k=a.k;ua.set_translation(a,b);k.yb.set(c);y(a,b,c);z(a,d);P(a,e);E(a,f);W(a,h);k.Zj=g}function n(a,b,c){var d=a.k,e=ia.get_trans_view(d.n),f=ia.get_quat_view(d.n),d=za;d.set(Y.AXIS_Z);d[3]=0;a=k(a,la)[1];f=Y.quat_to_dir(f,Y.AXIS_MZ,va);
pa.set_pline_initial_point(da,e);pa.set_pline_directional_vec(da,f);if(!Y.line_plane_intersect(d,-b,da,c)||Math.abs(a)<xa)Ea.warn("Active hover camera view vector and the supporting plane are parallel to each other. Hover pivot will be set based on the camera position."),c[0]=e[0],c[1]=0,c[2]=e[2];return c}function f(b){for(var c=b.k,d=0;d<b.D.length;d++){var e=b.D[d].R[0];if(e.type==a.Yd)switch(c.pb){case a.MS_TARGET_CONTROLS:var f=ia.get_trans_view(c.n);c.yi=aa.dist(f,c.pivot);c.zi=e.top;break;
case a.MS_HOVER_CONTROLS:f=ia.get_trans_view(c.n),c.yi=aa.dist(f,c.yb),c.zi=e.top}}}function t(a){a={type:a,name:"",dC:1,width:0,height:0,he:null,io:null,Zb:null,ee:null,bb:0,od:0,near:0,far:0,left:0,right:0,top:0,bottom:0,xd:T.create(),n:new Float32Array(9),rb:new Float32Array(16),lx:new Float32Array(16),ab:new Float32Array(16),Ic:new Float32Array(16),Ts:new Float32Array(16),Uv:new Float32Array(16),xf:new Float32Array(16),ye:ia.Rj(),Us:ia.Rj(),Xo:ia.Rj(),hs:ia.Rj(),gp:ia.Rj(),dof_distance:0,dof_front_start:0,
dof_front_end:0,dof_rear_start:0,dof_rear_end:0,dof_power:0,Xa:0,tc:null,pz:!1,$c:!1,dof_on:!1,Ar:new Float32Array(3),Ag:m(),dj:0,te:0,Nb:null,ug:null,Pn:null,tq:new Float32Array(4),lm:new Float32Array(4)};a.xd[0]=a.xd[2]=45;a.xd[1]=a.xd[3]=55;return a}function g(a,b){var c=t(a.type);c.name=a.name;c.dC=a.dC;c.width=a.width;c.height=a.height;b||(c.he=a.he,c.io=a.io,c.Zb=a.Zb,c.ee=a.ee);c.bb=a.bb;c.od=a.od;c.near=a.near;c.far=a.far;c.left=a.left;c.right=a.right;c.top=a.top;c.bottom=a.bottom;T.copy(a.xd,
c.xd);ia.copy(a.n,c.n);oa.copy(a.rb,c.rb);oa.copy(a.ab,c.ab);oa.copy(a.Ic,c.Ic);oa.copy(a.Ts,c.Ts);oa.copy(a.Uv,c.Uv);oa.copy(a.xf,c.xf);ia.copy(a.ye,c.ye);ia.copy(a.Us,c.Us);ia.copy(a.Xo,c.Xo);ia.copy(a.hs,c.hs);ia.copy(a.gp,c.gp);c.dof_distance=a.dof_distance;c.dof_front_start=a.dof_front_start;c.dof_front_end=a.dof_front_end;c.dof_rear_start=a.dof_rear_start;c.dof_rear_end=a.dof_rear_end;c.dof_power=a.dof_power;c.Xa=a.Xa;c.tc=a.tc;c.pz=a.pz;c.$c=a.$c;c.dof_on=a.dof_on;aa.copy(a.Ar,c.Ar);var d=
a.Ag,e=c.Ag;T.copy(d.left,e.left);T.copy(d.right,e.right);T.copy(d.top,e.top);T.copy(d.bottom,e.bottom);T.copy(d.near,e.near);T.copy(d.far,e.far);c.dj=a.dj;c.te=a.te;a.Nb&&(c.Nb=T.clone(a.Nb));if(a.ug){d=a.ug.length;c.ug=Array(d);for(e=0;e<d;e++)c.ug[e]=aa.clone(a.ug[e]);c.Pn=new Float32Array(a.Pn)}T.copy(a.tq,c.tq);T.copy(a.lm,c.lm);return c}function m(){return{left:new Float32Array([0,0,0,0]),right:new Float32Array([0,0,0,0]),top:new Float32Array([0,0,0,0]),bottom:new Float32Array([0,0,0,0]),near:new Float32Array([0,
0,0,0]),far:new Float32Array([0,0,0,0])}}function v(b){switch(b){case "STATIC":return a.MS_STATIC;case "TARGET":return a.MS_TARGET_CONTROLS;case "EYE":return a.MS_EYE_CONTROLS;case "HOVER":return a.MS_HOVER_CONTROLS;default:Y.r("Unknown move style")}}function x(b){var c=t(b);if(b==a.Kc)return c;switch(b){case a.hd:C(c,40,.1,1E3);break;case a.Yd:C(c,2.5,.1,1E3);break;case a.ng:break;case a.bh:break;case a.bi:break;case a.pc:case a.Bc:case a.Wd:case a.Xd:Y.r("Stereo camera may only be created from perspective one");
break;default:Y.r("Unknown camera type")}return c}function d(b,c,d){b.type!=a.pc&&b.type!=a.Bc&&b.type!=a.Wd&&b.type!=a.Xd&&Y.r("set_stereo_params(): wrong camera type");if(b.type==a.pc||b.type==a.Bc)b.dj=c;b.te=d;R(b,b.bb);if(Aa.Ba()&&(c=Aa.get_active(),b=c.q.Sc))for(c=I.ga(Aa.hk(c),c).R,d=0;d<c.length;d++)N(c[d],b)}function k(a,b){var c=ia.get_quat_view(a.k.n);return r(c,b)}function r(a,b){var c=Y.quat_to_dir(a,Y.AXIS_Z,va),d=Y.quat_to_dir(a,Y.AXIS_MY,X),e=-Math.asin(c[2]/aa.length(c)),c=Math.abs(e)>
Math.PI/4?aa.scale(d,-Y.sign(e),ya):aa.scale(c,-Y.sign(d[2]),ya),f=Math.atan(Math.abs(c[0]/c[1]));0<d[2]&&(e=Y.sign(e)*Math.PI-e);d=f;0<c[1]&&(d=Math.PI-d);0>c[0]&&(d=2*Math.PI-d);b[0]=d;b[1]=e;return b}function C(b,c,d,e,f){switch(b.type){case a.hd:case a.pc:case a.Bc:b.od=c;b.bb=1;break;case a.Yd:b.top=c;b.bb=1;break;case a.ng:b.od=c;b.bb=f/c;break;case a.bh:b.top=c;b.bb=f/c;break;case a.Wd:case a.Xd:break;default:Ea.error("set_frustum(): Unsupported camera type: "+b.type)}b.near=d;b.far=e}function B(b,
c){var d=ia.bc(c.k.n,va),e=ia.ud(c.k.n,Fa),d=oa.fromRotationTranslation(e,d,Sa);oa.invert(d,b.rb);if(Aa.Ba())var f=Aa.get_active(),f=Aa.Da(f,V.ai);if(b.type==a.pc||f&&f.enable_hmd_stereo&&b.type==a.Wd)b.rb[12]+=b.te/2;else if(b.type==a.Bc||f&&f.enable_hmd_stereo&&b.type==a.Xd)b.rb[12]-=b.te/2;if(b.Nb){ia.from_mat4(b.rb,b.Xo);ia.invert(b.Xo,b.hs);var f=b.Nb[0],d=b.Nb[1],e=b.Nb[2],h=b.Nb[3],g=b.lx;g[0]=1-2*f*f;g[1]=-2*f*d;g[2]=-2*f*e;g[3]=0;g[4]=-2*f*d;g[5]=1-2*d*d;g[6]=-2*d*e;g[7]=0;g[8]=-2*f*e;g[9]=
-2*d*e;g[10]=1-2*e*e;g[11]=0;g[12]=-2*f*h;g[13]=-2*d*h;g[14]=-2*e*h;g[15]=1;oa.multiply(b.rb,b.lx,b.rb);R(b,b.bb,!0);f=za;d=Sa;oa.invert(b.rb,d);oa.transpose(d,d);T.transformMat4(b.Nb,d,f);d=Ga;d[0]=(Y.sign(f[0])+b.ab[8])/b.ab[0];d[1]=(Y.sign(f[1])+b.ab[9])/b.ab[5];d[2]=-1;d[3]=(1+b.ab[10])/b.ab[14];T.scale(f,2/(f[0]*d[0]+f[1]*d[1]+f[2]*d[2]+f[3]*d[3]),f);b.ab[2]=f[0];b.ab[6]=f[1];b.ab[10]=f[2]+1;b.ab[14]=f[3]}ia.from_mat4(b.rb,b.ye);ia.invert(b.ye,b.Us);Q(b);ca(b);ia.copy(c.k.n,b.n)}function F(b,
c,d,e){oa.lookAt(c,d,e,b.rb);d=Aa.get_active();d=Aa.Da(d,V.ai);Aa.Ba()&&(d=Aa.get_active(),d=Aa.Da(d,V.ai));if(b.type==a.pc||d&&d.enable_hmd_stereo&&b.type==a.Wd)b.rb[12]+=b.te/2;else if(b.type==a.Bc||d&&d.enable_hmd_stereo&&b.type==a.Xd)b.rb[12]-=b.te/2;ia.from_mat4(b.rb,b.ye);Q(b);ca(b);ia.set_trans(c,b.n)}function D(a,b,c){c=aa.subtract(c,b,va);aa.length(c)&&(aa.normalize(c,c),c=Y.LB(Y.AXIS_MZ,c,Fa),ua.set_rotation(a,c));ua.set_translation(a,b)}function y(a,b,c){var d=a.k,e=w(a);D(a,b,c);e?(b=
aa.copy(d.xe,va),aa.negate(b,b),sa.correct_up(a,b,!0)):sa.correct_up(a,d.xe,!0)}function A(a,b){var c=a.k,d=b.R;d||Y.r("Wrong object");for(var e=b.aC,f=0;f<e.length;f++){var h=e[f];aa.copy(ia.get_trans_view(c.n),h.Ar)}for(f=0;f<d.length;f++)if(h=d[f],B(h,a),Y.Fl(h.Ic,h.Ag),h.tc&&h.dof_on){var e=ia.get_trans_view(c.n),g=ua.get_translation(h.tc,va),e=aa.dist(e,g);h.dof_distance=e}}function H(b){var c=b.k;c.pb==a.MS_TARGET_CONTROLS&&(c.Hm=w(b))}function w(a){a=ia.get_quat_view(a.k.n);return 0>Y.quat_to_dir(a,
Y.AXIS_Y,va)[2]}function h(b,c){var d=b.k;if(c){d.gb=d.gb||{};d.gb.left=c.left;d.gb.right=c.right;d.gb.Yl=c.left;d.gb.pm=c.right;d.gb.camera_space=Boolean(c.camera_space);var e=b.k;!(d=e.gb)||e.pb!=a.MS_EYE_CONTROLS&&e.pb!=a.MS_TARGET_CONTROLS||(e=k(b,la),d.camera_space?(d.left+=e[0],d.right+=e[0]):(d.Yl-=e[0],d.pm-=e[0]),d.left=Y.angle_wrap_0_2pi(d.left),d.right=Y.angle_wrap_0_2pi(d.right),d.Yl=Y.angle_wrap_0_2pi(d.Yl),d.pm=Y.angle_wrap_0_2pi(d.pm))}else d.gb=null}function u(a,b){var c=a.k;b?(c.oa=
c.oa||{},c.oa.down=b.down,c.oa.up=b.up,c.oa.Cl=b.down,c.oa.Mm=b.up,c.oa.camera_space=Boolean(b.camera_space),p(a)):c.oa=null}function P(a,b){var c=a.k;if(!b){var d=k(a,la);b={down:d[1],up:d[1]}}c.oa=c.oa||{};c.oa.down=b.down;c.oa.up=b.up;p(a);c.kb&&c.oa&&ga(a)}function p(b){var c=b.k,d=c.oa;if(d)switch(c.pb){case a.MS_EYE_CONTROLS:case a.MS_TARGET_CONTROLS:b=k(b,la);d.camera_space?(d.up+=b[1],d.down+=b[1]):(d.Mm-=b[1],d.Cl-=b[1]);d.up=Y.angle_wrap_periodic(d.up,-Math.PI,Math.PI);d.down=Y.angle_wrap_periodic(d.down,
-Math.PI,Math.PI);d.Mm=Y.angle_wrap_periodic(d.Mm,-Math.PI,Math.PI);d.Cl=Y.angle_wrap_periodic(d.Cl,-Math.PI,Math.PI);break;case a.MS_HOVER_CONTROLS:d.up=Y.angle_wrap_periodic(d.up,-Math.PI,Math.PI),d.down=Y.angle_wrap_periodic(d.down,-Math.PI,Math.PI),d.up=Y.clamp(d.up,-Math.PI/2,0),d.down=Y.clamp(d.down,-Math.PI/2,0)}}function z(a,b){var c=a.k;if(!b){var d=ua.im(a,c.yb);b={min:d,max:d}}c.kb=c.kb||{};c.kb.min=b.min;c.kb.max=b.max;c.kb&&c.oa&&ga(a)}function l(a,b){var c=a.k;b?(c.kb=c.kb||{},c.kb.min=
b.min,c.kb.max=b.max):c.kb=null}function M(a,b){var c=a.k;b?(c.oe=c.oe||{},c.oe.min_z=b.min_z,c.oe.max_z=b.max_z):c.oe=null}function E(a,b){var c=a.k;b?(c.Ec=c.Ec||{},c.Ec.min=b.min,c.Ec.max=b.max):c.Ec=null}function W(a,b){var c=a.k;b?(c.Fc=c.Fc||{},c.Fc.min=b.min,c.Fc.max=b.max):c.Fc=null}function G(b){var c=b.k;if(I.is_camera(b))for(var d=b.D,e=0;e<d.length;e++){var f=d[e].R;if(f[0].type===a.Yd){switch(c.pb){case a.MS_TARGET_CONTROLS:var h=ia.get_trans_view(c.n),h=aa.dist(h,c.pivot),h=h/c.yi*c.zi;
break;case a.MS_HOVER_CONTROLS:h=ia.get_trans_view(c.n);h=aa.distance(h,c.yb);h=h/c.yi*c.zi;break;default:h=f[0].top}for(var g=0;g<f.length;g++){var k=f[g];k.top=h;R(k,k.bb)}A(b,d[e])}}}function J(b){var c=b.k,d=c.pb;if(d===a.MS_TARGET_CONTROLS||d===a.MS_EYE_CONTROLS){if(c.gb){var e=c.gb.left,f=c.gb.right,h=k(b,la);(h=d==a.MS_TARGET_CONTROLS?Y.Hj(h[0],e,f):Y.Hj(h[0],f,e))&&(d==a.MS_TARGET_CONTROLS?L(b,h,0):Z(b,h,0))}c.oa&&(e=c.oa.down,f=c.oa.up,h=k(b,la),(h=d==a.MS_TARGET_CONTROLS?Y.Hj(h[1],f,e):
Y.Hj(h[1],e,f))&&(d==a.MS_TARGET_CONTROLS?L(b,0,h):Z(b,0,h)));if(d===a.MS_TARGET_CONTROLS&&c.kb){var h=b.k,e=ia.get_trans_view(h.n),f=aa.subtract(e,h.pivot,va),g=aa.length(f);g>h.kb.max?(aa.scale(f,h.kb.max/g,f),aa.add(h.pivot,f,e)):g<h.kb.min&&(g=ia.get_quat_view(h.n),g=Y.quat_to_dir(g,Y.AXIS_MZ,X),aa.scale(g,100*h.kb.min,g),aa.add(f,g,f),aa.scale(f,-h.kb.min/aa.length(f),f),aa.add(h.pivot,f,e))}}d===a.MS_TARGET_CONTROLS&&c.oe&&(c=b.k,h=c.pivot[2],e=Y.clamp(c.pivot[2],c.oe.min_z,c.oe.max_z),e!=h&&
(h=aa.set(0,0,e-h,va),aa.add(c.pivot,h,c.pivot),c=ia.get_trans_view(c.n),aa.add(c,h,c)));d===a.MS_HOVER_CONTROLS&&(d=b.k,d.Ec&&(h=Y.clamp(d.yb[0],d.Ec.min,d.Ec.max)-d.yb[0],d.yb[0]+=h,c=ia.get_trans_view(d.n),c[0]+=h),d.Fc&&(h=Y.clamp(d.yb[1],d.Fc.min,d.Fc.max)-d.yb[1],d.yb[1]+=h,c=ia.get_trans_view(d.n),c[1]+=h),d=b.k,c=k(b,la)[1],(d=Y.Hj(c,d.oa.up,d.oa.down))&&O(b,0,d))}function Z(a,b,c,d,e){var f=a.k,h=b,g=c;if(d||e)a=k(a,ma),d&&(h=b-a[0]),e&&(g=c-a[1]);if(h||g)b=ka.identity(Fa),h&&(h=ka.setAxisAngle(f.xe,
h,Ha),ka.multiply(b,h,b)),f=ia.get_quat_view(f.n),g&&(h=Y.quat_to_dir(f,Y.AXIS_X,va),g=ka.setAxisAngle(h,g,Ha),ka.normalize(g,g),ka.multiply(b,g,b)),ka.multiply(b,f,f)}function L(a,b,c,d,e){var f=a.k,h=b,g=c;if(d||e){var l=k(a,ma);d&&(h=b-l[0]);e&&(g=c-l[1])}U(a,a.k.pivot,h,g);a=k(a,ma);a=Y.angle_wrap_periodic(a[1],-Math.PI,Math.PI);f.Hm=Math.abs(a)>Math.PI/2}function O(a,b,c,d,e){var f=a.k,h=b,g=c;if(d||e){var l=k(a,ma);d&&(h=b-l[0]);e&&(g=c-l[1])}f.Zj||(h=0);U(a,f.yb,h,g);g&&ga(a)}function U(a,
b,c,d){var e=a.k;if(c||d){var f=ka.identity(Fa);c&&(c=ka.setAxisAngle(Y.AXIS_Z,c,Ha),ka.multiply(f,c,f));K(a);a=ia.get_quat_view(e.n);d&&(c=Y.quat_to_dir(a,Y.AXIS_X,va),d=ka.setAxisAngle(c,d,Ha),ka.normalize(d,d),ka.multiply(f,d,f));e=ia.get_trans_view(e.n);Y.wM(e,b,f,e);ka.multiply(f,a,a)}}function ga(a){var b=a.k,c=k(a,la)[1],d=a.k;a=d.oa;d=d.kb;a.down-a.up?(c=(a.down-c)/(a.down-a.up),c=Math.max(c,0)):c=0;c=c*(d.max-d.min)+d.min;a=ia.get_trans_view(b.n);d=ia.get_quat_view(b.n);d=Y.quat_to_dir(d,
Y.AXIS_MZ,va);aa.normalize(d,d);aa.scale(d,c,d);aa.subtract(b.yb,d,a)}function R(b,c,d){switch(b.type){case a.hd:c||Y.r("No aspect ratio"),b.bb=c;case a.ng:oa.perspective(Y.deg_to_rad(b.od),b.bb,b.near,b.far,b.ab);break;case a.Yd:c||Y.r("No aspect ratio"),b.bb=c;case a.bh:c=b.top*b.bb;oa.ortho(-c,c,-b.top,b.top,b.near,b.far,b.ab);break;case a.bi:oa.ortho(b.left,b.right,b.bottom,b.top,b.near,b.far,b.ab);break;case a.pc:case a.Bc:c||Y.r("No aspect ratio");b.bb=c;var e=Math.tan(b.od*Math.PI/360);c=b.near*
e;var f=b.bb*b.dj*e;b.type==a.pc?(e=f-b.te/2,f+=b.te/2):(e=f+b.te/2,f-=b.te/2);e=-(b.near/b.dj*e);f*=b.near/b.dj;oa.frustum(e,f,-c,c,b.near,b.far,b.ab);b.left=e;b.right=f;break;case a.Wd:case a.Xd:if(Aa.Ba())if(e=Aa.get_active(),(e=Aa.Da(e,V.ai))&&e.enable_hmd_stereo){c=Math.tan(Y.deg_to_rad(b.xd[0]));var e=Math.tan(Y.deg_to_rad(b.xd[1])),f=Math.tan(Y.deg_to_rad(b.xd[2])),h=Math.tan(Y.deg_to_rad(b.xd[3]));b.top=b.near*c;b.right=b.near*e;b.bottom=-b.near*f;b.left=-b.near*h;oa.frustum(b.left,b.right,
b.bottom,b.top,b.near,b.far,b.ab)}else c||(c=b.bb),oa.perspective(Y.deg_to_rad(b.od),c,b.near,b.far,b.ab);break;case a.Kc:return;default:Y.r("Wrong camera type: "+b.type)}d||(Q(b),ca(b))}function ca(a){oa.copy(a.rb,a.xf);a.xf[12]=0;a.xf[13]=0;a.xf[14]=0;a.xf[15]=1;oa.multiply(a.ab,a.xf,a.xf);oa.invert(a.xf,a.xf)}function Q(a){oa.copy(a.rb,a.Ic);oa.multiply(a.ab,a.Ic,a.Ic);oa.invert(a.Ic,a.Ts)}function ta(b,c,d,e,f){e||(e=new Float32Array(24));c||(c=b.near);d||(d=b.far);var h,g,k,l,m,n,p,u;switch(b.type){case a.Kc:Y.r("Extraction from NONE camera is not possible");
break;case a.hd:case a.ng:h=c*Math.tan(b.od*Math.PI/360);l=-h;g=h*b.bb;k=-g;m=d/c*h;u=-m;n=m*b.bb;p=-n;break;case a.Yd:case a.bh:k=b.top*b.bb;h=m=b.top;g=n=k;l=u=-b.top;k=p=-k;break;case a.bi:h=m=b.top;g=n=b.right;l=u=b.bottom;k=p=b.left;break;case a.pc:case a.Bc:m=c/b.near;h=c*Math.tan(b.od*Math.PI/360);l=-h;g=b.right*m;k=b.left*m;p=d/c;m=h*p;u=-m;n=g*p;p*=k;break;case a.Wd:case a.Xd:m=c/b.near;h=b.top*m;l=b.bottom*m;g=b.right*m;k=b.left*m;p=d/c;m=h*p;u=l*p;n=g*p;p*=k;break;default:Y.r("Wrong camera type: "+
b.type)}e[0]=k;e[1]=l;e[2]=-c;e[3]=g;e[4]=l;e[5]=-c;e[6]=g;e[7]=h;e[8]=-c;e[9]=k;e[10]=h;e[11]=-c;e[12]=p;e[13]=u;e[14]=-d;e[15]=p;e[16]=m;e[17]=-d;e[18]=n;e[19]=m;e[20]=-d;e[21]=n;e[22]=u;e[23]=-d;f&&(c=Sa,oa.invert(b.rb,c),Y.nm(e,c,e,0));return e}function K(b){return I.is_camera(b)&&b.k&&b.k.pb==a.MS_HOVER_CONTROLS}function N(a,b){if(b.enable_csm){var c=b.csm_num;if(!a.ug){var d=b.csm_num;a.ug=Array(d);for(var e=0;e<d;e++)a.ug[e]=new Float32Array(3);a.Pn=new Float32Array(d)}for(d=0;d<c;d++){var e=
0==d?a.near:ha(b,a,d-1),f=ha(b,a,d),e=ta(a,e,f,Ba),e=ra.ZJ(e);a.ug[d].set(e.I);a.Pn[d]=e.Ka;a.tq[d]=aa.length(e.I);a.lm[d]=qa(b.first_cascade_blur_radius,b.last_cascade_blur_radius,c,d)}}else a.lm[0]=b.first_cascade_blur_radius}function ha(a,b,c){var d=a.csm_num,e=Y.clamp(a.csm_first_cascade_border,b.near,b.far);a=Y.clamp(a.csm_last_cascade_border,b.near,b.far);return Y.clamp(qa(e,a,d,c),b.near,b.far)}function qa(a,b,c,d){switch(d){case 0:break;case c-1:a=b;break;default:a=0==a?0:a*Math.pow(b/a,d/
(c-1))}return a}function na(a,b){b||(b=new Float32Array(3));var c=ia.get_trans_view(a.k.n);aa.copy(c,b);return b}var ra=q("__boundings");q("__config");var sa=q("__constraints"),ea=q("__container"),oa=q("__mat4"),pa=q("__math"),I=q("__obj_util"),Ea=q("__print"),ka=q("__quat"),Aa=q("__scenes"),V=q("__subscene"),ua=q("__transform"),ia=q("__tsr"),Y=q("__util"),aa=q("__vec3"),T=q("__vec4");a.Kc=10;a.hd=20;a.Yd=30;a.ng=40;a.bh=50;a.bi=60;a.pc=70;a.Bc=80;a.Wd=90;a.Xd=100;a.MS_STATIC=0;a.MS_TARGET_CONTROLS=
2;a.MS_EYE_CONTROLS=3;a.MS_HOVER_CONTROLS=4;var xa=Y.deg_to_rad(.5),la=new Float32Array(2),ma=new Float32Array(2),va=new Float32Array(3),X=new Float32Array(3),ya=new Float32Array(3),Fa=new Float32Array(4),Ha=new Float32Array(4),za=new Float32Array(4),Ga=new Float32Array(4),Sa=new Float32Array(16),Ba=new Float32Array(24),da=new Float32Array(6);a.JG=function(d,h){var k=h.k,l=d.data;switch(l.type){case "PERSP":var m=x(a.hd);if(l.angle_y)var p=Y.rad_to_deg(l.angle_y);C(m,p,l.clip_start,l.clip_end);break;
case "ORTHO":m=x(a.Yd),C(m,l.ortho_scale/2,l.clip_start,l.clip_end)}m.name=h.name;p=h.D;p[0].R.push(m);for(var u=1;u<p.length;u++){var da=g(m,!1);p[u].R.push(da)}k.pb=v(l.b4w_move_style);k.dof_distance=l.dof_distance;m=l.dof_object;k.tc=m?m.Ga:null;k.dof_front_start=l.b4w_dof_front_start;k.dof_front_end=l.b4w_dof_front_end;k.dof_rear_start=l.b4w_dof_rear_start;k.dof_rear_end=l.b4w_dof_rear_end;k.dof_power=l.b4w_dof_power;k.Nc=l.b4w_dof_bokeh;k.Xa=l.b4w_dof_bokeh_intensity;k.$c=l.b4w_dof_foreground_blur;
k.Xk=l.b4w_trans_velocity;k.Wk=l.b4w_rot_velocity;k.Yk=l.b4w_zoom_velocity;m=h.k.pb;p=d.data;u=null;m!=a.MS_TARGET_CONTROLS&&m!=a.MS_EYE_CONTROLS||!p.b4w_use_horizontal_clamping||(u={left:p.b4w_rotation_left_limit,right:p.b4w_rotation_right_limit,camera_space:"LOCAL"==p.b4w_horizontal_clamping_type},m==a.MS_EYE_CONTROLS&&(u.left*=-1,u.right*=-1));m=u;p=h.k.pb;u=d.data;da=null;p!=a.MS_TARGET_CONTROLS&&p!=a.MS_EYE_CONTROLS||!u.b4w_use_vertical_clamping?p==a.MS_HOVER_CONTROLS&&u.b4w_use_zooming&&(u.b4w_hover_angle_min<=
u.b4w_hover_angle_max?(da={down:u.b4w_hover_angle_min,up:u.b4w_hover_angle_max},da.down*=-1,da.up*=-1):Ea.error("Wrong angle limits for the HOVER camera. Disabling angle limits.")):(da={down:u.b4w_rotation_down_limit,up:u.b4w_rotation_up_limit,camera_space:"LOCAL"==u.b4w_vertical_clamping_type},p==a.MS_TARGET_CONTROLS&&(da.down*=-1,da.up*=-1));var p=da,u=h.k.pb,da=d.data,r=null;u==a.MS_TARGET_CONTROLS&&da.b4w_use_target_distance_limits&&da.b4w_distance_min<=da.b4w_distance_max?r={min:da.b4w_distance_min,
max:da.b4w_distance_max}:u===a.MS_HOVER_CONTROLS&&da.b4w_use_zooming&&(da.b4w_distance_min<=da.b4w_distance_max?r={min:da.b4w_distance_min,max:da.b4w_distance_max}:Ea.error("Wrong distance limits for the HOVER camera. Disabling distance limits."));u=r;da=d.data;r=null;h.k.pb==a.MS_HOVER_CONTROLS&&da.b4w_use_horizontal_clamping&&da.b4w_horizontal_translation_min<=da.b4w_horizontal_translation_max&&(r={min:da.b4w_horizontal_translation_min,max:da.b4w_horizontal_translation_max});var da=r,r=d.data,t=
null;h.k.pb==a.MS_HOVER_CONTROLS&&r.b4w_use_vertical_clamping&&r.b4w_vertical_translation_min<=r.b4w_vertical_translation_max&&(t={min:r.b4w_vertical_translation_min,max:r.b4w_vertical_translation_max});var r=t,t=d.data,z=null;h.k.pb==a.MS_TARGET_CONTROLS&&t.b4w_use_pivot_limits&&(z={min_z:t.b4w_pivot_z_min,max_z:t.b4w_pivot_z_max});t=z;switch(k.pb){case a.MS_EYE_CONTROLS:k=ia.get_trans_view(h.k.n);e(h,k,null,m,p);break;case a.MS_TARGET_CONTROLS:k=ia.get_trans_view(h.k.n);c(h,k,l.b4w_target,m,p,u,
t,l.b4w_use_panning);break;case a.MS_HOVER_CONTROLS:k=ia.get_trans_view(h.k.n),m=n(h,d.data.b4w_hover_zero_level,X),b(h,k,m,u,p,da,r,l.b4w_enable_hover_hor_rotation)}J(h);f(h)};a.nN=e;a.pN=c;a.oN=b;a.uo=f;a.ic=g;a.AH=m;a.BR=v;a.Dc=x;a.hQ=function(a,b){switch(b){case "COLOR":case "CUBEMAP":return Boolean(a.Zb);case "DEPTH":return Boolean(a.ee);case "SCREEN":return!Boolean(a.Zb)&&!Boolean(a.ee);default:Y.r("Wrong attachment type: "+b)}};a.qs=function(a,b,c){switch(b){case "COLOR":case "CUBEMAP":a.Zb=
c;break;case "DEPTH":a.ee=c;break;case "SCREEN":a.Zb=null;a.ee=null;break;default:Y.r("Wrong attachment type: "+b)}};a.QQ=function(a,b){switch(b){case "COLOR":case "CUBEMAP":return a.Zb;case "DEPTH":return a.ee;case "SCREEN":return null;default:Y.r("Wrong attachment type: "+b)}};a.Dr=function(b,c){(b.type!=a.hd||c!=a.pc&&c!=a.Bc&&c!=a.Wd&&c!=a.Xd)&&Y.r("make_stereo(): wrong camera type");b.type=c;d(b,6,.065)};a.fN=d;a.get_camera_angles=k;a.Sz=r;a.get_camera_angles_char=function(a,b){k(a,b);b[0]=Y.angle_wrap_0_2pi(b[0]+
Math.PI);b[1]*=-1;return b};a.rs=C;a.SM=function(b,c,d,e,f,h,g){switch(b.type){case a.bi:b.left=c;b.right=d;b.bottom=e;b.top=f;b.near=h;b.far=g;break;default:Ea.error("set_frustum_asymmetric(): Unsupported camera type: "+b.type)}};a.get_move_style=function(a){return a.k.pb};a.kN=B;a.NR=F;a.qw=function(a,b,c){var d=va;d[0]=0;d[1]=0;d[2]=-1;aa.transformQuat(d,c,d);d[0]+=b[0];d[1]+=b[1];d[2]+=b[2];var e=X;e[0]=0;e[1]=1;e[2]=0;aa.transformQuat(e,c,e);F(a,b,d,e)};a.set_look_at=D;a.ZM=y;a.rO=A;a.qO=function(b){var c=
b.k;J(b);G(b);switch(c.pb){case a.MS_TARGET_CONTROLS:var e=ia.get_trans_view(c.n),f=ia.get_quat_view(c.n);sa.xM(e,f,c.pivot);for(f=0;f<b.D.length;f++)for(var h=b.D[f].R,g=0;g<h.length;g++){var k=h[g];k.type!=a.pc&&k.type!=a.Bc||d(k,aa.dist(e,c.pivot),k.te)}sa.correct_up(b,c.xe);break;case a.MS_EYE_CONTROLS:b.Kb||sa.correct_up(b,c.xe)}H(b)};a.dx=H;a.TB=h;a.WB=u;a.hover_set_vertical_limits=P;a.hover_set_distance_limits=z;a.KM=l;a.bN=M;a.TM=E;a.jN=W;a.BO=G;a.rotate_eye_camera=Z;a.rotate_target_camera=
L;a.rotate_hover_camera=O;a.qR=function(b){switch(b.type){case a.hd:case a.Yd:case a.pc:case a.Bc:return!0;default:return!1}};a.Pz=function(b){switch(b.type){case a.hd:case a.ng:case a.pc:case a.Bc:return Y.deg_to_rad(b.od);default:return Ea.error("get_angular_diameter(): Unsupported camera type: "+b.type),0}};a.aj=R;a.FM=function(b,c,d,e,f){var h=1/Math.max(f,e);switch(b.type){case a.hd:case a.ng:f/=2;e/=2;d=-(d-f)/f*Math.tan(Y.deg_to_rad(b.od)/2);c=(c-e)/e*Math.tan(Y.deg_to_rad(b.od)/2)*b.bb;e=
b.near*(d+h);f=b.near*(c+h);d=b.near*(d-h);c=b.near*(c-h);oa.frustum(c,f,d,e,b.near,b.far,b.ab);break;case a.Yd:case a.bh:b.right=b.top*b.bb;d=-d/f;c/=e;e=b.top+(d+h)*(b.top+b.top);f=-b.right+(c+h)*(b.right+b.right);d=b.top+(d-h)*(b.top+b.top);c=-b.right+(c-h)*(b.right+b.right);oa.ortho(c,f,d,e,b.near,b.far,b.ab);break;case a.bi:d=-d/f,c/=e,e=b.top+(d+h)*(b.top-b.bottom),f=b.left+(c+h)*(b.right-b.left),d=b.top+(d-h)*(b.top-b.bottom),c=b.left+(c-h)*(b.right-b.left),oa.ortho(c,f,d,e,b.near,b.far,b.ab)}oa.copy(b.rb,
b.Ic);oa.multiply(b.ab,b.Ic,b.Ic);Y.Fl(b.Ic,b.Ag)};a.Mt=ca;a.yy=Q;a.cJ=ta;a.fG=function(a){a=a.k;var b=ra.Mc();b.min_x=-1;b.max_x=1;b.min_y=-1;b.max_y=1;b.min_z=-1;b.max_z=1;a.J=b;var c=ra.gq(1,Y.f32([0,0,0]));a.da=c;a.pn=ra.hy(1,b);a.rn=ra.jy(1,b);a.qn=ra.iy(1,b)};a.is_static_camera=function(b){return I.is_camera(b)&&b.k&&b.k.pb==a.MS_STATIC};a.is_target_camera=function(b){return I.is_camera(b)&&b.k&&b.k.pb==a.MS_TARGET_CONTROLS};a.is_eye_camera=function(b){return I.is_camera(b)&&b.k&&b.k.pb==a.MS_EYE_CONTROLS};
a.is_hover_camera=K;a.is_ortho_camera=function(b){return I.is_camera(b)&&b.k&&b.D[0].R[0].type==a.Yd};a.cx=N;a.xI=ha;a.project_point=function(b,c,d){b=b.D[0].R[0];switch(b.type){case a.hd:case a.ng:case a.Yd:case a.bh:case a.pc:case a.Bc:case a.Wd:case a.Xd:var e=za;e.set(c);e[3]=1;T.transformMat4(e,b.Ic,e);c=-e[1]/e[3];d[0]=(e[0]/e[3]+1)/2*b.width;d[1]=(c+1)/2*b.height;ea.hP(d[0],d[1],d,b);2<d.length&&(d[2]=(e[2]/Math.abs(e[3])+1)/2);return d;default:return Ea.error("Non-compatible camera"),d}};
a.XJ=function(a){return a.D[0].R[0]};a.Ml=function(b,c){switch(b.type){case a.hd:case a.ng:case a.pc:case a.Bc:var d=Math.tan(Y.deg_to_rad(b.od)/2);switch(c){case "LEFT":return-d*b.bb;case "RIGHT":return d*b.bb;case "TOP":return d;case "BOTTOM":return-d}break;case a.Yd:case a.bh:switch(c){case "LEFT":return-b.top*b.bb;case "RIGHT":return b.top*b.bb;case "TOP":return b.top;case "BOTTOM":return-b.top}break;case a.bi:switch(c){case "LEFT":return b.left;case "RIGHT":return b.right;case "TOP":return b.top;
case "BOTTOM":return b.bottom}break;case a.Wd:case a.Xd:switch(c){case "LEFT":return Math.tan(Y.deg_to_rad(b.xd[3]));case "RIGHT":return Math.tan(Y.deg_to_rad(b.xd[1]));case "TOP":return Math.tan(Y.deg_to_rad(b.xd[0]));case "BOTTOM":return Math.tan(Y.deg_to_rad(b.xd[2]))}break;default:Y.r("Unknown camera type")}};a.KK=function(b){switch(b.type){case a.Yd:case a.bh:case a.bi:return!0;default:return!1}};a.get_fov=function(b,c){switch(b.type){case a.hd:case a.ng:case a.pc:case a.Bc:var d=Y.deg_to_rad(b.od);
return c?d*b.bb:d;default:return 0}};a.set_trans_pivot=function(a,b,c){a=a.k;ia.set_trans(b,a.n);aa.copy(c,a.pivot)};a.set_hover_pivot=function(a,b){var c=a.k,d=aa.subtract(b,c.yb,va),e=ia.get_trans_view(c.n),d=aa.add(d,e,d);ua.set_translation(a,d);aa.copy(b,c.yb)};a.gN=function(a,b){var c=a.k,d=aa.subtract(b,c.pivot,va),e=ia.get_trans_view(c.n),d=aa.add(d,e,d);ua.set_translation(a,d);aa.copy(b,c.pivot)};a.get_eye=na;a.set_move_style=function(c,d){c.k.pb=d;c.k.gb=null;c.k.oa=null;c.k.kb=null;c.k.Ec=
null;c.k.Fc=null;f(c);switch(d){case a.MS_HOVER_CONTROLS:var e=ia.get_trans_view(c.k.n),h=n(c,0,X);b(c,e,h,null,null,null,null,c.k.Zj);break;case a.MS_TARGET_CONTROLS:e=na(c,va),h=ia.get_quat_view(c.k.n),h=Y.quat_to_dir(h,Y.AXIS_MZ,X),h=aa.scaleAndAdd(e,h,10,h),aa.copy(h,c.k.pivot)}};a.bt=function(a){a=a.k;a.pb=0;aa.set(0,0,0,a.pivot);aa.set(0,0,0,a.yb);a.Hm=!1;a.use_panning=!1;a.gb=null;a.oa=null;a.kb=null;a.Ec=null;a.Fc=null;a.oe=null;a.Zj=!0};a.set_eye_distance=function(a,b){for(var c=0;c<a.length;c++){var e=
a[c];70!=e.type&&80!=e.type&&90!=e.type&&100!=e.type||d(e,e.dj,b)}};a.set_hmd_fov=function(a,b,c){var d=Aa.get_active();a=I.ga(a,d).R;for(d=0;d<a.length;d++){var e=a[d];if(90==e.type||100==e.type)90==e.type&&T.copy(b,e.xd),100==e.type&&T.copy(c,e.xd),e.Nb||R(e),Q(e),ca(e)}}};b4w.module.__lights=function(a,q){function e(a){n.scale(a.color,a.Je,a.Kn)}q("__print");var c=q("__tsr"),b=q("__util"),n=q("__vec3"),f=new Float32Array(3);new Float32Array(3);a.PK=function(a,g){var m=a.data,v=g.Ta={name:"",type:m.type,vB:new Float32Array(3),direction:new Float32Array(3),color:new Float32Array(3),Kn:new Float32Array(3),jz:0,Pk:0,mp:0,Dn:.1,Cn:30,Oz:!1,ZA:!1,rz:!1,Om:!0,Uk:!0,Je:1,distance:25,EQ:"INVERSE_SQUARE"};v.name=g.name;v.Om=m.use_diffuse;v.Uk=m.use_specular;var q=c.get_quat_view(g.k.n),
q=b.quat_to_dir(q,b.AXIS_Z,f);n.normalize(q,q);v.direction.set(q);v.color[0]=m.color[0];v.color[1]=m.color[1];v.color[2]=m.color[2];v.Je=v.jz=m.energy;e(v);v.distance=m.distance;v.Dn=m.clip_start;v.Cn=m.clip_end;if("POINT"===v.type||"SPOT"===v.type)v.distance=m.distance;"SPOT"===v.type?(v.mp=m.spot_blend,v.Pk=m.spot_size):"POINT"===v.type&&(v.Pk=Math.PI/2);v.Oz=m.b4w_generate_shadows;v.rz=m.b4w_dynamic_intensity};a.set_light_color=function(a,b){a.color[0]=b[0];a.color[1]=b[1];a.color[2]=b[2];e(a)};
a.WM=function(a,b){a.mp=b};a.VM=function(a,b){a.distance=b};a.XM=function(a,b){a.Pk=b};a.set_light_energy=function(a,b){a.Je=b;e(a)};a.wO=function(a){var e=a.Ta;if(e){a=c.get_quat_view(a.k.n);b.quat_to_dir(a,b.AXIS_Z,e.direction);n.normalize(e.direction,e.direction);if("SUN"==e.type){a=Math.acos(n.dot(e.vB,b.vt));var f=Math.acos(n.dot(e.direction,b.vt));e.ZA=Math.floor(a/.025)!=Math.floor(f/.025)?!0:!1}n.copy(e.direction,e.vB)}}};b4w.module.__scenes=function(a,q){function e(a){for(var b=0;b<a.length;b++){var c=a[b];if(!c.df||!c.df.length)return c}return null}function c(){jb||Ja.r("No active scene available");return jb}function b(a,b,c){if(!wa.Aq||!n(a,b,c))return null;c=a.b4w_shadow_settings;var d={};c.csm_resolution>qb.dc?(d.csm_resolution=qb.dc,Ca.error("Shadow map texture has unsupported size. Changed to "+qb.dc+".")):d.csm_resolution=c.csm_resolution;wa.wG=c.blur_samples;d.wN=c.soft_shadows;a=Ba.Sq(b,wa.ssao&&a.b4w_enable_ssao);
d.self_shadow_polygon_offset=c.self_shadow_polygon_offset;d.self_shadow_normal_offset=c.self_shadow_normal_offset;d.enable_csm=c.b4w_enable_csm&&1==a.length;d.Rf=[];d.nC=[];d.KI=[];d.Dn=[];d.Cn=[];for(b=0;b<a.length;b++)d.Rf.push(a[b].Ta.type),d.nC.push(a[b].Ta.Pk),d.KI.push(a[b].Ta.distance),d.Dn.push(a[b].Ta.Dn),d.Cn.push(a[b].Ta.Cn),"SPOT"!=d.Rf[b]&&"POINT"!=d.Rf[b]||!d.enable_csm||(Ca.warn("Generating shadows for SPOT or POINT light. Disabling Cascaded Shadow Maps"),d.enable_csm=!1);d.enable_csm?
(d.csm_num=c.csm_num,d.csm_first_cascade_border=c.csm_first_cascade_border,d.first_cascade_blur_radius=c.first_cascade_blur_radius,d.csm_last_cascade_border=c.csm_last_cascade_border,d.last_cascade_blur_radius=c.last_cascade_blur_radius,d.fade_last_cascade=c.fade_last_cascade,d.blend_between_cascades=c.blend_between_cascades):(d.csm_num=1,d.csm_first_cascade_border=c.csm_first_cascade_border,d.first_cascade_blur_radius=c.first_cascade_blur_radius,d.csm_last_cascade_border=c.csm_last_cascade_border,
d.last_cascade_blur_radius=c.last_cascade_blur_radius,d.fade_last_cascade=!1,d.blend_between_cascades=!1);return d}function n(a,b,c){if(0!=b.length&&wa.shadows)switch(a.b4w_render_shadows){case "OFF":return!1;case "ON":return!0}else return!1;var d=!1,e=!1;a=wa.ssao&&a.b4w_enable_ssao;if(0==b.length&&!a)return!1;for(b=0;b<c.length;b++){var f=c[b];f.b4w_shadow_cast&&(d=!0);f.b4w_shadow_receive&&(e=!0);if((a||d)&&e)return!0}return!1}function f(a){for(var b=0;b<a.length;b++)if("SUN"==a[b].Ta.type)return!0;
return!1}function t(a){if(!wa.shore_smoothing)return!1;a=na(a);for(var b=0;b<a.length;b++){var c=a[b];if(c.b4w_water&&c.b4w_water_shore_smoothing)return!0}return!1}function g(a){for(var b=0;b<a.length;b++)for(var c=a[b].particle_systems,d=0;d<c.length;d++)if(Ba.Hy(a[b],c[d].settings))return!0;return!1}function m(a){for(var b=na(a),c=[],d=0;d<b.length;d++){var e=b[d];if(e.b4w_water){for(var f={},h=0;h<a.length;h++)for(var g=a[h],k=g.data.materials,l=0;l<k.length;l++)k[l]==e&&(f.oj=g.location[2]);f.Kd=
e.b4w_water_fog_color.slice(0);f.Kd.push(e.b4w_water_fog_density);e.b4w_water_dynamic?(f.Zn=!0,f.waves_height=e.b4w_waves_height,f.waves_length=e.b4w_waves_length,f.dst_noise_scale0=e.b4w_water_dst_noise_scale0,f.dst_noise_scale1=e.b4w_water_dst_noise_scale1,f.dst_noise_freq0=e.b4w_water_dst_noise_freq0,f.dst_noise_freq1=e.b4w_water_dst_noise_freq1,f.dir_min_shore_fac=e.b4w_water_dir_min_shore_fac,f.dir_freq=e.b4w_water_dir_freq,f.dir_noise_scale=e.b4w_water_dir_noise_scale,f.dir_noise_freq=e.b4w_water_dir_noise_freq,
f.dir_min_noise_fac=e.b4w_water_dir_min_noise_fac,f.dst_min_fac=e.b4w_water_dst_min_fac,f.waves_hor_fac=e.b4w_water_waves_hor_fac):(f.Zn=!1,f.waves_height=0,f.waves_length=0);f.Hf=e.b4w_water_enable_caust;f.LG=e.b4w_water_caust_scale;f.KG=e.b4w_water_caust_brightness;f.MG=new Float32Array([.3,.7]);f.bj=null;e=e.texture_slots;for(h=0;h<e.length;h++)g=e[h].texture,!0===g.b4w_shore_dist_map&&"FILE"==g.image.source&&(f.bj=g.image,f.uw=g.image.size[0],f.pv=g.b4w_max_shore_dist,g=g.b4w_shore_boundings,
f.rm=[(g[0]+g[1])/2,(g[2]+g[3])/2],f.sm=[g[0]-g[1],g[2]-g[3]]);c.push(f)}}if(0<c.length){f=c[0];if(!f.Zn)for(d=0;d<c.length;d++)c[d].Zn&&(f=c[d]);return f}return null}function v(a){function b(a){if(a){a=a.nodes;for(var d=0;d<a.length;d++){var e=a[d];"GROUP"==e.type&&e.node_group&&b(e.node_group.node_tree);"GROUP"==e.type&&"B4W_REFRACTION"==e.node_tree_name&&(c.refractions=!0)}}}var c={refractions:!1};a=na(a);for(var d=0;d<a.length;d++){var e=a[d];e.b4w_refractive&&(c.refractions=!0);e.node_tree&&
b(e.node_tree)}return c}function x(a,b,c){if(wa.reflections)switch(a.b4w_render_reflections){case "OFF":return!1}else return!1;a=[];for(var d=0,e=!1,f=0;f<b.length;f++){var h=b[f];h.k.dd&&"CUBE"==h.k.wf&&d++;if(h.Zo.length){for(var g=null,k=0;k<a.length;k++)if(a[k]==h){g=k;break}null==g&&a.push(h)}}for(f=0;f<c.length;f++){a:if(b=c[f],b.b4w_reflexible){b=b.data.materials;for(h=0;h<b.length;h++)if(g=b[h].game_settings.alpha_blend,"OPAQUE"!=g&&"CLIP"!=g){b=!0;break a}b=!1}else b=void 0;b&&(e=!0)}return{FB:a,
eB:d,lh:[],ku:[],Kg:[],$r:[],kA:e}}function d(a,b){var c=a.b4w_sky_settings,d={};d.jM=c.render_sky;d.procedural_skydome=c.procedural_skydome&&b;d.use_as_environment_lighting=c.use_as_environment_lighting;d.um=c.color;d.rayleigh_brightness=c.rayleigh_brightness;d.mie_brightness=c.mie_brightness;d.spot_brightness=c.spot_brightness;d.scatter_strength=c.scatter_strength;d.rayleigh_strength=c.rayleigh_strength;d.mie_strength=c.mie_strength;d.rayleigh_collection_power=c.rayleigh_collection_power;d.mie_collection_power=
c.mie_collection_power;d.mie_distribution=c.mie_distribution;d.Qc=c.reflexible;d.Gc=c.reflexible_only;!b&&c.procedural_skydome&&Ca.warn("There is no sun on the scene. Procedural sky won't be rendered");return d}function k(a){var b={};a=a.b4w_ssao_settings;b.radius_increase=a.radius_increase;b.uK=a.hemisphere;b.vG=a.blur_depth;b.py=a.blur_discard_value;b.influence=a.influence;b.dist_factor=a.dist_factor;b.AM=a.samples;return b}function r(a){if(!(wa.bloom&&a.b4w_enable_bloom&&a.q.Ph))return null;var b=
{};a=a.b4w_bloom_settings;b.blur=a.blur;b.QI=a.edge_lum;b.key=a.key;return b}function C(a){var b={};a=a.b4w_motion_blur_settings;b.mb_decay_threshold=a.motion_blur_decay_threshold;b.mb_factor=a.motion_blur_factor;return b}function B(a){var b={};a=a.b4w_color_correction_settings;b.brightness=a.brightness;b.contrast=a.contrast;b.exposure=a.exposure;b.saturation=a.saturation;return b}function F(a){var b={};a=a.b4w_god_rays_settings;b.$u=a.intensity;b.$l=a.max_ray_length;b.Cm=a.steps_per_pass;return b}
function D(a){var b={};b.Eh=a.b4w_outline_color;b.Lo=a.b4w_outline_factor;return b}function y(a){var b={};a=a.b4w_glow_settings;b.small_glow_mask_coeff=a.small_glow_mask_coeff;b.large_glow_mask_coeff=a.large_glow_mask_coeff;b.small_glow_mask_width=a.small_glow_mask_width;b.large_glow_mask_width=a.large_glow_mask_width;return b}function A(a,b){var c=a.light_settings,d={};d.qh=c.environment_energy;d.hx=c.use_environment_light;d.xu=c.environment_color;d.Pe=a.horizon_color.slice(0);d.cf=a.zenith_color.slice(0);
d.$O=a.use_sky_paper;d.ZO=a.use_sky_blend;d.aP=a.use_sky_real;d.hC=null;d.xw=null;d.yu=null;if(d.hx&&"SKY_TEXTURE"==d.xu&&(!b.procedural_skydome||!b.use_as_environment_lighting)){for(var c=null,e=0;e<a.texture_slots.length;e++)if(a.texture_slots[e].texture.b4w_use_as_environment_lighting){c=a.texture_slots[e];break}c?d.yu=c:(Ca.warn("environment lighting is set to 'Sky Texture', but there is no world texture with 'Sky Texture Usage' property set to 'ENVIRONMENT_LIGHTING'"),d.hx=!1)}for(e=0;e<a.texture_slots.length;e++)if(a.texture_slots[e].texture.b4w_use_as_skydome){c=
a.texture_slots[e];d.hC=c;d.xw={sG:c.blend_factor,wK:c.horizon_factor,sP:c.zenith_up_factor,rP:c.zenith_down_factor,color:c.color,jb:c.default_value,invert:c.invert,YO:c.use_rgb_to_intensity,tG:c.blend_type,UO:c.use_map_blend,VO:c.use_map_horizon,XO:c.use_map_zenith_up,WO:c.use_map_zenith_down};break}return d}function H(a){var b=a.fog_settings,c={};c.QO=b.use_fog;c.$u=b.intensity;c.depth=b.depth;c.start=b.start;c.height=b.height;c.fJ=b.falloff;c.color=b.use_custom_color?b.color.slice(0):a.horizon_color.slice(0);
a=c.color;c.Kd=new Float32Array([a[0],a[1],a[2],1/c.depth]);c.hf=new Float32Array([c.$u,c.depth,c.start,c.height]);return c}function w(a,b){if(!wa.jc)return!1;switch(a.b4w_render_dynamic_grass){case "OFF":return!1;case "ON":return!0}for(var c=!1,d=!1,e=0;e<b.length;e++){for(var f=b[e],h=f.data.materials,g=0;g<h.length;g++)h[g].b4w_terrain&&(c=!0);f=f.particle_systems;for(g=0;g<f.length;g++)h=f[g].settings,"HAIR"==h.type&&h.b4w_dynamic_grass&&(d=!0);if(c&&d)return!0}return!1}function h(a,b){if(Bb.outlining_overview_mode)return!0;
if(wa.enable_selectable)switch(a.b4w_enable_object_selection){case "OFF":return!1;case "ON":return!0;case "AUTO":for(var c=0;c<b.length;c++)if(b[c].Ga.k.Ng)return!0;return!1}else return!1}function u(a,b){if(Bb.outlining_overview_mode)return!0;if(wa.enable_outlining)switch(a.b4w_enable_outlining){case "OFF":return!1;case "ON":return!0;case "AUTO":for(var c=0;c<b.length;c++)if(b[c].Ga.k.ec)return!0;return!1}else return!1}function P(a,b){if(wa.th)switch(a.b4w_enable_glow_materials){case "OFF":return!1;
case "ON":return!0;case "AUTO":for(var c=0;c<b.length;c++)for(var d=b[c].data.materials,e=0;e<d.length;e++)if(Ga.Gy(d[e]))return!0;return!1}else return!1}function p(a,b){if(wa.refractions)switch(a.b4w_render_refractions){case "OFF":return!1;case "ON":return!0;case "AUTO":return b.refractions}else return!1}function z(a){for(var b=0;b<a.length;b++)for(var c=a[b].data.materials,d=0;d<c.length;d++){var e=c[d],f=e.game_settings.alpha_blend;if(e.b4w_render_above_all&&"OPAQUE"!=f&&"CLIP"!=f)return!0}return!1}
function l(a,b){switch(a.b4w_enable_anchors_visibility){case "OFF":return!1;case "ON":return!0;case "AUTO":for(var c=0;c<b.length;c++){var d=b[c].Ga;if(d.anchor&&d.anchor.Al)return!0}return!1}}function M(a,b,c){var d=ya.Uf(a,b);ya.Ug(a,d,function(a,b,d){if(d.hc){switch(d.from){case "COLOR":case "CUBEMAP":var e=b.p.Zb;break;case "DEPTH":e=b.p.ee;break;case "SCREEN":e=null;break;case S.Jc:return;default:Ja.r("Wrong slink")}switch(d.to){case "COLOR":case "CUBEMAP":case "DEPTH":case "NONE":case "SCREEN":case "OFFSCREEN":case "RESOLVE":case "COPY":case "u_cube_reflection":case "u_plane_reflection":break;
default:e||Ja.r("Connection of SCREEN is forbidden"),e.Td&&Ja.r("Batch texture can't use renderbuffer"),ja.Ky(c.Qa,d.to)&&T.pl(c,e,d.to)}}});for(a=0;a<b.Ja.length;a++){var d=b.Ja[a],e=b.Sg[a];switch(d.to){case "COLOR":case "CUBEMAP":case "DEPTH":case "NONE":case "SCREEN":case "OFFSCREEN":case "RESOLVE":case "COPY":break;default:e.Td&&Ja.r("Batch texture can't use renderbuffer"),ja.Ky(c.Qa,d.to)&&T.pl(c,e,d.to)}}}function E(a,b,c,d,e,f){for(var h=b.k,g=Ba.ga(b,e).U,k=0;k<g.length;k++){var l=g[k];if(!(l.fd||
l.Gc||"MAIN"!=l.type&&"NODES_GLOW"!=l.type&&"PARTICLES"!=l.type&&"LINE"!=l.type)&&("OPAQUE"==l.ub&&"OPAQUE"==d||"BLEND"==l.ub&&"BLEND"==d||"XRAY"==l.ub&&"XRAY"==d||"NODES_GLOW"==l.type&&"GLOW"==d)){if(!f&&(W(l,a,b,c,d,e),!T.fc(l)))if("DEBUG"===Na.type())T.Zp(l,"error.glslv","error.glslf"),T.fc(l);else continue;S.rc(a,S.Cg(l,h));M(c,a,l);G(l)}}}function W(a,b,c,d,e,f){var h=c.k,g=f.q,k=Ba.ga(c,f),l="NO_SHADOWS";c=sa(f,[S.Ac]);if(c.length&&a.Tc){switch(e){case "OPAQUE":l="SHADOW_MAPPING_OPAQUE";break;
case "BLEND":case "XRAY":l="SHADOW_MAPPING_BLEND";break;case "COLOR_ID":case "REFLECT":case "GLOW":l="NO_SHADOWS";break;case "SHADOW":l="SHADOW_MASK_GENERATION";break;default:Ja.r("Wrong subscene type")}for(var m=0;m<c.length;m++)T.by(a,f.q.Sc)}m="NO_SOFT_SHADOWS";if(g.Sc&&g.Sc.wN)switch(wa.wG){case "16x":m="POISSON_X_16";break;case "8x":m="POISSON_X_8";break;case "4x":m="POISSON_X_4"}c=a.qb;ja.W(c,"SHADOW_USAGE",l);ja.W(c,"POISSON_DISK_NUM",m);a.jc&&(m=fa.$b(d,S.ah))&&J(a,m,h);if("SHADOW"!=a.type&&
"COLOR_ID"!=e||a.wi){e=b.Pr;ja.W(c,"NUM_LIGHTS",e);ja.W(c,"NUM_LFACTORS",0==e%2?e/2:Math.floor(e/2)+1);ja.W(c,"REFLECTION_PASS","REFL_PASS_NONE");ja.W(c,"SSAO_ONLY",0);ja.W(c,"INVERT_FRONTFACING",0);if(e=g.oc)ja.W(c,"WATER_EFFECTS",1),ja.W(c,"WAVES_HEIGHT",ja.F(e.waves_height)),ja.W(c,"WAVES_LENGTH",ja.F(e.waves_length)),ja.W(c,"WATER_LEVEL",ja.F(e.oj));if(b.Hf&&h.Hf){ja.W(c,"CAUSTICS",1);if(h=g.Sc){h=h.Rf;for(m=l=0;m<h.length;m++)"SUN"==h[m]&&(l=m);ja.W(c,"SUN_NUM",l)}ja.W(c,"CAUST_SCALE",ja.F(b.Ay));
ja.W(c,"CAUST_SPEED",ja.F(b.By,2));ja.W(c,"CAUST_BRIGHT",ja.F(b.zy))}b=k.lh;k=k.Kg;if(-1!==a.Uc.indexOf("u_mirrormap"))ja.W(c,"REFLECTION_TYPE","REFL_MIRRORMAP");else if(a.dd&&b)b=b.p.Zb,T.pl(a,b,"u_cube_reflection"),ja.W(c,"REFLECTION_TYPE","REFL_CUBE");else if(a.dd&&k)for(m=0;m<k.length;m++)b=k[m].p.Zb,T.pl(a,b,"u_plane_reflection"),ja.W(c,"REFLECTION_TYPE","REFL_PLANE");else ja.W(c,"REFLECTION_TYPE","REFL_NONE");(k=fa.$b(d,S.$h))?a.cs?(b=k.p.Zb,T.pl(a,b,"u_sky")):(a.Id=k.Id,ja.W(c,"PROCEDURAL_FOG",
1)):ja.W(c,"PROCEDURAL_FOG",0);b=g.rx;b.hx&&(ja.W(c,"USE_ENVIRONMENT_LIGHT",1),"SKY_TEXTURE"==b.xu?(b=b.yu?Wa.Oc(b.yu,!1):k.p.Zb,ja.W(c,"SKY_TEXTURE",1),T.pl(a,b,"u_sky_texture")):"SKY_COLOR"==b.xu&&ja.W(c,"SKY_COLOR",1));b=g.uD;b.QO&&(ja.W(c,"USE_FOG",1),ja.W(c,"FOG_TYPE",b.fJ));a.Wi&&a.mb?(wa.Aq&&ja.W(c,"USE_REFRACTION_CORRECTION",1),"MAIN"==a.type&&a.wi||"NODES_GLOW"==a.type?(ja.W(c,"REFRACTIVE",1),g.refractions?ja.W(c,"USE_REFRACTION",1):ja.W(c,"USE_REFRACTION",0)):g.refractions?ja.W(c,"REFRACTIVE",
1):ja.W(c,"REFRACTIVE",0),(g.QA.refractions||g.refractions)&&ja.W(c,"HAS_REFRACT_TEXTURE",1)):(ja.W(c,"REFRACTIVE",0),ja.W(c,"USE_REFRACTION",0),ja.W(c,"USE_REFRACTION_CORRECTION",0));a.Xg&&(wa.shore_smoothing&&a.Um&&fa.$b(d,S.yx)?ja.W(c,"SHORE_SMOOTHING",1):ja.W(c,"SHORE_SMOOTHING",0),a.water_dynamic&&e&&e.waves_height?ja.W(c,"DYNAMIC",1):ja.W(c,"DYNAMIC",0));"PARTICLES"==a.type&&(ja.W(c,"SIZE_RAMP_LENGTH",a.Ma.SR),ja.W(c,"COLOR_RAMP_LENGTH",a.Ma.Sy));if(!a.jf)for(a=a.T,d=0;d<a.length;d++)if(b=a[d],
"SCENE"==b.source)for(g=0;g<Pa.length;g++)for(c=Pa[g],k=Pa[g].df,e=0;e<k.length;e++)k[e].q==b&&ya.s(Vb,c,f,null)}}function G(a){8<a.T.length&&Ca.warn(a.type,"too many textures used - "+a.T.length+' (max 8), materials "'+a.cc.join(", ")+'"')}function J(a,b,c){a.wd=b.wd;var d=b.wd[0],e=b.wd[1],f=b.wd[2];c=c.J;c=Math.max(c.max_x-c.min_x,c.max_y-c.min_y);f=0==f?c:Math.max(f,c);b.wd[2]=f;b=b.p;la.rs(b,f/2,-e,-d,f/2);la.aj(b);d=a.po||0;d=0==d?c:Math.max(d,c);a.po=d}function Z(a,b,c,d,e,f){for(var h=b.k,
g=Ba.ga(b,e).U,k=0;k<g.length;k++){var l=g[k];if(("MAIN"==l.type||"PARTICLES"==l.type||"LINE"==l.type)&&"REFLECT"==l.ub&&l.mb==d){if(a.type==S.Wc||a.type==S.Ae){var m;a:{var p=e.q.Mg.Kg;for(m=0;m<p.length;m++)for(var n=0;n<p[m].length;n++)if(p[m][n]==a)break a;p=e.q.Mg.$r;for(m=0;m<p.length;m++)for(n=0;n<p[m].length;n++)if(p[m][n]==a)break a;m=null}if(m==h.Nd)continue}else if(m=aa(e,a),m==h.ce)continue;if(!f&&(W(l,a,b,c,"REFLECT",e),m=l.qb,ja.W(m,"WATER_EFFECTS",0),a.type==S.Wc||a.type==S.Ae?ja.W(m,
"REFLECTION_PASS","REFL_PASS_PLANE"):ja.W(m,"REFLECTION_PASS","REFL_PASS_CUBE"),ja.W(m,"TEXTURE_NORM",0),a.type==S.Wc&&ja.W(m,"INVERT_FRONTFACING",1),!T.fc(l)))if("DEBUG"===Na.type())T.Zp(l,"error.glslv","error.glslf"),T.fc(l);else continue;S.rc(a,S.Cg(l,h))}}}function L(a){ha(a);var b=ea(a,S.sb),c=!0,d=a.q.Sc;ya.na(a.q.Pa,function(e,f){f.type===S.Ac&&(U(f,a,b.p,d,c),c=!1)})}function O(a){ya.na(a.q.Pa,function(a,b){b.type===S.hl&&(b.wu=1)})}function U(a,b,c,d,e){if(0!=a.Ea.length){var f=a.p,h=Da.bc(c.n,
pc);Da.set_trans(h,f.n);Da.copy(c.ye,f.gp);if("SUN"===d.Rf[a.fg]||"HEMI"===d.Rf[a.fg]){h=jc;xa.tP(h);for(var g=0;g<a.Ea.length;g++)for(var k=a.Ea[g].ka,l=0;l<k.length;l++){var m=k[l].Ig;0==g&&0==l?xa.ni(m.Y,h):xa.Gq(h,m.Y)}h=xa.co(h,ec);Ja.nm(h,f.rb,h);if(d.enable_csm){b=Ka.copy(c.ug[a.ju],pc);d=za.invert(c.rb,xc);Ja.nm(b,d,b);Ja.nm(b,f.rb,b);a=c.Pn[a.ju];if(e)for(Zb=0,Dc=-Infinity,e=2;e<h.length;e+=3)Zb=Math.min(Zb,h[e]),Dc=Math.max(Dc,h[e]);e=jc;e.max_x=b[0]+a;e.max_y=b[1]+a;e.max_z=Dc;e.min_x=
b[0]-a;e.min_y=b[1]-a;e.min_z=Zb}else{c=e=jc;d=fc;d.set(h);h=ed/9;g=za.identity(xc);za.rotate(g,h,Ja.AXIS_MZ,g);l=k=-1;for(m=0;10>m;m++){var p=xa.pG(d,Ec),n=(p.max_x-p.min_x)*(p.max_y-p.min_y);if(-1==k||n<k)k=n,l=m,xa.ni(p,c);Ja.nm(d,g,d)}c=l*h;0<c&&(h=za.identity(xc),za.rotate(h,c,Ja.AXIS_MZ,h),za.multiply(h,f.rb,f.rb),Da.from_mat4(f.rb,f.ye));c=e.max_x-e.min_x;h=e.max_y-e.min_y;c&&h&&(d=Math.abs(c-h)/2,2<c/h?(e.max_y+=d,e.min_y-=d):2<h/c&&(e.max_x+=d,e.min_x-=d));e.max_x+=.005;e.max_y+=.005;e.max_z+=
.005;e.min_x-=.005;e.min_y-=.005;e.min_z-=.005;ga(a,b.q.Pa)}la.SM(f,e.min_x,e.max_x,e.min_y,e.max_y,-e.max_z,-e.min_z);la.aj(f);Ja.Fl(f.Ic,f.Ag)}else"SPOT"!==d.Rf[a.fg]&&"POINT"!==d.Rf[a.fg]||la.aj(f,f.bb)}}function ga(a,b){for(var c=a.p,d=fa.gK(b,a),e=0;e<d.length;e++){var f=d[e];if(f.type==S.sb||f.type==S.Ce||f.type==S.gc||f.type==S.Be)if(wa.Cr)f.ix.set(c.ye,9*a.fg);else{var h=Da.get_trans_view(c.ye),g=Da.get_scale(c.ye),k=Da.get_quat_view(c.ye);pb.set(h[0],h[1],h[2],g,Ob);f.Ps.set(Ob,4*a.fg);f.Os.set(k,
4*a.fg)}}}function R(a,b,c,d,e){for(var f=b.k,h=Ba.ga(b,d).U,g=0;g<h.length;g++){var k=h[g];if("COLOR_ID"==k.type&&(a.type==S.Ud&&"COLOR_ID"==k.ub||a.type==S.$g&&"COLOR_ID_XRAY"==k.ub)){if(!e&&(W(k,a,b,c,"COLOR_ID",d),T.Va(k,"USE_OUTLINE",0),!T.fc(k)))continue;S.rc(a,S.Cg(k,f))}}}function ca(a,b,c,d,e){if(!d&&(e.jc&&(d=fa.$b(c,S.ah))&&J(e,d,b),!T.fc(e)))if("DEBUG"===Na.type())T.Zp(e,"error.glslv","error.glslf"),T.fc(e);else return;S.rc(a,S.Cg(e,b));M(c,a,e);G(e)}function Q(a,b){ta(a,b);for(var c=
0;c<a.be.length;c++)a.be[c].parent==a&&Q(a.be[c],b)}function ta(a,b){a.k.hide=b;if(Ba.is_lamp(a))for(var c=0;c<a.D.length;c++)for(var d=a.D[c],e=sa(d.Ua,La),f=0;f<e.length;f++)N(a,d,e[f])}function K(a,b){for(var c=sa(b,La),d=a.Ta,e=a.k,f=Ba.ga(a,b),h=f.vk,g=Da.get_trans_view(e.n),e=Da.get_quat_view(e.n),k=0;k<c.length;k++){var l=c[k];l.xr.set(g,3*h);l.hv.set(d.direction,3*h);l.wr.set(d.Kn,3*h);switch(d.type){case "SUN":l.zC.set(e);l.yC=d.Kn;l.type===S.$h?(l.Kr=d.ZA,Ka.copy(d.direction,l.Iw),qa(b,
l)):Ka.copy(d.direction,l.Iw);break;case "HEMI":case "POINT":case "SPOT":break;default:Ca.error("Unknown light type: "+d.type+'".')}N(a,f,l);for(var l=l.Ea,m=0;m<l.length;m++)for(var p=l[m].ka,n=0;n<p.length;n++){var u=p[n].pa;u.Di&&T.UM(u,a)}}c=ea(b,S.sb).p;f=f.sw;d=b.q.Sc;for(k=0;k<f.length;k++)l=f[k],la.qw(l.p,g,e),U(l,b,c,d,!0),ga(l,b.q.Pa)}function N(a,b,c){var d=a.k;a=a.Ta;b=b.vk;var e=Tc;e[0]=a.Om&&!d.hide?1:0;e[1]=a.Uk&&!d.hide?1:0;c.iv.set(e,2*b);c.wa=!0}function ha(a){var b=Sa.xb(a,"LAMP",
Sa.DATA_ID_ALL),b=Ba.Sq(b,wa.ssao&&a.b4w_enable_ssao);if(b.length)for(var c=0;c<b.length;c++)for(var d=b[c],e=d.k,f=Da.bc(e.n,pc),e=Da.ud(e.n,ob),h=0;h<d.D.length;h++){var g=d.D[h],k=g.sw;if(g.Ua==a)for(g=0;g<k.length;g++)la.qw(k[g].p,f,e)}}function qa(a,b){ba.bs(b);Ra.Dl(b);if(b.Kr)for(var c=sa(a,Ta),d=0;d<c.length;d++)for(var e=c[d].Ea,f=0;f<e.length;f++)for(var h=e[f].ka,g=0;g<h.length;g++){var k=h[g];k.vb&&(k=k.pa,T.PG(k)&&Ra.mO(k))}}function na(a){for(var b=[],c=0;c<a.length;c++)for(var d=a[c].data,
e=0;e<d.materials.length;e++){var f=d.materials[e];-1==b.indexOf(f)&&b.push(f)}return b}function ra(a,b,c){for(var d=a.q,e=Ba.ga(a.ci,a).R,f=0;f<e.length;f++){var h=e[f];la.aj(h,b/c);d.Sc&&la.cx(h,d.Sc)}d.Sc&&(d.Lr=!0,ea(a,S.Ce).wa=!0,ea(a,S.gc).wa=!0);var g=d.Pa;fa.dO(g,function(d,e,f){if(d.sp){var h=d.Mk*b,k=d.Nk*c;if(e)for(e=0;e<f.Ja.length;e++)f.Ja[e]==d&&Wa.resize(d.Na,h,k);else switch(Wa.Ul(d.Na)&&Wa.resize(d.Na,h,k),d=f.p,d.width=h,d.height=k,f.type){case S.Zm:oa(a,{dof_power:f.p.dof_power});
break;case S.$m:I(a,{small_glow_mask_width:f.small_glow_mask_width,large_glow_mask_width:f.large_glow_mask_width});break;case S.Wm:pa(a,{bloom_blur:f.bloom_blur});break;case S.hl:f=fa.fb(g,f,S.Db);h=fa.fb(g,f,S.Db);k=fa.fb(g,h,S.Db);d=fa.fb(g,k,S.Db);fa.ed(f,1/b,1/c);fa.ed(h,1/b,1/c);fa.ed(k,1/b,1/c);fa.ed(d,1/b,1/c);break;default:fa.ed(f,1/b,1/c)}}})}function sa(a,b){for(var c=[],d=0;d<b.length;d++){var e=b[d];ya.na(a.q.Pa,function(a,b){b.type==e&&c.push(b)})}return c}function ea(a,b){return fa.$b(a.q.Pa,
b)}function oa(a,b){var c=ea(a,S.Zm);if(!c)return Ca.error("DOF is not enabled on the scene. Check camera settings"),0;var d=c.p.Nc,e=d?sa(a,[S.ft]):[],f=a.q.Pa;if("boolean"==typeof b.dof_on&&(c.p.dof_on=b.dof_on,d))for(var h=0;h<e.length;h++)e[h].p.dof_on=b.dof_on;if("number"==typeof b.dof_distance&&(c.p.dof_distance=b.dof_distance,d))for(h=0;h<e.length;h++)e[h].p.dof_distance=b.dof_distance;if("number"==typeof b.dof_front_start&&(c.p.dof_front_start=b.dof_front_start,d))for(h=0;h<e.length;h++)e[h].p.dof_front_start=
b.dof_front_start;if("number"==typeof b.dof_front_end&&(c.p.dof_front_end=b.dof_front_end,d))for(h=0;h<e.length;h++)e[h].p.dof_front_end=b.dof_front_end;if("number"==typeof b.dof_rear_start&&(c.p.dof_rear_start=b.dof_rear_start,d))for(h=0;h<e.length;h++)e[h].p.dof_rear_start=b.dof_rear_start;if("number"==typeof b.dof_rear_end&&(c.p.dof_rear_end=b.dof_rear_end,d))for(h=0;h<e.length;h++)e[h].p.dof_rear_end=b.dof_rear_end;"number"==typeof b.Xa&&(c.p.Xa=b.Xa,d&&(e=fa.Nu(f,c,S.Db),e[0].p.Xa=b.Xa,e[1].p.Xa=
b.Xa,e[0]=fa.fb(f,e[0],S.Db),e[0].p.Xa=b.Xa));if("number"==typeof b.dof_power)if(d){d=b.dof_power;c.p.dof_power=d;var d=d/2,h=c.p.width,g=c.p.height,k=[1/h,0],l=[1/h*.5,1/g*.866],m=[-1/h*.5,1/g*.866],e=fa.Nu(f,c,S.Db);fa.nc(e[0],d);fa.ed(e[0],m[0],m[1]);fa.nc(e[1],d);fa.ed(e[1],l[0],l[1]);e[0]=fa.fb(f,e[0],S.Db);fa.nc(e[0],d);fa.ed(e[0],k[0],k[1]);c.p.$c&&(e[0]=fa.fb(f,e[0],S.ft),e[0]=fa.fb(f,e[0],S.Db),fa.ed(e[0],1/h,1/g),e[0]=fa.fb(f,e[0],S.Db),fa.ed(e[0],1/h,1/g))}else c.p.dof_power=b.dof_power,
e=fa.fb(f,c,S.Db),f=fa.fb(f,e,S.Db),fa.nc(e,c.p.dof_power),fa.ed(e,1/c.p.width,1/c.p.height),fa.nc(f,c.p.dof_power),fa.ed(f,1/c.p.width,1/c.p.height)}function pa(a,b){var c=ea(a,S.Jp),d=ea(a,S.Wm);if(!c||!d)return Ca.error("Bloom is not enabled on the scene"),0;"number"==typeof b.bloom_key&&(c.bloom_key=b.bloom_key,c.wa=!0);"number"==typeof b.bloom_edge_lum&&(c.bloom_edge_lum=b.bloom_edge_lum,c.wa=!0);if("number"==typeof b.bloom_blur){var e=a.q.Pa,c=fa.fb(e,d,S.Xm),e=fa.fb(e,c,S.Xm);d.bloom_blur=
b.bloom_blur;fa.nc(c,b.bloom_blur);fa.ed(c,1/d.p.width,1/d.p.height);fa.nc(e,b.bloom_blur);fa.ed(e,1/d.p.width,1/d.p.height)}}function I(a,b){var c=ea(a,S.$m);if(!c)return Ca.error("Glow is not enabled on the scene"),null;for(var d=a.q.Pa,e=fa.cK(d,c),f=0;f<e.length;++f){var h=e[f];if(h.type==S.Db&&"GLOW_MASK_LARGE"==h.ub)var g=h;if(h.type==S.Db&&"GLOW_MASK_SMALL"==h.ub)var k=h}e=fa.fb(d,g,S.Db);d=fa.fb(d,k,S.Db);"number"==typeof b.small_glow_mask_coeff&&(c.small_glow_mask_coeff=b.small_glow_mask_coeff,
c.wa=!0);"number"==typeof b.large_glow_mask_coeff&&(c.large_glow_mask_coeff=b.large_glow_mask_coeff,c.wa=!0);"number"==typeof b.small_glow_mask_width&&(c.small_glow_mask_width=b.small_glow_mask_width,fa.nc(k,b.small_glow_mask_width),fa.ed(k,1/c.p.width,1/c.p.height),k.wa=!0,fa.nc(d,b.small_glow_mask_width),fa.ed(d,1/c.p.width,1/c.p.height),d.wa=!0);"number"==typeof b.large_glow_mask_width&&(c.large_glow_mask_width=b.large_glow_mask_width,fa.nc(g,b.large_glow_mask_width),fa.ed(g,1/c.p.width,1/c.p.height),
g.wa=!0,fa.nc(e,b.large_glow_mask_width),fa.ed(e,1/c.p.width,1/c.p.height),e.wa=!0)}function Ea(a,b,c){var d=a.q,e=d.oc;if(!e.Zn)return e.oj;var f=e.waves_height,h=e.waves_length,g=e.oj,k=Ka.length(d.Xh);a=ea(a,S.sb).time;k&&(a*=k);var l=Tc;l[0]=20/h*(b-.25*a);l[1]=20/h*(c-.25*a);k=Ja.Cy(l);l[0]=17/h*(c+.1*a);l[1]=17/h*(b+.1*a);var l=Ja.Cy(l),k=k+l-1,m=e.dst_noise_scale0,l=e.dst_noise_scale1,p=e.dst_noise_freq0,n=e.dst_noise_freq1,u=Tc;u[0]=m*(b+p*a);u[1]=m*(c+p*a);m=Ja.yw(u);u[0]=l*(c-n*a);u[1]=
l*(b-n*a);l=Ja.yw(u);l*=f*m;if(e.bj)if(n=(b-e.rm[0])/e.sm[0],u=(e.rm[1]+c)/e.sm[1],n+=.5,u+=.5,1<n||0>n||1<u||0>u)e=l;else{var d=Ja.Qz(d.tw,e.uw,n,u),u=e.dir_freq,da=e.dir_noise_scale,r=e.dir_noise_freq,m=e.dir_min_noise_fac,n=e.dst_min_fac,p=h/e.pv/Math.PI;c=[da/h*(b+r*a),da/h*(c+r*a)];b=Math.sqrt(d);e=f*Math.max(d,e.dir_min_shore_fac)*Math.sin(b/p+u*a)*Math.max(Ja.yw(c),m);f=Math.max(b,n);e=e*(1-f)+l*f;k*=d}else e=l;return g+(e+.05*k)}function ka(a,b){a.yo&&a.type==S.Db&&b.vb!=a.vb&&(a.vb=b.vb);
b.vb||a.type!=S.hl||(a.wu=0)}function Aa(a,b,c,d){var e=ya.Sa(a,b);la.qs(e.p,c,d);e.Dt=!0;ya.gj(a,b,function(b,e,f){f.hc&&f.from==c&&fa.$G(f)&&V(a,b,f.to,d)});ya.Ug(a,b,function(b,e,f){f.hc&&f.from==c&&f.from==f.to&&Aa(a,b,c,d)})}function V(a,b,c,d){a=ya.Sa(a,b).Ea;for(b=0;b<a.length;b++)for(var e=a[b].ka,f=0;f<e.length;f++)T.qM(e[f].pa,d,c)}function ua(a){var b=ea(a,S.ah);if(b){var c=b.p,d=a.ci.k;a=Da.bc(d.n,pc);var e=md;e[0]=0;e[1]=0;e[2]=-b.wd[2]/2;b=Da.ud(d.n,ob);Ka.transformQuat(e,b,e);e[0]+=
a[0];e[1]+=a[1];e[2]=0;Ia.identity(b);la.qw(c,e,b)}}function ia(a,b){ya.na(a,function(c,d){if(d.type==S.Zh){d.Ja[0]&&d.Sg[0]||Ja.r("Wrong MOTION_BLUR subscene");var e=d.Ja[0],f=d.Sg[0];d.Sg[0]=d.p.Zb;ya.gj(a,c,function(b,c,d){d.hc&&V(a,b,d.to,f)});Aa(a,c,e.from,f);V(a,c,e.to,d.Sg[0]);d.VA=Math.exp(-b/d.mb_factor)}})}function Y(a){return a.q.Xh}function aa(a,b){if(!a.q.Mg)return null;for(var c=a.q.Mg.lh,d=0;d<c.length;d++)if(c[d]==b)return d;c=a.q.Mg.ku;for(d=0;d<c.length;d++)if(c[d]==b)return d;return null}
var T=q("__batch"),xa=q("__boundings"),la=q("__camera"),ma=q("__config"),va=q("__container"),X=q("__debug"),ya=q("__graph"),Fa=q("__hud"),Ha=q("__input"),za=q("__mat4"),Ga=q("__nodemat"),Sa=q("__objects"),Ba=q("__obj_util"),da=q("__physics"),ba=q("__prerender"),Oa=q("__primitives"),Ca=q("__print"),Ia=q("__quat"),Ra=q("__renderer"),fa=q("__scenegraph"),Nb=q("__sfx"),ja=q("__shaders"),S=q("__subscene"),Wa=q("__textures"),Da=q("__tsr"),Ja=q("__util"),Ka=q("__vec3"),pb=q("__vec4"),Na=q("__version"),wa=
ma.v,qb=ma.jh,Bb=ma.ec,Qa=ma.Kk,gb=[S.ah,S.Ac,S.sb,S.gc,S.Be,S.qd,S.Wc,S.Jc,S.Ae,S.Vd,S.Ud,S.$g,S.Ce,S.mg,S.ze];a.QP=gb;var La=[S.sb,S.gc,S.Be,S.qd,S.Wc,S.Jc,S.Yh,S.Ip,S.$h,S.Ae,S.Vd,S.Jp,S.Ce,S.Ac,S.Ud,S.$g,S.mg],Ta=[S.sb,S.Np,S.gc,S.Be,S.qd,S.Wc,S.Jc,S.Ae,S.Vd],bb=[S.Ac,S.sb,S.gc,S.Be,S.qd,S.Wc,S.Jc,S.Ae,S.Vd,S.Ud,S.$g,S.Ce,S.Yh,S.mg,S.ze],Ub=[S.sb,S.gc,S.Be,S.qd,S.Wc,S.Jc,S.Ae,S.Vd],ic=null,jb=null,Pa=[],Vb=null,ed=Math.PI/2,Tc=new Float32Array(2),pc=new Float32Array(3),md=new Float32Array(3),
ob=new Float32Array(4),Ob=new Float32Array(4),xc=new Float32Array(16),ec=new Float32Array(24),fc=new Float32Array(24),jc=xa.Mc(),Ec=xa.Mc(),Zb=0,Dc=-Infinity;a.vQ=function(){return{}};a.set_active=function(a){jb=a;Nb.EM(a)};a.aM=function(a,b){var c=a.q,d=fa.NH(c.Pa);if(a==b){ra(a,va.fA(),va.eA());for(var e=0;e<d.length;e++)a.q.Ik.push(d[e])}else for(e=a.df[0],ra(a,e.q.Kh,e.q.Kh),e=0;e<d.length;e++)b.q.Ik.push(d[e]);d=sa(a,bb);for(e=0;e<d.length;e++)d[e].Xh.set(c.Xh);for(e=0;e<c.Ik.length;e++)c.Ik[e].type==
S.Ac&&Ra.Dl(c.Ik[e])};a.jk=function(){ic||(ic=e(Pa));return ic};a.Iq=e;a.get_active=c;a.Ba=function(){return jb?!0:!1};a.hk=function(a){return a.ci};a.mo=function(){return Pa};a.Ou=function(){if(1==Pa.length)return Pa;for(var a=0;a<Pa.length;a++){var b=Pa[a].q.Pa;ya.na(b,function(b,c){for(var d=c.Ea,e=0;e<d.length;e++)for(var f=d[e].ka,h=0;h<f.length;h++){for(var g=f[h],k=g.pa.T,l=null,m=0;m<k.length;m++)if("SCENE"==k[m].source&&k[m].jp==Pa[a].name&&c.type!=S.ht){Ca.error('Texture-scene loop detected. A scene is rendered to texture "'+
k[m].name+'" yet this texture belongs to the same scene.');ya.Uf(Vb,Pa[a]);l=g.pa;break}l&&(l.T=[],l.Uc=[],T.lO(l,null),T.fc(l),S.rc(c,g))}})}for(var c=[],a=0;a<Pa.length;a++)if(b=Pa[a],!b.df.length){b=ya.Uf(Vb,b);ya.XI(Vb,b);b=ya.Bs(Vb,b,ya.Ep);b=ya.Tw(b);ya.na(b,function(a,b){c.push(b)});break}return c};a.LF=function(a,c,e,n,da){a.df=a.df||[];a.ia=null;var ba=a.q,q=Ba.ga(a.ci,a),aa=a.ci.k;ba.Sm=[];var O=a.world;ba.QK=e.length;ba.Ph=f(e);ba.xs=d(O,ba.Ph);ba.rx=A(O,ba.xs);ba.uD=H(O);if(O=!a.df.length)a:{if("HMD"==
wa.stereo){if(q.R[0].type!=la.hd){Ca.warn("Head-mounted display stereo is disabled for the non-perspective camera");wa.stereo="NONE";O=!1;break a}if(!Ha.can_use_device(Ha.DEVICE_HMD)){Ca.warn("Head-mounted display stereo is disabled for the non-WebVR and non-mobile devices");wa.stereo="NONE";O=!1;break a}}O="HMD"==wa.stereo}ba.ro=O;if(O=!a.df.length)q.R[0].type!=la.hd&&"ANAGLYPH"==wa.stereo?(Ca.warn("Anaglyph stereo is disabled for the non-perspective camera"),wa.stereo="NONE",O=!1):O="ANAGLYPH"==
wa.stereo;ba.anaglyph_use=O;ba.CF=!ba.ro&&!ba.anaglyph_use&&l(a,da);ba.Mg=x(a,c,n);ba.uG=r(a);ba.xL=C(a);ba.NG=B(a);ba.oK=F(a);ba.ML=D(a);ba.vi=y(a);ba.dof=wa.dof&&(0<aa.dof_distance||aa.tc);ba.motion_blur=wa.motion_blur&&a.b4w_enable_motion_blur;ba.ul=wa.ul&&a.b4w_enable_color_correction;ba.antialiasing=wa.antialiasing&&1==wa.lc&&"NONE"!=a.b4w_antialiasing_quality;ba.ssao=wa.ssao&&a.b4w_enable_ssao;ba.god_rays=wa.god_rays&&a.b4w_enable_god_rays&&ba.Ph;ba.GI=wa.Aq;ba.Tq=a.b4w_glow_settings.render_glow_over_blend;
ba.MN=k(a);da=v(n);ba.QA=da;ba.refractions=p(a,da);ba.Sc=b(a,e,n);ba.oc=m(n);ba.lg=z(n);ba.vN=g(n);ba.shore_smoothing=t(n);ba.jc=w(a,n);ba.mH=!ba.ro&&!ba.anaglyph_use&&h(a,n);ba.outline=u(a,n);ba.th=P(a,n);switch(a.b4w_reflection_quality){case "LOW":ba.mh=Qa.cz;ba.ag=Qa.rB;break;case "MEDIUM":ba.mh=Qa.zI;ba.ag=Qa.XL;break;case "HIGH":ba.mh=Qa.yI;ba.ag=Qa.WL;break;default:ba.mh=Qa.cz,ba.ag=Qa.rB}if(va.GK())Ca.log("%cENABLE HIDPI MODE","color: #00a"),ba.Qx="AA_QUALITY_LOW",ba.re=1,wa.lc=1;else if(1<
wa.lc)Ca.log("%cENABLE MSAA RENDERING: "+wa.lc+"x","color: #00a"),ba.re=1;else{ba.Qx="AA_QUALITY_"+a.b4w_antialiasing_quality;switch(a.b4w_antialiasing_quality){case "LOW":ba.antialiasing&&(ba.re=1);break;case "MEDIUM":wa.quality==ma.P_LOW||wa.quality==ma.P_HIGH?ba.re=1:wa.quality==ma.P_ULTRA&&(ba.re=1.33);break;case "HIGH":wa.quality==ma.P_LOW?ba.re=1:wa.quality==ma.P_HIGH?ba.re=1.33:wa.quality==ma.P_ULTRA&&(ba.re=2);break;case "NONE":wa.quality==ma.P_LOW||wa.quality==ma.P_HIGH?ba.re=1:wa.quality==
ma.P_ULTRA&&(ba.re=2)}wa.quality==ma.P_CUSTOM&&(ba.re=1)}e=a.df.sort(function(a,b){return b.q.Kh-a.q.Kh});ba.Pa=fa.MH(ba,q,aa,e);ba.Ik=[];ba.Lr=!1;ba.Ev=!1;ba.Fv=!1;ba.Xh=new Float32Array(3);Pa.push(a);Vb||(Vb=ya.create());ya.H(Vb,a);for(ba=0;ba<c.length;ba++)Ba.mw(c[ba],!0,a);a=va.get_container();va.resize(a.clientWidth,a.clientHeight,!0)};a.MF=function(a,b,c){for(var d=0;d<b.length;d++)b[d].q&&b[d].q.tk&&(b[d].q.jg=c,a.q.Sm.push(b[d]))};a.Mu=function(a){return a.q.Pa};a.Lz=function(a){ya.na(a,function(b,
c){var d=null;switch(c.type){case S.Db:d=T.eu(c.as);break;case S.Np:d=T.TH(c);break;case S.tt:d=T.UH(c);break;case S.yx:d=T.yH();break;case S.Yh:fa.fb(a,c,S.jl)||fa.fb(a,c,S.ze)||fa.fb(a,c,S.gc)||fa.fb(a,c,S.Yh);d=T.CH(c.mB,c.Xg,c.Cm);break;case S.Ip:fa.fb(a,c,S.jl)||fa.fb(a,c,S.ze)||fa.fb(a,c,S.gc);fa.fb(a,c,S.Yh);d=T.DH();break;case S.Zh:d=T.HH();break;case S.ft:d=T.uH(c.Py);break;case S.Zm:var d=T.zH(c),e=c.p.dof_power;if(c.p.Nc){var e=e/2,f=fa.Nu(a,c,S.Db);fa.nc(f[0],e);fa.nc(f[1],e);f[0]=fa.fb(a,
f[0],S.Db);fa.nc(f[0],e)}else{var f=fa.fb(a,c,S.Db),h=fa.fb(a,f,S.Db);fa.nc(f,e);fa.nc(h,e)}break;case S.hl:var d=T.IH(),e=fa.fb(a,c,S.Db),f=fa.fb(a,e,S.Db),h=fa.fb(a,f,S.Db),g=fa.fb(a,h,S.Db);fa.nc(f,c.Ht);fa.nc(e,c.Ht);fa.nc(g,c.Bu*c.Lo);fa.nc(h,c.Bu*c.Lo);break;case S.$m:d=T.BH();break;case S.gt:d=T.wH();break;case S.sx:d=T.qH(c);break;case S.rt:case S.Lp:case S.bn:case S.Mp:d=T.RH(c.type);break;case S.ai:d=T.VH(c.ub);break;case S.$h:d=T.LH();break;case S.LUMINANCE:d=T.EH();break;case S.wD:d=T.rH();
break;case S.Jp:d=T.FH();break;case S.Xm:d=T.sH();break;case S.Wm:d=fa.fb(a,c,S.Xm);e=fa.fb(a,d,S.Xm);fa.nc(d,c.bloom_blur);fa.nc(e,c.bloom_blur);d=T.tH();break;case S.oF:d=T.uI();break;case S.fl:d=T.pH();break;case S.an:d=T.JH()}d&&(e=S.Cg(d,Ba.wl("NONE")),S.rc(c,e),M(a,c,d),G(d))})};a.append_object=function(a,b,c){switch(b.type){case "MESH":case "LINE":case "WORLD":var d=a.q.Pa,e=b.k;!fa.$b(d,S.Ac)&&e.Tc&&(e.Tc=!1);e=sa(a,gb);c&&b.Tk&&da.append_object(b,a);for(var f=0;f<e.length;f++){var h=e[f],
g=b,k=d,l=a,m=c;switch(h.type){case S.sb:E(h,g,k,"OPAQUE",l,m);break;case S.gc:E(h,g,k,"BLEND",l,m);break;case S.Be:E(h,g,k,"XRAY",l,m);break;case S.qd:E(h,g,k,"GLOW",l,m);break;case S.Wc:case S.Jc:Z(h,g,k,!1,l,m);break;case S.Ae:case S.Vd:Z(h,g,k,!0,l,m);break;case S.Ce:for(var p=Ba.ga(g,l).U,n=0;n<p.length;n++){var u=p[n];if("SHADOW"==u.type&&"RECEIVE"==u.ub&&u.Tc){if(!m&&(W(u,h,g,k,"SHADOW",l),!T.fc(u)))continue;S.rc(h,S.Cg(u,g.k));M(k,h,u);G(u)}}break;case S.Ac:for(var p=!1,n=g.k,g=Ba.ga(g,l).U,
u=fa.$b(k,S.ah),r=0;r<g.length;r++){var t=g[r];if("SHADOW"==t.type&&"CAST"==t.ub){p=!0;if(!m){var v=h.Pr;T.Va(t,"NUM_LIGHTS",v);T.Va(t,"NUM_LFACTORS",0==v%2?v/2:Math.floor(v/2)+1);ja.W(t.qb,"SHADOW_USAGE","SHADOW_CASTING");t.jc&&u&&J(t,u,n);T.Va(t,"SHADOW_TEX_RES",ja.F(l.q.Sc.csm_resolution));if(!T.fc(t))continue}S.rc(h,S.Cg(t,n))}}p&&(g=l.q.Sc,m=fa.$b(k,S.sb),U(h,l,m.p,g,!0));break;case S.Ud:R(h,g,k,l,m);break;case S.$g:R(h,g,k,l,m);break;case S.mg:p=g.k;n=Ba.ga(g,l).U;for(u=0;u<n.length;u++)if(r=
n[u],"COLOR_ID"==r.type&&"OUTLINE"==r.ub){if(!m&&(W(r,h,g,k,"COLOR_ID",l),T.Va(r,"USE_OUTLINE",1),!T.fc(r)))continue;S.rc(h,S.Cg(r,p))}break;case S.ah:k=g.k;g=Ba.ga(g,l).U;for(l=0;l<g.length;l++)if(p=g[l],"GRASS_MAP"==p.type){if(!m&&!T.fc(p))if("DEBUG"===Na.type())T.Zp(p,"error.glslv","error.glslf"),T.fc(p);else continue;S.rc(h,S.Cg(p,k));p=h.p;t=k.Y;n=h.wd[0];u=h.wd[1];r=h.wd[2];0==n&&0==u?(n=t.min_z,u=t.max_z):(n=Math.min(n,t.min_z),u=Math.max(u,t.max_z));t=1E-4*(u-n);n-=t;u+=t;h.wd[0]=n;h.wd[1]=
u;la.rs(p,r/2,-u,-n,r/2);la.aj(p)}break;case S.ze:for(p=g.k,g=Ba.ga(g,l).U,l=0;l<g.length;l++)n=g[l],"DEBUG_VIEW"==n.type&&ca(h,p,k,m,n)}}break;case "LAMP":K(b,a),Sa.AN(a)}Ba.mw(b,!0,a)};a.nw=function(a){a.q.Lr=!0};a.GO=function(a,b){ya.na(b,function(b,c){if(c.type===S.Ac){var d=Da.bc(a.n,pc);Da.set_trans(d,c.p.n);Da.copy(a.ye,c.p.gp)}})};a.gS=ga;a.SJ=function(a,b){for(var c=a.q.Sc,d=new Float32Array(c.csm_num),e=0;e<c.csm_num;e++)d[e]=la.xI(c,b,e);return d};a.YP=ca;a.Dy=Q;a.zn=ta;a.is_hidden=function(a){return a.k.hide};
a.iM=function(a){for(var b=0;b<a.D.length;b++)for(var c=sa(a.D[b].Ua,gb),b=0;b<c.length;b++)for(var d=c[b].Ea,e=0;e<d.length;e++)for(var f=d[e].ka,h=f.length-1;0<=h;h--){var g=f[h];g.Ig==a.k&&(g.pa&&T.Oy(g.pa),f.splice(h,1))}};a.vO=function(a,b){for(var c=a.Ta,d=Ba.ga(a,b).vk,e=sa(b,La),f=0;f<e.length;f++){var h=e[f];h.wr.set(c.Kn,3*d);h.wa=!0}};a.Nm=K;a.cleanup=function(){for(var a=0;a<Pa.length;a++){var b=Pa[a];ya.na(b.q.Pa,function(a,b){if(b.type!=S.kl){var c=b.p;Ra.kM(c.he,c.Zb,c.ee,c.width,c.height);
for(var c=b.Ea,d=0;d<c.length;d++)for(var e=c[d].ka,f=0;f<e.length;f++){var h=e[f].pa;h&&T.Oy(h)}}});b.q.Pa=[];b.q.Ik=[]}jb=ic=null;Pa.length=0;Vb=null};a.PA=function(a,b,c){a=la.cJ(a,a.near,a.far,null,!0);var d=Oa.CJ(a);a=Ba.wl("DYNAMIC");a.Y=a.J={max_x:1E12,min_x:-1E12,max_y:1E12,min_y:-1E12,max_z:1E12,min_z:-1E12};a.Aa=a.da=xa.rG();var e=a.Aa.Ka;a.va=a.Z=xa.sn([e,0,0],[0,e,0],[0,0,e],a.Aa.I);c=T.QH(d,c);S.rc(b,S.Cg(c,a))};a.aR=function(a){return[a.frame_start,a.frame_end]};a.XB=function(a,b,c){va.qN(a,
b,c);jb&&ra(jb,a,b)};a.OR=ra;a.Gw=sa;a.Da=ea;a.get_environment_colors=function(a){a=ea(a,S.sb);var b=a.Pe,c=a.cf,d=[],e=[];d[0]=b[0];d[1]=b[1];d[2]=b[2];e[0]=c[0];e[1]=c[1];e[2]=c[2];return[a.qh,d,e]};a.set_environment_colors=function(a,b,c,d){a=sa(a,La);for(var e=0;e<a.length;e++){var f=a[e];f.Pe.set(c);f.cf.set(d);f.qh=b;f.wa=!0}};a.get_sky_params=function(a){if(a=ea(a,S.$h)){var b={};b.color=Array(3);Ka.copy(a.um,b.color);b.procedural_skydome=a.procedural_skydome;b.use_as_environment_lighting=
a.use_as_environment_lighting;b.rayleigh_brightness=a.rayleigh_brightness;b.mie_brightness=a.mie_brightness;b.spot_brightness=a.spot_brightness;b.scatter_strength=a.scatter_strength;b.rayleigh_strength=a.rayleigh_strength;b.mie_strength=a.mie_strength;b.rayleigh_collection_power=a.rayleigh_collection_power;b.mie_collection_power=a.mie_collection_power;b.mie_distribution=a.mie_distribution;return b}return null};a.set_sky_params=function(a,b){var c=ea(a,S.$h);c&&("number"==typeof b.procedural_skydome&&
(c.procedural_skydome=b.procedural_skydome),"number"==typeof b.use_as_environment_lighting&&(c.use_as_environment_lighting=b.use_as_environment_lighting),"object"==typeof b.color&&c.um.set(b.color),"number"==typeof b.rayleigh_brightness&&(c.rayleigh_brightness=b.rayleigh_brightness),"number"==typeof b.mie_brightness&&(c.mie_brightness=b.mie_brightness),"number"==typeof b.spot_brightness&&(c.spot_brightness=b.spot_brightness),"number"==typeof b.scatter_strength&&(c.scatter_strength=b.scatter_strength),
"number"==typeof b.rayleigh_strength&&(c.rayleigh_strength=b.rayleigh_strength),"number"==typeof b.mie_strength&&(c.mie_strength=b.mie_strength),"number"==typeof b.rayleigh_collection_power&&(c.rayleigh_collection_power=b.rayleigh_collection_power),"number"==typeof b.mie_collection_power&&(c.mie_collection_power=b.mie_collection_power),"number"==typeof b.mie_distribution&&(c.mie_distribution=b.mie_distribution),c.wa=!0,c.Kr=!0,qa(a,c))};a.YQ=function(a){return sa(a,Ta)[0].hf[0]};a.WQ=function(a){return sa(a,
Ta)[0].hf[1]};a.ZQ=function(a){return sa(a,Ta)[0].hf[2]};a.XQ=function(a){return sa(a,Ta)[0].hf[3]};a.OM=function(a,b){for(var c=sa(a,Ta),d=0;d<c.length;d++){var e=c[d];e.hf[0]=b;e.wa=!0}};a.MM=function(a,b){for(var c=sa(a,Ta),d=0;d<c.length;d++){var e=c[d];e.hf[1]=b;e.wa=!0}};a.PM=function(a,b){for(var c=sa(a,Ta),d=0;d<c.length;d++){var e=c[d];e.hf[2]=b;e.wa=!0}};a.NM=function(a,b){for(var c=sa(a,Ta),d=0;d<c.length;d++){var e=c[d];e.hf[3]=b;e.wa=!0}};a.get_fog_color_density=function(a,b){var c=b||
[],d=sa(a,Ta)[0].Kd;c[0]=d[0];c[1]=d[1];c[2]=d[2];c[3]=d[3];return c};a.set_fog_color_density=function(a,b){for(var c=sa(a,Ta),d=0;d<c.length;d++){var e=c[d];e.Kd.set(b);e.wa=!0}};a.get_ssao_params=function(a){var b=ea(a,S.Np);a=ea(a,S.tt);if(!b)return null;var c=b.Ea[0].ka[0].pa,d={};d.ssao_quality=T.ad(c,"SSAO_QUALITY")[1];d.ssao_hemisphere=b.ssao_hemisphere;d.ssao_blur_depth=a.ssao_blur_depth;d.py=a.ssao_blur_discard_value;d.radius_increase=b.ym;d.influence=b.xm;d.dist_factor=b.wm;d.ssao_only=
b.ssao_only;d.ssao_white=T.ad(c,"SSAO_WHITE")[1];return d};a.set_ssao_params=function(a,b){var c=ea(a,S.Np),d=ea(a,S.tt);if(!c)return Ca.error("SSAO is not enabled on the scene"),0;var e=c.Ea[0].ka[0],f=e.pa;"string"==typeof b.ssao_quality&&(T.Va(f,"SSAO_QUALITY",b.ssao_quality),T.fc(f),S.rc(c,e));"number"==typeof b.ssao_hemisphere&&(T.Va(f,"SSAO_HEMISPHERE",b.ssao_hemisphere),T.fc(f),S.rc(c,e));"number"==typeof b.ssao_blur_depth&&(T.Va(f,"SSAO_BLUR_DEPTH",b.ssao_blur_depth),T.fc(f),S.rc(c,e));"number"==
typeof b.ssao_white&&(T.Va(f,"SSAO_WHITE",b.ssao_white),T.fc(f),S.rc(c,e));"number"==typeof b.ssao_blur_discard_value&&(d.ssao_blur_discard_value=b.ssao_blur_discard_value);"number"==typeof b.ym&&(c.ym=b.ym);"number"==typeof b.xm&&(c.xm=b.xm);"number"==typeof b.wm&&(c.wm=b.wm);if("number"==typeof b.ssao_only){c=ea(a,S.sb);c.ssao_only=b.ssao_only;for(var e=c.Ea,h=0;h<e.length;h++)for(var g=e[h].ka,k=0;k<g.length;k++)f=g[k].pa,T.Va(f,"SSAO_ONLY",b.ssao_only),T.fc(f),S.rc(c,g[k])}c.wa=!0;d.wa=!0};a.get_dof_params=
function(a){a=ea(a,S.Zm);if(!a)return null;var b={};b.dof_distance=a.p.dof_distance;b.dof_front_start=a.p.dof_front_start;b.dof_front_end=a.p.dof_front_end;b.dof_rear_start=a.p.dof_rear_start;b.dof_rear_end=a.p.dof_rear_end;b.dof_power=a.p.dof_power;b.Nc=a.p.Nc;b.Xa=a.p.Xa;b.tc=a.p.tc;return b};a.set_dof_params=oa;a.get_god_rays_params=function(a){var b=sa(a,[S.Yh]);a=ea(a,S.Ip);if(!b||!a)return null;var c={};c.god_rays_max_ray_length=b[0].$l;c.god_rays_intensity=a.god_rays_intensity;c.god_rays_steps=
T.ad(b[0].Ea[0].ka[0].pa,"STEPS_PER_PASS")[1];return c};a.set_god_rays_params=function(a,b){var c=sa(a,[S.Yh]),d=ea(a,S.Ip);if(!c||!d)return Ca.error("God Rays are not enabled on the scene"),0;"number"==typeof b.god_rays_intensity&&(d.god_rays_intensity=b.god_rays_intensity);if("number"==typeof b.god_rays_max_ray_length)for(var e=b.god_rays_max_ray_length,f=0;f<c.length;f++)c[f].$l=e,c[f].gs=e/c[f].Cm/(f+1),c[f].wa=!0;if("number"==typeof b.god_rays_steps)for(var h=ja.F(b.god_rays_steps,1),e=c[0].$l,
f=0;f<c.length;f++){c[f].Cm=h;c[f].gs=e/h/(f+1);c[f].wa=!0;var g=c[f].Ea[0].ka[0],k=g.pa;T.Va(k,"STEPS_PER_PASS",h);T.fc(k);S.rc(c[f],g)}d.wa=!0};a.get_bloom_params=function(a){var b=ea(a,S.Jp);a=ea(a,S.Wm);if(!b||!a)return null;var c={};c.bloom_key=b.bloom_key;c.bloom_edge_lum=b.bloom_edge_lum;c.bloom_blur=a.bloom_blur;return c};a.set_bloom_params=pa;a.get_glow_material_params=function(a){a=ea(a,S.$m);if(!a)return null;var b={};b.small_glow_mask_coeff=a.small_glow_mask_coeff;b.large_glow_mask_coeff=
a.large_glow_mask_coeff;b.small_glow_mask_width=a.small_glow_mask_width;b.large_glow_mask_width=a.large_glow_mask_width;return b};a.set_glow_material_params=I;a.get_wind_params=function(a){var b=Y(a);a=Ka.length(b);if(0==a)return null;var b=Ja.rad_to_deg(Math.atan2(b[0],-b[1])),c={};c.wind_dir=b;c.wind_strength=a;return c};a.BM=function(a){a.q.Ev=!0};a.get_water_surface_level=Ea;a.get_water_mat_params=function(a,b){var c=a.q.oc,d=ea(a,S.sb);d&&c&&(b.waves_height=c.waves_height,b.waves_length=c.waves_length,
d.Yg&&(b.water_fog_density=d.Yg[3],c=b.water_fog_color=[],c[0]=d.Yg[0],c[1]=d.Yg[1],c[2]=d.Yg[2]))};a.set_water_params=function(a,b){var c=a.q.oc;if(!c)return Ca.error("set_water_params() - no water parameters on the scene"),null;"number"==typeof b.dst_noise_scale0&&(c.dst_noise_scale0=b.dst_noise_scale0);"number"==typeof b.dst_noise_scale1&&(c.dst_noise_scale1=b.dst_noise_scale1);"number"==typeof b.dst_noise_freq0&&(c.dst_noise_freq0=b.dst_noise_freq0);"number"==typeof b.dst_noise_freq1&&(c.dst_noise_freq1=
b.dst_noise_freq1);"number"==typeof b.dir_min_shore_fac&&(c.dir_min_shore_fac=b.dir_min_shore_fac);"number"==typeof b.dir_freq&&(c.dir_freq=b.dir_freq);"number"==typeof b.dir_noise_scale&&(c.dir_noise_scale=b.dir_noise_scale);"number"==typeof b.dir_noise_freq&&(c.dir_noise_freq=b.dir_noise_freq);"number"==typeof b.dir_min_noise_fac&&(c.dir_min_noise_fac=b.dir_min_noise_fac);"number"==typeof b.dst_min_fac&&(c.dst_min_fac=b.dst_min_fac);"number"==typeof b.waves_hor_fac&&(c.waves_hor_fac=b.waves_hor_fac);
"number"==typeof b.water_dynamic&&(c.Zn=b.water_dynamic);for(var d=sa(a,Ub),e=0;e<d.length;e++){var f=d[e];"number"==typeof b.water_fog_density&&c.Kd&&(f.Yg[3]=b.water_fog_density);"object"==typeof b.water_fog_color&&c.Kd&&f.Yg.set(b.water_fog_color);"number"==typeof b.waves_height&&(f.mx=b.waves_height);"number"==typeof b.waves_length&&(f.nx=b.waves_length);f.wa=!0}};a.get_shore_dist=function(a,b,c){var d=a.q.oc;if(!d.bj)return 100;var e=d.pv;a=d.oj;var f=(b[0]-d.rm[0])/d.sm[0],h=(d.rm[1]+b[1])/
d.sm[1],f=f+.5,h=h+.5;if(1<f||0>f||1<h||0>h)b=1;else return d=e*Ja.Qz(jb.q.tw,d.uw,f,h),b=(a-b[2])*c,b=Math.sqrt(d*d+b*b)};a.update=function(a,b){for(var d=c().ci.k,e=0;e<Pa.length;e++){var f=Pa[e],h=f.q.Pa,g=f.q;if(g.oc)var k=Da.get_trans_view(d.n),l=k[2]-Ea(f,k[0],k[1]);for(k=0;k<g.Sm.length;k++){var m=g.Sm[k].q,p=m.ya,n=m.Rc;if(!(f.b4w_use_nla&&m.Pm||!p&&!n)&&Wa.pD(m)){var u=Wa.mD(m),da=Wa.oD(m);p&&wa.is_mobile_device&&(da-=5);var r=Wa.gP(m);u>=r&&m.Th||u<da?(Wa.reset_video(m.name,m.jg),n&&(m.$i=
Wa.ps(m,a))):u>=r&&!m.Th?Wa.pause_video(m.name,m.jg):Wa.qD(m)&&(p?Wa.aD(m):(p=Wa.ps(m,a),p!=m.$i&&(Wa.$C(m),m.Jh++),m.$i=p))}}ya.na(h,function(b,c){-1<bb.indexOf(c.type)&&(c.time=a);g.oc&&(c.Ot=l)})}for(e=0;e<Pa.length;e++)if(f=Pa[e],g=f.q,h=g.Pa,d=g.Ik,d.length)for(g.Lr&&(L(f),g.Lr=!1),g.Ev&&(ua(f),g.Ev=!1),g.Fv&&(O(f),g.Fv=!1),g.motion_blur&&ia(h,b),f=fa.$b(h,S.mg),k=0;k<d.length;k++)h=d[k],ba.bs(h),f&&ka(h,f),Ra.Dl(h);wa.show_hud_debug_info&&Fa.sN(Pa,b)};a.sM=function(a){a.q.Fv=!0};a.Hu=function(a){var b=
[];ya.na(a.q.Pa,function(a,c){b.push(c)});return b};a.get_cam_water_depth=function(){var a=ea(jb,S.gc),b=jb;return a||b.q.oc?a.Ot:null};a.ZC=function(a){ya.na(a.q.Pa,function(a,b){b.wa=!0})};a.HM=function(a,b){a.debug_view_mode=b;a.vb=b!=X.DV_NONE;a.mb=b==X.DV_TRANSPARENT_WIREFRAME;a.wa=!0;for(var d=c(),e=0;e<Ub.length;e++){var f=ea(d,Ub[e]);f&&(f.uu=b==X.DV_RENDER_TIME)}};a.GM=function(a,b){a.debug_colors_seed=b;a.wa=!0};a.eN=function(a,b){a.fz=b;a.wa=!0};a.lN=function(a,b){for(var c=a.Ea,d=0;d<
c.length;d++)for(var e=c[d].ka,f=0;f<e.length;f++){var h=e[f].pa;Ka.copy(b,h.wireframe_edge_color);h.wa=!0}};a.WC=function(a,b){var c=b.Gl,d=a.q.Xh;if(c&&"WIND"==c.type&&d){var e=Da.get_quat_view(b.k.n);Ka.transformQuat(Ja.AXIS_Z,e,d);Ka.normalize(d,d);Ka.scale(d,c.uC,d);c=sa(a,bb);for(e=0;e<c.length;e++)c[e].Xh.set(d);return!0}return!1};a.RL=function(a,b,c){var d=ea(a,S.Ud);if(d){var e=va.get_canvas();la.FM(d.p,b,c,e.clientWidth,e.clientHeight);ba.bs(d);d.vb&&Ra.Dl(d);if(a=ea(a,S.$g))za.copy(d.p.ab,
a.p.ab),za.copy(d.p.Ic,a.p.Ic),Ja.Fl(a.p.Ic,a.p.Ag),ba.bs(a),a.vb&&Ra.Dl(a);if(d.vb||a&&a.vb)return Ra.aw(a?a.p.he:d.p.he,0,0)}else Ca.error("Object Selection is not available on the scene");return null};a.set_outline_color=function(a){var b=c();if(b=ea(b,S.hl))b.Eh.set(a),b.wa=!0};a.eR=Y;a.get_meta_tags=function(a){var b={title:"",description:""};a.b4w_tags&&(b.title=a.b4w_tags.title,b.description=a.b4w_tags.description);return b};a.VC=function(a,b){var c=pc;Ka.negate(b,c);for(var d=0;6>d;d++){var e=
a.Tj[d],f=a.Qn[d],h=a.p;za.translate(Ja.JD[d],c,e);za.multiply(h.ab,e,h.Ic);Ja.Fl(h.Ic,f)}};a.XC=function(a,b,c){Ja.$N(b,c,Ja.AXIS_Z,a.p.Nb)};a.hG=function(a,b,c){var d=a.q.Sc,e=a.q.Mg;c=Ba.Sq(c,wa.ssao&&a.b4w_enable_ssao);if(e)for(var f=0;f<b.length;f++){var h=b[f],g=Ba.ga(h,a);if(-1!=h.k.Nd){var k=e.Kg,l=e.$r,h=h.k.Nd;l.length?g.Kg=l[h]:k.length&&(g.Kg=k[h])}else-1!=h.k.ce&&(k=e.lh,l=e.ku,h=h.k.ce,l.length?g.lh=l[h]:k.length&&(g.lh=k[h]))}for(f=0;f<c.length;f++)if(g=Ba.ga(c[f],a),d)for(b=sa(a,[S.Ac]),
e=0;e<b.length;e++)f==b[e].fg&&g.sw.push(b[e])};a.marker_frame=function(a,b){return a.timeline_markers[b]};a.set_hmd_params=function(a){var b=c();if(b=ea(b,S.ai))a.distortion_coefs&&(b.Vj[0]=a.distortion_coefs[0],b.Vj[1]=a.distortion_coefs[1],b.wa=!0),a.chromatic_aberration_coefs&&(b.chromatic_aberration_coefs[0]=a.chromatic_aberration_coefs[0],b.chromatic_aberration_coefs[1]=a.chromatic_aberration_coefs[1],b.chromatic_aberration_coefs[2]=a.chromatic_aberration_coefs[2],b.chromatic_aberration_coefs[3]=
a.chromatic_aberration_coefs[3],b.wa=!0),a.base_line_factor&&(b.Vj[2]=a.base_line_factor,b.wa=!0),a.inter_lens_factor&&(b.Vj[3]=a.inter_lens_factor,b.wa=!0),a.enable_hmd_stereo&&(b.enable_hmd_stereo=a.enable_hmd_stereo,b.wa=!0)};a.WA=function(b,c){for(var d=Pa,e=0;e<d.length;e++)fa.DL(a.Mu(d[e]),b,c)};a.gO=function(a){for(var b=Sa.xb(a,"LAMP",Sa.DATA_ID_ALL),c=sa(a,gb),d=0;d<c.length;d++)for(var e=c[d],f=e.Ea,h=0;h<f.length;h++)for(var g=f[h].ka,k=0;k<g.length;k++){var l=g[k],m=l.pa;"MAIN"==m.type&&
(T.kO(m,b,a),T.fc(m),S.rc(e,l))}};a.EB=function(a){for(var b=0;b<Pa.length;b++)ya.na(Pa[b].q.Pa,function(b,c){for(var d=c.Ea,e=0;e<d.length;e++)for(var f=d[e].ka,h=0;h<f.length;h++){var g=f[h];g.pa==a&&S.rc(c,g)}})}};b4w.module.__physics=function(a,q){function e(a,b){for(var c=a.be,d=0;d<c.length;d++)c[d].$f.wp&&b.push(c[d]),e(c[d],b)}function c(a,b,c){for(var d=a.Wb.ka,e=0;e<d.length;e++)for(var f=d[e].B,h=0;h<f.$d.length;h++){var g=f.$d[h];"ANY"!=g.Bb&&c!=g.Bb||A(g,a,b)}}function b(a,b,c){if(G.kr(a))switch(b){case G.SD:var d=n(a);d.Wb.tD=!0;G.S(a,G.QE,Date.now()-performance.now(),K.max_fps,K.Lt?N.Ez:0);break;case G.TD:Z.le("URANIUM:",c.slice(1));break;case G.OD:Z.error(c);break;case G.PD:W.fbmsg.apply(this,
c.slice(1));break;case G.YD:var e=f(c.N);if(e){a=c.trans;d=c.quat;b=c.Dg;var g=c.pg,e=e.B;e.uq=c.time;R.set_sep(a,1,d,e.mu);Q.copy(b,e.Dg);Q.copy(g,e.pg)}break;case G.VD:(a=f(c.Pt))&&R.set_sep(c.trans,1,c.quat,a.u.To[c.Vv]);break;case G.QD:if(d=f(c[1]))a=c[4],d=d.gf.fq[c[2]],ga.set_translation(d,c[3]),ga.set_rotation(d,a),ga.A(d);break;case G.ZD:if(e=f(c[1]))e.u.speed=c[2];break;case G.KD:d=n(a);t(d,c.Dj,c.Ej,c.result,null,null,0);break;case G.MD:d=n(a);t(d,c.Dj,c.Ej,c.result,c.Lj,c.coll_norm,c.coll_dist);
break;case G.LD:if(e=f(c[1]))a=e.B,a.Kj&&a.Kj(c[2]);break;case G.Ax:case G.WD:d=n(a);if(a=d.Wb.Ui[c.id])if(d=f(c.ql),b==G.Ax)b=a.callback,b(a.id,c.hit_fract,d,c.hit_time);else{b=c.hit_fract;var g=c.hit_time,e=c.hit_pos,k=a.callback;e?k(a.id,b,d,g,e,c.hit_norm):k(a.id,b,d,g)}break;case G.XD:h(id);break;case G.UD:a=na.indexOf(a);console.log("Physics #"+a+" Ping: OUT "+(c[2]-c[1]).toFixed(3)+" ms, IN "+(performance.now()-c[2]).toFixed(3)+" ms, ALL "+(performance.now()-c[1]).toFixed(3)+" ms");break;case G.RD:qa=
c[1];break;case G.ND:a=na.indexOf(a);console.log("Worker: #"+String(a));console.log(c[1]);break;default:Z.error("Wrong message: "+b)}}function n(a){for(var b=0;b<na.length;b++)if(na[b]==a)return ra[b]}function f(a){return sa[a]||null}function t(a,b,c,d,e,h,k){a=a.Wb.ka;for(var l=0;l<a.length;l++)for(var m=a[l].B,p=0;p<m.$d.length;p++){for(var n=m.$d[p],u=n.Ri,r=!1,t=0;t<u.length;t++){var v=u[t];if(v[0]===b&&v[1]===c){n.Mo[t]=d;r=!0;break}}r&&(u=g(n),e&&n.It!=b&&(r=e,t=h,v=k,r[0]+=t[0]*v,r[1]+=t[1]*
v,r[2]+=t[2]*v,t[0]*=-1,t[1]*=-1,t[2]*=-1),n.callback(u,u?n.It==b?f(c):f(b):null,e,h,k))}}function g(a){a=a.Mo;for(var b=!1,c=0;c<a.length;c++)b=b||a[c];return b}function m(){pa.body++;return pa.body}function v(a){var b=oa.indexOf(a);return-1==b?(oa.push(a),oa.length-1):b}function x(a,b){return{N:a,type:b,Gg:0,or:!1,cj:!0,je:!1,is_character:!1,EK:!1,nq:null,Bb:"",Hn:0,pQ:{},$d:[],Kj:null,uq:0,mu:new Float32Array([0,0,0,1,0,0,0,1]),Dg:new Float32Array(3),pg:new Float32Array(3),iq:new Float32Array(3),
wn:new Float32Array(4)}}function d(a,b){switch(a){case "BOX":var c=b.J;break;case "CYLINDER":c=b.rn;break;case "CONE":c=b.qn;break;case "SPHERE":c=b.da;break;case "CAPSULE":c=b.pn}return c}function k(a){if(!a)return null;var b={};"number"===typeof a.min_x&&(b.min_x=a.min_x);"number"===typeof a.min_y&&(b.min_y=a.min_y);"number"===typeof a.min_z&&(b.min_z=a.min_z);"number"===typeof a.max_x&&(b.max_x=a.max_x);"number"===typeof a.max_y&&(b.max_y=a.max_y);"number"===typeof a.max_z&&(b.max_z=a.max_z);"object"===
typeof a.I&&(b.center=a.I);"number"===typeof a.Ka&&(b.radius=a.Ka);"number"===typeof a.height&&(b.height=a.height);return b}function r(a,b,c,d,e){var f=R.get_trans_view(a.k.n),h=R.invert(b.k.n,ka),g=new Float32Array(3);R.transform_vec3(f,h,g);switch(b.u.type){case 10:b=b.we;a=a.k.J;G.S(e,G.tE,c,g,b.VN,b.iw,(a.max_z-a.min_z)/2,d);break;case 20:G.S(e,G.sE,c,g,a.YR)}}function C(a){return a.B&&a.B.nq}function B(a,b,c,d,e,f,h,g,k,l){var m;pa.Kb++;m=pa.Kb.toString(16);var p=b.B.N;G.S(F(p),G.AE,m,a,g,p,
c,d,e.B.N,f,h,k,l);b.B.nq=m}function F(a){for(var b=0;b<ra.length;b++)for(var c=ra[b].Wb.ka,d=0;d<c.length;d++)if(c[d].B.N==a)return na[b];return null}function D(a){var b=a.B;if(b=b?0===b.Gg?!0:!0===b.or?!0:!1===b.cj?!0:"RIGID_BODY"!==b.type&&"DYNAMIC"!==b.type?!0:!1:!1)var b=R.bc(a.k.n,I),c=R.ud(a.k.n,Ea),b=b[0]!=a.B.iq[0]||b[1]!=a.B.iq[1]||b[2]!=a.B.iq[2]||c[0]!=a.B.wn[0]||c[1]!=a.B.wn[1]||c[2]!=a.B.wn[2]||c[3]!=a.B.wn[3];if(b){var b=a.B,d=a.k,c=G.Yz(G.Kp);c.N=b.N;var e=R.bc(d.n,c.trans),d=R.ud(d.n,
c.quat);Q.copy(e,b.iq);L.copy(d,b.wn);"DYNAMIC"==b.type&&L.identity(c.quat);G.S(F(b.N),G.Kp)}a=a.be;for(b=0;b<a.length;b++)D(a[b])}function y(a,b,c,d,e){e=e||new Float32Array(3);a=R.get_quat_view(a.k.n);e[0]=b;e[1]=c;e[2]=d;Q.transformQuat(e,a,e)}function A(a,b,c){var d=a.Ri,e=a.Mo,f=a.It,h=[],g=a.Bb;h||ca.r("At least one destination required");for(var k=0;k<b.Wb.ka.length;k++){var l=b.Wb.ka[k];if("ANY"==g||l.B.Bb==g)l=l.B.N,h&&-1==h.indexOf(l)&&h.push(l)}for(b=0;b<h.length;b++)g=h[b],f<g&&!H(d,f,
g)?(d.push([f,g]),e.push(!1)):f>g&&!H(d,g,f)&&(d.push([g,f]),e.push(!1));G.S(c,G.rE,f);G.S(c,G.zE,d,a.sg)}function H(a,b,c){for(var d=0;d<a.length;d++)if(a[d][0]==b&&a[d][1]==c)return!0;return!1}function w(a){a.B&&a.B.Kj&&(a=a.B,G.S(F(a.N),G.ME,a.N),a.Kj=null)}function h(a){var b=P(a),c=u(a).Wb;c.Ui[a]&&(delete c.Ui[a],c.$v.splice(c.$v.indexOf,1),G.S(b,G.VE,a))}function u(a){for(var b=0;b<ra.length;b++){var c=ra[b];if(c.Wb.Ui[a])return c}return null}function P(a){for(var b=0;b<ra.length;b++)if(ra[b].Wb.Ui[a])return na[b];
return null}function p(a,b,c){if(b.Bm){a=a.B.N;var d=b.El*b.fo,e=b.un*b.vn,f=-b.zm*b.Am*2*Math.PI/b.np;b.xo&&(f*=-1);switch(b.type){case 10:G.S(c,G.hF,a,d,e,f);break;case 20:G.S(c,G.gF,a,d,e,f)}}}function z(a){return a.je&&"CHASSIS"==a.we.ne}function l(a){return a.je&&"HULL"==a.we.ne}function M(a){return a.rk&&"MAIN_BODY"==a.Hl.ne}var E=q("__config"),W=q("__debug"),G=q("__ipc"),J=q("__obj_util"),Z=q("__print"),L=q("__quat"),O=q("__scenes"),U=q("__subscene"),ga=q("__transform"),R=q("__tsr"),ca=q("__util"),
Q=q("__vec3"),ta=q("__version"),K=E.B,N=E.v,ha=E.Gd,qa=0,na=[],ra=[],sa={},ea=[],oa=["ANY"],pa={body:0,Kb:0,CB:0},I=new Float32Array(3);new Float32Array(4);var Ea=new Float32Array(4);new Float32Array(16);var ka=R.create(),Aa=R.create();a.zK=function(a){a.Wb={tD:!1,ka:[],Ui:{},$v:[]};var c=K.tp;ha.prevent_caching&&(c+=ta.timestamp());Z.log("%cLOAD PHYSICS","color: #0a0",K.Ap?"Using Separate Worker Thread,":"Using Same Thread,","Max FPS: "+K.max_fps);Z.log("%cPHYSICS PATH","color: #0a0",c);var d=G.vI(c,
!K.Ap);G.kG(d,b);na.push(d);ra.push(a);K.ping&&setInterval(function(){G.S(d,G.SE,performance.now())},1E3)};a.aH=function(a){return a.Wb?a.Wb.tD:!0};a.cleanup=function(){for(var a=0;a<na.length;a++)G.terminate(na[a]);na.length=0;ra.length=0;sa={};ea.length=0;oa.length=0;for(var b in pa)pa[b]=0};a.append_object=function(a,b){a.k||ca.r("No object render: "+a.name);var f;a:{for(var h=0;h<ra.length;h++)if(ra[h]==b){f=na[h];break a}f=void 0}var g=[];a.$f.wp&&e(a,g);var n=b.Wb.ka;if(z(a)||l(a)||a.is_character||
M(a)||a.Tk){var u,t=a,q=f,w=t.k,y=t.$f,A=y.Yr,O=m();if("CAMERA"==t.type)var E=y.gx?y.lq:"BOX",I=d(E,w),U=w.dk,F=w.Xj,U=.5,F=0;else if("EMPTY"==t.type)E="EMPTY",I=null,F=U=0;else{var E=y.gx?y.lq:"BOX",I=d(E,w),Ba=R.get_scale(w.n);if(1!=Ba){var da=I;switch(E){case "BOX":da.min_x*=Ba;da.max_x*=Ba;da.min_y*=Ba;da.max_y*=Ba;da.min_z*=Ba;da.max_z*=Ba;break;case "CYLINDER":case "CONE":case "CAPSULE":da.height*=Ba;da.Ka*=Ba;break;case "SPHERE":da.Ka*=Ba}}U=w.dk;F=w.Xj}var ba=R.get_trans_view(w.n),Oa=R.get_quat_view(w.n),
P=y.zp,Ia=y.eD,H=y.Gg,pa=y.iD,D=y.hD,ga=y.ou,S=y.kw,K=t.Bb,N=v(K),Q=y.In,W=y.Gn,qa=y.Jn,ta=w.da.Ka,ha=k(I),oa=t.qq,Bb;var Qa=E;if(g.length){var gb=[],La={};La.quat=new Float32Array([0,0,0,1]);La.trans=new Float32Array(3);La.worker_bounding=ha;La.bounding_type=Qa;gb.push(La);var Ta=R.invert(w.n,ka),bb=Ea,Ub=R.get_quat_view(w.n);L.invert(Ub,bb);for(var ic=0;ic<g.length;ic++){var jb={},Pa=g[ic],Vb=Pa.$f.lq,ed=new Float32Array(4),Tc=new Float32Array(3),pc=R.get_trans_view(Pa.k.n),md=R.get_quat_view(Pa.k.n);
R.transform_vec3(pc,Ta,Tc);L.multiply(bb,md,ed);jb.trans=Tc;jb.quat=ed;jb.bounding_type=Vb;jb.worker_bounding=k(d(Vb,Pa.k));gb.push(jb)}Bb=gb}else Bb=[];G.S(q,G.wE,O,ba,Oa,A,P,Ia,H,pa,D,ga,S,N,Q,W,qa,E,ha,ta,U,F,Bb,oa);sa[O]=t;ea.push(t);var ob=x(O,"BOUNDING");ob.type=A;ob.Gg=H;ob.or=P;ob.Bb=K;ob.Hn=N;u=ob;a.B=u;var Ob={pa:null,B:u};n.push(Ob);c(b,f,u.Bb)}else for(var xc=J.ga(a,b).U,ec=0;ec<xc.length;ec++){var fc=xc[ec],jc;if(jc="PHYSICS"==fc.type){var Ec;a:{for(var Zb=b.Wb.ka,Dc=0;Dc<Zb.length;Dc++){var nd=
Zb[Dc].pa;if(nd&&nd.id==fc.id){Ec=!0;break a}}Ec=!1}jc=!Ec}if(jc)if(fc.We.sa)if(fc.Xg&&b.q.oc){var Ib=fc,dd=b,Fc=f,qc=dd.q.oc;G.S(Fc,G.FE,qc.oj);if(Ib.nP){var wb={};wb.dst_noise_scale0=Ib.dst_noise_scale0;wb.dst_noise_scale1=Ib.dst_noise_scale1;wb.dst_noise_freq0=Ib.dst_noise_freq0;wb.dst_noise_freq1=Ib.dst_noise_freq1;wb.dir_min_shore_fac=Ib.dir_min_shore_fac;wb.dir_freq=Ib.dir_freq;wb.dir_noise_scale=Ib.dir_noise_scale;wb.dir_noise_freq=Ib.dir_noise_freq;wb.dir_min_noise_fac=Ib.dir_min_noise_fac;
wb.dst_min_fac=Ib.dst_min_fac;wb.waves_hor_fac=Ib.waves_hor_fac;var yc=qc.waves_height,hd=qc.waves_length;qc.bj?G.S(Fc,G.Jx,wb,qc.sm[0],qc.sm[1],qc.rm[0],qc.rm[1],qc.pv,yc,hd,qc.uw,dd.q.tw):G.S(Fc,G.Jx,wb,0,0,0,0,0,yc,hd,0,null)}}else{var kc;if(fc.zp){var od=a,Gc=fc,zc=f,lc=m(),Jb=Gc.We,Pb=Jb.P[0].a_position,$b=Jb.lb||null,hb=Gc.Bb,rc=v(hb),Ac=Gc.In,ac=Gc.Gn,Cb=Gc.Jn,mc=R.get_trans_view(od.k.n);G.S(zc,G.CE,lc,Pb,$b,mc,rc,Ac,ac,Cb);var gc=x(lc,"STATIC_MESH");gc.or=!0;gc.Bb=hb;gc.Hn=rc;kc=gc}else{var hc=
a,xb=fc,Hc=f,yb=m(),Za=xb.We,Uc=Za.P[0].a_position,Vc=Za.lb||null,rb=R.get_trans_view(hc.k.n),Ab=xb.dk,kb=xb.Xj,sb=xb.Bb,sc=v(sb);G.S(Hc,G.EE,yb,Uc,Vc,rb,Ab,kb,sc,xb.In,xb.Gn,xb.Jn);var tc=x(yb,"STATIC_MESH");tc.Bb=sb;tc.Hn=sc;kc=tc}u=kc;a.B=u;Ob={pa:fc,B:u};n.push(Ob);c(b,f,u.Bb)}else Z.error("Object "+a.name+" has collision material with no assigned vertices")}if(z(a)||l(a)){var cb=a,Db=f,Eb=cb.B.N;z(cb)?(cb.u.type=10,G.S(Db,G.xE,Eb,cb.u.Jw,cb.u.Lw,cb.u.Kw,cb.u.qx,cb.u.qv)):l(cb)&&(cb.u.type=20,
G.S(Db,G.vE,Eb,cb.u.ak,cb.u.al,cb.u.bl));if(cb.u.Hk){var tb=cb.u.Hk;switch(cb.u.type){case 10:r(tb[0],cb,Eb,!0,Db);r(tb[1],cb,Eb,!0,Db);r(tb[2],cb,Eb,!1,Db);r(tb[3],cb,Eb,!1,Db);break;case 20:for(var Mb=0;Mb<tb.length;Mb++)r(tb[Mb],cb,Eb,!1,Db)}}p(a,a.u,f)}else if(a.is_character){var Wb=f,uc=a.k,Oc=a.B,nc=uc.J.max_z-uc.J.min_z,bc=Oc.N,Qb=a.Ey,$a=Qb.mP,Fb=Qb.zM,Bc=Qb.NN,Ua=Qb.OK,vc=Qb.oP,Kb=ca.II(a);G.S(Wb,G.yE,bc,Kb,nc,$a,Fb,Bc,Ua,vc);Oc.is_character=!0}else if(M(a)){var lb=a,ib=f,ub=lb.B.N;G.S(ib,
G.BE,ub,lb.gf.ak,lb.gf.al,lb.gf.bl);if(lb.gf.fq)for(var Ma=lb.gf.fq,fb=0;fb<Ma.length;fb++){var db=Ma[fb],Pc=R.get_trans_view(db.k.n),mb=R.invert(lb.k.n,ka),Xa=new Float32Array(3);R.transform_vec3(Pc,mb,Xa);G.S(ib,G.uE,ub,Xa,db.qy)}lb.B.EK=!0}for(ec=0;ec<ea.length;ec++)if(a=ea[ec],a.B){var Gb=a;if(!C(Gb))for(var ab=0;ab<Gb.Sv.length;ab++){var Ya=Gb.Sv[ab],Hb=Ya.target,Rb=Ya.SL;if(Hb.B){var Qc=new Float32Array([Ya.TL,Ya.UL,Ya.VL]),Ic,Sb=new Float32Array([Ya.jd,Ya.kd,Ya.ld]);Ic=ca.euler_to_quat(Sb,
new Float32Array(4));var vb=R.identity(ka),vb=R.set_trans(Qc,vb),vb=R.set_quat(Ic,vb),Wc=R.multiply(Gb.k.n,vb,ka),Tb=R.invert(Hb.k.n,Aa),cc=R.multiply(Tb,Wc,Tb),oc=R.get_trans_view(cc),Jc=R.get_quat_view(cc),Va=Ya,eb={};eb.use_limit_x=Va.RO;eb.use_limit_y=Va.SO;eb.use_limit_z=Va.TO;eb.use_angular_limit_x=Va.NO;eb.use_angular_limit_y=Va.OO;eb.use_angular_limit_z=Va.PO;eb.limit_max_x=Va.YK;eb.limit_min_x=Va.aL;eb.limit_max_y=Va.ZK;eb.limit_min_y=Va.bL;eb.limit_max_z=Va.$K;eb.limit_min_z=Va.cL;eb.limit_angle_max_x=
Va.SK;eb.limit_angle_min_x=Va.VK;eb.limit_angle_max_y=Va.TK;eb.limit_angle_min_y=Va.WK;eb.limit_angle_max_z=Va.UK;eb.limit_angle_min_z=Va.XK;B(Rb,Gb,Qc,Ic,Hb,oc,Jc,eb,null,null)}}}};a.iJ=f;a.update=function(a,b){for(var c=0;c<na.length;c++){var d=na[c],e=a;d&&G.vA(d)&&G.S(d,G.iF,e,b);for(var f=0;f<ea.length;f++){var h=ea[f],g=h.B;if(g.cj&&g.uq){var k=G.vA(d)?e-g.uq:performance.now()/1E3-g.uq,k=Math.min(k,10/K.max_fps),k=k-1/K.max_fps;N.FL&&(k=0);var l=ka;R.AK(g.mu,k,g.Dg,g.pg,ka);ga.set_tsr(h,l);
ga.A(h);D(h);if(h.u)for(var g=h,k=g.u.Hk,l=g.k.n,m=ka,p=0;p<k.length;p++){var n=k[p];R.multiply(l,g.u.To[p],m);ga.set_tsr(n,m);ga.A(n)}h.u&&h.u.Bm&&(m=h,k=m.u,g=k.Bm)&&(p=m.u.rC,R.multiply(m.k.n,m.u.sC,g.k.n),l=I,R.transform_dir_vec3(p,m.k.n,l),m=Ea,L.setAxisAngle(l,-k.zm*k.Am*2*Math.PI,m),k=R.get_quat_view(g.k.n),L.multiply(m,k,k),ga.A(g));h.u&&h.u.Aw&&(m=h,k=m.u,g=k.Aw)&&(p=m.u.lC,R.multiply(m.k.n,m.u.mC,g.k.n),l=I,R.transform_dir_vec3(p,m.k.n,l),m=Ea,p=Math.abs(k.speed)*k.lp,p>k.am&&(p=k.am),L.setAxisAngle(l,
-p,m),k=R.get_quat_view(g.k.n),L.multiply(m,k,k),L.normalize(k,k),ga.A(g));h.u&&h.u.Mw&&(l=h,g=l.u,h=g.Mw)&&(m=l.u.BC,R.multiply(l.k.n,l.u.CC,h.k.n),k=I,R.transform_dir_vec3(m,l.k.n,k),l=Ea,L.setAxisAngle(k,-Math.abs(g.El)*g.Tn,l),g=R.get_quat_view(h.k.n),L.multiply(l,g,g),L.normalize(g,g),ga.A(h))}}G.YL(d);d=ra[c];(e=d.q.oc)&&0<e.waves_height&&(d=O.Da(d,U.sb),e=Q.length(d.Xh),G.S(na[c],G.fF,d.time*e))}};a.JJ=function(){return ra[0]};a.pause=function(){for(var a=0;a<na.length;a++)G.S(na[a],G.RE)};
a.resume=function(){for(var a=0;a<na.length;a++)G.S(na[a],G.WE)};a.enable_simulation=function(a){(a=a.B)||ca.r("No object physics");if(!a.cj){var b=a.N,c=F(b);a.cj=!0;G.S(c,G.PE,b)}};a.disable_simulation=function(a){(a=a.B)||ca.r("No object physics");if(a.cj){var b=a.N,c=F(b);a.cj=!1;G.S(c,G.OE,b)}};a.ms=function(a){return Boolean(a.Wb)};a.ha=function(a){return Boolean(a.B)};a.has_dynamic_physics=function(a){return(a=a.B)&&a.cj&&("RIGID_BODY"==a.type||"DYNAMIC"==a.type)&&0<a.Gg&&0==a.or?!0:!1};a.has_simulated_physics=
function(a){return(a=a.B)&&a.cj?!0:!1};a.set_gravity=function(a,b){var c=a.B.N;G.S(F(c),G.eF,c,b)};a.sK=C;a.apply_constraint=B;a.clear_constraint=function(a){a=a.B;G.S(F(body_a),G.UE,a.nq);a.nq=null};a.pull_to_constraint_pivot=function(b,c,d,e,f,h){c=R.set_sep(c,1,d,ka);f=R.set_sep(f,1,h,Aa);R.invert(c,c);R.multiply(f,c,c);ga.get_tsr(e,f);R.multiply(f,c,c);ga.set_tsr(b,c);ga.A(b);e=R.get_trans_view(b.k.n);f=R.get_quat_view(b.k.n);a.set_transform(b,e,f)};a.set_transform=function(a,b,c){var d=a.B,e=
G.Yz(G.Kp),f=R.bc(a.k.n,e.trans);a=R.ud(a.k.n,e.quat);R.set_sep(f,1,a,d.mu);e.N=d.N;Q.copy(b,e.trans);L.copy(c,e.quat);G.S(F(d.N),G.Kp)};a.sync_transform=D;a.apply_velocity=function(a,b,c,d){var e=I;y(a,b,c,d,e);a=a.B.N;b=Math.abs(0);c=Math.abs(0);d=Math.abs(0);var f=Math.abs(e[0]),h=Math.abs(e[1]),g=Math.abs(e[2]);e[0]=f?e[0]/f*Math.max(f,b):0;e[1]=h?e[1]/h*Math.max(h,c):0;e[2]=g?e[2]/g*Math.max(g,d):0;G.S(F(a),G.Lx,a,e[0],e[1],e[2])};a.apply_velocity_world=function(a,b,c,d){a=a.B.N;G.S(F(a),G.Lx,
a,b,c,d)};a.apply_force=function(a,b,c,d,e){var f=I;e?(f[0]=b,f[1]=c,f[2]=d):y(a,b,c,d,f);a=a.B.N;G.S(F(a),G.GE,a,f[0],f[1],f[2])};a.apply_torque=function(a,b,c,d){var e=I;y(a,b,c,d,e);a=a.B.N;G.S(F(a),G.IE,a,e[0],e[1],e[2])};a.set_character_move_dir=function(a,b,c){a=a.B.N;G.S(F(a),G.ZE,a,b,c)};a.set_character_move_type=function(a,b){var c=a.B.N;G.S(F(c),G.$E,c,b)};a.set_character_walk_velocity=function(a,b){var c=a.B.N;G.S(F(c),G.dF,c,b)};a.set_character_run_velocity=function(a,b){var c=a.B.N;G.S(F(c),
G.bF,c,b)};a.set_character_fly_velocity=function(a,b){var c=a.B.N;G.S(F(c),G.XE,c,b)};a.character_jump=function(a){a=a.B.N;G.S(F(a),G.KE,a)};a.character_rotation_inc=function(a,b,c){a=a.B.N;G.S(F(a),G.LE,a,b,c)};a.set_character_rotation=function(a,b,c){a=a.B.N;G.S(F(a),G.aF,a,b,c)};a.set_character_rotation_h=function(a,b){var c=a.B.N;G.S(F(c),G.YE,c,b)};a.set_character_rotation_v=function(a,b){var c=a.B.N;G.S(F(c),G.cF,c,b)};a.append_collision_test=function(a,b,c,d){var e=a.B,f=e.N;b=b||"ANY";for(var h=
0;h<e.$d.length;h++)if(a=e.$d[h],a.Bb==b&&a.callback==c)return;a={It:f,sg:d||!1,Bb:b,callback:c,Ri:[],Mo:[]};e.$d.push(a);b=F(f);A(a,n(b),b)};a.remove_collision_test=function(a,b,c){a=a.B;for(var d=F(a.N),e=n(d),f=0;f<a.$d.length;f++){var h=a.$d[f];if(h.Bb==b&&h.callback==c){if(g(h)){var k=Q.set(0,0,0,I);h.callback(!1,null,k,k,0)}a.$d.splice(f,1);f--;for(var k=d,h=h.Ri,l=e.Wb.ka,m=0;m<l.length;m++)for(var p=l[m].B,u=0;u<p.$d.length;u++)for(var r=p.$d[u],t=0;t<r.Ri.length;t++)for(var v=r.Ri[t],z=0;z<
h.length;z++){var q=h[z];v[0]==q[0]&&v[1]==q[1]&&(h.splice(z,1),z--)}h.length&&G.S(k,G.Kx,h)}}};a.apply_collision_impulse_test=function(a,b){a.B&&a.B.Kj&&w(a);var c=a.B;G.S(F(c.N),G.HE,c.N);c.Kj=b};a.clear_collision_impulse_test=w;a.append_ray_test=function(a,b,c,d,e,f,h,g,k){var l;pa.CB++;l=pa.CB;d=d||"ANY";a={id:l,N:a?a.B.N:0,from:new Float32Array(b),to:new Float32Array(c),Bb:d,Hn:v(d),fy:f,BG:h,sg:g,hr:k,callback:e};b=F(a.N)||na[0];c=n(b).Wb;l=a.id;c.Ui[l]=a;c.$v.push(a);G.S(b,G.DE,a.id,a.N,a.from,
a.to,a.Hn,a.fy,a.BG,a.sg,a.hr);return l};a.remove_ray_test=h;a.change_ray_test_from_to=function(a,b,c){var d=P(a),e=u(a).Wb.Ui[a];e&&!e.fy&&(e.from.set(b),e.to.set(c),G.S(d,G.JE,a,b,c))};a.wA=function(a){return u(a).Wb.Ui[a]?!0:!1};a.vehicle_throttle=function(a,b){var c=a.u;c.El=b;p(a,c,F(a.B.N))};a.vehicle_steer=function(a,b){var c=a.u;c.zm=b;p(a,c,F(a.B.N))};a.vehicle_brake=function(a,b){var c=a.u;c.un=b;p(a,c,F(a.B.N))};a.is_vehicle_chassis=z;a.is_vehicle_hull=l;a.DK=function(a){if(!a.je)return!1;
a=a.we.ne;return"WHEEL_FRONT_LEFT"==a||"WHEEL_FRONT_RIGHT"==a||"WHEEL_BACK_LEFT"==a||"WHEEL_BACK_RIGHT"==a?!0:!1};a.CK=function(a){return a.je?"BOB"==a.we.ne?!0:!1:!1};a.FK=function(a){return a.rk?"BOB"==a.Hl.ne?!0:!1:!1};a.yA=function(a){return a.je&&"STEERING_WHEEL"==a.we.ne?!0:!1};a.xA=function(a){return a.je&&"SPEEDOMETER"==a.we.ne?!0:!1};a.zA=function(a){return a.je&&"TACHOMETER"==a.we.ne?!0:!1};a.get_vehicle_speed=function(a){return a.u.speed};a.qP=function(a){switch(a){case "WHEEL_FRONT_RIGHT":return 0;
case "WHEEL_FRONT_LEFT":return 1;case "WHEEL_BACK_LEFT":return 2;case "WHEEL_BACK_RIGHT":return 3}};a.is_character=function(a){return a.is_character};a.rR=M;a.YJ=function(){return qa};a.DI=function(){for(var a=0;a<na.length;a++)G.S(na[a],G.NE)};a.remove_object=function(a){if("BOUNDING"==a.B.type){var b=ea.indexOf(a);-1==b&&Z.error("Object "+a.name+" doesn't have bounding physics");delete sa[c];ea.splice(b,1)}for(var c=a.B.N,b=F(c),d=n(b),e=c,f=d.Wb.ka,h=[],k=0;k<f.length;k++)for(var l=f[k].B,m=0;m<
l.$d.length;m++)for(var p=l.$d[m],u=0;u<p.Ri.length;u++){var r=p.Ri[u],t=p.Mo[u];if(r[0]==e||r[1]==e)p.Ri.splice(u,1),p.Mo.splice(u,1),u--,t&&!g(p)&&(t=Q.set(0,0,0,I),p.callback(!1,null,t,t,0)),h.push(r)}h.length&&G.S(b,G.Kx,h);a.B&&a.B.Kj&&w(a);a=d.Wb.ka;for(d=0;d<a.length;d++)a[d].B.N==c&&(a.splice(d,1),d--);G.S(b,G.TE,c)}};b4w.module.__data=function(a,q){function e(a,b){Ja[b.id]=null;Ka[b.id]=null}function c(a,b,c,d){a instanceof ArrayBuffer&&(a=Ea.hA(a,d));d=a.width;a=a.height;X.log("%cLOAD IMAGE "+d+"x"+a,"color: #"+(2048<d||2048<a?"a00":1024<d||1024<a?"aa0":"0a0"),b);-1==b.indexOf(pb)&&c&&X.warn("image",b,"is not from app root.")}function b(a,b,c,d,e,f){(d=b.zg)||Ia.r("Nothing requested");ea.enqueue([{id:d,type:ea.AT_JSON,url:d}],function(d,f,h,g){if(d){X.log("%cLOAD METADATA","color: #616",g);f=Ia.tC(d.b4w_format_version);
switch(Ia.jD(f,ja.yk)){case -1:f[0]<ja.yk[0]?Ia.r("JSON version is too old relative to B4W engine: "+Ia.mj(f)+", required: "+Ia.mj(ja.yk)+". Reexport scene with the latest B4W addon to fix it."):X.warn("JSON version is a bit old relative to B4W engine: "+ +Ia.mj(f)+", required: "+Ia.mj(ja.yk)+". Some compatibility issues can occur. Reexport scene with the latest B4W addon to fix it.");break;case 1:f[0]>ja.yk[0]?Ia.r("B4W engine version is too old relative to JSON. Can't load the scene. Update your engine version to fix it."):
X.warn("B4W engine version is a bit old relative to JSON. Some compatibility issues can occur. Update your engine version to fix it.")}ja.lv=f;for(var k in d)a[k]=d[k];b.nb&&(Na=za.Iq(a.scenes));(d=a.binaries[0].binfile)?b.my=d:(ua.ws(b,"load_binaries"),ua.ws(b,"prepare_bindata"));ja.is_mobile_device||ua.ws(b,"mobile_media_start");ja.antialiasing&&ja.smaa||ua.ws(b,"load_smaa_textures");if(a.b4w_export_errors)for(d=0;d<a.b4w_export_errors.length;d++)k=a.b4w_export_errors[d],(b.nb&&"PRIMARY"==k.type||
"ALL"==k.type)&&X.$I(k.text+" See more details in https://www.blend4web.com/doc/en/addon.html#non-critical-export-errors");if(a.b4w_export_warnings)for(d=0;d<a.b4w_export_warnings.length;d++)k=a.b4w_export_warnings[d],(b.nb&&"PRIMARY"==k.type||"ALL"==k.type)&&X.aJ(k.text+" See more details in https://www.blend4web.com/doc/en/addon.html#other-messages");e(b,c)}else ua.Rx(b)},null,function(a){f(b,c,a)})}function n(a,b,c,d,e,f){(d=ha(b.zg)+b.my)||Ia.r("Binary data is missing");ea.enqueue([{id:d,type:ea.AT_ARRAYBUFFER,
url:d}],function(d,f,h,k){d?(X.log("%cLOAD BINARY","color: #616",k),a.bin_data=d,d=g(d),f=Ia.tC(a.b4w_format_version),d[0]!=f[0]&&Ia.r("BIN version does not match to JSON version: "+Ia.mj(d)+", required: "+Ia.mj(ja.yk)+". Couldn't load the scene. Reexport scene to fix it."),d[1]!=f[1]&&X.warn("BIN version does not match to JSON version: "+ +Ia.mj(d)+", required: "+Ia.mj(ja.yk)+". Some compatibility issues can occur. Reexport scene to fix it."),e(b,c)):ua.Rx(b)},null,function(a){f(b,c,a)})}function f(a,
b,c,d,e){Sa.Jy()&&e(b,c)}function t(a,b,c,d,e){d=a.bin_data;var f=a.binaries[0],h=a.objects,k=a.meshes;a=a.actions;var l=Ia.VG();g(d);for(var p=["indices"],n=["normal","tangent"],u=["color","group"],da=["position","texcoord","texcoord2","shade_tangs"],r=0;r<k.length;r++)for(var t=k[r].submeshes,v=0;v<t.length;v++){for(var ba in t[v]){var z=t[v][ba][1];if(-1!=p.indexOf(ba)){var q=4*t[v][ba][0]+f["int"]+12,w=t[v],y=ba,x=d;if(l)var A=new Uint32Array(x,q,z);else for(var A=new Uint32Array(z),x=new DataView(x),
O=0;O<z;O++)A[O]=x.getUint32(q+4*O,!0);w[y]=A}else if(-1!=da.indexOf(ba))q=4*t[v][ba][0]+f["float"]+12,t[v][ba]=m(d,q,z,l);else if(-1!=n.indexOf(ba)){q=2*t[v][ba][0]+f["short"]+12;w=t[v];y=ba;x=d;A=new Float32Array(z);x=new DataView(x);for(O=0;O<z;O++)A[O]=x.getInt16(q+2*O,!0)/32767;w[y]=A}else if(-1!=u.indexOf(ba)){q=2*t[v][ba][0]+f.ushort+12;w=t[v];y=ba;x=d;A=new Float32Array(z);x=new DataView(x);for(O=0;O<z;O++)A[O]=x.getUint16(q+2*O,!0)/65535;w[y]=A}}z=t[v];if(k[r].b4w_shape_keys.length)for(q=
z.base_length,w=z.normal.length/q/3,z.tbn_quat=Ia.gen_tbn_quats(z.normal.subarray(0,3*q),z.tangent.subarray(0,4*q),new Float32Array(z.normal.length/3*4)),y=1;y<w;y++)for(x=y*q,A=0;A<q;A++){var B=z.normal.subarray(3*A,3*(A+1)),O=Ra.add(z.normal.subarray(3*(x+A),3*(x+A+1)),B,qb);if(z.tangent.length){var aa=z.tangent.subarray(4*A,4*(A+1)),ma=fa.add(z.tangent.subarray(4*(x+A),4*(x+A+1)),aa,Bb),B=Ia.dA(B,aa,Qa),O=Ia.dA(O,ma,gb);ya.invert(B,Qa);O=ya.multiply(O,B,Qa)}else O=ya.rotationTo(B,O,Qa);z.tbn_quat.subarray(4*
(x+A),4*(x+A+1)).set(O)}else z.tbn_quat=Ia.gen_tbn_quats(z.normal,z.tangent)}for(ba=0;ba<h.length;ba++)for(k=h[ba].particle_systems,p=0;p<k.length;p++)n=k[p],n.transforms=m(d,4*n.transforms[0]+f["float"]+12,n.transforms[1],l);for(h=0;h<a.length;h++){ba=a[h];k=ba.fcurves;p=ba.frame_range;u=p[0];da=p[1];r=sa.NJ(u,da);p=null;0>r&&(r=0);var v=t=!1,C;for(C in k)t|=-1<C.indexOf("rotation_euler"),v|=-1<C.indexOf("rotation_quaternion");n=[];for(C in k)if(t&&v&&-1<C.indexOf("rotation_euler"))delete k[C];else{var z=
k[C],va;for(va in z)q=z[va],w=m(d,f["float"]+4*q.bin_data_pos[0]+12,q.bin_data_pos[1],l),y=new Float32Array(r),null===p&&(p=new Int8Array(r)),sa.cG(q,w,y,p,u,da),q.De=y;-1<C.indexOf("rotation_euler")&&(sa.gJ(k[C]),n.push(C))}for(u=0;u<n.length;u++)da=n[u],r=da.replace("euler","quaternion"),k[r]=k[da],delete k[da];ba.vF=p}e(b,c)}function g(a){new Uint8Array(a,0,4);var b=(new Uint32Array(a,4,1))[0];a=(new Uint32Array(a,8,1))[0];return[b,a]}function m(a,b,c,d){if(d)d=new Float32Array(a,b,c);else{d=new Float32Array(c);
a=new DataView(a);for(var e=0;e<c;e++)d[e]=a.getFloat32(b+4*e,!0)}return d}function v(a,b,c,d,e){var f=a.cameras,h=a.groups,g=a.materials,l=a.meshes,m=a.node_groups,p=a.objects,n=a.particles,u=a.scenes,t=a.speakers,v=a.lamps,z=a.textures,q=a.worlds;m||(X.warn('"node_groups" datablock undefined. reexport main scene.'),m=a.node_groups=[]);for(var w="actions armatures cameras curves groups images lamps materials meshes node_groups objects particles scenes sounds speakers textures worlds".split(" "),
y={},O=0;O<w.length;O++)for(var B=a[w[O]],aa=0;aa<B.length;aa++){var ma=B[aa];y[ma.uuid]=ma}for(var C=0;C<u.length;C++){for(var E=u[C],I=E.objects,T=0;T<I.length;T++)H(I,T,y);E.camera&&H(E,"camera",y);E.world&&H(E,"world",y)}for(C=0;C<h.length;C++)for(var xa=h[C].objects,T=0;T<xa.length;T++)H(xa,T,y);for(C=0;C<p.length;C++){var Oa=p[C];Oa.dupli_group&&H(Oa,"dupli_group",y);Oa.parent&&H(Oa,"parent",y);Oa.dg_parent&&H(Oa,"dg_parent",y);if(Oa.animation_data){var U=Oa.animation_data;U.action&&H(U,"action",
y);if(U.nla_tracks)for(T=0;T<U.nla_tracks.length;T++)for(var L=U.nla_tracks[T],J=0;J<L.strips.length;J++)L.strips[J].action&&H(L.strips[J],"action",y)}switch(Oa.type){case "MESH":Oa.data||Ia.r("mesh not found for object "+Oa.name);H(Oa,"data",y);for(var Ba=!1,M=Oa.modifiers,T=0;T<M.length;T++){var F=M[T];"ARMATURE"==F.type?(Ba&&X.warn('Object "'+Oa.name+'" has more than one armature modifiers. Only the first one will be used.'),Ba=!0,H(F,"object",y)):"CURVE"==F.type&&H(F,"object",y)}var P=Oa.particle_systems;
if(P)for(T=0;T<P.length;T++)H(P[T],"settings",y);break;case "ARMATURE":H(Oa,"data",y);for(var S=Oa.pose.bones,Ca=Oa.data.bones,T=0;T<S.length;T++){var pa=S[T];pa.bone=Ca[pa.bone];var Z=pa.constraints;if(Z)for(J=0;J<Z.length;J++){var R=Z[J];R.target&&H(R,"target",y)}for(var fa=pa.parent_recursive,J=0;J<fa.length;J++)fa[J]=S[fa[J]]}break;case "LAMP":case "CAMERA":case "SPEAKER":case "CURVE":H(Oa,"data",y)}if(Z=Oa.constraints)for(T=0;T<Z.length;T++)R=Z[T],R.target&&H(R,"target",y);var D=Oa.lod_levels;
if(D)for(T=0;T<D.length;T++){var Sa=D[T];Sa.object&&H(Sa,"object",y)}}for(C=0;C<l.length;C++)for(var ga=l[C].materials,T=0;T<ga.length;T++)H(ga,T,y);for(C=0;C<g.length;C++){for(var ya=g[C],Nb=ya.texture_slots,T=0;T<Nb.length;T++)H(Nb[T],"texture",y);var K=ya.node_tree;K&&A(K,y)}for(C=0;C<m.length;C++)(K=m[C].node_tree)&&A(K,y);for(C=0;C<z.length;C++){var Ra=z[C],ja=Ra.type;"IMAGE"!=ja&&"ENVIRONMENT_MAP"!=ja||H(Ra,"image",y)}for(C=0;C<f.length;C++){var N=f[C];N.dof_object&&H(N,"dof_object",y)}for(C=
0;C<t.length;C++){var Ea=t[C];Ea.sound&&H(Ea,"sound",y);if(Ea.animation_data&&(U=Ea.animation_data,U.action&&H(U,"action",y),U.nla_tracks))for(T=0;T<U.nla_tracks.length;T++)for(L=U.nla_tracks[T],J=0;J<L.strips.length;J++)L.strips[J].action&&H(L.strips[J],"action",y)}for(C=0;C<n.length;C++){for(var Q=n[C],Nb=Q.texture_slots,T=0;T<Nb.length;T++)H(Nb[T],"texture",y);Q.dupli_group&&H(Q,"dupli_group",y);Q.dupli_object&&H(Q,"dupli_object",y)}for(C=0;C<v.length;C++){var W=v[C];if(W.animation_data&&(U=W.animation_data,
U.action&&H(U,"action",y),U.nla_tracks))for(T=0;T<U.nla_tracks.length;T++)for(L=U.nla_tracks[T],J=0;J<L.strips.length;J++)L.strips[J].action&&H(L.strips[J],"action",y)}for(C=0;C<q.length;C++){var Ja=q[C];if(Nb=Ja.texture_slots)for(T=0;T<Nb.length;T++)H(Nb[T],"texture",y);if(Ja.animation_data&&(U=Ja.animation_data,U.action&&H(U,"action",y),U.nla_tracks))for(T=0;T<U.nla_tracks.length;T++)for(L=U.nla_tracks[T],J=0;J<L.strips.length;J++)L.strips[J].action&&H(L.strips[J],"action",y)}Fa.RG(a);for(var ca=
a.textures,Da=b.nb?a.scenes[0].b4w_anisotropic_filtering:Na.b4w_anisotropic_filtering,qa=0;qa<ca.length;qa++)b.nb||"SCENE"!=ca[qa].b4w_source_type||(ca[qa].b4w_source_id=""),da.rI(ca[qa],Da,a.scenes,b.id);for(var ka={},V=a.objects,Ha=0;Ha<V.length;Ha++){var na=V[Ha];if("MESH"===na.type&&!na.particle_systems.length)for(var ra=na.data,ea=ra.name,Y=ra.submeshes,ta=ra.materials,bb=0;bb<Y.length;bb++)0!==Y[bb].base_length||ka[ea]||(ta[bb]&&X.warn('material "'+ta[bb].name+'" is not assigned to any face (object "'+
na.name+'").'),ka[ea]=!0)}for(var ha=a.meshes,oa=0;oa<ha.length;oa++){var wa=ha[oa];wa.materials.length||wa.uv_textures.length&&X.warn('mesh "'+wa.name+'" has a UV map but has no exported material.')}a.materials.push(Fa.GH());for(var ia=a.meshes,Aa=Ia.keysearch("name","DEFAULT",a.materials),ua=0;ua<ia.length;ua++){var pb=ia[ua];0==pb.materials.length&&pb.materials.push(Aa)}for(var qb=a.actions,Ta=b.id,La=0;La<qb.length;La++){var Qa=qb[La];Qa.wF=Ta;sa.EF(Qa)}for(var Pa=a.scenes,jb=0;jb<Pa.length;jb++){for(var gb=
Pa[jb],Ub=[],Bb=[],Sb=Pa[jb].objects,vb=0;vb<Sb.length;vb++){var Wc=Sb[vb];G(Sb,Wc,null,Ub,Bb);var Tb=Wc.dupli_group;if(Tb)for(var cc=Tb.objects,oc=0;oc<cc.length;oc++)G(cc,cc[oc],Wc,Ub,Bb)}for(vb=0;vb<Bb.length;vb++)for(var Jc=Bb[vb],Va=[gb],eb=0;eb<Va.length;eb++){for(var Kc=Va[eb].objects,Xb=0;Xb<Kc.length;Xb++){var Lb=Kc[Xb].dupli_group;if(Lb){var Xc=Lb.objects,Lc=Xc.indexOf(Jc);-1<Lc&&Xc.splice(Lc,1)}}var Lc=Kc.indexOf(Jc);-1<Lc&&Kc.splice(Lc,1)}for(vb=0;vb<Ub.length;vb++)Ia.ZF(Ub[vb][0],Ub[vb][1])}!b.nb&&
1<a.scenes.length&&(a.scenes=[za.Iq(a.scenes)],X.warn("loading data contains multiple scenes.","Only the first one will be loaded."));var Rc=b.nb?Na:za.Iq(a.scenes);ba.RM(Na.fps);1<a.scenes.length&&(a.scenes.splice(a.scenes.indexOf(Na),1),a.scenes.unshift(Na));for(var Sc=0;Sc<a.scenes.length;Sc++){var dc=a.scenes[Sc];dc.q={};dc.Px=dc==Rc;dc.xF=b.nb;Wa.enabled&&dc.b4w_enable_physics&&(b.nb||!va.ms(Na)&&dc==za.Iq(a))&&va.zK(dc)}for(var Yb=0;Yb<a.scenes.length;Yb++){for(var Yc=a.scenes[Yb],wc=x(Yc),
Zc=0;Zc<wc.length;Zc++){var nb=wc[Zc];la.SG(nb,Yc,a)&&(nb.Lc||(nb.Lc=[]),nb.Lc.push(b.nb?Yc:Na))}for(var Mc=wc,fd=0;fd<Mc.length;fd++){var $c=Mc[fd];if($c.Lc&&"WORLD"!=$c.type)for(var jd=$c.particle_systems,pd=0;pd<jd.length;pd++){var ad=jd[pd].settings;if("HAIR"==ad.type)if("OBJECT"==ad.render_type){var bd=ad.dupli_object;bd.Lc||(bd.Lc=$c.Lc.slice())}else if("GROUP"==ad.render_type)for(var qd=ad.dupli_group,Cc=0;Cc<qd.objects.length;Cc++)bd=qd.objects[Cc],bd.Lc||(bd.Lc=$c.Lc.slice())}}}for(var cd=
a.scenes,kd=[],zb=0;zb<cd.length;zb++)k(cd[zb].objects,0,b.nb,kd);Ka[b.id]=[];for(zb=0;zb<kd.length;zb++)for(var rd=kd[zb],Nc=0;Nc<rd.length;Nc++)for(var sd=rd[Nc],ld=0;ld<sd.length;ld++)Ka[b.id].push(sd[ld]);for(var td=a.particles,zb=0;zb<td.length;zb++){var gd=td[zb].dupli_object;gd&&(gd.Ox=!0,Ka[b.id].push(gd));var Cd=td[zb].dupli_group;if(Cd)for(var Dd=Cd.objects,Nc=0;Nc<Dd.length;Nc++)gd=Dd[Nc],gd.Ox=!0,Ka[b.id].push(gd)}for(var ud=Ka[b.id],zb=ud.length-1;0<=zb;zb--)ud[zb].Lc||ud.splice(zb,1);
for(var Ed=Ka[b.id],Yb=0;Yb<Ed.length;Yb++)if(nb=Ed[Yb],!b.nb&&nb.parent&&-1<ic.indexOf(nb.parent.type)&&(nb.parent=""),"MESH"==nb.type){var vd=Fa.bG(nb);vd&&(a.meshes.push(vd),nb.data=vd)}for(var wd=0;wd<a.scenes.length;wd++){var Fd=a.scenes[wd],xd=Fd.world;xd.Lc||(xd.Lc=[]);xd.Lc.push(b.nb?Fd:Na)}for(var yd=0;yd<a.scenes.length;yd++){var zd=a.scenes[yd];if(zd.b4w_use_logic_editor){var Gd=x(zd);Fa.gG(Gd,zd)}}for(var Ad=0;Ad<a.scenes.length;Ad++){var Hd=a.scenes[Ad],Bd=b.nb?Hd:Na;Boolean(r(b.id,Bd,
"SPEAKER").length)&&!Bd.qc&&Ga.lG(Bd)}e(b,c)}function x(a){var b=[];-1==a.objects.indexOf(a.camera)&&a.objects.push(a.camera);d(a.objects,"ALL",b);return b}function d(a,b,c){for(var e=0;e<a.length;e++){var f=a[e];"ALL"!=b&&b!=f.type||c.push(f);(f=f.dupli_group)&&d(f.objects,b,c)}}function k(a,b,c,d){d[b]=d[b]||[];for(var e=d[b],f=0;f<a.length;f++){var h=a[f],g=na(h);e[g]=e[g]||[];(c||-1==ic.indexOf(h.type))&&-1==e[g].indexOf(h)&&e[g].push(h);(h=h.dupli_group)&&k(h.objects,b+1,c,d)}}function r(a,b,
c){var d=[];a=Ka[a];for(var e=0;e<a.length;e++){var f=a[e];if(f.type==c||"ALL"==c)for(var h=0;h<f.Lc.length;h++)b==f.Lc[h]&&d.push(f)}return d}function C(a,b,c,d,e){var f=Ka[b.id],h=a.worlds;d=b.id;for(var g=0;g<f.length;g++){for(var k=f[g],l=ma.Nn(k.name,k.type,k.origin_name),m=0;m<k.Lc.length;m++)ma.kn(l,k.Lc[m]);k.Ga=l;la.kj(k,l);l.k.sd=d;l.zo=k.Ox||!1}for(d=0;d<h.length;d++){g=h[d];k="%meta_world%"+g.name;k=ma.Nn(k,"WORLD",k);for(l=0;l<g.Lc.length;l++)ma.kn(k,g.Lc[l]);g.Ga=k;la.KO(g,k)}d=la.get_all_objects(b.id);
for(g=0;g<f.length;g++)k=f[g],l=k.Ga,Y.kj(k,l);for(g=0;g<h.length;g++)k=h[g],Y.kj(k,k.Ga);if(b.nb)for(h=b.id,g=0;g<a.scenes.length;g++)for(var k=a.scenes[g],l=0,m=la.xb(k,"LAMP",h),p=0;p<m.length;p++)ma.ga(m[p],k).vk=l++;for(g=0;g<f.length;g++)k=f[g],l=k.Ga,l.zo||(la.zO(k,l),Oa.A(l));for(a=0;a<f.length;a++)if(h=f[a],g=h.Ga,ma.is_mesh(g)&&(k=h.lod_levels.length))for(l=g,m=0;m<k;m++)if(p=h.lod_levels[m].object){p=p.Ga;p.k.Ei=g.k.Ei;l.k.Fg=h.lod_levels[m].distance;p.k.xk=h.lod_levels[m].distance;if(h.lod_levels[m+
1])p.k.Fg=h.lod_levels[m+1].distance;else{p.k.Xl=!0;p.k.Fg=ma.pt;break}l.k.Xl=!1;l=p}else{l.k.Xl=!0;l.k.Fg=h.lod_levels[m].distance;break}for(f=0;f<d.length;f++)if(a=d[f],"MESH"==a.type&&(h=a.$p)){var h=h.k,g=a.k.ii,k=[],n;for(n in g)l=g[n],k.push(4*l.qu,4*l.hi);h.Fr.push(k);h.tm.push(a.k)}f=n=-1;a=sa.Xz();for(h=0;h<d.length;h++)g=d[h],k=g.k,ma.is_mesh(g)&&k.Bi&&(g=k.Tf,g>n&&(n=g),a>=g&&g>f&&(f=g));for(h=0;h<d.length;h++)g=d[h],k=g.k,ma.is_mesh(g)&&k.Bi&&(k.ck=!0,n<a?k.Tf=n:k.Tf<=a?k.Tf=f:(X.warn('too many bones for "'+
g.name+'" / '+k.Tf+" bones (max "+a+" with blending, "+2*a+" without blending). Blending between frames will be disabled."),k.Tf=n,k.ck=!1),k.ck=k.ck&&!Nb.Gz);for(n=0;n<d.length;n++)if(f=d[n],f.je)if(a=f.we,"CHASSIS"==a.ne){f.u={};f.u.fo=a.fo;f.u.vn=a.vn;f.u.Jw=a.Jw;f.u.Lw=a.Lw;f.u.Kw=a.Kw;f.u.qx=a.qx;f.u.iw=a.iw;f.u.qv=a.qv;f.u.El=0;f.u.un=1;f.u.zm=0;f.u.speed=0;f.u.Hk=[];f.u.To=[];f.u.Bm=null;g=(h=ma.get_dg_parent(f))?ma.Iu(h,d):d;for(h=0;h<g.length;h++)k=g[h],k.je&&(l=k.we,va.DK(k)&&a.name==l.name?
(l=va.qP(k.we.ne),f.u.Hk[l]=k,f.u.To[l]=new Float32Array(8)):va.yA(k)&&a.name==l.name?(f.u.Bm=k,f.u.Am=l.Am,f.u.np=l.np,f.u.xo=l.xo,l=Ca.invert(f.k.n,Ca.create()),k=Ca.multiply(l,k.k.n,l),f.u.sC=k,l=new Float32Array([1,0,0]),Ca.transform_dir_vec3(l,k,l),f.u.rC=l):va.xA(k)&&a.name==l.name?(f.u.Aw=k,f.u.lp=l.lp,f.u.am=l.am,l=Ca.invert(f.k.n,Ca.create()),k=Ca.multiply(l,k.k.n,l),f.u.mC=k,l=new Float32Array([1,0,0]),Ca.transform_dir_vec3(l,k,l),f.u.lC=l):va.zA(k)&&a.name==l.name&&(f.u.Mw=k,f.u.Tn=l.Tn,
l=Ca.invert(f.k.n,Ca.create()),k=Ca.multiply(l,k.k.n,l),f.u.CC=k,l=new Float32Array([1,0,0]),Ca.transform_dir_vec3(l,k,l),f.u.BC=l));4!=f.u.Hk.length&&Ia.r("Not enough wheels for chassis "+f.name)}else if("HULL"==a.ne)for(f.u={},f.u.Hk=[],f.u.To=[],f.u.fo=a.fo,f.u.vn=a.vn,f.u.ak=a.ak,f.u.al=a.al,f.u.bl=a.bl,f.u.El=0,f.u.un=1,f.u.zm=0,f.u.speed=0,f.u.Bm=null,g=(h=ma.get_dg_parent(f))?ma.Iu(h,d):d,h=0;h<g.length;h++)k=g[h],k.je&&(l=k.we,va.CK(k)&&a.name==l.name?(f.u.Hk.push(k),f.u.To.push(new Float32Array(8))):
va.yA(k)&&a.name==l.name?(f.u.Bm=k,f.u.Am=l.Am,f.u.np=l.np,f.u.xo=l.xo,l=Ca.invert(f.k.n,Ca.create()),k=Ca.multiply(l,k.k.n,l),f.u.sC=k,l=new Float32Array([1,0,0]),Ca.transform_dir_vec3(l,k,l),f.u.rC=l):va.xA(k)&&a.name==l.name?(f.u.Aw=k,f.u.lp=l.lp,f.u.am=l.am,l=Ca.invert(f.k.n,Ca.create()),k=Ca.multiply(l,k.k.n,l),f.u.mC=k,l=new Float32Array([1,0,0]),Ca.transform_dir_vec3(l,k,l),f.u.lC=l):va.zA(k)&&a.name==l.name&&(f.u.Mw=k,f.u.Tn=l.Tn,l=Ca.invert(f.k.n,Ca.create()),k=Ca.multiply(l,k.k.n,l),f.u.CC=
k,l=new Float32Array([1,0,0]),Ca.transform_dir_vec3(l,k,l),f.u.BC=l));for(n=0;n<d.length;n++)if(f=d[n],f.rk&&(a=f.Hl,"MAIN_BODY"==a.ne))for(f.gf={},f.gf.ak=a.ak,f.gf.al=a.al,f.gf.bl=a.bl,f.gf.fq=[],h=(h=ma.get_dg_parent(f))?ma.Iu(h,d):d,g=0;g<h.length;g++)k=h[g],k.rk&&(l=k.Hl,va.FK(k)&&a.name==l.name&&(f.gf.fq.push(k),k.qy=k.Hl.AC));e(b,c)}function B(a,b,c,d,e){for(d=0;d<a.scenes.length;d++){var f=a.scenes[d];f.ci=f.camera.Ga}for(d=0;d<a.scenes.length;d++){var f=b.nb?a.scenes[d]:Na,h=b.nb?la.xb(f,
"LAMP",b.id):la.xb(f,"LAMP",0),g=la.xb(f,"ALL",b.id),k=r(b.id,f,"MESH"),l=r(b.id,f,"EMPTY");r(b.id,f,"WORLD");b.nb&&za.LF(f,g,h,k,l);for(var g=!1,m=0;m<l.length;m++)for(var p=l[m].Ga,n=p.D,u=0;u<n.length;u++){var da=n[u].Ua,t=za.WC(da,p);f.name==da.name&&(g=g||t)}b.nb&&f.q.oc&&!g&&X.warn('Scene "'+f.name+'" has water but has no wind.');l=[];za.set_active(f);oa.HJ(f,k,h,l);m=r(b.id,f,"LINE");oa.GJ(f,m);p=za.Mu(f);if(b.nb){m=f.q.xs;if(m.jM||m.procedural_skydome)g=f.world.Ga,oa.QF(f,m,g),oa.cu(g,p,f);
za.Lz(p)}for(m=0;m<k.length;m++)oa.cu(k[m].Ga,p,f);for(m=0;m<l.length;m++)oa.cu(l[m],p,f),la.JL(l[m]);g=la.xb(f,"ALL",b.id);za.hG(f,g,h);for(m=0;m<g.length;m++)p=g[m],p.k.Rd&&la.update_boundings(p),ma.YG(p)&&(p.YA=!0)}za.MF(Na,a.textures,b.id);b.nb&&Na.q.Sm.length&&(b.Wu=!0);d=a.materials;if((S.pu||S.es)&&ja.cD)for(a=0;a<d.length;a++){k=d[a];m=k.texture_slots;for(f=0;f<m.length;f++)if(l=m[f],p=l.texture,"IMAGE"==p.type||"ENVIRONMENT_MAP"==p.type)h=p.image,h.Df||(-1<h.filepath.indexOf(".dds")?h.Df=
!0:(h.Df=!p.b4w_disable_compression&&!l.use_map_normal&&"ENVIRONMENT_MAP"!=p.type&&!p.b4w_shore_dist_map&&"MOVIE"!=h.source,h.Df?(h.en=ja.Pj,h.filepath="dds"==ja.Pj?h.filepath+".dds":ea.Ok(h.filepath)[0]+".pvr"):h.en=""));if(f=k.node_tree)for(k=f.nodes,f=0;f<k.length;f++)h=k[f],"TEXTURE"==h.type&&(m=h.texture)&&(h=m.image)&&!h.Df&&(h.Df=m.q.nl&&!m.b4w_disable_compression&&"MOVIE"!=h.source&&"ENVIRONMENT_MAP"!=m.type,h.Df?(h.en=ja.Pj,h.filepath="dds"==ja.Pj?h.filepath+".dds":ea.Ok(h.filepath)[0]+".pvr"):
h.en="")}else for(a=a.images,d=0;d<a.length;d++)f=a[d],f.Df=Boolean("FILE"==f.source&&-1<f.filepath.indexOf(".dds")&&".dds"==ja.Pj);e(b,c)}function F(a,b,c,d,e){d=a.groups;for(var f=a.objects,h={},g={},k={},l={},m=0;m<d.length;m++){var p=d[m];h[p.uuid]=p;k[p.uuid]=p}for(m=0;m<f.length;m++)p=f[m],g[p.uuid]=p,l[p.uuid]=p;a=a.scenes;for(m=0;m<a.length;m++)D(a[m].objects,null,l,k,null);for(var n in k)n in h||d.push(k[n]);for(n in l)n in g||f.push(l[n]);e(b,c)}function D(a,b,c,d,e){for(var f=[],h=0;h<
a.length;h++){var g=a[h],k=c[g.uuid];if(g=k.proxy){b&&-1==f.indexOf(g.uuid)&&f.push(g.uuid);for(var l=c[g.uuid],m=l.constraints,g=0;g<m.length;g++){var p=Ia.ih(m[g]);p.name+="_CLONE";k.constraints.push(p)}"b4w_proxy_inherit_anim"in k&&!k.b4w_proxy_inherit_anim||(k.animation_data&&(l.animation_data=Ia.ih(k.animation_data)),l.b4w_use_default_animation=k.b4w_use_default_animation,l.b4w_auto_skel_anim=k.b4w_auto_skel_anim,l.b4w_anim_behavior=k.b4w_anim_behavior,l.b4w_cyclic_animation=k.b4w_cyclic_animation)}}for(h=
0;h<f.length;h++)k=Ia.bK(a,f[h]),-1<k&&a.splice(k,1);f={};if(b)for(h=0;h<a.length;h++)g=a[h],k=c[g.uuid],m=Ia.ih(k),l="origin_name"in k?k.origin_name:k.name,m.name=ma.Kz(b.name,l),m.origin_name=l,m.dg_parent={uuid:b.uuid},y(m),c[m.uuid]=m,f[g.uuid]=m.uuid,g.uuid=m.uuid,e&&e[k.uuid]&&(m.b4w_cluster_data=e[k.uuid]);for(h=0;h<a.length;h++)g=a[h],k=c[g.uuid],k.dupli_group&&(g=k.dupli_group,e=d[g.uuid],m=Ia.ih(e),m.name=Ia.rp(e.name+"_CLONE"),m.uuid=ia.mA("Group"+m.name),d[m.uuid]=m,g.uuid=m.uuid,D(m.objects,
k,c,d,k.b4w_cluster_data));if(b)for(h=0;h<a.length;h++){g=a[h];k=c[g.uuid];k.parent&&k.parent.uuid in f?k.parent.uuid=f[k.parent.uuid]:k.parent&&(X.warn("Object's \""+k.name+'" parent is not in dupli group. Disabling parenting.'),k.parent=null);m=k.constraints;for(g=0;g<m.length;g++)b=m[g],b.target&&b.target.uuid in f&&(b.target.uuid=f[b.target.uuid]);if(b=k.pose)for(d=b.bones,g=0;g<d.length;g++)if(e=d[g].constraints)for(m=0;m<e.length;m++)b=e[m],b.target&&b.target.uuid in f&&(b.target.uuid=f[b.target.uuid]);
b=k.modifiers;for(g=0;g<b.length;g++)d=b[g],d.object&&d.object.uuid in f&&(d.object.uuid=f[d.object.uuid]);if((k=k.lod_levels)&&k.length)for(g=0;g<k.length;g++)b=k[g],b.object&&b.object.uuid in f&&(b.object.uuid=f[b.object.uuid])}for(var n in f)wa[n]=f[n]}function y(a){a.uuid=ia.mA("Object"+a.name)}function A(a,b){for(var c=a.nodes,d=0;d<c.length;d++){var e=c[d];"TEXTURE"==e.type&&e.texture&&H(e,"texture",b);"LAMP"==e.type&&e.lamp&&(e.lamp.uuid in wa&&(e.lamp.uuid=wa[e.lamp.uuid]),b[e.lamp.uuid]||
(e.lamp=null));"GROUP"==e.type&&e.node_group&&H(e,"node_group",b)}e=a.links;for(d=0;d<e.length;d++){var f=e[d];w(f,"from_node",c);w(f,"to_node",c);h(f,"from_socket",f.from_node.outputs);h(f,"to_socket",f.to_node.inputs)}if(c=a.animation_data)if(c.action&&H(c,"action",b),c.nla_tracks)for(d=0;d<c.nla_tracks.length;d++)for(e=c.nla_tracks[d],f=0;f<e.strips.length;f++)e.strips[f].action&&H(e.strips[f],"action",b)}function H(a,b,c){(c=c[a[b].uuid])||X.error("Dangling link found:",b,a);a[b]=c}function w(a,
b,c){c=Ia.keysearch("name",a[b].name,c);a[b]=c}function h(a,b,c){c=Ia.keysearch("identifier",a[b].identifier,c);a[b]=c}function u(a,b,d,e,f,h){e=ha(b.zg);for(var g=a.images,k={},l=[],m=0;m<g.length;m++){var n=g[m],u=n.uuid;if("FILE"===n.source||"MOVIE"===n.source){var r=p(n,a.textures);if(!r.length)X.warn("image ",n.name," has no users.");else if(!r[0].b4w_shore_dist_map){r=Ia.Jo(e+n.filepath);if("FILE"===n.source){var t=n.Df?ea.AT_ARRAYBUFFER:ea.AT_IMAGE_ELEMENT,v=ea.Ok(r),ba=v[1].toLowerCase();
if(!ea.XG(ba)){X.error("image ",n.name," has unsupported format.");continue}S.uv&&ja.use_min50&&("dds"==v[1]?(r=ea.Ok(v[0]),r=r[0]+".min50."+r[1]+".dds"):r=v[0]+".min50."+v[1])}else if("MOVIE"===n.source)if(ja.dp)v=ea.Ok(r),r=v[0]+".altconv.seq",t=ea.Cp;else{var v=ea.Ok(r),ba=v[1].toLowerCase(),z=Ga.detect_video_container(ba);if(""==z){X.error("failed to load video file (unsupported format)",r);continue}r=z!=ba?v[0]+".altconv."+z:v[0]+"."+v[1];t=ea.Dp}l.push({id:u,type:t,url:r});k[u]=n}}}if(l.length){var q=
0;ea.enqueue(l,function(e,f,g,m){if(e){f=k[f];if(g==ea.Dp||g==ea.Cp){if(g==ea.Dp)var n=e.videoWidth,u=e.videoHeight;else n=e.images[0].width,u=e.images[0].height;X.log("%cLOAD VIDEO "+n+"x"+u,"color: #"+(2048<n||2048<u?"a00":1024<n||1024<u?"aa0":"0a0"),m);-1==m.indexOf(pb)&&X.warn("video",m,"is not from app root.")}else c(e,m,!0,f.en);m=p(f,a.textures);for(n=0;n<m.length;n++){var u=m[n],r=u.image.filepath;g==ea.Cp?(u.q.bp=e.Pf,da.Ms(u.q,e.images,"",r,b.id)):da.Ms(u.q,e,f.en,r,b.id)}}e=++q/l.length;
h(b,d,e)},function(){X.log("%cLOADED ALL IMAGES","color: #0a0");f(b,d)})}else f(b,d)}function P(a,b,c,d,e){a=za.Ou();for(d=0;d<a.length;d++){var f=a[d];if(f.b4w_use_nla){var h=f.b4w_nla_cyclic;f.b4w_use_logic_editor&&(h=!1);Y.EO(f,h,b.id)}}e(b,c)}function p(a,b){for(var c=[],d=0;d<b.length;d++){var e=b[d];e.image===a&&c.push(e)}return c}function z(a,b,c,d,e,f){a=ha(b.zg);var h=[],g={};d=la.get_all_objects(b.id);for(var k=0;k<d.length;k++){var m=d[k];if(l(m)){var p=m.M.lj;"BACKGROUND_MUSIC"==Ga.Pu(m)?
(p=Ia.Fu(),b.Uu=!0):"NONE"!=Ga.Pu(m)&&ja.Yu&&(b.Xu=!0);if(!(p in g)){g[p]=[];var n=Ia.Jo(a+m.M.zg);switch(Ga.kC(m)){case Ga.et:var u=ea.AT_AUDIOBUFFER;break;case Ga.vx:u=ea.AT_AUDIO_ELEMENT}var da=ea.Ok(n),r=da[1].toLowerCase(),t=Ga.detect_audio_container(r);""!=t?(n=t!=r?da[0]+".altconv."+t:da[0]+"."+da[1],h.push({id:p,type:u,url:n})):X.error("failed to load audio file (unsupported format)",n)}g[p].push(m)}}if(h.length){var v=0;ea.enqueue(h,function(a,d,e,k){if(a)for(X.log("%cLOAD SOUND","color: #0aa",
k),-1==k.indexOf(pb)&&X.warn("sound",k,"is not from app root."),d=g[d],e=0;e<d.length;e++)Ga.IO(d[e],a);a=++v/h.length;f(b,c,a)},function(){X.log("%cLOADED ALL SOUNDS","color: #0aa");e(b,c)})}else e(b,c)}function l(a){return ma.is_speaker(a)&&Ga.kC(a)!=Ga.wx}function M(a,b,c){a=la.xb(a,"SPEAKER",b);for(b=0;b<a.length;b++){var d=a[b];ma.is_speaker(d)&&(Ga.BK(d)||c)&&Ga.play_def(d)}}function E(a,b){for(var c=a.q.Sm,d=0;d<c.length;d++){var e=c[d].q;a.b4w_use_nla&&c[d].b4w_nla_video||!c[d].use_auto_refresh||
b!=e.jg||(da.reset_video(e.name,b),da.play_video(e.name,b))}}function W(a,b,c,d,e){Y.start();X.log("%cSTART NLA","color: #0a0");e(b,c)}function G(a,b,c,d,e){if(b.lod_levels&&b.lod_levels.length)for(var f=b.lod_levels.length,h=0;h<f;h++){var g=b.lod_levels[h],k=g.object;if(k){var l=Ia.Fn(k);l.name=b.name+"_LOD_"+String(h+1);l.b4w_cluster_data=b.b4w_cluster_data;y(l);l.lod_levels=[];c&&(l.dg_parent=c);d.push([a,l]);e.push(k);g.object=l}}}function J(a,b,c,d,e){d=!0;for(var f=0;f<a.scenes.length;f++)if(!va.aH(a.scenes[f])){d=
!1;break}d&&(e(b,c),X.log("%cPHYSICS READY","color: #0a0"))}function Z(a,b,c,d,e){for(d=0;d<a.scenes.length;d++){var f=a.scenes[d];if(b.nb)var h=va.ms(f);else h=va.ms(Na)||va.ms(f),f=Na;if(Wa.enabled&&h)for(h=0;h<jb.length;h++)for(var g=la.xb(f,jb[h],b.id),k=0;k<g.length;k++){var l=g[k];l.k.sd==b.id&&(va.append_object(l,f),b.MA&&va.ha(l)&&va.disable_simulation(l))}}e(b,c)}function L(a,b,d,e,f){var h={};e=[];for(var g=a.scenes,k=0;k<a.scenes.length;k++){var l=g[k];if(l.q.oc&&(l=l.q.oc.bj)&&"FILE"===
l.source){var m=l.uuid,n=Ia.Jo(ha(b.zg)+l.filepath);e.push({id:m,type:l.Df?ea.AT_ARRAYBUFFER:ea.AT_IMAGE_ELEMENT,url:n});h[m]=l}}e.length?ea.enqueue(e,function(d,e,f,k){if(d){c(d,k,!0);e=h[e];k=p(e,a.textures);for(f=0;f<k.length;f++){var l=k[f],m=l.image.filepath,n="";e.Df&&(n=-1!=m.indexOf(".dds")?"dds":"pvr");da.Ms(l.q,d,n,m,b.id)}for(f=0;f<g.length;f++)if(k=g[f],k.q.oc&&(l=k.q.oc.bj,l===e)){var n=d,u=document.createElement("canvas"),l=e.size[0],m=e.size[1];u.width=l;u.height=m;u=u.getContext("2d");
u.drawImage(n,0,0);n=u.getImageData(0,0,l,m).data;u=new Float32Array(4);u[0]=1/16581375;u[1]=1/65025;u[2]=1/255;u[3]=1;for(var l=l*m,m=new Float32Array(l),r=0;r<l;r++)m[r]=u[1]*n[4*r+2]+u[2]*n[4*r+3];k.q.tw=m}}else for(e=h[e],f=0;f<g.length;f++)k=g[f],l=k.q.oc.bj,l===e&&(k.q.oc.bj=null,X.warn("image",l.filepath," was not found. Disabling water shore effects."))},function(){f(b,d)}):f(b,d)}function O(a,b,d,e,f){e=a.scenes[0];a=[];for(var h=[Ba.Lp,Ba.bn,Ba.Mp,Ba.rt],g=0;g<h.length;g++){var k=za.Da(e,
h[g]);k&&a.push(k)}if(a.length){e=[];g=ea.AT_IMAGE_ELEMENT;e.push({id:"SEARCH_TEXTURE",type:g,zg:pa.Md.smaa_search_texture_path});e.push({id:"AREA_TEXTURE",type:g,url:pa.Md.smaa_area_texture_path});for(g=0;g<a.length;g++)if(h=a[g],h.type==Ba.bn){a=h.Ja;for(g=0;g<a.length;g++)if(h=a[g],"u_search_tex"==h.to)var l=h.Na;else if("u_area_tex"==h.to)var m=h.Na;break}e.length?ea.enqueue(e,function(a,d,e,f){a&&(c(a,f,!1),d="SEARCH_TEXTURE"==d?l:m,d.source="IMAGE",d.dQ=!0,da.Ms(d,a,-1!=f.indexOf(".dds")?1:
0,f,b.id),da.ow(d,da.G,da.G))},function(){f(b,d)}):f(b,d)}else f(b,d)}function U(a,b,c,d){for(c=0;c<a.scenes.length;c++){var e=a.scenes[c];b.nb||(e=Na);for(var f=la.xb(e,"LAMP",b.id),h=0;h<f.length;h++){var g=f[h];g.k.sd==b.id&&d.yt.push({Ua:e,obj:g})}f=la.xb(e,"ALL",b.id);for(h=0;h<f.length;h++)g=f[h],"LAMP"!=g.type&&g.k.sd==b.id&&(b.MA&&ma.is_mesh(g)&&za.zn(g,!0),d.yt.push({Ua:e,obj:g}))}}function ga(a,b,c,d,e,f){var h=d.yt;e=d.fB;if(h.length){a=h[e].obj;var g=h[e].Ua;e=ma.ga(a,g);za.append_object(g,
a,!1);!a.anchor||g.q.ro||g.q.anaglyph_use||ra.append(a);d=++d.fB/h.length;h=e.lh;if(-1!=a.k.ce&&h){var k=Ra.copy(a.k.Aa.I,qb);za.VC(h,k)}h=a.Zo;if(h.length&&g.q.Mg)for(g=Ca.get_trans_view(a.k.n),a=Ca.get_quat_view(a.k.n),e=e.Kg,k=0;k<e.length;k++)za.XC(e[k],g,a),ma.YC(h,e[k].p.Nb)}else d=1;f(b,c,d)}function R(a,b,c,d,e){if(b.nb){d=za.jk();var f=za.Ou();for(a=0;a<f.length;a++)za.aM(f[a],d);za.set_active(d)}else za.ZC(Na);d=la.get_all_objects(b.id);la.AO(d);for(f=0;f<d.length;f++){var h=d[f];for(a=
0;a<h.D.length;a++)for(var g=h.D[a].U,k=0;k<g.length;k++)null==g[k].Qa&&g.splice(k--,1)}e(b,c)}function ca(a,b,c,d,e){if(b.nb)for(a=za.Ou(),d=0;d<a.length;d++){var f=a[d];f.b4w_use_logic_editor&&aa.xK(f,b.id)}e(b,c)}function Q(a,b,c,d,e){if(b.nb)for(d=0;d<a.scenes.length;d++)E(a.scenes[d],b.id),M(a.scenes[d],b.id,!1);else E(Na,b.id),M(Na,b.id,!1);e(b,c)}function ta(a,b,c,d,e){for(d=0;d<a.scenes.length;d++)a.scenes[d].camera=null;ja.media_auto_activation&&(b.Wu||b.Uu||b.Xu)?La||K(a,e,b,c):e(b,c)}function K(a,
b,c,d){function e(){if(!g){g=!0;c.Wu&&(da.play(),da.pause(),da.reset());if(c.Uu){if(c.nb)for(var f=0;f<a.scenes.length;f++)M(a.scenes[f],c.id,!0);else M(Na,c.id,!0);Ga.pause()}c.Xu&&Ga.sB();N();b(c,d)}}var f=Pa.parentElement;bb=f.style.zIndex;f.style.zIndex="999";La=document.createElement("div");La.style.position="relative";La.style.height="88px";La.style.width="88px";var h=Math.round(Pa.offsetWidth/2-44);La.style.top=Math.round(Pa.offsetHeight/2-44).toString()+"px";La.style.left=h.toString()+"px";
La.style.backgroundImage="url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALAAAACwCAYAAACvt+ReAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAbrwAAG68BXhqRHAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAABVDSURBVHic7Z15kF1Vncc/v05Ys7JIQJZ0GLaAgCzCQARGFMIwZKTiqCPBAbTEEodBhYKALJKSVWYsCpTBcgCLAdQBHWZACCCyhCElIRiWEMOSBZAkCglJOoTQyW/++J3Xfe95971+273v3fvOp6qr+5573+vT3d8+93vP+Z3fTwjUhKoKsC0wLvKxDTA68rEVMNK9ZDiwpft6PdDvvl4LvA+sBt5zn1cCy4EVwDJgpYhouj9RMZB2d6ATUdWtgD2BXvcxARgPbJ5RFzYAS4BFwGL38YqIvJ/R988NQcCAqm4LHADsA+yLibannX1KYBMm6JeBBcA8EVnZ3i61n64UsKoOAyYCh7iPCeTvd6HA68BcYA6wQEQ2trdL2ZO3P1rDqGoPsD9wNHAkMKqBt1nNoFctfV7j2ldj/rbPXdsvIuvd994S88QAIzCfHPXOHyHurRvt21PALOAFEdnUwHvkjsILWFV7gcnAUcDYWl8GvAEsZNCDLhKR91rfw4RvrjoWuyv0us97ALtS+99rFfAEMFNElqTRx06hkAJ2I94ngRMwXzsUmzCxzsP85csisja9HtaPqo7CbM9EzK/vRW1/vwXATODJ0h2hSBRKwO5hbAom3KFuw2uAZzD/+JyIrEm5ey1FVUcDB2Ee/hPU9vM+ANwnIu+m3L3MKISAVXU3YCrwNwx6zSTWArOBJ7Gn+P4q1+YGVR0OfByzSX+N+exKfAg8DtwtIm9m0L1UybWAVfWjwJcw4Vb6WRT4A3YbnV0U0VZCVTfDRDwZOJDKv5dNwGPAXSLydja9az25FLCqbg9MA44FhlW4bDXwIPYgszyrvnUSqrojJuRqlqof+C1wp4i8k1XfWkWuBKyqmwN/D3wRW7ZN4m3gfzHhfpBV3zoZNyofBXwem81I4gPgHsxabMiqb82SGwGr6lHAV7A50yQWA3cCT4c4gmRcPMeRwCnY0ngSK4BbRGRWZh1rgo4XsJtZOAvzdUm8CfwSeKxbJu+bxQl5EnAqsEuFy+YAPxKRP2fWsQboWAG7X/JJwGkMRnVFWQXcDjwchNsYbnVyMibkMQmXvA/8DLi/U+9qHSlg95B2HvCxhNP9wG+AO0SkL+F8oE7cws9UzCNvlnDJAuA6EVmWacdqoOMErKpHA98keS7zReAGEXkr2151B6q6C3A2sF/C6bWYpXgy215Vp2MErKpbYMI9NuF0H3ArNrPQkbeyouCs2wnA6SQPIo8AN3XKDE9HCFhVdwK+iwWv+DwLXF+k5c88oKrbAecAByecfh24shMsRdsFrKqHYn53pHdqAzYtdk8YdduDG40nA18DtvBOrwP+TURmZ96xCG0VsKp+DrtV+f1YDFwrIkuz7lOgHBeSej6wm38KmzP+deadcrRFwG765kxsmszncexBrXChf3nGzVScg63o+cwEftyOHSGZC9htmLwAONQ71Y/9N/9P1n0K1I6qngycQXkMyjPANVkPPJkKWFVHApcDe3un1mIPBc9n2Z9AY6jqgcBFlM9SLAAuy3J+PjMBu20yM4DdvVPLge+JyBtZ9SXQPC4G+zJsD1+U14BLs9p+lYmAXTzDFZRHQi0EZojIqiz6EWgtqroNcCmWQyPKUuDiLKY+Uxewqo4BrqL8CfZF4PKQrCPfuIe7S7Dg+ShvARekPTilKmBVHYGNvHt4p54FrshT3GmgMm4V9SJsf16URcBFae43TE3Abrbh+5Q/sM0Gri761p5uwwXNTwcO904twOxEKrMTqaRPcvO851Eu3uewqZYg3oIhIh9iVnGOd2ofYLrLhtRy0sr/dSbl/4nzMdvwYUrfM9Bm3MB0JfCCd+pQbFNCy2m5gN3ysL/CthCbWgmrawXHPdfMAF7xTk12iyAtpaUCVtXDsNiGKMuxqbIg3i7BzSzNwPbXRfmqC95qGS0TsKqOA75N/MGwjzDP25W41K+XYausA83AeS58tiW0RMCRucBo7oF+zPMWOrlcoDJudfUqIBrkMxK40KVIaJpWjcBnUR6MfkuIbQiIyDzgNq95d+AbrXj/pgWsqpMo3wb0eIgqC5Rw8cL+Xrrj3P7HpmhKwKr6EeBfvOYlwA3NvG+gkFyPxUhEOcvtQG+YhgXstpucSzykbgO2kyLMOARiOE1ci2XHLDES+I7TUkM0MwJPoTxvw63hoS1QCRFZjCVKiXIAcGKj79mQgJ11+LLX/BxwX6MdCXQN92K7N6Kc1qiVaHQE/ibx7JB9wA/D7uHAUDiN3MhgMRyArWlwqbluAbsskf5qyq0hb0OgVlwe4tu85sPcjFZd1CVgN/l8htf8IrYrNRCohwexAK8oX3OxxTVT7wg8FdghctyPbYEP1iFQF04zNzBYQxpge+Cz9bxPzQJ2qYb+wWu+NyTaCzSKW2q+32v+gttDWRP1jMDTiOfpXYUllg4EmuFOrJ5JiS2xDPI1UZOAXTWgT3vNt4f8vIFmcRq63Wv+jCtQMyS1jsCnEM/E8haWZjO3qOrDqrp/u/sRAGwSIFqzbjjwj7W8cEgBuwQWftDFfxagMvpngLmqerNbmAm0CVci4ude87GquvNQr61lBP6cd90SrCJ6ERiO7d/7o6pe0KoY1UBDPI5lJS3Rg2mvKlUF7J4Gj/Ga7yjgtNk2wNXAC6r6+XZ3phtxmvqF1/wpl/2nIkONwFOI1x7+E/B0/d3LDXsBvwz+uG08hRWqLLEZySl4B6goYLdN6ASv+b8LOPomEfxxG3Be+F6v+cRqq3PVRuCjie9xWwM82nj3ckfwx+3hYeLzwqNITqoNVBfw8d7xg10aqB78cYa46kd+bM3kStcnCtjVRNgn2gQ81Gznck7wx9kxE9NciYluOreMSiOwr/g/iMjbiVd2H8Efp4wr3+XvaPcdAZAgYJeYz/ccIVwyTvDH6ePf8Y9x2oyRNALvD4yNHPdhKVED5QR/nB5PY7XoSmwD7OtflCRgf9n4/0I61CEJ/rjFuCSB/sBZNhsRE7DL4XqEd01Rlo2zIPjj1uJrb5JvI/wReCIwOnK8GpiXQseKTPDHrWMutv5QYix2txvAF7Bf42BOsA8NE/xxkzjtzfWaYxr1BezvNvbTxQfqJ/jj5njWO45pdEDALuqnN3JuE5asJNAagj9ujGeJL2rs4YpmAvER+EDiyakXplkeqUsJ/rhOXMXP16JNRFKaRQU80XtteHhLj+CP68PX4sB8cE9So+Pl1LoTKBH8cW34WowL2BUlHB+5QIE/pt+vgCP44+rMJ+6DJ7h49YEReE/io/Ebwf9mTvDHFRCR1dhO+BLDcOWLS6Lt9V7j1/gKZEfwx8ks9I4nwKCAd/dOLkq9O4GhCP44jp84vRcqj8BBwJ1D8MeGr8legB5Xn8CPdg9lAjqL4I/jOSMAxquq9ADbAtFfyJpQWbNj6Vp/7BKoR3PxbQmM7QHGedcuy6xXgUbpVn+83DselyRg/6JA59Jt/tjX5g5BwPmnm/xx4gjs5576S0adCbSWbvDHK7zj7XqI78AAy7weyC9F9serveNRSQIOS8jFoIj+2Bfw6CDgYlM0f+xrc3QPVnC52kWB/FMUf+yPwCN7sBysUT7IqDOB7Mm7P97gHW+eJOCwC7n45NUff+gdb5YkYP+iQDHJoz9OFPBwrzGMwN1FnvxxooADgRLvt7sD9dJD+Yjrj8iBYrMSmA7sLyL3tbszQ1Bmd4djw/Lm3kX+016gePQDtwAXi8if292ZGqko4ChhBC4+jwDfFpEX292ROqlJwBVLGgVyz0Lg3BxYhUr4MyUbeihfeRtFoGjkyedWoyzsYTgJ68sZdSaQPnn0udVIFHBZhE9GnQmkS159bjV8bb4XBFw88u5zq+Hb27XDMX8UZfuMOhNoLSuBa4AfugIpRWQH7/id4ZTvM9oxo84EWkPRfG41fG0uTxKwr/JA51JEn1sNX5uJAg4jcOdTZJ9bjbId9D3Au8SD2EdFaxAEOoqizOfWjapuC4yINL0PvNcjIgos9a7vzapjgZroB34C7C0i1xT4Ia0aE7zjJSIyUPUwMfNfoCN4BDhIRL7eBQ9p1ej1jhfBYODOYu+kr/ZA9nSrz63EeO94CQwK2B+B90y9O4FKdMN8biPs5R0vhkEBvwJsxGoPAOyqqqNCnYxM6ab53LpQ1dHAzpGmjcCr4DK0i8h64jZCgH0y6l8g+Nyh2Jd4Ec7XnWZjlYkq1uIKpMZCYIqIHNdFixGN4GvxpdIX1QScx8QXeaFr53Mb5EDveECr0e1Dz2PF5EpD9d6qOsbVqg20huBz60RVxxCvoqUkjcAishJ4PXKhAB9Pu4NdRPC5jXEIcf/7SrSGi58XYm7CiwPNEXxuc/ganBM98AU8xzs+TFXDLuXGCD63SZz2fAHHBllfwAuI79AYSbAR9RLiFlrHwcTT/67CKzkbE7CIbASe8t7kk6l0rZgEn9tajvaOZ4nIpmhDUm60Wd7xEarqJ5QIxAk+t8W4bJmHec2+NhMF/DwWI1xiBHB467pWKILPTY8jga0jx+8SmT4rUSZgFx/sK/2ElnYt/wSfmz7HecdPOG3GqJRedaZ3fKCq7tSSbuWf4HNTRlV3BA7wmh9KujZRwCKyBJuRGGgCjm9J7/JL8LnZMZn44sV8EfF3DQGVR2AoH4VPUNUtm+1ZDgk+N0NUdQvKLauvxQGqCfgJ4nnTRgHHNt613BF8bns4jngGnjUkzD6UqChgEfkA+I3XPFVVu6EsQfC5bcBp67Ne831Oi4kMJcb7iecP3hE4orHu5YLgc9vLJCA6WbAB02BFqgpYRN4FHveap6mqJF2fY4LPbTNu9D3Fa340GnmWRC124G4guny3G+VLfHkl+NzO4Rhg18jxRuBXQ71oSAGLyJvAY17zNFUdlnB5nngAOCD43PbjRt8ves2/E5E/DfXaWh/I7iJejuuj5HxeWEROFBF/G1WgPZwI7BI57gd+XssLaxKwiLwN/NZrPlVVRyRdHwjUiqqOBKZ5zQ+LyLJaXl/PlNidwPrI8RjgS3W8PhBIYhrxed/12B2/JmoWsIi8gz3QRTlJVXdJuj4QGApV3Q34W6/5F272qybqXZT4FfF8wsOBbxVwWi2QMk4z/0x8Z/wy4N563qcuAbtpplu95n0I4ZaB+jmR8oQlP613KrPuZWERmQX83ms+XVW3q/e9At2Jqm4PnOY1zxaR2fW+V6NxDTcCfZHjEQQrEaiBiHWI7rZYB/x7I+/XkICdyb7daz4ImNLI+wW6ipOBQ72220TkL428WTORZfcDL3htp6tqbxPvGSgwqro78E9e8zxsVbQhGhaw25/0r8DaSPPmwPldGvgeqIKqbgWcD0R3uK/BEnmX7XWrlaZie92wf4PXvBtwbvDDgRJOC+cQXy4G+HGj1qFE08HpIvIUFgAe5QjKA5MD3ctUyhPkzBSRJ5t941btrriJeGZLgDNU1c/rGugyVPUgyn3vq8DNrXj/lgjYbfn4PvG8asOA74aHuu7FLRVPZ7D2CpjvvapVsdct298mIiuAHxAPft8auERVt2nV9wnkA1dZ83vEq2sqcJ2I+OWNG6alGzRF5DnKl5rHAZe6p9BAF6CqWwOXUV6c+6ci8mwrv1fLdxiLyK8Bf1/ZnsCMML1WfFxeh0uBv/JOPSgidQXq1EJaW+R/Avjr2hOBi13WwUABcQmpLwQ+5p2agz3ot5xUBOxyuF5HPD0VWLLsC0K61uLh/qYXUb5MPB+42uWebjmpLja4LUdXAHt4p54HZpSK1QXyjbMNF2PxMFEWAReKyNryV7WG1FfLXJnQq7EVuigvAZeLyLq0+xBID/dccwnltdzeBKYPldehWVJPEyUiq7H/Tj+74H7AFWGKLb+4qbJrKBfvUuCitMULGYzAJdzu0xmUVx1/BxuJ/ZW8QAfjFim+R/lU2WvApVkVyMw04MZ54sspLyTeB1wpIvOy7E+gMdzy8HTiixRgD2yXi0hf+avSIfOIMeeZLgA+4Z3aiC2C3NtMeF0gPVxU2VQstsHPzPR74NqsH8zbEvLoUgmdCZyUcHo2FiOa2X9xYGjcwPMtksuuPQjclNZUWTXaGrOrqicDX03ox1Lsv3lx5p0KlOF2UpxPeTzvJuA/0lhhq5W2B52r6gHYL2esd+pD4A7gnmAp2oOzDFOAM4jvpACLKvuBiPj1tTOl7QIGUNVx2CqOv34OVhv3epcZKJARbuv7OZQvToDNNFzZyqiyRukIAcNAZcZvUF4fDGyW4mfAA2E0Thc36v4d9qC2dcIlM4GbOyWXcscIuISqTgLOJl7kucR84AYReSPbXnUHbm73bCzwymcNcKPbQtYxdJyAYeD29R3Ki92B5Y69D7grzFS0BrfIdAqW7ml4wiXzsJmhpjZgpkFHChhqupWtxpKrPNSO6Zsi4LLsnwCcSjzFaYl1wG10sHXrWAGXcOvtX8cq2CSxHPgvTMibKlwTiOAGh0nAl4GdK1z2DPCjThx1o3S8gEs4b/wVbItSEkuxxMizOnW0aDduAWkSZhd2rXDZMmxu9+nMOtYEuREwDET8n4jd8pJsBdiIfC82Iod4YwaCzY8CvkD5YkSJ9Vj+57s7ZYahFnIl4BLOVkwDPk3yQwfYU/ODmJDfzqpvnYSq7oQVzp5MsscFeyh+GHsorjkzeqeQSwGXUNUdsTodn6JybLNiO0BmYjloczO6NIKbTz8SqyK1P5X/xhuB32HCbfuCRKPkWsAlXJ2OqZiQq+23W4cFC80C5opIf5Vrc4OzCAdhNuFwKtsrsCX6R7El+iHrsHU6hRBwCbe74yTMJ1e6ZZbow56052JiTn33QCtR1bHAwcAh2EbKoUqercFS4t6Xt5+1GoUScAm3yfAo7Dbq12FIfAmWr+t5bLXvZbcVqmNQ1THYCtm+2Bae3ant7zcfeAh4slrV97xSSAFHccujx2P1nbet9WXAW1j1+iVY4sIlWT3kuHoj44EJQC+WGKaecmbvAk9gGSALvexeeAGXcJP3+2Ej8yTKwzdroQ+bJ12BTdetwFYE10Q+r8PiZPtL03guGHw49qC5NWZvRkc+74DNb5c+GqmAugrz9rOAl7plLrxrBBzFTejvhXnHQ7C8FXn7XSjwCvCs+1jYjSuRefujpYLzl/tj/nIi5i/9PV/tZiNmZV7Gcmq8mNXO304mCDgBd8vfA/OfvZgXHQ9klZxwPbAY89+L3NevhpXFcoKA68BN05V86g7Adgz62NGYd90KG72Hua8B3sdG0H5MnH2YZy755ncY9NTLijTNlTb/Dz+sKh/f1rAbAAAAAElFTkSuQmCC')";
La.style.backgroundSize="88px";Ta=document.createElement("div");Ta.style.position="relative";Ta.style.height=Pa.offsetHeight.toString()+"px";Ta.style.width=Pa.offsetWidth.toString()+"px";Ta.style.background="rgba(0, 0, 0, 0.5)";Ta.style.zIndex="999";f.appendChild(Ta);Ta.appendChild(La);La.addEventListener("touchstart",e,!1);La.addEventListener("click",e,!1);var g=!1}function N(){if(La){var a=Pa.parentElement;a.style.zIndex=bb;Ta.removeChild(La);a.removeChild(Ta);La=Ta=null;bb=0}}function ha(a){(a=
a.split("/").slice(0,-1).join("/"))&&(a+="/");return a}function qa(a){sa.is_animated(a)&&sa.remove(a);T.hM(a);la.clear_outline_anim(a);I.check_sensor_manifold(a)&&I.remove_sensor_manifold(a);va.ha(a)&&va.remove_object(a);za.iM(a);ma.is_speaker(a)&&Ga.CN(a);ra.is_anchor(a)&&ra.remove(a)}function na(a){var b=sa.Rz(a);return(a=b&&b.parent==a?null:a.parent||b)?1+na(a):0}var ra=q("__anchors"),sa=q("__animation"),ea=q("__assets"),oa=q("__batch"),pa=q("__config"),I=q("__controls"),Ea=q("__texcomp"),ka=q("__debug"),
Aa=q("__extensions"),V=q("__input"),ua=q("__loader"),ia=q("__md5"),Y=q("__nla"),aa=q("__logic_nodes"),T=q("__particles"),xa=q("__nodemat"),la=q("__objects"),ma=q("__obj_util"),va=q("__physics"),X=q("__print"),ya=q("__quat"),Fa=q("__reformer"),Ha=q("__renderer"),za=q("__scenes"),Ga=q("__sfx"),Sa=q("__shaders"),Ba=q("__subscene"),da=q("__textures"),ba=q("__time"),Oa=q("__transform"),Ca=q("__tsr"),Ia=q("__util"),Ra=q("__vec3"),fa=q("__vec4"),Nb=pa.xj,ja=pa.v,S=pa.Gd,Wa=pa.B,Da=pa.M,Ja=null,Ka=null,pb=
"",Na=null,wa={},qb=new Float32Array(3),Bb=new Float32Array(4),Qa=new Float32Array(4),gb=new Float32Array(4),La=null,Ta=null,bb=0,Ub=!1,ic=["LAMP","CAMERA"],jb=["MESH","CAMERA","EMPTY"],Pa=null;a.is_primary_loaded=function(a){return ua.is_primary_loaded(a)};a.update=function(){ua.FO(Ja)};a.mN=function(a){Pa=a};a.xO=function(a,b){if(La){Ta.style.height=b.toString()+"px";Ta.style.width=a.toString()+"px";var c=Math.round(a/2-44);La.style.top=Math.round(b/2-44).toString()+"px";La.style.left=c.toString()+
"px"}};a.load=function(a,c,d,h,g){var k={load_main:{Hb:ua.rj,Pb:!1,K:[],Tb:!1,Ub:500,mc:!1,Yb:b},duplicate_objects:{Hb:ua.Ed,Pb:!1,K:["load_main"],Tb:!1,Ub:50,mc:!1,Yb:F},load_binaries:{Hb:ua.rj,Pb:!1,K:["load_main"],Tb:!1,Ub:500,mc:!1,Yb:n},wait_for_shaders:{Hb:ua.Ed,Pb:!1,K:[],Tb:!1,Ub:50,mc:!0,ki:f},prepare_bindata:{Hb:ua.Ed,Pb:!1,K:["duplicate_objects","load_binaries"],Tb:!1,Ub:100,mc:!1,Yb:t},prepare_bpy_data:{Hb:ua.Ed,Pb:!1,K:["duplicate_objects","prepare_bindata"],Tb:!1,Ub:100,mc:!1,Yb:v},
process_objects:{Hb:ua.Ed,Pb:!1,K:["prepare_bpy_data"],Tb:!1,Ub:150,mc:!1,Yb:C},process_scenes:{Hb:ua.Ed,Pb:!1,K:["process_objects","wait_for_shaders"],Tb:!1,Ub:300,mc:!1,Yb:B},load_smaa_textures:{Hb:ua.rj,Pb:!1,K:["process_scenes"],Tb:!1,Ub:30,mc:!0,Yb:O},load_shoremap:{Hb:ua.rj,Pb:!1,K:["process_scenes"],Tb:!1,Ub:30,mc:!0,Yb:L},load_textures:{Hb:ua.rj,Pb:!0,K:["process_scenes"],Tb:!0,Ub:500,mc:!1,Yb:u},update_scenes_nla:{Hb:ua.Ed,Pb:!1,K:["process_scenes","load_textures"],Tb:!1,Ub:50,mc:!1,Yb:P},
wait_physics_workers:{Hb:ua.Ed,Pb:!1,K:["load_shoremap"],Tb:!1,Ub:20,mc:!1,ki:J},add_physics_objects:{Hb:ua.Ed,Pb:!1,K:["wait_physics_workers"],Tb:!1,Ub:50,mc:!1,Yb:Z},add_objects:{Hb:ua.Ed,Pb:!1,K:["add_physics_objects"],Tb:!1,Ub:600,mc:!1,Yb:U,ki:ga,xn:R,yn:{yt:[],fB:0}},init_logic_nodes:{Hb:ua.Ed,Pb:!1,K:["update_scenes_nla","add_objects"],Tb:!1,Ub:50,mc:!1,Yb:ca},load_speakers:{Hb:ua.rj,Pb:!0,K:["add_objects"],Tb:!0,Ub:100,mc:!1,Yb:z},mobile_media_start:{Hb:ua.Ed,Pb:!1,K:["load_textures","update_scenes_nla",
"load_speakers","init_logic_nodes"],Tb:!0,Ub:5,mc:!1,Yb:ta,ki:ta},synchronize_media:{Hb:ua.Ed,Pb:!0,K:["mobile_media_start"],Tb:!0,Ub:50,mc:!1,Yb:Q},start_nla:{Hb:ua.Ed,Pb:!0,K:["mobile_media_start"],Tb:!1,Ub:5,mc:!0,Yb:W}},l=ua.bA();l||(l=ua.OH(),Ja={},Ka={},wa={});Ja[l.Tg.length]={};return ua.sI(k,a,c,d,e,h||Da.ey,ja.do_not_load_resources,g)};a.unload=function(a){var b=ua.bA();if(!b||!b.Tg.length||a&&!ua.XN(b.Tg[a]))X.error("Unable to unload data!");else{if(0==a)X.log("%cUNLOAD ALL","color: #00a"),
ra.cleanup(),sa.cleanup(),Ga.cleanup(),Y.cleanup(),oa.cleanup(),za.cleanup(),ua.cleanup(),I.cleanup(),va.cleanup(),la.cleanup(),Ia.cleanup(),Ha.cleanup(),xa.cleanup(),Sa.cleanup(),Aa.cleanup(),ea.cleanup(),da.cleanup(),aa.cleanup(),T.cleanup(),V.cleanup(),ka.cleanup(),Ka=null,wa={},Ja=Na=null,Ub=!1;else{X.log("%cUNLOAD DATA "+a,"color: #00a");sa.fM(a);for(var b=la.get_all_objects(la.DATA_ID_ALL),c=0;c<b.length;c++){var d=b[c];ma.get_object_data_id(d)!=a&&la.Qr(d,!1,!1,!1,!1)}b=la.get_all_objects(a);
for(c=b.length-1;0<=c;c--)d=b[c],qa(d),la.remove_object(d);b=la.get_all_objects(la.DATA_ID_ALL);for(c=0;c<b.length;c++)la.Qr(b[c],!0,!0,!0,!0)}N()}};a.$L=qa;a.set_debug_resources_root=function(a){pb=a};a.activate_media=function(){Ub||ja.media_auto_activation||(da.play(),da.pause(),da.reset(),M(Na,la.DATA_ID_ALL,!0),Ga.pause(),ja.Yu&&Ga.sB(),Ub=!0)};a.reset=function(){Pa=null}};b4w.module.__batch=function(a,q){function e(a){a={type:a,ub:"",id:0,$o:0,Jj:-1,Li:"",vq:-1,zl:-1,Rn:0,Ie:0,Uj:[],T:[],Uc:[],cc:[],Oj:[],Uh:null,zc:{},Qa:null,qb:{Wg:null,kf:null,qi:[],Vf:[],status:ka.ut,oJ:0,eP:0,dy:0,GC:0},Ki:"",on:[],ja:null,Sd:Y.pi(),Rd:!1,nh:!1,wq:!1,num_vertices:0,num_triangles:0,sr:0,ur:0,Uq:0,po:0,wd:new Float32Array(3),Id:new Float32Array(16),Ef:!1,mb:!1,Yt:!1,Ha:!1,lg:!1,Ab:!1,Qd:!1,fe:!1,pd:!1,fd:!1,Tc:!1,Qc:!1,Gc:!1,dd:!1,jc:!1,cs:!1,Lf:ia.Ym,bf:!1,jf:!1,Wv:"",bC:"",$q:!1,
dr:0,ar:0,er:0,fr:0,cr:new Float32Array(3),br:new Float32Array(3),qo:!1,Ff:0,Mf:0,wg:1,reflect_factor:0,Mh:0,kp:1,parallax_scale:0,vg:0,og:1,Or:0,Ho:0,sf:0,ks:0,Jd:Array(2),Bd:new Float32Array(3),Rg:new Float32Array(3),zf:new Float32Array(3),Zc:new Float32Array(4),Me:new Float32Array(4),Di:null,Wl:null,Co:null,Bo:null,Do:null,wi:!1,wireframe_edge_color:aa.create(),Xg:!1,water_dynamic:!1,Um:!1,Ys:!1,Zs:0,$s:0,Xs:0,pj:.1,shallow_water_col_fac:0,shore_water_col_fac:0,foam_factor:0,Lq:new Float32Array(2),
Kq:new Float32Array(2),eo:new Float32Array(2),shallow_water_col:new Float32Array(3),shore_water_col:new Float32Array(3),Dh:null,Wi:!1,Ma:null,Zl:0,vj:null,Gk:!1,Po:null,Ch:null,Xf:null,$A:null,Ld:null,Wf:null,aB:null,J:null,Y:null,da:null,Aa:null,va:null,Z:null,Bf:!1,md:!0,ss:!1};a.Zc[3]=1;a.Yt=!0;a.Ha=!0;a.Zl=1;return a}function c(a){var b=e(a.type);b.ub=a.ub;b.id=a.id;b.$o=a.$o;b.Jj=a.Jj;b.Li=a.Li;b.vq=a.vq;b.zl=a.zl;b.Rn=a.Rn;b.Ie=a.Ie;b.Uj=[];b.T=a.T.slice();b.Uc=a.Uc.slice();b.cc=a.cc.slice();
b.Oj=a.Oj.slice();b.Uh=Y.L(a.Uh);b.zc=Y.L(a.zc);b.Qa=a.Qa;b.qb=Y.L(a.qb);b.Ki=a.Ki;b.on=I.jH(a.on);b.ja=a.ja;b.Rd=a.Rd;b.nh=a.nh;b.wq=a.wq;b.num_vertices=a.num_vertices;b.num_triangles=a.num_triangles;b.sr=a.sr;b.ur=a.ur;b.Uq=a.Uq;b.po=a.po;b.wd=a.wd;b.Id=a.Id;b.Ef=a.Ef;b.mb=a.mb;b.Yt=a.Yt;b.Ha=a.Ha;b.lg=a.lg;b.Ab=a.Ab;b.Qd=a.Qd;b.fe=a.fe;b.pd=a.pd;b.fd=a.fd;b.Tc=a.Tc;b.Qc=a.Qc;b.Gc=a.Gc;b.dd=a.dd;b.jc=a.jc;b.cs=a.cs;b.Lf=a.Lf;b.bf=a.bf;b.jf=a.jf;b.Wv=a.Wv;b.bC=a.bC;b.$q=a.$q;b.dr=a.dr;b.ar=a.ar;
b.er=a.er;b.fr=a.fr;aa.copy(a.cr,b.cr);aa.copy(a.br,b.br);b.qo=a.qo;b.Ff=a.Ff;b.Mf=a.Mf;b.wg=a.wg;b.reflect_factor=a.reflect_factor;b.Mh=a.Mh;b.kp=a.kp;b.parallax_scale=a.parallax_scale;b.vg=a.vg;b.og=a.og;b.Or=a.Or;b.Ho=a.Ho;b.sf=a.sf;b.ks=a.ks;b.Jd=a.Jd.slice();aa.copy(a.Bd,b.Bd);aa.copy(a.Rg,b.Rg);aa.copy(a.zf,b.zf);T.copy(a.Zc,b.Zc);T.copy(a.Me,b.Me);b.Di=Y.L(a.Di);a.Wl&&(b.Wl=new Float32Array(a.Wl),b.Co=new Float32Array(a.Co),b.Bo=new Float32Array(a.Bo),b.Do=new Float32Array(a.Do));b.wi=a.wi;
aa.copy(a.wireframe_edge_color,b.wireframe_edge_color);b.Xg=a.Xg;b.water_dynamic=a.water_dynamic;b.Um=a.Um;b.Ys=a.Ys;b.Zs=a.Zs;b.$s=a.$s;b.Xs=a.Xs;b.pj=a.pj;b.shallow_water_col_fac=a.shallow_water_col_fac;b.shore_water_col_fac=a.shore_water_col_fac;b.foam_factor=a.foam_factor;b.Lq.set(a.Lq);b.Kq.set(a.Kq);b.eo.set(a.eo);aa.copy(a.shallow_water_col,b.shallow_water_col);aa.copy(a.shore_water_col,b.shore_water_col);b.Dh=Y.L(a.Dh);b.Wi=a.Wi;b.Ma=Y.L(a.Ma);b.Zl=a.Zl;a.vj&&(b.vj=new Float32Array(a.vj));
b.Gk=a.Gk;b.Po=Y.L(a.Po);b.Ch=Y.L(a.Ch);b.Xf=Y.L(a.Xf);b.$A=Y.L(a.$A);b.Ld=Y.L(a.Ld);b.Wf=Y.L(a.Wf);b.aB=Y.L(a.aB);b.J=Q.tl(a.J);b.Y=Q.tl(a.Y);b.Z=Q.En(a.Z);b.va=Q.En(a.va);b.da=Q.Ij(a.da);b.Aa=Q.Ij(a.Aa);b.Bf=a.Bf;b.md=a.md;b.ss=a.ss;return b}function b(a){switch(a.type){case "MAIN":case "PARTICLES":case "LINE":a.ub=a.mb?a.lg?"XRAY":"BLEND":"OPAQUE";break;case "SHADOW":a.ub=a.fd?"CAST":"RECEIVE";break;case "COLOR_ID":a.ub=a.lg?"COLOR_ID_XRAY":"COLOR_ID"}}function n(a,b){for(var c=[],d=0;d<a.length;d++){var e=
a[d],f=e.Ga.k,h=Q.Mc();Q.ni(f.fi,h);var k=e.data.b4w_bounding_cylinder_radius,l=e.data.b4w_bounding_sphere_radius,m=e.data.b4w_bounding_sphere_center,p=e.data.b4w_bounding_ellipsoid_axes,n=e.data.b4w_bounding_ellipsoid_center;if(f.Fe){var k=Math.max(Math.abs(h.max_x),Math.abs(h.min_x)),l=Math.max(Math.abs(h.max_y),Math.abs(h.min_y)),u=Math.max(Math.abs(h.max_z),Math.abs(h.min_z)),u=Math.sqrt(k*k+l*l+u*u),k=Math.sqrt(k*k+l*l);h.max_x=h.max_y=h.max_z=u;h.min_x=h.min_y=h.min_z=-u;l=u;m[0]=m[1]=m[2]=
0;p[0]=p[1]=p[2]=u;n[0]=n[1]=n[2]=0}Q.ji(h,f.n,f.Y);g(f,k,k,h);m=Q.gq(l,Y.f32(m));Q.sl(m,f.n,f.Aa);p=Q.sn([p[0],0,0],[0,p[1],0],[0,0,p[2]],n);Q.rl(p,f.n,f.va);f.J=h;f.da=m;f.Z=p;c.push.apply(c,t(e,f,b))}return c}function f(a,b){for(var c=[],d=[],e={},f=0;f<a.length;f++){var h=a[f],g=h.Ga.k,k=Q.Mc();Q.ni(g.fi,k);var l=Q.ji(k,g.n),m=Q.gq(h.data.b4w_bounding_sphere_radius,Y.f32(h.data.b4w_bounding_sphere_center)),p=Q.sl(m,g.n),n=h.data.b4w_bounding_ellipsoid_axes,n=Q.sn([n[0],0,0],[0,n[1],0],[0,0,n[2]],
h.data.b4w_bounding_ellipsoid_center),r=Q.rl(n,g.n);g.J=k;g.Y=l;g.da=m;g.Aa=p;g.Z=n;g.va=r;k={};k.pd=g.pd;k.fd=g.fd;k.Tc=g.Tc;k.Ng=g.Ng;k.km=g.km;k.ec=g.ec;k.jm=g.jm;k.uf=g.uf;k.Qc=g.Qc;k.Gc=g.Gc;k.dd=g.dd;k.ce=g.ce;k.Nd=g.Nd;k.wf=g.wf;k.Hf=g.Hf;k.Dd=g.Dd;k.Sf=g.Sf;k.Yc=g.Yc;k.Fe=g.Fe;k.Cj=g.Cj;k.Bj=g.Bj;k.jc=g.jc;k.ph=g.ph;k.Bl=g.Bl;k.fe=g.fe;k.Jj=h.b4w_cluster_data.cluster_id;k.Fg=g.Fg;k.xk=g.xk;k.Ei=g.Ei;k.ri=g.ri;g=JSON.stringify(k);e[g]=e[g]||[];e[g].push(h)}for(var v in e){k=JSON.parse(v);delete k.Jj;
var h=e[v],g=ra.wl("STATIC"),z;for(z in k)g[z]=k[z];g.sd=a[0].Ga.k.sd;g.Cf=0;g.kg=0;g.Kf=0;g.Jf=0;g.Gf=0;g.hide=!1;for(f=0;f<h.length;f++){var q=h[f].Ga;0==f?(Q.ni(q.k.Y,g.Y),Q.oq(q.k.Aa,g.Aa)):(Q.Gq(g.Y,q.k.Y),Q.tz(g.Aa,q.k.Aa))}g.va=Q.Ge();g.Z=Q.Ge();Q.ni(q.k.Y,g.J);Q.oq(q.k.Aa,g.da);d.push({k:g,AG:h})}for(e=0;e<d.length;e++)for(f=d[e].k,v=d[e].AG,z=0;z<v.length;z++){q=v[z];h=q.Ga.k;g=t(q,f,b);k=ua.create();h.Fe&&!h.tn?(l=ua.get_trans_view(h.n),ua.set_trans(l,k)):ua.copy(h.n,k);l={};if(f.Dd||f.Fe)l.au_center_pos=
[k[0],k[1],k[2]];f.Dd&&(l.au_wind_bending_amp=[h.Cf],l.au_wind_bending_freq=[q.b4w_wind_bending_freq],l.au_detail_bending_amp=[q.b4w_detail_bending_amp],l.au_detail_bending_freq=[q.b4w_detail_bending_freq],l.au_branch_bending_amp=[q.b4w_branch_bending_amp]);for(m=0;m<g.length;m++)r=g[m].k,p=g[m].We,n=g[m].pa,r.Ql?p.Qf||(r.Fe?ia.PN(p,k):ia.Cs(p,k)):("COLOR_ID"==n.type&&(g[m].k=h,n.Li=q.uuid,u(n,h),r=J(h),G(n,r)),p=ia.Cs(p,k),ia.ON(p,l));c.push.apply(c,g)}return c}function t(a,b,c){var d=[],f=m(c,b,
!b.ri,!1),h=J(b),g=a.data,k=g.materials,p=Array(k.length),n=Array(k.length),r=Ea.$b(c,Aa.sb),t=!1;r&&(t=r.xr.length?!0:!1);for(var q=0;q<f.length;q++)for(var w=f[q],y=0;y<k.length;y++){var x=k[y];if((!x.b4w_lens_flares||t)&&!ia.lA(g,y)){var A=e(w);"MAIN"==w?p[y]=A:"DEBUG_VIEW"==w&&(n[y]=A);A.Jj=a.b4w_cluster_data.cluster_id;if(W(A,x)){"SHADOW"==w&&p[y]&&(A.Qd=p[y].Qd);A.Lf=b.Rd||b.fe?ia.Gp:ia.Ym;u(A,b);for(var O=A,B=a.particle_systems,C=0;C<B.length;C++){var ma=B[C].settings.b4w_vcol_from_name,T=
B[C].settings.b4w_vcol_to_name;""!==ma&&""!==T&&(O.zc[ma]={gk:!1,src:[{name:ma,pf:7}]})}"DYNAMIC"==b.type&&(A.Li=a.uuid);G(A,h);var va=ia.wz(g,y,A.Oj,b.ii,A.zc,A.Uh);!x.use_tangent_shading||"a_shade_tangs"in va.P[0]||(l(A,"CALC_TBN",1),z(A,"a_tbn_quat"));x.b4w_lens_flares&&(va=sa.ZL(va));d.push({pa:A,We:va,me:[x.name],k:b,pe:[a]})}}}for(q=0;q<n.length;q++)n[q]&&(n[q].zl=p[q].id,G(n[q],n[q].$o));var I=a.particle_systems;if(0<I.length&&d.length){for(var X=!1,U=!1,q=0;q<I.length;q++){var L=I[q],Ba=L.settings;
Ba.use_render_emitter&&(X=!0);"HAIR"!=Ba.type||"OBJECT"!=Ba.render_type&&"GROUP"!=Ba.render_type&&L.transforms.length||(U=!0);if(X&&U)break}var F=d[0].pa.zc,M;if(U){var P;if(1<k.length){for(var H={},Z=0;Z<I.length;Z++){var R=I[Z].settings;if("HAIR"==R.type&&("OBJECT"==R.render_type||"GROUP"==R.render_type)){var D=R.b4w_vcol_from_name,la=R.b4w_vcol_to_name;""!==D&&""!==la&&(H[D]=Y.L(F[D]))}}"a_bending_col_main"in F&&(H.a_bending_col_main=Y.L(F.a_bending_col_main));"a_bending_col_detail"in F&&(H.a_bending_col_detail=
Y.L(F.a_bending_col_detail));P=ia.xz(g,[],H)}else P=d[0].We;M=P}else M=null;for(var Sa=M,ga=a.Ga,ya=[],N=a.particle_systems,Q=a.data,Fa=0;Fa<N.length;Fa++){var ca=N[Fa],qa=ca.settings;if(qa.count)if("EMITTER"==qa.type){if("DYNAMIC"==b.type){var V=e("PARTICLES");V.da=b.da;V.J=b.J;V.Z=b.Z;V.Aa=b.Aa;V.Y=b.Y;V.va=b.va;var Ha,na=Q.materials,ea=ca.settings.material-1;ea>=na.length&&(K.warn('Wrong material used for rendering particle system "'+ca.name+'"'),ea=0);Ha=na[ea];"HALO"===ca.settings.render_type&&
"HALO"===Ha.type&&(V.qo=!0);v(V,Ha);var za=V,ta=a,ha=ca.settings;switch(ha.b4w_billboard_align){case "VIEW":l(za,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW");break;case "XY":l(za,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_XY");break;case "YZ":l(za,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_YZ");break;case "ZX":l(za,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_ZX");break;default:Y.r("Wrong billboard align value")}l(za,"BILLBOARD",0);var Ga=ha.b4w_enable_soft_particles&&ra.Hy(ta,ha);l(za,"SOFT_PARTICLES",0<ha.b4w_particles_softness&&
Ga&&xa.Aq?1:0);l(za,"SOFT_STRENGTH",ka.F(ha.b4w_particles_softness));ka.W(za.qb,"WORLD_SPACE","WORLD"==ha.b4w_coordinate_system?1:0);V.fe=!0;V.Li=ga.name+"_"+qa.uuid;V.Wv=ca.name;G(V,h);sa.yK(V,ca,Ha);var oa=sa.BJ(V,Q,ca,ga.k);sa.DO(oa,V,qa.count);sa.CO(ga);u(V,ga.k);ya.push({pa:V,We:oa,me:[Ha.name],k:b,pe:[a]})}}else if("HAIR"==qa.type){var zc=Y.jr(ca.seed);qa.b4w_dynamic_grass&&(b.ph=!0);var lc=pa.Iy(xa.lv)&&!qa.b4w_initial_rand_rotation&&!qa.b4w_hair_billboard,Jb=4;lc&&(Jb=8);if(ca.transforms.length)var Pb=
ca.transforms;else for(var $b=ia.Gu(Sa,qa.count,!1,zc),Pb=new Float32Array($b.length*Jb),hb=0;hb<$b.length;hb++){var rc=.75+.5*Y.vf(zc);Pb[hb*Jb]=$b[hb][0];Pb[hb*Jb+1]=$b[hb][1];Pb[hb*Jb+2]=$b[hb][2];Pb[hb*Jb+3]=rc;lc&&(Pb[hb*Jb+4]=1,Pb[hb*Jb+5]=0,Pb[hb*Jb+6]=0,Pb[hb*Jb+7]=0)}var Ac=Ea.$b(c,Aa.ah)?!0:!1;if("OBJECT"==qa.render_type){var ac=[m(c,qa.dupli_object.Ga.k,!b.ri,!0)],Cb=E(a,b,F,Sa,[qa.dupli_object],ac,[Pb],qa,ca,Ac,zc,!1);ya.push.apply(ya,Cb)}else if("GROUP"==qa.render_type){for(var mc=qa.dupli_group.objects,
ac=[],hb=0;hb<mc.length;hb++){var gc=m(c,mc[hb].Ga.k,!b.ri,!0);ac.push(gc)}for(var hc=!1,xb=[],hb=0;hb<mc.length;hb++)xb.push(mc[hb].Ga);if(qa.use_whole_group){for(var Hc,yb=Pb,Za=xb,Uc=lc,Vc=Jb,rb={},Ab=new Float32Array([0,0,0,1]),kb=0;kb<yb.length;kb+=Vc)for(var sb=0;sb<Za.length;sb++){var sc=aa.create(),tc=ua.get_scale(Za[sb].k.n),cb=ua.get_trans_view(Za[sb].k.n);aa.scale(cb,tc,sc);var Db=aa.clone([yb[kb],yb[kb+1],yb[kb+2]]);rb[sb]||(rb[sb]=new Float32Array(yb.length));Uc&&(rb[sb][kb+4]=Ab[0]=
yb[kb+4],rb[sb][kb+5]=Ab[1]=yb[kb+5],rb[sb][kb+6]=Ab[2]=yb[kb+6],rb[sb][kb+7]=Ab[3]=yb[kb+7],Y.Xv(Ab,Ab),Y.aO(sc,Ab,sc));aa.add(Db,sc,Db);rb[sb][kb]=Db[0];rb[sb][kb+1]=Db[1];rb[sb][kb+2]=Db[2];rb[sb][kb+3]=yb[kb+3]}Hc=rb;hc=!0}else{var Eb;if(qa.use_group_count){for(var tb=Pb,Mb=xb,Wb=qa.dupli_weights,uc=zc,Oc=lc,nc=Jb,bc={},Qb=[],$a=0;$a<Mb.length;$a++)for(var Fb=Mb[$a],Bc=Fb.Ak||Fb.name,Ua=0;Ua<Wb.length;Ua++){var vc=Wb[Ua];Bc==vc.name&&Qb.push(vc)}Wb.length!=Qb.length&&K.error("dupli weights match failed");
for($a=0;$a<tb.length;$a+=nc){for(var Kb,lb=Qb,ib=[0],ub=0;ub<lb.length;ub++)ib[ub+1]=ib[ub]+lb[ub].count;for(var Ma=ib[ib.length-1]*Y.vf(uc),fb=0,ub=0;ub<ib.length;ub++)if(Ma>=ib[ub]&&Ma<ib[ub+1]){fb=ub;break}Kb=fb;bc[Kb]=bc[Kb]||[];bc[Kb].push(tb[$a],tb[$a+1],tb[$a+2],tb[$a+3]);Oc&&bc[Kb].push(tb[$a+4],tb[$a+5],tb[$a+6],tb[$a+7])}for(Kb in bc)bc[Kb]=new Float32Array(bc[Kb]);Eb=bc}else{for(var db=Pb,Pc=zc,mb=lc,Xa=Jb,Gb=xb.length,ab={},Ya=0;Ya<db.length;Ya+=Xa){var Hb=Math.floor(Gb*Y.vf(Pc));ab[Hb]=
ab[Hb]||[];ab[Hb].push(db[Ya],db[Ya+1],db[Ya+2],db[Ya+3]);mb&&ab[Hb].push(db[Ya+4],db[Ya+5],db[Ya+6],db[Ya+7])}for(Hb in ab)ab[Hb]=new Float32Array(ab[Hb]);Eb=ab}Hc=Eb}Cb=E(a,b,F,Sa,mc,ac,Hc,qa,ca,Ac,zc,hc);ya.push.apply(ya,Cb)}"INSTANCE"==qa.b4w_wind_bend_inheritance&&ga.k.Dd&&K.warn('Emitter object "'+ga.name+"\" has a particle system with wind bending inheritance from the particle instance. Wind bending on the emitter isn't disabled. Expect unforeseen behavior.")}else Y.r("Unknown particle settings type")}X?
d.push.apply(d,ya):d=ya}return d}function g(a,b,c,d){a.rn=Q.jy(b,d);a.pn=Q.hy(c,d);a.qn=Q.iy(b,d)}function m(a,b,c,d){var e=[];d||(b.Ng&&Ea.$b(a,Aa.Ud)||b.ec&&Ea.$b(a,Aa.mg))&&e.push("COLOR_ID");c&&(e.push("MAIN"),e.push("NODES_GLOW"),Ea.$b(a,Aa.ze)&&e.push("DEBUG_VIEW"),Ea.$b(a,Aa.Ce)&&e.push("SHADOW"),Ea.$b(a,Aa.ah)&&e.push("GRASS_MAP"));e.push("PHYSICS");if(b.fd||b.Gc)for(a=null,b.fd&&(a=["MAIN","NODES_GLOW","COLOR_ID","PHYSICS","DEBUG_VIEW"]),b.Gc&&(b=["COLOR_ID","PHYSICS","SHADOW","DEBUG_VIEW"],
a=null!==a?Y.dG(a,b):b),b=a,a=0;a<b.length;a++)c=e.indexOf(b[a]),-1!==c&&e.splice(c,1);return e}function v(a,b){var c;switch(a.type){case "MAIN":if(b.b4w_do_not_render)c=!1;else{if(b.use_nodes&&"HALO"!=b.type)D(a,b,"MAIN");else{k(a,b);c=b.game_settings.alpha_blend;a.lg=b.b4w_render_above_all&&"OPAQUE"!=c&&"CLIP"!=c;a.sf=b.offset_z;a.Rg.set([1,1,1]);var e=b.texture_slots;T.set(b.diffuse_color[0],b.diffuse_color[1],b.diffuse_color[2],b.alpha,a.Zc);if(b.b4w_lens_flares){L(a,"special_lens_flares.glslv",
"special_lens_flares.glslf");z(a,"a_position");z(a,"a_texcoord");var f=V.Oc(e[0],null);O(a,f)}else{L(a,"main.glslv","main_stack.glslf");b.use_shadeless||(c=na.du(b.uuid,b.name,{Qd:b.use_shadeless,Un:b.diffuse_shader,vm:b.specular_shader,Vk:b.use_tangent_shading}),a.qb.Vf=na.mq(c));var g=r("use_map_color_diffuse",e),m=r("use_map_color_spec",e),p=r("use_map_normal",e),n=r("use_map_mirror",e),u=r("use_stencil",e);c=g[0];m=m[0];p=p[0];n=n[0];g=g[1];e=u[0]&&r("use_rgb_to_intensity",e)[0];if(c){switch(c.blend_type){case "MIX":l(a,
"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":l(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}f=V.Oc(c,null);O(a,f,"u_colormap0");a.vg=c.diffuse_color_factor;a.og=c.use_map_alpha?c.alpha_factor:0;a.Rg.set(c.scale)}u=c&&c==m;m&&(u||(f=V.Oc(m,null),O(a,f,"u_specmap0")),a.Mh=m.specular_color_factor);if(p&&(z(a,"a_tbn_quat"),a.Gk=!0,f=V.Oc(p,null),O(a,f,"u_normalmap0"),a.Or=p.normal_factor,f=p.texture,f.b4w_use_map_parallax&&xa.Ur)){var t=ka.F(f.b4w_parallax_steps),v=ka.F(f.b4w_parallax_lod_dist);
l(a,"PARALLAX",1);l(a,"PARALLAX_STEPS",t);l(a,"PARALLAX_LOD_DIST",v);a.parallax_scale=f.b4w_parallax_scale}n&&(f=V.Oc(n,null),O(a,f,"u_mirrormap"),a.Ho=n.mirror_factor);if(n=c&&g&&e?1:0)f=V.Oc(g,null),O(a,f,"u_colormap1"),f=V.Oc(e,null),O(a,f,"u_stencil0");(f=c||m||p)&&a.Rg.set(f.scale);l(a,"TEXTURE_SPEC",void 0==m?0:1);l(a,"ALPHA_AS_SPEC",u?1:0);l(a,"TEXTURE_STENCIL_ALPHA_MASK",n);z(a,"a_position");z(a,"a_tbn_quat");(c||m||p)&&z(a,"a_texcoord");if(b.b4w_water){a.Xg=!0;a.water_dynamic=b.b4w_water_dynamic;
b.b4w_water_shore_smoothing&&!a.mb?(K.warn('Material: "'+b.name+'" is opaque.',"Disabling shore smoothing."),a.Um=!1):a.Um=b.b4w_water_shore_smoothing;L(a,"special_water.glslv","special_water.glslf");n=na.du(b.uuid,b.name,{Qd:!1,Un:b.diffuse_shader,vm:b.specular_shader,Vk:b.use_tangent_shading});a.qb.Vf=na.mq(n);z(a,"a_position");xa.rD?(z(a,"a_polyindex"),a.Ha=!0,aa.set(0,0,0,a.wireframe_edge_color),N.cA()?l(a,"DEBUG_WIREFRAME",1):l(a,"DEBUG_WIREFRAME",2)):l(a,"DEBUG_WIREFRAME",0);u=b.texture_slots;
n=r("use_map_normal",u);f=r("use_map_mirror",u)[0];n.length&&(t=V.Oc(n[0]),O(a,t,"u_normalmap0"),a.pj=b.b4w_water_norm_uv_velocity);l(a,"NUM_NORMALMAPS",n.length);a.Dh=Array(n.length);for(t=0;t<n.length;t++)a.Dh[t]=new Float32Array(2),a.Dh[t].set([n[t].scale[0],n[t].scale[1]]);f&&(t=V.Oc(f),O(a,t,"u_mirrormap"),a.Ho=f.mirror_factor);f=null;if(xa.Il)for(t=0;t<u.length;t++){var q=u[t];if(!0===q.texture.b4w_water_foam){f=q;break}}f&&(l(a,"FOAM",1),t=V.Oc(f),O(a,t,"u_foam"),a.foam_factor=b.b4w_foam_factor,
a.Lq.set(f.texture.b4w_foam_uv_freq),a.Kq.set(f.texture.b4w_foam_uv_magnitude),a.eo[0]=f.scale[0],a.eo[1]=f.scale[1]);for(t=0;t<u.length;t++)if(q=u[t],!0===q.texture.b4w_shore_dist_map){var w=q;break}w&&xa.Wp&&(w=V.Oc(w),O(a,w,"u_shore_dist_map"),l(a,"SHORE_PARAMS",1),w=q.texture.b4w_shore_boundings,l(a,"MAX_SHORE_DIST",ka.F(q.texture.b4w_max_shore_dist)),l(a,"SHORE_MAP_SIZE_X",ka.F(w[0]-w[1])),l(a,"SHORE_MAP_SIZE_Y",ka.F(w[2]-w[3])),l(a,"SHORE_MAP_CENTER_X",ka.F((w[0]+w[1])/2)),l(a,"SHORE_MAP_CENTER_Y",
ka.F((w[2]+w[3])/2)));if(b.b4w_generated_mesh)l(a,"GENERATED_MESH",1),a.Ys=!0,a.Zs=b.b4w_water_num_cascads,a.$s=b.b4w_water_subdivs,a.Xs=b.b4w_water_detailed_dist;else{z(a,"a_tbn_quat");if(f||n.length)z(a,"a_texcoord"),a.Gk=!0;l(a,"GENERATED_MESH",0)}if(b.b4w_water_dynamic){var q=ka.F(b.b4w_water_dst_noise_scale0),w=ka.F(b.b4w_water_dst_noise_scale1),n=ka.F(b.b4w_water_dst_noise_freq0),u=ka.F(b.b4w_water_dst_noise_freq1),f=ka.F(b.b4w_water_dir_min_shore_fac),t=ka.F(b.b4w_water_dir_freq),v=ka.F(b.b4w_water_dir_noise_scale),
y=ka.F(b.b4w_water_dir_noise_freq),A=ka.F(b.b4w_water_dir_min_noise_fac),ma=ka.F(b.b4w_water_dst_min_fac),va=ka.F(b.b4w_water_waves_hor_fac);l(a,"DST_NOISE_SCALE_0",q);l(a,"DST_NOISE_SCALE_1",w);l(a,"DST_NOISE_FREQ_0",n);l(a,"DST_NOISE_FREQ_1",u);l(a,"DIR_MIN_SHR_FAC",f);l(a,"DIR_FREQ",t);l(a,"DIR_NOISE_SCALE",v);l(a,"DIR_NOISE_FREQ",y);l(a,"DIR_MIN_NOISE_FAC",A);l(a,"DST_MIN_FAC",ma);l(a,"WAVES_HOR_FAC",va)}B(a,b);F(a,b);a.shallow_water_col.set(b.b4w_shallow_water_col);a.shore_water_col.set(b.b4w_shore_water_col);
a.shallow_water_col_fac=b.b4w_shallow_water_col_fac;a.shore_water_col_fac=b.b4w_shore_water_col_fac;l(a,"ABSORB",ka.F(b.b4w_water_absorb_factor));l(a,"SSS_STRENGTH",ka.F(b.b4w_water_sss_strength));l(a,"SSS_WIDTH",ka.F(b.b4w_water_sss_width))}"HALO"===b.type&&(L(a,"halo.glslv","halo.glslf"),x(a,b),a.Oj=["a_position"]);b.use_tangent_shading&&(l(a,"USE_TBN_SHADING",1),z(a,"a_shade_tangs"));l(a,"TEXCOORD",0);l(a,"NORMAL_TEXCOORD",0);c&&d(a,c,"TEXTURE_COLOR0_CO");g&&d(a,g,"TEXTURE_COLOR1_CO");e&&d(a,e,
"TEXTURE_STENCIL_ALPHA_MASK_CO");m&&d(a,m,"TEXTURE_SPEC_CO");p&&d(a,p,"TEXTURE_NORM_CO");l(a,"SHADELESS",b.use_shadeless?1:0);a.Qd=b.use_shadeless}c=b.game_settings.alpha_blend;l(a,"ALPHA","OPAQUE"===c?0:1);l(a,"ALPHA_CLIP","CLIP"===c?1:0);l(a,"DOUBLE_SIDED_LIGHTING",b.b4w_double_sided_lighting?1:0);b.use_vertex_color_paint?(l(a,"VERTEX_COLOR",1),z(a,"a_color")):l(a,"VERTEX_COLOR",0);a.Ff=b.ambient;a.wg=b.diffuse_intensity;a.Mf=b.emit;a.zf.set(b.specular_color);a.kp=b.specular_alpha;B(a,b);F(a,b);
b.b4w_wettable?l(a,"WETTABLE",1):l(a,"WETTABLE",0);C(a,b);b.b4w_refractive&&!a.mb?(K.warn('Material "'+b.name+'" is not blend. Disabling refractions.'),a.Wi=!1):a.Wi=b.b4w_refractive;a.ks=b.b4w_refr_bump}c=!0}break;case "NODES_GLOW":c=D(a,b,"GLOW");break;case "SHADOW":if(b.b4w_lens_flares||b.b4w_water||b.b4w_do_not_render||"HALO"===b.type)c=!1;else if(k(a,b),a.mb)c=!1;else{m=b.game_settings.alpha_blend;b.use_nodes&&"CLIP"==m?D(a,b,"SHADOW"):(L(a,"shadow.glslv","shadow.glslf"),T.set(b.diffuse_color[0],
b.diffuse_color[1],b.diffuse_color[2],b.alpha,a.Zc));z(a,"a_position");z(a,"a_tbn_quat");l(a,"ALPHA","OPAQUE"===m?0:1);a.Rg.set([1,1,1]);if((c=r("use_map_color_diffuse",b.texture_slots)[0])&&"CLIP"===m){switch(c.blend_type){case "MIX":l(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":l(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}a.Rg.set(c.scale);l(a,"TEXTURE_COLOR",1);z(a,"a_texcoord");if("IMAGE"==c.texture.q.source||"ENVIRONMENT_MAP"==c.texture.q.source||"CANVAS"==
c.texture.q.source)m=V.Oc(c),O(a,m,"u_colormap0");"NONE"==c.texture.q.source&&(m=V.Oc(c),O(a,m,"u_colormap0"))}else l(a,"TEXTURE_COLOR",0);c=!0}break;case "PHYSICS":b.b4w_collision?(a.zp=b.b4w_use_ghost,a.Bb=b.b4w_collision_id,a.In=b.b4w_collision_margin,a.Gn=b.b4w_collision_group,a.Jn=b.b4w_collision_mask,a.dk=b.physics.friction,a.Xj=b.physics.elasticity,c=!0):b.b4w_water?(a.Xg=!0,a.nP=b.b4w_water_dynamic,a.dst_noise_scale0=b.b4w_water_dst_noise_scale0,a.dst_noise_scale1=b.b4w_water_dst_noise_scale1,
a.dst_noise_freq0=b.b4w_water_dst_noise_freq0,a.dst_noise_freq1=b.b4w_water_dst_noise_freq1,a.dir_min_shore_fac=b.b4w_water_dir_min_shore_fac,a.dir_freq=b.b4w_water_dir_freq,a.dir_noise_scale=b.b4w_water_dir_noise_scale,a.dir_noise_freq=b.b4w_water_dir_noise_freq,a.dir_min_noise_fac=b.b4w_water_dir_min_noise_fac,a.dst_min_fac=b.b4w_water_dst_min_fac,a.waves_hor_fac=b.b4w_water_waves_hor_fac,c=!0):c=!1;break;case "COLOR_ID":if(b.b4w_lens_flares||"HALO"===b.type)c=!1;else{k(a,b);a.bf=!1;a.Ha=!0;a.mb=
!1;m=b.game_settings.alpha_blend;a.lg=b.b4w_render_above_all&&"OPAQUE"!=m&&"CLIP"!=m;b.use_nodes&&"CLIP"==m?D(a,b,"COLOR_ID"):(L(a,"color_id.glslv","color_id.glslf"),T.set(b.diffuse_color[0],b.diffuse_color[1],b.diffuse_color[2],b.alpha,a.Zc));z(a,"a_position");l(a,"ALPHA","OPAQUE"===m?0:1);a.Rg.set([1,1,1]);c=r("use_map_color_diffuse",b.texture_slots)[0];m="CLIP"===m?1:0;l(a,"ALPHA_CLIP",m);if(c&&m){switch(c.blend_type){case "MIX":l(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":l(a,
"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}a.Rg.set(c.scale);l(a,"TEXTURE_COLOR",1);z(a,"a_texcoord");if("IMAGE"==c.texture.q.source||"ENVIRONMENT_MAP"==c.texture.q.source)m=V.Oc(c),O(a,m,"u_colormap0");"NONE"==c.texture.q.source&&(m=V.Oc(c),O(a,m,"u_colormap0"))}else l(a,"TEXTURE_COLOR",0);c=!0}break;case "GRASS_MAP":!b.b4w_terrain||b.b4w_do_not_render?c=!1:(k(a,b),a.mb=!1,a.bf=!1,a.Ha=!0,L(a,"grass_map.glslv","grass_map.glslf"),z(a,"a_position"),c=b.b4w_dynamic_grass_size?b.b4w_dynamic_grass_size:
null,m=b.b4w_dynamic_grass_color?b.b4w_dynamic_grass_color:null,a.zc.a_grass_size={gk:!0,src:[]},c?(a.zc.a_grass_size.src.push({name:c,pf:4}),l(a,"DYNAMIC_GRASS_SIZE",1)):l(a,"DYNAMIC_GRASS_SIZE",0),a.zc.a_grass_color={gk:!0,src:[]},m?(a.zc.a_grass_color.src.push({name:m,pf:7}),l(a,"DYNAMIC_GRASS_COLOR",1)):l(a,"DYNAMIC_GRASS_COLOR",0),c=!0);break;case "DEBUG_VIEW":c=h(a,b);break;case "PARTICLES":a:if(b.b4w_do_not_render)c=!1;else{c=b.texture_slots;if(a.qo)L(a,"particle_system.glslv","particle_system_stack.glslf"),
l(a,"HALO_PARTICLES",1),x(a,b);else{m={Qd:!1,Un:b.diffuse_shader,vm:b.specular_shader,Vk:b.use_tangent_shading};if(b.use_nodes){L(a,"particle_system.glslv","particle_system.glslf");D(a,b,"PARTICLES");c=!0;break a}L(a,"particle_system.glslv","particle_system_stack.glslf");m=na.du(b.uuid,b.name,m);a.qb.Vf=na.mq(m);if(c=r("use_map_color_diffuse",c)[0]){l(a,"TEXTURE_COLOR",1);switch(c.blend_type){case "MIX":l(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":l(a,"TEXTURE_BLEND_TYPE",
"TEXTURE_BLEND_TYPE_MULTIPLY")}a.vg=c.diffuse_color_factor;a.og=c.use_map_alpha?c.alpha_factor:0;c=V.Oc(c);O(a,c)}}T.set(b.diffuse_color[0],b.diffuse_color[1],b.diffuse_color[2],b.alpha,a.Zc);a.Ff=b.ambient;a.wg=b.diffuse_intensity;a.Mf=b.emit;a.zf.set(b.specular_color);a.kp=b.specular_alpha;z(a,"a_position");z(a,"a_tbn_quat");c=b.game_settings.alpha_blend;l(a,"ALPHA","OPAQUE"===c?0:1);l(a,"ALPHA_CLIP","CLIP"===c?1:0);l(a,"PARTICLES_SHADELESS",b.use_shadeless?1:0);B(a,b);F(a,b);k(a,b);c=b.game_settings.alpha_blend;
a.lg=b.b4w_render_above_all&&"OPAQUE"!=c&&"CLIP"!=c;a.sf=b.offset_z;c=!0}break;default:Y.r("Wrong batch type: "+a.type)}return c}function x(a,b){var c=b.halo;l(a,"NUM_RINGS",c.ring_count);l(a,"NUM_LINES",c.line_count);l(a,"NUM_STARS",c.star_tip_count);l(a,"SKY_STARS",b.b4w_halo_sky_stars?1:0);a.dr=c.size;a.ar=c.hardness/20;a.cr.set(c.b4w_halo_rings_color);a.br.set(c.b4w_halo_lines_color);a.er=1/b.b4w_halo_stars_blend_height;a.fr=b.b4w_halo_stars_min_height;a.$q=!0}function d(a,b,c){switch(b.texture_coords){case "UV":case "ORCO":l(a,
c,"TEXTURE_COORDS_UV_ORCO");l(a,"TEXCOORD",1);break;case "NORMAL":l(a,c,"TEXTURE_COORDS_NORMAL");l(a,"NORMAL_TEXCOORD",1);break;default:l(a,c,"TEXTURE_COORDS_NONE")}}function k(a,b){var c=b.game_settings,d=c.alpha_blend;switch(d){case "ALPHA_SORT":a.mb=!0;a.bf=!0;a.Ha=!0;a.Ef=!1;break;case "ALPHA":a.mb=!0;a.bf=!1;a.Ha=!0;a.Ef=!1;break;case "CLIP":a.mb=!1;a.bf=!1;a.Ha=!0;a.Ef=!0;break;case "ADD":a.mb=!0;a.bf=!1;a.Ha=!1;a.Ef=!1;break;case "OPAQUE":a.mb=!1;a.bf=!1;a.Ha=!0;a.Ef=!1;break;default:Y.r("Unknown alpha blend mode: "+
d)}a.Ab=c.use_backface_culling}function r(a,b){for(var c=[],d=b.length,e=0;e<d;e++){var f=b[e];1==f[a]&&f.texture&&f.texture.q&&c.push(f)}return c}function C(a,b){var c=b.raytrace_transparency;a.Me[0]=c.fresnel;a.Me[1]=1-c.fresnel_factor/5;c=b.raytrace_mirror;a.reflect_factor=c.reflect_factor;a.Me[2]=c.fresnel;a.Me[3]=1-c.fresnel_factor/5}function B(a,b){var c,d=0;switch(b.specular_shader){case "PHONG":case "COOKTORR":c=b.specular_hardness;break;case "WARDISO":c=b.specular_slope;break;case "TOON":c=
b.specular_toon_size;d=b.specular_toon_smooth;break;case "BLINN":c=b.specular_ior;d=b.specular_hardness;break;default:K.error("unsupported specular shader: "+b.specular_shader+' (material "'+b.name+'")'),c=b.specular_hardness}a.Bd[0]=b.specular_intensity;a.Bd[1]=c;a.Bd[2]=d}function F(a,b){switch(b.diffuse_shader){case "LAMBERT":a.Jd[0]=0;a.Jd[1]=0;break;case "OREN_NAYAR":a.Jd[0]=b.roughness;a.Jd[1]=0;break;case "FRESNEL":a.Jd[0]=b.diffuse_fresnel;a.Jd[1]=b.diffuse_fresnel_factor;break;case "MINNAERT":a.Jd[0]=
b.darkness;a.Jd[1]=0;break;case "TOON":a.Jd[0]=b.diffuse_toon_size;a.Jd[1]=b.diffuse_toon_smooth;break;default:K.error("unsupported diffuse shader: "+b.diffuse_shader+' (material "'+b.name+'")'),a.Jd[0]=0,a.Jd[1]=0}}function D(a,b,c){if(!b.use_nodes||b.b4w_do_not_render)return!1;var d;switch(c){case "MAIN":L(a,"main.glslv","main.glslf");d=!1;break;case "GLOW":L(a,"main.glslv","main.glslf");d=!0;break;case "SHADOW":L(a,"shadow.glslv","shadow.glslf");d=!1;break;case "COLOR_ID":L(a,"color_id.glslv",
"color_id.glslf"),d=!1}var e=b.node_tree;c=na.nH(e,b.uuid,!1,b.name,c);if(!c.Pa)return K.error('Failed to create node graph for material "'+b.name+'", disable nodes'),w(a,b),!0;a.Ki=c.id;a.wi=!0;l(a,"NODES",1);l(a,"DOUBLE_SIDED_LIGHTING",b.b4w_double_sided_lighting?1:0);z(a,"a_position");b.use_orco_tex_coord&&z(a,"a_orco_tex_coord");k(a,b);a.sf=b.offset_z;var f=b.game_settings.alpha_blend;d?(l(a,"ALPHA",1),l(a,"ALPHA_CLIP",0)):(l(a,"ALPHA","OPAQUE"===f?0:1),l(a,"ALPHA_CLIP","CLIP"===f?1:0));a.lg=
b.b4w_render_above_all&&"OPAQUE"!=f&&"CLIP"!=f;T.set(b.diffuse_color[0],b.diffuse_color[1],b.diffuse_color[2],b.alpha,a.Zc);a.Mf=b.emit;a.Ff=b.ambient;C(a,b);b.b4w_wettable?l(a,"WETTABLE",1):l(a,"WETTABLE",0);var h=null,g=!1;ha.na(c.Pa,function(c,d){switch(d.type){case "UVMAP":case "TEX_COORD_UV":case "GEOMETRY_UV":case "UV_MERGED":var e=d.data.name,f=d.data.value;a.Uh||(a.Uh={});a.Uh[f]=e;break;case "GEOMETRY_VC":case "GEOMETRY_VC1":case "GEOMETRY_VC2":case "GEOMETRY_VC3":e=d.data.name;a.zc[e]={gk:!0,
src:[{name:d.data.value}]};f=0;if("GEOMETRY_VC"==d.type)f=7;else for(var k=0;k<d.Ya.length;k++){var m="RGB".indexOf(d.Ya[k].identifier);-1<m&&(f|=1<<2-m)}a.zc[e].src[0].pf=f;break;case "TEX_COORD_NO":case "GEOMETRY_NO":z(a,"a_tbn_quat");break;case "MATERIAL_BEGIN":d.data.value.Vk&&(l(a,"USE_TBN_SHADING",1),"PARTICLES"!=a.type?z(a,"a_shade_tangs"):a.Gk=!0);z(a,"a_tbn_quat");g=!0;break;case "TEXTURE_COLOR":case "TEXTURE_ENVIRONMENT":e=d.data.name;f=d.data.value;if(!f.q){K.warn('Wrong texture "'+d.data.value.name+
'" in material "'+b.name+'".');w(a,b);break}!1!==f.q.nl&&(f.q.nl="TEXTURE_ENVIRONMENT"!=d.type?!0:!1);O(a,f.q,e);break;case "TEXTURE_NORMAL":case "B4W_PARALLAX":l(a,"CALC_TBN_SPACE",1);z(a,"a_tbn_quat");a.Gk=!0;e=d.data.name;f=d.data.value;f.q.nl=!1;O(a,f.q,e);break;case "NORMAL_MAP":z(a,"a_tbn_quat");switch(Number(d.Rb[0][1])){case na.eE:l(a,"CALC_TBN_SPACE",1);a.Gk=!0;break;case na.dE:case na.cE:l(a,"USE_MODEL_MATRIX",1)}break;case "LAMP":d.data&&(a.Di=d.data);break;case "B4W_REFRACTION":a.mb?a.Wi=
!0:(a.Wi=!0,K.warn('Material "'+b.name+'" is not blend. Disabling refractions.'));break;case "VALTORGB":case "CURVE_VEC":case "CURVE_RGB":h||(h=d.data.Na);break;case "PARTICLE_INFO":"PARTICLES"==a.type&&d.data&&(a.Po=d.data);break;case "VECT_TRANSFORM":switch(Number(d.Rb[1][1])){case na.uF:l(a,"USE_MODEL_MATRIX_INVERSE",1);break;case na.tF:l(a,"USE_VIEW_MATRIX",1);break;case na.sF:l(a,"USE_MODEL_MATRIX",1);break;case na.rF:l(a,"USE_MODEL_MATRIX",1);l(a,"USE_VIEW_MATRIX",1);break;case na.qF:l(a,"USE_VIEW_MATRIX_INVERSE",
1);break;case na.pF:l(a,"USE_MODEL_MATRIX_INVERSE",1),l(a,"USE_VIEW_MATRIX_INVERSE",1)}break;case "B4W_VECTOR_VIEW":l(a,"USE_VIEW_MATRIX",1);break;case "B4W_REFLECT":l(a,"USE_VIEW_MATRIX_INVERSE",1)}});h&&O(a,h,"u_nodes_texture");g||(a.Qd=!0);d=a.qb.Vf=na.mq(c.Pa);y(e,a);e=a.Xf;c=a.Wf;for(f=0;f<d.length;f++){var m=d[f];switch(m.id){case "VALUE":var p=m.Vr[0];if(p)for(var n=0;n<e.length;n+=2)if(e[n]==p){m.Rb.push(["VALUE_IND",e[n+1]]);break}break;case "RGB":if(p=m.Vr[0])for(n=0;n<c.length;n+=2)if(c[n]==
p){m.Rb.push(["RGB_IND",c[n+1]]);break}}}l(a,"NUM_VALUES",a.Ch.length);l(a,"NUM_RGBS",a.Ld.length);return!0}function y(a,b){var c=[],d=[],e=[],f=[];A(a,"",c,d,e,f);b.Ch=c;b.Xf=d;b.Ld=e;b.Wf=f}function A(a,b,c,d,e,f){for(var h=0;h<a.nodes.length;h++){var g=a.nodes[h];if("VALUE"==g.type){var k=H(b,g.name);c.push(g.outputs[0].default_value);d.push(k,d.length/2)}else"RGB"==g.type?(k=H(b,g.name),g=g.outputs[0].default_value.slice(0,3),e.push(g[0],g[1],g[2]),f.push(k,f.length/2)):"GROUP"==g.type&&A(g.node_group.node_tree,
H(b,g.name),c,d,e,f)}}function H(a,b){var c;return c=(a?a+"%join%":"")+b}function w(a,b){switch(a.type){case "SHADOW":L(a,"shadow.glslv","shadow.glslf");break;case "COLOR_ID":L(a,"color_id.glslv","color_id.glslf");break;default:L(a,"main.glslv","main_stack.glslf")}l(a,"SHADELESS",1);z(a,"a_position");z(a,"a_tbn_quat");T.set(1,0,1,1,a.Zc);if(b){var c=b.game_settings.alpha_blend;l(a,"ALPHA","OPAQUE"===c?0:1);l(a,"ALPHA_CLIP","CLIP"===c?1:0);l(a,"VERTEX_COLOR",0);a.sf=b.offset_z;k(a,b)}return!0}function h(a,
b){if(b&&(b.b4w_lens_flares||b.b4w_do_not_render))return!1;L(a,"debug_view.glslv","debug_view.glslf");z(a,"a_position");z(a,"a_tbn_quat");z(a,"a_polyindex");a.Ha=!0;aa.set(0,0,0,a.wireframe_edge_color);return!0}function u(a,b){if("PHYSICS"!==a.type){"DYNAMIC"==b.type?(b.Ql?l(a,"AU_QUALIFIER","GLSL_IN"):l(a,"AU_QUALIFIER","uniform"),l(a,"STATIC_BATCH",0)):(l(a,"AU_QUALIFIER","GLSL_IN"),l(a,"STATIC_BATCH",1));"DEBUG_VIEW"==a.type&&(N.cA()?l(a,"WIREFRAME_QUALITY",1):l(a,"WIREFRAME_QUALITY",0),a.nh?(l(a,
"DEBUG_SPHERE",1),a.wq?l(a,"DEBUG_SPHERE_DYNAMIC",1):l(a,"DEBUG_SPHERE_DYNAMIC",0)):l(a,"DEBUG_SPHERE",0),l(a,"ALPHA",1));b.Rd&&(a.Rd=b.Rd);b.Dd?(""!==b.Sf?(a.zc.a_bending_col_main={gk:!0,src:[{name:b.Sf,pf:4}]},z(a,"a_bending_col_main"),""!==b.Yc.IA&&""!==b.Yc.HA&&""!==b.Yc.kB?(a.zc.a_bending_col_detail={gk:!0,src:[{name:b.Yc.IA,pf:4},{name:b.Yc.HA,pf:2},{name:b.Yc.kB,pf:1}]},z(a,"a_bending_col_detail"),z(a,"a_tbn_quat"),l(a,"DETAIL_BEND",1)):l(a,"DETAIL_BEND",0),l(a,"MAIN_BEND_COL",1)):l(a,"MAIN_BEND_COL",
0),l(a,"WIND_BEND",1)):l(a,"WIND_BEND",0);b.Aj?l(a,"BEND_CENTER_ONLY",1):l(a,"BEND_CENTER_ONLY",0);l(a,"BILLBOARD_PRES_GLOB_ORIENTATION",b.tn|0);b.Fe?l(a,"BILLBOARD",1):l(a,"BILLBOARD",0);b.Fe&&b.Ql?l(a,"HAIR_BILLBOARD",1):l(a,"HAIR_BILLBOARD",0);b.Bj?l(a,"BILLBOARD_SPHERICAL",1):l(a,"BILLBOARD_SPHERICAL",0);switch(b.Cj){case "RANDOM":l(a,"BILLBOARD_RANDOM",1);l(a,"BILLBOARD_JITTERED",0);break;case "JITTERED":l(a,"BILLBOARD_RANDOM",0);l(a,"BILLBOARD_JITTERED",1);break;default:l(a,"BILLBOARD_RANDOM",
0),l(a,"BILLBOARD_JITTERED",0)}b.jc&&xa.Wp?l(a,"DYNAMIC_GRASS",1):l(a,"DYNAMIC_GRASS",0);a.jc=b.jc;"PARTICLES"!=a.type&&(a.fe=b.fe);a.pd=b.pd;a.fd=b.fd;a.Tc=b.Tc&&!a.Qd&&!(a.mb&&xa.tu);a.Qc=b.Qc;a.Gc=b.Gc;a.dd=b.dd;b.Bi?(z(a,"a_influence"),l(a,"SKINNED",1),xa.vs?(l(a,"DISABLE_TANGENT_SKINNING",1),l(a,"FRAMES_BLENDING",0)):(l(a,"DISABLE_TANGENT_SKINNING",0),b.ck?l(a,"FRAMES_BLENDING",1):l(a,"FRAMES_BLENDING",0)),l(a,"MAX_BONES",b.Tf)):(l(a,"SKINNED",0),l(a,"FRAMES_BLENDING",0),l(a,"DISABLE_TANGENT_SKINNING",
0));b.yc?(l(a,"VERTEX_ANIM",1),xa.kD?l(a,"VERTEX_ANIM_MIX_NORMALS_FACTOR",.5):l(a,"VERTEX_ANIM_MIX_NORMALS_FACTOR","u_va_frame_factor")):l(a,"VERTEX_ANIM",0);b.Bi&&b.yc&&Y.r("Skinning and vertex animation are mutually exlusive");b.Bl?l(a,"DISABLE_FOG",1):l(a,"DISABLE_FOG",0)}}function P(a,b,c){if(b.length){for(var d=ra.Sq(b,xa.ssao&&c.b4w_enable_ssao),e=a.qb,f=0,h=0;h<a.qb.Vf.length;h++){var g=a.qb.Vf[h];if("LIGHTING_LAMP"==g.id){var k=b[f++%b.length],l=k.Ta;"AREA"==l.type&&(k=b[f++%b.length],l=k.Ta);
var m=ra.ga(k,c);if("SPOT"==l.type||"POINT"==l.type)var n=Math.cos(l.Pk/2);if("SPOT"==l.type)var u=l.mp*(1-n);m=m.vk;k=d.indexOf(k);g.Rb=[["LAMP_TYPE",l.type],["LAMP_IND",m],["LAMP_LIGHT_FACT_IND",Math.floor(m/2)],["LAMP_FAC_CHANNELS",0==m%2?"rg":"ba"],["LAMP_SPOT_SIZE",ka.F(n||.01)],["LAMP_SPOT_BLEND",ka.F(u||.01)],["LAMP_LIGHT_DIST",ka.F(l.distance)],["LAMP_SHADOW_MAP_IND",k]]}}if(a.Di){c=0;for(var r in a.Di)c++;a.Wl=new Float32Array(3*c);a.Co=new Float32Array(3*c);a.Bo=new Float32Array(3*c);a.Do=
new Float32Array(4*c);ka.W(e,"NUM_LAMP_LIGHTS",c);for(h=0;h<b.length;h++)p(a,b[h])}}}function p(a,b){if(b.lj in a.Di){var c=a.Di[b.lj],d=ua.get_trans_view(b.k.n);a.Wl.set(d,3*c);a.Co.set(b.Ta.direction,3*c);a.Bo.set(b.Ta.Kn,3*c);var d=Fa,e=b.Ta;d[0]=-1;d[1]=-1;d[2]=-1;d[3]=e.Uk?1:0;switch(e.type){case "POINT":d[2]=e.distance;break;case "SPOT":d[2]=e.distance;var f=d[0]=Math.cos(e.Pk/2);d[1]=e.mp*(1-f)}a.Do.set(d,4*c)}}function z(a,b){var c=a.Oj;-1==c.indexOf(b)&&c.push(b)}function l(a,b,c){ka.W(a.qb,
b,c)}function M(a,b){if("PHYSICS"==a.type)0<b.La.length&&ia.QN(b,b.P[0]),a.We=b;else{var c=a.bf,d=a.Lf;a.$q&&"PARTICLES"!=a.type&&(b=ia.dJ(b));a.Ys&&(b=ea.yJ(a.Zs,a.$s,a.Xs));c=ia.SN(b,c,d,a.zc);a.ja=c;a.fe||c.Pl||a.Rd||(c.ie=null,c.Hc=null);c=b.P.length;a.num_vertices=b.sa*c;a:switch(a.Lf){case ia.Ym:case ia.Hp:case ia.Gp:d=!0;break a;default:d=!1}d?ia.HK(b)?a.num_triangles=b.lb.length/3*c:a.num_triangles=b.sa/3*c:a.num_triangles=0}}function E(a,b,c,d,f,h,g,k,m,n,p,r){var t=a.Ga,v=[],z=k.b4w_dynamic_grass;
if(!n&&z)return v;for(var q="INSTANCE"==k.b4w_wind_bend_inheritance,w="INSTANCE"==k.b4w_shadow_inheritance,y="INSTANCE"==k.b4w_reflection_inheritance,x=[],A=[],O=0;O<f.length;O++){var B=f[O].Ga.k,C=ra.Ut(b);C.Fe=k.b4w_hair_billboard;C.Cj=k.b4w_hair_billboard_type;C.Bj="SPHERICAL"==k.b4w_hair_billboard_geometry;C.jc=z;C.Ql=!0;q?(C.Dd=B.Dd,C.el=B.el,C.kg=B.kg,C.Kf=B.Kf,C.Sf=B.Sf,C.Jf=B.Jf,C.Gf=B.Gf,C.Cf=B.Cf,C.Yc=B.Yc,C.Aj=!1):(C.Dd=t.k.Dd,C.el=t.k.el,C.kg=t.k.kg,C.Kf=t.k.Kf,C.Sf=t.k.Sf,C.Jf=t.k.Jf,
C.Gf=t.k.Gf,C.Cf=t.k.Cf,C.Yc=t.k.Yc,C.Aj=!0);w?(C.pd=B.pd,C.fd=B.fd,C.Tc=B.Tc):(C.pd=t.k.pd,C.fd=t.k.fd,C.Tc=t.k.Tc);y?(C.Qc=B.Qc,C.Gc=B.Gc,C.dd=B.dd,C.ce=B.ce,C.Nd=B.Nd,C.wf=B.wf):(C.Qc=t.k.Qc,C.Gc=t.k.Gc,C.dd=t.k.dd,C.ce=t.k.ce,C.Nd=t.k.Nd,C.wf=t.k.wf);x.push(C);var T=g[O];T||(T=new Float32Array);r&&Y.jr(m.seed,p);var va=new Float32Array(3),E=new Float32Array([0,0,0,1]),I=[],X=pa.Iy(xa.lv)&&!k.b4w_initial_rand_rotation&&!k.b4w_hair_billboard,U=4;X&&(U=8);for(var L=0;L<T.length;L+=U){va[0]=T[L];
va[1]=T[L+1];va[2]=T[L+2];var Ba=T[L+3]*ua.get_scale(B.n);if(k.b4w_initial_rand_rotation){switch(k.b4w_rotation_type){case "XYZ":var F=new Float32Array([Y.vf(p),Y.vf(p),Y.vf(p)]);aa.normalize(F,F);break;case "Z":F=new Float32Array([0,0,1]);break;default:Y.r("Unsupported random rotation type: "+k.b4w_rotation_type)}oa.setAxisAngle(F,k.b4w_rand_rotation_strength*(2*Math.PI*Y.vf(p)-Math.PI),E)}else if(X&&(E.set(T.subarray(L+4,L+8)),Y.Xv(E,E),!k.use_whole_group))if(k.use_rotation_dupli){var M=ua.get_quat_view(B.n);
oa.multiply(E,M,E)}else oa.multiply(E,ma,E);var P=ua.set_sep(va,Ba,E,ua.create());I.push(P)}A.push(I)}for(var H={},O=0;O<f.length;O++){var R=f[O],Z=h[O],C=x[O],D={};C.Dd&&(D.au_wind_bending_amp=[C.Cf],D.au_wind_bending_freq=[C.kg],D.au_detail_bending_freq=[C.Kf],D.au_detail_bending_amp=[C.Jf],D.au_branch_bending_amp=[C.Gf],C.Cf=0,C.kg=0,C.Kf=0,C.Jf=0,C.Gf=0);var la=J(C),I=A[O];if(I.length){for(var Sa=R.data,ga=Sa.materials,ya=Array(ga.length),N=Array(ga.length),L=0;L<ga.length;L++)if(!ia.lA(Sa,L))for(var Ea=
0;Ea<Z.length;Ea++){var Q=Z[Ea],Fa=e(Q),qa=ga[L];"MAIN"==Q?ya[L]=Fa:"DEBUG_VIEW"==Q&&(N[L]=Fa);Fa.Jj=a.b4w_cluster_data.cluster_id;if(W(Fa,qa)){"SHADOW"==Q&&ya[L]&&(Fa.Qd=ya[L].Qd);Fa.Lf=ia.Ym;u(Fa,C);Fa.Li=k.uuid;"JITTERED"==k.b4w_hair_billboard_type&&(Fa.sr=k.b4w_hair_billboard_jitter_amp,Fa.ur=k.b4w_hair_billboard_jitter_freq);z&&(Fa.Uq=k.b4w_dynamic_grass_scale_threshold);q||(delete Fa.zc.a_bending_col_main,delete Fa.zc.a_bending_col_detail);G(Fa,la);var ca=ia.wz(Sa,L,Fa.Oj,b.ii,Fa.zc,Fa.Uh),
V=t.k.n,Ha=xa.Wx&&1==f.length&&"PHYSICS"!=Fa.type;if(Ha){var ka=Y.L(ca);ia.wy(ca,ka,I);ka.Qf={Km:I,As:V,qC:"STATIC"==b.type,op:D,Fk:{},Yn:z};if(C.Dd&&C.Aj){var na=aa.fromValues(0,0,0);ua.transform_vec3(na,t.k.n,na);for(var za=[],ea=0;ea<I.length;ea++)za.push(na[0],na[1],na[2]);ka.Qf.Fk.a_emitter_center={Lb:3,data:za}}ia.wy(ca,ca,I);"STATIC"==b.type&&ia.xG(ka.Xe,V)}else{var sa=ka=ia.oL(ca,D,I),ta=I;sa.aa.au_center_pos=new Float32Array(3*sa.sa);for(var ha=ta.length,Ga=sa.sa/ha,Aa=0;Aa<ha;Aa++)for(var rc=
ta[Aa],Ac=3*Ga*Aa,ac=0;ac<Ga;ac++)sa.aa.au_center_pos[Ac+3*ac]=rc[0],sa.aa.au_center_pos[Ac+3*ac+1]=rc[1],sa.aa.au_center_pos[Ac+3*ac+2]=rc[2];ka=sa;if(C.Dd&&C.Aj){var Cb=ka,mc=t.k.n;Cb.aa.a_emitter_center=new Float32Array(3*Cb.sa);var gc=aa.fromValues(0,0,0);ua.transform_vec3(gc,mc,gc);for(var hc=0;hc<Cb.sa;hc++)Cb.aa.a_emitter_center[3*hc]=gc[0],Cb.aa.a_emitter_center[3*hc+1]=gc[1],Cb.aa.a_emitter_center[3*hc+2]=gc[2];ka=Cb}}var xb=k.b4w_vcol_from_name,Hc=k.b4w_vcol_to_name,yb=Fa,Za=c,Uc=!q,Vc=
Sa,rb=[];if(""!==xb&&""!==Hc){var Ab,kb=Hc,sb=yb.zc,sc=[],tc=void 0;for(tc in sb)for(var cb=sb[tc].src,Db=0,Eb=0;Eb<cb.length;Eb++){var tb=cb[Eb].pf;kb==cb[Eb].name&&sc.push(tc,tb,Db);Db+=Y.Jk(tb)}Ab=sc;if(0<Ab.length)for(var Mb=0;Mb<Ab.length;Mb+=3)rb.push({ao:xb,Eq:7,Wr:Ab[Mb],Xr:Ab[Mb+1],Bq:Ab[Mb+2]});else ia.rK(yb.Oj,"a_color")&&Hc==Vc.active_vcol_name&&rb.push({ao:xb,Eq:7,Wr:"a_color",Xr:7,Bq:0})}Uc&&("a_bending_col_main"in Za&&rb.push({ao:"a_bending_col_main",Eq:4,Wr:"a_bending_col_main",Xr:4,
Bq:0}),"a_bending_col_detail"in Za&&rb.push({ao:"a_bending_col_detail",Eq:7,Wr:"a_bending_col_detail",Xr:7,Bq:0}));for(var Wb=ka,uc=I,Oc=d,nc=rb,bc=Fa.zc,Qb=Ha,$a=!1,Fb=0;Fb<nc.length;Fb++){var Bc=nc[Fb].ao,Ua=Oc.aa[Bc];if(Ua&&0<Ua.length){$a=!0;break}}if(Qb)var vc=Wb.Qf.Fk;if($a){var Kb,lb=t.k.J,ib=Oc.P[0].a_position,ub=uc,Ma=H,fb=new Float32Array(3),db=new Float32Array(3),Pc=new Uint32Array(ub.length);if(!("verts_indices"in Ma)){Ma.gh=new Float32Array(3);Ma.fh=new Float32Array(3);Ma.jx=new Uint32Array(ib.length/
3);Ma.Ko=new Uint32Array(ib.length/3);Ma.gh[0]=(lb.max_x-lb.min_x)/20;Ma.gh[1]=(lb.max_y-lb.min_y)/20;Ma.gh[2]=(lb.max_z-lb.min_z)/20;Ma.fh[0]=lb.min_x;Ma.fh[1]=lb.min_y;Ma.fh[2]=lb.min_z;for(var mb=0;mb<ib.length/3;mb++){var Xa=Y.trunc((ib[3*mb]-Ma.fh[0])/Ma.gh[0]),Gb=Y.trunc((ib[3*mb+1]-Ma.fh[1])/Ma.gh[1]),ab=Y.trunc((ib[3*mb+2]-Ma.fh[2])/Ma.gh[2]),Xa=Y.clamp(Xa,0,19),Gb=Y.clamp(Gb,0,19),ab=Y.clamp(ab,0,19);Ma.jx[mb]=mb;Ma.Ko[mb]=ab*Math.pow(20,2)+20*Gb+Xa}ia.jC(Ma.Ko,Ma.jx,ia.st,!0);Ma.Zk=new Uint32Array(Math.pow(20,
3));for(mb=0;mb<Ma.Ko.length;mb++)Ma.Zk[Ma.Ko[mb]]++;delete Ma.Ko;for(mb=1;mb<Ma.Zk.length;mb++)Ma.Zk[mb]+=Ma.Zk[mb-1]}for(var Ya=0;Ya<ub.length;Ya++){fb[0]=ub[Ya][0];fb[1]=ub[Ya][1];fb[2]=ub[Ya][2];for(var Hb=1E10,Rb=-1,Qc=Y.trunc((fb[0]-Ma.fh[0])/Ma.gh[0]),Ic=Y.trunc((fb[1]-Ma.fh[1])/Ma.gh[1]),Sb=Y.trunc((fb[2]-Ma.fh[2])/Ma.gh[2]),Qc=Y.clamp(Qc,0,19),Ic=Y.clamp(Ic,0,19),Sb=Y.clamp(Sb,0,19),vb=Sb*Math.pow(20,2)+20*Ic+Qc,Wc=Ma.Zk[vb],Tb=0==vb?0:Ma.Zk[vb-1];Tb<Wc;Tb++){var cc=Ma.jx[Tb];db[0]=ib[3*
cc];db[1]=ib[3*cc+1];db[2]=ib[3*cc+2];aa.sub(db,fb,db);var oc=aa.sqrLen(db);oc<=Hb&&(Hb=oc,Rb=cc)}if(-1==Rb)for(Tb=0;Tb<ib.length/3;Tb++)db[0]=ib[3*Tb],db[1]=ib[3*Tb+1],db[2]=ib[3*Tb+2],aa.sub(db,fb,db),oc=aa.sqrLen(db),oc<=Hb&&(Hb=oc,Rb=Tb);Pc[Ya]=Rb}Kb=Pc;for(var Jc=Wb.sa/uc.length,Fb=0;Fb<nc.length;Fb++){var Va=nc[Fb].Wr,eb=nc[Fb].Xr,Bc=nc[Fb].ao,Kc=nc[Fb].Eq,Ua=Oc.aa[Bc];switch(Va){case "a_bending_col_main":var Xb=1;break;case "a_bending_col_detail":Xb=3;break;case "a_color":Xb=3;break;default:for(var Lb=
Xb=0;Lb<bc[Va].src.length;Lb++)Xb+=Y.Jk(bc[Va].src[Lb].pf)}if(Ua&&0<Ua.length){var Xc=Y.Jk(Kc),Lc=Y.Jk(eb),Rc=Kc&eb,Sc=Y.JB(Rc);Rc!=eb&&K.error("Wrong color extraction from "+Bc+" to "+Va+".");if(Qb)for(vc[Va]={Lb:Xb,data:[]},Lb=0;Lb<uc.length;Lb++)for(dc=Kb[Lb],Yb=dc*Xc,nb=0;nb<Sc.length;nb++)Sc[nb]&&(Mc=Y.om(Kc,nb),vc[Va].data.push(Ua[Yb+Mc]));else{if("a_bending_col_main"==Va||"a_bending_col_detail"==Va)Wb.aa[Va]=new Float32Array(Wb.sa*Lc);for(Lb=0;Lb<uc.length;Lb++){var dc=Kb[Lb],Yb=dc*Xc,Yc=Lb*
Jc*Xb;if(-1!=dc)for(var wc=0;wc<Jc;wc++)for(var Zc=wc*Xb,nb=0;nb<Sc.length;nb++)if(Sc[nb]){var Mc=Y.om(Kc,nb);Wb.aa[Va][Yc+Zc+(nc[Fb].Bq+Y.om(eb,nb))]=Ua[Yb+Mc]}}}}else Wb.aa[Va]=new Float32Array(0)}}ka=Wb;l(Fa,"USE_INSTANCED_PARTCLS",ka.Qf?1:0);v.push({pa:Fa,We:ka,me:[qa.name],k:C,pe:[a]})}}for(L=0;L<N.length;L++)N[L]&&(N[L].zl=ya[L].id,G(N[L],N[L].$o))}}return v}function W(a,b){var c=!0;"NODES_GLOW"==a.type&&(c=na.Gy(b));return c=c&&v(a,b)}function G(a,b){var c=null,d=null,e=a.J,f=a.Z,h=a.Y,g=a.va,
k=a.Sd;a.J=null;a.Z=null;a.Y=null;a.va=null;a.Sd=null;for(var l=0;l<a.T.length;l++){var m=a.T[l].Hd;m&&(c||(c={}),c[l]=m,a.T[l].Hd=null);if(m=a.T[l].ya)d||(d={}),d[l]=m,a.T[l].ya=null}a.id=0;a.$o=b;a.id=Y.xy(a,b);a.J=e;a.Z=f;a.Y=h;a.va=g;a.Sd=k;if(c)for(var p in c)a.T[p].Hd=c[p];if(d)for(p in d)a.T[p].ya=d[p]}function J(a){var b=a.Zd;a.Zd=null;var c=Y.xy(a,0);a.Zd=b;return c}function Z(a,b,c,d){var f=e("DEBUG_VIEW");L(f,"debug_view.glslv","debug_view.glslf");f.nh=!0;f.Ha=!0;f.Li=b;f.wq=c;u(f,a);a=
J(a);G(f,a);if(d.Bf){if(c)var h=d.Z,g=h.I;else h=d.va,g=aa.create();a=ea.Pq(1,g);b=aa.fromValues(aa.length(h.jd),aa.length(h.kd),aa.length(h.ld));ia.OB(a,b,g);c||(ua.set_trans(h.I,Ha),c=aa.normalize(h.jd,va),g=aa.normalize(h.kd,X),h=aa.normalize(h.ld,ya),!b[0]&&b[1]&&b[2]?aa.cross(g,h,c):!b[1]&&b[0]&&b[2]?aa.cross(h,c,g):!b[2]&&b[0]&&b[1]&&aa.cross(c,g,h),c=Y.TI(c,g,h,Ga),qa.invert(c,c),c=oa.fromMat3(c,Fa),ua.set_quat(c,Ha),ua.set_scale(1,Ha),ia.Cs(a,Ha))}else c?(c=d.da,a=ea.Pq(c.Ka,c.I)):(c=d.Aa,
a=ea.Pq(c.Ka,aa.create()),ua.identity(Ha),ua.set_trans(c.I,Ha),ia.Cs(a,Ha));f.J=Q.tl(d.J);f.Z=Q.En(d.Z);f.da=Q.Ij(d.da);f.Y=Q.tl(d.Y);f.va=Q.En(d.va);f.Aa=Q.Ij(d.Aa);ia.Ds(a,1,!0);a.aa.a_polyindex=ia.Hq(a);M(f,a);return f}function L(a,b,c){a.qb.Wg=b;a.qb.kf=c;ka.JM(a.qb)}function O(a,b,c){1==a.T.length&&0==a.Uc.length&&a.Uc.push("default0");c=c||"default"+String(a.T.length);-1==a.Uc.indexOf(c)&&(a.T.push(b),a.Uc.push(c));a.Qa&&I.cy(a)}function U(a){a.qb||Y.r("No shaders info for batch "+a.name);var b=
a.Qa?a.Qa.fp:null;a.Qa=ka.QJ(a.qb);var c=a.qb;if(c.status===ka.ut){var d=a.Qa.attributes,e=a.ja.zb,f;for(f in d)e[f]||Y.r('missing data for "'+f+'" attribute')}c.status&ka.FD&&K.error("Texture limit exceeded for shader - "+c.kf+', materials: "'+a.cc.join(", ")+'". Maximum texture count: '+la.rv+", actual texture count: "+c.GC);c.status&ka.ED&&K.error("Fragment uniform limit exceeded for shader - "+c.kf+', materials: "'+a.cc.join(", ")+'". Maximum fragment uniform count: '+la.Fo+", actual fragment uniform count: "+
c.oJ);c.status&ka.ID&&K.error("Vertex uniform limit exceeded for shader - "+c.Wg+', materials: "'+a.cc.join(", ")+'". Maximum vertex uniform count: '+la.Go+", actual vertex uniform count: "+c.eP);c.status&ka.HD&&K.error("Vertex attribute limit exceeded for shader - "+c.Wg+', materials: "'+a.cc.join(", ")+'". Maximum attribute count: '+la.sv+", actual attribute count: "+c.dy);c.status&ka.GD&&("MAIN"!=a.type||a.wi||K.error("Varying limit exceeded for shader - "+a.qb.kf+', materials: "'+a.cc.join(", ")+
'"'),"MAIN"==a.type&&a.wi||"NODES_GLOW"==a.type)&&(e=d=0,a.Uh&&(d=Y.no(a.Uh)),a.zc&&(e=Y.no(a.zc)),K.error("Varying limit exceeded for node shader - "+a.qb.kf+", uv: "+d+", vc: "+e+', materials: "'+a.cc.join(", ")+'"'));c.status&ka.yD&&K.error("Shader compilation/linking error: "+c.Wg+", "+c.kf+', materials: "'+a.cc.join(", ")+'"');return a.qb.status===ka.ut?(I.iG(a.Qa),I.Ct(a),I.cy(a),a.Qa.fp!=b&&(a.ss=!0),!0):!1}function ga(a,b,c){a=a.D[0].U;for(var d=0;d<a.length;d++)if(a[d].type==c&&!a[d].jf&&
-1!=a[d].cc.indexOf(b))return a[d];return null}function R(a,b,c){a=a.D[0].U;for(var d=0;d<a.length;d++)if(a[d].type==c&&a[d].jf&&-1!=a[d].cc.indexOf(b))return a[d];return null}function ca(a,b){a.Zc.set(b.Zc);a.wg=b.wg;a.zf.set(b.zf);a.Mh=b.Mh;a.Bd.set(b.Bd);a.Mf=b.Mf;a.Ff=b.Ff;a.vg=b.vg;a.og=b.og;a.reflect_factor=b.reflect_factor;a.Me.set(b.Me);a.parallax_scale=b.parallax_scale;a.shallow_water_col.set(b.shallow_water_col);a.shallow_water_col_fac=b.shallow_water_col_fac;a.shore_water_col.set(b.shore_water_col);
a.shore_water_col_fac=b.shore_water_col_fac;a.foam_factor=b.foam_factor;a.pj=b.pj}var Q=q("__boundings"),ta=q("__config"),K=q("__print"),N=q("__extensions"),ha=q("__graph"),qa=q("__mat3"),na=q("__nodemat"),ra=q("__obj_util"),sa=q("__particles"),ea=q("__primitives"),oa=q("__quat"),pa=q("__reformer"),I=q("__renderer"),Ea=q("__scenegraph"),ka=q("__shaders"),Aa=q("__subscene"),V=q("__textures"),ua=q("__tsr"),ia=q("__geometry"),Y=q("__util"),aa=q("__vec3"),T=q("__vec4"),xa=ta.v,la=ta.jh,ma=new Float32Array([0,
0,-Math.sqrt(.5),Math.sqrt(.5)]),va=new Float32Array(3),X=new Float32Array(3),ya=new Float32Array(3),Fa=new Float32Array(4),Ha=ua.create(),za=new Float32Array(24),Ga=qa.create();a.uP=Sa;var Sa="u_colormap0 u_colormap1 u_stencil0 u_specmap0 u_normalmap0 u_mirrormap".split(" "),Ba={};a.mG=function(a){return Ba[a]||null};a.nG=function(a,b){Ba[a]=b};a.HJ=function(a,c,d,e){for(var h=[],g=[],k=0;k<c.length;k++){var l=c[k],m=l.Ga;m.zo||(ra.Fa(m)?h.push(l):g.push(l))}var p=[];p.push.apply(p,n(h,a.q.Pa));
p.push.apply(p,f(g,a.q.Pa));for(var h=[],g=[],u={},k=0;k<p.length;k++){var l=p[k].pa,m=p[k].k,r=null;if(l.id in u){var t=u[l.id],v=g[t].pa,z=g[t].k,q=null,w=null,y=l.J,x=l.Z,A=l.da,O=l.Y,B=l.va,C=l.Aa;l.J=null;l.Z=null;l.da=null;l.Y=null;l.va=null;l.Aa=null;var aa=v.J,ma=v.Z,T=v.da,E=v.va,I=v.Y,va=v.Aa;v.J=null;v.Z=null;v.da=null;v.Y=null;v.va=null;v.Aa=null;for(var X=0;X<l.T.length;X++){var U=l.T[X].Hd;U&&(q||(q={}),q[X]=U,l.T[X].Hd=null);if(U=l.T[X].ya)w||(w={}),w[X]=U,l.T[X].ya=null}Y.vC(l,v)&&
Y.vC(m,z)&&(r=g[t]);l.J=y;l.Z=x;l.da=A;l.Y=O;l.va=B;l.Aa=C;v.J=aa;v.Z=ma;v.da=T;v.Y=I;v.va=E;v.Aa=va;if(q)for(X in q)l.T[X].Hd=q[X];if(w)for(X in w)l.T[X].ya=w[X];if(!r){do l.id++;while(u[l.id])}}r||(r={pa:l,k:p[k].k,pe:[],Fw:[],xC:[],me:[]},u[l.id]=g.length,g.push(r));r.pe.push.apply(r.pe,p[k].pe);p[k].We&&p[k].We.sa&&(r.Fw.push(p[k].We),r.xC.push(p[k].pe[0].Ga.k.n));if(r.me.length)for(X=0;X<p[k].me.length;X++)l=p[k].me[X],-1==r.me.indexOf(l)&&r.me.push(l);else r.me=p[k].me;ia.jC(r.me,r.Fw,ia.jF,
!1)}for(k=0;k<g.length;k++){u=g[k].Fw;p=g[k].xC;l=g[k].pa;m=g[k].k;if(0==u.length)X=ia.Re(Y.rp("%empty"));else if(1==u.length)X=u[0];else{r=[];for(X=0;X<u.length;X++)ia.IK(u[X])||r.push(X);if(r.length<u.length)for(X=0;X<r.length;X++)ia.Ds(u[r[X]]);X=ia.RN(u)}"PARTICLES"!=l.type&&(u=X.Xe,l.J=Q.tl(u.J),l.Z=Q.En(u.Z),l.da=m.da.Ka<u.da.Ka?"STATIC"==m.type?Q.Ij(m.Aa):Q.Ij(m.da):Q.Ij(u.da),"STATIC"==m.type?(l.va=l.Z,l.Y=l.J,l.Aa=l.da):(m=p[0],l.va=Q.rl(l.Z,m),l.Aa=Q.sl(l.da,m),l.Y=Q.ji(l.J,m)),l.Bf=Q.lr(l.Z,
l.da));h.push({pa:l,k:g[k].k,We:X,me:g[k].me,pe:g[k].pe})}for(g=0;g<h.length;g++)if(k=h[g].pa,k.cc=h[g].me,M(k,h[g].We),P(k,d,a),"STATIC"==h[g].k.type&&"COLOR_ID"!=k.type){l=Y.rp("%meta%"+k.type+"%"+k.cc.join("%")+"%");X=ra.Nn(l,"MESH");X.k=ra.Ut(h[g].k);ra.kn(X,a);ra.Yp(X,a,k);e.push(X);p=[];for(m=0;m<h[g].pe.length;m++){l=h[g].pe[m];l=l.Ga;Q.co(l.k.Y,za);for(u=0;u<za.length;u++)p.push(za[u]);"MAIN"==k.type&&l.Gr.push(X)}X.k.va=Q.rq(Y.f32(p),!0);X.k.Z=Q.ty(X.k.va,X.k.n);X.k.da=Q.vl(X.k.Z);X.k.Aa=
Q.vl(X.k.va);X.k.Bf=Q.lr(X.k.Z,X.k.da)}else for(X=[],m=0;m<h[g].pe.length;m++)l=h[g].pe[m],l=l.Ga,-1==X.indexOf(l.name)&&(ra.Yp(l,a,k),X.push(l.name),l.k.Bf=Q.lr(l.k.Z,l.k.da));if(xa.debug_view){for(g=0;g<h.length;g++)if(d=h[g].k,"DYNAMIC"==d.type&&(l=h[g].pe[0].Ga,k=h[g].pa,"MAIN"==k.type)){m=ra.ga(l,a);X=m.U;p=!1;for(m=0;m<X.length;m++)X[m].nh&&(p=!0);p||(d=Z(d,l.name,!0,k),ra.Yp(l,a,d))}for(g=0;g<e.length;g++)l=e[g],d=l.k,m=ra.ga(l,a),k=m.U[0],"MAIN"==k.type&&(d=Z(d,l.name,!1,k),ra.Yp(l,a,d));
for(g=0;g<h.length;g++)k=h[g].pa,"DEBUG_VIEW"==k.type&&(k.vq=g)}for(g=0;g<c.length;g++)for(m=ra.ga(c[g].Ga,a),X=m.U,m=0;m<X.length;m++)b(X[m]);for(g=0;g<e.length;g++)for(m=ra.ga(e[g],a),X=m.U,m=0;m<X.length;m++)b(X[m])};a.QF=function(a,d,f){var g=a.q.rx,k=e("MAIN");L(k,"special_skydome.glslv","special_skydome.glslf");if(d.procedural_skydome)l(k,"PROCEDURAL_SKYDOME",1),k.cs=!0;else{var m=g.xw;if(m){l(k,"WO_SKYTEX",1);var p=V.Oc(g.hC,null);O(k,p,"u_sky");m.invert&&l(k,"MTEX_NEGATIVE",1);m.YO&&l(k,"MTEX_RGBTOINT",
1);l(k,"BLENDTYPE",m.tG);m.UO&&l(k,"WOMAP_BLEND",1);m.VO&&l(k,"WOMAP_HORIZ",1);m.XO&&l(k,"WOMAP_ZENUP",1);m.WO&&l(k,"WOMAP_ZENDOWN",1)}g.ZO&&l(k,"WO_SKYBLEND",1);g.$O&&l(k,"WO_SKYPAPER",1);g.aP&&l(k,"WO_SKYREAL",1)}d.Qc&&(k.Qc=!0,d.Gc&&(k.Gc=!0));k.sf=99999;z(k,"a_position");d=ea.DJ();M(k,d);b(k);g=ra.ga(f,a);f.k.ph=!0;k.Z=Q.Ge();k.va=Q.Ge();k.J=Q.Mc();k.Y=Q.Mc();k.da=Q.oi();k.Aa=Q.oi();f=J(f.k);G(k,f);g.U.push(k);Ea.$b(a.q.Pa,Aa.ze)&&(a=c(k),a.type="DEBUG_VIEW",a.ub="",h(a),l(a,"DEBUG_VIEW_SPECIAL_SKYDOME",
1),d.aa.a_polyindex=ia.Hq(d),M(a,d),a.zl=k.id,G(a,f),g.U.push(a))};a.cu=function(a,b,d){d=ra.ga(a,d).U;var e=[];Ea.$b(b,Aa.Ac);var f=Ea.$b(b,Aa.Wc),h=Ea.$b(b,Aa.Jc),g=Ea.$b(b,Aa.mg);b=Ea.$b(b,Aa.Ud);for(var k=0;k<d.length;k++){var l=d[k],m=null;"SHADOW"==l.type&&"RECEIVE"==l.ub&&l.pd&&(m=c(l),m.ub="CAST");"MAIN"!=l.type&&"PARTICLES"!=l.type||!f&&!h||!l.Qc||(m=c(l),m.ub="REFLECT",m.Wi=!1,m.bf&&(m.bf=!1,m.Ha=!1),m.Ma=l.Ma);"COLOR_ID"==l.type&&g&&a.k.ec&&(b&&a.k.Ng?(m=c(l),m.ub="OUTLINE"):l.ub="OUTLINE");
m&&(m.jf=!0,G(m,a.k.id),e.push(m))}d.push.apply(d,e)};a.YM=g;a.pP=function(a,b,c){b?b=c*(b.max_z-b.min_z):(b=1,Y.r("No bounding box for mesh"));if(0==b)return 0;a=b*Math.tan(Y.deg_to_rad(a));return.5*(Math.sqrt(2*Math.sqrt(4*a+1)+2)/2-1)/b};a.oG=function(a){return{max_x:a.max_x,min_x:a.min_x,max_y:a.max_y,min_y:a.min_y,max_z:a.max_z,min_z:a.min_z}};a.WF=function(a,b,c){b=V.Mz(b,c);O(a,b,"u_color_ramp_tex")};a.lO=w;a.kO=P;a.UM=p;a.by=function(a,b){l(a,"CSM_SECTION1",0);l(a,"CSM_SECTION2",0);l(a,"CSM_SECTION3",
0);l(a,"NUM_CAST_LAMPS",0);if(b){l(a,"NUM_CAST_LAMPS",b.Rf.length);xa.Cr&&l(a,"MAC_OS_SHADOW_HACK",1);for(var c=1;c<b.csm_num;c++)l(a,"CSM_SECTION"+String(c),1);l(a,"SHADOW_TEX_RES",ka.F(b.csm_resolution));l(a,"CSM_FADE_LAST_CASCADE",b.fade_last_cascade?1:0);l(a,"CSM_BLEND_BETWEEN_CASCADES",b.blend_between_cascades?1:0)}else l(a,"SHADOW_TEX_RES",0),l(a,"CSM_FADE_LAST_CASCADE",0),l(a,"CSM_BLEND_BETWEEN_CASCADES",0)};a.Va=l;a.ad=function(a,b){return ka.VJ(a.qb,b)};a.iO=M;a.jO=G;a.GG=J;a.Zp=L;a.pl=O;
a.qM=function(a,b,c){c=a.Uc.indexOf(c);-1<c&&(a.T[c]=b)};a.QH=function(a,b){var c=e("MAIN");c.mb=!0;T.set(b[0],b[1],b[2],.5,c.Zc);c.Lf=ia.Hp;M(c,a);L(c,"main.glslv","main_stack.glslf");l(c,"SHADELESS",1);U(c);return c};a.fc=U;a.GJ=function(a,c){for(var d=0;d<c.length;d++){var f=c[d].Ga,h=e("LINE");L(h,"line.glslv","line.glslf");h.mb=!0;var g=ea.FJ();M(h,g);b(h);h.J=Q.Mc();h.Y=Q.Mc();h.Z=Q.Ge();h.va=Q.Ge();h.Aa=Q.oi();h.da=Q.oi();ra.kn(f,a);ra.ga(f,a).U.push(h);U(h)}};a.PG=function(a){return a.Qa.Qo.length?
a.Qa.Rv.u_cube_fog?!0:!1:!1};a.yH=function(){var a=e("DEPTH_PACK");a.Ab=!0;a.Ha=!1;var b=ea.vc();M(a,b);L(a,"postprocessing/postprocessing.glslv","postprocessing/depth_pack.glslf");U(a);return a};a.eu=function(a){var b=e("POSTPROCESSING");L(b,"postprocessing/postprocessing.glslv","postprocessing/postprocessing.glslf");switch(a){case "NONE":l(b,"POST_EFFECT","POST_EFFECT_NONE");break;case "GRAYSCALE":l(b,"POST_EFFECT","POST_EFFECT_GRAYSCALE");break;case "X_BLUR":case "Y_BLUR":l(b,"POST_EFFECT","POST_EFFECT_BLUR");
break;case "X_GLOW_BLUR":case "Y_GLOW_BLUR":l(b,"POST_EFFECT","POST_EFFECT_GLOW_BLUR");break;case "X_DOF_BLUR":case "Y_DOF_BLUR":l(b,"POST_EFFECT","POST_EFFECT_DOF_BLUR");break;case "X_ALPHA_BLUR":case "Y_ALPHA_BLUR":l(b,"POST_EFFECT","POST_EFFECT_ALPHA_BLUR");break;case "X_EXTEND":case "Y_EXTEND":l(b,"POST_EFFECT","POST_EFFECT_EXTEND");break;case "FLIP_CUBEMAP_COORDS":l(b,"POST_EFFECT","FLIP_CUBEMAP_COORDS");break;default:Y.r("Wrong postprocessing effect: "+a)}b.Ab=!0;b.Ha=!1;a=ea.vc();M(b,a);U(b);
return b};a.TH=function(a){var b=e("SSAO");b.Ha=!1;b.Ab=!0;var c=ea.vc();M(b,c);L(b,"postprocessing/postprocessing.glslv","postprocessing/ssao.glslf");l(b,"SSAO_QUALITY","SSAO_QUALITY_"+a.pC);l(b,"SSAO_HEMISPHERE",a.ssao_hemisphere?1:0);a={texture:V.IJ("SSAO_TEXTURE",a)};c={width:4,height:4,data:new Uint8Array([150,123,254,0,127,3,97,0,164,246,99,0,155,177,14,0,54,83,221,0,2,142,143,0,32,57,79,0,49,160,32,0,57,232,115,0,178,216,203,0,70,196,218,0,241,164,82,0,225,58,85,0,233,88,189,0,144,25,203,0,
117,73,12,0])};a=V.Oc(a,c);O(b,a,"u_ssao_special_tex");U(b);return b};a.UH=function(a){var b=e("SSAO_BLUR");b.Ha=!1;b.Ab=!0;var c=ea.vc();M(b,c);L(b,"postprocessing/postprocessing.glslv","postprocessing/ssao_blur.glslf");l(b,"SSAO_BLUR_DEPTH",a.ssao_blur_depth?1:0);U(b);return b};a.uH=function(a){var b=e("COC");b.Ha=!1;b.Ab=!0;var c=ea.vc();M(b,c);L(b,"postprocessing/postprocessing.glslv","postprocessing/coc.glslf");l(b,"DEPTH_RGBA",1);switch(a){case "COC_ALL":l(b,"COC_TYPE","COC_ALL");break;case "COC_FOREGROUND":l(b,
"COC_TYPE","COC_FOREGROUND");break;case "COC_COMBINE":l(b,"COC_TYPE","COC_COMBINE")}U(b);return b};a.zH=function(a){var b=e("DOF");b.Ha=!1;b.Ab=!0;var c=ea.vc();M(b,c);L(b,"postprocessing/postprocessing.glslv","postprocessing/dof.glslf");a.p.Nc?l(b,"DOF_TYPE","DOF_BOKEH"):(l(b,"DOF_TYPE","DOF_SIMPLE"),l(b,"DEPTH_RGBA",1));U(b);return b};a.IH=function(){var a=e("OUTLINE");a.Ha=!1;a.Ab=!0;var b=ea.vc();M(a,b);L(a,"postprocessing/postprocessing.glslv","postprocessing/outline.glslf");U(a);return a};a.BH=
function(){var a=e("GLOW_COMBINE");a.Ha=!1;a.Ab=!0;var b=ea.vc();M(a,b);L(a,"postprocessing/postprocessing.glslv","postprocessing/glow.glslf");U(a);return a};a.CH=function(a,b,c){var d=e("GOD_RAYS");d.Ha=!1;d.Ab=!0;var f=ea.xJ();M(d,f);L(d,"postprocessing/god_rays.glslv","postprocessing/god_rays.glslf");l(d,"DEPTH_RGBA",a?1:0);l(d,"WATER_EFFECTS",b?1:0);l(d,"STEPS_PER_PASS",ka.F(c,1));U(d);return d};a.DH=function(){var a=e("GOD_RAYS_COM");a.Ha=!1;a.Ab=!0;var b=ea.vc();M(a,b);L(a,"postprocessing/postprocessing.glslv",
"postprocessing/god_rays_combine.glslf");l(a,"SAFARI_CANVAS_ALPHA_HACK",xa.MB?1:0);U(a);return a};a.LH=function(){var a=e("SKY");a.Ha=!1;a.Ab=!0;var b=ea.zJ();M(a,b);L(a,"procedural_skydome.glslv","procedural_skydome.glslf");l(a,"WATER_EFFECTS",1);U(a);return a};a.qH=function(a){var b=e("ANTIALIASING");b.Ha=!1;b.Ab=!0;var c=ea.vc();M(b,c);L(b,"postprocessing/postprocessing.glslv","postprocessing/antialiasing.glslf");xa.AB?(l(b,"AA_METHOD","AA_METHOD_FXAA_QUALITY"),l(b,"AA_QUALITY",a.Hz)):l(b,"AA_METHOD",
"AA_METHOD_FXAA_LIGHT");U(b);return b};a.RH=function(a){var b=e("SMAA"),c=ea.vc();M(b,c);L(b,"postprocessing/smaa.glslv","postprocessing/smaa.glslf");l(b,"AA_METHOD","AA_METHOD_SMAA_HIGH");l(b,"SMAA_PASS",a);l(b,"SMAA_PREDICATION",0);l(b,"SMAA_REPROJECTION",0);U(b);b.Ha=!1;b.Ab=!0;return b};a.wH=function(){var a=e("COMPOSITING");a.Ha=!1;a.Ab=!0;var b=ea.vc();M(a,b);L(a,"postprocessing/postprocessing.glslv","postprocessing/compositing.glslf");U(a);return a};a.HH=function(){var a=e("MOTION_BLUR");a.Ab=
!0;a.Ha=!1;var b=ea.vc();M(a,b);L(a,"postprocessing/postprocessing.glslv","postprocessing/motion_blur.glslf");U(a);return a};a.VH=function(a){var b=e("STEREO");b.Ab=!0;b.Ha=!1;var c=ea.vc();M(b,c);L(b,"postprocessing/postprocessing.glslv","postprocessing/stereo.glslf");l(b,"ANAGLYPH","ANAGLYPH"===a?1:0);U(b);return b};a.EH=function(){var a=e("LUMINANCE");a.Ha=!1;a.Ab=!0;var b=ea.vc();M(a,b);L(a,"postprocessing/postprocessing.glslv","postprocessing/luminance.glslf");U(a);return a};a.rH=function(){var a=
e("LUMINANCE");a.Ha=!1;a.Ab=!0;var b=ea.vc();M(a,b);L(a,"postprocessing/postprocessing.glslv","postprocessing/luminance_av.glslf");U(a);return a};a.FH=function(){var a=e("LUMINANCE_X_BLUR");a.Ha=!1;a.Ab=!0;var b=ea.vc();M(a,b);L(a,"postprocessing/luminance_trunced.glslv","postprocessing/luminance_trunced.glslf");U(a);return a};a.sH=function(){var a=e("POSTPROCESSING");a.Ab=!0;a.Ha=!1;var b=ea.vc();M(a,b);L(a,"postprocessing/postprocessing.glslv","postprocessing/bloom_blur.glslf");U(a);return a};a.tH=
function(){var a=e("BLOOM");a.Ha=!1;a.Ab=!0;var b=ea.vc();M(a,b);L(a,"postprocessing/postprocessing.glslv","postprocessing/bloom_combine.glslf");U(a);return a};a.uI=function(){var a=e("VELOCITY");a.Ha=!1;a.Ab=!0;var b=ea.vc();M(a,b);L(a,"postprocessing/postprocessing.glslv","postprocessing/velocity.glslf");U(a);return a};a.pH=function(){var a=e("ANCHOR_VISIBILITY");a.Ha=!0;a.Ab=!0;a.Lf=ia.zx;L(a,"anchors.glslv","anchors.glslf");var b=ea.Nz(1);M(a,b);l(a,"ANCHOR_NUM",1);U(a);a.vj=new Float32Array(3);
return a};a.JH=function(){var a=e("PERFORMANCE");a.Ha=!1;a.Ab=!0;var b=ea.vc();M(a,b);L(a,"postprocessing/postprocessing.glslv","postprocessing/performance.glslf");U(a);return a};a.hO=function(a,b){var c=b.length/3;if(c!=a.vj.length/3){var d=ea.Nz(c);M(a,d);l(a,"ANCHOR_NUM",c);U(a)}a.vj=b};a.Lu=function(a){if(!a.D.length)return null;a=a.D[0];return a.U.length?a.U[0]:null};a.Ra=ga;a.Le=R;a.MR=ca;a.iQ=function(a,b){for(var c=a.D[0].U,d=0;d<c.length;d++)if(c[d].type==b)return!0;return!1};a.Oy=function(a){for(var b=
a.T,c=0;c<b.length;c++){var d=b[c];d.md&&V.FI(d.Za)}a.ja.md&&ia.fH(a.ja);a.md&&a.Sd.length&&I.iH(a);a.Qa.md&&ka.hH(a.Qa);a.Ki&&(b=na.Zz(a.Ki))&&b.Ny&&na.gH(a.Ki)};a.inherit_material=function(a,b,c,d){for(var e=["MAIN","SHADOW","COLOR_ID"],f=!1,h=0;h<e.length;h++){var g=e[h],k=ga(a,b,g),l=ga(c,d,g);if(k&&l){var f=!0,m=R(c,d,g);"MAIN"==g&&(ca(l,k),m&&ca(m,k));for(g=0;g<l.Uc.length;g++){var p=l.Uc[g];if(-1!==Sa.indexOf(p)){var n=k.Uc.indexOf(p);-1!==n&&(l.T[g]=k.T[n],m&&(p=m.Uc.indexOf(p),-1!==p&&(m.T[p]=
k.T[n])))}}}}f||K.error("Wrong objects for inheriting material!")};a.set_nodemat_value=function(a,b,c,d){for(var e=0;e<a.D.length;e++)for(var f=a.D[e].U,h=0;h<f.length;h++){var g=f[h];-1!=g.cc.indexOf(b)&&g.Ch&&(g.Ch[c]=d)}};a.set_nodemat_rgb=function(a,b,c,d,e,f){for(var h=0;h<a.D.length;h++)for(var g=a.D[h].U,k=0;k<g.length;k++){var l=g[k];-1!=l.cc.indexOf(b)&&l.Ld&&(l.Ld[3*c]=d,l.Ld[3*c+1]=e,l.Ld[3*c+2]=f)}};a.get_nodemat_value=function(a,b){return a.Ch[b]};a.get_nodemat_rgb=function(a,b,c){c[0]=
a.Ld[3*b];c[1]=a.Ld[3*b+1];c[2]=a.Ld[3*b+2];return c};a.Nl=function(a,b){var c;c=b[1];for(var d=2;d<b.length;d++)c+="%join%"+b[d];for(d=0;d<a.length;d+=2)if(a[d]==c)return a[d+1];return null};a.cleanup=function(){Ba={}}};b4w.module.__nodemat=function(a,q){function e(a,b,h,l,p){var n=xa.get_active(),n=f(b,p,n.uuid);if(n in ya)return ya[n];var v={Pa:null,id:n,Ny:!0};if("SHADOW"!=p&&"COLOR_ID"!=p){b=V.create();for(var q=a.nodes,w=0;w<q.length;w++)if(null==M(b,q[w],0,l,p))return ya[n]=null,v;if(h&&-1==z(a,b,"GROUP_OUTPUT","group"))return v;w=na(b);q=h?a.links:a.links.slice();if(!ra(b,q,w))return v;if(h)return v.Pa=b,v;for(w=0;w<q.length;w++){h=q[w];for(var y=k(h.from_node,b),A=k(h.to_node,b),O=0;O<y.length;O++)for(var C=
0;C<A.length;C++){var aa=y[O],ma=A[C],T=V.Sa(b,aa),X=V.Sa(b,ma);if(!ha(b,aa,ma,T,X,h))return ya[n]=null,v}}d(b);a="GLOW"==p?z(a,b,"B4W_GLOW_OUTPUT","material",!0):z(a,b,"OUTPUT","material",!1,!0);-1==a&&(b=g(),a=0);r(b);a=V.Bs(b,a,V.Ep);c(a,l);m(a);B(a);u(a);x(a,l,p);Ea(a)}else l=e(a,b,h,l,"MAIN"),l=V.clone(l.Pa,function(a){var b=la.Fn(a);b.K=la.L(a.K);b.Ya=la.L(a.Ya);return b}),a=z(a,l,"OUTPUT","material",!1,!0),t(l,a),a=V.Bs(l,a,V.Ep),m(a);v.Pa=a;return ya[n]=v}function c(a,c){var d=[];V.na(a,function(a,
b){"MATERIAL"!=b.type&&"MATERIAL_EXT"!=b.type||d.push({IL:a,node:b})});for(var e=0;e<d.length;++e){var f=d[e].IL,h=d[e].node,g=V.lo(a);V.ol(a,g,h.data.rL);var k=V.lo(a);V.ol(a,k,h.data.sL);V.rd(a,g,k,[4,2]);for(var l={5:["LIGHTING_APPLY",10],6:["LIGHTING_APPLY",6],7:["MATERIAL_END",3],8:["MATERIAL_END",4],9:["MATERIAL_END",5]},m=V.ir(a,f),p=[],n=[],u=[],r={},t=0;t<m;t++){var v=V.ik(a,f,t);v in r||(r[v]=0);var z=V.Oe(a,v,f,r[v]++);p.push([v,f,z]);var q=l[z[1]];if(q)switch(q[0]){case "MATERIAL_END":n.push([v,
k,[z[0],q[1]]]);break;case "LIGHTING_APPLY":u.push([v,[z[0],q[1]]])}else n.push([v,g,z])}b(a,h.data.value,g,k,u,c);for(t=0;t<p.length;t++)V.ls(a,p[t][0],p[t][1],p[t][2]);for(t=0;t<n.length;t++)V.rd(a,n[t][0],n[t][1],n[t][2]);h=V.Jg(a,f);g=[];l=[];m={};for(t=0;t<h;t++)p=V.Bg(a,f,t),p in m||(m[p]=0),z=V.Oe(a,f,p,m[p]++),g.push([f,p,z]),l.push([k,p,z]);for(t=0;t<g.length;t++)V.ls(a,g[t][0],g[t][1],g[t][2]);for(t=0;t<l.length;t++)V.rd(a,l[t][0],l[t][1],l[t][2]);V.cg(a,f)}}function b(a,b,c,d,e,f){var h=
{name:"LIGHTING_AMBIENT",type:"LIGHTING_AMBIENT"},g=M(a,h,0,f,null),k=g;n(a,c,g,"E");n(a,c,g,"A");n(a,c,g,"D");g=xa.get_active();g=Y.xb(g,"LAMP",Y.DATA_ID_ALL);if(!b.Qd)for(var l,m,p,u=0;u<g.length;u++){p=g[u].Ta;h={name:"LIGHTING_LAMP",type:"LIGHTING_LAMP"};l=M(a,h,0,f,null);h={name:"LIGHTING_APPLY",type:"LIGHTING_APPLY"};m=M(a,h,0,f,null);n(a,k,m,"color");n(a,k,m,"specular");n(a,l,m,"ldir");n(a,c,m,"normal");n(a,c,m,"D");n(a,c,m,"S");n(a,l,m,"lcolorint");n(a,c,l,"shadow_factor");k="COOKTORR"==b.vm?
"SPECULAR_PHONG":"SPECULAR_"+b.vm;h={name:k,type:k,use_tangent_shading:b.Vk};k=M(a,h,0,f,null);n(a,l,k,"ldir");n(a,l,k,"lfac");n(a,c,k,"normal");n(a,k,m,"sfactor");n(a,l,k,"norm_fac");n(a,c,k,"sp_params");k="HEMI"==p.type?"DIFFUSE_LAMBERT":"DIFFUSE_"+b.Un;h={name:k,type:k,use_tangent_shading:b.Vk};p=M(a,h,0,f,null);n(a,l,p,"ldir");n(a,l,p,"lfac");n(a,c,p,"normal");n(a,l,p,"norm_fac");n(a,p,m,"lfactor");"DIFFUSE_LAMBERT"!=k&&n(a,c,p,"dif_params");for(l=0;l<e.length;l++)V.rd(a,e[l][0],m,e[l][1]);k=
m}n(a,k,d,"color");n(a,k,d,"specular")}function n(a,b,c,d){for(var e=V.Sa(a,b),f=V.Sa(a,c),h,g=0;g<f.K.length;g++)if(d==f.K[g].identifier){h=g;break}for(var k,g=0;g<e.Ya.length;g++)if(d==e.Ya[g].identifier){k=g;break}void 0!=h&&void 0!=k&&V.rd(a,b,c,[k,h])}function f(a,b,c){switch(b){case "GLOW":return a+c+"11";case "COLOR_ID":case "SHADOW":return a+c+"00";default:return a+c+"10"}}function t(a,b){V.ig(a,function(c,d,e){var f=V.Sa(a,d);d==b&&"Color"==f.K[e[1]].identifier&&V.ls(a,c,d,e)})}function g(){var a=
V.create(),b={data:null,Rb:[],V:[],K:[{jb:new Float32Array([0,0,0]),identifier:"Color",xc:!1,name:"Color"},{jb:1,identifier:"Alpha",xc:!1,name:"Alpha"}],Ya:[],type:"OUTPUT",nj:[]};V.ol(a,0,b);return a}function m(a){V.na(a,function(b,c){for(var d=c.K,e=c.Ya,f=0;f<d.length;f++)v(a,d[f],b,f,1);for(f=0;f<e.length;f++)v(a,e[f],b,f,0)})}function v(a,b,c,d,e){if(b.xc){var f=!0;V.ig(a,function(a,b,h){if(!e&&a==c&&h[0]==d||e&&b==c&&h[1]==d)f=!1});f&&(b.xc=!1)}}function x(a,b,c){var d=[];V.ig(a,function(e,
f,h){var g=V.Sa(a,e),k=V.Sa(a,f),g=la.is_vector(g.Ya[h[0]].jb),k=la.is_vector(k.K[h[1]].jb);if(g!=k){var m,p={default_value:[0,0,0],identifier:"Vector",is_linked:!0,name:"Vector"},n={default_value:0,identifier:"Value",is_linked:!0,name:"Value"};g&&!k?m=l("vector_to_scalar","B4W_VECTOSCAL",[p],[n]):!g&&k&&(m=l("scalar_to_vector","B4W_SCALTOVEC",[n],[p]));M(a,m,0,b,c);d.push([e,f,a.O[a.O.length-2],h])}});for(var e=0;e<d.length;++e)V.ls(a,d[e][0],d[e][1],d[e][3]),V.rd(a,d[e][0],d[e][2],[d[e][3][0],0]),
V.rd(a,d[e][2],d[e][1],[0,d[e][3][1]])}function d(a){var b=[];V.na(a,function(c,d){switch(d.type){case "B4W_TRANSLUCENCY":V.ig(a,function(e,f,h){var g=V.Sa(a,f);e==c&&"MATERIAL_EXT"==g.type&&"Translucency"==d.Ya[h[0]].name&&b.push(e,f,[h[0]+1,h[1]+1])})}});for(var c=0;c<b.length;c+=3)V.rd(a,b[c],b[c+1],b[c+2])}function k(a,b){var c=[];V.na(b,function(b,d){d.name==a.name&&c.push(b)});if(c.length)return c;la.r("Node not found")}function r(a){var b=[];V.na(a,function(a,c){"B4W_PARALLAX"!=c.type&&"REROUTE"!=
c.type||b.push(a,c)});for(var c=0;c<b.length;c+=2){var d=b[c],e=b[c+1];if("B4W_PARALLAX"==e.type){var f=C(a,d);if(-1!=f){var h=V.ik(a,f,0);V.Xi(a,f,d,-1);-1!=h&&V.Xi(a,h,f,-1);d=V.Sa(a,f);e.data=d.data;e.V[0]=d.V[0];V.cg(a,f)}e.K.splice(1,1)}else if("REROUTE"==e.type){for(var e=V.ik(a,d,0),g=V.Jg(a,d),f=[],h=[],k=[],l=0;l<g;l++){var m=V.Bg(a,d,l),p=h.indexOf(m);-1!=p?k[p]+=1:(h.push(m),k.push(1),f.push(d,m))}if(-1!=e)for(g=V.Oe(a,e,d,0)[0],l=0;l<h.length;l++)for(m=0;m<k[l];m++)p=V.Oe(a,d,h[l],m)[1],
V.rd(a,e,h[l],[g,p]);for(l=0;l<f.length;l+=2)V.Xi(a,f[l],f[l+1],-1)}}}function C(a,b){for(var c=a.Ca,d=0;d<c.length;d+=3)if(c[d+1]==b&&1==c[d+2][1])return c[d];return-1}function B(a){D(a);H(a);F(a)}function F(a){var b=[],c="",d="",e={};V.na(a,function(a,f){if("GEOMETRY_UV"==f.type||"UVMAP"==f.type||"TEX_COORD_UV"==f.type){b.push(a,f);var h=f.data.value;c?c==h||d||(d=h,e[d]=0):(c=h,e[c]=0);e[h]++}});for(var f in e)if(2>e[f]){for(var g=0;g<b.length;g+=2)b[g+1].data.value==f&&b.splice(g,2);delete e[f];
c==f&&(c=d,d="");d==f&&(d="")}if(!(3>b.length)){var g={default_value:[0,0,0],identifier:"UV_geom",is_linked:!1,name:"UV_geom"},k={default_value:[0,0,0],identifier:"UV_cycles",is_linked:!1,name:"UV_cycles"};f=l("merged_uv","UV_MERGED",[],[g,k]);f.uv_layer=c;M(a,f,0,"",void 0);var m=a.O[a.O.length-2];f=a.O[a.O.length-1];if(d){k=l("merged_uv","UV_MERGED",[],[g,k]);k.uv_layer=d;M(a,k,0,"",void 0);var p=a.O[a.O.length-2],k=a.O[a.O.length-1]}else k=null;for(var n=-1,u=null,g=0;g<b.length;g+=2){var r=b[g],
t=b[g+1];h(t,b[1])?(n=m,u=f):k&&(n=p,u=k);for(var v=[],z=V.Jg(a,r),q={},w=0;w<z;w++){var y=V.Bg(a,r,w);y in q||(q[y]=0);var x=V.Oe(a,r,y,q[y]++);v.push(r,y,x);x=x.splice(0,x.length);switch(t.type){case "GEOMETRY_UV":x[0]=0;u.Ya[0].xc=!0;break;case "UVMAP":case "TEX_COORD_UV":x[0]=1,u.Ya[1].xc=!0}V.rd(a,n,y,x)}for(var w=0;w<v.length;w+=3)V.Xi(a,v[w],v[w+1],0);V.cg(a,r)}}}function D(a){var b=[];V.na(a,function(a,c){"GEOMETRY_VC"!=c.type&&"GEOMETRY_NO"!=c.type&&"GEOMETRY_FB"!=c.type&&"GEOMETRY_VW"!=
c.type&&"GEOMETRY_GL"!=c.type&&"GEOMETRY_LO"!=c.type&&"GEOMETRY_OR"!=c.type||b.push(a,c)});for(var c=[],d=0;d<b.length;d+=2){for(var e=b[d],f=b[d+1],h=!0,g=0;g<c.length;g++){var k=c[g];if(w(f,k.Ee)){h=[];g=V.Jg(a,e);for(p=0;p<g;p++){var l=V.Bg(a,e,p),m=V.Oe(a,e,l,0);h.push(e,l,m);V.rd(a,k.id,l,m)}for(var p=0;p<h.length;p+=3)V.Xi(a,h[p],h[p+1],0);V.cg(a,e);h=!1;break}}h&&(k={id:e,Ee:f},c.push(k))}}function y(a){for(var b={},c=0;c<a.O.length;c+=2){var d=a.O[c];b[d]={nn:{},tA:!1}}for(c=0;c<a.Ca.length;c+=
3)b[a.Ca[c+1]].nn[a.Ca[c]]=!0;for(d in b)A(d,b);for(d in b)b[d]=Object.keys(b[d].nn).map(function(a){return parseInt(a)});return b}function A(a,b){var c=b[a];if(!c.tA){var d=la.L(c),e;for(e in c.nn){A(e,b);var c=b[e],f;for(f in c.nn)d.nn[f]=!0}d.tA=!0;b[a]=d}}function H(a){var b=[];V.na(a,function(a,c){"TEXTURE_COLOR"!=c.type&&"TEXTURE_NORMAL"!=c.type||b.push(a,c)});if(b.length){for(var c=y(a),d=[],e=0;e<b.length;e+=2){for(var f=b[e],h=b[e+1],g=!0,k=0;k<d.length;k++){var l=d[k];if(!(3<=l.bm.length||
!w(h,l.Ee)||-1<c[f].indexOf(l.id)||-1<c[l.id].indexOf(f))){for(var m=!1,p=0;p<l.bm.length;p++){var n=l.bm[p].id;if(-1<c[f].indexOf(n)||-1<c[n].indexOf(f)){m=!0;break}}if(!m){for(var k=[],n=V.ir(a,f),u={},p=0;p<n;p++)m=V.ik(a,f,p),m in u||(u[m]=0),g=V.Oe(a,m,f,u[m]++),k.push(m,f,g);for(var n=[],u=V.Jg(a,f),r={},p=0;p<u;p++)m=V.Bg(a,f,p),m in r||(r[m]=0),g=V.Oe(a,f,m,r[m]++),n.push(f,m,g);g=k.concat(n);for(p=0;p<g.length;p+=3)V.Xi(a,g[p],g[p+1],0);V.cg(a,f);p={id:f,Ee:h,RI:k,SI:n};l.bm.push(p);g=!1;
break}}}g&&(l={id:f,Ee:h,bm:[]},d.push(l))}for(e=0;e<d.length;e++){l=d[e];c=l.bm.length;for(k=0;k<c;k++){h=l.bm[k];p=h.Ee;f=h.RI;h=h.SI;l.Ee.K[k+1].xc=p.K[0].xc;l.Ee.K[k+1].jb=p.K[0].jb;l.Ee.Ya[2*(k+1)].xc=p.Ya[0].xc;l.Ee.Ya[2*(k+1)].jb=p.Ya[0].jb;l.Ee.Ya[2*(k+1)+1].xc=p.Ya[1].xc;l.Ee.Ya[2*(k+1)+1].jb=p.Ya[1].jb;for(p=0;p<f.length;p+=3)m=f[p],g=f[p+2],g[1]+=k+1,V.rd(a,m,l.id,g);for(p=0;p<h.length;p+=3)m=h[p+1],g=h[p+2],g[0]+=2*(k+1),V.rd(a,l.id,m,g);l.Ee.Rb.push(["USE_uv"+(k+2),1])}V.cg(a,l.id);V.ol(a,
l.id,l.Ee)}}}function w(a,b){if(a.type!==b.type)return!1;switch(a.type){case "GEOMETRY_VC":return a.data.value==b.data.value;case "GEOMETRY_NO":case "GEOMETRY_FB":case "GEOMETRY_VW":case "GEOMETRY_GL":case "GEOMETRY_LO":case "GEOMETRY_OR":return!0;case "TEXTURE_COLOR":case "TEXTURE_NORMAL":return a.data.value.uuid==b.data.value.uuid;default:return!1}}function h(a,b){var c=["GEOMETRY_UV","TEX_COORD_UV","UVMAP"];return-1!=c.indexOf(a.type)&&-1!=c.indexOf(b.type)?a.data.value==b.data.value:!1}function u(a){var b=
[],c=[];V.na(a,function(a,d){"GEOMETRY_VC"==d.type&&b.push(a,d);"GEOMETRY_VW"==d.type&&c.push(a,d)});P(a,b);p(a,c)}function P(a,b){for(var c=0;c<b.length;c+=2){for(var d=b[c],e=b[c+1],f=!1,h=[],g=[],k=[[],[],[]],l=V.Jg(a,d),m=0;m<l;m++){var p=V.Bg(a,d,m);if("SEPRGB"!=V.Sa(a,p).type){f=!1;break}h.push(d,p);for(var n={},u=V.Jg(a,p),f=0;f<u;f++){var r=V.Bg(a,p,f);r in n||(n[r]=0);var t=V.Oe(a,p,r,n[r]++);h.push(p,r);k[t[0]].push(d,r,t)}g.push(p);f=!0}if(f){for(m=d=l=0;m<k.length;m++)k[m].length&&(l++,
d|=1<<2-m);if(l){e.type+=l;e.Ya=[];for(m=0;m<k.length;m++)if(k[m].length)for(e.Ya.push({jb:0,identifier:"RGB"[m],xc:!0,name:"RGB"[m]}),f=0;f<k[m].length;f+=3)k[m][f+2][0]=la.om(d,m);for(m=0;m<h.length;m+=2)V.Xi(a,h[m],h[m+1],0);for(m=0;m<g.length;m++)V.cg(a,g[m]);for(m=0;m<k.length;m++)for(f=0;f<k[m].length;f+=3)V.rd(a,k[m][f],k[m][f+1],k[m][f+2])}}}}function p(a,b){for(var c=0;c<b.length;c+=2){for(var d=b[c],e=!0,f=[],h=V.Jg(a,d),g=0;g<h;g++){var k=V.Bg(a,d,g);if("B4W_REFLECT"==V.Sa(a,k).type){var l=
V.Oe(a,d,k,0),m=V.Oe(a,d,k,1);l&&1==l[1]||m&&1==m[1]?e=!1:f.push(d,k)}else e=!1}for(g=0;g<f.length;g+=2)h=a,l=f[g],k=f[g+1],m=V.Sa(h,k),m.type+="_WORLD",V.Xi(h,l,k,0),m.K.splice(0,1),l=V.ik(h,k,0),l!=V.qt&&(V.Oe(h,l,k,0)[1]=0);e&&V.cg(a,d)}}function z(a,b,c,d,e,f){a=a.nodes;for(var h=null,g=0;g<a.length;g++){var l=a[g];e?"GROUP"==l.type&&l.node_tree_name==c&&(h=l):l.type==c&&(h=l)}return h?k(h,b)[0]:(f||aa.error('No "'+c+'" node in node '+d),-1)}function l(a,b,c,d){return{name:a,type:b,inputs:c,outputs:d}}
function M(a,b,c,d,e){var f=b.name,h=b.type,g=[],k=[],l=[],m=[],p=null,n=[];switch(h){case "BSDF_ANISOTROPIC":case "BSDF_DIFFUSE":case "BSDF_GLOSSY":case "BSDF_GLASS":case "BSDF_HAIR":case "BSDF_TRANSPARENT":case "BSDF_TRANSLUCENT":case "BSDF_REFRACTION":case "BSDF_TOON":case "BSDF_VELVET":case "SUBSURFACE_SCATTERING":case "EMISSION":case "AMBIENT_OCCLUSION":case "VOLUME_ABSORPTION":case "VOLUME_SCATTER":case "BUMP":case "BLACKBODY":case "WAVELENGTH":case "SEPXYZ":case "COMBXYZ":case "LIGHT_FALLOFF":case "TEX_IMAGE":case "TEX_ENVIRONMENT":case "TEX_SKY":case "TEX_NOISE":case "TEX_WAVE":case "TEX_MUSGRAVE":case "TEX_GRADIENT":case "TEX_MAGIC":case "TEX_CHECKER":case "TEX_BRICK":case "WIREFRAME":case "LAYER_WEIGHT":case "TANGENT":case "LIGHT_PATH":case "ATTRIBUTE":case "HOLDOUT":case "HAIR_INFO":case "OBJECT_INFO":case "SCRIPT":case "NEW_GEOMETRY":k=
ta(b);l=K(b);aa.warn(h+" node is not fully supported.");break;case "BRIGHTCONTRAST":case "ADD_SHADER":case "MIX_SHADER":k=ta(b);l=K(b);break;case "UVMAP":var u=b.uv_layer;u||(h="EMPTY_UV");if("EMPTY_UV"!=h){var p=J("param_"+h+"_a"),r=J("param_"+h+"_v");g.push(N(p));g.push(N(r));m.push(N(r));p={name:p,value:u}}l=K(b);break;case "UV_MERGED":p=J("param_UV_MERGED_a");r=J("param_UV_MERGED_v");g.push(N(p));g.push(N(r));l.push(R(b,"UV_geom"));l.push(R(b,"UV_cycles"));m.push(N(r));p={name:p,value:b.uv_layer};
break;case "CAMERA":k=[];l=K(b);break;case "COMBRGB":case "COMBHSV":k=ta(b);l=K(b);break;case "CURVE_RGB":case "CURVE_VEC":"CURVE_RGB"==h?(ka(b,0,0)&&n.push(["READ_R",1]),ka(b,1,0)&&n.push(["READ_G",1]),ka(b,2,0)&&n.push(["READ_B",1]),ka(b,3,0)&&n.push(["READ_A",1])):(ka(b,0,-1)&&n.push(["READ_R",1]),ka(b,1,-1)&&n.push(["READ_G",1]),ka(b,2,-1)&&n.push(["READ_B",1]));k=ta(b);l=K(b);p={value:b};break;case "PARTICLE_INFO":k=ta(b);l=K(b);for(r=0;r<b.outputs.length;r++){var t=b.outputs[r],v=t.identifier,
z=N("v_param_PART_INFO_"+v.replace(" ",""));if(t.is_linked)switch(v){case "Size":n.push(["PART_INFO_SIZE",T.F(1)]);break;case "Age":n.push(["PART_INFO_AGE",T.F(1)]);break;case "Lifetime":n.push(["PART_INFO_LT",T.F(1)]);break;case "Location":n.push(["PART_INFO_LOC",T.F(1)]);break;case "Index":p=u=N("a_param_PART_INFO_"+t.identifier.replace(" ",""));n.push(["PART_INFO_IND",T.F(1)]);break;case "Velocity":n.push(["PART_INFO_VEL",T.F(1)]);break;case "Angular Velocity":n.push(["PART_INFO_A_VEL",T.F(1)])}"Age"!=
v&&"Lifetime"!=v&&"Size"!=v&&(g.push(z),m.push(z))}u&&g.push(u);break;case "GEOMETRY":if(!Z(b))return!0;h=L(b,c);if(!h)return aa.error("Geometry output is not supported"),null;switch(h){case "GEOMETRY_UV":(u=b.uv_layer)||(h="EMPTY_UV");"EMPTY_UV"!=h&&(p=J("param_GEOMETRY_UV_a"),r=J("param_GEOMETRY_UV_v"),g.push(N(p)),g.push(N(r)),m.push(N(r)),p={name:p,value:u});l.push(R(b,"UV"));break;case "GEOMETRY_VC":(u=b.color_layer)||(h="EMPTY_VC");"EMPTY_VC"!=h&&(p=J("param_GEOMETRY_VC_a"),r=J("param_GEOMETRY_VC_v"),
g.push(N(p)),g.push(N(r)),m.push(N(r)),p={name:p,value:u});l.push(R(b,"Vertex Color"));break;case "GEOMETRY_NO":l.push(R(b,"Normal"));break;case "GEOMETRY_FB":l.push(R(b,"Front/Back"));break;case "GEOMETRY_VW":l.push(R(b,"View"));break;case "GEOMETRY_GL":l.push(R(b,"Global"));break;case "GEOMETRY_LO":l.push(R(b,"Local"));break;case "GEOMETRY_OR":u=J("param_GEOMETRY_OR_v"),g.push(N(u)),l.push(R(b,"Orco")),m.push(N(u))}break;case "TEX_COORD":if(!Z(b))return!0;h=O(b,c);if(!h)return aa.error("Texture coordinate output is not supported"),
null;switch(h){case "TEX_COORD_UV":(u=b.uv_layer)||(h="EMPTY_UV");"EMPTY_UV"!=h&&(p=J("param_TEX_COORD_UV_a"),r=J("param_TEX_COORD_UV_v"),g.push(N(p)),g.push(N(r)),m.push(N(r)),p={name:p,value:b.uv_layer});l.push(R(b,"UV"));break;case "TEX_COORD_NO":l.push(R(b,"Normal"));break;case "TEX_COORD_GE":u=J("param_TEX_COORD_GE_v");g.push(N(u));l.push(R(b,"Generated"));m.push(N(u));break;case "TEX_COORD_OB":l.push(R(b,"Object"));aa.warn('Output "Object" of node "Texture Coordinate" doesn\'t supported fully.');
break;case "TEX_COORD_CA":l.push(R(b,"Camera"));break;case "TEX_COORD_WI":l.push(R(b,"Window"));aa.warn('Output "Window" of node "Texture Coordinate" doesn\'t supported fully.');break;case "TEX_COORD_RE":l.push(R(b,"Reflection")),aa.warn('Output "Reflection" of node "Texture Coordinate" doesn\'t supported fully.')}break;case "GROUP":u=b.node_tree_name;switch(u){case "B4W_LINEAR_TO_SRGB":if(!E(b,[1],[1])){p=W(b,d,e);break}h="B4W_LINEAR_TO_SRGB";break;case "B4W_NORMAL_VIEW":case "B4W_VECTOR_VIEW":if(!E(b,
[1],[1])){p=W(b,d,e);break}h="B4W_VECTOR_VIEW";break;case "B4W_SRGB_TO_LINEAR":if(!E(b,[1],[1])){p=W(b,d,e);break}h="B4W_SRGB_TO_LINEAR";break;case "B4W_REFLECT":if(!E(b,[1,1],[1])){p=W(b,d,e);break}h="B4W_REFLECT";break;case "B4W_REFRACTION":if(!E(b,[1,0],[1])){p=W(b,d,e);break}h="B4W_REFRACTION";break;case "B4W_PARALLAX":if(!E(b,[1,1,0,0,0],[1])){p=W(b,d,e);break}h="B4W_PARALLAX";r=J("temp_texture");m.push(N(r));break;case "B4W_CLAMP":if(!E(b,[1],[1])){p=W(b,d,e);break}h="B4W_CLAMP";break;case "B4W_TRANSLUCENCY":if(!E(b,
[0,0,0,0,0],[0])){p=W(b,d,e);break}h="B4W_TRANSLUCENCY";break;case "B4W_TIME":if(!E(b,[],[0])){p=W(b,d,e);break}h="B4W_TIME";break;case "B4W_SMOOTHSTEP":if(!E(b,[0,0,0],[0])){p=W(b,d,e);break}h="B4W_SMOOTHSTEP";break;case "B4W_GLOW_OUTPUT":h="B4W_GLOW_OUTPUT";break;default:p=W(b,d,e)}k=ta(b);l=K(b);"B4W_TRANSLUCENCY"==u&&(u=Q("TranslucencyParams","TranslucencyParams",[0,0,0,0]),u.xc=l[0].xc,l.push(u));break;case "LAMP":p=b.lamp;if(!p)return aa.error("There is no lamp in node: "+b.name),null;l.push(R(b,
"Color"));l.push(R(b,"Light Vector"));l.push(R(b,"Distance"));l.push(R(b,"Visibility Factor"));p.uuid in Ha?n.push(["LAMP_INDEX",String(Ha[p.uuid])]):(Ha[p.uuid]=za,n.push(["LAMP_INDEX",String(za++)]));p=Ha;break;case "LIGHTING_AMBIENT":k=[Q("E","E",[0,0,0],!0),Q("A","A",[0,0,0],!0),Q("D","D",[0,0,0],!0)];l=[Q("color","color",[0,0,0],!0),Q("specular","specular",[0,0,0],!0)];break;case "LIGHTING_BEGIN":l=[Q("E","E",[0,0,0],!0),Q("A","A",[0,0,0],!0),Q("D","D",[0,0,0],!0),Q("S","S",[0,0,0],!0),Q("normal",
"normal",[0,0,0],!0),Q("dif_params","dif_params",[0,0],!0),Q("sp_params","sp_params",[0,0],!0),Q("shadow_factor","shadow_factor",0,!0),Q("translucency_color","translucency_color",0,!0),Q("translucency_params","translucency_params",[0,0,0,0],!0)];break;case "LIGHTING_END":k=[Q("color","color",[0,0,0],!0),Q("specular","specular",[0,0,0],!0)];break;case "LIGHTING_LAMP":k=[Q("shadow_factor","shadow_factor",0,!0)];l=[Q("ldir","ldir",[0,0,0],!0),Q("lfac","lfac",[0,0],!0),Q("lcolorint","lcolorint",[0,0,
0],!0),Q("norm_fac","norm_fac",0,!0)];break;case "DIFFUSE_LAMBERT":k=[Q("ldir","ldir",[0,0,0],!0),Q("lfac","lfac",[0,0],!0),Q("normal","normal",[0,0,0],!0),Q("norm_fac","norm_fac",0,!0)];l=[Q("lfactor","lfactor",0,!0)];n.push(["MAT_USE_TBN_SHADING",b.use_tangent_shading|0]);break;case "DIFFUSE_FRESNEL":case "DIFFUSE_MINNAERT":case "DIFFUSE_OREN_NAYAR":case "DIFFUSE_TOON":k=[Q("ldir","ldir",[0,0,0],!0),Q("lfac","lfac",[0,0],!0),Q("normal","normal",[0,0,0],!0),Q("norm_fac","norm_fac",0,!0),Q("dif_params",
"dif_params",[0,0],!0)];l=[Q("lfactor","lfactor",0,!0)];n.push(["MAT_USE_TBN_SHADING",b.use_tangent_shading|0]);break;case "SPECULAR_BLINN":case "SPECULAR_PHONG":k=[Q("ldir","ldir",[0,0,0],!0),Q("lfac","lfac",[0,0],!0),Q("normal","normal",[0,0,0],!0),Q("norm_fac","norm_fac",0,!0),Q("sp_params","sp_params",[0,0],!0)];l=[Q("sfactor","sfactor",0,!0)];n.push(["MAT_USE_TBN_SHADING",b.use_tangent_shading|0]);break;case "SPECULAR_TOON":case "SPECULAR_WARDISO":k=[Q("ldir","ldir",[0,0,0],!0),Q("lfac","lfac",
[0,0],!0),Q("normal","normal",[0,0,0],!0),Q("norm_fac","norm_fac",0,!0),Q("sp_params","sp_params",[0,0],!0)];l=[Q("sfactor","sfactor",0,!0)];n.push(["MAT_USE_TBN_SHADING",b.use_tangent_shading|0]);break;case "LIGHTING_APPLY":k=[Q("color","color",[0,0,0,0],!0),Q("specular","specular",[0,0,0],!0),Q("lfactor","lfactor",0,!0),Q("sfactor","sfactor",0,!0),Q("ldir","ldir",[0,0,0],!0),Q("normal","normal",[0,0,0],!0),Q("translucency_params","translucency_params",[0,0,0,0],!0),Q("D","D",[0,0,0],!0),Q("S","S",
[0,0,0],!0),Q("lcolorint","lcolorint",[0,0,0],!0),Q("translucency_color","translucency_color",0,!0)];l=[Q("color","color",[0,0,0,0],!0),Q("specular","specular",[0,0,0],!0)];break;case "NORMAL":k=ta(b);l=K(b);u=R(b,"Normal");m.push(N(J("param_NORMAL_Normal"),u.jb,3));break;case "MAPPING":u=b.vector_type;h="MAPPING";k.push(ga(b,"Vector"));l.push(R(b,"Vector"));var r=la.f32(b.rotation),t=la.f32(b.scale),v=la.f32(b.translation),z=ua.create(),q=la.ZI(r);"TEXTURE"==u&&(t[0]=t[0]||1,t[1]=t[1]||1,t[2]=t[2]||
1);var w=new Float32Array([t[0],0,0,0,t[1],0,0,0,t[2]]);ua.multiply(q,w,z);z=la.qL(z,ia.create());switch(u){case "POINT":z[12]=v[0];z[13]=v[1];z[14]=v[2];break;case "TEXTURE":z[12]=v[0];z[13]=v[1];z[14]=v[2];z=ia.invert(z,z);break;case "NORMAL":ia.invert(z,z),ia.transpose(z,z)}switch(u){case "NORMAL":n.push(["MAPPING_IS_NORMAL",1]);case "TEXTURE":n.push(["MAPPING_TRS_MATRIX_DEF",1]);n.push(["MAPPING_TRS_MATRIX",T.F(z,16)]);break;case "POINT":0!==ma.length(r)?(n.push(["MAPPING_TRS_MATRIX_DEF",1]),
n.push(["MAPPING_TRS_MATRIX",T.F(z,16)])):(0!==ma.length(t)&&(n.push(["MAPPING_SCALE_DEF",1]),n.push(["MAPPING_SCALE",T.F(t,3)])),0!==ma.length(v)&&(n.push(["MAPPING_TRANS_DEF",1]),n.push(["MAPPING_TRANS",T.F(v,3)])));break;case "VECTOR":0!==ma.length(r)?(n.push(["MAPPING_TRS_MATRIX_DEF",1]),n.push(["MAPPING_TRS_MATRIX",T.F(z,16)])):0!==ma.length(t)&&(n.push(["MAPPING_SCALE_DEF",1]),n.push(["MAPPING_SCALE",T.F(t,3)]))}b.use_min&&(n.push(["MAPPING_MIN_CLIP_DEF",1]),n.push(["MAPPING_MIN_CLIP",T.F(b.min,
3)]));b.use_max&&(n.push(["MAPPING_MAX_CLIP_DEF",1]),n.push(["MAPPING_MAX_CLIP",T.F(b.max,3)]));break;case "MATERIAL":case "MATERIAL_EXT":p=[];u=[];r=[];t=[Q("E","E",[0,0,0],!0),Q("A","A",[0,0,0],!0),Q("D","D",[0,0,0],!0),Q("S","S",[0,0,0],!0),Q("normal","normal",[0,0,0],!0),Q("dif_params","dif_params",[0,0],!0),Q("sp_params","sp_params",[0,0],!0),Q("shadow_factor","shadow_factor",0,!0)];v=[Q("color","color",[0,0,0],!0),Q("specular","specular",[0,0,0],!0),Q("normal","normal",[0,0,0],!0)];z=[R(b,"Color"),
R(b,"Alpha"),R(b,"Normal")];q=[];w=ga(b,"Color");w.jb.splice(3);r.push(w);k.push(w);w=ga(b,"Spec");w.jb.splice(3);r.push(w);k.push(w);(w=ga(b,"DiffuseIntensity"))||(w=ga(b,"Refl"));w.jb=b.diffuse_intensity;r.push(w);k.push(w);var y=ga(b,"Normal");y.jb.splice(3);r.push(y);k.push(y);"MATERIAL_EXT"==h?((w=ga(b,"Emit"))||(w=Q("Emit","Emit",0)),r.push(w),k.push(w),(w=ga(b,"Translucency"))?(w.jb=0,w.name="Translucency",w.identifier="Translucency"):w=Q("Translucency","Translucency",0),k.push(w),(w=ga(b,
"Translucency"))?(w.jb=[0,0,0,0],w.name="TranslucencyParams",w.identifier="TranslucencyParams"):w=Q("TranslucencyParams","TranslucencyParams",[0,0,0,0]),k.push(w),l=ga(b,"Reflectivity"),w=ga(b,"Ray Mirror"),l?(w=l,l="Reflectivity"):w?l="Ray Mirror":(w=l,l="Reflectivity"),w||(w=Q(l,l,0)),k.push(w),v.push(w),(w=ga(b,"SpecTra"))||(w=Q("SpecTra","SpecTra",0)),k.push(w),v.push(w),(w=ga(b,"Alpha"))||(w=Q("Alpha","Alpha",b.alpha)),k.push(w),v.push(w),z.push(R(b,"Diffuse")),z.push(R(b,"Spec")),p.push(["MATERIAL_EXT",
1]),u.push(["MATERIAL_EXT",1])):(r.push(Q("emit_intensity","emit_intensity",0)),v.push(Q("reflect_factor","reflect_factor",0)),v.push(Q("specular_alpha","specular_alpha",0)),v.push(Q("alpha_in","alpha_in",0)),z.push(Q("diffuse_out","diffuse_out",0)),z.push(Q("spec_out","spec_out",0)),p.push(["MATERIAL_EXT",0]),u.push(["MATERIAL_EXT",0]));q.push(N(J("param_MATERIAL_alpha"),b.alpha));q.push(N(J("param_MATERIAL_spec_alpha"),b.specular_alpha));l=z;p.push(["USE_MATERIAL_NORMAL",y.xc|0]);b.use_diffuse&&
(p.push(["USE_MATERIAL_DIFFUSE",1]),u.push(["USE_MATERIAL_DIFFUSE",1]));b.use_specular&&u.push(["USE_MATERIAL_SPECULAR",1]);var w=[],x=0;switch(b.specular_shader){case "COOKTORR":case "PHONG":y=b.specular_hardness;break;case "WARDISO":y=b.specular_slope;break;case "TOON":y=b.specular_toon_size;x=b.specular_toon_smooth;break;case "BLINN":y=b.specular_ior;x=b.specular_hardness;break;default:aa.error("unsupported specular shader: "+b.specular_shader+' (material "'+b.material_name+'")'),y=b.specular_hardness}var A,
B;switch(b.diffuse_shader){case "LAMBERT":B=A=0;break;case "OREN_NAYAR":A=b.roughness;B=0;break;case "FRESNEL":A=b.diffuse_fresnel;B=b.diffuse_fresnel_factor;break;case "MINNAERT":A=b.darkness;B=0;break;case "TOON":A=b.diffuse_toon_size;B=b.diffuse_toon_smooth;break;default:aa.error("unsupported diffuse shader: "+b.diffuse_shader+' (material "'+b.material_name+'")'),B=A=0}w.push(N(J("param_MATERIAL_diffuse"),[A,B],2));w.push(N(J("param_MATERIAL_spec"),[b.specular_intensity,y,x],3));p.push(["SHADELESS_MAT",
b.use_shadeless?1:0]);y={name:b.name,value:{vm:b.specular_shader,Un:b.diffuse_shader,Qd:b.use_shadeless,Vk:b.use_tangent_shading}};p={name:b.name,value:{vm:b.specular_shader,Un:b.diffuse_shader,Qd:b.use_shadeless,Vk:b.use_tangent_shading},rL:{name:"material_begin",type:"MATERIAL_BEGIN",K:r,Ya:t,V:w,data:y,Rb:p,nj:[]},sL:{name:"material_end",type:"MATERIAL_END",K:v,Ya:z,V:q,data:y,Rb:u,nj:[]}};break;case "MATH":switch(b.operation){case "ADD":h="MATH_ADD";break;case "SUBTRACT":h="MATH_SUBTRACT";break;
case "MULTIPLY":h="MATH_MULTIPLY";break;case "DIVIDE":h="MATH_DIVIDE";break;case "SINE":h="MATH_SINE";break;case "COSINE":h="MATH_COSINE";break;case "TANGENT":h="MATH_TANGENT";break;case "ARCSINE":h="MATH_ARCSINE";break;case "ARCCOSINE":h="MATH_ARCCOSINE";break;case "ARCTANGENT":h="MATH_ARCTANGENT";break;case "POWER":h="MATH_POWER";break;case "LOGARITHM":h="MATH_LOGARITHM";break;case "MINIMUM":h="MATH_MINIMUM";break;case "MAXIMUM":h="MATH_MAXIMUM";break;case "ROUND":h="MATH_ROUND";break;case "LESS_THAN":h=
"MATH_LESS_THAN";break;case "GREATER_THAN":h="MATH_GREATER_THAN";break;case "MODULO":h="MATH_MODULO";break;case "ABSOLUTE":h="MATH_ABSOLUTE";break;default:return aa.error("Unsupported MATH operation: "+b.operation),null}n.push(["MATH_USE_CLAMP",Number(b.use_clamp)]);k=ta(b);l=K(b);break;case "MIX_RGB":switch(b.blend_type){case "MIX":h="MIX_RGB_MIX";break;case "ADD":h="MIX_RGB_ADD";break;case "MULTIPLY":h="MIX_RGB_MULTIPLY";break;case "SUBTRACT":h="MIX_RGB_SUBTRACT";break;case "SCREEN":h="MIX_RGB_SCREEN";
break;case "DIVIDE":h="MIX_RGB_DIVIDE";break;case "DIFFERENCE":h="MIX_RGB_DIFFERENCE";break;case "DARKEN":h="MIX_RGB_DARKEN";break;case "LIGHTEN":h="MIX_RGB_LIGHTEN";break;case "OVERLAY":h="MIX_RGB_OVERLAY";break;case "DODGE":h="MIX_RGB_DODGE";break;case "BURN":h="MIX_RGB_BURN";break;case "HUE":h="MIX_RGB_HUE";break;case "SATURATION":h="MIX_RGB_SATURATION";break;case "VALUE":h="MIX_RGB_VALUE";break;case "COLOR":h="MIX_RGB_COLOR";break;case "SOFT_LIGHT":h="MIX_RGB_SOFT_LIGHT";break;case "LINEAR_LIGHT":h=
"MIX_RGB_LINEAR_LIGHT";break;default:return aa.error("Unsupported MIX_RGB blend type: "+b.blend_type),null}n.push(["MIX_RGB_USE_CLAMP",Number(b.use_clamp)]);k=ta(b);l=K(b);break;case "OUTPUT":k=ta(b);l=[];break;case "RGB":u=b.name;u={name:"-1",value:u};m.push(u);l.push(R(b,"Color"));break;case "SEPRGB":case "SEPHSV":k=ta(b);l=K(b);break;case "TEXTURE":h=U(b);if("TEXTURE_EMPTY"==h)l.push(R(b,"Color")),l.push(R(b,"Normal")),l.push(R(b,"Value"));else if("TEXTURE_ENVIRONMENT"==h)k.push(ga(b,"Vector")),
l.push(R(b,"Color")),l.push(R(b,"Value"));else{if("TEXTURE_NORMAL"==h&&"ENVIRONMENT_MAP"==b.texture.type)return aa.error("Wrong output for ENVIRONMENT_MAP texture: "+b.name),null;"TEXTURE_COLOR"==h&&(p=!1,(u=b.texture.image)&&"Non-Color"==u.colorspace_settings_name&&(p=!0),n.push(["NON_COLOR",Number(p)]));for(p=0;4>p;++p)p?(w=Q("Vector"+p,"Vector"+p,[0,0,0]),"TEXTURE_COLOR"==h&&(r=Q("Color"+p,"Color"+p,[0,0,0]),t=Q("Value"+p,"Value"+p,0)),"TEXTURE_NORMAL"==h&&(r=Q("Normal"+p,"Normal"+p,[0,0,0]),t=
Q("Value"+p,"Value"+p,0))):(w=ga(b,"Vector"),"TEXTURE_COLOR"==h&&(r=R(b,"Color"),t=R(b,"Value")),"TEXTURE_NORMAL"==h&&(r=R(b,"Normal"),t=R(b,"Value"))),k.push(w),l.push(r),l.push(t)}r=J("param_TEXTURE_texture");m.push(N(r));p={name:r,value:b.texture};break;case "VALTORGB":k=ta(b);l=K(b);p={value:b};u=b.color_ramp.interpolation;"CONSTANT"!=u&&"LINEAR"!=u&&aa.warn("Color Ramp node is not fully supported.");break;case "VALUE":h="VALUE";u=b.name;u={name:"-1",value:u};m.push(u);l.push(R(b,"Value"));break;
case "VECT_MATH":switch(b.operation){case "ADD":h="VECT_MATH_ADD";break;case "SUBTRACT":h="VECT_MATH_SUBTRACT";break;case "AVERAGE":h="VECT_MATH_AVERAGE";break;case "DOT_PRODUCT":h="VECT_MATH_DOT_PRODUCT";break;case "CROSS_PRODUCT":h="VECT_MATH_CROSS_PRODUCT";break;case "NORMALIZE":h="VECT_MATH_NORMALIZE";break;default:return aa.error("Unsupported VECT_MATH operation: "+b.operation),null}k=ta(b);l=K(b);break;case "VECT_TRANSFORM":switch(b.vector_type){case "POINT":n.push(["VECTOR_TYPE",T.F(0)]);break;
case "VECTOR":n.push(["VECTOR_TYPE",T.F(1)]);break;case "NORMAL":n.push(["VECTOR_TYPE",T.F(2)]);break;default:return aa.error("Unsupported VECT_TRANSFORM vector_type: "+b.vector_type),null}k=b.convert_from;l=b.convert_to;u=0;if("WORLD"==k)if("WORLD"==l)u=0;else if("OBJECT"==l)u=1;else if("CAMERA"==l)u=2;else return aa.error("Unsupported VECT_TRANSFORM convert_to: "+b.convert_to),null;else if("OBJECT"==k)if("WORLD"==l)u=3;else if("OBJECT"==l)u=4;else if("CAMERA"==l)u=5;else return aa.error("Unsupported VECT_TRANSFORM convert_to: "+
b.convert_to),null;else if("CAMERA"==k)if("WORLD"==l)u=6;else if("OBJECT"==l)u=7;else if("CAMERA"==l)u=8;else return aa.error("Unsupported VECT_TRANSFORM convert_to: "+b.convert_to),null;else return aa.error("Unsupported VECT_TRANSFORM convert_from: "+b.convert_from),null;n.push(["CONVERT_TYPE",T.F(u)]);k=ta(b);l=K(b);break;case "NORMAL_MAP":u=0;switch(b.space){case "TANGENT":u=0;break;case "OBJECT":u=1;break;case "WORLD":u=2;break;case "BLENDER_OBJECT":u=3;break;case "BLENDER_WORLD":u=4;break;default:return aa.error("Unsupported NORMAL_MAP space: "+
b.space),null}n.push(["SPACE",T.F(u)]);k.push(ga(b,"Strength"));k.push(ga(b,"Color"));l.push(R(b,"Normal"));break;default:k=ta(b),l=K(b)}h={name:f,type:h,nj:g,K:k,Ya:l,V:m,data:p,Rb:n};f=V.lo(a);V.ol(a,V.lo(a),h);if(!(h="GEOMETRY"!=b.type&&"TEX_COORD"!=b.type)){a:{h=b.outputs;for(m=g=0;m<h.length;m++)if(h[m].is_linked&&g++>c){h=!0;break a}h=!1}h=!h}return h||null!=M(a,b,++c,d,e)?f:null}function E(a,b,c){for(var d=a.inputs,e=a.outputs,f=a.node_tree_name,h=0;h<b.length;h++){var g=d[h],k=b[h];if(!g||
g.default_value instanceof Array!=k)return aa.warn('Wrong inputs for custom node group "'+a.name+'" of type: "',f,'".Processing as general node group.'),!1}for(h=0;h<c.length;h++)if(b=e[h],d=c[h],!b||b.default_value instanceof Array!=d)return aa.warn('Wrong outputs for custom node group "'+a.name+'" of type: "',f,'".Processing as general node group.'),!1;return!0}function W(a,b,c){var d=a.node_group.node_tree,f={},h;for(h in d)if("links"==h||"nodes"==h){f[h]=[];for(var g=0;g<d[h].length;g++){f[h][g]=
{};for(var k in d[h][g])if("links"==h){f[h][g][k]={};for(var m in d[h][g][k])f[h][g][k][m]=G(d[h][g][k][m])}else f[h][g][k]=G(d[h][g][k])}}else f[h]=G(d[h]);d=a.node_tree_name;if("B4W_REPLACE"==d||"B4W_LEVELS_OF_QUALITY"==d)h=l("Group input","GROUP_INPUT",[],a.inputs),g=l("Group output","GROUP_OUTPUT",a.outputs,[]),k=null,k="B4W_REPLACE"==d||"B4W_LEVELS_OF_QUALITY"==d&&(Ga.quality==Aa.P_LOW||Ga.Du)?{from_node:h,from_socket:h.outputs[1],to_node:g,to_socket:g.inputs[0]}:{from_node:h,from_socket:h.outputs[0],
to_node:g,to_socket:g.inputs[0]},f.nodes=[h,g],f.links=[k];d=a.name;h=f.nodes;g=f.links;for(k=0;k<h.length;k++)h[k].name=qa(h[k].type,d,h[k].name);for(k=0;k<g.length;k++)g[k].from_node.name=qa(g[k].from_node.type,d,g[k].from_node.name),g[k].to_node.name=qa(g[k].to_node.type,d,g[k].to_node.name);return{GL:e(f,a.node_group.uuid,!0,b,c).Pa,HL:f.links}}function G(a){var b=typeof a;return"string"!=b&&"number"!=b&&"boolean"!=b&&a?la.Fn(a):a}function J(a){X[a]||(X[a]=0);var b=a+"_"+X[a],b=b.replace(/ /g,
"_").replace(/\//g,"_");X[a]++;return b}function Z(a){a=a.outputs;for(var b=0;b<a.length;b++)if(a[b].is_linked)return!0;return!1}function L(a,b){for(var c=a.outputs,d=0,e=0;e<c.length;e++){var f=c[e];if(f.is_linked&&!(d++<b))switch(f.identifier){case "UV":return"GEOMETRY_UV";case "Vertex Color":return"GEOMETRY_VC";case "Normal":return"GEOMETRY_NO";case "Front/Back":return"GEOMETRY_FB";case "View":return"GEOMETRY_VW";case "Global":return"GEOMETRY_GL";case "Local":return"GEOMETRY_LO";case "Orco":return"GEOMETRY_OR";
default:return null}}}function O(a,b){for(var c=a.outputs,d=0,e=0;e<c.length;e++){var f=c[e];if(f.is_linked&&!(d++<b))switch(f.identifier){case "Camera":return"TEX_COORD_CA";case "Generated":return"TEX_COORD_GE";case "Normal":return"TEX_COORD_NO";case "Object":return"TEX_COORD_OB";case "Reflection":return"TEX_COORD_RE";case "UV":return"TEX_COORD_UV";case "Window":return"TEX_COORD_WI";default:return null}}}function U(a){if(!a.texture)return"TEXTURE_EMPTY";for(var b=a.outputs,c=!1,d=!1,e=!1,f=0;f<b.length;f++){var h=
b[f];if(h.is_linked)switch(h.identifier){case "Color":c=!0;break;case "Normal":d=!0;break;case "Value":e=!0;break;default:la.r("Unknown texture output")}}if(c)return d&&aa.warn('Node "'+a.name+'" has both Color and Normal outputs. Normal will be omitted'),"ENVIRONMENT_MAP"==a.texture.type?"TEXTURE_ENVIRONMENT":"TEXTURE_COLOR";if(d)return"TEXTURE_NORMAL";if(e)return"ENVIRONMENT_MAP"==a.texture.type?"TEXTURE_ENVIRONMENT":"TEXTURE_COLOR"}function ga(a,b){for(var c=a.inputs,d=0;d<c.length;d++){var e=
c[d];if(e.identifier==b)return ca(e)}return null}function R(a,b){for(var c=a.outputs,d=0;d<c.length;d++){var e=c[d];if(e.identifier==b)return ca(e)}return null}function ca(a){var b=a.name,c=a.identifier,d=a.is_linked;a=a.default_value;a=la.is_vector(a)?a.slice(0):a;return{name:b,identifier:c,xc:d,jb:a}}function Q(a,b,c,d){return{name:a,identifier:b,xc:d||!1,jb:c}}function ta(a){for(var b=[],c=0;c<a.inputs.length;c++){var d=ca(a.inputs[c]);d.jb.length&&d.jb.splice(3);b.push(d)}return b}function K(a){for(var b=
[],c=0;c<a.outputs.length;c++){var d=ca(a.outputs[c]);b.push(d)}return b}function N(a,b,c){b=null===b||void 0===b?null:T.F(b,c);return{name:a,value:b}}function ha(a,b,c,d,e,f){var h=[],g=f.from_socket.identifier;f=f.to_socket.identifier;var k=d.Ya;for(d=0;d<k.length;d++)if(k[d].identifier==g){h.push(d);break}e=e.K;for(d=0;d<e.length;d++)if(e[d].identifier==f){h.push(d);break}2==h.length&&V.rd(a,b,c,h);return!0}function qa(a,b,c){return"GROUP_INPUT"==a?b+"*GI*"+c:"GROUP_OUTPUT"==a?b+"*GO*"+c:b+"%join%"+
c}function na(a){var b=[];V.na(a,function(a,c){"GROUP"==c.type&&b.push(c)});return b}function ra(a,b,c){for(var d=0;d<c.length;d++){var e=c[d].data.GL,f=c[d].data.HL;if(!e)return!1;V.na(e,function(b,c){V.ol(a,V.lo(a),c)});for(e=0;e<f.length;e++)b.push(f[e]);I(c[d],b,a)}return!0}function sa(a,b,c,d,e,f){switch(a.type){case "GROUP":a.name==b&&d.push(c);break;case "GROUP_INPUT":a.name.indexOf(b+"*GI*")||e.push(c);break;case "GROUP_OUTPUT":a.name.indexOf(b+"*GO*")||f.push(c)}}function ea(a,b,c){for(var d=
[],e=0;e<c.length;e++){for(var f=c[e],h=null,g=0;g<b.length;g++)if(f.from_socket.identifier==b[g].to_socket.identifier){h=b[g];break}h?(f.from_node=h.from_node,f.from_socket=h.from_socket):d.push(f)}for(e=0;e<b.length;e++)a.splice(a.indexOf(b[e]),1);return d}function oa(a,b){if(b.length)for(var c=b[0].from_node.name,d=0;d<a.length;d++)a[d].from_node.name==c&&b.push(a[d])}function pa(a,b,c,d){for(var e=0;e<d.length;e++){for(var f=d[e],h,g=0;g<c.K.length;g++)if(f.from_socket.identifier==c.K[g].identifier){h=
c.K[g].jb;break}for(var g=f,l=b,m=h,p=k(g.to_node,l),n=0;n<p.length;n++)for(var u=V.Sa(l,p[n]),r=0;r<u.K.length;r++){var t=u.K[r];if(t.identifier==g.to_socket.identifier){u=t.jb instanceof Object?0:1;if((m instanceof Object?0:1)==u)t.jb=m;else switch(u){case 0:t=t.jb;t[0]=t[1]=t[2]=m;break;case 1:t.jb=(m[0]+m[1]+m[2])/3}break}}f=a.indexOf(f);-1!=f&&a.splice(f,1)}}function I(a,b,c){for(var d=a.name,e=[],f=[],h=[],g=[],k=0;k<b.length;k++){var l=b[k];sa(l.from_node,d,l,e,h,g);sa(l.to_node,d,l,f,h,g)}f=
ea(b,f,h);e=ea(b,g,e);oa(b,f);pa(b,c,a,f);if(e.length){var m;V.na(c,function(a,b){"GROUP_OUTPUT"!=b.type||b.name.indexOf(d+"*GO*")||(m=b)});pa(b,c,m,e)}}function Ea(a){var b=[],c=[];V.na(a,function(a,d){switch(d.type){case "VALTORGB":b.push(d);break;case "CURVE_VEC":case "CURVE_RGB":c.push(d)}});var d=0,e=a=null,f=b.length+c.length;if(b.length){a=va.vH(b,va.xD);for(var h=0;h<b.length;h++)b[h].Rb.push(["NODE_TEX_ROW",T.F((d+.5)/f)]),d++}if(c.length)for(e=va.tI(c,va.xx),h=0;h<c.length;h++)c[h].Rb.push(["NODE_TEX_ROW",
T.F((d+.5)/f)]),d++;h=null;a&&e?(h=new Uint8Array(a.length+e.length),h.set(a),h.set(e,a.length)):h=a?a:e;a=h?va.Mz(h,va.xx):null;for(h=0;h<b.length;h++)b[h].data.Na=a;for(h=0;h<c.length;h++)c[h].data.Na=a}function ka(a,b,c){a=a.curve_mapping.curves_data[b];return 2==a.length&&a[0][0]<c+.01&&a[0][1]<c+.01&&.99<a[1][0]&&.99<a[1][1]?!1:!0}var Aa=q("__config");q("__debug");var V=q("__graph"),ua=q("__mat3"),ia=q("__mat4"),Y=q("__objects"),aa=q("__print"),T=q("__shaders"),xa=q("__scenes"),la=q("__util"),
ma=q("__vec3"),va=q("__textures"),X={},ya={},Fa={},Ha={},za=0;new Float32Array(4);var Ga=Aa.v;a.VP=0;a.uF=1;a.tF=2;a.sF=3;a.UP=4;a.rF=5;a.qF=6;a.pF=7;a.TP=8;a.eE=0;a.dE=1;a.PP=2;a.cE=3;a.OP=4;a.Zz=function(a){return ya[a]};a.gH=function(a){delete ya[a]};a.nH=e;a.du=function(a,c,d){var e=xa.get_active();a=f(a,"MAIN",e.uuid);if(a in Fa)return Fa[a];var e=V.create(),h={name:"LIGHTING_BEGIN",type:"LIGHTING_BEGIN"},g=M(e,h,0,c,null),h={name:"LIGHTING_END",type:"LIGHTING_END"},h=M(e,h,0,c,null);b(e,d,g,
h,[[g,[8,10]],[g,[9,6]]],c);m(e);return Fa[a]=e};a.mq=function(a){var b=[],c={};X={};var d=V.Tw(a);V.na(d,function(a,d){var e;e=[];for(var f=[],h=[],g=[],k=[],l=[],m=0;m<d.K.length;m++){var p=d.K[m];if(p.xc)e.push(null),f.push(null);else{e.push(J("in_"+d.type+"_"+p.identifier.replace(/\./g,"")));var n=T.F(p.jb,0);Ga.rw&&(0<=d.type.indexOf("MIX_RGB_")&&("Color1"==p.identifier||"Color2"==p.identifier||"Fac"==p.identifier)||0<=d.type.indexOf("MATH_")&&("Value"==p.identifier||"Value_001"==p.identifier)||
0<=d.type.indexOf("VECT_MATH_")&&"Vector_001"==p.identifier||0<=d.type.indexOf("LIGHTING_APPLY")||0<=d.type.indexOf("MATERIAL_END")||0<=d.type.indexOf("MATERIAL_BEGIN"))&&(p=n,p=p.replace(/(,)/g,"$1 "),p=p.replace(/(^|[^0-9]|\s)(0\.0)($|[^0-9]|\s)/g,"$1_0_0$3"),p=p.replace(/(^|[^0-9]|\s)(1\.0)($|[^0-9]|\s)/g,"$1_1_0$3"),n=p=p.replace(/\s+/g,""));f.push(n)}}for(m=0;m<d.Ya.length;m++)p=d.Ya[m],p.xc?h.push(null):h.push(J("out_"+d.type+"_"+p.identifier.replace(/\./g,"")));for(m=0;m<d.V.length;m++)p=d.V[m],
g.push(p.name),k.push(p.value);for(m=0;m<d.nj.length;m++)l.push(d.nj[m].name);e={id:d.type,K:e,Zu:f,Ya:h,V:g,Vr:k,nj:l,Rb:JSON.parse(JSON.stringify(d.Rb))};b.push(e);c[a]=e});V.ig(d,function(a,b,e){var f=V.Sa(d,a);V.Sa(d,b);var h=f.Ya[e[0]];a=c[a].Ya;b=c[b].K;f=a[e[0]]||J("out_"+f.type+"_"+h.identifier.replace(/\./g,""));a[e[0]]=f;b[e[1]]=f});return b};a.Gy=function(a){if(a.node_tree)for(var b=0;b<a.node_tree.nodes.length;b++){var c=a.node_tree.nodes[b];if("GROUP"==c.type&&"B4W_GLOW_OUTPUT"==c.node_tree_name)return!0}return!1};
a.cleanup=function(){for(var a in ya)delete ya[a];for(a in Fa)delete Fa[a];for(var b in Ha)delete Ha[b];za=0}};b4w.module.__animation=function(a,q){function e(a,b){var c=a.X[b];c&&c.Cu&&c.bo&&(c.bo=!1,c.Cu(a,b))}function c(a,b,c){c=a.X[c];c.type=30;var d=b.ma,e=b.Oa-d+1;c.start=d;c.length=e;c.He=d;c.eh=b.name;for(e=d=0;e<a.yc.length;e++){var f=a.yc[e];if(f==b)break;else d+=f.Oa-f.ma+1}c.fD=d}function b(a,b){a.type=50;a.eh=b.name;a.start=b.ma;a.length=b.Oa-a.start;b.cyclic||(a.length+=b.gv)}function n(a){return a.replace(/_B4W_BAKED$/,"")}function f(a,b){return{gm:a,action:b}}function t(a,b,c){if(a.animation_data){var d=
a.animation_data.action;d&&60==d.q.type&&b.push(f(c,d))}a=a.nodes;for(d=0;d<a.length;d++){var e=a[d];if(e.node_group){var h=e.node_group.node_tree;if(h){var g=c.slice();g.push(e.name);t(h,b,g)}}}}function g(a){return ca.is_mesh(a)&&a.k.yc?!0:!1}function m(a,b,c){var d=a.X;if(-1==c)for(c=0;8>c;c++){var e=d[c];e&&(e.He=b,x(a,0,c,!0))}else if(e=d[c])e.He=b,x(a,0,c,!0)}function v(a,b,c){if(-1==b)for(b=0;8>b;b++){var d=a[b];d&&c(d)}else(d=a[b])&&c(d)}function x(a,b,c,d){y(a,b,c,d);e(a,c);a.k.dh&&(w(a,
b),H(a,b))}function d(a,b,c,d){var e=c.frame_range;if(e[0]>e[1])return K.warn('Incompatible action "'+c.name+'" has been applied to object "'+a.name+'"'),!1;var f=c.q,g=a.X[d];g.eh=c.name;g.xt=e;g.Ux=f.qB;g.Sx=f.ly;g.hh.set(f.hh);g.start=e[0];g.length=e[1]-e[0];g.He=e[0];switch(f.type){case 10:if(ca.is_armature(a)){g.type=10;var l=k(a,b,c);if(!l){for(var l=a.k.Zd,e=[],m=[],p=c.q.Jv,n=0;n<p;n++){for(var t in l){var v=l[t],z=v.Is,q=c.q.Jt[t];q?oa.copy(q.subarray(8*n,8*n+8),z):oa.identity(z);v.Js=!1}v=
h(l);e.push(v.trans);m.push(v.hb)}l={trans:e,hb:m};r(a,b,c,l)}g.trans=l.trans;g.hb=l.hb;b=l;g=a.k;l=g.tm;e=a.X[d];t=e.vw;a:{m=g.us;for(p=0;p<m.length;p+=2)if(c==m[p]){m=m[p+1];break a}m=null}if(m)e.vw=m;else{for(e=0;e<l.length;e++){m=l[e].ii;p=[];n=[];v=b.trans;z=b.hb;for(q=0;q<v.length;q++){var w=u(v[q],z[q],m);p.push(w.trans);n.push(w.hb)}t.push({trans:p,hb:n})}g.us.push(c,t)}g.dh&&(c=g.Lm,d>c[1]?(b=c[1],c[1]=d,c[0]=b):d>c[0]&&d<c[1]&&(c[0]=d),C(a))}break;case 40:ca.is_speaker(a)&&(g.volume=f.V.volume||
null,g.pitch=f.V.pitch||null,g.type=40);break;case 70:ca.is_lamp(a)&&(g.color=f.V.color||null,g.Je=f.V.energy||null,g.type=70);break;case 60:if("MESH"==a.type){g.type=60;t=k(a,b,c);if(!t){t=[];e=[];m=[];p=[];n=[];v=c.q;z=b?b[0]:null;for(l in v.V){q=b;w=l.match(/"(.*?)"/)[1];if(q&&1<q.length){for(var y=q[1],x=2;x<q.length;x++)y=y+"%join%"+q[x];y+="%join%"+w}else y=w;q=y;for(w=0;w<a.D.length;w++)for(y=a.D[w].U,x=0;x<y.length;x++){var A=y[x];if(!z||-1!=A.cc.indexOf(z)){var O=A.Wf,aa=F(l,q,v,e,t,A.Xf),
O=F(l,q,v,p,m,O);(aa||O)&&n.push(A)}}}t={bP:t,values:e,uM:m,vM:p,Nr:n};r(a,b,c,t)}g.Xf=t.bP;g.cB=t.values;g.Wf=t.uM;g.bB=t.vM;g.Nr=t.Nr}break;case 20:if(l=f.V.tsr){g.type=20;t=k(a,b,c);if(!t){t=c.q.Jv;e=[];m=[];for(p=0;p<t;p++)e.push(l.subarray(8*p,8*p+4)),m.push(l.subarray(8*p+4,8*p+8));t={trans:e,hb:m};r(a,b,c,t)}g.trans=t.trans;g.hb=t.hb;Q.hm(a)&&Q.JO(a,g.trans[0],g.hb[0])}else return K.warn('Incompatible action "'+c.name+'" has been applied to object "'+a.name+'"'),!1;break;case 80:ca.is_world(a)&&
(g.Je=f.V["light_settings.environment_energy"]||null,g.Pe=f.V.horizon_color||null,g.cf=f.V.zenith_color||null,g.Cz=f.V["mist_settings.intensity"]||null,g.Az=f.V["mist_settings.depth"]||null,g.Dz=f.V["mist_settings.start"]||null,g.Bz=f.V["mist_settings.height"]||null,g.zz=f.V.b4w_fog_color||null,g.type=80)}ca.is_armature(a)&&10!=f.type&&B(a,d);return!0}function k(a,b,c){a=a.Up;b=b?b.join("%join%"):null;for(var d=0;d<a.length;d+=3)if(c==a[d]&&b==a[d+1])return a[d+2];return null}function r(a,b,c,d){a.Up.push(c,
b?b.join("%join%"):null,d)}function C(a){var b=a.k.Lm;if(-1!=b[0]&&-1!=b[1]){var c=a.X;a=c[b[1]].He;var d=Math.floor(a),e=a-d,b=c[b[0]];a=b.He;d=Math.floor(a);b.He=d+e}}function B(a,b){var c=a.k.Lm,d=c[1];c[0]=-1;c[1]=-1;if(-1!=b)for(var e=a.X;0<=d;d--){var f=e[d];if(f&&10==f.type)if(d>c[1])c[1]=d;else{d>c[0]&&(c[1]=d);break}}}function F(a,b,c,d,e,f){if(!f)return!1;for(var h=!1,g=0;g<f.length;g+=2)b==f[g]&&(e.push(f[g+1]),d.push(new Float32Array(c.V[a])),h=!0);return h}function D(a){a=a.q;for(var b in a.V)if(-1!=
b.indexOf("nodes"))return!0;return!1}function y(a,b,c,d){if((c=a.X[c])&&null!=c.type&&(c.play||d)){var e=a.k,f=c.He,h=c.start,g=c.length,f=f+c.speed*b*sa.Pc(),k=c.type,l=c.speed;if(0<=l&&f>=h+g||0>l&&f<h)switch(d||(c.bo=!0),c.behavior){case 10:f=0<=l?(f-h)%g+h:h+g-1E-6;break;case 20:f=0<=l?h:h+g-1E-6;c.play=!1;break;case 30:f=0<=l?h+g-1E-6:h,c.play=!1}c.He=f;switch(k){case 10:if(!e.dh){d=A(c);b=d[0];var m=d[1];d=d[2];e.zd=c.hb[b];e.Od=c.hb[m];e.Cd=c.trans[b];e.Pd=c.trans[m];e.ge=d;d=e.tm;c=c.vw;for(var p=
0;p<d.length;p++){var n=d[p],u=c[p];n.zd=u.hb[b];n.Od=u.hb[m];n.Cd=u.trans[b];n.Pd=u.trans[m];n.ge=e.ge}ea.A(a)}break;case 20:d=A(c);var e=V,m=d[0],p=d[1],n=d[2],u=c.trans,r=u[m][1],f=u[m][2],h=u[p][1],g=u[p][2];e[0]=(1-n)*u[m][0]+n*u[p][0];e[1]=(1-n)*r+n*h;e[2]=(1-n)*f+n*g;m=ia;f=d[0];p=d[1];n=d[2];u=c.hb;r=Y;r[0]=u[f][0];r[1]=u[f][1];r[2]=u[f][2];r[3]=u[f][3];f=aa;f[0]=u[p][0];f[1]=u[p][1];f[2]=u[p][2];f[3]=u[p][3];N.slerp(r,f,n,m);p=d[2];n=c.trans;d=(1-p)*n[d[0]][3]+p*n[d[1]][3];a.parent&&a.Zr&&
(p=T,oa.set_sep(e,d,m,p),oa.multiply(a.Zr,p,p),oa.bc(p,e),oa.ud(p,m),d=oa.get_scale(p));c.$w&&(p=ua,ea.get_translation(a,p),pa.smooth_v(e,p,b,c.$w,e));c.Yv&&(p=Y,ea.get_rotation(a,p),pa.iC(m,p,b,c.Yv,m));f=c.hh;f[0]&&ea.set_translation_rel(a,e);f[1]&&ea.set_rotation_rel(a,m);f[2]&&ea.set_scale_rel(a,d);ea.A(a);ta.sync_transform(a);break;case 30:d=c.He-c.start;0>d&&(d=0);d>=c.length&&(d=c.length);a=Math.floor(d);b=a+1;d-=a;10!=c.behavior&&b==c.length&&(b=--a,d=1);c=c.fD;Aa[0]=a+c;Aa[1]=b+c;Aa[2]=d;
d=Aa;e.Qs=d[0];e.Rs=d[2];break;case 40:d=A(c);b=d[0];e=d[1];d=d[2];c.volume&&na.set_volume(a,(1-d)*c.volume[b]+d*c.volume[e]);c.pitch&&na.playrate(a,(1-d)*c.pitch[b]+d*c.pitch[e]);break;case 50:b=10==c.behavior?(f-h)/sa.Pc():f/sa.Pc();Q.hN(a,c.eh,b);break;case 60:d=A(c);b=d[0];e=d[1];d=d[2];u=c.cB;r=c.Xf;a=c.bB;m=c.Wf;p=c.Nr;for(c=0;c<r.length;c++)for(f=u[c],n=r[c],h=(1-d)*f[b]+d*f[e],f=0;f<p.length;f++)p[f].Ch[n]=h;for(c=0;c<m.length;c++)for(u=a[c],n=m[c],u=I.lerp(u.subarray(3*b,3*b+3),u.subarray(3*
e,3*e+3),d,V),f=0;f<p.length;f++)p[f].Ld[3*n]=u[0],p[f].Ld[3*n+1]=u[1],p[f].Ld[3*n+2]=u[2];break;case 70:d=A(c);b=d[0];e=d[1];d=d[2];f=c.hh;(g=c.Je)&&f[0]&&R.set_light_energy(a.Ta,(1-d)*g[b]+d*g[e]);(c=c.color)&&f[1]&&(V[0]=(1-d)*c[3*b]+d*c[3*e],V[1]=(1-d)*c[3*b+1]+d*c[3*e+1],V[2]=(1-d)*c[3*b+2]+d*c[3*e+2],R.set_light_color(a.Ta,V));h=a.D;for(c=0;c<h.length;c++)qa.vO(a,h[c].Ua);break;case 80:d=A(c);b=d[0];e=d[1];d=d[2];f=c.hh;h=a.D;l=qa.Da(h[0].Ua,ra.sb);g=c.Je;g=f[0]?(1-d)*g[b]+d*g[e]:l.Je;k=c.Pe;
f[1]?(V[0]=(1-d)*k[3*b]+d*k[3*e],V[1]=(1-d)*k[3*b+1]+d*k[3*e+1],V[2]=(1-d)*k[3*b+2]+d*k[3*e+2],k=V):k=l.Pe;var t=c.cf;f[2]?(ua[0]=(1-d)*t[3*b]+d*t[3*e],ua[1]=(1-d)*t[3*b+1]+d*t[3*e+1],ua[2]=(1-d)*t[3*b+2]+d*t[3*e+2],l=ua):l=l.cf;t=c.Cz;f[3]&&(m=(1-d)*t[b]+d*t[e]);t=c.Az;f[4]&&(p=(1-d)*t[b]+d*t[e]);t=c.Dz;f[5]&&(n=(1-d)*t[b]+d*t[e]);t=c.Bz;f[6]&&(u=(1-d)*t[b]+d*t[e]);c=c.zz;f[7]&&(ia[0]=(1-d)*c[3*b]+d*c[3*e],ia[1]=(1-d)*c[3*b+1]+d*c[3*e+1],ia[2]=(1-d)*c[3*b+2]+d*c[3*e+2],r=ia);for(c=0;c<h.length;c++)b=
a.D[c].Ua,(f[0]||f[1]||f[2])&&qa.set_environment_colors(b,g,k,l),f[3]&&qa.OM(b,m),f[4]&&qa.MM(b,p),f[5]&&qa.PM(b,n),f[6]&&qa.NM(b,u),f[7]&&qa.set_fog_color_density(b,r);break;default:pa.r("Unknown animation type:"+k)}}}function A(a){var b=a.xt[0],c=a.xt[1]-b,b=a.He-b;0>b&&(b=0);b>=c&&(b=c);b/=a.Ux;c=Math.floor(b);a=a.Sx[c]?b-c:0;b=Math.ceil(c+a);Aa[0]=c;Aa[1]=b;Aa[2]=a;return Aa}function H(a,b){var c=a.k,d=c.qg,e=c.Lm,f=e[0],e=e[1];if(-1!=e){if(-1!=f){var h=a.X[f];if(h.play||0==b){var g=A(h),k=g[0],
l=g[1];c.ge=g[2];var g=h.hb[k],m=h.hb[l],k=h.trans[k],l=h.trans[l]}else d=1}else d=1;e=a.X[e];if(e.play||0==b){var f=A(e),p=f[0],n=f[1];c.ge=f[2]}else if(-1!=f&&h.play)d=0;else return;f=e.hb[p];h=e.hb[n];p=e.trans[p];n=e.trans[n];if(1==d)c.zd.set(f),c.Od.set(h),c.Cd.set(p),c.Pd.set(n);else if(0==d)c.zd.set(g),c.Od.set(m),c.Cd.set(k),c.Pd.set(l);else{for(e=0;e<g.length;e+=4){for(var u=ia,t=Y,r=0;4>r;r++)u[r]=g[e+r],t[r]=f[e+r];N.slerp(u,t,d,u);for(r=0;4>r;r++)c.zd[e+r]=u[r];for(r=0;4>r;r++)u[r]=m[e+
r],t[r]=h[e+r];N.slerp(u,t,d,u);for(r=0;4>r;r++)c.Od[e+r]=u[r]}pa.ny(k,p,d,c.Cd);pa.ny(l,n,d,c.Pd)}ea.A(a);U.HO(a)}}function w(a,b){var c=a.k,d=c.qg,e=c.hn;if(0!=e){var d=c.gn-d,f=e*b;pa.sign(d)==pa.sign(e)&&Math.abs(f)<Math.abs(d)?c.qg+=f:(c.qg=c.gn,c.hn=0)}}function h(a){var b=[],c=[],d=new Float32Array(4),e=new Float32Array(4),f;for(f in a){var h=a[f],g=d,k=e,l=h.kq,m=l[l.length-1],p=m.bx;m.Js||oa.identity(p);for(m=l.length-1;0<=m;m--){var n=l[m],u=n.bx;if(n.Js)p=u;else{var r=n.hj,t=n.Is;oa.invert(r,
T);oa.multiply(t,T,T);oa.multiply(r,T,T);oa.multiply(p,T,u);p=u;n.Js=!0}}l=n.bx;g[0]=l[0];g[1]=l[1];g[2]=l[2];g[3]=l[3];k[0]=l[4];k[1]=l[5];k[2]=l[6];k[3]=l[7];N.normalize(k,k);h=h.hi;for(g=0;4>g;g++)k=4*h+g,b[k]=d[g],c[k]=e[g]}return{trans:b,hb:c}}function u(a,b,c){var d=[],e=[];new Float32Array(4);new Float32Array(4);for(var f in c)for(var h=c[f],g=h.hi,h=h.qu,k=0;4>k;k++){var l=4*h+k,m=4*g+k;d[l]=a[m];e[l]=b[m]}d=new Float32Array(d);e=new Float32Array(e);return{trans:d,hb:e}}function P(a){var b=
a.q,c;if(b.Jt)c=10;else if(b.V)if("volume"in b.V||"pitch"in b.V)c=40;else if(D(a))c=60;else{var d;a:{if(a.q.V){d=a.fcurves;for(var e in d)if("color"==e&&!d[e][3]){d=!0;break a}if("energy"==e){d=!0;break a}}d=!1}if(d)c=70;else if(d=a.q.V,"light_settings.environment_energy"in d||"horizon_color"in d||"zenith_color"in d||"mist_settings.intensity"in d||"mist_settings.depth"in d||"mist_settings.start"in d||"mist_settings.height"in d||"b4w_fog_color"in d)c=80;else{a:{if(a.q.V)for(c in a=a.fcurves,a)if("location"==
c||"rotation_quaternion"==c||"scale"==c){c=!0;break a}c=!1}c=c?20:0}}else c=0;b.type=c}function D(a){if(a=a.q.V)for(var b in a)if(-1!=b.indexOf("nodes"))return!0;return!1}function p(a,b){b[0]=b[1]=b[2]=0;for(var c in a)"location"==c?b[0]=1:"rotation_quaternion"==c?b[1]=1:"scale"==c&&(b[2]=1)}function z(a,b){b[0]=b[1]=0;for(var c in a)"energy"==c?b[0]=1:"color"==c&&(b[1]=1)}function l(a,b){b[0]=b[1]=b[2]=0;b[3]=b[4]=b[5]=0;b[6]=b[7]=0;for(var c in a)"light_settings.environment_energy"==c?b[0]=1:"horizon_color"==
c?b[1]=1:"zenith_color"==c?b[2]=1:"mist_settings.intensity"==c?b[3]=1:"mist_settings.depth"==c?b[4]=1:"mist_settings.start"==c?b[5]=1:"mist_settings.height"==c?b[6]=1:"b4w_fog_color"==c&&(b[7]=1)}function M(a,b,c,d,e,f,h){var g=a+(b-a)/2,k=E(g,d,e,f,h)-c;return.02>Math.abs(k)?g:0<k?M(a,g,c,d,e,f,h):M(g,b,c,d,e,f,h)}function E(a,b,c,d,e){var f=1-a;return b*f*f*f+3*c*f*f*a+3*d*f*a*a+e*a*a*a}function W(a,b){var c={type:null,eh:null,xt:null,Ux:0,Sx:null,hh:new Int8Array(8),hb:null,trans:null,vw:[],play:!1,
behavior:20,He:0,start:0,length:0,$w:0,Yv:0,bo:!1,fD:null,speed:1,volume:null,pitch:null,color:null,Je:null,cf:null,Pe:null,Cz:null,Az:null,Dz:null,Bz:null,zz:null,cB:[],Xf:[],bB:[],Wf:[],Nr:null};if(!a.X.length)for(var d=0;8>d;d++)a.X.push(null);a.X[b]=c;-1==xa.indexOf(a)&&xa.push(a)}function G(a,b){ea.A(a);ta.sync_transform(a);x(a,0,b,!0)}function J(a,e,f,h){h=h||0;if(ca.is_mesh(a)){var g=Z(a,f);if(g)return W(a,h),c(a,g,h),G(a,h),!0;if((g=L(a,f))&&"EMITTER"==g.Tr){W(a,h);e=g.name;f=h;for(var g=
a.D,k=0;k<g.length;k++)for(var l=g[k].U,m=0;m<l.length;m++){var p=l[m].Ma;p&&p.name==e&&b(a.X[f],p)}G(a,h);return!0}}if(g=pa.keysearch("name",f,la)||pa.keysearch("name",f+"_B4W_BAKED",la)){W(a,h);if(d(a,e,g,h))return G(a,h),!0;a.X[h]=null}K.error('Unsupported object: "'+a.name+'" or animation name: "'+f+'"');return!1}function Z(a,b){for(var c=0;c<a.yc.length;c++){var d=a.yc[c];if(d.name===b)return d}return null}function L(a,b){for(var c=a.D,d=0;d<c.length;d++)for(var e=c[d].U,f=0;f<e.length;f++){var h=
e[f].Ma;if(h&&h.name===b)return h}return null}function O(a){a=a.modifiers;for(var b=0;b<a.length;b++){var c=a[b];if("ARMATURE"==c.type)return c.object}return null}var U=q("__armature"),ga=q("__config"),R=q("__lights"),ca=q("__obj_util"),Q=q("__particles"),ta=q("__physics"),K=q("__print"),N=q("__quat"),ha=q("__reformer"),qa=q("__scenes"),na=q("__sfx"),ra=q("__subscene"),sa=q("__time"),ea=q("__transform"),oa=q("__tsr"),pa=q("__util"),I=q("__vec3"),Ea=ga.xj,ka=ga.jh;a.$D=1E-6;a.OBJ_ANIM_TYPE_NONE=0;
a.OBJ_ANIM_TYPE_ARMATURE=10;a.OBJ_ANIM_TYPE_OBJECT=20;a.OBJ_ANIM_TYPE_VERTEX=30;a.OBJ_ANIM_TYPE_SOUND=40;a.OBJ_ANIM_TYPE_PARTICLES=50;a.OBJ_ANIM_TYPE_MATERIAL=60;a.qE=70;a.pE=80;a.SLOT_0=0;a.SLOT_1=1;a.SLOT_2=2;a.SLOT_3=3;a.SLOT_4=4;a.SLOT_5=5;a.SLOT_6=6;a.SLOT_7=7;a.SLOT_ALL=-1;a.AB_CYCLIC=10;a.AB_FINISH_RESET=20;a.AB_FINISH_STOP=30;var Aa=Array(3),V=new Float32Array(3),ua=new Float32Array(3),ia=new Float32Array(4),Y=new Float32Array(4),aa=new Float32Array(4),T=oa.create();new Float32Array(16);var xa=
[],la=[];a.Xz=function(){return pa.trunc((ka.Go-50)/4)};a.frame_to_sec=function(a){return a/sa.Pc()};a.update=function(a){for(var b=0;b<xa.length;b++){for(var c=xa[b],d=0;8>d;d++)y(c,a,d);c.k.dh&&(w(c,a),H(c,a))}for(b=0;b<xa.length;b++)for(c=xa[b],d=0;8>d&&c.X.length;d++)e(c,d)};a.KJ=function(){return la};a.get_anim_names=function(a){var b=[];if(g(a))for(var c=0;c<a.yc.length;c++)b.push(a.yc[c].name);for(var d=[],c=0;c<la.length;c++){var e=la[c],f=e.q;20==f.type?d.push(e):60==e.q.type&&"MESH"==a.type?
d.push(e):10==f.type&&"ARMATURE"==a.type?d.push(e):40==f.type&&"SPEAKER"==a.type?d.push(e):80==f.type&&"WORLD"==a.type&&d.push(e)}for(c=0;c<d.length;c++)b.push(n(d[c].name));if(Q.hm(a)&&Q.gB(a))for(a=a.D,c=0;c<a.length;c++)for(d=a[c].U,e=0;e<d.length;e++)(f=d[e].Ma)&&b.push(f.name);return b};a.wC=n;a.get_anim_type=function(a,b){var c=a.X[b];return c?c.type:0};a.apply_def=function(a){for(var e=0,f=a.D,h=0;h<f.length;h++)for(var k=f[h].U,l=0;l<k.length;l++){var m=k[l].Ma;m&&"EMITTER"==m.Tr&&!k[l].jf&&
(W(a,e),b(a.X[e],m),G(a,e),a.X[e].behavior=m.cyclic?10:a.wj,e++)}f=a.oh.slice();for(h=0;h<f.length;h++)l=f[h],k=l.gm,l=l.action,W(a,e),d(a,k,l,e)?(G(a,e),a.X[e].behavior=a.wj,e++):a.X[e]=null;g(a)&&(W(a,e),c(a,a.yc[0],e),G(a,e),a.X[e].behavior=a.wj)};a.At=function(a){switch(a){case "CYCLIC":return 10;case "FINISH_RESET":return 20;case "FINISH_STOP":return 30;default:pa.r("Wrong animation behavior")}};a.OJ=function(a){var b=[];a=a.data.materials;for(var c=0;c<a.length;c++){var d=a[c],e=d.node_tree;
e&&t(e,b,[d.name])}return b};a.oA=f;a.play=function(a,b,c){v(a.X,c,function(a){a.play=!0;a.Cu=b?b:null;a.bo=!1});a.k.dh&&C(a)};a.stop=function(a,b){v(a.X,b,function(a){a.play=!1;a.Cu=null;a.bo=!1})};a.is_play=function(a,b){var c=a.X;if(-1==b)for(var d=0;8>d;d++){if(c[d]&&c[d].play)return!0}else if(c=c[b])return c.play;return!1};a.set_frame=m;a.set_first_frame=function(a,b){b=b||0;v(a.X,b,function(c){m(a,c.start,b)})};a.Uz=function(a,b){var c=a.X[b];return c&&c.He?c.He:0};a.is_cyclic=function(a,b){var c=
a.X[b];return c&&10==c.behavior};a.set_behavior=function(a,b,c){v(a.X,c,function(a){a.behavior=b})};a.get_behavior=function(a,b){var c=a.X[b];return c&&c.behavior};a.apply_smoothing=function(a,b,c,d){v(a.X,d,function(a){a.$w=b||0;a.Yv=c||0})};a.remove_slot_animation=function(a,b){if(-1==b)for(var c=0;8>c;c++)a.X[c]=null;else a.X[b]=null;a.k.dh&&B(a,b)};a.yO=x;a.iB=function(a){if("ARMATURE"==a.type||a.$p||"WORLD"==a.type)return!0;for(var b=0;b<a.oh.length;b++){var c=a.oh[b].action.q.type;if(20==c||
10==c||40==c&&"SPEAKER"==a.type||70==c&&"LAMP"==a.type||60==c&&"MESH"==a.type)return!0}return Q.hm(a)&&Q.gB(a)||"MESH"==a.type&&a.yc.length?!0:!1};a.sy=function(a,b){if("ARMATURE"==b.type||O(a)||"WORLD"==b.type)return!0;for(var c=0;c<b.oh.length;c++){var d=b.oh[c].action.q.type;if(20==d||10==d||40==d&&"SPEAKER"==b.type||60==d&&"MESH"==b.type)return!0}return Q.zG(a)&&Q.yG(a)||"MESH"==b.type&&a.data.b4w_vertex_anim.length?!0:!1};a.is_animated=function(a){return Boolean(a.X.length)};a.FG=h;a.eJ=u;a.EF=
function(a){function b(a,c){for(var d=0;d<c;d++){var e=a.subarray(8*d+4,8*d+8);N.normalize(e,e)}}function c(a,b){if(-1<a.indexOf("location"))var d=0,e=b;else-1<a.indexOf("rotation_quaternion")?(d=4,e=0==b?3:b-1):-1<a.indexOf("scale")?(d=3,e=0):(d=0,e=b);return d+e}function d(a,b,c,h,g){if(-1<c.search(e)){a=b;c=c.split('"')[1];var k=f}else 8==g?(c="tsr",k=f):k=1<g?new Float32Array(g):0;if(!a[c]){g=a;b=c;if("object"==typeof k&&k.length)for(var l=k.length,m=new Float32Array(h*l),p=0;p<h;p++)for(var n=
0;n<l;n++)m[p*l+n]=k[n];else if("number"==typeof k)for(m=new Float32Array(h),p=0;p<h;p++)m[p]=k;else pa.r("Wrong storage default value");g[b]=m}return a[c]}var e=new RegExp(/pose.bones\[\".+\"\]/g),f=oa.create(),h=a.q={type:0,Jv:0,qB:0,V:null,Jt:null,ly:null,hh:new Int8Array(8)};h.qB=1/Ea.bk;var g=a.fcurves,k={},m={},n=0,u;for(u in g){var r=g[u],t;for(t in r){var v=r[t],q=v.De;ha.OG(v,a);v=v.num_channels;n||(n=q.length);for(var v=d(k,m,u,n,v),w=v.length/n,y=c(u,t|0),x=0;x<n;x++)v[x*w+y]=q[x]}}if(pa.no(k)){for(var A in k)"tsr"==
A&&b(k[A],n);h.V=k}if(pa.no(m)){for(var O in m)b(m[O],n);h.Jt=m}h.Jv=n;h.ly=a.vF;"tsr"in k&&p(g,h.hh);("color"in k||"energy"in k)&&z(g,h.hh);("light_settings.environment_energy"in k||"horizon_color"in k||"zenith_color"in k||"mist_settings.intensity"in k||"mist_settings.depth"in k||"mist_settings.start"in k||"mist_settings.height"in k||"b4w_fog_color"in k)&&l(g,h.hh);P(a);la.push(a)};a.NJ=function(a,b){return(b-a)*Ea.bk+1};a.cG=function(a,b,c,d,e,f){var h=new Float32Array(2),g=new Float32Array(2),
k=new Float32Array(2),l=new Float32Array(2),m=b[1],p=b[2],n=b[a.last_frame_offset+1];a=b[a.last_frame_offset+2];for(var u=0,r=0,t=null;e<=f;e++)if(e<m)for(var v=0;v<Ea.bk;v++)c[u++]=p;else if(e>n)for(v=0;v<Ea.bk;v++)c[u++]=a;else{var z=b[r],q=3;0===z&&(q+=2);0===t&&(q+=2);var w=2===z?0:1;if(b[r+1]==b[r+q+1])t=z,r+=q;else{v=0;e==b[r+1]&&(w&&(d[u]=1),c[u]=b[r+2],u++,v++);if(e==n)for(;v<Ea.bk;v++)c[u++]=a;else for(h[0]=b[r+1],h[1]=b[r+2],0!==z?(g[0]=0,g[1]=0):0===t?(g[0]=b[r+5],g[1]=b[r+6]):(g[0]=b[r+
3],g[1]=b[r+4]),0!==z?(k[0]=0,k[1]=0):(k[0]=b[r+q+3],k[1]=b[r+q+4]),l[0]=b[r+q+1],l[1]=b[r+q+2];v<Ea.bk;v++){var y=e+v/Ea.bk;switch(z){case 0:var x=h,A=g,O=k,B=l,C=[],aa=[],T=void 0,I=void 0,xa=void 0,T=void 0;C[0]=x[0]-A[0];C[1]=x[1]-A[1];aa[0]=B[0]-O[0];aa[1]=B[1]-O[1];xa=B[0]-x[0];T=Math.abs(C[0]);I=Math.abs(aa[0]);0!=T+I&&T+I>xa&&(T=xa/(T+I),A[0]=x[0]-T*C[0],A[1]=x[1]-T*C[1],O[0]=B[0]-T*aa[0],O[1]=B[1]-T*aa[1]);w&&(d[u]=1);c[u]=E(M(0,1,y,h[0],g[0],k[0],l[0]),h[1],g[1],k[1],l[1]);u++;break;case 1:w&&
(d[u]=1);x=h[0];A=h[1];O=(l[1]-A)/(l[0]-x);c[u]=O*y+(A-O*x);u++;break;case 2:w&&(d[u]=1);c[u]=b[r+2];u++;break;default:pa.r("Unknown keyframe interpolation mode: "+z)}}e+1==b[r+q+1]&&(t=z,r+=q)}}};a.apply=J;a.$F=function(a,b,c,e){e=e||0;var f=pa.keysearch("uuid",c,la);if(f){W(a,e);if(d(a,b,f,e)){G(a,e);return}a.X[e]=null}K.error('Unsupported object: "'+a.name+'" or animation uuid: "'+c+'"')};a.gD=function(a,b){var c=pa.keysearch("name",b,la)||pa.keysearch("name",b+"_B4W_BAKED",la);if(c){if(0==c.q.type)return!1}else if(!(L(a,
b)||ca.is_mesh(a)&&Z(a,b)))return!1;return!0};a.get_slot_num_by_anim=function(a,b){for(var c=a.X,d=0;d<c.length;d++){var e=c[d];if(e&&n(e.eh)==n(b))return d}return-1};a.LJ=function(a,b){var c=a.X[b];return c&&c.eh?n(c.eh):null};a.remove=function(a){a.X.length=0;a=xa.indexOf(a);-1!=a&&xa.splice(a,1)};a.fM=function(a){for(var b=la.length-1;0<=b;b--)la[b].wF==a&&la.splice(b,1)};a.apply_to_first_empty_slot=function(a,b){if(!a.X.length)return J(a,b,0)?0:-1;for(var c=0;c<a.X.length;c++)if(!a.X[c])return J(a,
b,c)?c:-1};a.set_skel_mix_factor=function(a,b,c){a.k.hn=(b-a.k.qg)/c;a.k.gn=b};a.set_speed=function(a,b,c){v(a.X,c,function(a){a.speed=b})};a.get_speed=function(a,b){return a.X[b].speed};a.get_anim_start_frame=function(a,b){return a.X[b].start};a.get_anim_length=function(a,b){return a.X[b].length};a.cleanup=function(){xa.length=0;la.length=0};a.gJ=function(a){var b=(a[0]||a[1]||a[2]).De.length,c=ia,d=V,e=Boolean(a[0]);e||(a[0]={De:new Float32Array(b),num_channels:8});var f=Boolean(a[1]);f||(a[1]=
{De:new Float32Array(b),num_channels:8});var h=Boolean(a[2]);h||(a[2]={De:new Float32Array(b),num_channels:8});a[3]={De:new Float32Array(b),num_channels:8};for(var g=0;g<b;g++)d[0]=e?a[0].De[g]:0,d[1]=f?a[1].De[g]:0,d[2]=h?a[2].De[g]:0,pa.euler_to_quat(d,c),a[0].De[g]=c[3],a[1].De[g]=c[0],a[2].De[g]=c[1],a[3].De[g]=c[2]};a.Rz=O;a.uN=function(a,b){for(var c=7,d=0,e=0;e<la.length;e++){var f=la[e];if(f.name==b){d=f.q.type;break}}0==d&&(Z(a,b)?d=30:(e=L(a,name))&&"EMITTER"==e.Tr&&(d=50));for(e=0;8>e;e++)if(f=
a.X[e]){if(f.type==d)return e}else e<c&&(c=e);return c}};b4w.module.__time=function(a,q){function e(){return-1!==c.xj.Mq?c.xj.Mq:v}var c=q("__config");q("__print");var b=0,n=0,f=[],t=0,g=0,m=[],v=-1;a.VB=function(a){b=a;n=performance.now();for(a=0;a<f.length;a++){var c=f[a];b>c.zu&&(f.splice(a,1),a--,c.callback())}for(a=0;a<m.length;a++){var c=m[a],e=1-(c.zu-b)/c.duration,e=Math.min(e,1);c.callback(c.from+e*(c.to-c.from));1==e&&(m.splice(a,1),a--)}};a.get_timeline=function(){return b};a.set_timeout=function(a,c){var e;t++;e=t;f.push({id:e,callback:a,zu:b+
(performance.now()-n+c)/1E3});return e};a.clear_timeout=function(a){for(var b=0;b<f.length;b++)if(f[b].id==a){f.splice(b,1);break}};a.clear_animation=function(a){for(var b=m.length;b--;)if(m[b].id==a){m.splice(b,1);break}};a.animate=function(a,c,e,f){e/=1E3;var n;g++;n=g;m.push({id:n,callback:f,from:a,to:c,zu:b+e,duration:e});f(a);return n};a.reset=function(){n=b=0;f.length=0;g=t=m.length=0};a.Pc=e;a.RM=function(a){v=a};a.get_frame=function(a){return a*e()}};b4w.module.__transform=function(a,q){function e(a,b){v.mf(a)?B.set_trans(b,v.lf(a)):B.set_trans(b,a.k.n)}function c(a,b){var c=a.k;if(v.mf(a)){B.set_quat(b,c.n);var d=v.Qq(a),d=B.invert(d,w);B.multiply(d,c.n,v.lf(a))}else B.set_quat(b,c.n)}function b(a,b){v.mf(a)?B.set_quat(b,v.lf(a)):B.set_quat(b,a.k.n)}function n(a,b){v.mf(a)?B.copy(b,v.lf(a)):B.copy(b,a.k.n)}function f(a,b){v.mf(a)?B.copy(v.lf(a),b):B.copy(a.k.n,b);return b}function t(a){var b=a.k,c=a.D,e=a.type;"CAMERA"==e&&m.dx(a);v.tO(a,u);
"CAMERA"==e&&m.qO(a);var f=B.bc(b.n,y),h=B.ud(b.n,H);g.ji(b.J,b.n,b.Y);g.sl(b.da,b.n,b.Aa);if(b.vp)for(var n=0;n<c.length;n++)for(var q=c[n].U,A=0;A<q.length;A++){var L=q[A];g.ji(L.J,b.n,L.Y);g.sl(L.da,b.n,L.Aa);L.Bf&&g.rl(L.Z,b.n,L.va)}else b.Bf&&g.rl(b.Z,b.n,b.va);switch(e){case "MESH":a.YA&&B.invert(a.k.n,a.k.dt);if(q=a.$p)B.invert(q.k.n,w),B.multiply(w,b.n,w),B.mK(w,b.mn),B.ud(w,b.ln);b.ho=!0;break;case "CAMERA":for(n=0;n<c.length;n++)m.rO(a,c[n]);break;case "SPEAKER":C.EN(a,u,P);break;case "LAMP":x.wO(a)}for(n=
0;n<c.length;n++)if(A=c[n],A.kr){q=A.Ua;L=q.q;switch(e){case "MESH":b.pd&&r.nw(q);L=A.lh;null!=b.ce&&L&&r.VC(L,f);break;case "EMPTY":d.uO(a);break;case "CAMERA":r.BM(q);if(L.Sc){L.Sc.enable_csm&&r.nw(q);var O=k.ga(a,q).R[0];r.GO(O,L.Pa)}r.get_active()==q&&r.hk(q)==a&&C.eL(q,f,h,u,P);break;case "LAMP":r.Nm(a,q)}L=A.Kg;O=a.Zo;if(O.length)for(A=0;A<L.length;A++){var U=L[A].p;r.XC(L[A],f,h);k.YC(O,U.Nb);m.kN(U,r.hk(q));F.Fl(U.Ic,U.Ag)}}b=a.be;for(n=0;n<b.length;n++)t(b[n]);a=a.$t;for(n=0;n<a.length;n++)b=
a[n],q=b[0],v.nO(q,b[1])}var g=q("__boundings"),m=q("__camera"),v=q("__constraints"),x=q("__lights"),d=q("__objects"),k=q("__obj_util");q("__quat");var r=q("__scenes"),C=q("__sfx"),B=q("__tsr"),F=q("__util"),D=q("__vec3"),y=new Float32Array(3),A=new Float32Array(3),H=new Float32Array(4);new Float32Array(9);var w=B.create(),h=B.create(),u=0,P=0;a.SPACE_WORLD=0;a.SPACE_LOCAL=1;a.update=function(a){u=a;P++};a.set_translation=function(a,b){var c=a.k;if(v.mf(a)){B.set_trans(b,c.n);var d=v.Qq(a),d=B.invert(d,
w);B.multiply(d,c.n,v.lf(a))}else B.set_trans(b,c.n)};a.set_translation_rel=e;a.get_translation=function(a,b){B.bc(a.k.n,b);return b};a.get_translation_rel=function(a,b){v.mf(a)?B.bc(v.lf(a),b):B.bc(a.k.n,b);return b};a.set_rotation=c;a.set_rotation_rel=b;a.get_rotation=function(a,b){B.ud(a.k.n,b);return b};a.get_rotation_rel=function(a,b){v.mf(a)?B.ud(v.lf(a),b):B.ud(a.k.n,b);return b};a.set_rotation_euler=function(a,b){var d=F.euler_to_quat(b,H);c(a,d)};a.set_rotation_euler_rel=function(a,c){var d=
F.euler_to_quat(c,H);b(a,d)};a.set_scale=function(a,b){var c=a.k;if(v.mf(a)){var c=v.lf(a),d=B.get_scale(v.Qq(a));B.set_scale(b/d,c)}else B.set_scale(b,c.n)};a.set_scale_rel=function(a,b){var c=a.k;v.mf(a)?B.set_scale(b,v.lf(a)):B.set_scale(b,c.n)};a.get_scale=function(a){return B.get_scale(a.k.n)};a.get_scale_rel=function(a){return v.mf(a)?B.get_scale(v.lf(a)):B.get_scale(a.k.n)};a.set_tsr=function(a,b){B.copy(b,a.k.n);if(v.mf(a)){var c=v.Qq(a),c=B.invert(c,w);B.multiply(c,a.k.n,v.lf(a))}};a.set_tsr_rel=
n;a.get_tsr=function(a,b){return B.copy(a.k.n,b)};a.get_tsr_rel=f;a.get_object_size=function(a){var b=a.k;a=b.fi;var c=B.get_scale(b.n),b=c*(a.max_x-a.min_x),d=c*(a.max_y-a.min_y);a=c*(a.max_z-a.min_z);return.5*Math.sqrt(b*b+d*d+a*a)};a.get_object_center=function(a,b,c){b?(a=a.k,D.copy(a.Aa.I,c)):(a=a.k,b=a.fi,c[0]=(b.max_x+b.min_x)/2,c[1]=(b.max_y+b.min_y)/2,c[2]=(b.max_z+b.min_z)/2,B.transform_vec3(c,a.n,c));return c};a.move_local=function(a,b,c,d){var h=f(a,w),g=y;g[0]=b;g[1]=c;g[2]=d;B.transform_vec3(g,
h,g);e(a,g)};a.jw=function(a,b){var c=f(a,w),d=B.set_quat(b,B.identity(h));B.multiply(c,d,d);n(a,d)};a.A=t;a.distance=function(a,b){var c=B.bc(a.k.n,y),d=B.bc(b.k.n,A);return D.dist(c,d)};a.im=function(a,b){var c=B.bc(a.k.n,y);return D.dist(c,b)};a.get_object_bounding_box=function(a){return{max_x:a.k.Y.max_x,min_x:a.k.Y.min_x,max_y:a.k.Y.max_y,min_y:a.k.Y.min_y,max_z:a.k.Y.max_z,min_z:a.k.Y.min_z}}};b4w.module.__tsr=function(a,q){function e(){var a=new Float32Array(8);a[3]=1;a[7]=1;return a}function c(){var a=new Float32Array(9);a[3]=1;a[7]=1;return a}function b(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];return b}function n(a,b,c,d){d[0]=a[0];d[1]=a[1];d[2]=a[2];d[3]=b;d[4]=c[0];d[5]=c[1];d[6]=c[2];d[7]=c[3];return d}function f(a,b){b[0]=a[4];b[1]=a[5];b[2]=a[6];b[3]=a[7];return b}function t(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],k=b[4],m=b[5],l=b[6];
b=b[7];var n=a[0]*g,r=a[1]*g,t=a[2]*g;a=b*n+m*t-l*r;var g=b*r+l*n-k*t,v=b*t+k*r-m*n,n=-k*n-m*r-l*t;c[0]=a*b+n*-k+g*-l-v*-m;c[1]=g*b+n*-m+v*-k-a*-l;c[2]=v*b+n*-l+a*-m-g*-k;c[0]+=d;c[1]+=e;c[2]+=f;return c}var g=q("__mat4"),m=q("__quat"),v=q("__util"),x=q("__vec3"),d=q("__vec4"),k=Math.sin(-Math.PI/4),r=-k,C=new Float32Array(3),B=new Float32Array(4),F=new Float32Array(4),D=new Float32Array(16);a.create=e;a.clone=function(a){var c=e();b(a,c);return c};a.from_values=function(a,b,c,d,f,g,k,m){var n=e();
n[0]=a;n[1]=b;n[2]=c;n[3]=d;n[4]=f;n[5]=g;n[6]=k;n[7]=m;return n};a.Rj=c;a.nQ=function(a){var d=c();b(a,d);return d};a.LQ=function(a,b,d,e,f,g,k,m){var n=c();n[0]=a;n[1]=b;n[2]=d;n[3]=e;n[4]=f;n[5]=g;n[6]=k;n[7]=m;return n};a.copy=b;a.identity=function(a){a[0]=0;a[1]=0;a[2]=0;a[3]=1;a[4]=0;a[5]=0;a[6]=0;a[7]=1;return a};a.set_sep=n;a.set_trans=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};a.set_scale=function(a,b){b[3]=a;return b};a.set_transcale=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];
b[3]=a[3];return b};a.set_quat=function(a,b){b[4]=a[0];b[5]=a[1];b[6]=a[2];b[7]=a[3];return b};a.get_trans_view=function(a){return a.subarray(0,3)};a.bc=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};a.get_scale=function(a){return a[3]};a.mK=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3]};a.get_quat_view=function(a){return a.subarray(4,8)};a.ud=f;a.invert=function(a,b){var c=1/a[3];if(!c)return null;var d=a[0],e=a[1],f=a[2];B[0]=a[4];B[1]=a[5];B[2]=a[6];B[3]=a[7];m.invert(B,B);var g=
B[0],k=B[1],n=B[2],l=B[3],d=d*c,e=e*c,r=f*c,f=l*d+k*r-n*e,t=l*e+n*d-g*r,v=l*r+g*e-k*d,d=-g*d-k*e-n*r;b[0]=-(f*l+d*-g+t*-n-v*-k);b[1]=-(t*l+d*-k+v*-g-f*-n);b[2]=-(v*l+d*-n+f*-k-t*-g);b[3]=c;b[4]=g;b[5]=k;b[6]=n;b[7]=l;return b};a.to_mat4=function(a,b){var c=a[3];g.fromRotationTranslation(a.subarray(4,8),a.subarray(0,3),b);for(var d=0;12>d;d++)b[d]*=c;return b};a.from_mat4=function(a,b){var c=v.SA(a,C),d=v.RA(a),e=v.matrix_to_quat(a,B);n(c,d,e,b);return b};a.multiply=function(a,b,c){t(b,a,c);c[3]=a[3]*
b[3];var d=a[4],e=a[5],f=a[6];a=a[7];var g=b[4],k=b[5],m=b[6];b=b[7];c[4]=d*b+a*g+e*m-f*k;c[5]=e*b+a*k+f*g-d*m;c[6]=f*b+a*m+d*k-e*g;c[7]=a*b-d*g-e*k-f*m;return c};a.bO=function(a,b,c){var d=b[3];b=g.fromRotationTranslation(b.subarray(4,8),b.subarray(0,3),D);for(var e=0;12>e;e++)b[e]*=d;g.multiply(b,a,c);return c};a.transform_vec3=t;a.transform_vec3_inv=function(a,b,c){var d=b[3],e=a[0]-b[0],f=a[1]-b[1],g=a[2]-b[2];a=b[4];var k=b[5],m=b[6];b=b[7];var l=a*a+k*k+m*m+b*b,l=l?1/l:0;a=-a*l;k=-k*l;m=-m*
l;b*=l;var l=b*e+k*g-m*f,n=b*f+m*e-a*g,r=b*g+a*f-k*e,e=-a*e-k*f-m*g;c[0]=l*b+e*-a+n*-m-r*-k;c[1]=n*b+e*-k+r*-a-l*-m;c[2]=r*b+e*-m+l*-k-n*-a;c[0]/=d;c[1]/=d;c[2]/=d;return c};a.transform_vectors=function(a,b,c,d){d||(d=0);var e=a.length,f=b[0],g=b[1],k=b[2],m=b[3],l=b[4],n=b[5],r=b[6];b=b[7];for(var t=0;t<e;t+=3){var v=a[t]*m,q=a[t+1]*m,x=a[t+2]*m,B=b*v+n*x-r*q,O=b*q+r*v-l*x,C=b*x+l*q-n*v,v=-l*v-n*q-r*x;c[d+t]=B*b+v*-l+O*-r-C*-n;c[d+t+1]=O*b+v*-n+C*-l-B*-r;c[d+t+2]=C*b+v*-r+B*-n-O*-l;c[d+t]+=f;c[d+
t+1]+=g;c[d+t+2]+=k}return c};a.transform_dir_vectors=function(a,b,c,d){d||(d=0);var e=a.length,f=b[3],g=b[4],k=b[5],m=b[6];b=b[7];for(var l=0;l<e;l+=3){var n=a[l]*f,r=a[l+1]*f,t=a[l+2]*f,v=b*n+k*t-m*r,q=b*r+m*n-g*t,x=b*t+g*r-k*n,n=-g*n-k*r-m*t;c[d+l]=v*b+n*-g+q*-m-x*-k;c[d+l+1]=q*b+n*-k+x*-g-v*-m;c[d+l+2]=x*b+n*-m+v*-k-q*-g}return c};a.transform_dir_vec3=function(a,b,c){var d=b[3],e=b[4],f=b[5],g=b[6];b=b[7];var k=a[0]*d,m=a[1]*d,l=a[2]*d;a=b*k+f*l-g*m;var d=b*m+g*k-e*l,n=b*l+e*m-f*k,k=-e*k-f*m-
g*l;c[0]=a*b+k*-e+d*-g-n*-f;c[1]=d*b+k*-f+n*-e-a*-g;c[2]=n*b+k*-g+a*-f-d*-e;return c};a.transform_tangents=function(a,b,c,d){d||(d=0);var e=a.length,f=b[3],g=b[4],k=b[5],m=b[6];b=b[7];for(var l=0;l<e;l+=4){var n=a[l]*f,r=a[l+1]*f,t=a[l+2]*f,v=b*n+k*t-m*r,q=b*r+m*n-g*t,x=b*t+g*r-k*n,n=-g*n-k*r-m*t;c[d+l]=v*b+n*-g+q*-m-x*-k;c[d+l+1]=q*b+n*-k+x*-g-v*-m;c[d+l+2]=x*b+n*-m+v*-k-q*-g;c[d+l+3]=a[l+3]}return c};a.cO=function(a,b,c){b=f(b,B);m.multiply(b,a,c)};a.QC=function(a,b,c,e){e||(e=0);var h=a.length;
b=f(b,B);for(var g=0;g<h;g+=4){var k=F;k[0]=a[g];k[1]=a[g+1];k[2]=a[g+2];k[3]=a[g+3];var n=0<k[3];m.multiply(b,k,k);(n&&0>k[3]||!n&&0<k[3])&&d.scale(k,-1,k);c[e+g]=k[0];c[e+g+1]=k[1];c[e+g+2]=k[2];c[e+g+3]=k[3]}};a.translate=function(a,b,c){var d=a[3],e=a[4],f=a[5],g=a[6],k=a[7],m=b[0]*d,l=b[1]*d,n=b[2]*d;b=k*m+f*n-g*l;var d=k*l+g*m-e*n,r=k*n+e*l-f*m,m=-e*m-f*l-g*n;c[0]=a[0]+b*k+m*-e+d*-g-r*-f;c[1]=a[1]+d*k+m*-f+r*-e-b*-g;c[2]=a[2]+r*k+m*-g+b*-f-d*-e;c[3]=a[3];c[4]=a[4];c[5]=a[5];c[6]=a[6];c[7]=a[7];
return c};a.interpolate=function(a,b,c,d){x.lerp(a.subarray(0,3),b.subarray(0,3),c,d.subarray(0,3));var e=a[3];d[3]=e+c*(b[3]-e);m.slerp(a.subarray(4,8),b.subarray(4,8),c,d.subarray(4,8));return d};a.DQ=function(a,b,c,d){var e=a.subarray(0,3),f=b.subarray(0,3),g=d.subarray(0,3);g[0]=f[0]*(c+1)-e[0]*c;g[1]=f[1]*(c+1)-e[1]*c;g[2]=f[2]*(c+1)-e[2]*c;d[3]=b[3]*(c+1)-a[3]*c;a=a.subarray(4,8);b=b.subarray(4,8);e=d.subarray(4,8);e[0]=b[0]*(c+1)-a[0]*c;e[1]=b[1]*(c+1)-a[1]*c;e[2]=b[2]*(c+1)-a[2]*c;e[3]=b[3]*
(c+1)-a[3]*c;m.normalize(e,e);return d};a.AK=function(a,b,c,d,e){e[0]=a[0]+b*c[0];e[1]=a[1]+b*c[1];e[2]=a[2]+b*c[2];e[3]=a[3];c=d[0];var f=d[1];d=d[2];var g=a[4],k=a[5],m=a[6],l=a[7];e[4]=.5*(c*l+f*m-d*k);e[5]=.5*(f*l+d*g-c*m);e[6]=.5*(d*l+c*k-f*g);e[7]=.5*(-c*g-f*k-d*m);e[4]=a[4]+e[4]*b;e[5]=a[5]+e[5]*b;e[6]=a[6]+e[6]*b;e[7]=a[7]+e[7]*b;a=e[4];b=e[5];c=e[6];f=e[7];a=a*a+b*b+c*c+f*f;0<a&&(a=1/Math.sqrt(a),e[4]*=a,e[5]*=a,e[6]*=a,e[7]*=a)};a.$R=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];
var c=a[4],d=a[5],e=a[6],f=a[7];b[4]=c*r+f*k;b[5]=d*r+e*k;b[6]=e*r-d*k;b[7]=f*r-c*k};a.ZR=function(a,b){b[0]=a[0];b[1]=-a[2];b[2]=a[1];b[3]=a[3];b[4]=a[4];b[5]=-a[6];b[6]=a[5];b[7]=a[7]}};b4w.module.__util=function(a,q){function e(a){return 0<a?1:0>a?-1:0}function c(a,b,c){var d=b.length,e=G;e[0]=a[0];e[1]=a[1];e[2]=a[2];z.normalize(e,e);d?(a=O,a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],b=z.cross(a,e,Z),z.normalize(b,b),z.cross(e,b,a),d=U,d[0]=a[0],d[1]=a[1],d[2]=a[2],d[3]=e[0],d[4]=e[1],d[5]=e[2],d[6]=b[0],d[7]=b[1],d[8]=b[2],p.fromMat3(d,c),c[3]=0<c[3]?c[3]+1E-6:c[3]-1E-6,(0<c[3]&&0>a[3]||0>c[3]&&0<a[3])&&p.scale(c,-1,c),p.normalize(c,c)):p.rotationTo(ra,e,c);return c}function b(a,
b){b||(b=new Float32Array(4));H.fromMat4(a,U);var c=U[0],d=U[3],e=U[6],f=U[1],h=U[4],g=U[7],k=U[2],l=U[5],m=U[8],c=Math.sqrt(c*c+d*d+e*e)||1,f=Math.sqrt(f*f+h*h+g*g)||1,k=Math.sqrt(k*k+l*l+m*m)||1;U[0]/=c;U[3]/=c;U[6]/=c;U[1]/=f;U[4]/=f;U[7]/=f;U[2]/=k;U[5]/=k;U[8]/=k;p.fromMat3(U,b);p.normalize(b,b);return b}function n(a){var b=a[0],c=a[1],d=a[2],e=a[3],f=Math.sqrt(b*b+c*c+d*d),f=1/f;a[0]=b*f;a[1]=c*f;a[2]=d*f;a[3]=e*f}function f(a,b){var c=b;switch(typeof a){case "object":if(a)switch(a.constructor){case Object:for(var d in a)c=
f(a[d],c);break;case Float32Array:case Uint32Array:case Int8Array:case Uint8Array:case Int16Array:case Uint16Array:case Int32Array:case Float64Array:for(d=0;d<a.length;d++)c=t(a[d],c);break;case Array:for(d=0;d<a.length;d++)c=f(a[d],c);break;case WebGLUniformLocation:case WebGLProgram:case WebGLShader:case WebGLFramebuffer:case WebGLTexture:case WebGLBuffer:c=t(0,c);break;default:r("Wrong object constructor")}else c=t(0,c);return c;case "number":return t(a,c);case "boolean":return t(a|0,c);case "string":return g(a,
c);case "function":case "undefined":return t(0,c)}}function t(a,b){var c=b;Q[0]=a;c=(c<<5)-c+ta[0];c&=c;c=(c<<5)-c+ta[1];return c&c}function g(a,b){for(var c=b,d=0;d<a.length;d++)c=(c<<5)-c+a.charCodeAt(d),c&=c;return c}function m(a){return(34*a+1)*a%289}function v(a){return a-Math.floor(a)}function x(a){return d((34*a+5)*a)}function d(a){return a-289*Math.floor(a/289)}function k(a){return a-7*Math.floor(a/7)}function r(a){a&&u.error.apply(u,arguments);throw"engine panic:\nThe engine tried to perform an invalid operation and halted.\nPlease copy the console contents above and submit it to the Blend4Web forum at\nhttps://www.blend4web.com/en/forums/forum/17/";
}function C(a,b,c){a-=b;c-=b;return b+(a-Math.floor(a/c)*c)}function B(a){return C(a,0,2*Math.PI)}function F(a,b){if(a&&b){var c=a instanceof Array;if(c!=b instanceof Array)return!1;var d=a.buffer instanceof ArrayBuffer&&"undefined"!==a.byteLength;if(d!=(b.buffer instanceof ArrayBuffer&&"undefined"!==b.byteLength))return!1;if(c){if(a.length!=b.length)return!1;for(c=0;c<a.length;c++)if(!D(a[c],b[c]))return!1}else if(d){if(a.length!=b.length)return!1;for(c=0;c<a.length;c++)if(a[c]!=b[c])return!1}else{switch(a.constructor){case WebGLUniformLocation:case WebGLProgram:case WebGLShader:case WebGLFramebuffer:case WebGLTexture:case WebGLBuffer:return a==
b}for(var e in a)if(!D(a[e],b[e]))return!1;for(e in b)if(!(e in a))return!1}return!0}return!(a||b)}function D(a,b){if(typeof a!=typeof b)return!1;switch(typeof a){case "number":case "string":case "boolean":return a==b;case "object":return F(a,b);default:return!0}}function y(a){if(""==a)return".";var b=0==a.indexOf("/")|0;b&&0==a.indexOf("//")&&0!=a.indexOf("///")&&(b=2);a=a.split("/");for(var c=[],d=0;d<a.length;d++){var e=a[d];""!=e&&"."!=e&&(".."!=e||!b&&!c.length||c.length&&".."==c[c.length-1]?
c.push(e):c.length&&c.pop())}a=c.join("/");for(d=0;d<b;d++)a="/"+a;return a||"."}function A(){var a=[{}];a.length=0;return a}var H=q("__mat3"),w=q("__mat4"),h=q("__math"),u=q("__print"),P=q("__tsr"),p=q("__quat"),z=q("__vec3"),l=q("__vec4"),M=0,E={},W=[I,Ea,ka,Aa,V],G=new Float32Array(3),J=new Float32Array(3),Z=new Float32Array(3),L=new Float32Array(4),O=new Float32Array(4),U=new Float32Array(9),ga=new Float32Array(16),R=new Float32Array(16),ca=p.create(),Q=new Float64Array(1),ta=new Uint32Array(Q.buffer),
K=new Float32Array([0,0,0]),N=new Float32Array([0,0,0,1]),ha=new Float32Array([0,0,0,1,0,0,0,1]),qa=new Float32Array([1,1,1]),na=new Float32Array([1,0,0]),ra=new Float32Array([0,1,0]),sa=new Float32Array([0,0,1]),ea=new Float32Array([-1,0,0]),oa=new Float32Array([0,-1,0]),pa=new Float32Array([0,0,-1]),I=0,Ea=1,ka=2,Aa=4,V=5,ua=Math.floor(44488.07041494893),ia=[new Float32Array([0,0,-1,0,0,-1,0,0,-1,0,0,0,0,0,0,1]),new Float32Array([0,0,1,0,0,-1,0,0,1,0,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,0,
-1,0,0,1,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,-1,0,0,0,0,-1,0,0,0,0,1]),new Float32Array([-1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1])];a.Nx=K;a.il=N;a.RP=ha;a.vt=qa;a.AXIS_X=na;a.AXIS_Y=ra;a.AXIS_Z=sa;a.AXIS_MX=ea;a.AXIS_MY=oa;a.AXIS_MZ=pa;a.XYX=I;a.YZY=Ea;a.ZXZ=ka;a.XZX=3;a.YXY=Aa;a.ZYZ=V;a.XYZ=6;a.YZX=7;a.ZXY=8;a.XZY=9;a.YXZ=10;a.ZYX=11;a.JD=ia;a.of=function(a){return"undefined"!=typeof a};a.keyfind=function(a,b,c){for(var d=[],e=c.length,f=0;f<
e;f++){var h=c[f];h[a]==b&&d.push(h)}return d};a.f32=function(a){return new Float32Array(a)};a.lJ=function(a,b){var c=a.length,d=new Float32Array(c+b.length);d.set(a);d.set(b,c);return d};a.eO=function(a,b){var c=a.length,d=new Uint32Array(c+b.length);d.set(a);d.set(b,c);return d};a.VG=function(){var a=new Uint16Array([255]);return 255==(new DataView(a.buffer)).getUint16(0,!0)};a.dG=function(a,b){var c=[],d={},e=b.length,f,h;for(f=0;f<e;f++)d[b[f]]=!0;e=a.length;for(f=0;f<e;f++)h=a[f],h in d&&c.push(h);
return c};a.sign=e;a.uR=function(a,b,c){for(var d=c.length,e=0;e<d;e++)if(c[e][a]==b)return!0;return!1};a.keysearch=function(a,b,c){for(var d=0;d<c.length;d++){var e=c[d];if(e[a]===b)return e}return null};a.sR=function(a,b,c,d,e){for(var f=0;f<e.length;f++){var h=e[f];if(h[a]==b&&h[c]==d)return h}return null};a.bK=function(a,b){for(var c=0;c<a.length;c++)if(a[c].uuid==b)return c;return-1};a.ZF=function(a,b){for(var c=0;c<a.length;c++)if(a[c]==b)return;a.push(b)};a.lQ=function(a){for(var b=0;b<a.length-
1;b++)for(var c=a[b],d=b+1;d<a.length;d++)if(c==a[d])return!1;return!0};a.ZN=function(a,b,c,d){d||(d=new Float32Array(16));w.identity(d);d[12]=a;d[13]=b;d[14]=c};var Y=1;a.cM=function(){Y=(69069*Y+5)%Math.pow(2,32);return Math.round(Y/65536)%32768/32767};a.LN=function(a){Y=a};a.vf=function(a){var b=a[0]%ua*48271-3399*Math.floor(a[0]/ua);a[0]=0<b?b:b+2147483647;return(a[0]-1)/2147483646};a.jr=function(a,b){b||(b=[]);b[0]=5E4+Math.floor(a);return b};a.euler_to_quat=function(a,b){b||(b=new Float32Array(4));
var c=Math.cos(a[2]/2),d=Math.cos(-a[1]/2),e=Math.cos(a[0]/2),f=Math.sin(a[2]/2),h=Math.sin(-a[1]/2),g=Math.sin(a[0]/2);b[0]=c*d*g+f*h*e;b[1]=f*d*g-c*h*e;b[2]=f*d*e+c*h*g;b[3]=c*d*e-f*h*g;return b};a.ordered_angles_to_quat=function(a,b,c){var d=a[0],e=a[1];a=a[2];var f=Math.cos(d/2),h=Math.cos(e/2),g=Math.cos(a/2),k=Math.sin(d/2),e=Math.sin(e/2),l=Math.sin(a/2);if(-1<W.indexOf(b))var m=Math.cos((d+a)/2),n=Math.sin((d+a)/2),p=Math.cos((d-a)/2),u=Math.sin((d-a)/2),r=Math.cos((a-d)/2),t=Math.sin((a-
d)/2);switch(b){case I:c[0]=h*n;c[1]=e*p;c[2]=e*u;c[3]=h*m;break;case Ea:c[0]=e*u;c[1]=h*n;c[2]=e*p;c[3]=h*m;break;case ka:c[0]=e*p;c[1]=e*u;c[2]=h*n;c[3]=h*m;break;case 3:c[0]=h*n;c[1]=e*t;c[2]=e*r;c[3]=h*m;break;case Aa:c[0]=e*r;c[1]=h*n;c[2]=e*t;c[3]=h*m;break;case V:c[0]=e*t;c[1]=e*r;c[2]=h*n;c[3]=h*m;break;case 6:c[0]=k*h*g+f*e*l;c[1]=f*e*g-k*h*l;c[2]=f*h*l+k*e*g;c[3]=f*h*g-k*e*l;break;case 7:c[0]=f*h*l+k*e*g;c[1]=k*h*g+f*e*l;c[2]=f*e*g-k*h*l;c[3]=f*h*g-k*e*l;break;case 8:c[0]=f*e*g-k*h*l;c[1]=
f*h*l+k*e*g;c[2]=k*h*g+f*e*l;c[3]=f*h*g-k*e*l;break;case 9:c[0]=k*h*g-f*e*l;c[1]=f*h*l-k*e*g;c[2]=f*e*g+k*h*l;c[3]=f*h*g+k*e*l;break;case 10:c[0]=f*e*g+k*h*l;c[1]=k*h*g-f*e*l;c[2]=f*h*l-k*e*g;c[3]=f*h*g+k*e*l;break;case 11:c[0]=f*h*l-k*e*g,c[1]=f*e*g+k*h*l,c[2]=k*h*g-f*e*l,c[3]=f*h*g+k*e*l}return c};a.quat_to_ordered_angles=function(a,b,c){var d=a[0],e=a[1],f=a[2];a=a[3];switch(b){case I:c[0]=Math.atan2(d*e+f*a,e*a-d*f);c[1]=Math.acos(1-2*(e*e+f*f));c[2]=Math.atan2(d*e-f*a,d*f+e*a);break;case Ea:c[0]=
Math.atan2(d*a+e*f,f*a-d*e);c[1]=Math.acos(1-2*(d*d+f*f));c[2]=Math.atan2(e*f-d*a,d*e+f*a);break;case ka:c[0]=Math.atan2(d*f+e*a,d*a-e*f);c[1]=Math.acos(1-2*(d*d+e*e));c[2]=Math.atan2(d*f-e*a,d*a+e*f);break;case 3:c[0]=Math.atan2(d*f-e*a,d*e+f*a);c[1]=Math.acos(1-2*(e*e+f*f));c[2]=Math.atan2(d*f+e*a,f*a-d*e);break;case Aa:c[0]=Math.atan2(d*e-f*a,d*a+e*f);c[1]=Math.acos(1-2*(d*d+f*f));c[2]=Math.atan2(d*e+f*a,d*a-e*f);break;case V:c[0]=Math.atan2(e*f-d*a,d*f+e*a);c[1]=Math.acos(1-2*(d*d+e*e));c[2]=
Math.atan2(d*a+e*f,e*a-d*f);break;case 6:c[0]=Math.atan2(2*(d*a-e*f),1-2*(d*d+e*e));c[1]=Math.asin(2*(d*f+e*a));c[2]=Math.atan2(2*(f*a-d*e),1-2*(e*e+f*f));break;case 7:c[0]=Math.atan2(2*(e*a-d*f),1-2*(e*e+f*f));c[1]=Math.asin(2*(d*e+f*a));c[2]=Math.atan2(2*(d*a-e*f),1-2*(d*d+f*f));break;case 8:c[0]=Math.atan2(2*(f*a-d*e),1-2*(d*d+f*f));c[1]=Math.asin(2*(d*a+e*f));c[2]=Math.atan2(2*(e*a-d*f),1-2*(d*d+e*e));break;case 9:c[0]=Math.atan2(2*(d*a+e*f),1-2*(d*d+f*f));c[1]=Math.asin(2*(f*a-d*e));c[2]=Math.atan2(2*
(d*f+e*a),1-2*(e*e+f*f));break;case 10:c[0]=Math.atan2(2*(d*f+e*a),1-2*(d*d+e*e));c[1]=Math.asin(2*(d*a-e*f));c[2]=Math.atan2(2*(d*e+f*a),1-2*(d*d+f*f));break;case 11:c[0]=Math.atan2(2*(d*e+f*a),1-2*(e*e+f*f)),c[1]=Math.asin(2*(e*a-d*f)),c[2]=Math.atan2(2*(d*a+e*f),1-2*(d*d+e*e))}return c};a.ZI=function(a){var b=H.create(),c=Math.cos(a[0]),d=Math.cos(a[1]),e=Math.cos(a[2]),f=Math.sin(a[0]),h=Math.sin(a[1]);a=Math.sin(a[2]);var g=c*e,k=c*a,l=f*e,m=f*a;b[0]=d*e;b[1]=d*a;b[2]=-h;b[3]=h*l-k;b[4]=h*m+
g;b[5]=d*f;b[6]=h*g+m;b[7]=h*k-l;b[8]=d*c;return b};a.quat_to_euler=function(a,b){var c=a[0],d=a[1],e=a[2],f=a[3],h=e*e,g=c*d+e*f;.499999<g?(b[0]=0,b[1]=2*Math.atan2(c,f),b[2]=Math.PI/2):-.499999>g?(b[0]=0,b[1]=-2*Math.atan2(c,f),b[2]=-Math.PI/2):(b[0]=Math.atan2(2*c*f-2*d*e,1-2*c*c-2*h),b[1]=Math.atan2(2*d*f-2*c*e,1-2*d*d-2*h),b[2]=Math.asin(2*c*d+2*e*f));return b};a.quat_to_dir=function(a,b,c){c||(c=new Float32Array(3));z.transformQuat(b,a,c);return c};a.dir_to_quat=function(a,b,c){c||(c=new Float32Array(4));
a=z.normalize(a,G);var d=z.dot(b,a);a=z.cross(b,a,J);d=Math.acos(d);c[0]=a[0]*Math.sin(d/2);c[1]=a[1]*Math.sin(d/2);c[2]=a[2]*Math.sin(d/2);c[3]=Math.cos(d/2);return c};a.$N=function(a,b,c,d){d||(d=new Float32Array(4));z.transformQuat(c,b,d);d[3]=-z.dot(a,d)};a.II=function(a){var b=P.get_quat_view(a.k.n),c=G;switch(a.type){case "CAMERA":c[0]=0;c[1]=-1;c[2]=0;z.transformQuat(c,b,c);J[0]=0;J[1]=0;J[2]=-1;break;case "MESH":c[0]=0;c[1]=0;c[2]=1;z.transformQuat(c,b,c);J[0]=0;J[1]=0;J[2]=1;break;case "EMPTY":c[0]=
0,c[1]=1,c[2]=0,z.transformQuat(c,b,c),J[0]=0,J[1]=1,J[2]=0}c[1]=0;z.normalize(c,c);a=z.dot(c,J);return Math.acos(a)*(0<-c[0]*J[2]?-1:1)};a.ny=function(a,b,c,d){if(0!=c){d=d||[];for(var e=0;e<a.length;e++)d[e]=(1-c)*a[e]+c*b[e]}};a.eS=function(){M++;return M.toString(16)};a.rp=function(a){E[a]||(E[a]=0);var b=a+E[a];E[a]++;return b};a.If=function(){return{a_position:new Float32Array(0),a_tbn_quat:new Float32Array(0)}};a.gen_tbn_quats=function(a,b,d){b=b||A();var e=b.length,f=a.length/3;d=d||new Float32Array(4*
f);for(var h=0;h<f;++h){var g=G;g[0]=a[3*h];g[1]=a[3*h+1];g[2]=a[3*h+2];var k;e?(k=O,k[0]=b[4*h],k[1]=b[4*h+1],k[2]=b[4*h+2],k[3]=b[4*h+3]):k=b;c(g,k,d.subarray(4*h,4*(h+1)))}return d};a.dA=c;a.tQ=function(a){var b={a_influence:new Float32Array(0),a_color:new Float32Array(0),a_texcoord:new Float32Array(0)};return{name:a,sa:0,lb:null,P:[],aa:b,La:[],Xe:{Y:m_bounds.Mc(),va:m_bounds.Ge(),J:m_bounds.Mc(),Z:m_bounds.Ge()},Qf:null}};a.ih=function(a){return JSON.parse(JSON.stringify(a))};a.L=function(b){if(!(b instanceof
Object))return b;var c;c=b.constructor;switch(c){case Int8Array:case Uint8Array:case Int16Array:case Uint16Array:case Int32Array:case Uint32Array:case Float32Array:case Float64Array:c=new c(b);break;case Array:c=new c(b.length);for(var d=0;d<b.length;d++)c[d]=a.L(b[d]);break;default:for(d in c=new c,b)c[d]=a.L(b[d])}return c};a.Fn=function(a){var b=a instanceof Array?[]:{},c;for(c in a)if(a[c]instanceof Object){var d=a[c].constructor;switch(d){case Int8Array:case Uint8Array:case Int16Array:case Uint16Array:case Int32Array:case Uint32Array:case Float32Array:case Float64Array:b[c]=
new d(a[c]);break;case Array:b[c]=a[c].slice(0);break;default:b[c]=a[c]}}else b[c]=a[c];return b};a.matrix_to_quat=b;a.SA=function(a,b){b||(b=new Float32Array(3));b[0]=a[12];b[1]=a[13];b[2]=a[14];return b};a.RA=function(a){L[0]=.577350269189626;L[1]=.577350269189626;L[2]=.577350269189626;L[3]=0;l.transformMat4(L,a,L);return l.length(L)};a.Fl=function(a,b){var c=b.left,d=b.right,e=b.top,f=b.bottom,h=b.near,g=b.far;c[0]=a[3]+a[0];c[1]=a[7]+a[4];c[2]=a[11]+a[8];c[3]=a[15]+a[12];d[0]=a[3]-a[0];d[1]=a[7]-
a[4];d[2]=a[11]-a[8];d[3]=a[15]-a[12];e[0]=a[3]-a[1];e[1]=a[7]-a[5];e[2]=a[11]-a[9];e[3]=a[15]-a[13];f[0]=a[3]+a[1];f[1]=a[7]+a[5];f[2]=a[11]+a[9];f[3]=a[15]+a[13];h[0]=a[3]+a[2];h[1]=a[7]+a[6];h[2]=a[11]+a[10];h[3]=a[15]+a[14];g[0]=a[3]-a[2];g[1]=a[7]-a[6];g[2]=a[11]-a[10];g[3]=a[15]-a[14];n(c);n(d);n(e);n(f);n(h);n(g)};a.GN=function(a,b,c){return c<-h.point_plane_dist(a,b.near)||c<-h.point_plane_dist(a,b.left)||c<-h.point_plane_dist(a,b.right)||c<-h.point_plane_dist(a,b.top)||c<-h.point_plane_dist(a,
b.bottom)||c<-h.point_plane_dist(a,b.far)?!0:!1};a.UI=function(a,b,c,d,e){var f=z.dot(c,b.far),g=z.dot(d,b.far),k=z.dot(e,b.far),f=Math.sqrt(f*f+g*g+k*k);if(f<-h.point_plane_dist(a,b.near)||f<-h.point_plane_dist(a,b.far))return!0;f=z.dot(c,b.left);g=z.dot(d,b.left);k=z.dot(e,b.left);if(Math.sqrt(f*f+g*g+k*k)<-h.point_plane_dist(a,b.left))return!0;f=z.dot(c,b.right);g=z.dot(d,b.right);k=z.dot(e,b.right);if(Math.sqrt(f*f+g*g+k*k)<-h.point_plane_dist(a,b.right))return!0;f=z.dot(c,b.top);g=z.dot(d,b.top);
k=z.dot(e,b.top);if(Math.sqrt(f*f+g*g+k*k)<-h.point_plane_dist(a,b.top))return!0;f=z.dot(c,b.bottom);g=z.dot(d,b.bottom);k=z.dot(e,b.bottom);return Math.sqrt(f*f+g*g+k*k)<-h.point_plane_dist(a,b.bottom)?!0:!1};a.nm=function(a,b,c,d){d||(d=0);for(var e=a.length,f=0;f<e;f+=3){var h=a[f],g=a[f+1],k=a[f+2];c[d+f]=b[0]*h+b[4]*g+b[8]*k+b[12];c[d+f+1]=b[1]*h+b[5]*g+b[9]*k+b[13];c[d+f+2]=b[2]*h+b[6]*g+b[10]*k+b[14]}};a.iS=function(a,b,c,d){d||(d=0);for(var e=a.length,f=0;f<e;f+=3){var h=a[f],g=a[f+1],k=a[f+
2];c[d+f]=b[0]*h+b[4]*g+b[8]*k;c[d+f+1]=b[1]*h+b[5]*g+b[9]*k;c[d+f+2]=b[2]*h+b[6]*g+b[10]*k}return c};a.WN=function(a,b,c){var d;d=0;for(var e=a.length,f=0;f<e;f+=4){ca[0]=a[f];ca[1]=a[f+1];ca[2]=a[f+2];ca[3]=a[f+3];var h=0<ca[3];p.multiply(b,ca,ca);(h&&0>ca[3]||!h&&0<ca[3])&&l.scale(ca,-1,ca);c[d+f]=ca[0];c[d+f+1]=ca[1];c[d+f+2]=ca[2];c[d+f+3]=ca[3]}};a.cP=function(a,b,c){c||(c=new Float32Array(3));L[0]=a[0];L[1]=a[1];L[2]=a[2];L[3]=0;l.transformMat4(L,b,L);c[0]=L[0];c[1]=L[1];c[2]=L[2]};a.FQ=function(a,
b){var c=a.length;c||r("flatten(): Wrong or empty array");var d=a[0].length;d||r("flatten(): Wrong or empty subarray");b||(b=new Float32Array(c*d));for(var e=0;e<c;e++)for(var f=0;f<d;f++)b[e*d+f]=a[e][f];return b};a.dP=function(a){for(var b=[],c=0;c<a.length;c+=3){var d=new Float32Array([a[c],a[c+1],a[c+2]]);b[c/3]=d}return b};a.dq=function(b,c,d,e){if(e<d)return d;var f=d+Math.floor((e-d)/2);return b[f]>c?a.dq(b,c,d,f-1):b[f]<c?a.dq(b,c,f+1,e):f};a.li=function(a,b){for(var c=0;c<a.length;c++)if(a[c]!=
b[c])return!1;return!0};a.oQ=function(a,b,c){for(var d=0;d<a.length;d++)if(Math.abs(a[d]-b[d])>c)return!1;return!0};a.KR=function(a,b,c){c||(c=new Float32Array(16));for(var d=0;12>d;d++)c[d]=a[d]*b;c[12]=a[12];c[13]=a[13];c[14]=a[14];c[15]=a[15];return c};a.bO=function(a,b,c,d,e){e||(e=new Float32Array(16));b=w.fromRotationTranslation(c,d,ga);w.multiply(b,a,e);return e};a.transform_vec3=function(a,b,c,d,e){e||(e=new Float32Array(3));c=w.fromRotationTranslation(c,d,ga);1!==b&&(d=w.identity(R),b=z.set(b,
b,b,G),w.scale(d,b,d),w.multiply(c,d,c));z.transformMat4(a,c,e);return e};a.bS=function(a,b,c,d,e){e||(e=new Float32Array(4));b=w.fromRotationTranslation(c,d,ga);l.transformMat4(a,b,e);return e};a.nR=function(a,b,c,d,e){e||(e=new Float32Array(3));b=w.fromRotationTranslation(c,d,ga);w.invert(b,b);z.transformMat4(a,b,e);return e};a.aS=function(a,b,c){c||(c=new Float32Array(16));w.fromRotationTranslation(b,a,c);a=a[3];for(b=0;12>b;b++)c[b]*=a;return c};a.AR=function(c,d,e){a.SA(c,d);d[3]=a.RA(c);b(c,
e)};a.ZP=function(a){for(var b=[],c=0;c<a.length;c++)b.push(a[c]);return JSON.stringify(b)};a.wM=function(a,b,c,d){d||(d=new Float32Array(3));var e=G;z.subtract(b,a,e);z.transformQuat(e,c,e);z.subtract(b,e,d)};a.AJ=function(){var a=G;a[0]=0;a[1]=0;a[2]=0;var b=new Float32Array(16),c=new Float32Array(16),d=new Float32Array(16),e=new Float32Array(16),f=new Float32Array(16),h=new Float32Array(16);w.lookAt(a,[-1,0,0],[0,-1,0],b);w.scale(b,[-1,1,1],b);w.scale(b,[-1,1,-1],c);w.lookAt(a,[0,-1,0],[0,0,-1],
d);w.scale(d,[1,1,-1],d);w.scale(d,[1,-1,-1],e);w.lookAt(a,[0,0,-1],[0,-1,0],f);w.scale(f,[-1,1,1],f);w.scale(f,[-1,1,-1],h);return[b,c,d,e,f,h]};a.EJ=function(){var a=G;a[0]=0;a[1]=0;a[2]=0;var b=new Float32Array(16),c=new Float32Array(16),d=new Float32Array(16),e=new Float32Array(16),f=new Float32Array(16),h=new Float32Array(16);w.lookAt(a,[1,0,0],[0,-1,0],b);w.scale(b,[-1,1,-1],c);w.lookAt(a,[0,1,0],[0,0,1],d);w.scale(d,[1,-1,-1],e);w.lookAt(a,[0,0,1],[0,-1,0],f);w.scale(f,[-1,1,-1],h);return[b,
c,d,e,f,h]};a.xy=function(a,b){return f(a,b)};a.hash_code=f;a.iR=g;a.qL=function(a,b){b[15]=1;b[14]=0;b[13]=0;b[12]=0;b[11]=0;b[10]=a[8];b[9]=a[7];b[8]=a[6];b[7]=0;b[6]=a[5];b[5]=a[4];b[4]=a[3];b[3]=0;b[2]=a[2];b[1]=a[1];b[0]=a[0];return b};a.quat_to_angle_axis=function(a,b){b||(b=a);var c=a[0]*a[0]+a[1]*a[1]+a[2]*a[2];0<c?(b[3]=2*Math.acos(a[3]),c=1/Math.sqrt(c),b[0]=a[0]*c,b[1]=a[1]*c,b[2]=a[2]*c):(b[3]=0,b[0]=1,b[1]=0,b[2]=0);return b};a.trunc=function(a){return isNaN(a)||"undefined"==typeof a?
NaN:a|0};a.deg_to_rad=function(a){return a*Math.PI/180};a.rad_to_deg=function(a){return 180*a/Math.PI};a.yw=function(a){var b=.366025403784439*a[0]+.366025403784439*a[1],c=Math.floor(a[0]+b),d=Math.floor(a[1]+b),e=.211324865405187*c+.211324865405187*d,b=a[0]-c+e;a=a[1]-d+e;var f=b>a?1:0,h=1-f,e=b+.211324865405187-f,g=a+.211324865405187-h,k=b+-.577350269189626,l=a+-.577350269189626,c=c%289,d=d%289,n=m(m(d)+c),h=m(m(d+h)+c+f),p=m(m(d+1)+c+1),c=Math.max(.5-(b*b+a*a),0),d=Math.max(.5-(e*e+g*g),0),f=Math.max(.5-
(k*k+l*l),0),u=2*v(.024390243902439*n)-1,r=2*v(.024390243902439*h)-1,t=2*v(.024390243902439*p)-1,n=Math.abs(u)-.5,h=Math.abs(r)-.5,p=Math.abs(t)-.5,u=u-Math.floor(u+.5),r=r-Math.floor(r+.5),t=t-Math.floor(t+.5),c=c*c*c*c*(1.79284291400159-.85373472095314*(u*u+n*n)),d=d*d*d*d*(1.79284291400159-.85373472095314*(r*r+h*h)),f=f*f*f*f*(1.79284291400159-.85373472095314*(t*t+p*p));return 130*(c*(u*b+n*a)+d*(r*e+h*g)+f*(t*k+p*l))};a.Cy=function(a){var b=1/7,c=b/2,e=d(Math.floor(a[0])),f=d(Math.floor(a[1])),
h=v(a[0]);a=v(a[1]);var g=h-.5,l=h-1.5,h=a-.5;a-=1.5;var m=x(e),n=x(e+1),p=m,e=n,m=x(m+f),n=x(n+f),p=x(p+f+1),e=x(e+f+1),f=g+.7*(k(m)*b+c),u=l+.7*(k(n)*b+c),g=g+.7*(k(p)*b+c),l=l+.7*(k(e)*b+c),m=h+.7*(k(Math.floor(m*b))*b+c),h=h+.7*(k(Math.floor(n*b))*b+c),p=a+.7*(k(Math.floor(p*b))*b+c),b=a+.7*(k(Math.floor(e*b))*b+c);return Math.min(f*f+m*m,u*u+h*h,g*g+p*p,l*l+b*b)};a.quat_project=function(a,b,c,d,e){e||(e=new Float32Array(4));a=z.transformQuat(b,a,G);b=c[0];var f=c[1];c=c[2];var h=U;h[0]=f*f+c*
c;h[1]=-f*b;h[2]=-c*b;h[3]=-b*f;h[4]=b*b+c*c;h[5]=-c*f;h[6]=-b*c;h[7]=-f*c;h[8]=b*b+f*f;z.transformMat3(a,h,a);z.normalize(a,a);p.rotationTo(d,a,e);return e};a.cam_quat_to_mesh_quat=function(a,b){b||(b=new Float32Array(4));var c=L,d=O,c=p.setAxisAngle([0,0,1],Math.PI,p.create()),d=p.setAxisAngle([1,0,0],Math.PI/2,p.create());p.multiply(c,d,c);p.multiply(a,c,b);return b};a.cleanup=function(){M=0;E={}};a.clamp=function(a,b,c){return Math.min(Math.max(a,b),c)};a.smooth=function(a,b,c,d){c=Math.exp(-c/
d);return(1-c)*a+c*b};a.smooth_v=function(a,b,c,d,e){e||(e=new Float32Array(a.length));c=Math.exp(-c/d);for(d=0;d<e.length;d++)e[d]=(1-c)*a[d]+c*b[d];return e};a.iC=function(a,b,c,d,e){e||(e=new Float32Array(a.length));p.slerp(a,b,Math.exp(-c/d),e)};a.cv=function(a){return"object"===typeof a&&a.buffer&&a.buffer instanceof ArrayBuffer?!0:!1};a.is_vector=function(a,b){if(a instanceof Array||a.buffer&&a.buffer instanceof ArrayBuffer)if(b&&b==a.length||!b)return!0;return!1};a.correct_cam_quat_up=function(a,
b){var c=H.fromQuat(a,U),d=G;d[0]=c[6];d[1]=c[7];d[2]=c[8];d=z.cross(sa,d,d);z.normalize(d,d);var e=c[4];!b&&0<e&&(d[0]*=-1,d[1]*=-1,d[2]*=-1);J[0]=c[0];J[1]=c[1];J[2]=c[2];z.normalize(J,J);c=O;p.rotationTo(J,d,c);p.multiply(c,a,a)};a.Qz=function(a,b,c,d){c=c*b-.5;var e=d*b-.5;d=c-Math.floor(c);var f=e-Math.floor(e);c=Math.floor(c);var e=Math.floor(e),h=b-1,g=a[e*b+c],k=a[e*b+Math.min(c+1,h)],l=a[Math.min(e+1,h)*b+c];a=a[Math.min(e+1,h)*b+Math.min(c+1,h)];return(g*(1-d)+k*d)*(1-f)+(l*(1-d)+a*d)*f};
a.Jk=function(a){for(var b=0,c=0;3>c;c++)0<(a&1<<c)&&b++;return b};a.JB=function(a){for(var b=[0,0,0],c=0;3>c;c++)0<(a&1<<c)&&(b[2-c]=1);return b};a.om=function(a,b){var c=0;(1==b||2==b)&&0<(a&4)&&c++;2==b&&0<(a&2)&&c++;return c};a.Fu=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0;return("x"==a?b:b&3|8).toString(16)})};a.no=function(a){var b=0,c;for(c in a)a.hasOwnProperty(c)&&b++;return b};a.random_from_array=function(a){if(!a.length)return null;
var b=Math.floor(Math.random()*a.length);return a[b]};a.horizontal_direction=function(a,b,c){c||(c=new Float32Array(3));c[0]=a[0]-b[0];c[1]=a[1]-b[1];c[2]=0;z.normalize(c,c)};a.aO=function(a,b,c){var d=a[0],e=a[1];a=a[2];var f=b[0],h=b[1],g=b[2];b=b[3];var k=h*a-g*e,l=g*d-f*a,m=f*e-h*d,n=h*m-g*l,g=g*k-f*m,f=f*l-h*k;c[0]=d+2*k*b+2*n;c[1]=e+2*l*b+2*g;c[2]=a+2*m*b+2*f};a.assert=function(a){a||r("Assertion failed")};a.r=r;a.angle_wrap_periodic=C;a.angle_wrap_0_2pi=B;a.Ku=function(a){return/(?:\.([^.]+))?$/.exec(a)[1]};
a.vC=function(a,b){for(var c in a){var d=!0,e=a[c],f=b[c];switch(typeof e){case "number":case "string":case "boolean":d=e==f;break;case "object":d=F(e,f)}if(!d)return!1}return!0};a.Xv=function(a,b){var c=a[0],d=a[2],e=a[3];b[0]=a[1];b[1]=d;b[2]=e;b[3]=c};a.Jz=function(a){a+=1;132651<a&&u.error("Color ID pool depleted");var b=Math.floor(a/2601);a%=2601;var c=Math.floor(a/51);return new Float32Array([b/51,c/51,a%51/51])};a.line_plane_intersect=function(a,b,c,d){L.set(a);L[3]=b;a=O;G[0]=c[3];G[1]=c[4];
G[2]=c[5];a.set(G);a[3]=0;a=l.dot(L,a);if(0==a)return null;b=O;z.copy(c,G);b.set(G);b[3]=1;a=-l.dot(L,b)/a;d[0]=c[0]+a*c[3];d[1]=c[1]+a*c[4];d[2]=c[2]+a*c[5];return d};a.hK=function(a,b,c,d){var e=b[0]-a[0],f=c[0]-a[0],h=b[1]-a[1],g=c[1]-a[1];b=b[2]-a[2];a=c[2]-a[2];d[0]=h*a-b*g;d[1]=f*b-e*a;d[2]=e*g-h*f;return d};a.qQ=function(a,b){for(var c=0;c<a.length;c++)b[c]=a[c];return b};a.LB=function(a,b,c){var d=G,e=z.dot(a,b);-.9999999>e?(z.cross(na,a,d),1E-6>z.length(d)&&z.cross(ra,a,d),z.normalize(d,
d),p.setAxisAngle(d,Math.PI,c)):(z.cross(a,b,d),c.set(d),c[3]=1+e,p.normalize(c,c));return c};a.Hj=function(a,b,c){if(b==c)return c-a;a=B(a);b=B(b);c=B(c);b=2*Math.PI-b;c=B(c+b);a=B(a+b);return a>c?(c-=a,a=2*Math.PI-a,-c>a?a:c):0};a.smooth_step=function(a,b,c){isFinite(b)&&isFinite(c)&&(a=clamp(a,b,c));return a*a*(3-2*a)};a.lerp=function(a,b,c){return b+a*(c-b)};a.eG=function(a,b){for(var c=0;c<a.length;c++)for(var d=0;d<b.length;d++)if(b[d]==a[c])return!0;return!1};a.xQ=function(a){for(var b=Array(a),
c=0;c<a;c++)b[c]=0;return b};a.jD=function(a,b){for(var c=Math.max(a.length,b.length),d=0;d<c;d++){var f=e((d>=a.length?0:a[d])-(d>=b.length?0:b[d]));if(f)return f}return 0};a.mj=function(a){return a.join(".")};a.tC=function(a){return a.split(".").map(function(a){return a|0})};a.oC=function(a,b){b[0]=Math.pow(a[0],2.2);b[1]=Math.pow(a[1],2.2);b[2]=Math.pow(a[2],2.2)};a.jv=function(a,b){b[0]=Math.pow(a[0],1/2.2);b[1]=Math.pow(a[1],1/2.2);b[2]=Math.pow(a[2],1/2.2);return b};a.Jo=function(a){var b=a.split("://",
2);return 1<b.length?(b[1]=y(b[1]),b.join("://")):y(a)};a.Bn=function(a){return 0!=parseInt(a.toString(2).substr(1),2)};a.TI=function(a,b,c,d){d[0]=a[0];d[1]=b[0];d[2]=c[0];d[3]=a[1];d[4]=b[1];d[5]=c[1];d[6]=a[2];d[7]=b[2];d[8]=c[2];return d};a.pi=A};b4w.module.__sfx=function(a,q){function e(){var a=window.AudioContext||window.webkitAudioContext;if(a){try{var b=new a}catch(c){return D.error('Unable to initialize AudioContext: "'+c+'". The audio is disabled.'),null}if(b.createGain)return b;D.warn("deprecated WebAudio implementation");return null}D.warn("WebAudio is not supported");return null}function c(a,c,d){var e=a.M;if("NONE"!=e.behavior){var h=e.loop,k=e.pitch;if(e.src&&(h||0<=d)){e.Et=Math.floor(5E4*Math.random());var l=W.currentTime+c,l=
Math.max(0,l);e.se=l;e.state=20;var n=G.qc;"POSITIONAL"==e.behavior&&"none"==n.Wn&&(e.behavior="BACKGROUND_SOUND");b(a,G.qc);if("POSITIONAL"==e.behavior||"BACKGROUND_SOUND"==e.behavior){c=W.createBufferSource();c.buffer=e.src;c.playbackRate.value=k;if(h){e.Jb&&e.Jb.disconnect();e.gd&&e.gd.disconnect();c.loop=!0;c.loopStart=e.OA;if(c.loopEnd=e.Br)d=W.createBufferSource(),d.buffer=e.src,d.playbackRate.value=k,e.gd=d,d.connect(e.cd);c.start(l);e.duration=0}else h=c.buffer?c.buffer.duration:0,d>h?(h=
l+d+e.Ke,c.loop=!0,c.start(l),c.stop(h),e.duration=d):(c.loop=!1,c.start(l),e.duration=h);c.connect(e.cd);e.Jb=c;f(e);t(e);g(e)}else"BACKGROUND_MUSIC"==e.behavior&&(A.clear_timeout(e.Ft),A.clear_timeout(e.Gt),d=function(){var b=a.M,c=b.src;c&&(c.volume=1,c.loop=b.loop,b.Jb=b.Jb||W.createMediaElementSource(c),b.Jb.connect(b.cd),20==b.state&&(c.currentTime&&(c.currentTime=0),c.play()))},0==c?d():e.Ft=A.set_timeout(d,1E3*c),e.duration=h?0:B(a));m(e,l)}}}function b(a,b){var c=a.M;if(!c.cd){var d=H.get_trans_view(a.k.n),
e=H.get_quat_view(a.k.n);if(P.Ir){var f=W.createBiquadFilter();f.type="peaking"}else f=null;var g=W.createGain();switch(c.behavior){case "POSITIONAL":var k=W.createPanner();"string"!=typeof k.panningModel?(k.panningModel=k.EQUALPOWER,k.distanceModel=k.INVERSE_DISTANCE):(k.panningModel="equalpower",k.distanceModel=b.Wn);k.setPosition(d[0],d[1],d[2]);h.copy(d,c.ev);d=p;w.quat_to_dir(e,w.AXIS_MZ,d);k.setOrientation(d[0],d[1],d[2]);k.refDistance=c.dist_ref;k.maxDistance=c.dist_max;k.rolloffFactor=c.attenuation;
k.coneInnerAngle=c.Ty;k.coneOuterAngle=c.Uy;k.coneOuterGain=c.Vy;var l=W.createGain();l.gain.value=C(c);f?(k.connect(f),f.connect(l)):k.connect(l);l.connect(g);c.cd=k;if(c.$k){var m=W.createGain();g.connect(m);m.connect(b.cd)}else m=null,g.connect(b.cd);break;case "BACKGROUND_SOUND":k=null;l=W.createGain();l.gain.value=C(c);f?(c.cd=f,f.connect(l)):c.cd=l;l.connect(g);c.$k?(m=W.createGain(),g.connect(m),m.connect(b.cd)):(m=null,g.connect(b.cd));break;case "BACKGROUND_MUSIC":m=k=null,l=W.createGain(),
l.gain.value=C(c),f?(c.cd=f,f.connect(l)):c.cd=l,l.connect(g),g.connect(b.cd)}c.Nv=k;c.Of=f;c.Ll=l;c.si=g;c.Zv=m}}function n(a){var b=a.M,d=b.duration,b=b.delay+b.lz*Math.random();c(a,b,d)}function f(a){var b=a.gd||a.Jb;w.of(b.onended)&&(b.onended=function(){a.state=50})}function t(a){a.$k&&a.Zv.gain.cancelScheduledValues(a.se);a.mm&&(a.Jb.playbackRate.cancelScheduledValues(a.se),a.gd&&a.gd.playbackRate.cancelScheduledValues(a.se));a.Bp=a.se}function g(a){if(a.$k||a.mm){var b=a.Zv,c=a.Jb,d=c.buffer?
c.buffer.duration:0;if(d){var e=a.se;Z[0]=a.Et;for(var f=0;5>f;){var h=a.pitch+a.mm*w.vf(Z);if(e>=a.Bp){if(a.$k){var g=1-w.clamp(a.$k,0,1)*Math.random();b.gain.setValueAtTime(g,e)}a.mm&&(c.playbackRate.setValueAtTime(h,e),a.gd&&a.gd.playbackRate.setValueAtTime(h,e));f++}e+=d/h}a.Bp=e-.001}}}function m(a,b){if(a.$j||a.Ke){var c=a.si;c.gain.cancelScheduledValues(b);a.$j?(c.gain.setValueAtTime(0,b),c.gain.linearRampToValueAtTime(1,b+a.$j)):c.gain.setValueAtTime(1,b);a.Ke&&!a.loop&&(c.gain.setValueAtTime(1,
b+a.duration),c.gain.linearRampToValueAtTime(0,b+a.duration+a.Ke))}}function v(a){"SPEAKER"!=a.type&&w.r("Wrong object type");var b=a.M;if(50==b.state)b.state=30;else if(20==b.state||40==b.state){var c=b.si,d=W.currentTime;b.Ke&&(c.gain.setValueAtTime(c.gain.value,d),c.gain.linearRampToValueAtTime(0,d+b.Ke));"BACKGROUND_MUSIC"==b.behavior?b.src&&(A.clear_timeout(b.Ft),A.clear_timeout(b.Gt),b.Gt=A.set_timeout(function(){var b=a.M.src;b&&(b.currentTime&&(b.currentTime=0),b.pause())},1E3*b.Ke)):(c=b.Jb,
b.duration<c.buffer.duration?b.Ke&&20==b.state?c.stop(d+b.Ke):20==b.state&&(c.stop(0),c.disconnect()):c.disconnect(),b.se=0,b.Pv=0,b.Kt=0);b.state=30}}function x(a){a=a.M;if(20==a.state){var b=W.currentTime;a.Pv=b;if("BACKGROUND_MUSIC"==a.behavior){var c=a.src;c&&c.pause()}else{if(b>a.se){Z[0]=a.Et;for(var d=a.Jb.buffer.duration,e=a.se;e<b;)c=a.pitch+a.mm*w.vf(Z),e+=d/c;c*=d/c-(e-b)}else c=0;a.Kt=c;a.Jb.stop(0);a.Jb.disconnect();t(a)}a.state=40}}function d(a){var b=a.M;if(40==b.state){var c=W.currentTime;
b.se+=c-b.Pv;if("BACKGROUND_MUSIC"==b.behavior)b.src.play();else{a=a.M;var d=W.createBufferSource();d.loop=a.Jb.loop;d.loopStart=a.Jb.loopStart;d.loopEnd=a.Jb.loopEnd;d.buffer=a.Jb.buffer;d.playbackRate.value=a.Jb.playbackRate.value;d.connect(a.cd);a.Jb=d;a.gd&&(d=W.createBufferSource(),d.loop=a.gd.loop,d.buffer=a.gd.buffer,d.playbackRate.value=a.gd.playbackRate.value,d.connect(a.cd),a.gd=d);b.Bp=c;c=b.Jb;f(b);c.start(b.se,b.Kt);g(b)}m(b,b.se);b.state=20}}function k(a,b,c){var d=1,d=b.LI;if(0<d){var e=
b.FN;if(0!=h.dot(a.Ss,a.Ss)||0!=h.dot(b.wk,b.wk)){var f=h.subtract(a.ev,b.Eg,p),g=h.length(f);b=h.dot(f,b.wk)/g;f=h.dot(f,a.Ss)/g;f=-f;g=e/d;b=Math.min(-b,g);f=Math.min(f,g);d=(e-d*b)/(e-d*f);isFinite(d)||(d=0);d=Math.min(d,16);d=Math.max(d,.125);d=w.smooth(d,a.FA,c,.3);a.Jb.playbackRate.value=d;a.FA=d}}}function r(a){a=a.M;return!a||20!=a.state&&40!=a.state&&30!=a.state&&50!=a.state?!1:!0}function C(a){return a.muted?0:a.volume}function B(a){a=a.M;return(a=a.src)?a.duration:0}var F=q("__config"),
D=q("__print"),y=q("__quat"),A=q("__time"),H=q("__tsr"),w=q("__util"),h=q("__vec3"),u=F.v,P=F.M,p=new Float32Array(3),z=new Float32Array(3);new Float32Array(3);var l=y.create(),M=[],E=[],W=null,G=null,J=[],Z=[1],L=null;a.wx=10;a.et=20;a.vx=30;a.PH=function(){return{lj:-1,zg:"",behavior:"NONE",muted:!1,volume:1,pitch:1,attenuation:1,dist_ref:1,dist_max:1E4,Ty:360,Uy:360,Vy:1,autoplay:!1,cyclic:!1,loop:!1,OA:0,Br:0,delay:0,lz:0,$k:0,mm:0,$j:0,Ke:0,se:0,Pv:0,Kt:0,duration:0,Bp:0,Et:1,src:null,state:10,
ev:new Float32Array(3),Ss:new Float32Array(3),Fq:!1,FA:1,Ft:-1,Gt:-1,Wj:0,cd:null,Jb:null,gd:null,Nv:null,Of:null,Ll:null,si:null,Zv:null,jj:0}};a.init=function(){var a=document.createElement("audio"),b=document.createElement("video");a.canPlayType&&(""!=a.canPlayType("audio/ogg")&&(M.push("ogg"),M.push("ogv"),M.push("oga")),""!=a.canPlayType("audio/mpeg")&&M.push("mp3"),""!=a.canPlayType("audio/mp4")&&(M.push("mp4"),M.push("m4v"),M.push("m4a")),""!=a.canPlayType("audio/webm")&&M.push("webm"));b.canPlayType&&
(""!=b.canPlayType("video/ogg")&&(E.push("ogv"),E.push("ogg"),E.push("oga")),""!=b.canPlayType("video/mp4")&&(E.push("m4v"),E.push("mp4")),""!=b.canPlayType("video/webm")&&E.push("webm"),""!=b.canPlayType("video/mpeg")&&E.push("mp3"))};a.lG=function(a){P.ox&&!W&&(W=e())&&D.log("%cINIT WEBAUDIO: "+W.sampleRate+"Hz","color: #00a");if(W){var b={Eg:new Float32Array(3),wk:new Float32Array(3),jj:0},c=W.createGain(),d=W.createGain();b.Ll=c;b.si=d;c.connect(d);d.connect(W.destination);if(a.b4w_enable_dynamic_compressor){var d=
W.createDynamicsCompressor(),f=a.b4w_dynamic_compressor_settings;d.threshold.value=f.threshold;d.knee.value=f.knee;d.ratio.value=f.ratio;d.attack.value=f.attack;d.release.value=f.release;d.connect(c);b.Mn=d;b.cd=d}else b.Mn=null,b.cd=c;switch(a.audio_distance_model){case "INVERSE":case "INVERSE_CLAMPED":b.Wn="inverse";break;case "LINEAR":case "LINEAR_CLAMPED":b.Wn="linear";break;case "EXPONENT":case "EXPONENT_CLAMPED":b.Wn="exponential";break;case "NONE":b.Wn="none";break;default:w.r("Wrong audio distance model")}b.LI=
a.audio_doppler_factor;b.FN=a.audio_doppler_speed;b.muted=!1;b.volume=a.audio_volume;c.gain.value=C(b);b.Wj=0}else b=null;a.qc=b};a.EM=function(a){G=a};a.detect_audio_container=function(a){a||(a="ogg");return-1<M.indexOf(a)?a:-1<M.indexOf("m4a")?"m4a":-1<M.indexOf("oga")?"oga":""};a.detect_video_container=function(a){a||(a="webm");return-1<E.indexOf(a)?a:-1<E.indexOf("m4v")?"m4v":-1<E.indexOf("webm")?"webm":""};a.kj=function(a,b){var c=a.data,d=b.M;d.lj=a.data.sound.uuid;d.zg=a.data.sound.filepath;
switch(c.b4w_behavior){case "POSITIONAL":case "BACKGROUND_SOUND":d.behavior=W?c.b4w_behavior:"NONE";break;case "BACKGROUND_MUSIC":var e;W?(window.MediaElementAudioSourceNode?e=!0:(D.warn("MediaElementAudioSourceNode not found"),e=!1),e=e&&!u.Ly?"BACKGROUND_MUSIC":"BACKGROUND_SOUND"):e="NONE";d.behavior=e;break;default:w.r("Wrong speaker behavior")}c.sound||(d.behavior="NONE");d.Fq=c.b4w_enable_doppler;d.muted=c.muted;d.volume=c.volume;d.pitch=c.pitch;d.attenuation=c.attenuation;d.dist_ref=c.distance_reference;
d.dist_max=c.distance_max||1E4;d.Ty=c.cone_angle_inner;d.Uy=c.cone_angle_outer;d.Vy=c.cone_volume_outer;d.autoplay=c.b4w_auto_play;d.cyclic=c.b4w_cyclic_play;d.loop=c.b4w_loop;d.OA=c.b4w_loop_start;d.Br=c.b4w_loop_end;d.delay=c.b4w_delay;d.lz=c.b4w_delay_random;d.$k=c.b4w_volume_random;d.mm=c.b4w_pitch_random;d.$j=c.b4w_fade_in;d.Ke=c.b4w_fade_out;J.push(b)};a.kC=function(b){"SPEAKER"!=b.type&&w.r("Wrong object type");switch(b.M.behavior){case "POSITIONAL":return a.et;case "BACKGROUND_SOUND":return a.et;
case "BACKGROUND_MUSIC":return a.vx;case "NONE":return a.wx;default:w.r("Wrong speaker behavior")}};a.IO=function(a,b){var c=a.M;switch(c.behavior){case "POSITIONAL":case "BACKGROUND_SOUND":case "BACKGROUND_MUSIC":c.src=b;break;case "NONE":break;default:w.r("Wrong speaker behavior")}};a.sB=function(){var a=W.createBufferSource();a.buffer=W.createBuffer(1,22050,22050);a.connect(W.destination);a.start(0)};a.EI=function(a,b,c){W?W.decodeAudioData(a,b,c):c()};a.CN=function(a){v(a);a.M=null;J.splice(J.indexOf(a),
1)};a.cleanup=function(){for(var a=0;a<J.length;a++){var b=J[a].M;"BACKGROUND_MUSIC"==b.behavior?(b=b.src)&&b.pause():(b.Jb&&b.Jb.disconnect(),b.gd&&b.gd.disconnect())}G&&G.qc&&(a=G.qc,a.Eg[0]=0,a.Eg[1]=0,a.Eg[2]=0,a.wk[0]=0,a.wk[1]=0,a.wk[2]=0);G=null;J.splice(0);L=null};a.update=function(a){if(W&&0!=J.length){for(var b=0;b<J.length;b++){var c=J[b],d=c.M,e=d.Jb,f=W.currentTime;!d.loop&&20==d.state&&d.duration&&d.se+d.duration<f&&("BACKGROUND_MUSIC"==d.behavior||e&&!w.of(e.onended))&&(d.state=50);
d.cyclic&&50==d.state&&n(c);20==d.state&&3>d.Bp-f&&g(d)}L&&L.Lh.length&&(-1==L.hc||a>L.Vx+L.qz[L.hc])&&(b=L,-1<b.hc&&v(b.Lh[b.hc]),-1==b.hc&&b.random?c=Math.round(Math.random()*(b.Lh.length-1)):b.random?(c=1+Math.round(Math.random()*(b.Lh.length-2)),c=(b.hc+c)%b.Lh.length):c=(b.hc+1)%b.Lh.length,n(b.Lh[c]),b.hc=c,b.Vx=a)}};a.play=c;a.play_def=n;a.stop=v;a.is_playing=function(a){return 20==a.M.state};a.BN=x;a.DN=d;a.loop_stop=function(a,b){var c=a.M,d=c.gd;if(r(a)&&("POSITIONAL"==c.behavior||"BACKGROUND_SOUND"==
c.behavior)&&d){var e=W.currentTime+b;c.Jb.stop(e);d.start(e,c.Br)}};a.playrate=function(a,b){var c=a.M;c.pitch=b;!r(a)||"POSITIONAL"!=c.behavior&&"BACKGROUND_SOUND"!=c.behavior||(c.Jb.playbackRate.value=b,c.gd&&(c.gd.playbackRate.value=b),t(c),g(c))};a.get_playrate=function(a){return a.M.pitch};a.cyclic=function(a,b){a.M.cyclic=Boolean(b)};a.BK=function(a){return a.M.autoplay};a.is_cyclic=function(a){return a.M.cyclic};a.eL=function(a,b,c,d,e){if(a=a.qc){var f=p;f[0]=0;f[1]=-1;f[2]=0;h.transformQuat(f,
c,f);z[0]=0;z[1]=0;z[2]=-1;h.transformQuat(z,c,z);c=W.listener;c.setPosition(b[0],b[1],b[2]);c.setOrientation(f[0],f[1],f[2],z[0],z[1],z[2]);if(d&&a.jj!=e){if(a.listener_stride)a.listener_stride=!1,h.copy(b,a.Eg);else for(c=a.wk,c[0]=(b[0]-a.Eg[0])/d,c[1]=(b[1]-a.Eg[1])/d,c[2]=(b[2]-a.Eg[2])/d,h.copy(b,a.Eg),b=0;b<J.length;b++)c=J[b],f=c.M,r(c)&&"POSITIONAL"==f.behavior&&f.Fq&&k(f,a,d);a.jj=e}else h.copy(b,a.Eg)}};a.listener_stride=function(){var a=G.qc;a&&(a.listener_stride=!0)};a.EN=function(a,
b,c){var d=a.M;if(r(a)&&"POSITIONAL"==d.behavior){var e=H.bc(a.k.n,p);a=H.ud(a.k.n,l);var f=d.Nv;f.setPosition(e[0],e[1],e[2]);w.quat_to_dir(a,w.AXIS_MZ,z);f.setOrientation(z[0],z[1],z[2]);d.Fq&&(a=d.ev,b&&d.jj!=c?(d.Ve?(h.copy(e,a),d.Ve=!1):(f=d.Ss,f[0]=(e[0]-a[0])/b,f[1]=(e[1]-a[1])/b,f[2]=(e[2]-a[2])/b,h.copy(e,a),k(d,G.qc,b)),d.jj=c):h.copy(e,a))}};a.speaker_stride=function(a){var b=a.M;r(a)&&"POSITIONAL"==b.behavior&&b.Fq&&(b.Ve=!0)};a.Pu=function(a){return a.M.behavior};a.check_active_speakers=
function(){for(var a=0;a<J.length;a++)if(r(J[a]))return!0;return!1};a.$M=function(a){var b=G.qc;b&&(b.volume=a,W&&(b.Ll.gain.value=C(b)))};a.eK=function(){var a=G.qc;return a?a.volume:0};a.set_volume=function(a,b){var c=a.M;c.volume=b;r(a)&&(c.Ll.gain.value=C(c))};a.get_volume=function(a){return a.M.volume};a.mute=function(a,b){a.M.muted=Boolean(b);r(a)&&(a.M.Ll.gain.value=C(a.M))};a.is_muted=function(a){return a.M.muted};a.EL=function(a){var b=G.qc;b&&(b.muted=Boolean(a),W&&(b.Ll.gain.value=C(b)))};
a.JK=function(){var a=G.qc;return a?a.muted:!1};a.get_speaker_objects=function(){return J};a.pause=function(){for(var a=0;a<J.length;a++)x(J[a])};a.resume=function(){for(var a=0;a<J.length;a++)d(J[a])};a.set_compressor_params=function(a,b){if(a.qc&&a.qc.Mn){var c=a.qc.Mn;c.threshold.value=b.threshold;c.knee.value=b.knee;c.ratio.value=b.ratio;c.attack.value=b.attack;c.release.value=b.release}};a.get_compressor_params=function(a){if(!a.qc||!a.qc.Mn)return null;a=a.qc.Mn;return{threshold:a.threshold.value,
knee:a.knee.value,ratio:a.ratio.value,attack:a.attack.value,release:a.release.value}};a.duck=function(a,b,c){if(r(a)){a=a.M;var d=a.si,e=W.currentTime;d.gain.setValueAtTime(d.gain.value,e);d.gain.linearRampToValueAtTime(b,e+c);a.Wj=c}};a.unduck=function(a){if(r(a)){a=a.M;var b=a.si,c=W.currentTime;b.gain.setValueAtTime(b.gain.value,c);b.gain.linearRampToValueAtTime(1,c+a.Wj);a.Wj=0}};a.OI=function(a,b){if(W){var c=G.qc,d=c.si,e=W.currentTime;d.gain.setValueAtTime(d.gain.value,e);d.gain.linearRampToValueAtTime(a,
e+b);c.Wj=b}};a.fO=function(){if(W){var a=G.qc,b=a.si,c=W.currentTime;b.gain.setValueAtTime(b.gain.value,c);b.gain.linearRampToValueAtTime(1,c+a.Wj);a.Wj=0}};a.apply_playlist=function(a,b,c){L={hc:-1,Vx:0,random:c,Lh:[],qz:[]};for(c=0;c<a.length;c++){var d=a[c],e=B(d);0==e?D.warn("Ignoring speaker with zero duration: "+d.name):(v(d),d.M.cyclic=!1,L.Lh.push(d),L.qz.push(e+b))}};a.get_duration=B;a.clear_playlist=function(){if(L)for(var a=L.Lh,b=0;b<a.length;b++)v(a[b]);L=null};a.get_positional_params=
function(a){return(a=a.M)&&"POSITIONAL"==a.behavior?{dist_ref:a.dist_ref,dist_max:a.dist_max,attenuation:a.attenuation}:null};a.set_positional_params=function(a,b){var c=a.M;if(c&&"POSITIONAL"==c.behavior){c.dist_ref=b.dist_ref;c.dist_max=b.dist_max;c.attenuation=b.attenuation;var d=c.Nv;d&&(d.refDistance=c.dist_ref,d.maxDistance=c.dist_max,d.rolloffFactor=c.attenuation)}};a.set_filter_params=function(a,b){var c=a.M;c&&c.Of&&(c.Of.frequency.value=b.freq,c.Of.Q.value=b.Q,c.Of.gain.value=b.gain)};a.get_filter_params=
function(a){return(a=a.M)&&a.Of?{freq:a.Of.frequency.value,Q:a.Of.Q.value,gain:a.Of.gain.value}:null};a.get_filter_freq_response=function(a,b,c,d){a=a.M;if(!a||!a.Of)return null;a.Of.getFrequencyResponse(b,c,d)};a.reset=function(){M.length=0;E.length=0;W=null}};b4w.module.__input=function(a,q){function e(a){var b=G.detect_mobile();return(20!=a||navigator.getVRDevices||navigator.getVRDisplays||b)&&(10!=a||b&&window.DeviceOrientationEvent)?!0:!1}function c(a,b){if(!e(a))return null;var c={type:a,bg:!1,tf:[],Yf:[],xh:[],yh:[],zh:[],Ah:[],Ao:[],CA:[],vh:[],Sh:[],Rh:[],Qh:[],element:b,Gh:!0,Ib:[],Jr:new Float32Array(2),CL:0,distortion_coefs:new Float32Array(2),chromatic_aberration_coefs:new Float32Array(4),Vm:null,Zg:null,af:null,orientation:O.create(),position:ga.create(),
rh:new Float32Array(4),sh:new Float32Array(4),uh:0,ei:0,Yi:0,cl:0,xi:0,gi:0,ek:[],ui:[0,0,0,0,0,0,0,0,0,0,0,0],Iz:[0,0,0,0,0,0,0,0,0,0,0,0],Oq:[]};c.rh[0]=c.rh[1]=c.rh[2]=c.rh[3]=45;c.sh[0]=c.sh[1]=c.sh[2]=c.sh[3]=45;30==a||40==a||50==a?(c.bg=Boolean(b),50==a?document.addEventListener("touchstart",function(){}):40==a&&(c.Gh=!1)):10==a?c.bg=!0:20!=a||navigator.getVRDisplays||(navigator.getVRDevices&&!ca.is_mobile_device?f(c,Q.webvr):(n(c),c.bg=!0));return c}function b(b,d){10==b||20==b?d=window:d||
(d=J.get_container());for(var e=0;e<oa.length;e++)if(oa[e].type==b&&oa[e].element==d)return oa[e];e=c(b,d);60!=b&&70!=b&&80!=b&&90!=b||e.Oq.push(a.GMPD_BUTTON_0,a.GMPD_BUTTON_1,a.GMPD_BUTTON_2,a.GMPD_BUTTON_3,a.GMPD_BUTTON_4,a.GMPD_BUTTON_5,a.GMPD_BUTTON_6,a.GMPD_BUTTON_7,a.GMPD_BUTTON_8,a.GMPD_BUTTON_9,a.GMPD_BUTTON_10,a.GMPD_BUTTON_11,a.GMPD_BUTTON_12,a.GMPD_BUTTON_13,a.GMPD_BUTTON_14,a.GMPD_BUTTON_15,a.GMPD_BUTTON_16,a.GMPD_BUTTON_17,a.GMPD_BUTTON_18,a.GMPD_BUTTON_19,a.GMPD_BUTTON_20,a.GMPD_BUTTON_21,
a.GMPD_BUTTON_22,a.GMPD_BUTTON_23,a.GMPD_BUTTON_24,a.GMPD_BUTTON_25,a.GMPD_AXIS_0,a.GMPD_AXIS_1,a.GMPD_AXIS_2,a.GMPD_AXIS_3,a.GMPD_AXIS_4,a.GMPD_AXIS_5,a.GMPD_AXIS_6,a.GMPD_AXIS_7,a.GMPD_AXIS_8,a.GMPD_AXIS_9,a.GMPD_AXIS_10,a.GMPD_AXIS_11);e&&oa.push(e);return e}function n(a){var b=Q.nonwebvr;a.cl=b.cl;a.xi=b.xi;a.gi=b.gi;f(a,b);a.uh=b.uh;a.ei=b.ei;a.Yi=b.Yi;g(a)}function f(a,b){a.distortion_coefs[0]=b.distortion_coefs[0];a.distortion_coefs[1]=b.distortion_coefs[1];a.chromatic_aberration_coefs[0]=
b.chromatic_aberration_coefs[0];a.chromatic_aberration_coefs[1]=b.chromatic_aberration_coefs[1];a.chromatic_aberration_coefs[2]=b.chromatic_aberration_coefs[2];a.chromatic_aberration_coefs[3]=b.chromatic_aberration_coefs[3]}function t(a,b){var c=b*b;return b*(1+a[0]*c+a[1]*c*c)}function g(a){var b=a.ei-a.gi,c=a.xi-b,d=a.uh/2,e=(a.cl-a.uh)/2,f=a.distortion_coefs,b=U.rad_to_deg(Math.atan(t(f,b/a.Yi))),c=U.rad_to_deg(Math.atan(t(f,c/a.Yi))),d=U.rad_to_deg(Math.atan(t(f,d/a.Yi))),e=U.rad_to_deg(Math.atan(t(f,
e/a.Yi)));c&&(a.rh[0]=a.sh[0]=Math.min(c,60));d&&(a.rh[1]=a.sh[3]=Math.min(d,60));b&&(a.rh[2]=a.sh[2]=Math.min(b,60));e&&(a.rh[3]=a.sh[1]=Math.min(e,60))}function m(a,b){var c=b.filter(function(a){return a instanceof HMDVRDevice}),d=null;c.length&&(d=c[0]);c=null;d&&(c=b.filter(function(a){return-1!==a.deviceName.toLowerCase().indexOf("oculus")&&a.hardwareUnitId==d.hardwareUnitId&&a instanceof PositionSensorVRDevice}));a.Vm=d;a.Zg=c}function v(a,b,c){switch(a.type){case 20:var d=a.af||a.Vm;d?(b=d.getEyeParameters(b),
b=b.fieldOfView||b.currentFieldOfView,a=a.distortion_coefs,d=t(a,Math.tan(U.deg_to_rad(b.downDegrees))),U.rad_to_deg(Math.atan(d)),d=t(a,Math.tan(U.deg_to_rad(b.upDegrees))),U.rad_to_deg(Math.atan(d)),d=t(a,Math.tan(U.deg_to_rad(b.leftDegrees))),U.rad_to_deg(Math.atan(d)),a=t(a,Math.tan(U.deg_to_rad(b.rightDegrees))),U.rad_to_deg(Math.atan(a)),c[0]=b.upDegrees,c[1]=b.rightDegrees,c[2]=b.downDegrees,c[3]=b.leftDegrees):(b="left"==b?a.rh:a.sh,R.copy(b,c));break;default:L.error("fov is undefined for device: ",
a.type)}return c}function x(a,b){switch(b){case 0:return navigator.getVRDisplays?3:navigator.getVRDevices?ca.is_mobile_device?1:0:2;case 23:var c=a.af||a.Vm;if(c){var d=c.getEyeParameters("left"),c=c.getEyeParameters("right");return a.af?c.offset[0]-d.offset[0]:c.eyeTranslation.x-d.eyeTranslation.x}return a.uh}}function d(a,b){if(a.af){var c=a.af,d=c.capabilities,c=c.getPose();d.hasOrientation&&c.orientation&&(a.orientation[0]=c.orientation[0],a.orientation[1]=c.orientation[1],a.orientation[2]=c.orientation[2],
a.orientation[3]=c.orientation[3]);d.hasPosition&&c.position&&(a.position[0]=c.position[0],a.position[1]=-c.position[2],a.position[2]=c.position[1])}else 1<b-ha&&(ha=b,navigator.getVRDisplays?a.af||navigator.getVRDisplays().then(function(b){0<b.length&&(a.af=b[0],a.bg=!0)},function(){L.uc("WebVR displays are not found.");a.bg=!1}):navigator.getVRDevices?a.Vm||qa||navigator.getVRDevices().then(function(b){m(a,b);b.length&&(a.bg=!0);qa=!0},function(){L.uc("WebVR devices are not found.");a.bg=!1;qa=
!0}):ca.is_mobile_device||L.uc("HMD isn't supported."))}function k(a,b){if(a){for(var c=0;c<a.buttons.length;c++)b.ek[c]=a.buttons[c].pressed;if(a.axes&&12>=a.axes.length)for(c=0;c<a.axes.length;c++)b.ui[c]=a.axes[c]}}function r(a){for(var b=0;b<a.ek;b++)a.ek[b]=!1;for(b=0;b<a.ui.length;b++)a.Iz[b]=a.ui[b],a.ui[b]=0}function C(a,b){var c=a.indexOf(b);0<=c&&(a[c]=null)}function B(a){return null===a}function F(a,b,c,d){switch(b){case 120:c&&C(a.tf,c);if(d||a.Yf.every(B)&&a.tf.every(B))a.tf.length=0,
a.Yf.length=0,b=a.Ib.indexOf(131),0<=b&&(a.Ib.splice(b,1),a.element.removeEventListener("deviceorientation",y,!1));break;case 130:c&&C(a.Yf,c);if(d||a.Yf.every(B)&&a.tf.every(B))a.tf.length=0,a.Yf.length=0,b=a.Ib.indexOf(131),0<=b&&(a.Ib.splice(b,1),a.element.removeEventListener("deviceorientation",y,!1));break;case 40:c&&C(a.xh,c);if(d||a.xh.every(B))a.xh.length=0,b=a.Ib.indexOf(b),0<=b&&(a.Ib.splice(b,1),a.element.removeEventListener("mousedown",w,!1));break;case 30:c&&C(a.yh,c);if(d||a.yh.every(B))a.yh.length=
0,b=a.Ib.indexOf(b),0<=b&&(a.Ib.splice(b,1),a.element.removeEventListener("mousemove",H,!1));break;case 50:c&&C(a.zh,c);if(d||a.zh.every(B)){a.zh.length=0;b=a.Ib.indexOf(b);0<=b&&(a.Ib.splice(b,1),a.element.removeEventListener("mouseout",h,!1),a.element.removeEventListener("mouseup",u,!1));break}break;case 60:c&&C(a.Ah,c);if(d||a.Ah.every(B))a.Ah.length=0,b=a.Ib.indexOf(b),0<=b&&(a.Ib.splice(b,1),a.element.removeEventListener("wheel",P,!1));break;case 80:c&&C(a.Ao,c);if(d||a.Ao.every(B))a.Ao.length=
0,b=a.Ib.indexOf(b),0<=b&&(a.Ib.splice(b,1),a.element.removeEventListener("keydown",p,!1));break;case 70:c&&C(a.vh,c);if(d||a.vh.every(B))a.vh.length=0,b=a.Ib.indexOf(b),0<=b&&(a.Ib.splice(b,1),a.element.removeEventListener("keyup",z,!1));break;case 90:c&&C(a.Sh,c);if(d||a.Sh.every(B))a.Sh.length=0,b=a.Ib.indexOf(b),0<=b&&(a.Ib.splice(b,1),a.element.removeEventListener("touchstart",l,!1));break;case 100:c&&C(a.Rh,c);if(d||a.Rh.every(B))a.Rh.length=0,b=a.Ib.indexOf(b),0<=b&&(a.Ib.splice(b,1),a.element.removeEventListener("touchmove",
M,!1));break;case 110:if(c&&C(a.Qh,c),d||a.Qh.every(B))a.Qh.length=0,b=a.Ib.indexOf(b),0<=b&&(a.Ib.splice(b,1),a.element.removeEventListener("touchend",E,!1))}}function D(a,b){U.ordered_angles_to_quat(a,U.ZXY,b);var c="orientation"in window?U.deg_to_rad(window.orientation):"orientation"in window.screen?U.deg_to_rad(window.screen.orientation.angle):0,c=O.setAxisAngle(U.AXIS_MZ,c,K);O.multiply(b,c,b);return b}function y(a){var c=N;null===a.alpha||null===a.beta||null===a.gamma?c[0]=c[1]=c[2]=0:(c[0]=
U.deg_to_rad(a.alpha),c[1]=U.deg_to_rad(a.beta),c[2]=U.deg_to_rad(a.gamma));a=b(10,a.currentTarget);for(var d=0;d<a.Yf.length;d++){var e=a.Yf[d];e&&(ga.copy(c,ra),e(ra))}if(a.tf.length)for(c=D(c,ta),d=0;d<a.tf.length;d++)if(e=a.tf[d])O.copy(c,sa),e(sa);for(d=0;d<a.tf.length;d++)a.tf[d]||a.tf.splice(d,1);for(d=0;d<a.Yf.length;d++)a.Yf[d]||a.Yf.splice(d,1)}function A(a,b){switch(a.type){case 30:a.Jr[0]=b.clientX,a.Jr[1]=b.clientY,a.CL=b.which}}function H(a){if(!ea||!(a.sourceCapabilities&&a.sourceCapabilities.firesTouchEvents||
5==a.mozInputSource)){var c=b(30,a.currentTarget);A(c,a);for(var d=0;d<c.yh.length;d++){var e=c.yh[d];e&&(na[0]=a.clientX,na[1]=a.clientY,e(na))}c.Gh&&a.preventDefault();for(d=0;d<c.yh.length;d++)c.yh[d]||c.yh.splice(d,1)}}function w(a){if(!ea||!(a.sourceCapabilities&&a.sourceCapabilities.firesTouchEvents||5==a.mozInputSource)){var c=b(30,a.currentTarget);A(c,a);for(var d=0;d<c.xh.length;d++){var e=c.xh[d];e&&e(a.which)}c.Gh&&a.preventDefault();for(d=0;d<c.xh.length;d++)c.xh[d]||c.xh.splice(d,1)}}
function h(a){J.sA(a.relatedTarget)||u(a)}function u(a){if(!ea||!(a.sourceCapabilities&&a.sourceCapabilities.firesTouchEvents||5==a.mozInputSource)){var c=b(30,a.currentTarget);A(c,a);for(var d=0;d<c.zh.length;d++){var e=c.zh[d];e&&e(a.which)}c.Gh&&a.preventDefault();for(d=0;d<c.zh.length;d++)c.zh[d]||c.zh.splice(d,1)}}function P(a){for(var c=b(30,a.currentTarget),d=0;d<c.Ah.length;d++){var e=c.Ah[d];e&&e(-a.deltaY)}c.Gh&&a.preventDefault();for(d=0;d<c.Ah.length;d++)c.Ah[d]||c.Ah.splice(d,1)}function p(a){for(var c=
b(40,a.currentTarget),d=a.ctrlKey||a.altKey||a.metaKey?c.CA:c.Ao,e=0;e<d.length;e++){var f=d[e];f?f(a.keyCode):d.splice(e--,1)}c.Gh&&a.preventDefault()}function z(a){for(var c=b(40,a.currentTarget),d=0;d<c.vh.length;d++){var e=c.vh[d];e&&e(a.keyCode)}c.Gh&&a.preventDefault();for(d=0;d<c.vh.length;d++)c.vh[d]||c.vh.splice(d,1)}function l(a){for(var c=b(50,a.currentTarget),d=0;d<c.Sh.length;d++){var e=c.Sh[d];e&&e(a.targetTouches)}for(d=0;d<c.Sh.length;d++)c.Sh[d]||c.Sh.splice(d,1)}function M(a){for(var c=
b(50,a.currentTarget),d=0;d<c.Rh.length;d++){var e=c.Rh[d];e&&e(a.targetTouches)}c.Gh&&a.preventDefault();for(d=0;d<c.Rh.length;d++)c.Rh[d]||c.Rh.splice(d,1)}function E(a){for(var c=b(50,a.currentTarget),d=0;d<c.Qh.length;d++){var e=c.Qh[d];e&&e(a.targetTouches)}for(d=0;d<c.Qh.length;d++)c.Qh[d]||c.Qh.splice(d,1)}function W(a){switch(a){case 0:a=60;break;case 1:a=70;break;case 2:a=80;break;case 3:a=90;break;default:a=60}return a}var G=q("__compat"),J=q("__container"),Z=q("__config"),L=q("__print"),
O=q("__quat"),U=q("__util"),ga=q("__vec3"),R=q("__vec4"),ca=Z.v,Q=Z.vK;a.DEVICE_GYRO=10;a.DEVICE_HMD=20;a.DEVICE_MOUSE=30;a.DEVICE_KEYBOARD=40;a.DEVICE_TOUCH=50;a.Fp=60;a.kt=70;a.lt=80;a.mt=90;a.HMD_WEBVR_DESKTOP=0;a.HMD_WEBVR_MOBILE=1;a.HMD_NON_WEBVR=2;a.HMD_WEBVR1=3;a.HMD_WEBVR_TYPE=0;a.HMD_ORIENTATION_QUAT=10;a.HMD_POSITION=20;a.CD=21;a.DD=22;a.HMD_EYE_DISTANCE=23;a.HMD_DISTORTION=24;a.HMD_BASELINE_DIST=25;a.HMD_SCREEN_LENSE_DIST=26;a.HMD_SCREEN_WIDTH=27;a.HMD_SCREEN_HEIGHT=28;a.HMD_BEVEL_SIZE=
29;a.MOUSE_LOCATION=30;a.MOUSE_DOWN_WHICH=40;a.MOUSE_UP_WHICH=50;a.MOUSE_WHEEL=60;a.KEYBOARD_UP=70;a.KEYBOARD_DOWN=80;a.Bx=81;a.TOUCH_START=90;a.TOUCH_MOVE=100;a.TOUCH_END=110;a.GYRO_ORIENTATION_QUAT=120;a.GYRO_ORIENTATION_ANGLES=130;a.GMPD_BUTTON_0=0;a.GMPD_BUTTON_1=1;a.GMPD_BUTTON_2=2;a.GMPD_BUTTON_3=3;a.GMPD_BUTTON_4=4;a.GMPD_BUTTON_5=5;a.GMPD_BUTTON_6=6;a.GMPD_BUTTON_7=7;a.GMPD_BUTTON_8=8;a.GMPD_BUTTON_9=9;a.GMPD_BUTTON_10=10;a.GMPD_BUTTON_11=11;a.GMPD_BUTTON_12=12;a.GMPD_BUTTON_13=13;a.GMPD_BUTTON_14=
14;a.GMPD_BUTTON_15=15;a.GMPD_BUTTON_16=16;a.GMPD_BUTTON_17=17;a.GMPD_BUTTON_18=18;a.GMPD_BUTTON_19=19;a.GMPD_BUTTON_20=20;a.GMPD_BUTTON_21=21;a.GMPD_BUTTON_22=22;a.GMPD_BUTTON_23=23;a.GMPD_BUTTON_24=24;a.GMPD_BUTTON_25=25;a.GMPD_AXIS_0=26;a.GMPD_AXIS_1=27;a.GMPD_AXIS_2=28;a.GMPD_AXIS_3=29;a.GMPD_AXIS_4=30;a.GMPD_AXIS_5=31;a.GMPD_AXIS_6=32;a.GMPD_AXIS_7=33;a.GMPD_AXIS_8=34;a.GMPD_AXIS_9=35;a.GMPD_AXIS_10=36;a.GMPD_AXIS_11=37;var ta=O.create(),K=O.create(),N=ga.create(),ha=-Infinity,qa=!1,na=new Float32Array(2);
ga.create();var ra=ga.create(),sa=O.create(),ea="ontouchstart"in document.documentElement,oa=[];a.can_use_device=e;a.get_device_by_type_element=b;a.switch_prevent_default=function(a,b){a.Gh=b};a.reset_device=function(a){switch(a.type){case 20:if(a.bg)if(a.af)a.af.resetPose();else if(a.Zg)for(var b=0;b<a.Zg.length;b++)a.Zg[b].resetSensor();break;default:L.error("reset_device() is undefined for device: ",a.type)}};a.get_vector_param=function(a,b,c){switch(b){case 10:a:switch(a.type){case 20:ga.copy(U.il,
c);if(a.af)c[0]=a.orientation[0],c[1]=a.orientation[1],c[2]=a.orientation[2],c[3]=a.orientation[3];else if(a.Zg)for(b=0;b<a.Zg.length;b++){var d=a.Zg[b],d=d.getState&&d.getState()||d.getImmediateState&&d.getImmediateState();d.orientation&&(c[0]=d.orientation.x,c[1]=d.orientation.y,c[2]=d.orientation.z,c[3]=d.orientation.w)}O.normalize(c,c);a=O.setAxisAngle(U.AXIS_X,Math.PI/2,K);O.multiply(a,c,c);break a;default:L.error("orientation_quat is undefined for device: ",a.type)}return c;case 20:a:switch(a.type){case 20:ga.copy(U.vt,
c);if(a.af)c[0]=a.position[0],c[1]=a.position[1],c[2]=a.position[2];else if(a.Zg)for(b=0;b<a.Zg.length;b++)d=a.Zg[b],d=d.getState&&d.getState()||d.getImmediateState&&d.getImmediateState(),d.position&&(c[0]=d.position.x,c[1]=-d.position.z,c[2]=d.position.y);break a;default:L.error("position is undefined for device: ",a.type)}return c;case 21:return v(a,"left",c);case 22:return v(a,"right",c);case 30:return c[0]=a.Jr[0],c[1]=a.Jr[1],c}};a.get_value_param=x;a.set_config=function(a,b,c){switch(a.type){case 20:if(3===
x(a,0))break;switch(b){case 24:a.distortion_coefs[0]=c[0];a.distortion_coefs[1]=c[1];break;case 23:a.uh=c;g(a);break;case 25:a.ei=c;g(a);break;case 26:a.Yi=c;g(a);break;case 27:a.cl=c;g(a);break;case 28:a.xi=c;g(a);break;case 29:a.gi=c,g(a)}break;case 60:case 70:case 80:case 90:a.Oq[b]=c}};a.aK=function(a,b){return b<a.ek.length?a.ek[a.Oq[b]]:!1};a.$J=function(a,b){return b-26<a.ui.length?a.ui[a.Oq[b]-26]:0};a.update=function(a){for(var b=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?
navigator.webkitGetGamepads:[],c=0;c<oa.length;c++){var e=oa[c];switch(e.type){case 60:r(e);k(b[0],e);break;case 70:r(e);k(b[1],e);break;case 80:r(e);k(b[2],e);break;case 90:r(e);k(b[3],e);break;case 20:d(e,a)}}};a.attach_param_cb=function(a,b,c){switch(b){case 120:a.tf.push(c);b=131;break;case 130:a.Yf.push(c);b=131;break;case 40:a.xh.push(c);break;case 30:a.yh.push(c);break;case 50:a.zh.push(c);break;case 60:a.Ah.push(c);break;case 80:a.Ao.push(c);break;case 81:a.CA.push(c);b=80;break;case 70:a.vh.push(c);
break;case 90:a.Sh.push(c);break;case 100:a.Rh.push(c);break;case 110:a.Qh.push(c)}if(-1==a.Ib.indexOf(b)&&(a.Ib.push(b),a.bg))switch(b){case 40:/iPad|iPhone|iPod/.test(navigator.platform)||a.element.addEventListener("mousedown",w,!1);break;case 30:a.element.addEventListener("mousemove",H,!1);break;case 50:/iPad|iPhone|iPod/.test(navigator.platform)||(a.element!=window&&a.element.addEventListener("mouseout",u,!1),a.element.addEventListener("mouseup",u,!1));break;case 60:a.element.addEventListener("wheel",
P,!1);break;case 80:a.element.addEventListener("keydown",p,!1);break;case 70:a.element.addEventListener("keyup",z,!1);break;case 90:a.element.addEventListener("touchstart",l,!1);break;case 100:a.element.addEventListener("touchmove",M,!1);break;case 110:a.element.addEventListener("touchend",E,!1);break;case 131:a.element.addEventListener("deviceorientation",y,!1)}};a.detach_param_cb=function(a,b,c){F(a,b,c,!1)};a.qK=D;a.cleanup=function(){for(var a=0;a<oa.length;a++)for(var b=oa[a],c=0;c<b.Ib.length;c++)F(b,
b.Ib[c],null,!0);oa.length=0};a.get_pressed_gmpd_btn=function(a){a=b(W(a));for(var c=0;c<a.ek.length;c++)if(a.ek[c])return c;return-1};a.get_moved_gmpd_axis=function(a){a=b(W(a));for(var c=0;c<a.ui.length;c++)if(a.Iz[c]-a.ui[c])return c+26;return-1};a.Wz=function(){for(var a=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads:[],b=0;b<a.length;b++)if(a[b])return b;return 0};a.gA=function(){var a=b(20);return a&&a.af}};b4w.module.__vec3=function(a){var q="undefined"!==typeof Float32Array?Float32Array:Array,e=Math.random;a.create=function(){var a=new q(3);a[0]=0;a[1]=0;a[2]=0;return a};a.clone=function(a){var b=new q(3);b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};a.fromValues=function(a,b,e){var f=new q(3);f[0]=a;f[1]=b;f[2]=e;return f};a.copy=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};a.set=function(a,b,e,f){f[0]=a;f[1]=b;f[2]=e;return f};a.add=function(a,b,e){e[0]=a[0]+b[0];e[1]=a[1]+b[1];e[2]=a[2]+b[2];
return e};a.subtract=function(a,b,e){e[0]=a[0]-b[0];e[1]=a[1]-b[1];e[2]=a[2]-b[2];return e};a.sub=a.subtract;a.multiply=function(a,b,e){e[0]=a[0]*b[0];e[1]=a[1]*b[1];e[2]=a[2]*b[2];return e};a.mul=a.multiply;a.divide=function(a,b,e){e[0]=a[0]/b[0];e[1]=a[1]/b[1];e[2]=a[2]/b[2];return e};a.div=a.divide;a.min=function(a,b,e){e[0]=Math.min(a[0],b[0]);e[1]=Math.min(a[1],b[1]);e[2]=Math.min(a[2],b[2]);return e};a.max=function(a,b,e){e[0]=Math.max(a[0],b[0]);e[1]=Math.max(a[1],b[1]);e[2]=Math.max(a[2],
b[2]);return e};a.scale=function(a,b,e){e[0]=a[0]*b;e[1]=a[1]*b;e[2]=a[2]*b;return e};a.scaleAndAdd=function(a,b,e,f){f[0]=a[0]+b[0]*e;f[1]=a[1]+b[1]*e;f[2]=a[2]+b[2]*e;return f};a.distance=function(a,b){var e=b[0]-a[0],f=b[1]-a[1],t=b[2]-a[2];return Math.sqrt(e*e+f*f+t*t)};a.dist=a.distance;a.squaredDistance=function(a,b){var e=b[0]-a[0],f=b[1]-a[1],t=b[2]-a[2];return e*e+f*f+t*t};a.sqrDist=a.squaredDistance;a.length=function(a){var b=a[0],e=a[1];a=a[2];return Math.sqrt(b*b+e*e+a*a)};a.len=a.length;
a.squaredLength=function(a){var b=a[0],e=a[1];a=a[2];return b*b+e*e+a*a};a.sqrLen=a.squaredLength;a.negate=function(a,b){b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];return b};a.inverse=function(a,b){b[0]=1/a[0];b[1]=1/a[1];b[2]=1/a[2];return b};a.normalize=function(a,b){var e=a[0],f=a[1],t=a[2],e=e*e+f*f+t*t;0<e&&(e=1/Math.sqrt(e),b[0]=a[0]*e,b[1]=a[1]*e,b[2]=a[2]*e);return b};a.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]};a.cross=function(a,b,e){var f=a[0],t=a[1];a=a[2];var g=b[0],m=b[1];b=b[2];
e[0]=t*b-a*m;e[1]=a*g-f*b;e[2]=f*m-t*g;return e};a.lerp=function(a,b,e,f){var t=a[0],g=a[1];a=a[2];f[0]=t+e*(b[0]-t);f[1]=g+e*(b[1]-g);f[2]=a+e*(b[2]-a);return f};a.jR=function(a,b,e,f,t,g){var m=t*t,v=m*(2*t-3)+1,q=m*(t-2)+t,d=m*(t-1);t=m*(3-2*t);g[0]=a[0]*v+b[0]*q+e[0]*d+f[0]*t;g[1]=a[1]*v+b[1]*q+e[1]*d+f[1]*t;g[2]=a[2]*v+b[2]*q+e[2]*d+f[2]*t;return g};a.ky=function(a,b,e,f,t,g){var m=1-t,v=m*m,q=t*t,d=v*m,v=3*t*v,m=3*q*m;t*=q;g[0]=a[0]*d+b[0]*v+e[0]*m+f[0]*t;g[1]=a[1]*d+b[1]*v+e[1]*m+f[1]*t;g[2]=
a[2]*d+b[2]*v+e[2]*m+f[2]*t;return g};a.random=function(a,b){a=a||1;var n=2*e()*Math.PI,f=2*e()-1,t=Math.sqrt(1-f*f)*a;b[0]=Math.cos(n)*t;b[1]=Math.sin(n)*t;b[2]=f*a;return b};a.transformMat4=function(a,b,e){var f=a[0],t=a[1];a=a[2];var g=b[3]*f+b[7]*t+b[11]*a+b[15],g=g||1;e[0]=(b[0]*f+b[4]*t+b[8]*a+b[12])/g;e[1]=(b[1]*f+b[5]*t+b[9]*a+b[13])/g;e[2]=(b[2]*f+b[6]*t+b[10]*a+b[14])/g;return e};a.transformMat3=function(a,b,e){var f=a[0],t=a[1];a=a[2];e[0]=f*b[0]+t*b[3]+a*b[6];e[1]=f*b[1]+t*b[4]+a*b[7];
e[2]=f*b[2]+t*b[5]+a*b[8];return e};a.transformQuat=function(a,b,e){var f=a[0],t=a[1],g=a[2];a=b[0];var m=b[1],v=b[2];b=b[3];var q=b*f+m*g-v*t,d=b*t+v*f-a*g,k=b*g+a*t-m*f,f=-a*f-m*t-v*g;e[0]=q*b+f*-a+d*-v-k*-m;e[1]=d*b+f*-m+k*-a-q*-v;e[2]=k*b+f*-v+q*-m-d*-a;return e};a.rotateX=function(a,b,e,f){var t=[],g=[];t[0]=a[0]-b[0];t[1]=a[1]-b[1];t[2]=a[2]-b[2];g[0]=t[0];g[1]=t[1]*Math.cos(e)-t[2]*Math.sin(e);g[2]=t[1]*Math.sin(e)+t[2]*Math.cos(e);f[0]=g[0]+b[0];f[1]=g[1]+b[1];f[2]=g[2]+b[2];return f};a.rotateY=
function(a,b,e,f){var t=[],g=[];t[0]=a[0]-b[0];t[1]=a[1]-b[1];t[2]=a[2]-b[2];g[0]=t[2]*Math.sin(e)+t[0]*Math.cos(e);g[1]=t[1];g[2]=t[2]*Math.cos(e)-t[0]*Math.sin(e);f[0]=g[0]+b[0];f[1]=g[1]+b[1];f[2]=g[2]+b[2];return f};a.rotateZ=function(a,b,e,f){var t=[],g=[];t[0]=a[0]-b[0];t[1]=a[1]-b[1];t[2]=a[2]-b[2];g[0]=t[0]*Math.cos(e)-t[1]*Math.sin(e);g[1]=t[0]*Math.sin(e)+t[1]*Math.cos(e);g[2]=t[2];f[0]=g[0]+b[0];f[1]=g[1]+b[1];f[2]=g[2]+b[2];return f};a.forEach=function(){var c=a.create();return function(a,
e,f,t,g,m){e||(e=3);f||(f=0);for(t=t?Math.min(t*e+f,a.length):a.length;f<t;f+=e)c[0]=a[f],c[1]=a[f+1],c[2]=a[f+2],g(c,m,c),a[f]=c[0],a[f+1]=c[1],a[f+2]=c[2];return a}}();a.XP=function(c,b){var e=a.fromValues(c[0],c[1],c[2]),f=a.fromValues(b[0],b[1],b[2]);a.normalize(e,e);a.normalize(f,f);e=a.dot(e,f);return 1<e?0:Math.acos(e)};a.str=function(a){return"vec3("+a[0]+", "+a[1]+", "+a[2]+")"}};b4w.module.vec3=b4w.module.__vec3;
b4w.module.__vec4=function(a){var q="undefined"!==typeof Float32Array?Float32Array:Array,e=Math.random;a.create=function(){var a=new q(4);a[0]=0;a[1]=0;a[2]=0;a[3]=0;return a};a.clone=function(a){var b=new q(4);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b};a.fromValues=function(a,b,e,f){var t=new q(4);t[0]=a;t[1]=b;t[2]=e;t[3]=f;return t};a.copy=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b};a.set=function(a,b,e,f,t){t[0]=a;t[1]=b;t[2]=e;t[3]=f;return t};a.add=function(a,b,e){e[0]=
a[0]+b[0];e[1]=a[1]+b[1];e[2]=a[2]+b[2];e[3]=a[3]+b[3];return e};a.subtract=function(a,b,e){e[0]=a[0]-b[0];e[1]=a[1]-b[1];e[2]=a[2]-b[2];e[3]=a[3]-b[3];return e};a.sub=a.subtract;a.multiply=function(a,b,e){e[0]=a[0]*b[0];e[1]=a[1]*b[1];e[2]=a[2]*b[2];e[3]=a[3]*b[3];return e};a.mul=a.multiply;a.divide=function(a,b,e){e[0]=a[0]/b[0];e[1]=a[1]/b[1];e[2]=a[2]/b[2];e[3]=a[3]/b[3];return e};a.div=a.divide;a.min=function(a,b,e){e[0]=Math.min(a[0],b[0]);e[1]=Math.min(a[1],b[1]);e[2]=Math.min(a[2],b[2]);e[3]=
Math.min(a[3],b[3]);return e};a.max=function(a,b,e){e[0]=Math.max(a[0],b[0]);e[1]=Math.max(a[1],b[1]);e[2]=Math.max(a[2],b[2]);e[3]=Math.max(a[3],b[3]);return e};a.scale=function(a,b,e){e[0]=a[0]*b;e[1]=a[1]*b;e[2]=a[2]*b;e[3]=a[3]*b;return e};a.scaleAndAdd=function(a,b,e,f){f[0]=a[0]+b[0]*e;f[1]=a[1]+b[1]*e;f[2]=a[2]+b[2]*e;f[3]=a[3]+b[3]*e;return f};a.distance=function(a,b){var e=b[0]-a[0],f=b[1]-a[1],t=b[2]-a[2],g=b[3]-a[3];return Math.sqrt(e*e+f*f+t*t+g*g)};a.dist=a.distance;a.squaredDistance=
function(a,b){var e=b[0]-a[0],f=b[1]-a[1],t=b[2]-a[2],g=b[3]-a[3];return e*e+f*f+t*t+g*g};a.sqrDist=a.squaredDistance;a.length=function(a){var b=a[0],e=a[1],f=a[2];a=a[3];return Math.sqrt(b*b+e*e+f*f+a*a)};a.len=a.length;a.squaredLength=function(a){var b=a[0],e=a[1],f=a[2];a=a[3];return b*b+e*e+f*f+a*a};a.sqrLen=a.squaredLength;a.negate=function(a,b){b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];b[3]=-a[3];return b};a.inverse=function(a,b){b[0]=1/a[0];b[1]=1/a[1];b[2]=1/a[2];b[3]=1/a[3];return b};a.normalize=
function(a,b){var e=a[0],f=a[1],t=a[2],g=a[3],m=e*e+f*f+t*t+g*g;0<m&&(m=1/Math.sqrt(m),b[0]=e*m,b[1]=f*m,b[2]=t*m,b[3]=g*m);return b};a.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]};a.lerp=function(a,b,e,f){var t=a[0],g=a[1],m=a[2];a=a[3];f[0]=t+e*(b[0]-t);f[1]=g+e*(b[1]-g);f[2]=m+e*(b[2]-m);f[3]=a+e*(b[3]-a);return f};a.random=function(c,b){c=c||1;b[0]=e();b[1]=e();b[2]=e();b[3]=e();a.normalize(b,b);a.scale(b,c,b);return b};a.transformMat4=function(a,b,e){var f=a[0],t=a[1],g=
a[2];a=a[3];e[0]=b[0]*f+b[4]*t+b[8]*g+b[12]*a;e[1]=b[1]*f+b[5]*t+b[9]*g+b[13]*a;e[2]=b[2]*f+b[6]*t+b[10]*g+b[14]*a;e[3]=b[3]*f+b[7]*t+b[11]*g+b[15]*a;return e};a.transformQuat=function(a,b,e){var f=a[0],t=a[1],g=a[2],m=b[0],v=b[1],q=b[2];b=b[3];var d=b*f+v*g-q*t,k=b*t+q*f-m*g,r=b*g+m*t-v*f,f=-m*f-v*t-q*g;e[0]=d*b+f*-m+k*-q-r*-v;e[1]=k*b+f*-v+r*-m-d*-q;e[2]=r*b+f*-q+d*-v-k*-m;e[3]=a[3];return e};a.forEach=function(){var c=a.create();return function(a,e,f,t,g,m){e||(e=4);f||(f=0);for(t=t?Math.min(t*
e+f,a.length):a.length;f<t;f+=e)c[0]=a[f],c[1]=a[f+1],c[2]=a[f+2],c[3]=a[f+3],g(c,m,c),a[f]=c[0],a[f+1]=c[1],a[f+2]=c[2],a[f+3]=c[3];return a}}();a.str=function(a){return"vec4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"}};b4w.module.vec4=b4w.module.__vec4;
b4w.module.__quat=function(a,q){var e=q("__vec3"),c=q("__vec4"),b=q("__mat3"),n="undefined"!==typeof Float32Array?Float32Array:Array;a.create=function(){var a=new n(4);a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a};a.rotationTo=function(){var b=e.create(),c=e.fromValues(1,0,0),g=e.fromValues(0,1,0);return function(m,n,q){var d=e.dot(m,n);if(-.9999999>d)return e.cross(c,m,b),1E-6>e.length(b)&&e.cross(g,m,b),e.normalize(b,b),a.setAxisAngle(b,Math.PI,q),q;if(.9999999<d)return q[0]=0,q[1]=0,q[2]=0,q[3]=1,q;e.cross(m,
n,b);q[0]=b[0];q[1]=b[1];q[2]=b[2];q[3]=1+d;return a.normalize(q,q)}}();a.setAxes=function(){var c=b.create();return function(b,e,m,n){c[0]=e[0];c[3]=e[1];c[6]=e[2];c[1]=m[0];c[4]=m[1];c[7]=m[2];c[2]=-b[0];c[5]=-b[1];c[8]=-b[2];return a.normalize(a.fromMat3(c,n),n)}}();a.clone=c.clone;a.fromValues=c.fromValues;a.copy=c.copy;a.set=c.set;a.identity=function(a){a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a};a.setAxisAngle=function(a,b,c){b*=.5;var e=Math.sin(b);c[0]=e*a[0];c[1]=e*a[1];c[2]=e*a[2];c[3]=Math.cos(b);
return c};a.add=c.add;a.multiply=function(a,b,c){var e=a[0],n=a[1],q=a[2];a=a[3];var d=b[0],k=b[1],r=b[2];b=b[3];c[0]=e*b+a*d+n*r-q*k;c[1]=n*b+a*k+q*d-e*r;c[2]=q*b+a*r+e*k-n*d;c[3]=a*b-e*d-n*k-q*r;return c};a.mul=a.multiply;a.scale=c.scale;a.rotateX=function(a,b,c){b*=.5;var e=a[0],n=a[1],q=a[2];a=a[3];var d=Math.sin(b);b=Math.cos(b);c[0]=e*b+a*d;c[1]=n*b+q*d;c[2]=q*b-n*d;c[3]=a*b-e*d;return c};a.rotateY=function(a,b,c){b*=.5;var e=a[0],n=a[1],q=a[2];a=a[3];var d=Math.sin(b);b=Math.cos(b);c[0]=e*
b-q*d;c[1]=n*b+a*d;c[2]=q*b+e*d;c[3]=a*b-n*d;return c};a.rotateZ=function(a,b,c){b*=.5;var e=a[0],n=a[1],q=a[2];a=a[3];var d=Math.sin(b);b=Math.cos(b);c[0]=e*b+n*d;c[1]=n*b-e*d;c[2]=q*b+a*d;c[3]=a*b-q*d;return c};a.calculateW=function(a,b){var c=a[0],e=a[1],n=a[2];b[0]=c;b[1]=e;b[2]=n;b[3]=Math.sqrt(Math.abs(1-c*c-e*e-n*n));return b};a.dot=c.dot;a.lerp=c.lerp;a.slerp=function(a,b,c,e){var n=a[0],q=a[1],d=a[2];a=a[3];var k=b[0],r=b[1],C=b[2];b=b[3];var B,F,D;F=n*k+q*r+d*C+a*b;0>F&&(F=-F,k=-k,r=-r,
C=-C,b=-b);1E-6<1-F?(B=Math.acos(F),D=Math.sin(B),F=Math.sin((1-c)*B)/D,c=Math.sin(c*B)/D):F=1-c;e[0]=F*n+c*k;e[1]=F*q+c*r;e[2]=F*d+c*C;e[3]=F*a+c*b;return e};a.VR=function(){var b=a.create(),c=a.create();return function(e,m,n,q,d,k){a.slerp(e,q,d,b);a.slerp(m,n,d,c);a.slerp(b,c,2*d*(1-d),k);return k}}();a.invert=function(a,b){var c=a[0],e=a[1],n=a[2],q=a[3],d=c*c+e*e+n*n+q*q,d=d?1/d:0;b[0]=-c*d;b[1]=-e*d;b[2]=-n*d;b[3]=q*d;return b};a.conjugate=function(a,b){b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];b[3]=
a[3];return b};a.length=c.length;a.len=a.length;a.squaredLength=c.squaredLength;a.sqrLen=a.squaredLength;a.normalize=c.normalize;a.fromMat3=function(a,b){var c=a[0]+a[4]+a[8];if(0<c)c=Math.sqrt(c+1),b[3]=.5*c,c=.5/c,b[0]=(a[5]-a[7])*c,b[1]=(a[6]-a[2])*c,b[2]=(a[1]-a[3])*c;else{var e=0;a[4]>a[0]&&(e=1);a[8]>a[3*e+e]&&(e=2);var n=(e+1)%3,q=(e+2)%3,c=Math.sqrt(a[3*e+e]-a[3*n+n]-a[3*q+q]+1);b[e]=.5*c;c=.5/c;b[3]=(a[3*n+q]-a[3*q+n])*c;b[n]=(a[3*n+e]+a[3*e+n])*c;b[q]=(a[3*q+e]+a[3*e+q])*c}return b};a.str=
function(a){return"quat("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"}};b4w.module.quat=b4w.module.__quat;
b4w.module.__mat3=function(a){var q="undefined"!==typeof Float32Array?Float32Array:Array;a.create=function(){var a=new q(9);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};a.fromMat4=function(a,c){c[0]=a[0];c[1]=a[1];c[2]=a[2];c[3]=a[4];c[4]=a[5];c[5]=a[6];c[6]=a[8];c[7]=a[9];c[8]=a[10];return c};a.clone=function(a){var c=new q(9);c[0]=a[0];c[1]=a[1];c[2]=a[2];c[3]=a[3];c[4]=a[4];c[5]=a[5];c[6]=a[6];c[7]=a[7];c[8]=a[8];return c};a.copy=function(a,c){c[0]=a[0];c[1]=a[1];c[2]=
a[2];c[3]=a[3];c[4]=a[4];c[5]=a[5];c[6]=a[6];c[7]=a[7];c[8]=a[8];return c};a.identity=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};a.transpose=function(a,c){if(c===a){var b=a[1],n=a[2],f=a[5];c[1]=a[3];c[2]=a[6];c[3]=b;c[5]=a[7];c[6]=n;c[7]=f}else c[0]=a[0],c[1]=a[3],c[2]=a[6],c[3]=a[1],c[4]=a[4],c[5]=a[7],c[6]=a[2],c[7]=a[5],c[8]=a[8];return c};a.invert=function(a,c){var b=a[0],n=a[1],f=a[2],t=a[3],g=a[4],m=a[5],v=a[6],q=a[7],d=a[8],k=d*g-m*q,r=-d*t+m*v,C=
q*t-g*v,B=b*k+n*r+f*C;if(!B)return null;B=1/B;c[0]=k*B;c[1]=(-d*n+f*q)*B;c[2]=(m*n-f*g)*B;c[3]=r*B;c[4]=(d*b-f*v)*B;c[5]=(-m*b+f*t)*B;c[6]=C*B;c[7]=(-q*b+n*v)*B;c[8]=(g*b-n*t)*B;return c};a.adjoint=function(a,c){var b=a[0],n=a[1],f=a[2],t=a[3],g=a[4],m=a[5],v=a[6],q=a[7],d=a[8];c[0]=g*d-m*q;c[1]=f*q-n*d;c[2]=n*m-f*g;c[3]=m*v-t*d;c[4]=b*d-f*v;c[5]=f*t-b*m;c[6]=t*q-g*v;c[7]=n*v-b*q;c[8]=b*g-n*t;return c};a.determinant=function(a){var c=a[3],b=a[4],n=a[5],f=a[6],t=a[7],g=a[8];return a[0]*(g*b-n*t)+a[1]*
(-g*c+n*f)+a[2]*(t*c-b*f)};a.multiply=function(a,c,b){var n=a[0],f=a[1],t=a[2],g=a[3],m=a[4],v=a[5],q=a[6],d=a[7];a=a[8];var k=c[0],r=c[1],C=c[2],B=c[3],F=c[4],D=c[5],y=c[6],A=c[7];c=c[8];b[0]=k*n+r*g+C*q;b[1]=k*f+r*m+C*d;b[2]=k*t+r*v+C*a;b[3]=B*n+F*g+D*q;b[4]=B*f+F*m+D*d;b[5]=B*t+F*v+D*a;b[6]=y*n+A*g+c*q;b[7]=y*f+A*m+c*d;b[8]=y*t+A*v+c*a;return b};a.mul=a.multiply;a.translate=function(a,c,b){var n=a[0],f=a[1],t=a[2],g=a[3],m=a[4],v=a[5],q=a[6],d=a[7];a=a[8];var k=c[0];c=c[1];b[0]=n;b[1]=f;b[2]=t;
b[3]=g;b[4]=m;b[5]=v;b[6]=k*n+c*g+q;b[7]=k*f+c*m+d;b[8]=k*t+c*v+a;return b};a.rotate=function(a,c,b){var n=a[0],f=a[1],t=a[2],g=a[3],m=a[4],v=a[5],q=a[6],d=a[7];a=a[8];var k=Math.sin(c);c=Math.cos(c);b[0]=c*n+k*g;b[1]=c*f+k*m;b[2]=c*t+k*v;b[3]=c*g-k*n;b[4]=c*m-k*f;b[5]=c*v-k*t;b[6]=q;b[7]=d;b[8]=a;return b};a.scale=function(a,c,b){var n=c[0];c=c[1];b[0]=n*a[0];b[1]=n*a[1];b[2]=n*a[2];b[3]=c*a[3];b[4]=c*a[4];b[5]=c*a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];return b};a.uJ=function(a,c){c[0]=1;c[1]=0;c[2]=
0;c[3]=0;c[4]=1;c[5]=0;c[6]=a[0];c[7]=a[1];c[8]=1;return c};a.sJ=function(a,c){var b=Math.sin(a),n=Math.cos(a);c[0]=n;c[1]=b;c[2]=0;c[3]=-b;c[4]=n;c[5]=0;c[6]=0;c[7]=0;c[8]=1;return c};a.tJ=function(a,c){c[0]=a[0];c[1]=0;c[2]=0;c[3]=0;c[4]=a[1];c[5]=0;c[6]=0;c[7]=0;c[8]=1;return c};a.fromMat2d=function(a,c){c[0]=a[0];c[1]=a[1];c[2]=0;c[3]=a[2];c[4]=a[3];c[5]=0;c[6]=a[4];c[7]=a[5];c[8]=1;return c};a.fromQuat=function(a,c){var b=a[0],n=a[1],f=a[2],t=a[3],g=b+b,m=n+n,v=f+f,b=b*g,q=n*g,n=n*m,d=f*g,k=
f*m,f=f*v,g=t*g,m=t*m,t=t*v;c[0]=1-n-f;c[3]=q-t;c[6]=d+m;c[1]=q+t;c[4]=1-b-f;c[7]=k-g;c[2]=d-m;c[5]=k+g;c[8]=1-b-n;return c};a.normalFromMat4=function(a,c){var b=a[0],n=a[1],f=a[2],t=a[3],g=a[4],m=a[5],v=a[6],q=a[7],d=a[8],k=a[9],r=a[10],C=a[11],B=a[12],F=a[13],D=a[14],y=a[15],A=b*m-n*g,H=b*v-f*g,w=b*q-t*g,h=n*v-f*m,u=n*q-t*m,P=f*q-t*v,p=d*F-k*B,z=d*D-r*B,d=d*y-C*B,l=k*D-r*F,k=k*y-C*F,r=r*y-C*D,C=A*r-H*k+w*l+h*d-u*z+P*p;if(!C)return null;C=1/C;c[0]=(m*r-v*k+q*l)*C;c[1]=(v*d-g*r-q*z)*C;c[2]=(g*k-m*
d+q*p)*C;c[3]=(f*k-n*r-t*l)*C;c[4]=(b*r-f*d+t*z)*C;c[5]=(n*d-b*k-t*p)*C;c[6]=(F*P-D*u+y*h)*C;c[7]=(D*w-B*P-y*H)*C;c[8]=(B*u-F*w+y*A)*C;return c};a.str=function(a){return"mat3("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+")"};a.rJ=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2))}};b4w.module.mat3=b4w.module.__mat3;
b4w.module.__mat4=function(a){var q="undefined"!==typeof Float32Array?Float32Array:Array;a.create=function(){var a=new q(16);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};a.clone=function(a){var c=new q(16);c[0]=a[0];c[1]=a[1];c[2]=a[2];c[3]=a[3];c[4]=a[4];c[5]=a[5];c[6]=a[6];c[7]=a[7];c[8]=a[8];c[9]=a[9];c[10]=a[10];c[11]=a[11];c[12]=a[12];c[13]=a[13];c[14]=a[14];c[15]=a[15];return c};a.copy=function(a,c){c[0]=a[0];
c[1]=a[1];c[2]=a[2];c[3]=a[3];c[4]=a[4];c[5]=a[5];c[6]=a[6];c[7]=a[7];c[8]=a[8];c[9]=a[9];c[10]=a[10];c[11]=a[11];c[12]=a[12];c[13]=a[13];c[14]=a[14];c[15]=a[15];return c};a.identity=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};a.transpose=function(a,c){if(c===a){var b=a[1],n=a[2],f=a[3],t=a[6],g=a[7],m=a[11];c[1]=a[4];c[2]=a[8];c[3]=a[12];c[4]=b;c[6]=a[9];c[7]=a[13];c[8]=n;c[9]=t;c[11]=a[14];c[12]=f;c[13]=
g;c[14]=m}else c[0]=a[0],c[1]=a[4],c[2]=a[8],c[3]=a[12],c[4]=a[1],c[5]=a[5],c[6]=a[9],c[7]=a[13],c[8]=a[2],c[9]=a[6],c[10]=a[10],c[11]=a[14],c[12]=a[3],c[13]=a[7],c[14]=a[11],c[15]=a[15];return c};a.invert=function(a,c){var b=a[0],n=a[1],f=a[2],t=a[3],g=a[4],m=a[5],v=a[6],q=a[7],d=a[8],k=a[9],r=a[10],C=a[11],B=a[12],F=a[13],D=a[14],y=a[15],A=b*m-n*g,H=b*v-f*g,w=b*q-t*g,h=n*v-f*m,u=n*q-t*m,P=f*q-t*v,p=d*F-k*B,z=d*D-r*B,l=d*y-C*B,M=k*D-r*F,E=k*y-C*F,W=r*y-C*D,G=A*W-H*E+w*M+h*l-u*z+P*p;if(!G)return null;
G=1/G;c[0]=(m*W-v*E+q*M)*G;c[1]=(f*E-n*W-t*M)*G;c[2]=(F*P-D*u+y*h)*G;c[3]=(r*u-k*P-C*h)*G;c[4]=(v*l-g*W-q*z)*G;c[5]=(b*W-f*l+t*z)*G;c[6]=(D*w-B*P-y*H)*G;c[7]=(d*P-r*w+C*H)*G;c[8]=(g*E-m*l+q*p)*G;c[9]=(n*l-b*E-t*p)*G;c[10]=(B*u-F*w+y*A)*G;c[11]=(k*w-d*u-C*A)*G;c[12]=(m*z-g*M-v*p)*G;c[13]=(b*M-n*z+f*p)*G;c[14]=(F*H-B*h-D*A)*G;c[15]=(d*h-k*H+r*A)*G;return c};a.adjoint=function(a,c){var b=a[0],n=a[1],f=a[2],t=a[3],g=a[4],m=a[5],v=a[6],q=a[7],d=a[8],k=a[9],r=a[10],C=a[11],B=a[12],F=a[13],D=a[14],y=a[15];
c[0]=m*(r*y-C*D)-k*(v*y-q*D)+F*(v*C-q*r);c[1]=-(n*(r*y-C*D)-k*(f*y-t*D)+F*(f*C-t*r));c[2]=n*(v*y-q*D)-m*(f*y-t*D)+F*(f*q-t*v);c[3]=-(n*(v*C-q*r)-m*(f*C-t*r)+k*(f*q-t*v));c[4]=-(g*(r*y-C*D)-d*(v*y-q*D)+B*(v*C-q*r));c[5]=b*(r*y-C*D)-d*(f*y-t*D)+B*(f*C-t*r);c[6]=-(b*(v*y-q*D)-g*(f*y-t*D)+B*(f*q-t*v));c[7]=b*(v*C-q*r)-g*(f*C-t*r)+d*(f*q-t*v);c[8]=g*(k*y-C*F)-d*(m*y-q*F)+B*(m*C-q*k);c[9]=-(b*(k*y-C*F)-d*(n*y-t*F)+B*(n*C-t*k));c[10]=b*(m*y-q*F)-g*(n*y-t*F)+B*(n*q-t*m);c[11]=-(b*(m*C-q*k)-g*(n*C-t*k)+d*
(n*q-t*m));c[12]=-(g*(k*D-r*F)-d*(m*D-v*F)+B*(m*r-v*k));c[13]=b*(k*D-r*F)-d*(n*D-f*F)+B*(n*r-f*k);c[14]=-(b*(m*D-v*F)-g*(n*D-f*F)+B*(n*v-f*m));c[15]=b*(m*r-v*k)-g*(n*r-f*k)+d*(n*v-f*m);return c};a.determinant=function(a){var c=a[0],b=a[1],n=a[2],f=a[3],t=a[4],g=a[5],m=a[6],q=a[7],x=a[8],d=a[9],k=a[10],r=a[11],C=a[12],B=a[13],F=a[14];a=a[15];return(c*g-b*t)*(k*a-r*F)-(c*m-n*t)*(d*a-r*B)+(c*q-f*t)*(d*F-k*B)+(b*m-n*g)*(x*a-r*C)-(b*q-f*g)*(x*F-k*C)+(n*q-f*m)*(x*B-d*C)};a.multiply=function(a,c,b){var n=
a[0],f=a[1],t=a[2],g=a[3],m=a[4],q=a[5],x=a[6],d=a[7],k=a[8],r=a[9],C=a[10],B=a[11],F=a[12],D=a[13],y=a[14];a=a[15];var A=c[0],H=c[1],w=c[2],h=c[3];b[0]=A*n+H*m+w*k+h*F;b[1]=A*f+H*q+w*r+h*D;b[2]=A*t+H*x+w*C+h*y;b[3]=A*g+H*d+w*B+h*a;A=c[4];H=c[5];w=c[6];h=c[7];b[4]=A*n+H*m+w*k+h*F;b[5]=A*f+H*q+w*r+h*D;b[6]=A*t+H*x+w*C+h*y;b[7]=A*g+H*d+w*B+h*a;A=c[8];H=c[9];w=c[10];h=c[11];b[8]=A*n+H*m+w*k+h*F;b[9]=A*f+H*q+w*r+h*D;b[10]=A*t+H*x+w*C+h*y;b[11]=A*g+H*d+w*B+h*a;A=c[12];H=c[13];w=c[14];h=c[15];b[12]=A*n+
H*m+w*k+h*F;b[13]=A*f+H*q+w*r+h*D;b[14]=A*t+H*x+w*C+h*y;b[15]=A*g+H*d+w*B+h*a;return b};a.mul=a.multiply;a.translate=function(a,c,b){var n=c[0],f=c[1];c=c[2];var t,g,m,q,x,d,k,r,C,B,F,D;a===b?(b[12]=a[0]*n+a[4]*f+a[8]*c+a[12],b[13]=a[1]*n+a[5]*f+a[9]*c+a[13],b[14]=a[2]*n+a[6]*f+a[10]*c+a[14],b[15]=a[3]*n+a[7]*f+a[11]*c+a[15]):(t=a[0],g=a[1],m=a[2],q=a[3],x=a[4],d=a[5],k=a[6],r=a[7],C=a[8],B=a[9],F=a[10],D=a[11],b[0]=t,b[1]=g,b[2]=m,b[3]=q,b[4]=x,b[5]=d,b[6]=k,b[7]=r,b[8]=C,b[9]=B,b[10]=F,b[11]=D,
b[12]=t*n+x*f+C*c+a[12],b[13]=g*n+d*f+B*c+a[13],b[14]=m*n+k*f+F*c+a[14],b[15]=q*n+r*f+D*c+a[15]);return b};a.scale=function(a,c,b){var n=c[0],f=c[1];c=c[2];b[0]=a[0]*n;b[1]=a[1]*n;b[2]=a[2]*n;b[3]=a[3]*n;b[4]=a[4]*f;b[5]=a[5]*f;b[6]=a[6]*f;b[7]=a[7]*f;b[8]=a[8]*c;b[9]=a[9]*c;b[10]=a[10]*c;b[11]=a[11]*c;b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b};a.rotate=function(a,c,b,n){var f=b[0],t=b[1];b=b[2];var g=Math.sqrt(f*f+t*t+b*b),m,q,x,d,k,r,C,B,F,D,y,A,H,w,h,u,P,p,z,l;if(1E-7>Math.abs(g))return null;
g=1/g;f*=g;t*=g;b*=g;m=Math.sin(c);q=Math.cos(c);x=1-q;c=a[0];g=a[1];d=a[2];k=a[3];r=a[4];C=a[5];B=a[6];F=a[7];D=a[8];y=a[9];A=a[10];H=a[11];w=f*f*x+q;h=t*f*x+b*m;u=b*f*x-t*m;P=f*t*x-b*m;p=t*t*x+q;z=b*t*x+f*m;l=f*b*x+t*m;f=t*b*x-f*m;t=b*b*x+q;n[0]=c*w+r*h+D*u;n[1]=g*w+C*h+y*u;n[2]=d*w+B*h+A*u;n[3]=k*w+F*h+H*u;n[4]=c*P+r*p+D*z;n[5]=g*P+C*p+y*z;n[6]=d*P+B*p+A*z;n[7]=k*P+F*p+H*z;n[8]=c*l+r*f+D*t;n[9]=g*l+C*f+y*t;n[10]=d*l+B*f+A*t;n[11]=k*l+F*f+H*t;a!==n&&(n[12]=a[12],n[13]=a[13],n[14]=a[14],n[15]=a[15]);
return n};a.rotateX=function(a,c,b){var n=Math.sin(c);c=Math.cos(c);var f=a[4],t=a[5],g=a[6],m=a[7],q=a[8],x=a[9],d=a[10],k=a[11];a!==b&&(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]);b[4]=f*c+q*n;b[5]=t*c+x*n;b[6]=g*c+d*n;b[7]=m*c+k*n;b[8]=q*c-f*n;b[9]=x*c-t*n;b[10]=d*c-g*n;b[11]=k*c-m*n;return b};a.rotateY=function(a,c,b){var n=Math.sin(c);c=Math.cos(c);var f=a[0],t=a[1],g=a[2],m=a[3],q=a[8],x=a[9],d=a[10],k=a[11];a!==b&&(b[4]=a[4],b[5]=a[5],b[6]=a[6],
b[7]=a[7],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]);b[0]=f*c-q*n;b[1]=t*c-x*n;b[2]=g*c-d*n;b[3]=m*c-k*n;b[8]=f*n+q*c;b[9]=t*n+x*c;b[10]=g*n+d*c;b[11]=m*n+k*c;return b};a.rotateZ=function(a,c,b){var n=Math.sin(c);c=Math.cos(c);var f=a[0],t=a[1],g=a[2],m=a[3],q=a[4],x=a[5],d=a[6],k=a[7];a!==b&&(b[8]=a[8],b[9]=a[9],b[10]=a[10],b[11]=a[11],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]);b[0]=f*c+q*n;b[1]=t*c+x*n;b[2]=g*c+d*n;b[3]=m*c+k*n;b[4]=q*c-f*n;b[5]=x*c-t*n;b[6]=d*c-g*n;b[7]=k*c-m*n;return b};
a.uJ=function(a,c){c[0]=1;c[1]=0;c[2]=0;c[3]=0;c[4]=0;c[5]=1;c[6]=0;c[7]=0;c[8]=0;c[9]=0;c[10]=1;c[11]=0;c[12]=a[0];c[13]=a[1];c[14]=a[2];c[15]=1;return c};a.tJ=function(a,c){c[0]=a[0];c[1]=0;c[2]=0;c[3]=0;c[4]=0;c[5]=a[1];c[6]=0;c[7]=0;c[8]=0;c[9]=0;c[10]=a[2];c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return c};a.sJ=function(a,c,b){var n=c[0],f=c[1];c=c[2];var t=Math.sqrt(n*n+f*f+c*c),g;if(1E-7>Math.abs(t))return null;t=1/t;n*=t;f*=t;c*=t;t=Math.sin(a);a=Math.cos(a);g=1-a;b[0]=n*n*g+a;b[1]=f*n*g+c*
t;b[2]=c*n*g-f*t;b[3]=0;b[4]=n*f*g-c*t;b[5]=f*f*g+a;b[6]=c*f*g+n*t;b[7]=0;b[8]=n*c*g+f*t;b[9]=f*c*g-n*t;b[10]=c*c*g+a;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b};a.IQ=function(a,c){var b=Math.sin(a),n=Math.cos(a);c[0]=1;c[1]=0;c[2]=0;c[3]=0;c[4]=0;c[5]=n;c[6]=b;c[7]=0;c[8]=0;c[9]=-b;c[10]=n;c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return c};a.JQ=function(a,c){var b=Math.sin(a),n=Math.cos(a);c[0]=n;c[1]=0;c[2]=-b;c[3]=0;c[4]=0;c[5]=1;c[6]=0;c[7]=0;c[8]=b;c[9]=0;c[10]=n;c[11]=0;c[12]=0;c[13]=0;
c[14]=0;c[15]=1;return c};a.KQ=function(a,c){var b=Math.sin(a),n=Math.cos(a);c[0]=n;c[1]=b;c[2]=0;c[3]=0;c[4]=-b;c[5]=n;c[6]=0;c[7]=0;c[8]=0;c[9]=0;c[10]=1;c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return c};a.fromRotationTranslation=function(a,c,b){var n=a[0],f=a[1],t=a[2],g=a[3],m=n+n,q=f+f,x=t+t;a=n*m;var d=n*q,n=n*x,k=f*q,f=f*x,t=t*x,m=g*m,q=g*q,g=g*x;b[0]=1-(k+t);b[1]=d+g;b[2]=n-q;b[3]=0;b[4]=d-g;b[5]=1-(a+t);b[6]=f+m;b[7]=0;b[8]=n+q;b[9]=f-m;b[10]=1-(a+k);b[11]=0;b[12]=c[0];b[13]=c[1];b[14]=c[2];
b[15]=1;return b};a.GQ=function(a,c,b,n){var f=a[0],t=a[1],g=a[2],m=a[3],q=f+f,x=t+t,d=g+g;a=f*q;var k=f*x,f=f*d,r=t*x,t=t*d,g=g*d,q=m*q,x=m*x,m=m*d,d=b[0],C=b[1];b=b[2];n[0]=(1-(r+g))*d;n[1]=(k+m)*d;n[2]=(f-x)*d;n[3]=0;n[4]=(k-m)*C;n[5]=(1-(a+g))*C;n[6]=(t+q)*C;n[7]=0;n[8]=(f+x)*b;n[9]=(t-q)*b;n[10]=(1-(a+r))*b;n[11]=0;n[12]=c[0];n[13]=c[1];n[14]=c[2];n[15]=1;return n};a.HQ=function(a,c,b,n,f){var t=a[0],g=a[1],m=a[2],q=a[3],x=t+t,d=g+g,k=m+m;a=t*x;var r=t*d,t=t*k,C=g*d,g=g*k,m=m*k,x=q*x,d=q*d,q=
q*k,k=b[0],B=b[1];b=b[2];var F=n[0],D=n[1];n=n[2];f[0]=(1-(C+m))*k;f[1]=(r+q)*k;f[2]=(t-d)*k;f[3]=0;f[4]=(r-q)*B;f[5]=(1-(a+m))*B;f[6]=(g+x)*B;f[7]=0;f[8]=(t+d)*b;f[9]=(g-x)*b;f[10]=(1-(a+C))*b;f[11]=0;f[12]=c[0]+F-(f[0]*F+f[4]*D+f[8]*n);f[13]=c[1]+D-(f[1]*F+f[5]*D+f[9]*n);f[14]=c[2]+n-(f[2]*F+f[6]*D+f[10]*n);f[15]=1;return f};a.fromQuat=function(a,c){var b=a[0],n=a[1],f=a[2],t=a[3],g=b+b,m=n+n,q=f+f,b=b*g,x=n*g,n=n*m,d=f*g,k=f*m,f=f*q,g=t*g,m=t*m,t=t*q;c[0]=1-n-f;c[1]=x+t;c[2]=d-m;c[3]=0;c[4]=x-
t;c[5]=1-b-f;c[6]=k+g;c[7]=0;c[8]=d+m;c[9]=k-g;c[10]=1-b-n;c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return c};a.frustum=function(a,c,b,n,f,t,g){var m=1/(c-a),q=1/(n-b),x=1/(f-t);g[0]=2*f*m;g[1]=0;g[2]=0;g[3]=0;g[4]=0;g[5]=2*f*q;g[6]=0;g[7]=0;g[8]=(c+a)*m;g[9]=(n+b)*q;g[10]=(t+f)*x;g[11]=-1;g[12]=0;g[13]=0;g[14]=t*f*2*x;g[15]=0;return g};a.perspective=function(a,c,b,n,f){a=1/Math.tan(a/2);var t=1/(b-n);f[0]=a/c;f[1]=0;f[2]=0;f[3]=0;f[4]=0;f[5]=a;f[6]=0;f[7]=0;f[8]=0;f[9]=0;f[10]=(n+b)*t;f[11]=-1;f[12]=
0;f[13]=0;f[14]=2*n*b*t;f[15]=0;return f};a.HR=function(a,c,b,n){var f=Math.tan(a.upDegrees*Math.PI/180),t=Math.tan(a.downDegrees*Math.PI/180),g=Math.tan(a.leftDegrees*Math.PI/180);a=Math.tan(a.rightDegrees*Math.PI/180);var m=2/(g+a),q=2/(f+t);n[0]=m;n[1]=0;n[2]=0;n[3]=0;n[4]=0;n[5]=q;n[6]=0;n[7]=0;n[8]=-((g-a)*m*.5);n[9]=(f-t)*q*.5;n[10]=b/(c-b);n[11]=-1;n[12]=0;n[13]=0;n[14]=b*c/(c-b);n[15]=0;return n};a.ortho=function(a,c,b,n,f,t,g){var m=1/(a-c),q=1/(b-n),x=1/(f-t);g[0]=-2*m;g[1]=0;g[2]=0;g[3]=
0;g[4]=0;g[5]=-2*q;g[6]=0;g[7]=0;g[8]=0;g[9]=0;g[10]=2*x;g[11]=0;g[12]=(a+c)*m;g[13]=(n+b)*q;g[14]=(t+f)*x;g[15]=1;return g};a.lookAt=function(e,c,b,n){var f,t,g,m,q,x,d,k,r=e[0],C=e[1];e=e[2];g=b[0];m=b[1];t=b[2];d=c[0];b=c[1];f=c[2];if(1E-7>Math.abs(r-d)&&1E-7>Math.abs(C-b)&&1E-7>Math.abs(e-f))return a.identity(n);c=r-d;b=C-b;d=e-f;k=1/Math.sqrt(c*c+b*b+d*d);c*=k;b*=k;d*=k;f=m*d-t*b;t=t*c-g*d;g=g*b-m*c;(k=Math.sqrt(f*f+t*t+g*g))?(k=1/k,f*=k,t*=k,g*=k):g=t=f=0;m=b*g-d*t;q=d*f-c*g;x=c*t-b*f;(k=Math.sqrt(m*
m+q*q+x*x))?(k=1/k,m*=k,q*=k,x*=k):x=q=m=0;n[0]=f;n[1]=m;n[2]=c;n[3]=0;n[4]=t;n[5]=q;n[6]=b;n[7]=0;n[8]=g;n[9]=x;n[10]=d;n[11]=0;n[12]=-(f*r+t*C+g*e);n[13]=-(m*r+q*C+x*e);n[14]=-(c*r+b*C+d*e);n[15]=1;return n};a.str=function(a){return"mat4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+")"};a.rJ=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],
2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2)+Math.pow(a[9],2)+Math.pow(a[10],2)+Math.pow(a[11],2)+Math.pow(a[12],2)+Math.pow(a[13],2)+Math.pow(a[14],2)+Math.pow(a[15],2))}};b4w.module.mat4=b4w.module.__mat4;b4w.module.__md5=function(a){function q(a,f){var m=a[0],q=a[1],x=a[2],d=a[3],m=c(m,q,x,d,f[0],7,-680876936),d=c(d,m,q,x,f[1],12,-389564586),x=c(x,d,m,q,f[2],17,606105819),q=c(q,x,d,m,f[3],22,-1044525330),m=c(m,q,x,d,f[4],7,-176418897),d=c(d,m,q,x,f[5],12,1200080426),x=c(x,d,m,q,f[6],17,-1473231341),q=c(q,x,d,m,f[7],22,-45705983),m=c(m,q,x,d,f[8],7,1770035416),d=c(d,m,q,x,f[9],12,-1958414417),x=c(x,d,m,q,f[10],17,-42063),q=c(q,x,d,m,f[11],22,-1990404162),m=c(m,q,x,d,f[12],7,1804603682),d=c(d,m,q,x,
f[13],12,-40341101),x=c(x,d,m,q,f[14],17,-1502002290),q=c(q,x,d,m,f[15],22,1236535329),m=b(m,q,x,d,f[1],5,-165796510),d=b(d,m,q,x,f[6],9,-1069501632),x=b(x,d,m,q,f[11],14,643717713),q=b(q,x,d,m,f[0],20,-373897302),m=b(m,q,x,d,f[5],5,-701558691),d=b(d,m,q,x,f[10],9,38016083),x=b(x,d,m,q,f[15],14,-660478335),q=b(q,x,d,m,f[4],20,-405537848),m=b(m,q,x,d,f[9],5,568446438),d=b(d,m,q,x,f[14],9,-1019803690),x=b(x,d,m,q,f[3],14,-187363961),q=b(q,x,d,m,f[8],20,1163531501),m=b(m,q,x,d,f[13],5,-1444681467),d=
b(d,m,q,x,f[2],9,-51403784),x=b(x,d,m,q,f[7],14,1735328473),q=b(q,x,d,m,f[12],20,-1926607734),m=e(q^x^d,m,q,f[5],4,-378558),d=e(m^q^x,d,m,f[8],11,-2022574463),x=e(d^m^q,x,d,f[11],16,1839030562),q=e(x^d^m,q,x,f[14],23,-35309556),m=e(q^x^d,m,q,f[1],4,-1530992060),d=e(m^q^x,d,m,f[4],11,1272893353),x=e(d^m^q,x,d,f[7],16,-155497632),q=e(x^d^m,q,x,f[10],23,-1094730640),m=e(q^x^d,m,q,f[13],4,681279174),d=e(m^q^x,d,m,f[0],11,-358537222),x=e(d^m^q,x,d,f[3],16,-722521979),q=e(x^d^m,q,x,f[6],23,76029189),m=
e(q^x^d,m,q,f[9],4,-640364487),d=e(m^q^x,d,m,f[12],11,-421815835),x=e(d^m^q,x,d,f[15],16,530742520),q=e(x^d^m,q,x,f[2],23,-995338651),m=n(m,q,x,d,f[0],6,-198630844),d=n(d,m,q,x,f[7],10,1126891415),x=n(x,d,m,q,f[14],15,-1416354905),q=n(q,x,d,m,f[5],21,-57434055),m=n(m,q,x,d,f[12],6,1700485571),d=n(d,m,q,x,f[3],10,-1894986606),x=n(x,d,m,q,f[10],15,-1051523),q=n(q,x,d,m,f[1],21,-2054922799),m=n(m,q,x,d,f[8],6,1873313359),d=n(d,m,q,x,f[15],10,-30611744),x=n(x,d,m,q,f[6],15,-1560198380),q=n(q,x,d,m,f[13],
21,1309151649),m=n(m,q,x,d,f[4],6,-145523070),d=n(d,m,q,x,f[11],10,-1120210379),x=n(x,d,m,q,f[2],15,718787259),q=n(q,x,d,m,f[9],21,-343485551);a[0]=m+a[0]&4294967295;a[1]=q+a[1]&4294967295;a[2]=x+a[2]&4294967295;a[3]=d+a[3]&4294967295}function e(a,b,c,e,f,d){b=(b+a&4294967295)+(e+d&4294967295)&4294967295;return(b<<f|b>>>32-f)+c&4294967295}function c(a,b,c,f,n,d,k){return e(b&c|~b&f,a,b,n,d,k)}function b(a,b,c,f,n,d,k){return e(b&f|c&~f,a,b,n,d,k)}function n(a,b,c,f,n,d,k){return e(c^(b|~f),a,b,n,
d,k)}var f="0123456789abcdef".split("");a.mA=function(a){var b=a,c=b.length;a=[1732584193,-271733879,-1732584194,271733878];var e;for(e=64;e<=b.length;e+=64){for(var n=b.substring(e-64,e),d=[],k=void 0,k=0;64>k;k+=4)d[k>>2]=n.charCodeAt(k)+(n.charCodeAt(k+1)<<8)+(n.charCodeAt(k+2)<<16)+(n.charCodeAt(k+3)<<24);q(a,d)}b=b.substring(e-64);n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<b.length;e++)n[e>>2]|=b.charCodeAt(e)<<(e%4<<3);n[e>>2]|=128<<(e%4<<3);if(55<e)for(q(a,n),e=0;16>e;e++)n[e]=0;n[14]=8*
c;q(a,n);for(b=0;b<a.length;b++){c=a[b];e="";for(n=0;4>n;n++)e+=f[c>>8*n+4&15]+f[c>>8*n&15];a[b]=e}return a.join("")}};b4w.module.shader_texts=function(a){a["anchors.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 ) ; }".split(" ")}]};a["anchors.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"ANCHOR_NUM",b:["0"]},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform vec3 u_position [ ANCHOR_NUM ] ; uniform mat4 u_view_proj_matrix ; GLSL_IN float a_index ; void main ( ) { gl_Position = u_view_proj_matrix * vec4 ( u_position [ int ( a_index ) ] , 1.0 ) ; gl_PointSize = 4.0 ; }".split(" ")}]};
a["color_id.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"ALPHA_CLIP",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"USE_OUTLINE",b:["0"]},{a:"var",c:"USE_VIEW_MATRIX",b:["0"]},{a:"var",c:"USE_VIEW_MATRIX_INVERSE",b:["0"]},{a:"var",c:"USE_MODEL_MATRIX",b:["0"]},{a:"var",c:"USE_MODEL_MATRIX_INVERSE",
b:["0"]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"USE_REFRACTION",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"TEXTURE_BLEND_TYPE",b:["TEXTURE_BLEND_TYPE_MIX"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"NUM_LAMP_LIGHTS",b:["0"]},{a:"var",c:"NUM_LFACTORS",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"NUM_VALUES",b:["0"]},{a:"var",c:"NUM_RGBS",b:["0"]},
{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"POISSON_DISK_NUM",b:["NO_SOFT_SHADOWS"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",e:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"math.glslv"}]}}]},{a:"cond",d:[{a:"if",e:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform float u_time ; uniform float u_environment_energy ;".split(" ")},{a:"cond",d:[{a:"if",e:["NUM_LIGHTS",0,{a:"g_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec3 u_light_color_intensities [ NUM_LIGHTS ] ; uniform vec4 u_light_factors [ NUM_LFACTORS ] ;".split(" ")}]}}]},{a:"txt",b:["uniform","vec3","u_camera_eye_frag",";"]},{a:"cond",d:[{a:"if",e:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_NODE_GEOMETRY_VW","USE_VIEW_MATRIX",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_frag",
";"]}]}}]},{a:"cond",d:[{a:"if",e:["USE_VIEW_MATRIX_INVERSE"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",e:["USE_MODEL_MATRIX"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"cond",d:[{a:"if",e:["USE_MODEL_MATRIX_INVERSE"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",e:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform",
"samplerCube","u_sky_texture",";"]}]}},{a:"elif",e:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_diffuse_color",";"]},{a:"cond",d:[{a:"if",e:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:"uniform sampler2D u_sampler ; uniform float u_alpha_factor ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",e:["USE_OUTLINE",{a:"logic_negative_expr",
i:1}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_color_id",";"]}]}}]},{a:"cond",d:[{a:"if",e:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{a:"cond",d:[{a:"if",e:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_plane_reflection",";"]}]}},{a:"elif",
e:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_cube_reflection",";"]}]}},{a:"elif",e:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{a:"cond",d:[{a:"if",e:["USE_NODE_B4W_REFRACTION"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_refractmap",";"]},{a:"cond",d:[{a:"if",e:["USE_REFRACTION","USE_REFRACTION_CORRECTION",{a:"logical_and_expr",i:2}],h:{a:"grp",
d:[{a:"txt",b:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]}]}}]},{a:"txt",b:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ;".split(" ")},{a:"cond",d:[{a:"if",e:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_mirror_factor",";"]}]}},{a:"elif",e:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_refl_plane",";"]}]}}]},{a:"cond",d:[{a:"if",e:["USE_NODE_LAMP"],
h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ; uniform vec4 u_lamp_light_factors [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["USE_NODE_VALUE"],h:{a:"grp",d:[{a:"txt",b:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["USE_NODE_RGB"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",e:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_pcf_blur_radii",";"]}]}}]},{a:"txt",b:"uniform vec4 u_csm_center_dists ; uniform GLSL_SMPLR2D_SHDW u_shadow_map0 ; uniform GLSL_SMPLR2D_SHDW u_shadow_map1 ; uniform GLSL_SMPLR2D_SHDW u_shadow_map2 ; uniform GLSL_SMPLR2D_SHDW u_shadow_map3 ; uniform sampler2D u_shadow_mask ;".split(" ")}]}}]}]}}]},
{a:"cond",d:[{a:"if",e:["USE_OUTLINE"],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_outline_intensity",";"]}]}}]},{a:"cond",d:[{a:"if",e:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec3 c ; GLSL_IN vec4 d ;".split(" ")},{a:"cond",d:[{a:"if",e:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE",{a:"logical_or_expr",i:5}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","e",";"]}]}}]},{a:"cond",d:[{a:"if",e:["CALC_TBN_SPACE"],
h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","f",";"]}]}}]},{a:"cond",d:[{a:"if",e:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_NODE_B4W_REFRACTION",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","h",";"]}]}}]},{a:"cond",d:[{a:"if",e:["USE_NODE_B4W_REFRACTION","USE_REFRACTION",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","i",";"]}]}}]},{a:"cond",d:[{a:"if",e:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:"GLSL_IN vec4 j ; GLSL_IN vec4 k ; GLSL_IN vec4 l ; GLSL_IN vec4 m ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","n",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",e:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","o",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"cond",d:[{a:"if",e:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"nodes.glslf"}]}}]},{a:"txt",
b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",e:["ALPHA"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["NODES"],h:{a:"grp",d:[{a:"txt",b:"vec3 u = u_camera_eye_frag - c ; vec3 v = normalize ( u ) ; vec3 A ; vec3 B ; vec3 C ; vec4 D ; float E ; mat3 F = mat3 ( 0.0 ) ; mat3 G = mat3 ( 0.0 ) ; mat3 H = mat3 ( 0.0 ) ; mat3 I = mat3 ( 0.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",e:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_NODE_GEOMETRY_VW",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:["F","=","u_view_tsr_frag",";"]}]}}]},{a:"cond",d:[{a:"if",e:["USE_VIEW_MATRIX_INVERSE"],h:{a:"grp",d:[{a:"txt",b:["G","=","u_view_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",e:["USE_MODEL_MATRIX"],h:{a:"grp",d:[{a:"txt",b:["H","=","u_model_tsr",";"]}]}}]},{a:"cond",d:[{a:"if",e:["USE_MODEL_MATRIX_INVERSE"],h:{a:"grp",d:[{a:"txt",b:["I","=","u_model_tsr_inverse",";"]}]}}]},{a:"txt",b:"J ( v , F , G , H , I , A , B , C , D , E ) ; float L = E ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"cond",
d:[{a:"if",e:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:"float L = ( GLSL_TEXTURE ( u_sampler , n ) ) . a ;".split(" ")},{a:"cond",d:[{a:"if",e:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float M = u_alpha_factor * L ; M += ( 1.0 - step ( 0.0 , M ) ) ; L = mix ( M , 1.0 , u_diffuse_color . a ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"float L = u_diffuse_color . a ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",e:["ALPHA_CLIP"],h:{a:"grp",
d:[{a:"txt",b:"if ( L < 0.5 ) discard ; L = 1.0 ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",e:["USE_OUTLINE"],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , 1.0 , 1.0 , u_outline_intensity ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( u_color_id , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]};a["color_id.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"CAUSTICS",b:["0"]},
{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"var",c:"CALC_TBN",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"AU_QUALIFIER",b:["GLSL_IN"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"WIND_BEND",b:["0"]},{a:"var",c:"BEND_CENTER_ONLY",b:["0"]},{a:"var",c:"BILLBOARD_PRES_GLOB_ORIENTATION",b:["0"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",
b:["0"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",c:"SKINNED",b:["0"]},{a:"var",c:"FRAMES_BLENDING",b:["0"]},{a:"var",c:"VERTEX_ANIM",b:["0"]},{a:"var",c:"SMAA_JITTER",b:["0"]},{a:"var",c:"VERTEX_ANIM_MIX_NORMALS_FACTOR",b:["u_va_frame_factor"]},{a:"var",c:"MAX_BONES",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"include",o:"scale_texcoord.glslv"},{a:"cond",d:[{a:"if",
e:["STATIC_BATCH"],h:{a:"grp",d:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},{a:"cond",d:[{a:"if",e:["BILLBOARD","DYNAMIC_GRASS",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{a:"cond",d:[{a:"if",e:["NODES","ALPHA",{a:"logical_and_expr",
i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["SMAA_JITTER"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{a:"cond",d:[{a:"if",e:["USE_NODE_B4W_REFRACTION"],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",e:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},{a:"cond",d:[{a:"if",
e:["FRAMES_BLENDING"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",e:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["BILLBOARD_JITTERED"],h:{a:"grp",d:[{a:"txt",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{a:"txt",b:"uniform vec3 u_wind ; uniform float u_time ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["VERTEX_ANIM"],h:{a:"grp",
d:[{a:"txt",b:["uniform","float","u_va_frame_factor",";"]}]}}]},{a:"cond",d:[{a:"if",e:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_texture_scale",";"]}]}}]},{a:"txt",b:["GLSL_IN","vec3","a_position",";"]},{a:"cond",d:[{a:"if",e:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},"CALC_TBN",{a:"logical_or_expr",i:7}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_tbn_quat",
";"]}]}}]},{a:"cond",d:[{a:"if",e:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_shade_tangs",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",e:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_influence",";"]}]}}]},{a:"cond",d:[{a:"if",e:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["MAIN_BEND_COL"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","a_bending_col_main",";"]},{a:"cond",d:[{a:"if",e:["DETAIL_BEND"],
h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},{a:"txt",b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{a:"cond",d:[{a:"if",e:["BEND_CENTER_ONLY"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_emitter_center",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",e:["WIND_BEND","BILLBOARD",{a:"logical_or_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{a:"cond",d:[{a:"if",e:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_position_next",";"]},{a:"cond",d:[{a:"if",e:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE",{a:"logical_or_expr",i:5}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_tbn_quat_next",";"]}]}}]}]}}]}]}}]},
{a:"cond",d:[{a:"if",e:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","a_texcoord",";"]}]}}]},{a:"cond",d:[{a:"if",e:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","o",";"]}]}}]},{a:"cond",d:[{a:"if",e:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT vec3 c ; GLSL_OUT vec4 d ;".split(" ")},{a:"cond",d:[{a:"if",e:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL",
"DETAIL_BEND",{a:"logical_and_expr",i:3},{a:"logical_or_expr",i:6}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","e",";"]}]}}]},{a:"cond",d:[{a:"if",e:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","f",";"]}]}}]},{a:"cond",d:[{a:"if",e:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_NODE_B4W_REFRACTION",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","h",";"]}]}}]},{a:"cond",d:[{a:"if",e:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{a:"logical_and_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","float","i",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec2","n",";"]}]}}]}]}}]},{a:"include",o:"skin.glslv"},{a:"include",o:"wind_bending.glslv"},{a:"cond",d:[{a:"if",e:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"nodes.glslv"}]}}]},{a:"txt",b:"void main ( ) { mat3 N = u_view_tsr ; vec3 O = a_position ;".split(" ")},{a:"cond",d:[{a:"if",e:["NODES","ALPHA",
"CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_NORMAL_MAP","USE_NODE_GEOMETRY_NO","CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},{a:"logical_or_expr",i:6},{a:"logical_and_expr",i:3},"USE_TBN_SHADING","CALC_TBN",{a:"logical_and_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 Q = P ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")},{a:"cond",d:[{a:"if",e:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:"vec3 R = P ( a_tbn_quat , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 S = sign ( a_tbn_quat [ 3 ] ) * cross ( Q , R ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 R = vec3 ( 0.0 ) ; vec3 S = vec3 ( 0.0 ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Q = vec3 ( 0.0 ) ; vec3 R = vec3 ( 0.0 ) ; vec3 S = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:["mat3","T","=","u_model_tsr",";"]},{a:"cond",d:[{a:"if",e:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["CALC_TBN"],h:{a:"grp",d:[{a:"txt",b:"vec3 V = normalize ( U ( u_model_tsr , Q ) ) ; vec3 W = cross ( vec3 ( 0.0 , 0.0 , 1.0 ) , V ) ; vec3 X = cross ( V , W ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec3","X","=","a_shade_tangs",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 X = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:"O = mix ( O , a_position_next , u_va_frame_factor ) ;".split(" ")},{a:"cond",d:[{a:"if",e:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE",{a:"logical_or_expr",
i:5}],h:{a:"grp",d:[{a:"txt",b:"vec3 Y = P ( a_tbn_quat_next , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; Q = mix ( Q , Y , VERTEX_ANIM_MIX_NORMALS_FACTOR ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:"vec3 Z = P ( a_tbn_quat_next , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 _ = sign ( a_tbn_quat_next [ 3 ] ) * cross ( Y , Z ) ; R = mix ( R , Z , u_va_frame_factor ) ; S = mix ( S , _ , u_va_frame_factor ) ;".split(" ")}]}}]}]}}]}]}}]},{a:"cond",d:[{a:"if",e:["SKINNED"],h:{a:"grp",
d:[{a:"txt",b:"ac ( O , R , S , Q ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["WIND_BEND","BILLBOARD",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["vec3","ad","=","au_center_pos",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 ad = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["BILLBOARD"],h:{a:"grp",d:[{a:"txt",b:"vec3 af = ae ( T , ad ) ;".split(" ")},{a:"cond",d:[{a:"if",e:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:"T = ah ( u_camera_eye , af , N , T ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"T = ai ( u_camera_eye , af , N ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"T = aj ( u_wind , u_time , u_jitter_amp , u_jitter_freq , af , T ) ;".split(" ")}]}}]},{a:"txt",b:"ak am = al ( O - ad , ad , vec3 ( 0.0 ) , X , vec3 ( 0.0 ) , vec3 ( 0.0 ) , T ) ; am . ad = af ;".split(" ")}]}},{a:"else",
h:{a:"grp",d:[{a:"txt",b:"ak am = al ( O , ad , vec3 ( 0.0 ) , X , vec3 ( 0.0 ) , vec3 ( 0.0 ) , T ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"an ( am . O , am . ad , Q , mat4 ( 0.0 ) ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 ao = P ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 ao = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"an ( am . O , am . ad , ao , mat4 ( 0.0 ) ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",e:["NODES","ALPHA",{a:"logical_and_expr",i:2},{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:"n = ap ( a_texcoord , u_texture_scale ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",e:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"c = am . O ;".split(" ")},
{a:"cond",d:[{a:"if",e:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},{a:"logical_or_expr",i:6}],h:{a:"grp",d:[{a:"txt",b:"e = am . Q ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:"float aq = ( dot ( cross ( am . Q , am . R ) , am . S ) < 0.0 ) ? - 1.0 : 1.0 ; f = vec4 ( am . R , aq ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["USE_TBN_SHADING"],
h:{a:"grp",d:[{a:"txt",b:"o = am . as ;".split(" ")}]}}]},{a:"txt",b:"d = vec4 ( ae ( N , am . O ) , 1.0 ) ; vec4 at = u_proj_matrix * d ;".split(" ")},{a:"cond",d:[{a:"if",e:["SMAA_JITTER"],h:{a:"grp",d:[{a:"txt",b:"at . xy += u_subpixel_jitter * at . w ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_NODE_B4W_REFRACTION",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float au = at . x ; float av = at . y ; float aw = at . w ; h . x = ( au + aw ) / 2.0 ; h . y = ( av + aw ) / 2.0 ; h . z = aw ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",e:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"i = - d . z / u_view_max_depth ;".split(" ")}]}}]},{a:"txt",b:["J","(",")",";"]}]}}]},{a:"txt",b:"gl_Position = u_proj_matrix * vec4 ( ae ( N , am . O ) , 1.0 ) ; }".split(" ")}]};a["debug_view.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"DEBUG_SPHERE",b:["0"]},{a:"var",c:"WIREFRAME_QUALITY",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"DEBUG_SPHERE_DYNAMIC",
b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"cond",d:[{a:"if",e:["DEBUG_SPHERE",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"uniform int u_debug_view_mode ; uniform float u_cluster_id ; uniform float u_batch_debug_id_color ; uniform float u_batch_debug_main_render_time ; uniform float u_debug_colors_seed ; uniform float u_debug_render_time_threshold ; uniform vec3 u_wireframe_edge_color ;".split(" ")}]}}]},{a:"txt",
b:"GLSL_IN vec3 ax ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; const float ay = 1.0 ;".split(" ")},{a:"cond",d:[{a:"if",e:["DEBUG_SPHERE"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["DEBUG_SPHERE_DYNAMIC"],h:{a:"grp",d:[{a:"txt",b:"const vec3 az = vec3 ( 1.0 , 0.05 , 0.05 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"const vec3 az = vec3 ( 0.05 , 0.05 , 1.0 ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"const vec3 aA = vec3 ( 0.4 , 0.4 , 1.0 ) ; const vec3 aB = vec3 ( 1.0 , 0.4 , 0.4 ) ; const vec3 aC = vec3 ( 1.0 , 1.0 , 1.0 ) ; const vec3 aD = vec3 ( 0.0 , 133.0 / 255.0 , 66.0 / 255.0 ) ; const vec3 aE = vec3 ( 160.0 / 255.0 , 38.0 / 255.0 , 33.0 / 255.0 ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",e:["DEBUG_SPHERE",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"float aJ ( ) { float aF = 1.0 ;".split(" ")},{a:"cond",d:[{a:"if",e:["WIREFRAME_QUALITY",0,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 aG = sign ( ax - vec3 ( 0.02 * ay ) ) ; if ( aG . x < 0.0 || aG . y < 0.0 || aG . z < 0.0 ) aF = 0.0 ;".split(" ")}]}},{a:"elif",e:["WIREFRAME_QUALITY",1,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["GLSL1"],h:{a:"grp",d:[{a:"extension",b:["GL_OES_standard_derivatives",
":","enable"]}]}}]},{a:"txt",b:"vec3 aH = fwidth ( ax ) ; vec3 aI = smoothstep ( vec3 ( 0.0 ) , aH * ay , ax ) ; aF = min ( min ( aI . x , aI . y ) , aI . z ) ; aF = clamp ( aF , 0.0 , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:["return","aF",";","}"]}]}}]},{a:"txt",b:"void main ( ) { vec3 aK = vec3 ( 0.0 ) ; float L = 0.0 ;".split(" ")},{a:"cond",d:[{a:"if",e:["DEBUG_SPHERE"],h:{a:"grp",d:[{a:"txt",b:"vec3 aG = sign ( ax - vec3 ( 0.02 * ay ) ) ; if ( aG . x < 0.0 || aG . y < 0.0 || aG . z < 0.0 ) { aK = az ; L = 1.0 ; } else discard ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"if ( u_debug_view_mode == DV_OPAQUE_WIREFRAME ) { float aF = aJ ( ) ; aK = vec3 ( mix ( u_wireframe_edge_color , aC , aF ) ) ; L = 1.0 ; } else if ( u_debug_view_mode == DV_TRANSPARENT_WIREFRAME ) { float aF = aJ ( ) ; aK = u_wireframe_edge_color ; L = mix ( 1.0 , 0.0 , aF ) ; } else if ( u_debug_view_mode == DV_FRONT_BACK_VIEW ) { float aF = aJ ( ) ; if ( gl_FrontFacing ) aK = mix ( u_wireframe_edge_color , aA , aF ) ; else aK = mix ( u_wireframe_edge_color , aB , aF ) ; L = 1.0 ; } else if ( u_debug_view_mode == DV_CLUSTERS_VIEW ) { float aL = u_cluster_id + u_debug_colors_seed + 2.0 ; aK = vec3 ( fract ( aL * 19.73 ) , fract ( aL * 6.34 ) , fract ( aL * 1.56 ) ) ; L = 1.0 ; } else if ( u_debug_view_mode == DV_BATCHES_VIEW ) { float aL = u_batch_debug_id_color + u_debug_colors_seed ; aK = vec3 ( fract ( aL * 19.73 ) , fract ( aL * 6.34 ) , fract ( aL * 1.56 ) ) ; L = 1.0 ; } else if ( u_debug_view_mode == DV_RENDER_TIME ) { float aM ; if ( u_debug_render_time_threshold > 0.0 ) aM = clamp ( u_batch_debug_main_render_time , 0.0 , u_debug_render_time_threshold ) / u_debug_render_time_threshold ; else aM = 1.0 ; float aN = clamp ( 2.0 * aM , 0.0 , 1.0 ) ; float aO = clamp ( 2.0 * aM - 1.0 , 0.0 , 1.0 ) ; float aP = aM ; aK = mix ( aD , aE , vec3 ( aN , aO , aP ) ) ; L = 1.0 ; }".split(" ")}]}}]},
{a:"txt",b:["aQ","(","aK",")",";"]},{a:"cond",d:[{a:"if",e:["ALPHA"],h:{a:"grp",d:[{a:"txt",b:"aR ( aK , L ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aK , L ) ; }".split(" ")}]};a["debug_view.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"USE_INSTANCED_PARTCLS",b:["0"]},{a:"var",c:"DEBUG_VIEW_SPECIAL_SKYDOME",b:["0"]},{a:"var",c:"DEBUG_SPHERE",b:["0"]},{a:"var",c:"WIND_BEND",b:["0"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",
c:"BILLBOARD",b:["0"]},{a:"var",c:"VERTEX_ANIM",b:["0"]},{a:"var",c:"SKINNED",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"AU_QUALIFIER",b:["GLSL_IN"]},{a:"var",c:"BEND_CENTER_ONLY",b:["0"]},{a:"var",c:"FRAMES_BLENDING",b:["0"]},{a:"var",c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"MAX_BONES",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"var",c:"BILLBOARD_PRES_GLOB_ORIENTATION",b:["0"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"include",
o:"to_world.glslv"},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec4 a_tbn_quat ; GLSL_IN float a_polyindex ;".split(" ")},{a:"cond",d:[{a:"if",e:["USE_INSTANCED_PARTCLS"],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec4 a_part_ts ; GLSL_IN vec4 a_part_r ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["DEBUG_SPHERE",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["MAIN_BEND_COL"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","a_bending_col_main",
";"]},{a:"cond",d:[{a:"if",e:["DETAIL_BEND"],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},{a:"txt",b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{a:"cond",d:[{a:"if",e:["BEND_CENTER_ONLY"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_emitter_center",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",
e:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{a:"cond",d:[{a:"if",e:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_position_next",";"]}]}}]},{a:"cond",d:[{a:"if",e:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_influence",";"]}]}}]}]}}]},{a:"txt",b:["GLSL_OUT","vec3","ax",";"]},{a:"cond",d:[{a:"if",
e:["STATIC_BATCH"],h:{a:"grp",d:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},{a:"cond",d:[{a:"if",e:["DEBUG_SPHERE",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["WIND_BEND"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_wind ; uniform PRECISION float u_time ;".split(" ")},
{a:"cond",d:[{a:"if",e:["BILLBOARD","BILLBOARD_JITTERED",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",e:["DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{a:"cond",d:[{a:"if",e:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_va_frame_factor",";"]}]}}]},{a:"cond",d:[{a:"if",e:["SKINNED"],h:{a:"grp",
d:[{a:"txt",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},{a:"cond",d:[{a:"if",e:["FRAMES_BLENDING"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",e:["DYNAMIC_GRASS"],h:{a:"grp",d:[{a:"txt",b:"uniform PRECISION sampler2D u_grass_map_depth ; uniform sampler2D u_grass_map_color ; uniform vec4 u_camera_quat ; uniform vec3 u_grass_map_dim ; uniform float u_grass_size ; uniform float u_scale_threshold ;".split(" ")}]}}]}]}}]},
{a:"cond",d:[{a:"if",e:["DEBUG_SPHERE",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"skin.glslv"},{a:"include",o:"wind_bending.glslv"},{a:"include",o:"dynamic_grass.glslv"}]}}]},{a:"txt",b:"void main ( ) { if ( a_polyindex == 0.0 ) ax = vec3 ( 1.0 , 0.0 , 0.0 ) ; else if ( a_polyindex == 1.0 ) ax = vec3 ( 0.0 , 1.0 , 0.0 ) ; else if ( a_polyindex == 2.0 ) ax = vec3 ( 0.0 , 0.0 , 1.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",e:["DEBUG_VIEW_SPECIAL_SKYDOME"],h:{a:"grp",d:[{a:"txt",b:"gl_Position = vec4 ( a_position . xy , 0.9999999 , 1.0 ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["USE_INSTANCED_PARTCLS"],h:{a:"grp",d:[{a:"txt",b:"mat3 T = mat3 ( a_part_ts [ 0 ] , a_part_ts [ 1 ] , a_part_ts [ 2 ] , a_part_ts [ 3 ] , a_part_r [ 0 ] , a_part_r [ 1 ] , a_part_r [ 2 ] , a_part_r [ 3 ] , 1.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",e:["STATIC_BATCH",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"T = aS ( u_model_tsr , T ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["mat3","T","=","u_model_tsr",";"]}]}}]},{a:"txt",
b:"mat3 N = u_view_tsr ; vec3 O = a_position ; vec3 Q = P ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")},{a:"cond",d:[{a:"if",e:["DEBUG_SPHERE"],h:{a:"grp",d:[{a:"txt",b:"ak am = al ( O , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , T ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:"O = mix ( O , a_position_next , u_va_frame_factor ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["SKINNED"],h:{a:"grp",
d:[{a:"txt",b:"vec3 R = vec3 ( 0.0 ) ; vec3 S = vec3 ( 0.0 ) ; ac ( O , R , S , Q ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["vec3","ad","=","au_center_pos",";"]}]}},{a:"elif",e:["DYNAMIC_GRASS","USE_INSTANCED_PARTCLS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 ad = a_part_ts . xyz ; O = ae ( T , O ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 ad = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["DYNAMIC_GRASS"],h:{a:"grp",d:[{a:"txt",b:"ak am = aT ( O , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , ad , u_grass_map_depth , u_grass_map_color , u_grass_map_dim , u_grass_size , u_camera_eye , u_camera_quat , N ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["BILLBOARD"],h:{a:"grp",d:[{a:"txt",b:"vec3 af = ae ( T , ad ) ;".split(" ")},{a:"cond",d:[{a:"if",
e:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2},"USE_INSTANCED_PARTCLS",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"T = ah ( u_camera_eye , af , N , T ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"T = ai ( u_camera_eye , af , N ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 aU = af ; T = aj ( u_wind , u_time , u_jitter_amp , u_jitter_freq , aU , T ) ;".split(" ")}]}}]},
{a:"txt",b:"ak am = al ( O - ad , ad , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , T ) ; am . ad = af ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"ak am = al ( O , ad , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , T ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",e:["WIND_BEND"],h:{a:"grp",d:[{a:"txt",b:"an ( am . O , am . ad , Q , mat4 ( 0.0 ) ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:"gl_Position = u_proj_matrix * vec4 ( ae ( N , am . O ) , 1.0 ) ;".split(" ")}]}}]},
{a:"txt",b:["}"]}]};a["error.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , 0.0 , 1.0 , 1.0 ) ; }".split(" ")}]};a["error.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"txt",b:"GLSL_IN vec3 a_position ; uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; void main ( ) { gl_Position = u_proj_matrix * aV ( u_view_tsr ) * vec4 ( a_position , 1.0 ) ; }".split(" ")}]};
a["grass_map.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"DYNAMIC_GRASS_SIZE",b:["0"]},{a:"var",c:"DYNAMIC_GRASS_COLOR",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",e:["DYNAMIC_GRASS_SIZE"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","aW",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","aW",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",
e:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","aW",";"]}]}}]}]}}]},{a:"txt",b:"GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) {".split(" ")},{a:"cond",d:[{a:"if",e:["DYNAMIC_GRASS_SIZE"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT_FRAG_COLOR","=","aW",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aW , vec3 ( 1.0 ) ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["DYNAMIC_GRASS_COLOR"],
h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , aW ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:["}"]}]};a["grass_map.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"DYNAMIC_GRASS_SIZE",b:["0"]},{a:"var",c:"DYNAMIC_GRASS_COLOR",b:["0"]},{a:"var",c:"WIND_BEND",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"include",
o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"txt",b:["GLSL_IN","vec3","a_position",";"]},{a:"cond",d:[{a:"if",e:["DYNAMIC_GRASS_SIZE"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","a_grass_size",";"]}]}}]},{a:"cond",d:[{a:"if",e:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_grass_color",";"]}]}}]},{a:"cond",d:[{a:"if",e:["DYNAMIC_GRASS_SIZE"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT",
"vec4","aW",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","float","aW",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","aW",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",e:["STATIC_BATCH"],h:{a:"grp",d:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},
{a:"cond",d:[{a:"if",e:["BILLBOARD"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{a:"cond",d:[{a:"if",e:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_wind ; uniform float u_time ; uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{a:"txt",b:"void main ( ) { mat3 N = u_view_tsr ; mat3 T = u_model_tsr ;".split(" ")},{a:"cond",d:[{a:"if",e:["BILLBOARD"],h:{a:"grp",d:[{a:"txt",b:"vec3 af = ae ( T , vec3 ( 0.0 ) ) ; mat3 T = ai ( u_camera_eye , af , N ) ;".split(" ")},
{a:"cond",d:[{a:"if",e:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"T = aj ( u_wind , u_time , u_jitter_amp , u_jitter_freq , vec3 ( 0.0 ) , T ) ;".split(" ")}]}}]},{a:"txt",b:"ak am = al ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , T ) ; am . ad = af ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"ak am = al ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , T ) ;".split(" ")}]}}]},
{a:"txt",b:"vec4 at = u_proj_matrix * vec4 ( ae ( N , am . O ) , 1.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",e:["DYNAMIC_GRASS_SIZE"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",d:[{a:"txt",b:"aW = vec4 ( a_grass_size , a_grass_color ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["aW","=","a_grass_size",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",d:[{a:"txt",b:["aW","=","a_grass_color",";"]}]}}]}]}}]},{a:"txt",
b:["gl_Position","=","at",";","}"]}]};a["halo.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"SKY_STARS",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform vec4 u_diffuse_color ; uniform vec3 u_halo_rings_color ; uniform vec3 u_halo_lines_color ; uniform float u_halo_hardness ; uniform float u_halo_size ;".split(" ")},{a:"cond",d:[{a:"if",e:["SKY_STARS"],h:{a:"grp",
d:[{a:"txt",b:["uniform","vec3","u_sun_intensity",";"]},{a:"cond",d:[{a:"if",e:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform float u_halo_stars_blend ; uniform float u_halo_stars_height ; uniform float u_cam_water_depth ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",e:["SKY_STARS","WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","aX",";"]}]}}]},
{a:"txt",b:"GLSL_IN vec2 n ; GLSL_IN float aY ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},{a:"include",o:"color_util.glslf"},{a:"include",o:"halo_color.glslf"},{a:"txt",b:"void main ( ) { vec4 a_ = aZ ( ) ; vec3 aK = a_ . rgb ; float aG = a_ . a ; aQ ( aK ) ; aR ( aK , aG ) ; GLSL_OUT_FRAG_COLOR = vec4 ( aK , aG ) ; }".split(" ")}]};a["halo.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},
{a:"var",c:"SKY_STARS",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform PRECISION float u_halo_size ; uniform vec3 u_camera_eye ;".split(" ")},{a:"cond",d:[{a:"if",e:["STATIC_BATCH"],h:{a:"grp",d:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",
b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec2 a_halo_bb_vertex ; GLSL_IN float a_random_vals ; GLSL_OUT vec2 n ; GLSL_OUT float aY ;".split(" ")},{a:"cond",d:[{a:"if",e:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","aX",";"]}]}}]},{a:"txt",b:"void main ( ) { mat3 N = u_view_tsr ; mat3 T = u_model_tsr ; vec3 O = ae ( T , a_position ) ; n = a_halo_bb_vertex * 2.0 ; aY = a_random_vals ;".split(" ")},
{a:"cond",d:[{a:"if",e:["SKY_STARS"],h:{a:"grp",d:[{a:"txt",b:"mat3 bd = bc ( O , N ) ; mat3 be = N ; be [ 0 ] [ 0 ] = 0.0 ; be [ 0 ] [ 1 ] = 0.0 ; be [ 0 ] [ 2 ] = 0.0 ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"mat3 bd = bc ( O , N ) ;".split(" ")}]}}]},{a:"txt",b:"vec2 bf = a_halo_bb_vertex * 2.0 * u_halo_size ; vec3 bh = vec3 ( bf [ 0 ] , 0.0 , bf [ 1 ] ) ; vec3 bi = ae ( bd , bh ) ;".split(" ")},{a:"cond",d:[{a:"if",e:["SKY_STARS"],h:{a:"grp",d:[{a:"txt",b:"vec4 at = u_proj_matrix * vec4 ( ae ( be , bi ) , 1.0 ) ; at . z = 0.99999 * at . w ;".split(" ")},
{a:"cond",d:[{a:"if",e:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aX = vec4 ( bi , 1.0 ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 at = u_proj_matrix * vec4 ( ae ( N , bi ) , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:["gl_Position","=","at",";","}"]}]};a["line.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"ALPHA",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},
{a:"include",o:"color_util.glslf"},{a:"txt",b:"uniform vec4 u_diffuse_color ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec3 aK = u_diffuse_color . xyz ; float L = u_diffuse_color . a ; aQ ( aK ) ;".split(" ")},{a:"cond",d:[{a:"if",e:["ALPHA"],h:{a:"grp",d:[{a:"txt",b:"aR ( aK , L ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aK , L ) ; }".split(" ")}]};a["line.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"include",
o:"to_world.glslv"},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec3 a_direction ; uniform mat3 u_model_tsr ; uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform float u_height ; uniform float u_line_width ; void main ( ) { mat3 N = u_view_tsr ; mat3 T = u_model_tsr ; ak am = al ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , normalize ( a_direction ) , T ) ; vec4 bj = u_proj_matrix * vec4 ( ae ( N , am . O ) , 1.0 ) ; bj . xyz /= bj . w ; vec2 bk = ( u_proj_matrix * vec4 ( U ( N , am . Q ) , 0.0 ) ) . xy ; float bl = M_PI / 2.0 ; mat2 bm = mat2 ( cos ( bl ) , sin ( bl ) , - sin ( bl ) , cos ( bl ) ) ; bk = bm * normalize ( bk ) ; vec2 bn = ( u_line_width / u_height ) * vec2 ( u_proj_matrix [ 0 ] [ 0 ] / u_proj_matrix [ 1 ] [ 1 ] , 1.0 ) ; gl_Position = vec4 ( bj . xy + bk . xy * bn / 2.0 , bj . z , 1.0 ) ; gl_Position *= bj . w ; }".split(" ")}]};
a["main.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"SHADELESS",b:["0"]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"NORMAL_TEXCOORD",b:["0"]},{a:"var",c:"USE_VIEW_MATRIX",b:["0"]},{a:"var",c:"USE_VIEW_MATRIX_INVERSE",b:["0"]},{a:"var",c:"USE_MODEL_MATRIX",b:["0"]},{a:"var",c:"USE_MODEL_MATRIX_INVERSE",b:["0"]},{a:"var",c:"WATER_EFFECTS",
b:["0"]},{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"var",c:"TEXTURE_NORM_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"PARALLAX",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"ALPHA_CLIP",b:["0"]},{a:"var",c:"WETTABLE",b:["0"]},{a:"var",c:"NUM_VALUES",b:["0"]},{a:"var",c:"NUM_RGBS",b:["0"]},{a:"var",c:"WIND_BEND",b:["0"]},{a:"var",c:"DISABLE_FOG",
b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"NUM_LAMP_LIGHTS",b:["0"]},{a:"var",c:"NUM_LFACTORS",b:["0"]},{a:"var",c:"SSAO_ONLY",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"USE_REFRACTION",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",
c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"WATER_LEVEL",b:["0.0"]},{a:"var",c:"POISSON_DISK_NUM",b:["NO_SOFT_SHADOWS"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"include",o:"math.glslv"},{a:"cond",d:[{a:"if",e:["SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["CAUSTICS"],h:{a:"grp",d:[{a:"include",o:"caustics.glslf"}]}}]}]}}]},{a:"txt",b:["uniform","float","u_time",";"]},{a:"cond",d:[{a:"if",e:["USE_ENVIRONMENT_LIGHT",
"SKY_TEXTURE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",e:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{a:"txt",b:["uniform","float","u_environment_energy",";"]},{a:"cond",d:[{a:"if",e:["SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["NUM_LIGHTS",0,{a:"g_expr",i:2}],h:{a:"grp",
d:[{a:"txt",b:"uniform vec3 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec3 u_light_color_intensities [ NUM_LIGHTS ] ; uniform vec4 u_light_factors [ NUM_LFACTORS ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["CAUSTICS"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_sun_quaternion ; uniform vec3 u_sun_intensity ; uniform vec3 u_sun_direction ;".split(" ")}]}}]}]}}]},{a:"txt",b:["uniform","vec3","u_camera_eye_frag",";"]},{a:"cond",d:[{a:"if",e:["NORMAL_TEXCOORD",
"REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_NODE_GEOMETRY_VW","USE_VIEW_MATRIX",{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{a:"cond",d:[{a:"if",e:["USE_VIEW_MATRIX_INVERSE"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",e:["USE_MODEL_MATRIX"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"cond",d:[{a:"if",e:["USE_MODEL_MATRIX_INVERSE"],h:{a:"grp",d:[{a:"txt",
b:["uniform","mat3","u_model_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",e:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_color_density",";"]},{a:"cond",d:[{a:"if",e:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["PROCEDURAL_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_cube_fog",";"]}]}}]},{a:"cond",d:[{a:"if",e:["USE_FOG"],
h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",e:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_plane_reflection",";"]}]}},{a:"elif",e:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_cube_reflection",";"]}]}},{a:"elif",e:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_mirrormap",
";"]}]}}]},{a:"cond",d:[{a:"if",e:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_shadow_mask",";"]}]}},{a:"elif",e:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_pcf_blur_radii",";"]}]}}]},{a:"txt",b:"uniform vec4 u_csm_center_dists ; uniform PRECISION GLSL_SMPLR2D_SHDW u_shadow_map0 ;".split(" ")},
{a:"cond",d:[{a:"if",e:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map1",";"]}]}}]},{a:"cond",d:[{a:"if",e:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map2",";"]}]}}]},{a:"cond",d:[{a:"if",e:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",
d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map3",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",e:["REFRACTIVE","USE_NODE_B4W_REFRACTION",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_refractmap",";"]}]}}]},{a:"cond",d:[{a:"if",e:["USE_NODE_B4W_REFRACTION","USE_REFRACTION","REFRACTIVE","USE_REFRACTION_CORRECTION",{a:"logical_and_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]},{a:"txt",b:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ;".split(" ")},
{a:"cond",d:[{a:"if",e:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[]}},{a:"elif",e:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_mirror_factor",";"]}]}}]},{a:"cond",d:[{a:"if",e:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_refl_plane",";"]}]}}]},{a:"cond",d:[{a:"if",e:["USE_NODE_LAMP"],
h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ; uniform vec4 u_lamp_light_factors [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["USE_NODE_VALUE"],h:{a:"grp",d:[{a:"txt",b:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["USE_NODE_RGB"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",e:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{a:"txt",b:["GLSL_IN","vec3","c",";"]},{a:"cond",d:[{a:"if",e:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},"USE_NODE_TEX_COORD_NO",{a:"logical_or_expr",i:7}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN",
"vec3","e",";"]}]}}]},{a:"cond",d:[{a:"if",e:["NODES","DISABLE_FOG",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"PARALLAX",{a:"logical_and_expr",i:2},"SHADELESS",{a:"logic_negative_expr",i:1},"CAUSTICS","WATER_EFFECTS",{a:"logical_and_expr",i:3},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2},{a:"logical_or_expr",i:6}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","d",";"]}]}}]},
{a:"cond",d:[{a:"if",e:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"CALC_TBN_SPACE",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","f",";"]}]}}]},{a:"cond",d:[{a:"if",e:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","o",";"]}]}}]},{a:"cond",d:[{a:"if",e:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","j",";"]},{a:"cond",d:[{a:"if",e:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},
{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","k",";"]}]}}]},{a:"cond",d:[{a:"if",e:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","l",";"]}]}}]},{a:"cond",d:[{a:"if",e:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","m",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",e:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"SHADOW_USAGE",
"SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2},"REFRACTIVE","USE_NODE_B4W_REFRACTION",{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","h",";"]}]}}]},{a:"cond",d:[{a:"if",e:["REFRACTIVE","USE_NODE_B4W_REFRACTION",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","i",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"include",o:"nodes.glslf"},{a:"cond",d:[{a:"if",e:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",
o:"fog.glslf"}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",e:["NODES","DISABLE_FOG",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"PARALLAX",{a:"logical_and_expr",i:2},"SHADELESS",{a:"logic_negative_expr",i:1},"CAUSTICS","WATER_EFFECTS",{a:"logical_and_expr",i:3},{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:"float bo = length ( d ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"float bp = c . z - WATER_LEVEL ;".split(" ")}]}}]},
{a:"txt",b:"vec3 u = normalize ( u_camera_eye_frag - c ) ; vec3 A ; vec3 B ; vec3 C ; vec4 D ; float E ; mat3 F = mat3 ( 0.0 ) ; mat3 G = mat3 ( 0.0 ) ; mat3 H = mat3 ( 0.0 ) ; mat3 I = mat3 ( 0.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",e:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_NODE_GEOMETRY_VW","USE_VIEW_MATRIX",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["F","=","u_view_tsr_frag",";"]}]}}]},{a:"cond",d:[{a:"if",e:["USE_VIEW_MATRIX_INVERSE"],h:{a:"grp",d:[{a:"txt",b:["G",
"=","u_view_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",e:["USE_MODEL_MATRIX"],h:{a:"grp",d:[{a:"txt",b:["H","=","u_model_tsr",";"]}]}}]},{a:"cond",d:[{a:"if",e:["USE_MODEL_MATRIX_INVERSE"],h:{a:"grp",d:[{a:"txt",b:["I","=","u_model_tsr_inverse",";"]}]}}]},{a:"txt",b:"J ( u , F , G , H , I , A , B , C , D , E ) ; vec3 aK = A ; float L = E ; vec3 Q = C ; vec4 bq = D ;".split(" ")},{a:"cond",d:[{a:"if",e:["SHADELESS",{a:"logic_negative_expr",i:1},"WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",
d:[{a:"cond",d:[{a:"if",e:["WETTABLE"],h:{a:"grp",d:[{a:"txt",b:"aK = max ( aK - sqrt ( 0.01 * - min ( bp , 0.0 ) ) , 0.5 * aK ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["CAUSTICS"],h:{a:"grp",d:[{a:"txt",b:"bs ( aK , bp , u_time , bq , Q , u_sun_direction , u_sun_intensity , u_sun_quaternion , c , bo ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",e:["ALPHA"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["ALPHA_CLIP"],h:{a:"grp",d:[{a:"txt",b:"if ( L < 0.5 ) discard ; L = 1.0 ;".split(" ")}]}}]}]}},{a:"else",
h:{a:"grp",d:[{a:"txt",b:["L","=","1.0",";"]}]}}]},{a:"cond",d:[{a:"if",e:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"bt ( aK , bo , u , bp ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"bt ( aK , bo , u , 1.0 ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",e:["SSAO_ONLY","SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float bu = GLSL_TEXTURE_PROJ ( u_shadow_mask , h ) . a ; aK = vec3 ( bu ) ;".split(" ")}]}}]},
{a:"txt",b:["aQ","(","aK",")",";"]},{a:"cond",d:[{a:"if",e:["ALPHA","ALPHA_CLIP",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aR ( aK , L ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aK , L ) ; }".split(" ")}]};a["main.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},
{a:"var",c:"CALC_TBN",b:["0"]},{a:"var",c:"USE_INSTANCED_PARTCLS",b:["0"]},{a:"var",c:"TEXTURE_NORM_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"PARALLAX",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"SMAA_JITTER",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"AU_QUALIFIER",b:["GLSL_IN"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"WIND_BEND",b:["0"]},{a:"var",c:"BEND_CENTER_ONLY",b:["0"]},{a:"var",c:"BILLBOARD_PRES_GLOB_ORIENTATION",b:["0"]},{a:"var",
c:"BILLBOARD",b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",c:"SKINNED",b:["0"]},{a:"var",c:"FRAMES_BLENDING",b:["0"]},{a:"var",c:"VERTEX_ANIM",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"MAC_OS_SHADOW_HACK",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",
b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"TEXCOORD",b:["0"]},{a:"var",c:"VERTEX_COLOR",b:["0"]},{a:"var",c:"VERTEX_ANIM_MIX_NORMALS_FACTOR",b:["u_va_frame_factor"]},{a:"var",c:"MAX_BONES",b:["0"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"include",o:"scale_texcoord.glslv"},{a:"txt",b:["GLSL_IN","vec3","a_position",";"]},{a:"cond",d:[{a:"if",e:["NODES",{a:"logic_negative_expr",i:1},"USE_NODE_MATERIAL_BEGIN",
"USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},"USE_NODE_TEX_COORD_NO","CALC_TBN","TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},{a:"logical_or_expr",i:10}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_tbn_quat",";"]}]}}]},{a:"cond",d:[{a:"if",e:["USE_INSTANCED_PARTCLS"],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec4 a_part_ts ; GLSL_IN vec4 a_part_r ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["USE_TBN_SHADING"],
h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_shade_tangs",";"]}]}}]},{a:"cond",d:[{a:"if",e:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_influence",";"]}]}}]},{a:"cond",d:[{a:"if",e:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{a:"cond",d:[{a:"if",e:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["MAIN_BEND_COL"],
h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","a_bending_col_main",";"]},{a:"cond",d:[{a:"if",e:["DETAIL_BEND"],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},{a:"txt",b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{a:"cond",d:[{a:"if",e:["BEND_CENTER_ONLY"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN",
"vec3","a_emitter_center",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",e:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_position_next",";"]},{a:"cond",d:[{a:"if",e:["NODES",{a:"logic_negative_expr",i:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","USE_NODE_TEX_COORD_NO",{a:"logical_or_expr",i:7}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_tbn_quat_next",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",e:["NODES",{a:"logic_negative_expr",i:1}],h:{a:"grp",
d:[{a:"cond",d:[{a:"if",e:["TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","a_texcoord",";"]}]}}]},{a:"cond",d:[{a:"if",e:["VERTEX_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_color",";"]}]}}]}]}}]},{a:"txt",b:["GLSL_OUT","vec3","c",";"]},{a:"cond",d:[{a:"if",e:["NODES",{a:"logic_negative_expr",i:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},"USE_NODE_TEX_COORD_NO",
{a:"logical_or_expr",i:8}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","e",";"]}]}}]},{a:"cond",d:[{a:"if",e:["NODES","DISABLE_FOG",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"PARALLAX",{a:"logical_and_expr",i:2},"WATER_EFFECTS","CAUSTICS",{a:"logical_and_expr",i:2},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2},{a:"logical_or_expr",i:6}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT",
"vec4","d",";"]}]}}]},{a:"cond",d:[{a:"if",e:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"CALC_TBN_SPACE",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","f",";"]}]}}]},{a:"cond",d:[{a:"if",e:["NODES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","bv",";"]},{a:"cond",d:[{a:"if",e:["TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec2","n",";"]}]}}]},{a:"cond",d:[{a:"if",e:["VERTEX_COLOR","DYNAMIC_GRASS",{a:"logical_or_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","bw",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",e:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","j",";"]},{a:"cond",d:[{a:"if",e:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","k",";"]}]}}]},{a:"cond",d:[{a:"if",e:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT",
"vec4","l",";"]}]}}]},{a:"cond",d:[{a:"if",e:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","m",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",e:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2},"REFRACTIVE","USE_NODE_B4W_REFRACTION",{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","h",";"]}]}}]},{a:"cond",d:[{a:"if",e:["REFRACTIVE","NODES",{a:"logic_negative_expr",
i:1},"USE_NODE_B4W_REFRACTION",{a:"logical_or_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","float","i",";"]}]}}]},{a:"cond",d:[{a:"if",e:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","o",";"]}]}}]},{a:"cond",d:[{a:"if",e:["STATIC_BATCH"],h:{a:"grp",d:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"cond",
d:[{a:"if",e:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_view_refl_matrix",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},{a:"cond",d:[{a:"if",e:["NODES",{a:"logic_negative_expr",i:1},"BILLBOARD","DYNAMIC_GRASS",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{a:"cond",d:[{a:"if",e:["SMAA_JITTER"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec2","u_subpixel_jitter",
";"]}]}}]},{a:"cond",d:[{a:"if",e:["DYNAMIC_GRASS"],h:{a:"grp",d:[{a:"txt",b:"uniform PRECISION sampler2D u_grass_map_depth ; uniform sampler2D u_grass_map_color ; uniform vec4 u_camera_quat ; uniform vec3 u_grass_map_dim ; uniform float u_grass_size ; uniform float u_scale_threshold ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},
{a:"cond",d:[{a:"if",e:["FRAMES_BLENDING"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",e:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["BILLBOARD_JITTERED"],h:{a:"grp",d:[{a:"txt",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{a:"txt",b:"uniform vec3 u_wind ; uniform PRECISION float u_time ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",
e:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_va_frame_factor",";"]}]}}]},{a:"cond",d:[{a:"if",e:["NODES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_texture_scale",";"]}]}}]},{a:"cond",d:[{a:"if",e:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_normal_offset",";"]},{a:"cond",d:[{a:"if",e:["MAC_OS_SHADOW_HACK"],h:{a:"grp",d:[{a:"txt",b:"uniform mat3 u_v_light_tsr [ NUM_CAST_LAMPS ] ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_v_light_ts [ NUM_CAST_LAMPS ] ; uniform vec4 u_v_light_r [ NUM_CAST_LAMPS ] ;".split(" ")}]}}]},{a:"txt",b:["uniform","mat4","u_p_light_matrix0",";"]},{a:"cond",d:[{a:"if",e:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_p_light_matrix1",";"]}]}}]},{a:"cond",d:[{a:"if",e:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:["uniform","mat4","u_p_light_matrix2",";"]}]}}]},{a:"cond",d:[{a:"if",e:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_p_light_matrix3",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",e:["REFRACTIVE","USE_NODE_B4W_REFRACTION",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]},{a:"include",o:"dynamic_grass.glslv"},{a:"include",o:"shadow.glslv"},{a:"include",o:"skin.glslv"},
{a:"include",o:"wind_bending.glslv"},{a:"cond",d:[{a:"if",e:["NODES"],h:{a:"grp",d:[{a:"include",o:"nodes.glslv"}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",e:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["mat4","bx","=","u_view_refl_matrix",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"mat4 bx = mat4 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:["mat3","N","=","u_view_tsr",";"]},{a:"cond",d:[{a:"if",e:["USE_INSTANCED_PARTCLS"],h:{a:"grp",d:[{a:"txt",
b:"mat3 T = mat3 ( a_part_ts [ 0 ] , a_part_ts [ 1 ] , a_part_ts [ 2 ] , a_part_ts [ 3 ] , a_part_r [ 0 ] , a_part_r [ 1 ] , a_part_r [ 2 ] , a_part_r [ 3 ] , 1.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",e:["STATIC_BATCH",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"T = aS ( u_model_tsr , T ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["mat3","T","=","u_model_tsr",";"]}]}}]},{a:"txt",b:["vec3","O","=","a_position",";"]},{a:"cond",d:[{a:"if",e:["CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN",
"USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},"NODES",{a:"logic_negative_expr",i:1},"USE_TBN_SHADING","CALC_TBN",{a:"logical_and_expr",i:2},{a:"logical_or_expr",i:8}],h:{a:"grp",d:[{a:"txt",b:"vec3 by = P ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",
{a:"logical_and_expr",i:3},"NODES",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:7}],h:{a:"grp",d:[{a:"txt",b:["vec3","Q","=","by",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Q = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["CALC_TBN_SPACE","NODES",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_UV_ORCO",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 R = P ( a_tbn_quat , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 S = sign ( a_tbn_quat [ 3 ] ) * cross ( Q , R ) ;".split(" ")}]}},
{a:"elif",e:["NODES",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 bz = ae ( T , O ) ; vec3 V = normalize ( U ( T , by ) ) ; vec3 u = bz - u_camera_eye ; vec3 S = cross ( u , V ) ; vec3 R = cross ( V , S ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 R = vec3 ( 0.0 ) ; vec3 S = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",
e:["CALC_TBN"],h:{a:"grp",d:[{a:"txt",b:"vec3 V = normalize ( U ( T , by ) ) ; vec3 W = cross ( vec3 ( 0.0 , 0.0 , 1.0 ) , V ) ; vec3 X = cross ( V , W ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec3","X","=","a_shade_tangs",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 X = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:"O = mix ( O , a_position_next , u_va_frame_factor ) ;".split(" ")},{a:"cond",d:[{a:"if",e:["NODES",{a:"logic_negative_expr",
i:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_NORMAL_MAP","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},{a:"logical_or_expr",i:7}],h:{a:"grp",d:[{a:"txt",b:"vec3 bA = P ( a_tbn_quat_next , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["NODES",{a:"logic_negative_expr",i:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_NORMAL_MAP","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE",{a:"logical_or_expr",i:6}],h:{a:"grp",d:[{a:"txt",
b:"Q = mix ( Q , bA , VERTEX_ANIM_MIX_NORMALS_FACTOR ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 Z = P ( a_tbn_quat_next , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 _ = sign ( a_tbn_quat_next [ 3 ] ) * cross ( bA , Z ) ; R = mix ( R , Z , u_va_frame_factor ) ; S = mix ( S , _ , u_va_frame_factor ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",e:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:"ac ( O , R , S , Q ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",e:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["vec3","ad","=","au_center_pos",";"]}]}},{a:"elif",e:["DYNAMIC_GRASS","USE_INSTANCED_PARTCLS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 ad = a_part_ts . xyz ; O = ae ( T , O ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 ad = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",
e:["DYNAMIC_GRASS"],h:{a:"grp",d:[{a:"txt",b:"ak am = aT ( O , R , X , S , Q , ad , u_grass_map_depth , u_grass_map_color , u_grass_map_dim , u_grass_size , u_camera_eye , u_camera_quat , N ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["BILLBOARD"],h:{a:"grp",d:[{a:"txt",b:"vec3 af = ae ( T , ad ) ;".split(" ")},{a:"cond",d:[{a:"if",e:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"O = ( bx * vec4 ( O , 1.0 ) ) . xyz ; ad = ( bx * vec4 ( ad , 1.0 ) ) . xyz ; af = ( bx * vec4 ( af , 1.0 ) ) . xyz ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",e:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2},"USE_INSTANCED_PARTCLS",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"T = ah ( u_camera_eye , af , N , T ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"T = ai ( u_camera_eye , af , N ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 aU = af ; T = aj ( u_wind , u_time , u_jitter_amp , u_jitter_freq , aU , T ) ;".split(" ")}]}}]},
{a:"txt",b:"ak am = al ( O - ad , ad , R , X , S , Q , T ) ; am . ad = af ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"ak am = al ( O , ad , R , X , S , Q , T ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",e:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"CALC_TBN_SPACE",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float aq = ( dot ( cross ( am . Q , am . R ) , am . S ) < 0.0 ) ? - 1.0 : 1.0 ; f = vec4 ( am . R , aq ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["USE_TBN_SHADING"],
h:{a:"grp",d:[{a:"txt",b:"o = am . as ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["WIND_BEND"],h:{a:"grp",d:[{a:"txt",b:"an ( am . O , am . ad , Q , bx ) ;".split(" ")}]}}]},{a:"txt",b:"c = am . O ;".split(" ")},{a:"cond",d:[{a:"if",e:["NODES",{a:"logic_negative_expr",i:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},{a:"logical_or_expr",i:7}],h:{a:"grp",d:[{a:"txt",b:"e = am . Q ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",e:["NODES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"bv = u_camera_eye - am . O ;".split(" ")},{a:"cond",d:[{a:"if",e:["TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:"n = ap ( a_texcoord , u_texture_scale ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["DYNAMIC_GRASS"],h:{a:"grp",d:[{a:"txt",b:"bw = am . aK ;".split(" ")}]}},{a:"elif",e:["VERTEX_COLOR"],h:{a:"grp",d:[{a:"txt",b:["bw","=","a_color",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",e:["REFLECTION_PASS","REFL_PASS_PLANE",
{a:"equal_expr",i:2},"BILLBOARD",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 bB = bx * vec4 ( am . O , 1.0 ) ; bB . xyz = ae ( N , bB . xyz ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 bB = vec4 ( ae ( N , am . O ) , 1.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["NODES","DISABLE_FOG",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"PARALLAX",{a:"logical_and_expr",i:2},"WATER_EFFECTS","CAUSTICS",
{a:"logical_and_expr",i:2},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2},{a:"logical_or_expr",i:6}],h:{a:"grp",d:[{a:"txt",b:["d","=","bB",";"]}]}}]},{a:"txt",b:"vec4 at = u_proj_matrix * bB ;".split(" ")},{a:"cond",d:[{a:"if",e:["SMAA_JITTER"],h:{a:"grp",d:[{a:"txt",b:"at . xy += u_subpixel_jitter * at . w ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",
{a:"equal_expr",i:2},"REFRACTIVE","USE_NODE_B4W_REFRACTION",{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:"h = bC ( at ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"bD ( am . O , am . Q ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["REFRACTIVE","NODES",{a:"logic_negative_expr",i:1},"USE_NODE_B4W_REFRACTION",{a:"logical_or_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"i = - bB . z / u_view_max_depth ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",e:["NODES"],h:{a:"grp",d:[{a:"txt",b:["J","(",")",";"]}]}}]},{a:"txt",b:["gl_Position","=","at",";","}"]}]};a["main_stack.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"TEXTURE_NORM_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"TEXTURE_SPEC_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"TEXTURE_COLOR0_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"TEXTURE_COLOR1_CO",b:["TEXTURE_COORDS_NONE"]},
{a:"var",c:"PARALLAX",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"TEXTURE_SPEC",b:["0"]},{a:"var",c:"ALPHA_AS_SPEC",b:["0"]},{a:"var",c:"TEXTURE_STENCIL_ALPHA_MASK",b:["0"]},{a:"var",c:"TEXTURE_STENCIL_ALPHA_MASK_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"NORMAL_TEXCOORD",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"var",c:"DOUBLE_SIDED_LIGHTING",b:["0"]},{a:"var",c:"SHADELESS",b:["0"]},{a:"var",c:"TEXCOORD",b:["0"]},{a:"var",c:"VERTEX_COLOR",
b:["0"]},{a:"var",c:"WETTABLE",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"NUM_LFACTORS",b:["0"]},{a:"var",c:"INVERT_FRONTFACING",b:["0"]},{a:"var",c:"WATER_LEVEL",b:["0.0"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"var",c:"TEXTURE_BLEND_TYPE",b:["TEXTURE_BLEND_TYPE_MIX"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",
c:"ALPHA",b:["0"]},{a:"var",c:"ALPHA_CLIP",b:["0"]},{a:"var",c:"PARALLAX_LOD_DIST",b:["5.0"]},{a:"var",c:"PARALLAX_STEPS",b:["5.0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",c:"POISSON_DISK_NUM",b:["NO_SOFT_SHADOWS"]},{a:"var",c:"SSAO_ONLY",b:["0"]},{a:"include",
o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"include",o:"math.glslv"},{a:"cond",d:[{a:"if",e:["SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["CAUSTICS"],h:{a:"grp",d:[{a:"include",o:"caustics.glslf"}]}}]}]}}]},{a:"txt",b:["uniform","float","u_time",";"]},{a:"cond",d:[{a:"if",e:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},
{a:"elif",e:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{a:"txt",b:["uniform","float","u_environment_energy",";"]},{a:"cond",d:[{a:"if",e:["SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["NUM_LIGHTS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec3 u_light_color_intensities [ NUM_LIGHTS ] ; uniform vec4 u_light_factors [ NUM_LFACTORS ] ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",e:["CAUSTICS"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_sun_quaternion ; uniform vec3 u_sun_intensity ; uniform vec3 u_sun_direction ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",e:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{a:"cond",d:[{a:"if",e:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_color_density",
";"]},{a:"cond",d:[{a:"if",e:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["PROCEDURAL_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_cube_fog",";"]}]}}]},{a:"cond",d:[{a:"if",e:["USE_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",e:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:["uniform","sampler2D","u_colormap0",";"]}]}}]},{a:"cond",d:[{a:"if",e:["TEXTURE_SPEC","ALPHA_AS_SPEC",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_specmap0",";"]}]}}]},{a:"cond",d:[{a:"if",e:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_normalmap0",";"]}]}}]},{a:"cond",d:[{a:"if",e:["TEXTURE_STENCIL_ALPHA_MASK"],h:{a:"grp",d:[{a:"txt",b:"uniform sampler2D u_colormap1 ; uniform sampler2D u_stencil0 ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",e:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_plane_reflection",";"]}]}},{a:"elif",e:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_cube_reflection",";"]}]}},{a:"elif",e:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{a:"cond",d:[{a:"if",e:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_shadow_mask",";"]}]}},{a:"elif",e:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_pcf_blur_radii",";"]}]}}]},{a:"txt",b:"uniform vec4 u_csm_center_dists ; uniform PRECISION GLSL_SMPLR2D_SHDW u_shadow_map0 ;".split(" ")},{a:"cond",d:[{a:"if",e:["CSM_SECTION1","NUM_CAST_LAMPS",
1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map1",";"]}]}}]},{a:"cond",d:[{a:"if",e:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map2",";"]}]}}]},{a:"cond",d:[{a:"if",e:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW",
"u_shadow_map3",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",e:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_refractmap",";"]}]}}]},{a:"cond",d:[{a:"if",e:["REFRACTIVE","USE_REFRACTION_CORRECTION",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]},{a:"txt",b:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ; uniform float u_specular_alpha ;".split(" ")},{a:"cond",d:[{a:"if",e:["REFLECTION_TYPE",
"REFL_PLANE",{a:"equal_expr",i:2},"REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_reflect_factor",";"]}]}},{a:"elif",e:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_mirror_factor",";"]}]}}]},{a:"cond",d:[{a:"if",e:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_refl_plane",";"]}]}}]},{a:"txt",b:"uniform vec4 u_diffuse_color ; uniform vec2 u_diffuse_params ; uniform float u_diffuse_intensity ;".split(" ")},
{a:"cond",d:[{a:"if",e:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_normal_factor",";"]}]}}]},{a:"cond",d:[{a:"if",e:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform float u_diffuse_color_factor ; uniform float u_alpha_factor ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["TEXTURE_SPEC"],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_specular_color_factor",";"]}]}}]},{a:"txt",b:"uniform vec3 u_specular_color ; uniform vec3 u_specular_params ;".split(" ")},
{a:"cond",d:[{a:"if",e:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"PARALLAX",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_parallax_scale",";"]}]}}]},{a:"cond",d:[{a:"if",e:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_refr_bump",";"]}]}}]},{a:"txt",b:"GLSL_IN vec3 c ; GLSL_IN vec3 e ;".split(" ")},{a:"cond",d:[{a:"if",e:["DISABLE_FOG",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},
"PARALLAX",{a:"logical_and_expr",i:2},"SHADELESS",{a:"logic_negative_expr",i:1},"CAUSTICS",{a:"logical_and_expr",i:2},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2},{a:"logical_or_expr",i:5}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","d",";"]}]}}]},{a:"cond",d:[{a:"if",e:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"CALC_TBN_SPACE",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","f",
";"]}]}}]},{a:"txt",b:["GLSL_IN","vec3","bv",";"]},{a:"cond",d:[{a:"if",e:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","o",";"]}]}}]},{a:"cond",d:[{a:"if",e:["TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","n",";"]}]}}]},{a:"cond",d:[{a:"if",e:["VERTEX_COLOR","DYNAMIC_GRASS",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","bw",";"]}]}}]},{a:"cond",d:[{a:"if",e:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN",
"vec4","j",";"]},{a:"cond",d:[{a:"if",e:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","k",";"]}]}}]},{a:"cond",d:[{a:"if",e:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","l",";"]}]}}]},{a:"cond",d:[{a:"if",e:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","m",";"]}]}}]}]}}]},
{a:"cond",d:[{a:"if",e:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2},"REFRACTIVE",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","h",";"]}]}}]},{a:"cond",d:[{a:"if",e:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","i",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"cond",d:[{a:"if",e:["SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"shadow.glslf"}]}}]},
{a:"include",o:"mirror.glslf"},{a:"cond",d:[{a:"if",e:["REFRACTIVE"],h:{a:"grp",d:[{a:"include",o:"refraction.glslf"}]}}]},{a:"include",o:"environment.glslf"},{a:"cond",d:[{a:"if",e:["SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"lighting_nodes.glslf"}]}}]},{a:"cond",d:[{a:"if",e:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"fog.glslf"}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",e:["DISABLE_FOG",{a:"logic_negative_expr",
i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"PARALLAX",{a:"logical_and_expr",i:2},"SHADELESS",{a:"logic_negative_expr",i:1},"CAUSTICS","WATER_EFFECTS",{a:"logical_and_expr",i:3},{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"float bo = length ( d ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"float bp = c . z - WATER_LEVEL ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:["vec2","bE","=","n",
";"]}]}}]},{a:"txt",b:"vec3 bF = normalize ( e ) ;".split(" ")},{a:"cond",d:[{a:"if",e:["DOUBLE_SIDED_LIGHTING"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["INVERT_FRONTFACING"],h:{a:"grp",d:[{a:"txt",b:["if","(","!","gl_FrontFacing",")"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["if","(","gl_FrontFacing",")"]}]}}]},{a:"txt",b:"bF = bF ; else bF = - bF ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 S = cross ( bF , f . xyz ) * f . w ; S = normalize ( S ) ; vec3 R = cross ( S , bF ) * f . w ; mat3 bG = mat3 ( R , S , bF ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",e:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["mat3","N","=","u_view_tsr_frag",";"]}]}}]},{a:"cond",d:[{a:"if",e:["NORMAL_TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:"vec2 bH = normalize ( U ( N , e ) ) . st ; bH = bH * vec2 ( 0.495 ) + vec2 ( 0.5 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"PARALLAX",{a:"logical_and_expr",i:2}],
h:{a:"grp",d:[{a:"txt",b:"if ( bo < PARALLAX_LOD_DIST ) { float bI = clamp ( 0.5 * ( PARALLAX_LOD_DIST - bo ) , 0.0 , 1.0 ) ; float bJ = u_parallax_scale * bI ; vec3 bK = normalize ( bv * bG ) ; float bL = 1.0 / PARALLAX_STEPS ; vec2 bM = bK . xy * bJ / ( PARALLAX_STEPS * bK . z ) ; float bN = 1.0 ; float bO ;".split(" ")},{a:"cond",d:[{a:"if",e:["TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["vec2","bP","=","bH",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",
b:["vec2","bP","=","bE",";"]}]}}]},{a:"txt",b:"bO = GLSL_TEXTURE ( u_normalmap0 , bP ) . a ; for ( float bQ = 1.0 ; bQ <= PARALLAX_STEPS ; bQ ++ ) { if ( bO < bN ) { bN -= bL ; bP -= bM ; bO = GLSL_TEXTURE ( u_normalmap0 , bP ) . a ; } } vec2 bR = bP + bM ; float bS = GLSL_TEXTURE ( u_normalmap0 , bR ) . a - ( bN + bL ) ; float bT = bO - bN ; float bU = bT / ( bT - bS ) ; bP = bU * bR + ( 1.0 - bU ) * bP ;".split(" ")},{a:"cond",d:[{a:"if",e:["TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",
i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:"bE += bP - bH ;".split(" ")}]}}]},{a:"txt",b:["bH","=","bP",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["NORMAL_TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:"bH += bP - bE ;".split(" ")}]}}]},{a:"txt",b:["bE","=","bP",";"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"cond",d:[{a:"if",e:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["vec4","bV",";"]},{a:"cond",d:[{a:"if",e:["TEXTURE_NORM_CO",
"TEXTURE_COORDS_NORMAL",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"bV = GLSL_TEXTURE ( u_normalmap0 , bH ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"bV = GLSL_TEXTURE ( u_normalmap0 , bE ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 bW = bV . rgb - 0.5 ; bW = mix ( vec3 ( 0.0 , 0.0 , 1.0 ) , bW , u_normal_factor ) ; vec3 Q = bG * bW ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec3","Q","=","bF",";"]}]}}]},{a:"txt",b:"Q = normalize ( Q ) ;".split(" ")},{a:"cond",d:[{a:"if",e:["NORMAL_TEXCOORD"],
h:{a:"grp",d:[{a:"txt",b:"bH = normalize ( U ( N , Q ) ) . st ; bH = bH * vec2 ( 0.495 ) + vec2 ( 0.5 ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 u = normalize ( bv ) ;".split(" ")},{a:"cond",d:[{a:"if",e:["VERTEX_COLOR","DYNAMIC_GRASS",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 bX = bw ; bY ( bX ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["VERTEX_COLOR","DYNAMIC_GRASS",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 bZ = vec4 ( bX , 1.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",
d:[{a:"txt",b:["vec4","bZ","=","u_diffuse_color",";"]}]}}]},{a:"txt",b:["float","b_","=","1.0",";"]},{a:"cond",d:[{a:"if",e:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 ca = GLSL_TEXTURE ( u_colormap0 , bH ) ;".split(" ")}]}},{a:"elif",e:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_UV_ORCO",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 ca = GLSL_TEXTURE ( u_colormap0 , bE ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NONE",
{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"bY ( ca . rgb ) ;".split(" ")},{a:"cond",d:[{a:"if",e:["TEXTURE_STENCIL_ALPHA_MASK"],h:{a:"grp",d:[{a:"txt",b:["vec4","cb",";"]},{a:"cond",d:[{a:"if",e:["TEXTURE_COLOR1_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"cb = GLSL_TEXTURE ( u_colormap1 , bH ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"cb = GLSL_TEXTURE ( u_colormap1 , bE ) ;".split(" ")}]}}]},{a:"txt",b:"bY ( cb . rgb ) ;".split(" ")},{a:"cond",
d:[{a:"if",e:["TEXTURE_STENCIL_ALPHA_MASK_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 cc = GLSL_TEXTURE ( u_stencil0 , bH ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 cc = GLSL_TEXTURE ( u_stencil0 , bE ) ;".split(" ")}]}}]},{a:"txt",b:"ca = mix ( ca , cb , cc . r ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"bZ . rgb = mix ( bZ . rgb , ca . rgb , u_diffuse_color_factor ) ; float M = u_alpha_factor * ca . a ; M += ( 1.0 - step ( 0.0 , M ) ) ; bZ . a = mix ( M , 1.0 , u_diffuse_color . a ) ; b_ = ca . a ;".split(" ")}]}},
{a:"elif",e:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"bZ . rgb *= mix ( vec3 ( 1.0 ) , ca . rgb , u_diffuse_color_factor ) ; bZ . a = ca . a ; b_ = ca . a ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",e:["SHADELESS"],h:{a:"grp",d:[{a:"txt",b:"vec3 aK = bZ . rgb ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 cd = u_diffuse_intensity * bZ . rgb ; vec3 cf = u_environment_energy * ce ( Q ) ; vec3 cg = u_ambient * cf ; vec4 bq = ch ( cd ) ; vec3 ci = u_emit * bZ . rgb ; vec3 cj = u_specular_color ;".split(" ")},
{a:"cond",d:[{a:"if",e:["TEXTURE_SPEC"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["ALPHA_AS_SPEC"],h:{a:"grp",d:[{a:"txt",b:"vec3 ck = vec3 ( b_ ) ;".split(" ")}]}},{a:"elif",e:["TEXTURE_SPEC_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 ck = GLSL_TEXTURE ( u_specmap0 , bH ) . rgb ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 ck = GLSL_TEXTURE ( u_specmap0 , bE ) . rgb ;".split(" ")}]}}]},{a:"txt",b:"bY ( ck . rgb ) ; cj = mix ( cj , ck , u_specular_color_factor ) ;".split(" ")}]}}]},
{a:"txt",b:"float cl = u_specular_params [ 0 ] ; vec2 cm = vec2 ( u_specular_params [ 1 ] , u_specular_params [ 2 ] ) ; vec3 cn = cl * cj ; vec3 aK ; vec3 co ; cp ( ci , cg , cd , cn , c , Q , u , cm , u_diffuse_params , bq , 0.0 , vec4 ( 0.0 ) , aK , co ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"cq ( aK , u , Q , u_reflect_factor , N ) ;".split(" ")}]}},{a:"elif",e:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],
h:{a:"grp",d:[{a:"txt",b:"cq ( aK , u , Q , u_reflect_factor , mat3 ( 0.0 ) ) ;".split(" ")}]}},{a:"elif",e:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"cq ( aK , u , Q , u_mirror_factor , mat3 ( 0.0 ) ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["aK","+=","co",";"]}]}}]},{a:"txt",b:"float L = bZ . a ;".split(" ")},{a:"cond",d:[{a:"if",e:["SHADELESS",{a:"logic_negative_expr",i:1},"WATER_EFFECTS",
{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["WETTABLE"],h:{a:"grp",d:[{a:"txt",b:"aK = max ( aK - sqrt ( 0.01 * - min ( bp , 0.0 ) ) , 0.5 * aK ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["CAUSTICS"],h:{a:"grp",d:[{a:"txt",b:"bs ( aK , bp , u_time , bq , Q , u_sun_direction , u_sun_intensity , u_sun_quaternion , c , bo ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",e:["ALPHA"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["ALPHA_CLIP"],h:{a:"grp",d:[{a:"txt",b:"if ( L < 0.5 ) discard ; L = 1.0 ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"float t = max ( max ( co . r , co . g ) , co . b ) * u_specular_alpha ; L = bZ . a * ( 1.0 - t ) + t ;".split(" ")}]}}]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["L","=","1.0",";"]}]}}]},{a:"cond",d:[{a:"if",e:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:"vec2 cr = - ( U ( N , Q ) ) . xy ; aK = mix ( cs ( h , cr * u_refr_bump ) , aK , L ) ; L = 1.0 ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",
e:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"bt ( aK , bo , u , bp ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"bt ( aK , bo , u , 1.0 ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",e:["SSAO_ONLY","SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float bu = GLSL_TEXTURE_PROJ ( u_shadow_mask , h ) . a ; aK = vec3 ( bu ) ;".split(" ")}]}}]},
{a:"txt",b:["aQ","(","aK",")",";"]},{a:"cond",d:[{a:"if",e:["ALPHA","ALPHA_CLIP",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aR ( aK , L ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aK , L ) ; }".split(" ")}]};a["particle_system.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"NUM_VALUES",b:["0"]},{a:"var",c:"NUM_RGBS",b:["0"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"NUM_LAMP_LIGHTS",b:["0"]},{a:"var",c:"NUM_LFACTORS",
b:["0"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"NORMAL_TEXCOORD",b:["0"]},{a:"var",c:"USE_VIEW_MATRIX",b:["0"]},{a:"var",c:"USE_VIEW_MATRIX_INVERSE",b:["0"]},{a:"var",c:"USE_MODEL_MATRIX",b:["0"]},{a:"var",c:"USE_MODEL_MATRIX_INVERSE",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"ALPHA_CLIP",b:["0"]},{a:"var",c:"SOFT_STRENGTH",b:["0.25"]},{a:"var",c:"SOFT_PARTICLES",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"DISABLE_FOG",
b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"TEXTURE_NORM_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"cond",d:[{a:"if",e:["SOFT_PARTICLES",
"NODES",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"pack.glslf"}]}}]},{a:"txt",b:["uniform","float","u_environment_energy",";"]},{a:"cond",d:[{a:"if",e:["NUM_LIGHTS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec3 u_light_color_intensities [ NUM_LIGHTS ] ; uniform vec4 u_light_factors [ NUM_LFACTORS ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["DISABLE_FOG",{a:"logic_negative_expr",
i:1}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_color_density",";"]},{a:"cond",d:[{a:"if",e:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["PROCEDURAL_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_cube_fog",";"]}]}}]},{a:"cond",d:[{a:"if",e:["USE_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",e:["USE_ENVIRONMENT_LIGHT",
"SKY_TEXTURE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",e:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{a:"txt",b:"uniform float u_emit ; uniform float u_ambient ; uniform float u_time ; uniform vec3 u_camera_eye_frag ;".split(" ")},{a:"cond",d:[{a:"if",e:["USE_NODE_LAMP"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ; uniform vec4 u_lamp_light_factors [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",e:["USE_NODE_VALUE"],h:{a:"grp",d:[{a:"txt",b:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["USE_NODE_RGB"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_NODE_GEOMETRY_VW","USE_VIEW_MATRIX",{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{a:"cond",d:[{a:"if",
e:["USE_VIEW_MATRIX_INVERSE"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",e:["USE_MODEL_MATRIX"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"cond",d:[{a:"if",e:["USE_MODEL_MATRIX_INVERSE"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",e:["SOFT_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:"uniform PRECISION sampler2D u_scene_depth ; uniform float u_view_max_depth ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",e:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{a:"cond",d:[{a:"if",e:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"CALC_TBN_SPACE","USE_TBN_SHADING",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","f",";"]}]}}]},{a:"cond",d:[{a:"if",e:["SOFT_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","h",";"]}]}}]},{a:"cond",
d:[{a:"if",e:["TEXTURE_COLOR","USE_NODE_TEX_COORD_UV","USE_NODE_UV_MERGED","USE_NODE_UVMAP","USE_NODE_GEOMETRY_UV","USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",i:7}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","n",";"]}]}}]},{a:"txt",b:["GLSL_IN","vec3","c",";"]},{a:"cond",d:[{a:"if",e:["SOFT_PARTICLES","DISABLE_FOG",{a:"logic_negative_expr",i:1},"NODES",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","d",";"]}]}}]},{a:"txt",b:"GLSL_IN vec3 e ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},
{a:"cond",d:[{a:"if",e:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"fog.glslf"}]}}]},{a:"include",o:"math.glslv"},{a:"include",o:"particles_nodes.glslf"},{a:"txt",b:"void main ( ) { vec3 u = normalize ( u_camera_eye_frag - c ) ; vec3 A ; vec3 B ; vec3 C ; vec4 D ; float E ; mat3 F = mat3 ( 0.0 ) ; mat3 G = mat3 ( 0.0 ) ; mat3 H = mat3 ( 0.0 ) ; mat3 I = mat3 ( 0.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",e:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_NODE_GEOMETRY_VW",
{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["F","=","u_view_tsr_frag",";"]}]}}]},{a:"cond",d:[{a:"if",e:["USE_VIEW_MATRIX_INVERSE"],h:{a:"grp",d:[{a:"txt",b:["G","=","u_view_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",e:["USE_MODEL_MATRIX"],h:{a:"grp",d:[{a:"txt",b:["H","=","u_model_tsr",";"]}]}}]},{a:"cond",d:[{a:"if",e:["USE_MODEL_MATRIX_INVERSE"],h:{a:"grp",d:[{a:"txt",b:["I","=","u_model_tsr_inverse",";"]}]}}]},{a:"txt",b:"J ( u , F , G , H , I , A , B , C , D , E ) ; vec3 aK = A ; float L = E ;".split(" ")},
{a:"cond",d:[{a:"if",e:["ALPHA"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["ALPHA_CLIP"],h:{a:"grp",d:[{a:"txt",b:"if ( L < 0.5 ) discard ; L = 1.0 ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["L","=","1.0",";"]}]}}]},{a:"cond",d:[{a:"if",e:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"bt ( aK , length ( d ) , u , 1.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["SOFT_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:"float ct = - d . z / u_view_max_depth ; vec4 cu = GLSL_TEXTURE_PROJ ( u_scene_depth , h ) ; float cw = cv ( cu ) ; float cx = cw - ct ; float cy = u_view_max_depth / SOFT_STRENGTH * cx ; L = L * min ( cy , 1.0 ) ;".split(" ")}]}}]},
{a:"txt",b:["aQ","(","aK",")",";"]},{a:"cond",d:[{a:"if",e:["ALPHA","ALPHA_CLIP",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aR ( aK , L ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aK , L ) ; }".split(" ")}]};a["particle_system.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"BILLBOARD_ALIGN",b:["BILLBOARD_ALIGN_VIEW"]},{a:"var",c:"TEXTURE_NORM_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"USE_TBN_SHADING",
b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"HALO_PARTICLES",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"PARTICLES_SHADELESS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"SOFT_PARTICLES",b:["0"]},{a:"var",c:"COLOR_RAMP_LENGTH",b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"WORLD_SPACE",b:["0"]},{a:"var",c:"USE_COLOR_RAMP",b:["0"]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"WIND_BEND",b:["0"]},{a:"var",c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"DETAIL_BEND",
b:["0"]},{a:"include",o:"std.glsl"},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec4 a_tbn_quat ; GLSL_IN vec3 a_p_data ; GLSL_IN vec4 a_p_vels ; GLSL_IN vec2 a_p_bb_vertex ;".split(" ")},{a:"cond",d:[{a:"if",e:["NODES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["HALO_PARTICLES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","float","cz",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec3","bw",";"]}]}}]},{a:"cond",d:[{a:"if",e:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",
{a:"non_equal_expr",i:2},"CALC_TBN_SPACE","USE_TBN_SHADING",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","f",";"]}]}}]},{a:"cond",d:[{a:"if",e:["TEXTURE_COLOR","HALO_PARTICLES","USE_NODE_TEX_COORD_UV","USE_NODE_UV_MERGED","USE_NODE_UVMAP","USE_NODE_GEOMETRY_UV","USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",i:8}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec2","n",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec3","c",";"]},{a:"cond",d:[{a:"if",e:["PARTICLES_SHADELESS",
{a:"logic_negative_expr",i:1},"DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","bv",";"]}]}}]},{a:"cond",d:[{a:"if",e:["SOFT_PARTICLES","DISABLE_FOG",{a:"logic_negative_expr",i:1},"NODES",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","d",";"]}]}}]},{a:"cond",d:[{a:"if",e:["SOFT_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","h",";"]}]}}]},{a:"cond",d:[{a:"if",e:["NODES"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT",
"vec3","e",";"]}]}}]},{a:"cond",d:[{a:"if",e:["HALO_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","float","aY",";"]}]}}]},{a:"cond",d:[{a:"if",e:["COLOR_RAMP_LENGTH",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_p_color_ramp [ COLOR_RAMP_LENGTH ] ;".split(" ")}]}}]},{a:"txt",b:"uniform float u_p_time ; uniform float u_p_length ; uniform int u_p_cyclic ; uniform float u_p_fade_in ; uniform float u_p_fade_out ; uniform float u_p_nfactor ; uniform float u_p_gravity ; uniform float u_p_mass ; uniform float u_p_wind_fac ; uniform float u_p_max_lifetime ; uniform float u_p_tilt ; uniform float u_p_tilt_rand ;".split(" ")},
{a:"cond",d:[{a:"if",e:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_view_refl_matrix",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform vec3 u_wind ; uniform float u_p_size ; uniform vec3 u_camera_eye ;".split(" ")},{a:"cond",d:[{a:"if",e:["WORLD_SPACE",{a:"logic_negative_expr",i:1},"NODES","HALO_PARTICLES",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"cond",
d:[{a:"if",e:["USE_COLOR_RAMP"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_color_ramp_tex",";"]}]}}]},{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"include",o:"particles.glslv"},{a:"cond",d:[{a:"if",e:["NODES"],h:{a:"grp",d:[{a:"include",o:"particles_nodes.glslv"}]}}]},{a:"txt",b:"float cC ( vec2 cA , vec2 cB ) { return ( atan ( cB . y , cB . x ) - atan ( cA . y , cA . x ) ) ; } void main ( ) {".split(" ")},{a:"cond",d:[{a:"if",e:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["mat4","bx","=","u_view_refl_matrix",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"mat4 bx = mat4 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"mat3 N = u_view_tsr ; cD pp ; pp = cE ( ) ; float cF ; mat3 bd = cG ( ) ;".split(" ")},{a:"cond",d:[{a:"if",e:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 cH = ( bx * vec4 ( pp . O , 1.0 ) ) . xyz ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 cH = pp . O ;".split(" ")}]}}]},
{a:"txt",b:"vec3 Q = P ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_VIEW ) { cF = pp . bl ; bd = bc ( cH , N ) ; } else if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_XY ) { cF = cC ( vec2 ( EPSILON , 1.0 ) , vec2 ( Q . x , - Q . y ) ) + pp . bl ; bd [ 0 ] = cH ; vec4 cJ = cI ( RIGHT_VECTOR , - M_PI / 2.0 ) ; bd = cK ( cJ , bd ) ; } else if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_YZ ) { cF = pp . bl ; bd [ 0 ] = cH ; vec4 cL = cI ( UP_VECTOR , M_PI / 2.0 ) ; bd = cK ( cL , bd ) ; } else if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_ZX ) { cF = pp . bl ; bd [ 0 ] = cH ; } vec3 bh = vec3 ( a_p_bb_vertex [ 0 ] * 2.0 * pp . cM * u_p_size , 0.0 , a_p_bb_vertex [ 1 ] * 2.0 * pp . cM * u_p_size ) ; float cN = a_p_data [ 2 ] ; float cO = u_p_tilt * u_p_tilt_rand * ( 2.0 * cN - 1.0 ) ; float cP = ( cO + u_p_tilt ) * M_PI ; vec4 cQ = cI ( TOWARD_VECTOR , cP + cF ) ; vec3 bi = ae ( bd , P ( cQ , bh ) ) ; vec4 bB = vec4 ( ae ( N , bi ) , 1.0 ) ; vec4 at = u_proj_matrix * bB ;".split(" ")},
{a:"cond",d:[{a:"if",e:["HALO_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:["aY","=","cN",";"]}]}}]},{a:"cond",d:[{a:"if",e:["NODES"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["CALC_TBN_SPACE","NODES",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_UV_ORCO",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2},"USE_TBN_SHADING",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"vec3 R = P ( a_tbn_quat , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 S = sign ( a_tbn_quat [ 3 ] ) * cross ( Q , R ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 R = vec3 ( 0.0 ) ; vec3 S = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"mat3 cR = cG ( ) ; cQ = cI ( TOWARD_VECTOR , cF ) ; cR = cK ( cQ , cR ) ; ak am = al ( vec3 ( 0.0 ) , vec3 ( 0.0 ) , R , vec3 ( 0.0 ) , S , vec3 ( 0.0 ) , aS ( bd , cR ) ) ;".split(" ")},{a:"cond",d:[{a:"if",e:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"CALC_TBN_SPACE","USE_TBN_SHADING",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"float aq = ( dot ( cross ( Q , am . R ) , am . S ) < 0.0 ) ? - 1.0 : 1.0 ; f = vec4 ( am . R , aq ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",e:["NODES",{a:"logic_negative_expr",i:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},{a:"logical_or_expr",i:6}],h:{a:"grp",d:[{a:"txt",b:["e","=","Q",";"]}]}}]},{a:"txt",b:"J ( pp . O , pp . cS , pp . cT , pp . cU , pp . cM , a_p_bb_vertex , a_p_data [ 0 ] ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:"n = a_p_bb_vertex + 0.5 ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",e:["HALO_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:"n = a_p_bb_vertex * 2.0 ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"cz = pp . L ;".split(" ")}]}}]},{a:"txt",b:"bw = pp . aK ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["SOFT_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:"float au = at . x ; float av = at . y ; float aw = at . w ; h . x = ( au + aw ) / 2.0 ; h . y = ( av + aw ) / 2.0 ; h . z = aw ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["SOFT_PARTICLES","DISABLE_FOG",{a:"logic_negative_expr",
i:1},"NODES",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["d","=","bB",";"]}]}}]},{a:"txt",b:"gl_Position = at ; c = bi ;".split(" ")},{a:"cond",d:[{a:"if",e:["PARTICLES_SHADELESS",{a:"logic_negative_expr",i:1},"DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"bv = u_camera_eye - bi ;".split(" ")}]}}]},{a:"txt",b:["}"]}]};a["particle_system_stack.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",
c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"NUM_LFACTORS",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"var",c:"TEXTURE_BLEND_TYPE",b:["TEXTURE_BLEND_TYPE_MIX"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"ALPHA_CLIP",b:["0"]},{a:"var",c:"SOFT_STRENGTH",b:["0.25"]},{a:"var",c:"SOFT_PARTICLES",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"HALO_PARTICLES",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},
{a:"var",c:"SKY_STARS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"PARTICLES_SHADELESS",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"cond",d:[{a:"if",e:["SOFT_PARTICLES","NODES",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"pack.glslf"}]}}]},{a:"cond",d:[{a:"if",e:["HALO_PARTICLES",{a:"logic_negative_expr",
i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_sampler",";"]}]}}]},{a:"txt",b:["uniform","float","u_environment_energy",";"]},{a:"cond",d:[{a:"if",e:["NUM_LIGHTS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec3 u_light_color_intensities [ NUM_LIGHTS ] ; uniform vec4 u_light_factors [ NUM_LFACTORS ] ;".split(" ")}]}}]},{a:"cond",
d:[{a:"if",e:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_diffuse_color_factor",";"]}]}}]},{a:"cond",d:[{a:"if",e:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",e:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{a:"txt",b:"uniform vec2 u_diffuse_params ; uniform float u_diffuse_intensity ; uniform float u_emit ; uniform float u_ambient ; uniform vec3 u_specular_color ; uniform vec3 u_specular_params ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"uniform float u_halo_size ; uniform vec3 u_halo_rings_color ; uniform float u_halo_hardness ; uniform vec3 u_halo_lines_color ;".split(" ")},{a:"cond",d:[{a:"if",e:["SKY_STARS"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_sun_intensity ; uniform float u_halo_stars_blend ; uniform float u_halo_stars_height ;".split(" ")}]}}]},{a:"txt",b:"uniform float u_p_alpha_start ; uniform float u_p_alpha_end ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["DISABLE_FOG",{a:"logic_negative_expr",
i:1}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_color_density",";"]},{a:"cond",d:[{a:"if",e:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["PROCEDURAL_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_cube_fog",";"]}]}}]},{a:"cond",d:[{a:"if",e:["USE_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{a:"txt",b:["uniform","vec4","u_diffuse_color",
";"]},{a:"cond",d:[{a:"if",e:["SOFT_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:"uniform PRECISION sampler2D u_scene_depth ; uniform float u_view_max_depth ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["SOFT_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","h",";"]}]}}]},{a:"cond",d:[{a:"if",e:["TEXTURE_COLOR","HALO_PARTICLES","USE_NODE_TEX_COORD_UV","USE_NODE_UV_MERGED","USE_NODE_UVMAP","USE_NODE_GEOMETRY_UV","USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",i:8}],h:{a:"grp",d:[{a:"txt",
b:["GLSL_IN","vec2","n",";"]}]}}]},{a:"txt",b:["GLSL_IN","vec3","c",";"]},{a:"cond",d:[{a:"if",e:["NODES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["HALO_PARTICLES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","cz",";"]}]}}]},{a:"txt",b:["GLSL_IN","vec3","bw",";"]}]}}]},{a:"cond",d:[{a:"if",e:["PARTICLES_SHADELESS",{a:"logic_negative_expr",i:1},"DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN",
"vec3","bv",";"]}]}}]},{a:"cond",d:[{a:"if",e:["SOFT_PARTICLES","DISABLE_FOG",{a:"logic_negative_expr",i:1},"NODES",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","d",";"]}]}}]},{a:"cond",d:[{a:"if",e:["HALO_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","aY",";"]},{a:"cond",d:[{a:"if",e:["SKY_STARS"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","aX",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",e:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","o",";"]}]}}]},{a:"txt",
b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"include",o:"lighting_nodes.glslf"},{a:"cond",d:[{a:"if",e:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"fog.glslf"}]}}]},{a:"cond",d:[{a:"if",e:["HALO_PARTICLES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"environment.glslf"}]}}]},{a:"cond",d:[{a:"if",e:["HALO_PARTICLES"],h:{a:"grp",d:[{a:"include",o:"halo_color.glslf"}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",e:["PARTICLES_SHADELESS",
{a:"logic_negative_expr",i:1},"DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 u = normalize ( bv ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["HALO_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:"vec4 a_ = aZ ( ) ; vec3 aK = a_ . rgb * bw ; float cV = 0.9 * length ( n ) ; float cW = smoothstep ( u_p_alpha_start , u_p_alpha_end , cV ) ; float L = a_ . a * ( 1.0 - cW ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec4","bZ","=","u_diffuse_color",
";"]},{a:"cond",d:[{a:"if",e:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:"vec4 ca = GLSL_TEXTURE ( u_sampler , n ) ; bY ( ca . rgb ) ;".split(" ")},{a:"cond",d:[{a:"if",e:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"bZ . rgb = mix ( bZ . rgb , ca . rgb , u_diffuse_color_factor ) ;".split(" ")}]}},{a:"elif",e:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"bZ . rgb *= mix ( vec3 ( 1.0 ) , ca . rgb , u_diffuse_color_factor ) ;".split(" ")}]}}]},
{a:"txt",b:"bZ . a = ca . a ;".split(" ")}]}}]},{a:"txt",b:"bZ . rgb *= bw ;".split(" ")},{a:"cond",d:[{a:"if",e:["PARTICLES_SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"vec3 cd = u_diffuse_intensity * bZ . rgb ; vec3 ci = u_emit * bZ . rgb ; vec3 Q = vec3 ( 0.0 , 0.0 , 1.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",e:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logic_negative_expr",i:1},"SKY_COLOR",{a:"logical_and_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"vec3 cf = u_environment_energy * ce ( vec3 ( 0.0 ) ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 cf = u_environment_energy * ce ( Q ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 cg = u_ambient * cf ; float cl = u_specular_params [ 0 ] ; vec2 cm = vec2 ( u_specular_params [ 1 ] , u_specular_params [ 2 ] ) ; vec3 cn = cl * u_specular_color ; vec3 aK ; vec3 co ; cp ( ci , cg , cd , cn , c , Q , u , cm , u_diffuse_params , vec4 ( 1.0 ) , 0.0 , vec4 ( 0.0 ) , aK , co ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 aK = bZ . rgb ;".split(" ")}]}}]},{a:"txt",
b:"float L = bZ . a * cz ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["ALPHA"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["ALPHA_CLIP"],h:{a:"grp",d:[{a:"txt",b:"if ( L < 0.5 ) discard ; L = 1.0 ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["L","=","1.0",";"]}]}}]},{a:"cond",d:[{a:"if",e:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"bt ( aK , length ( d ) , u , 1.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["SOFT_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:"float ct = - d . z / u_view_max_depth ; vec4 cu = GLSL_TEXTURE_PROJ ( u_scene_depth , h ) ; float cw = cv ( cu ) ; float cx = cw - ct ; float cy = u_view_max_depth / SOFT_STRENGTH * cx ; L = L * min ( cy , 1.0 ) ;".split(" ")}]}}]},
{a:"txt",b:["aQ","(","aK",")",";"]},{a:"cond",d:[{a:"if",e:["ALPHA","ALPHA_CLIP",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aR ( aK , L ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aK , L ) ; }".split(" ")}]};a["procedural_skydome.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"txt",b:"uniform vec3 u_sky_color ; uniform vec3 u_sun_direction ; uniform float u_rayleigh_brightness ; uniform float u_mie_brightness ; uniform float u_spot_brightness ; uniform float u_scatter_strength ; uniform float u_rayleigh_strength ; uniform float u_mie_strength ; uniform float u_rayleigh_collection_power ; uniform float u_mie_collection_power ; uniform float u_mie_distribution ; GLSL_IN vec3 cX ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; const float cY = 0.99 ; const float cZ = 1.8 ; const int c_ = 8 ; float df ( vec3 O , vec3 da ) { float a = dot ( da , da ) ; float b = 2.0 * dot ( da , O ) ; float db = dot ( O , O ) - 1.0 ; float dc = b * b - 4.0 * a * db ; float dd = sqrt ( dc ) ; float q = ( - b - dd ) / 2.0 ; float de = db / q ; return de ; } float dh ( float L , float g ) { float a = 3.0 * ( 1.0 - g * g ) ; float b = 2.0 * ( 2.0 + g * g ) ; float db = 1.0 + L * L ; float dg = pow ( 1.0 + g * g - 2.0 * g * L , 1.5 ) ; dg = max ( dg , 0.00001 ) ; return ( a / b ) * ( db / dg ) ; } float dm ( vec3 O , vec3 da , float di ) { float dj = dot ( da , - O ) ; if ( dj < 0.0 ) { return 1.0 ; } vec3 dk = O + dj * da ; if ( length ( dk ) < di ) { return 0.0 ; } else if ( length ( dk ) >= di ) { vec3 cB = normalize ( dk ) * di - O ; float dl = acos ( dot ( normalize ( cB ) , da ) ) ; return smoothstep ( 0.0 , 1.0 , pow ( dl * 2.0 , 3.0 ) ) ; } else return 1.0 ; } vec3 dn ( float aG , vec3 aK , float aF ) { return aK - aK * pow ( u_sky_color , vec3 ( aF / aG ) ) ; } void main ( ) { vec3 dp = normalize ( cX ) ; vec3 dq = u_sun_direction ; float L = dot ( dp , dq ) ; float dr = dh ( L , - 0.01 ) * u_rayleigh_brightness * dq . z ; float ds = dh ( L - 0.5 , u_mie_distribution ) * u_mie_brightness * ( 1.0 - dq . z ) ; float dt = smoothstep ( 0.0 , 100.0 , dh ( L , 0.9995 ) ) * u_spot_brightness ; vec3 du = vec3 ( 0.0 , 0.0 , cY ) ; float dv = df ( du , dp ) ; float dw = dv / float ( c_ ) ; float dx = dm ( du , dp , cY - 0.3 ) ; vec3 dy = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec3 dz = vec3 ( 0.0 , 0.0 , 0.0 ) ; for ( int bQ = 0 ; bQ < c_ ; bQ ++ ) { float dA = dw * float ( bQ ) ; vec3 O = du + dp * dA ; float dB = dm ( O , dq , cY - 0.2 ) ; float dC = df ( O , dq ) ; vec3 dD = dn ( dC , vec3 ( cZ ) , u_scatter_strength ) * dB ; dy += dn ( sqrt ( dA ) , u_sky_color * dD , u_rayleigh_strength ) ; dz += dn ( dA , dD , u_mie_strength ) ; } dy = dy * dx * pow ( dv , u_rayleigh_collection_power ) / float ( c_ ) ; dz = ( dz * dx * pow ( dv , u_mie_collection_power ) ) / float ( c_ ) ; vec3 aK = vec3 ( dt * dz + ds * dz + dr * dy ) ; aQ ( aK ) ; GLSL_OUT_FRAG_COLOR = vec4 ( aK , 1.0 ) ; }".split(" ")}]};
a["procedural_skydome.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform mat4 u_cube_view_matrix ; GLSL_IN vec3 a_position ; GLSL_OUT vec3 cX ; void main ( ) { vec4 O = vec4 ( a_position . xy , 0.999999 , 1.0 ) ; vec4 dp = u_cube_view_matrix * O ; cX = dp . xyz ; gl_Position = O ; }".split(" ")}]};a["shadow.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"REFLECTION_TYPE",
b:["REFL_NONE"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"SHADELESS",b:["0"]},{a:"var",c:"USE_VIEW_MATRIX_INVERSE",b:["0"]},{a:"var",c:"USE_MODEL_MATRIX_INVERSE",b:["0"]},{a:"var",c:"USE_VIEW_MATRIX",b:["0"]},{a:"var",c:"USE_MODEL_MATRIX",b:["0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"USE_REFRACTION",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",
b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"NUM_LAMP_LIGHTS",b:["0"]},{a:"var",c:"NUM_LFACTORS",b:["0"]},{a:"var",c:"TEXTURE_BLEND_TYPE",b:["TEXTURE_BLEND_TYPE_MIX"]},{a:"var",c:"NUM_VALUES",b:["0"]},{a:"var",c:"NUM_RGBS",b:["0"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"POISSON_DISK_NUM",
b:["NO_SOFT_SHADOWS"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",e:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"math.glslv"}]}}]},{a:"cond",d:[{a:"if",e:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform float u_time ; uniform float u_environment_energy ;".split(" ")},{a:"cond",d:[{a:"if",e:["NUM_LIGHTS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec3 u_light_color_intensities [ NUM_LIGHTS ] ; uniform vec4 u_light_factors [ NUM_LFACTORS ] ;".split(" ")}]}}]},
{a:"txt",b:["uniform","vec3","u_camera_eye_frag",";"]},{a:"cond",d:[{a:"if",e:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_NODE_GEOMETRY_VW","USE_VIEW_MATRIX",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{a:"cond",d:[{a:"if",e:["USE_VIEW_MATRIX_INVERSE"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",e:["USE_MODEL_MATRIX"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},
{a:"cond",d:[{a:"if",e:["USE_MODEL_MATRIX_INVERSE"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",e:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",e:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["REFLECTION_TYPE",
"REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_plane_reflection",";"]}]}},{a:"elif",e:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_cube_reflection",";"]}]}},{a:"elif",e:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{a:"txt",b:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ;".split(" ")},
{a:"cond",d:[{a:"if",e:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_mirror_factor",";"]}]}},{a:"elif",e:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_refl_plane",";"]}]}}]},{a:"cond",d:[{a:"if",e:["USE_NODE_LAMP"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ; uniform vec4 u_lamp_light_factors [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",e:["USE_NODE_VALUE"],h:{a:"grp",d:[{a:"txt",b:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["USE_NODE_RGB"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:"uniform sampler2D u_colormap0 ; uniform float u_alpha_factor ;".split(" ")}]}}]},{a:"txt",b:["uniform","vec4","u_diffuse_color",";"]}]}}]},{a:"cond",d:[{a:"if",
e:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_pcf_blur_radii",";"]}]}}]},{a:"txt",b:"uniform vec4 u_csm_center_dists ; uniform PRECISION GLSL_SMPLR2D_SHDW u_shadow_map0 ;".split(" ")},{a:"cond",d:[{a:"if",e:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW",
"u_shadow_map1",";"]}]}}]},{a:"cond",d:[{a:"if",e:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map2",";"]}]}}]},{a:"cond",d:[{a:"if",e:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map3",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",e:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_shadow_mask",";"]}]}}]},{a:"cond",d:[{a:"if",e:["USE_NODE_B4W_REFRACTION"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_refractmap",";"]},{a:"cond",d:[{a:"if",e:["USE_REFRACTION","USE_REFRACTION_CORRECTION",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",e:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{a:"logical_or_expr",i:3}],
h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{a:"cond",d:[{a:"if",e:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","c",";"]},{a:"cond",d:[{a:"if",e:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE",{a:"logical_or_expr",i:5}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","e",";"]}]}}]},{a:"cond",d:[{a:"if",e:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","f",";"]}]}}]}]}},
{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","n",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",e:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"NODES","ALPHA",{a:"logical_and_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","d",";"]}]}}]},{a:"cond",d:[{a:"if",e:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","j",";"]},{a:"cond",d:[{a:"if",
e:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","k",";"]}]}}]},{a:"cond",d:[{a:"if",e:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","l",";"]}]}}]},{a:"cond",d:[{a:"if",e:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","m",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",e:["REFLECTION_TYPE",
"REFL_PLANE",{a:"equal_expr",i:2},"USE_NODE_B4W_REFRACTION",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","h",";"]}]}}]},{a:"cond",d:[{a:"if",e:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["USE_NODE_B4W_REFRACTION","USE_REFRACTION",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","i",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",e:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","o",";"]}]}}]},{a:"txt",b:["GLSL_OUT",
"vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"cond",d:[{a:"if",e:["SHADELESS",{a:"logic_negative_expr",i:1},"NODES","ALPHA",{a:"logical_and_expr",i:2},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"include",o:"shadow.glslf"}]}}]},{a:"cond",d:[{a:"if",e:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"nodes.glslf"}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",e:["ALPHA"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",
e:["NODES"],h:{a:"grp",d:[{a:"txt",b:"vec3 u = u_camera_eye_frag - c ; vec3 v = normalize ( u ) ; vec3 A ; vec3 B ; vec3 C ; vec4 D ; float E ; mat3 F = mat3 ( 0.0 ) ; mat3 G = mat3 ( 0.0 ) ; mat3 H = mat3 ( 0.0 ) ; mat3 I = mat3 ( 0.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",e:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_NODE_GEOMETRY_VW","USE_VIEW_MATRIX",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["F","=","u_view_tsr_frag",";"]}]}}]},{a:"cond",d:[{a:"if",e:["USE_VIEW_MATRIX_INVERSE"],
h:{a:"grp",d:[{a:"txt",b:["G","=","u_view_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",e:["USE_MODEL_MATRIX"],h:{a:"grp",d:[{a:"txt",b:["H","=","u_model_tsr",";"]}]}}]},{a:"cond",d:[{a:"if",e:["USE_MODEL_MATRIX_INVERSE"],h:{a:"grp",d:[{a:"txt",b:["I","=","u_model_tsr_inverse",";"]}]}}]},{a:"txt",b:"J ( v , F , G , H , I , A , B , C , D , E ) ; float L = E ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:"float L = ( GLSL_TEXTURE ( u_colormap0 , n ) ) . a ;".split(" ")},
{a:"cond",d:[{a:"if",e:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float M = u_alpha_factor * L ; M += ( 1.0 - step ( 0.0 , M ) ) ; L = mix ( M , 1.0 , u_diffuse_color . a ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"float L = u_diffuse_color . a ;".split(" ")}]}}]}]}}]},{a:"txt",b:"if ( L < 0.5 ) discard ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["SHADOW_USAGE","NO_SHADOWS",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_CASTING",{a:"equal_expr",
i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 ) ;".split(" ")}]}},{a:"elif",e:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = dE ( d . z ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR . a *= clamp ( f . r , 0.999999999 , 1.0 ) ;".split(" ")}]}}]}]}}]},
{a:"txt",b:["}"]}]};a["shadow.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"var",c:"CALC_TBN",b:["0"]},{a:"var",c:"USE_INSTANCED_PARTCLS",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"SMAA_JITTER",b:["0"]},{a:"var",c:"MAC_OS_SHADOW_HACK",
b:["0"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"AU_QUALIFIER",b:["GLSL_IN"]},{a:"var",c:"BEND_CENTER_ONLY",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"HAIR_BILLBOARD",b:["0"]},{a:"var",c:"FRAMES_BLENDING",b:["0"]},{a:"var",c:"SHADOW_TEX_RES",b:["2048.0"]},{a:"var",c:"VERTEX_ANIM",b:["0"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"VERTEX_ANIM_MIX_NORMALS_FACTOR",
b:["u_va_frame_factor"]},{a:"var",c:"MAX_BONES",b:["0"]},{a:"var",c:"WIND_BEND",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"SKINNED",b:["0"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"var",c:"BILLBOARD_PRES_GLOB_ORIENTATION",b:["0"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"include",o:"scale_texcoord.glslv"},{a:"txt",b:["GLSL_IN",
"vec3","a_position",";"]},{a:"cond",d:[{a:"if",e:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"CALC_TBN",{a:"logical_or_expr",i:8}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_tbn_quat",";"]}]}}]},{a:"cond",d:[{a:"if",e:["USE_INSTANCED_PARTCLS"],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec4 a_part_ts ; GLSL_IN vec4 a_part_r ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",e:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_shade_tangs",";"]}]}}]},{a:"cond",d:[{a:"if",e:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_influence",";"]}]}}]},{a:"cond",d:[{a:"if",e:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{a:"cond",d:[{a:"if",e:["WIND_BEND"],h:{a:"grp",
d:[{a:"cond",d:[{a:"if",e:["MAIN_BEND_COL"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","a_bending_col_main",";"]},{a:"cond",d:[{a:"if",e:["DETAIL_BEND"],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},{a:"txt",b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{a:"cond",d:[{a:"if",e:["BEND_CENTER_ONLY"],
h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_emitter_center",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",e:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_position_next",";"]},{a:"cond",d:[{a:"if",e:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE",{a:"logical_or_expr",i:5}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_tbn_quat_next",";"]}]}}]}]}}]}]}}]},{a:"cond",
d:[{a:"if",e:["NODES","ALPHA",{a:"logical_and_expr",i:2},{a:"logic_negative_expr",i:1},"TEXTURE_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","a_texcoord",";"]}]}}]},{a:"cond",d:[{a:"if",e:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","c",";"]},{a:"cond",d:[{a:"if",e:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",
i:3},{a:"logical_or_expr",i:6}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","e",";"]}]}}]},{a:"cond",d:[{a:"if",e:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","f",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec2","n",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",e:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"NODES","ALPHA",{a:"logical_and_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:["GLSL_OUT","vec4","d",";"]}]}}]},{a:"cond",d:[{a:"if",e:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","j",";"]},{a:"cond",d:[{a:"if",e:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","k",";"]}]}}]},{a:"cond",d:[{a:"if",e:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","l",";"]}]}}]},{a:"cond",
d:[{a:"if",e:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","m",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",e:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_NODE_B4W_REFRACTION",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","h",";"]}]}}]},{a:"cond",d:[{a:"if",e:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{a:"logical_and_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","float","i",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",e:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","o",";"]}]}}]},{a:"cond",d:[{a:"if",e:["STATIC_BATCH"],h:{a:"grp",d:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"cond",d:[{a:"if",e:["SMAA_JITTER"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec2",
"u_subpixel_jitter",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},{a:"cond",d:[{a:"if",e:["DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{a:"cond",d:[{a:"if",e:["BILLBOARD","SHADOW_USAGE","SHADOW_CASTING",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_shadow_cast_billboard_view_tsr",";"]}]}}]},{a:"cond",d:[{a:"if",e:["DYNAMIC_GRASS"],
h:{a:"grp",d:[{a:"txt",b:"uniform PRECISION sampler2D u_grass_map_depth ; uniform sampler2D u_grass_map_color ; uniform vec4 u_camera_quat ; uniform vec3 u_grass_map_dim ; uniform float u_grass_size ; uniform float u_scale_threshold ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},{a:"cond",d:[{a:"if",e:["FRAMES_BLENDING"],
h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",e:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["BILLBOARD_JITTERED"],h:{a:"grp",d:[{a:"txt",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{a:"txt",b:"uniform vec3 u_wind ; uniform float u_time ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:["uniform",
"float","u_va_frame_factor",";"]}]}}]},{a:"cond",d:[{a:"if",e:["NODES","ALPHA",{a:"logical_and_expr",i:2},{a:"logic_negative_expr",i:1},"TEXTURE_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_texture_scale",";"]}]}}]},{a:"cond",d:[{a:"if",e:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_normal_offset",";"]},{a:"cond",d:[{a:"if",e:["MAC_OS_SHADOW_HACK"],h:{a:"grp",d:[{a:"txt",b:"uniform mat3 u_v_light_tsr [ NUM_CAST_LAMPS ] ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_v_light_ts [ NUM_CAST_LAMPS ] ; uniform vec4 u_v_light_r [ NUM_CAST_LAMPS ] ;".split(" ")}]}}]},{a:"txt",b:["uniform","mat4","u_p_light_matrix0",";"]},{a:"cond",d:[{a:"if",e:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_p_light_matrix1",";"]}]}}]},{a:"cond",d:[{a:"if",e:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:["uniform","mat4","u_p_light_matrix2",";"]}]}}]},{a:"cond",d:[{a:"if",e:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_p_light_matrix3",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",e:["USE_NODE_B4W_REFRACTION"],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]},{a:"include",o:"dynamic_grass.glslv"},{a:"include",o:"shadow.glslv"},{a:"include",o:"skin.glslv"},{a:"include",o:"wind_bending.glslv"},
{a:"cond",d:[{a:"if",e:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"nodes.glslv"}]}}]},{a:"txt",b:"void main ( ) { mat3 N = u_view_tsr ; vec3 O = a_position ;".split(" ")},{a:"cond",d:[{a:"if",e:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},{a:"logical_or_expr",i:7}],h:{a:"grp",d:[{a:"txt",
b:"vec3 by = P ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; vec3 Q = by ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Q = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["NODES","ALPHA","CALC_TBN_SPACE",{a:"logical_and_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"vec3 R = P ( a_tbn_quat , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 S = sign ( a_tbn_quat [ 3 ] ) * cross ( Q , R ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 R = vec3 ( 0.0 ) ; vec3 S = vec3 ( 0.0 ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",e:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:"O = mix ( O , a_position_next , u_va_frame_factor ) ;".split(" ")},{a:"cond",d:[{a:"if",e:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE",{a:"logical_or_expr",i:5}],h:{a:"grp",d:[{a:"txt",b:"vec3 Y = P ( a_tbn_quat_next , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; Q = mix ( Q , Y , VERTEX_ANIM_MIX_NORMALS_FACTOR ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",e:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:"vec3 Z = P ( a_tbn_quat_next , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 _ = sign ( a_tbn_quat_next [ 3 ] ) * cross ( Y , Z ) ; R = mix ( R , Z , u_va_frame_factor ) ; S = mix ( S , _ , u_va_frame_factor ) ;".split(" ")}]}}]}]}}]}]}}]},{a:"cond",d:[{a:"if",e:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:"ac ( O , R , S , Q ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["USE_INSTANCED_PARTCLS"],h:{a:"grp",d:[{a:"txt",b:"mat3 T = mat3 ( a_part_ts [ 0 ] , a_part_ts [ 1 ] , a_part_ts [ 2 ] , a_part_ts [ 3 ] , a_part_r [ 0 ] , a_part_r [ 1 ] , a_part_r [ 2 ] , a_part_r [ 3 ] , 1.0 ) ;".split(" ")},
{a:"cond",d:[{a:"if",e:["STATIC_BATCH",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"mat3 T = aS ( u_model_tsr , T ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",e:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["vec3","ad","=","au_center_pos",";"]}]}},{a:"elif",e:["DYNAMIC_GRASS","USE_INSTANCED_PARTCLS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 ad = a_part_ts . xyz ; O = ae ( T , O ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 ad = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",i:1},"DYNAMIC_GRASS",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["mat3","T","=","u_model_tsr",";"]}]}}]},{a:"cond",d:[{a:"if",e:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["CALC_TBN"],h:{a:"grp",d:[{a:"txt",b:"vec3 V = normalize ( U ( T , by ) ) ; vec3 W = cross ( vec3 ( 0.0 , 0.0 , 1.0 ) , V ) ; vec3 X = cross ( V , W ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec3","X","=","a_shade_tangs",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 X = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["DYNAMIC_GRASS"],h:{a:"grp",d:[{a:"txt",b:"ak am = aT ( O , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , Q , ad , u_grass_map_depth , u_grass_map_color , u_grass_map_dim , u_grass_size , u_camera_eye , u_camera_quat , N ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["BILLBOARD"],h:{a:"grp",d:[{a:"txt",
b:"vec3 af = ae ( T , ad ) ;".split(" ")},{a:"cond",d:[{a:"if",e:["HAIR_BILLBOARD",{a:"logic_negative_expr",i:1},"SHADOW_USAGE","SHADOW_CASTING",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["mat3","dF","=","u_shadow_cast_billboard_view_tsr",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["mat3","dF","=","N",";"]}]}}]},{a:"cond",d:[{a:"if",e:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2},"USE_INSTANCED_PARTCLS",
{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"T = ah ( u_camera_eye , af , dF , T ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"T = ai ( u_camera_eye , af , dF ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"T = aj ( u_wind , u_time , u_jitter_amp , u_jitter_freq , af , T ) ;".split(" ")}]}}]},{a:"txt",b:"ak am = al ( O - ad , ad , vec3 ( 0.0 ) , X , vec3 ( 0.0 ) , Q , T ) ; am . ad = af ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"ak am = al ( O , ad , vec3 ( 0.0 ) , X , vec3 ( 0.0 ) , Q , T ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",e:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["vec3","ao","=","by",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 ao = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"an ( am . O , am . ad , ao , mat4 ( 0.0 ) ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["NODES",
"ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"c = am . O ;".split(" ")},{a:"cond",d:[{a:"if",e:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},{a:"logical_or_expr",i:6}],h:{a:"grp",d:[{a:"txt",b:"e = am . Q ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:"float aq = ( dot ( cross ( am . Q , am . R ) , am . S ) < 0.0 ) ? - 1.0 : 1.0 ; f = vec4 ( am . R , aq ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",e:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:"o = am . as ;".split(" ")}]}}]}]}}]},{a:"txt",b:"vec4 bB = vec4 ( ae ( N , am . O ) , 1.0 ) ; vec4 at = u_proj_matrix * bB ;".split(" ")},{a:"cond",d:[{a:"if",e:["SMAA_JITTER"],h:{a:"grp",d:[{a:"txt",b:"at . xy += u_subpixel_jitter * at . w ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_NODE_B4W_REFRACTION",
{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"h = bC ( at ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"i = - bB . z / u_view_max_depth ;".split(" ")}]}}]},{a:"txt",b:["J","(",")",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:"n = ap ( a_texcoord , u_texture_scale ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",e:["SHADOW_USAGE","SHADOW_MASK_GENERATION",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"bD ( am . O , am . Q ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"NODES","ALPHA",{a:"logical_and_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["d","=","bB",";"]}]}}]},{a:"cond",d:[{a:"if",e:["SHADOW_USAGE","SHADOW_CASTING",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 dG = ( u_proj_matrix * vec4 ( N [ 0 ] , 1.0 ) ) . xy ; float dH = SHADOW_TEX_RES / 2.0 ; dG = floor ( dG * dH + 0.5 ) / dH - dG ; at . xy += dG ;".split(" ")}]}}]},
{a:"txt",b:["gl_Position","=","at",";","}"]}]};a["special_lens_flares.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"txt",b:"uniform sampler2D u_sampler ; GLSL_IN vec2 n ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 aK = GLSL_TEXTURE ( u_sampler , n ) ; aQ ( aK . rgb ) ; aR ( aK . rgb , aK . a ) ; GLSL_OUT_FRAG_COLOR = aK ; }".split(" ")}]};a["special_lens_flares.glslv"]=
{a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"define",c:"LIGHT_INDEX",b:["0"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; GLSL_IN float a_lf_dist ; GLSL_IN vec2 a_lf_bb_vertex ; GLSL_IN vec2 a_texcoord ; GLSL_OUT vec2 n ; void main ( ) { n = a_texcoord ; vec3 da = normalize ( u_light_directions [ LIGHT_INDEX ] ) ; vec4 at = u_proj_matrix * vec4 ( U ( u_view_tsr , da ) , 0.0 ) ; at . x /= at . w ; at . y /= at . w ; at += 99999.0 * step ( at . z , 0.0 ) ; at += 100.0 * ( step ( 1.0 , abs ( at . x ) ) + step ( 1.0 , abs ( at . y ) ) ) ; at . x = a_lf_dist * at . x ; at . y = a_lf_dist * at . y ; float dI = u_proj_matrix [ 1 ] [ 1 ] / u_proj_matrix [ 0 ] [ 0 ] ; vec2 dJ = vec2 ( a_lf_bb_vertex . x / dI , a_lf_bb_vertex . y ) ; if ( a_lf_dist < 0.999 ) { const float dK = 1.9 ; dJ *= ( 1.0 + dK * length ( at . xy ) ) ; } gl_Position = vec4 ( at . xy + dJ , 0.999999 , 1.0 ) ; }".split(" ")}]};
a["special_skydome.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"WO_SKYTEX",b:["0"]},{a:"var",c:"WO_SKYREAL",b:["0"]},{a:"var",c:"WO_SKYBLEND",b:["0"]},{a:"var",c:"PROCEDURAL_SKYDOME",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"WO_SKYPAPER",b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"WATER_LEVEL",b:["0.0"]},{a:"var",c:"BLENDTYPE",b:["MIX"]},{a:"var",c:"MTEX_RGBTOINT",b:["0"]},{a:"var",c:"MTEX_NEGATIVE",b:["0"]},
{a:"var",c:"WOMAP_HORIZ",b:["0"]},{a:"var",c:"WOMAP_ZENUP",b:["0"]},{a:"var",c:"WOMAP_ZENDOWN",b:["0"]},{a:"var",c:"WOMAP_BLEND",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"cond",d:[{a:"if",e:["WO_SKYTEX","PROCEDURAL_SKYDOME",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_sky",";"]}]}}]},{a:"cond",d:[{a:"if",e:["PROCEDURAL_SKYDOME",{a:"logic_negative_expr",i:1},"WO_SKYTEX",{a:"logical_and_expr",
i:2}],h:{a:"grp",d:[{a:"include",o:"blending.glslf"},{a:"txt",b:"uniform vec4 u_sky_tex_fac ; uniform vec3 u_sky_tex_color ; uniform float u_sky_tex_dvar ; vec3 ee ( vec3 dL , vec3 dM , float aF , float dN ) { float dO = aF * dN ;".split(" ")},{a:"cond",d:[{a:"if",e:["BLENDTYPE","MIX",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return dP ( dM , dL , dO ) ;".split(" ")}]}},{a:"elif",e:["BLENDTYPE","ADD",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return dQ ( dL , dM , dO ) ;".split(" ")}]}},
{a:"elif",e:["BLENDTYPE","SUBTRACT",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return dR ( dL , dM , dO ) ;".split(" ")}]}},{a:"elif",e:["BLENDTYPE","MULTIPLY",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return dS ( dL , dM , dO ) ;".split(" ")}]}},{a:"elif",e:["BLENDTYPE","SCREEN",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return dT ( dL , dM , dO ) ;".split(" ")}]}},{a:"elif",e:["BLENDTYPE","OVERLAY",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return dU ( dL , dM , dO ) ;".split(" ")}]}},
{a:"elif",e:["BLENDTYPE","DIFFERENCE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return dV ( dL , dM , dO ) ;".split(" ")}]}},{a:"elif",e:["BLENDTYPE","DIVIDE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return dW ( dL , dM , dO ) ;".split(" ")}]}},{a:"elif",e:["BLENDTYPE","DARKEN",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return dX ( dL , dM , dO ) ;".split(" ")}]}},{a:"elif",e:["BLENDTYPE","LIGHTEN",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return dY ( dL , dM , dO ) ;".split(" ")}]}},
{a:"elif",e:["BLENDTYPE","HUE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return dZ ( dM , dL , dO ) ;".split(" ")}]}},{a:"elif",e:["BLENDTYPE","SATURATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return d_ ( dM , dL , dO ) ;".split(" ")}]}},{a:"elif",e:["BLENDTYPE","VALUE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return ea ( dM , dL , dO ) ;".split(" ")}]}},{a:"elif",e:["BLENDTYPE","COLOR",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return eb ( dM , dL , dO ) ;".split(" ")}]}},
{a:"elif",e:["BLENDTYPE","SOFT_LIGHT",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return ec ( dM , dL , dO ) ;".split(" ")}]}},{a:"elif",e:["BLENDTYPE","LINEAR_LIGHT",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return ed ( dM , dL , dO ) ;".split(" ")}]}}]},{a:"txt",b:"return vec3 ( 1.0 , 0.0 , 1.0 ) ; } float ek ( float ef , float eg , float aF , float dN ) { vec3 dL = vec3 ( ef ) , dM = vec3 ( eg ) ; float dO = aF * dN ;".split(" ")},{a:"cond",d:[{a:"if",e:["BLENDTYPE","MIX",{a:"equal_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:"return dP ( dM , dL , dO ) . x ;".split(" ")}]}},{a:"elif",e:["BLENDTYPE","ADD",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return dQ ( dL , dM , dO ) . x ;".split(" ")}]}},{a:"elif",e:["BLENDTYPE","SUBTRACT",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return dR ( dL , dM , dO ) . x ;".split(" ")}]}},{a:"elif",e:["BLENDTYPE","MULTIPLY",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return eh ( ef , eg , dO , dN ) ;".split(" ")}]}},{a:"elif",e:["BLENDTYPE",
"SCREEN",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return ei ( ef , eg , dO , dN ) ;".split(" ")}]}},{a:"elif",e:["BLENDTYPE","OVERLAY",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return ej ( ef , eg , dO , dN ) ;".split(" ")}]}},{a:"elif",e:["BLENDTYPE","DIFFERENCE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return dV ( dL , dM , dO ) . x ;".split(" ")}]}},{a:"elif",e:["BLENDTYPE","DIVIDE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return dW ( dL , dM , dO ) . x ;".split(" ")}]}},
{a:"elif",e:["BLENDTYPE","DARKEN",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return dX ( dL , dM , dO ) . x ;".split(" ")}]}},{a:"elif",e:["BLENDTYPE","LIGHTEN",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return dY ( dL , dM , dO ) . x ;".split(" ")}]}},{a:"elif",e:["BLENDTYPE","SOFT_LIGHT",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return ec ( dM , dL , dO ) . x ;".split(" ")}]}},{a:"elif",e:["BLENDTYPE","LINEAR_LIGHT",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return ed ( dM , dL , dO ) . x ;".split(" ")}]}}]},
{a:"txt",b:["return","0.0",";","}"]}]}}]},{a:"cond",d:[{a:"if",e:["PROCEDURAL_SKYDOME",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",i:1},"REFLECTION_PASS","REFL_PASS_NONE",{a:"equal_expr",i:2},{a:"logical_and_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_camera_eye_frag ; uniform vec4 u_underwater_fog_color_density ;".split(" ")}]}}]},
{a:"txt",b:"GLSL_IN vec3 cX ; GLSL_IN vec2 n ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec3 el ; vec3 dp = normalize ( cX ) ;".split(" ")},{a:"cond",d:[{a:"if",e:["PROCEDURAL_SKYDOME"],h:{a:"grp",d:[{a:"txt",b:"el = GLSL_TEXTURE_CUBE ( u_sky , dp ) . rgb ;".split(" ")}]}},{a:"elif",e:["WO_SKYTEX","WO_SKYBLEND",{a:"logical_or_expr",i:2},{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"el = u_horizon_color ; aQ ( el ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec3",
"em",";"]},{a:"cond",d:[{a:"if",e:["WO_SKYPAPER"],h:{a:"grp",d:[{a:"txt",b:"em = vec3 ( n , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"em = vec3 ( cX . xy , 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:["float","en","=","0.0",";"]},{a:"cond",d:[{a:"if",e:["WO_SKYBLEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["WO_SKYPAPER"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["WO_SKYREAL"],h:{a:"grp",d:[{a:"txt",b:"en = abs ( n . y ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"en = ( n . y + 1.0 ) * 0.5 ;".split(" ")}]}}]}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"float L = acos ( dp . z ) ;".split(" ")},{a:"cond",d:[{a:"if",e:["WO_SKYREAL"],h:{a:"grp",d:[{a:"txt",b:"en = abs ( L * INV_PI - 0.5 ) * 2.0 ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"en = 1.0 - L * INV_PI ;".split(" ")}]}}]}]}}]}]}}]},{a:"txt",b:"vec3 eo = u_horizon_color ; vec3 ep = u_zenith_color ;".split(" ")},{a:"cond",d:[{a:"if",e:["WO_SKYTEX"],h:{a:"grp",d:[{a:"txt",b:"float eq = 1.0 ; vec4 er = GLSL_TEXTURE_CUBE ( u_sky , dp ) ; bY ( er . rgb ) ; eq = er . a ;".split(" ")},
{a:"cond",d:[{a:"if",e:["MTEX_RGBTOINT"],h:{a:"grp",d:[{a:"txt",b:"eq = es ( er ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["MTEX_NEGATIVE"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["MTEX_RGBTOINT",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"er = vec4 ( vec3 ( 1.0 ) - er . rgb , er . a ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"eq = 1.0 - eq ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",e:["WOMAP_HORIZ","WOMAP_ZENUP","WOMAP_ZENDOWN",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"cond",
d:[{a:"if",e:["MTEX_RGBTOINT"],h:{a:"grp",d:[{a:"txt",b:"er = vec4 ( u_sky_tex_color , 1.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"eq = er . a ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["WOMAP_HORIZ"],h:{a:"grp",d:[{a:"txt",b:"eo = ee ( er . rgb , eo , eq , u_sky_tex_fac [ 1 ] ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["WOMAP_ZENUP","WOMAP_ZENDOWN",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["float","et","=","0.0",";"]},{a:"cond",d:[{a:"if",e:["WO_SKYREAL"],h:{a:"grp",
d:[{a:"txt",b:"if ( dot ( em , vec3 ( 0.0 , 0.0 , 1.0 ) ) >= 0.0 ) {".split(" ")},{a:"cond",d:[{a:"if",e:["WOMAP_ZENUP"],h:{a:"grp",d:[{a:"txt",b:"et = u_sky_tex_fac [ 2 ] ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:[";"]}]}}]},{a:"txt",b:["}"]},{a:"cond",d:[{a:"if",e:["WOMAP_ZENDOWN"],h:{a:"grp",d:[{a:"txt",b:"else et = u_sky_tex_fac [ 3 ] ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["WOMAP_ZENUP"],h:{a:"grp",d:[{a:"txt",b:"et = u_sky_tex_fac [ 2 ] ;".split(" ")}]}},
{a:"elif",e:["WOMAP_ZENDOWN"],h:{a:"grp",d:[{a:"txt",b:"et = u_sky_tex_fac [ 3 ] ;".split(" ")}]}}]}]}}]},{a:"txt",b:"if ( et != 0.0 ) ep = ee ( er . rgb , ep , eq , et ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",e:["WOMAP_BLEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["MTEX_RGBTOINT",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"eq = dot ( er . rgb , vec3 ( 0.2126 , 0.7152 , 0.0722 ) ) ;".split(" ")}]}}]},{a:"txt",b:"en = ek ( u_sky_tex_dvar , en , eq , u_sky_tex_fac [ 0 ] ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",e:["WO_SKYBLEND"],h:{a:"grp",d:[{a:"txt",b:"el = mix ( eo , ep , en ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["el","=","eo",";"]}]}}]},{a:"txt",b:["aQ","(","el",")",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"aQ ( eo ) ; aQ ( ep ) ;".split(" ")},{a:"cond",d:[{a:"if",e:["WO_SKYBLEND"],h:{a:"grp",d:[{a:"txt",b:"el = mix ( eo , ep , en ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["el","=","eo",";"]}]}}]}]}}]}]}}]},{a:"cond",d:[{a:"if",e:["WATER_EFFECTS",
"DISABLE_FOG",{a:"logic_negative_expr",i:1},"REFLECTION_PASS","REFL_PASS_NONE",{a:"equal_expr",i:2},{a:"logical_and_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"bY ( el ) ; float eu = WATER_LEVEL - u_camera_eye_frag . z ; vec3 ev = vec3 ( 0.0 ) ; vec3 ew = mix ( u_underwater_fog_color_density . rgb , ev , min ( - dp . z , 1.0 ) ) ; ew *= min ( 1.0 - min ( 0.03 * eu , 0.8 ) , 1.0 ) ; float aF = clamp ( sign ( 0.01 * eu - dp . z ) , 0.0 , 1.0 ) ; el = mix ( el , ew , aF ) ; aQ ( el ) ;".split(" ")}]}}]},{a:"txt",
b:"GLSL_OUT_FRAG_COLOR = vec4 ( el , 1.0 ) ; }".split(" ")}]};a["special_skydome.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PROCEDURAL_SKYDOME",b:["0"]},{a:"var",c:"WO_SKYTEX",b:["0"]},{a:"var",c:"WO_SKYBLEND",b:["0"]},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform mat4 u_sky_vp_inverse ; GLSL_IN vec3 a_position ; GLSL_OUT vec3 cX ;".split(" ")},{a:"cond",d:[{a:"if",e:["PROCEDURAL_SKYDOME",{a:"logic_negative_expr",i:1},"WO_SKYTEX","WO_SKYBLEND",{a:"logical_or_expr",i:2},{a:"logical_and_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec2","n",";"]}]}}]},{a:"txt",b:"void main ( ) { vec4 O = vec4 ( a_position . xy , 0.9999999 , 1.0 ) ; vec4 dp = u_sky_vp_inverse * O ; cX = dp . xyz ;".split(" ")},{a:"cond",d:[{a:"if",e:["PROCEDURAL_SKYDOME",{a:"logic_negative_expr",i:1},"WO_SKYTEX","WO_SKYBLEND",{a:"logical_or_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"n = a_position . xy ;".split(" ")}]}}]},{a:"txt",b:["gl_Position","=","O",";","}"]}]};a["special_water.glslf"]=
{a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"NORM_FOAM0",b:["0"]},{a:"var",c:"NORM_FOAM1",b:["0"]},{a:"var",c:"NORM_FOAM2",b:["0"]},{a:"var",c:"NORM_FOAM3",b:["0"]},{a:"var",c:"DEBUG_WIREFRAME",b:["0"]},{a:"var",c:"NUM_NORMALMAPS",b:["0"]},{a:"var",c:"FOAM",b:["0"]},{a:"var",c:"SHORE_PARAMS",b:["0"]},{a:"var",c:"GENERATED_MESH",b:["0"]},{a:"var",c:"ABSORB",b:["6.0"]},{a:"var",c:"SSS_STRENGTH",
b:["1.0"]},{a:"var",c:"SSS_WIDTH",b:["0.45"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"NUM_LFACTORS",b:["0"]},{a:"var",c:"WAVES_HEIGHT",b:["1.0"]},{a:"var",c:"WATER_LEVEL",b:["0.0"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"var",c:"SHORE_SMOOTHING",b:["0"]},{a:"var",c:"DYNAMIC",b:["0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_COLOR",
b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"pack.glslf"},{a:"include",o:"color_util.glslf"},{a:"include",o:"math.glslv"},{a:"define",c:"REFL_BUMP",b:["0.001"]},{a:"define",c:"REFR_BUMP",b:["0.0005"]},{a:"txt",b:["uniform","float","u_time",";"]},{a:"cond",d:[{a:"if",e:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",i:2}],
h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",e:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{a:"txt",b:["uniform","float","u_environment_energy",";"]},{a:"cond",d:[{a:"if",e:["NUM_LIGHTS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec3 u_light_color_intensities [ NUM_LIGHTS ] ; uniform vec4 u_light_factors [ NUM_LFACTORS ] ;".split(" ")}]}}]},
{a:"txt",b:"uniform vec3 u_sun_intensity ; uniform vec3 u_sun_direction ;".split(" ")},{a:"cond",d:[{a:"if",e:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"SHORE_SMOOTHING","WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2},{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_cam_water_depth",";"]}]}}]},{a:"cond",d:[{a:"if",e:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_color_density",
";"]},{a:"cond",d:[{a:"if",e:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_underwater_fog_color_density",";"]}]}}]},{a:"cond",d:[{a:"if",e:["PROCEDURAL_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_cube_fog",";"]}]}}]},{a:"cond",d:[{a:"if",e:["USE_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",e:["NUM_NORMALMAPS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_normalmap0",";"]}]}}]},{a:"cond",d:[{a:"if",
e:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_refractmap",";"]}]}}]},{a:"cond",d:[{a:"if",e:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_plane_reflection",";"]}]}},{a:"elif",e:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{a:"cond",d:[{a:"if",e:["SHORE_SMOOTHING"],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","sampler2D","u_scene_depth",
";"]}]}}]},{a:"cond",d:[{a:"if",e:["FOAM"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_foam",";"]}]}}]},{a:"txt",b:"uniform vec4 u_diffuse_color ; uniform vec2 u_diffuse_params ; uniform float u_diffuse_intensity ; uniform float u_ambient ; uniform vec4 u_fresnel_params ; uniform vec3 u_specular_color ; uniform vec3 u_specular_params ; uniform vec3 u_shallow_water_col ; uniform vec3 u_shore_water_col ;".split(" ")},{a:"cond",d:[{a:"if",e:["NUM_NORMALMAPS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:"uniform float u_water_norm_uv_velocity ; uniform vec2 u_normalmap0_scale ;".split(" ")},{a:"cond",d:[{a:"if",e:["NUM_NORMALMAPS",1,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec2","u_normalmap1_scale",";"]},{a:"cond",d:[{a:"if",e:["NUM_NORMALMAPS",2,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec2","u_normalmap2_scale",";"]},{a:"cond",d:[{a:"if",e:["NUM_NORMALMAPS",3,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec2","u_normalmap3_scale",";"]}]}}]}]}}]}]}}]}]}}]},
{a:"cond",d:[{a:"if",e:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_mirror_factor",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_reflect_factor",";"]}]}}]},{a:"cond",d:[{a:"if",e:["SHORE_SMOOTHING","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_view_max_depth",";"]}]}}]},{a:"cond",d:[{a:"if",e:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:"uniform float u_water_shallow_col_fac ; uniform float u_water_shore_col_fac ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",e:["FOAM"],h:{a:"grp",d:[{a:"txt",b:"uniform float u_foam_factor ; uniform vec2 u_foam_uv_freq ; uniform vec2 u_foam_mag ; uniform vec2 u_foam_scale ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_refr_bump",";"]}]}}]},{a:"cond",d:[{a:"if",e:["DEBUG_WIREFRAME"],h:{a:"grp",d:[{a:"txt",b:"const float ay = 1.0 ; uniform vec3 u_wireframe_edge_color ;".split(" ")}]}}]},{a:"txt",b:"GLSL_IN vec3 bv ; GLSL_IN vec3 c ;".split(" ")},
{a:"cond",d:[{a:"if",e:["NUM_NORMALMAPS",0,{a:"g_expr",i:2},"FOAM",{a:"logical_or_expr",i:2},"GENERATED_MESH",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","n",";"]}]}}]},{a:"cond",d:[{a:"if",e:["NUM_NORMALMAPS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec3 f ; GLSL_IN vec3 ex ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["DYNAMIC","NUM_NORMALMAPS",0,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3",
"e",";"]}]}}]},{a:"cond",d:[{a:"if",e:["NUM_NORMALMAPS",0,{a:"g_expr",i:2},"FOAM",{a:"logical_or_expr",i:2},"GENERATED_MESH","DYNAMIC",{a:"logical_and_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","ey",";"]}]}}]},{a:"cond",d:[{a:"if",e:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","ez",";"]}]}}]},{a:"cond",d:[{a:"if",e:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","h",
";"]}]}}]},{a:"cond",d:[{a:"if",e:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","i",";"]}]}}]},{a:"cond",d:[{a:"if",e:["DEBUG_WIREFRAME"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","ax",";"]}]}}]},{a:"cond",d:[{a:"if",e:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","o",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",
";"]},{a:"include",o:"environment.glslf"},{a:"cond",d:[{a:"if",e:["REFRACTIVE","SHORE_SMOOTHING","USE_REFRACTION_CORRECTION",{a:"logical_and_expr",i:3}],h:{a:"grp",d:[{a:"include",o:"refraction.glslf"}]}}]},{a:"cond",d:[{a:"if",e:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"fog.glslf"}]}}]},{a:"txt",b:"vec3 eK ( in vec2 eA , in vec3 Q , in vec3 u , in vec3 eB , out float eC ) { eC = 0.0 ; vec3 eD = reflect ( - u , Q ) ;".split(" ")},{a:"cond",d:[{a:"if",e:["REFLECTION_TYPE",
"REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 eE = eA . xy + Q . xy * REFL_BUMP / i ; eC = u_reflect_factor ; vec3 eF ; if ( u_cam_water_depth < 0.0 ) {".split(" ")},{a:"cond",d:[{a:"if",e:["DISABLE_FOG",{a:"logic_negative_expr",i:1},"WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"eF = u_underwater_fog_color_density . rgb ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"eF = u_diffuse_color . rgb ;".split(" ")}]}}]},{a:"txt",b:"} else { eF = GLSL_TEXTURE ( u_plane_reflection , eE ) . rgb ; bY ( eF ) ; }".split(" ")}]}},
{a:"elif",e:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"eC = u_mirror_factor ; vec3 eF = eB * GLSL_TEXTURE_CUBE ( u_mirrormap , eD ) . rgb ; bY ( eF ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"eC = u_reflect_factor ; vec3 eF = eB * vec3 ( 0.3 , 0.5 , 1.0 ) ; bY ( eF ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 eG = normalize ( eD + u ) ; float eH = 1.0 - dot ( u , eG ) ; float eI = u_fresnel_params [ 3 ] ; float eJ = u_fresnel_params [ 2 ] ; float r = eI + ( 1.0 - eI ) * pow ( eH , eJ ) ; eC = min ( eC * r , 1.0 ) ; return eF ; }".split(" ")},
{a:"include",o:"lighting_nodes.glslf"},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",e:["NUM_NORMALMAPS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"mat3 bG = mat3 ( f , ex , e ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["DYNAMIC"],h:{a:"grp",d:[{a:"txt",b:"vec3 Q = normalize ( e ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec3","Q","=","UP_VECTOR",";"]}]}}]},{a:"cond",d:[{a:"if",e:["DYNAMIC","FOAM",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["WATER_EFFECTS"],
h:{a:"grp",d:[{a:"txt",b:"float bp = c . z - WATER_LEVEL ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"float bp = c . z ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",e:["NUM_NORMALMAPS",0,{a:"g_expr",i:2},"FOAM",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["GENERATED_MESH"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["DYNAMIC"],h:{a:"grp",d:[{a:"txt",b:"vec2 bE = vec2 ( ey . x , - ey . y ) + 0.5 ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec2 bE = vec2 ( c . x , - c . y ) + 0.5 ;".split(" ")}]}}]}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec2","bE","=","n",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",e:["NUM_NORMALMAPS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 eL = vec3 ( 0.0 ) ; vec3 eM = GLSL_TEXTURE ( u_normalmap0 , bE * u_normalmap0_scale + vec2 ( 0.3 , 0.5 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; eL += eM ;".split(" ")},{a:"cond",d:[{a:"if",e:["FOAM"],h:{a:"grp",d:[{a:"txt",b:"vec3 eN = vec3 ( 0.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",e:["NORM_FOAM0"],h:{a:"grp",d:[{a:"txt",
b:["eN","+=","eM",";"]}]}}]}]}}]}]}}]},{a:"cond",d:[{a:"if",e:["NUM_NORMALMAPS",1,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"eM = GLSL_TEXTURE ( u_normalmap0 , bE * u_normalmap1_scale + vec2 ( - 0.3 , 0.7 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; eL += eM ;".split(" ")},{a:"cond",d:[{a:"if",e:["FOAM"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["NORM_FOAM1"],h:{a:"grp",d:[{a:"txt",b:["eN","+=","eM",";"]}]}}]}]}}]}]}}]},{a:"cond",d:[{a:"if",e:["NUM_NORMALMAPS",2,{a:"g_expr",i:2}],h:{a:"grp",
d:[{a:"txt",b:"eM = GLSL_TEXTURE ( u_normalmap0 , bE * u_normalmap2_scale + vec2 ( 0.0 , 1.1 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; eL += eM ;".split(" ")},{a:"cond",d:[{a:"if",e:["FOAM"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["NORM_FOAM2"],h:{a:"grp",d:[{a:"txt",b:["eN","+=","eM",";"]}]}}]}]}}]}]}}]},{a:"cond",d:[{a:"if",e:["NUM_NORMALMAPS",3,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"eM = GLSL_TEXTURE ( u_normalmap0 , bE * u_normalmap3_scale + vec2 ( - 0.66 , - 0.3 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; eL += eM ;".split(" ")},
{a:"cond",d:[{a:"if",e:["FOAM"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["NORM_FOAM3"],h:{a:"grp",d:[{a:"txt",b:["eN","+=","eM",";"]}]}}]}]}}]}]}}]},{a:"cond",d:[{a:"if",e:["NUM_NORMALMAPS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["FOAM"],h:{a:"grp",d:[{a:"txt",b:"vec3 eO = bG * eN ; if ( ! eP ( eO , vec3 ( 0.0 ) ) ) eO = normalize ( eO ) ; vec3 eQ = mix ( Q , eO , 0.2 ) ; eQ = normalize ( eQ ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["DYNAMIC"],h:{a:"grp",d:[{a:"txt",b:"Q = mix ( Q , normalize ( bG * eL ) , 0.3 ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"Q = mix ( Q , normalize ( bG * eL ) , 0.5 ) ;".split(" ")}]}}]},{a:"txt",b:"Q = normalize ( Q ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 u = normalize ( bv ) ;".split(" ")},{a:"cond",d:[{a:"if",e:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 eA = h . xy / h . z ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:"vec2 eR = eA + Q . xy * u_refr_bump / i ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",e:["SHORE_SMOOTHING"],h:{a:"grp",d:[{a:"txt",b:"float L = u_diffuse_color . a ; vec4 cu = GLSL_TEXTURE_PROJ ( u_scene_depth , h ) ; float cw = cv ( cu ) ; float cx = max ( cw - i , 0.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",e:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:"float eT = eS ( cw , eR , eA ) ; float eU = max ( eT - i , 0.0 ) ; float eV = u_view_max_depth / ABSORB * eU ; float eW = min ( L * eV , 1.0 ) ; L = min ( 15.0 * L * u_view_max_depth * cx , 1.0 ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"float cy = u_view_max_depth / ABSORB * cx ; if ( u_cam_water_depth > 0.0 ) L = min ( L * cy , 1.0 ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"float L = u_diffuse_color . a ;".split(" ")},{a:"cond",d:[{a:"if",e:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:["float","eW","=","L",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",e:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:"if ( u_cam_water_depth < 0.0 ) eW = 0.0 ; vec3 eX = GLSL_TEXTURE ( u_refractmap , eR ) . rgb ; bY ( eX ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",e:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:"float eY = pow ( min ( ez . b / u_water_shallow_col_fac , 1.0 ) , 0.3 ) ; vec3 bZ = mix ( u_shallow_water_col , u_diffuse_color . rgb , eY ) ; eY = pow ( min ( ez . b / u_water_shore_col_fac , 1.0 ) , 0.3 ) ; bZ = mix ( u_shore_water_col , bZ , eY ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 bZ = u_diffuse_color . rgb ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["FOAM"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["SHORE_SMOOTHING"],
h:{a:"grp",d:[{a:"txt",b:"float eZ = max ( 1.0 - u_view_max_depth * cx , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"float eZ = 1.0 - L ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["DYNAMIC"],h:{a:"grp",d:[{a:"txt",b:"float e_ = max ( bp / WAVES_HEIGHT + 0.1 , 0.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",e:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:"vec3 fa = normalize ( vec3 ( ez . rg , 0.0 ) ) ; vec3 fb = normalize ( mix ( UP_VECTOR , fa , 0.8 ) ) ; float fc = 1.25 * max ( dot ( eQ , fb ) - 0.2 , 0.0 ) ; fc += max ( dot ( eQ , - UP_VECTOR ) , 0.0 ) ; eZ += fc * ( 1.0 - ez . b ) ; e_ *= ( 1.0 - 0.95 * pow ( ez . b , 0.1 ) ) ;".split(" ")}]}}]},
{a:"txt",b:"eZ += e_ ; eZ = min ( u_foam_factor * eZ , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:"vec4 fd = GLSL_TEXTURE ( u_foam , u_foam_mag * sin ( u_foam_uv_freq * u_time ) + bE * u_foam_scale ) ;".split(" ")}]}}]},{a:"txt",b:"float cl = u_specular_params [ 0 ] ; vec2 cm = vec2 ( u_specular_params [ 1 ] , u_specular_params [ 2 ] ) ; vec3 cn = cl * u_specular_color ; vec3 cf = u_environment_energy * ce ( Q ) ; vec3 cg = u_ambient * cf ; vec3 eB = cg + u_sun_intensity ; float eC ;".split(" ")},{a:"cond",
d:[{a:"if",e:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 eF = eK ( eA , Q , u , eB , eC ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 eF = eK ( vec2 ( 0.0 ) , Q , u , eB , eC ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 cd = u_diffuse_intensity * bZ ; vec3 aK ; vec3 co ; cp ( vec3 ( 0.0 ) , vec3 ( 0.0 ) , cd , cn , c , Q , u , cm , u_diffuse_params , vec4 ( 1.0 ) , 0.0 , vec4 ( 0.0 ) , aK , co ) ;".split(" ")},{a:"cond",d:[{a:"if",e:["DYNAMIC"],h:{a:"grp",
d:[{a:"txt",b:"float fe = max ( dot ( u_sun_direction , - e ) + SSS_WIDTH , 0.0 ) * max ( dot ( - u , u_sun_direction ) - 0.5 , 0.0 ) * max ( 0.0 , length ( u_sun_intensity ) - 0.1 ) ; fe = clamp ( SSS_STRENGTH * fe , 0.0 , 1.0 ) ; aK = mix ( aK , u_shallow_water_col , fe ) ; aK = mix ( aK , u_shore_water_col , fe ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:"aK = mix ( eX , aK , eW ) ;".split(" ")}]}}]},{a:"txt",b:"aK = mix ( aK , eF , eC ) ;".split(" ")},
{a:"cond",d:[{a:"if",e:["FOAM"],h:{a:"grp",d:[{a:"txt",b:"float ff = mix ( fd . g , fd . r , max ( 4.0 * ( eZ - 0.75 ) , 0.0 ) ) ; ff = mix ( fd . b , ff , max ( 2.0 * eZ - 1.0 , 0.0 ) ) ; ff = mix ( 0.0 , ff , eZ ) ; aK = mix ( aK , eB , ff ) ;".split(" ")}]}}]},{a:"txt",b:["aK","+=","co",";"]},{a:"cond",d:[{a:"if",e:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float fg = i * u_view_max_depth ; float fh = 1.0 ; if ( u_cam_water_depth > 1.0 ) fh = 2.0 ; bt ( aK , fg , u , fh ) ;".split(" ")}]}}]},
{a:"txt",b:["aQ","(","aK",")",";"]},{a:"cond",d:[{a:"if",e:["REFRACTIVE",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"L = max ( L , co . r ) ;".split(" ")},{a:"cond",d:[{a:"if",e:["FOAM"],h:{a:"grp",d:[{a:"txt",b:["L","+=","ff",";"]}]}}]}]}},{a:"elif",e:["SHORE_SMOOTHING",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["L","=","1.0",";"]}]}}]},{a:"cond",d:[{a:"if",e:["ALPHA"],h:{a:"grp",d:[{a:"txt",b:"aR ( aK , L ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["DEBUG_WIREFRAME",
1,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["GLSL1"],h:{a:"grp",d:[{a:"extension",b:["GL_OES_standard_derivatives",":","enable"]}]}}]},{a:"txt",b:"vec3 aH = fwidth ( ax ) ; vec3 aI = smoothstep ( vec3 ( 0.0 ) , aH * ay , ax ) ; float fi = min ( min ( aI . x , aI . y ) , aI . z ) ; fi = clamp ( fi , 0.0 , 1.0 ) ; aK = mix ( u_wireframe_edge_color , aK , fi ) ; L = mix ( 1.0 , L , fi ) ;".split(" ")}]}},{a:"elif",e:["DEBUG_WIREFRAME",2,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:"vec3 aG = sign ( ax - vec3 ( 0.02 * ay ) ) ; float fi = 1.0 ; if ( aG . x < 0.0 || aG . y < 0.0 || aG . z < 0.0 ) fi = 0.0 ; aK = mix ( u_wireframe_edge_color , aK , fi ) ; L = mix ( 1.0 , L , fi ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aK , L ) ; }".split(" ")}]};a["special_water.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"DEBUG_WIREFRAME",b:["0"]},{a:"var",c:"NUM_NORMALMAPS",b:["0"]},
{a:"var",c:"FOAM",b:["0"]},{a:"var",c:"SHORE_PARAMS",b:["0"]},{a:"var",c:"MAX_SHORE_DIST",b:["100.0"]},{a:"var",c:"SHORE_MAP_SIZE_X",b:["1.0"]},{a:"var",c:"SHORE_MAP_SIZE_Y",b:["1.0"]},{a:"var",c:"SHORE_MAP_CENTER_X",b:["0.0"]},{a:"var",c:"SHORE_MAP_CENTER_Y",b:["0.0"]},{a:"var",c:"GENERATED_MESH",b:["0"]},{a:"var",c:"DST_NOISE_SCALE_0",b:["0.05"]},{a:"var",c:"DST_NOISE_SCALE_1",b:["0.03"]},{a:"var",c:"DST_NOISE_FREQ_0",b:["1.3"]},{a:"var",c:"DST_NOISE_FREQ_1",b:["1.0"]},{a:"var",c:"DIR_MIN_SHR_FAC",
b:["0.4"]},{a:"var",c:"DIR_FREQ",b:["0.5"]},{a:"var",c:"DIR_NOISE_SCALE",b:["0.05"]},{a:"var",c:"DIR_NOISE_FREQ",b:["0.07"]},{a:"var",c:"DIR_MIN_NOISE_FAC",b:["0.5"]},{a:"var",c:"DST_MIN_FAC",b:["0.2"]},{a:"var",c:"WAVES_HOR_FAC",b:["5.0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"WAVES_HEIGHT",b:["1.0"]},{a:"var",c:"WAVES_LENGTH",b:["10.0"]},{a:"var",c:"WATER_LEVEL",b:["0.0"]},{a:"var",c:"SHORE_SMOOTHING",b:["0"]},{a:"var",c:"DYNAMIC",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",
c:"REFRACTIVE",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"include",o:"procedural.glslf"},{a:"txt",b:["GLSL_IN","vec3","a_position",";"]},{a:"cond",d:[{a:"if",e:["NUM_NORMALMAPS",0,{a:"g_expr",i:2},"DYNAMIC",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_tbn_quat",";"]}]}}]},{a:"cond",d:[{a:"if",e:["GENERATED_MESH",
{a:"logic_negative_expr",i:1},"NUM_NORMALMAPS",0,{a:"g_expr",i:2},"FOAM",{a:"logical_or_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","a_texcoord",";"]}]}}]},{a:"cond",d:[{a:"if",e:["DEBUG_WIREFRAME"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","a_polyindex",";"]}]}}]},{a:"txt",b:"GLSL_OUT vec3 bv ; GLSL_OUT vec3 c ;".split(" ")},{a:"cond",d:[{a:"if",e:["NUM_NORMALMAPS",0,{a:"g_expr",i:2},"FOAM",{a:"logical_or_expr",i:2},"GENERATED_MESH",{a:"logic_negative_expr",
i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec2","n",";"]}]}}]},{a:"cond",d:[{a:"if",e:["NUM_NORMALMAPS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT vec3 f ; GLSL_OUT vec3 ex ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["DYNAMIC","NUM_NORMALMAPS",0,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","e",";"]}]}}]},{a:"cond",d:[{a:"if",e:["NUM_NORMALMAPS",0,{a:"g_expr",i:2},"FOAM",{a:"logical_or_expr",i:2},"GENERATED_MESH","DYNAMIC",
{a:"logical_and_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","ey",";"]}]}}]},{a:"cond",d:[{a:"if",e:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","ez",";"]}]}}]},{a:"cond",d:[{a:"if",e:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","h",";"]}]}}]},{a:"cond",d:[{a:"if",e:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE","DISABLE_FOG",
{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","float","i",";"]}]}}]},{a:"cond",d:[{a:"if",e:["DEBUG_WIREFRAME"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","ax",";"]}]}}]},{a:"cond",d:[{a:"if",e:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","o",";"]}]}}]},{a:"cond",d:[{a:"if",e:["STATIC_BATCH"],h:{a:"grp",d:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",
h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform vec3 u_camera_eye ;".split(" ")},{a:"cond",d:[{a:"if",e:["DYNAMIC"],h:{a:"grp",d:[{a:"txt",b:"uniform PRECISION float u_time ; uniform vec3 u_wind ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",
b:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]},{a:"cond",d:[{a:"if",e:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_shore_dist_map",";"]}]}}]},{a:"cond",d:[{a:"if",e:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:"vec3 fp ( in vec2 fj ) { vec2 fk = 0.5 + vec2 ( ( fj . x - SHORE_MAP_CENTER_X ) / SHORE_MAP_SIZE_X , ( fj . y - SHORE_MAP_CENTER_Y ) / SHORE_MAP_SIZE_Y ) ; vec4 fl = GLSL_TEXTURE ( u_shore_dist_map , fk ) ; const vec2 fm = vec2 ( 1.0 / 255.0 , 1.0 ) ; float fn = dot ( fl . ba , fm ) ; vec2 fo = normalize ( fl . rg * 2.0 - 1.0 ) ; return vec3 ( fo , fn ) ; }".split(" ")}]}}]},
{a:"cond",d:[{a:"if",e:["DYNAMIC"],h:{a:"grp",d:[{a:"define",c:"SMALL_WAVES_FAC",b:["0.3"]},{a:"txt",b:"void fE ( inout vec3 fj , in float fq , in vec3 fl ) { float fs = fr ( DST_NOISE_SCALE_0 * ( fj . xy + DST_NOISE_FREQ_0 * fq ) ) * fr ( DST_NOISE_SCALE_1 * ( fj . yx - DST_NOISE_FREQ_1 * fq ) ) ;".split(" ")},{a:"cond",d:[{a:"if",e:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:"float ft = WAVES_LENGTH / MAX_SHORE_DIST / M_PI ; float fn = fl . b ; float fu = sqrt ( fn ) ; float fv = max ( fn , DIR_MIN_SHR_FAC ) * sin ( fu / ft + DIR_FREQ * fq ) ; float fw = max ( fr ( DIR_NOISE_SCALE * ( fj . xy + DIR_NOISE_FREQ * fq ) ) , DIR_MIN_NOISE_FAC ) ; fv *= fw ; float fx = WAVES_HEIGHT * mix ( fv , fs , max ( fu , DST_MIN_FAC ) ) ; vec2 fo = fl . rg ; float fy = WAVES_HOR_FAC * fv * max ( MAX_SHORE_DIST / 35.0 * ( 0.05 - fn ) , 0.0 ) ; vec2 fz = fy * fo ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"float fx = WAVES_HEIGHT * fs ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["GENERATED_MESH"],h:{a:"grp",d:[{a:"txt",b:"vec2 fA = 2.0 * ( fj . xy - 0.1 * fq ) ; vec2 fB = 1.3 * ( fj . yx + 0.03 * fq ) ; float fD = fC ( 0.5 * fA ) . x + fC ( 0.5 * fB ) . x - 1.0 ;".split(" ")},{a:"cond",d:[{a:"if",e:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:"fj . xy += fz ; fD *= fn ;".split(" ")}]}}]},{a:"txt",b:"fx += SMALL_WAVES_FAC * fD ;".split(" ")}]}}]},{a:"txt",b:"fj . z += fx ; }".split(" ")}]}}]},
{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",e:["DEBUG_WIREFRAME"],h:{a:"grp",d:[{a:"txt",b:"if ( a_polyindex == 0.0 ) ax = vec3 ( 1.0 , 0.0 , 0.0 ) ; else if ( a_polyindex == 1.0 ) ax = vec3 ( 0.0 , 1.0 , 0.0 ) ; else if ( a_polyindex == 2.0 ) ax = vec3 ( 0.0 , 0.0 , 1.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["GENERATED_MESH"],h:{a:"grp",d:[{a:"txt",b:"vec3 O = a_position ; float fF = abs ( O . z ) ; vec2 fG = u_camera_eye . xy - mod ( u_camera_eye . xy , fF ) ;".split(" ")},
{a:"cond",d:[{a:"if",e:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"O . z = WATER_LEVEL ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"O . z = 0.0 ;".split(" ")}]}}]},{a:"txt",b:"O . xy += fG ; vec3 bz = O ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["NUM_NORMALMAPS",0,{a:"g_expr",i:2},"FOAM",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["n","=","a_texcoord",";"]}]}}]},{a:"txt",b:"ak am = al ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , u_model_tsr ) ; vec3 bz = am . O ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",e:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:"ez = fp ( bz . xy ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["DYNAMIC"],h:{a:"grp",d:[{a:"txt",b:"float fH = length ( u_wind ) ; float fI = u_time ; fI *= fH ;".split(" ")},{a:"cond",d:[{a:"if",e:["GENERATED_MESH"],h:{a:"grp",d:[{a:"txt",b:"float fJ = fF ; vec3 fK = bz + vec3 ( fJ , 0.0 , 0.0 ) ; vec3 fL = bz + vec3 ( 0.0 , fJ , 0.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",e:["NUM_NORMALMAPS",0,{a:"g_expr",i:2},"FOAM",{a:"logical_or_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["ey","=","bz",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 fK = bz + vec3 ( 0.05 , 0.0 , 0.0 ) ; vec3 fL = bz + vec3 ( 0.0 , 0.05 , 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:"vec3 fM = fp ( fK . xy ) ; vec3 fN = fp ( fL . xy ) ; fE ( fK , fI , fM ) ; fE ( fL , fI , fN ) ; fE ( bz , fI , ez ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"fE ( fK , fI , vec3 ( 0.0 ) ) ; fE ( fL , fI , vec3 ( 0.0 ) ) ; fE ( bz , fI , vec3 ( 0.0 ) ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",e:["GENERATED_MESH","WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( a_position . z < 0.0 ) {".split(" ")},{a:"cond",d:[{a:"if",e:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"bz . z = WATER_LEVEL - 1.0 ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"bz . z = - 1.0 ;".split(" ")}]}}]},{a:"txt",b:"fK . z = bz . z ; fL . z = bz . z ; }".split(" ")}]}}]},{a:"txt",b:"vec3 fO = normalize ( fK - bz ) ; vec3 R = normalize ( fL - bz ) ; e = normalize ( cross ( fO , R ) ) ; float fP = dot ( e , UP_VECTOR ) ; float aF = clamp ( 0.8 - fP , 0.0 , 1.0 ) ; e = mix ( e , UP_VECTOR , aF ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",e:["NUM_NORMALMAPS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["DYNAMIC",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"vec3 R = P ( a_tbn_quat , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; e = P ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")}]}}]},{a:"txt",b:"f = R ; ex = cross ( e , f ) ;".split(" ")}]}}]},{a:"txt",b:"c = bz ; bv = u_camera_eye - bz ; vec4 bB = vec4 ( ae ( u_view_tsr , bz ) , 1.0 ) ; vec4 at = u_proj_matrix * bB ;".split(" ")},{a:"cond",d:[{a:"if",
e:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"float au = at . x ; float av = at . y ; float aw = at . w ; h . x = ( au + aw ) / 2.0 ; h . y = ( av + aw ) / 2.0 ; h . z = aw ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:"i = - bB . z / u_view_max_depth ;".split(" ")}]}}]},
{a:"txt",b:["gl_Position","=","at",";","}"]}]};a["postprocessing/antialiasing.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"AA_METHOD",b:["AA_METHOD_FXAA_LIGHT"]},{a:"var",c:"AA_QUALITY",b:["AA_QUALITY_LOW"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"txt",b:"uniform sampler2D u_color ; uniform vec2 u_texel_size ; GLSL_IN vec2 n ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},{a:"cond",d:[{a:"if",e:["AA_METHOD",
"AA_METHOD_FXAA_LIGHT",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_REDUCE_MIN",b:["(","1.0","/","128.0",")"]},{a:"define",c:"FXAA_REDUCE_MUL",b:["(","1.0","/","8.0",")"]},{a:"define",c:"FXAA_SPAN_MAX",b:["8.0"]},{a:"txt",b:"vec4 fR ( float x , float y ) { vec2 fQ = n + vec2 ( x , y ) * u_texel_size ; return GLSL_TEXTURE ( u_color , fQ ) ; } vec4 gl ( ) { vec4 fS = fR ( - 1.0 , - 1.0 ) ; vec4 fT = fR ( 1.0 , - 1.0 ) ; vec4 fU = fR ( - 1.0 , 1.0 ) ; vec4 fV = fR ( 1.0 , 1.0 ) ; vec4 fW = fR ( 0.0 , 0.0 ) ; float fX = es ( fW ) ; float fY = es ( fS ) ; float fZ = es ( fT ) ; float f_ = es ( fU ) ; float gc = es ( fV ) ; float gd = min ( fX , min ( min ( fY , fZ ) , min ( f_ , gc ) ) ) ; float ge = max ( fX , max ( max ( fY , fZ ) , max ( f_ , gc ) ) ) ; vec2 da ; da . x = - ( ( fY + fZ ) - ( f_ + gc ) ) ; da . y = ( ( fY + f_ ) - ( fZ + gc ) ) ; float gf = max ( ( fY + fZ + f_ + gc ) * ( 0.25 * FXAA_REDUCE_MUL ) , FXAA_REDUCE_MIN ) ; float gh = 1.0 / ( min ( abs ( da . x ) , abs ( da . y ) ) + gf ) ; da = min ( vec2 ( FXAA_SPAN_MAX , FXAA_SPAN_MAX ) , max ( vec2 ( - FXAA_SPAN_MAX , - FXAA_SPAN_MAX ) , da * gh ) ) * u_texel_size ; vec4 gi = 0.5 * ( GLSL_TEXTURE ( u_color , n + da * ( 1.0 / 3.0 - 0.5 ) ) + GLSL_TEXTURE ( u_color , n + da * ( 2.0 / 3.0 - 0.5 ) ) ) ; vec4 gj = gi * 0.5 + 0.25 * ( GLSL_TEXTURE ( u_color , n + da * - 0.5 ) + GLSL_TEXTURE ( u_color , n + da * 0.5 ) ) ; float gk = es ( gj ) ; if ( ( gk < gd ) || ( gk > ge ) ) return gi ; else return gj ; }".split(" ")}]}},
{a:"elif",e:["AA_METHOD","AA_METHOD_FXAA_QUALITY",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_GREEN_AS_LUMA",b:["1"]},{a:"include",o:"fxaa.glslf"},{a:"cond",d:[{a:"if",e:["AA_QUALITY","AA_QUALITY_HIGH",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PRESET",b:["39"]},{a:"define",c:"FXAA_QUALITY_SUBPIX",b:["1.00"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD",b:["0.063"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD_MIN",b:["0.0312"]}]}},{a:"elif",e:["AA_QUALITY","AA_QUALITY_MEDIUM",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PRESET",b:["20"]},{a:"define",c:"FXAA_QUALITY_SUBPIX",b:["0.65"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD",b:["0.166"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD_MIN",b:["0.0625"]}]}},{a:"elif",e:["AA_QUALITY","AA_QUALITY_LOW",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PRESET",b:["12"]},{a:"define",c:"FXAA_QUALITY_SUBPIX",b:["0.50"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD",b:["0.166"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD_MIN",
b:["0.0833"]}]}}]}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",e:["AA_METHOD","AA_METHOD_FXAA_LIGHT",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = gl ( ) ;".split(" ")}]}},{a:"elif",e:["AA_METHOD","AA_METHOD_FXAA_QUALITY",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 gm = u_texel_size ; GLSL_OUT_FRAG_COLOR = gn ( n , u_color , gm , FXAA_QUALITY_SUBPIX , FXAA_QUALITY_EDGE_THRESHOLD , FXAA_QUALITY_EDGE_THRESHOLD_MIN ) ;".split(" ")}]}}]},{a:"txt",
b:["}"]}]};a["postprocessing/bloom_blur.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform vec2 u_texel_size ; uniform sampler2D u_color ; GLSL_IN vec2 n ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec2 fE = vec2 ( 0.0 , 0.0 ) ; vec2 cx = u_texel_size ; vec4 go = GLSL_TEXTURE ( u_color , n ) ; GLSL_OUT_FRAG_COLOR = go * 0.0875447373698 ; fE += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , n + fE ) * 0.0858112354248 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , n - fE ) * 0.0858112354248 ; fE += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , n + fE ) * 0.0808139781061 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , n - fE ) * 0.0808139781061 ; fE += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , n + fE ) * 0.0731235112908 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , n - fE ) * 0.0731235112908 ; fE += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , n + fE ) * 0.0635705267419 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , n - fE ) * 0.0635705267419 ; fE += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , n + fE ) * 0.0530985673112 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , n - fE ) * 0.0530985673112 ; fE += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , n + fE ) * 0.0426125984122 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , n - fE ) * 0.0426125984122 ; fE += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , n + fE ) * 0.0328565115809 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , n - fE ) * 0.0328565115809 ; fE += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , n + fE ) * 0.0243407024472 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , n - fE ) * 0.0243407024472 ; GLSL_OUT_FRAG_COLOR = max ( 0.7 * go , GLSL_OUT_FRAG_COLOR ) ; }".split(" ")}]};
a["postprocessing/bloom_combine.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform sampler2D u_main ; uniform sampler2D u_bloom ; GLSL_IN vec2 n ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 gp = GLSL_TEXTURE ( u_main , n ) ; vec4 gq = GLSL_TEXTURE ( u_bloom , n ) ; GLSL_OUT_FRAG_COLOR = gp + gq ; }".split(" ")}]};a["postprocessing/coc.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",
c:"PRECISION",b:["highp"]},{a:"var",c:"COC_TYPE",b:["COC_ALL"]},{a:"txt",b:["precision","PRECISION","sampler2D",";"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"depth_fetch.glslf"},{a:"txt",b:"uniform sampler2D u_color ; uniform sampler2D u_depth ;".split(" ")},{a:"cond",d:[{a:"if",e:["COC_TYPE","COC_COMBINE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_coc_fg",";"]}]}}]},{a:"txt",b:"uniform float u_view_max_depth ; uniform float u_dof_dist ; uniform float u_dof_front_start ; uniform float u_dof_front_end ; uniform float u_dof_rear_start ; uniform float u_dof_rear_end ; uniform vec2 u_camera_range ; GLSL_IN vec2 n ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 aK = GLSL_TEXTURE ( u_color , n ) ; if ( u_dof_dist > 0.0 ) { float gt = gs ( u_depth , n , u_camera_range ) ; gt *= u_view_max_depth ; float gu = 0.0 ;".split(" ")},
{a:"cond",d:[{a:"if",e:["COC_TYPE","COC_COMBINE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 gv = GLSL_TEXTURE ( u_coc_fg , n ) ; float gw = gv . a ;".split(" ")}]}}]},{a:"txt",b:"if ( gt < u_dof_dist ) gu = ( u_dof_dist - gt - u_dof_front_start ) / ( u_dof_front_end - u_dof_front_start ) ;".split(" ")},{a:"cond",d:[{a:"if",e:["COC_TYPE","COC_FOREGROUND",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"else gu = ( gt - u_dof_dist - u_dof_rear_start ) / ( u_dof_rear_end - u_dof_rear_start ) ;".split(" ")}]}}]},
{a:"txt",b:"gu = clamp ( gu , 0.0 , 1.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",e:["COC_TYPE","COC_COMBINE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"gu = max ( gu , gw ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["COC_TYPE","COC_FOREGROUND",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( gu ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aK . xyz * gu , gu ) ;".split(" ")}]}}]},{a:"txt",b:"} else GLSL_OUT_FRAG_COLOR = vec4 ( aK . xyz , 0.0 ) ; }".split(" ")}]};
a["postprocessing/compositing.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"txt",b:"uniform sampler2D u_color ; uniform float u_brightness ; uniform float u_contrast ; uniform float u_exposure ; uniform float u_saturation ; GLSL_IN vec2 n ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 gx = GLSL_TEXTURE ( u_color , n ) ; vec3 aK = gx . rgb ; if ( u_brightness < 0.0 ) aK = aK * ( 1.0 + u_brightness ) ; else aK = aK + ( ( 1.0 - aK ) * u_brightness ) ; aK = ( aK - 0.5 ) * ( tan ( ( u_contrast + 1.0 ) * M_PI_4 ) ) + 0.5 ; aK *= u_exposure ; float cZ = es ( vec4 ( aK , 0.0 ) ) ; aK = mix ( vec3 ( cZ ) , aK , u_saturation ) ; GLSL_OUT_FRAG_COLOR = vec4 ( aK , gx . a ) ; }".split(" ")}]};
a["postprocessing/depth_pack.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"txt",b:["precision","PRECISION","sampler2D",";"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"pack.glslf"},{a:"include",o:"depth_fetch.glslf"},{a:"txt",b:"uniform sampler2D u_depth ; uniform vec2 u_camera_range ; GLSL_IN vec2 n ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { GLSL_OUT_FRAG_COLOR = gy ( clamp ( gs ( u_depth , n , u_camera_range ) , 0.0 , 0.999999 ) ) ; }".split(" ")}]};
a["postprocessing/dof.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"DOF_TYPE",b:["DOF_SIMPLE"]},{a:"txt",b:["precision","PRECISION","sampler2D",";"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",e:["DOF_TYPE","DOF_BOKEH",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform highp sampler2D u_sharp ; uniform highp sampler2D u_blurred1 ; uniform highp sampler2D u_blurred2 ; uniform float u_dof_dist ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"include",o:"depth_fetch.glslf"},{a:"txt",b:"uniform sampler2D u_sharp ; uniform sampler2D u_blurred ; uniform sampler2D u_depth ; uniform float u_view_max_depth ; uniform float u_dof_dist ; uniform float u_dof_front_end ; uniform float u_dof_rear_end ; uniform vec2 u_camera_range ;".split(" ")}]}}]},{a:"txt",b:"GLSL_IN vec2 n ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 gz = GLSL_TEXTURE ( u_sharp , n ) ; if ( u_dof_dist > 0.0 ) {".split(" ")},{a:"cond",d:[{a:"if",
e:["DOF_TYPE","DOF_BOKEH",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float gu ; vec4 gA = GLSL_TEXTURE ( u_blurred1 , n ) ; vec4 gB = GLSL_TEXTURE ( u_blurred2 , n ) ; vec4 gC = min ( gA . rgba , gB . rgba ) ; gu = gC . a ; if ( gu > 0.0 ) { gC = vec4 ( gC . rgb / gu , gz . a ) ; GLSL_OUT_FRAG_COLOR = mix ( gz , gC , min ( gu * 5.0 , 1.0 ) ) ; } else GLSL_OUT_FRAG_COLOR = gz ;".split(" ")}]}},{a:"elif",e:["DOF_TYPE","DOF_SIMPLE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float gt = gs ( u_depth , n , u_camera_range ) ; gt *= u_view_max_depth ; float gD ; if ( gt < u_dof_dist ) gD = ( u_dof_dist - gt ) / u_dof_front_end ; else gD = ( gt - u_dof_dist ) / u_dof_rear_end ; gD = clamp ( gD , 0.0 , 1.0 ) ; vec4 gE = GLSL_TEXTURE ( u_blurred , n ) ; GLSL_OUT_FRAG_COLOR = mix ( gz , gE , gD ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT_FRAG_COLOR","=","gz",";"]}]}}]},{a:"txt",b:"} else GLSL_OUT_FRAG_COLOR = gz ; }".split(" ")}]};a["postprocessing/glow.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform sampler2D u_src_color ; uniform sampler2D u_glow_mask_small ; uniform sampler2D u_glow_mask_large ; uniform float u_glow_mask_small_coeff ; uniform float u_glow_mask_large_coeff ; GLSL_IN vec2 n ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 gF = GLSL_TEXTURE ( u_src_color , n ) ; vec4 gG = GLSL_TEXTURE ( u_glow_mask_small , n ) ; vec4 gH = GLSL_TEXTURE ( u_glow_mask_large , n ) ; GLSL_OUT_FRAG_COLOR = gF ; if ( gH . a != 0.0 ) { float gI = u_glow_mask_large_coeff * gH . a ; gI = clamp ( gI , 0.0 , 1.0 ) ; GLSL_OUT_FRAG_COLOR . rgb = mix ( GLSL_OUT_FRAG_COLOR . rgb , gH . rgb / gH . a , gI ) ; GLSL_OUT_FRAG_COLOR . a = mix ( GLSL_OUT_FRAG_COLOR . a , 1.0 , gI ) ; } if ( gG . a != 0.0 ) { float gJ = u_glow_mask_small_coeff * gG . a ; gJ = clamp ( gJ , 0.0 , 1.0 ) ; GLSL_OUT_FRAG_COLOR . rgb = mix ( GLSL_OUT_FRAG_COLOR . rgb , gG . rgb / gG . a , gJ ) ; GLSL_OUT_FRAG_COLOR . a = mix ( GLSL_OUT_FRAG_COLOR . a , 1.0 , gJ ) ; } }".split(" ")}]};
a["postprocessing/god_rays.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"DEPTH_RGBA",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"STEPS_PER_PASS",b:["10.0"]},{a:"txt",b:["precision","PRECISION","sampler2D",";"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"depth_fetch.glslf"},{a:"include",o:"procedural.glslf"},{a:"include",o:"pack.glslf"},{a:"txt",b:"uniform float u_time ; uniform float u_radial_blur_step ; uniform sampler2D u_input ;".split(" ")},
{a:"cond",d:[{a:"if",e:["DEPTH_RGBA"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec2","u_camera_range",";"]}]}}]},{a:"cond",d:[{a:"if",e:["DEPTH_RGBA","WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN float gK ; GLSL_IN vec2 gL ;".split(" ")}]}}]},{a:"txt",b:"GLSL_IN vec2 n ; GLSL_IN vec4 gM ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec2 cx = ( gM . xy - n ) ; float aG = length ( cx ) ; vec2 gN = u_radial_blur_step * cx / aG ; float gO = aG / u_radial_blur_step ; gN *= min ( gO , STEPS_PER_PASS ) / STEPS_PER_PASS ; gO = max ( gO , STEPS_PER_PASS ) ; vec2 gP = n ; float gQ = 0.0 ; const int gR = int ( STEPS_PER_PASS ) ; int gS = int ( gO + 0.5 ) ; for ( int bQ = 0 ; bQ < gR ; bQ += 1 ) { if ( bQ <= gS ) {".split(" ")},
{a:"cond",d:[{a:"if",e:["DEPTH_RGBA"],h:{a:"grp",d:[{a:"txt",b:"float gt = gs ( u_input , gP , u_camera_range ) ; gQ += max ( ( 1.0 - pow ( aG , 0.3 ) ) * step ( 0.9 , gt ) , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 gT = GLSL_TEXTURE ( u_input , gP ) ; gQ += cv ( gT ) ;".split(" ")}]}}]},{a:"txt",b:"} gP += gN ; }".split(" ")},{a:"cond",d:[{a:"if",e:["DEPTH_RGBA","WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 bE = n + gL ; float gU = fC ( vec2 ( 2.5 * ( bE . x ) , 2.5 * ( bE . y ) + 1.0 * u_time ) ) . x + 0.75 * fC ( vec2 ( 5.0 * ( bE . x ) - 0.66 * u_time , 5.0 * ( bE . y ) + 0.66 * u_time ) ) . x + 0.5 * fr ( vec2 ( 7.5 * ( bE . x ) + 0.33 * u_time , 7.5 * ( bE . y ) - 0.33 * u_time ) ) ; gU *= clamp ( 1.2 - sqrt ( 0.2 * aG ) , 0.0 , 1.0 ) * gK ; gQ = max ( gU , gQ ) ;".split(" ")}]}}]},
{a:"txt",b:"GLSL_OUT_FRAG_COLOR = gy ( gQ / STEPS_PER_PASS ) ; }".split(" ")}]};a["postprocessing/god_rays.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"DEPTH_RGBA",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"txt",b:"uniform mat4 u_view_proj_matrix ; uniform vec3 u_sun_direction ;".split(" ")},{a:"cond",d:[{a:"if",e:["DEPTH_RGBA","WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_camera_quat ; uniform float u_cam_water_depth ;".split(" ")}]}}]},
{a:"txt",b:["GLSL_IN","vec2","a_bb_vertex",";"]},{a:"cond",d:[{a:"if",e:["DEPTH_RGBA","WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT float gK ; GLSL_OUT vec2 gL ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT vec2 n ; GLSL_OUT vec4 gM ; void main ( ) { n = a_bb_vertex + 0.5 ; vec3 da = normalize ( u_sun_direction ) ; gM = u_view_proj_matrix * vec4 ( da , 0.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",e:["DEPTH_RGBA","WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:"if ( u_cam_water_depth < 0.0 ) { gK = 1.0 ; vec3 gV = vec3 ( 0.0 , 1.0 , 0.0 ) ; vec3 gW = P ( u_camera_quat , gV ) ; gW = normalize ( gW ) ; float gX = dot ( gW , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; float gY = atan ( gW . x , gW . z ) ; gL = vec2 ( - gY , acos ( gX ) ) ; } else { gK = 0.0 ; }".split(" ")}]}}]},{a:"txt",b:"gM . xy = 0.5 * ( gM . xy / gM . w + 1.0 ) ; gM += 99999.0 * step ( gM . z , 0.0 ) ; gl_Position = vec4 ( 2.0 * a_bb_vertex . xy , 0.0 , 1.0 ) ; }".split(" ")}]};a["postprocessing/god_rays_combine.glslf"]=
{a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"SAFARI_CANVAS_ALPHA_HACK",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"include",o:"pack.glslf"},{a:"txt",b:"uniform sampler2D u_main ; uniform sampler2D u_god_rays ; uniform float u_god_rays_intensity ; uniform vec3 u_sun_intensity ; GLSL_IN vec2 n ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 gZ = GLSL_TEXTURE ( u_main , n ) ; vec3 g_ = clamp ( u_sun_intensity , 0.4 , 0.8 ) ; bY ( gZ . rgb ) ; float ha = cv ( GLSL_TEXTURE ( u_god_rays , n ) ) ; vec3 hb = gZ . rgb + u_god_rays_intensity * vec3 ( ha ) * g_ ; aQ ( hb ) ;".split(" ")},
{a:"cond",d:[{a:"if",e:["SAFARI_CANVAS_ALPHA_HACK"],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( hb , max ( 0.01 , gZ . a ) ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( hb , gZ . a ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]};a["postprocessing/luminance.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform sampler2D u_input ; GLSL_IN vec2 n ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 gp = GLSL_TEXTURE ( u_input , n ) ; float hc = dot ( gp . rgb , vec3 ( 0.2126 , 0.7152 , 0.0722 ) ) ; GLSL_OUT_FRAG_COLOR = vec4 ( vec3 ( hc ) , 1.0 ) ; }".split(" ")}]};
a["postprocessing/luminance_av.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform sampler2D u_input ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { float hc ; float hd = 0.0 ; float w = 0.025 ; float bO = 0.025 ; for ( int bQ = 0 ; bQ < 20 ; bQ += 1 ) { bO = 0.025 ; for ( int he = 0 ; he < 20 ; he += 1 ) { hc = max ( GLSL_TEXTURE ( u_input , vec2 ( w , bO ) ) . r , 0.01 ) ; hd += log ( hc ) ; bO += 0.05 ; } w += 0.05 ; } float hf = exp ( hd / 400.0 ) ; GLSL_OUT_FRAG_COLOR = vec4 ( vec3 ( hf ) , 1.0 ) ; }".split(" ")}]};
a["postprocessing/luminance_trunced.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform sampler2D u_main ; uniform sampler2D u_luminance ; uniform sampler2D u_average_lum ; uniform float u_bloom_edge_lum ; GLSL_IN vec2 n ; GLSL_IN float hg ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { float hf = GLSL_TEXTURE ( u_average_lum , vec2 ( 0.5 ) ) . r ; float hh = GLSL_TEXTURE ( u_luminance , n ) . r ; vec4 aK = GLSL_TEXTURE ( u_main , n ) ; float hi = hh / hf ; float hj = u_bloom_edge_lum ; GLSL_OUT_FRAG_COLOR = aK * max ( hi - hj , 0.0 ) * hg ; }".split(" ")}]};
a["postprocessing/luminance_trunced.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform vec4 u_camera_quat ; uniform vec3 u_sun_direction ; uniform float u_bloom_key ; GLSL_IN vec2 a_position ; GLSL_OUT vec2 n ; GLSL_OUT float hg ; void hr ( in vec4 hk , in vec3 hl , out vec3 hm ) { float hn = hk . w * hl . x + hk . y * hl . z - hk . z * hl . y ; float ho = hk . w * hl . y + hk . z * hl . x - hk . x * hl . z ; float hp = hk . w * hl . z + hk . x * hl . y - hk . y * hl . x ; float hq = - hk . x * hl . x - hk . y * hl . y - hk . z * hl . z ; hm . x = hn * hk . w - hq * hk . x - ho * hk . z + hp * hk . y ; hm . y = ho * hk . w - hq * hk . y - hp * hk . x + hn * hk . z ; hm . z = hp * hk . w - hq * hk . z - hn * hk . y + ho * hk . x ; } void main ( ) { n = 2.0 * a_position ; vec3 gW ; hr ( u_camera_quat , UP_VECTOR , gW ) ; hg = dot ( - gW , u_sun_direction ) * u_bloom_key ; hg *= max ( sign ( u_sun_direction . z ) , 0.0 ) ; gl_Position = vec4 ( 4.0 * ( a_position . xy - 0.25 ) , 0.0 , 1.0 ) ; }".split(" ")}]};
a["postprocessing/motion_blur.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform sampler2D u_mb_tex_curr ; uniform sampler2D u_mb_tex_accum ; uniform float u_motion_blur_exp ; uniform float u_motion_blur_decay_threshold ; float hs = 0.0042 ; GLSL_IN vec2 n ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 ht = GLSL_TEXTURE ( u_mb_tex_curr , n ) ; vec4 hu = GLSL_TEXTURE ( u_mb_tex_accum , n ) ; if ( length ( ht - hu ) > u_motion_blur_decay_threshold ) { vec4 hv = ( 1.0 - u_motion_blur_exp ) * ht + u_motion_blur_exp * hu ; vec4 hw = hv - hu ; vec4 hx = ht - hu ; vec4 cx = min ( max ( abs ( hw ) , vec4 ( hs ) ) , abs ( hx ) ) * sign ( hw ) ; GLSL_OUT_FRAG_COLOR = hu + cx ; } else { GLSL_OUT_FRAG_COLOR = ht ; } }".split(" ")}]};
a["postprocessing/outline.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"txt",b:"uniform sampler2D u_outline_src ; uniform sampler2D u_outline_mask ; uniform sampler2D u_outline_mask_blurred ; uniform vec3 u_outline_color ; uniform float u_draw_outline ; GLSL_IN vec2 n ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 hy = GLSL_TEXTURE ( u_outline_src , n ) ; GLSL_OUT_FRAG_COLOR = hy ; if ( u_draw_outline != 0.0 ) { vec4 hz = GLSL_TEXTURE ( u_outline_mask , n ) ; vec4 hA = GLSL_TEXTURE ( u_outline_mask_blurred , n ) ; float hB = hA . a - hz . a ; if ( hB != 0.0 ) { float hC = smoothstep ( 0.0 , 1.0 , hA . a ) ; if ( hz . a == 0.0 ) { vec3 hD = u_outline_color ; aQ ( hD ) ; vec4 hE = vec4 ( clamp ( hD , 0.0 , 1.0 ) , 1.0 ) ; GLSL_OUT_FRAG_COLOR = mix ( hy , hE , hC ) ; } } } }".split(" ")}]};
a["postprocessing/performance.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform sampler2D u_color ; GLSL_IN vec2 n ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 aK = vec4 ( 0.0 ) ; for ( int bQ = 0 ; bQ < 10 ; bQ ++ ) { vec2 hF = vec2 ( fract ( n * vec2 ( bQ ) * vec2 ( 1.431 , 3.921 ) ) ) ; aK += 0.01 * GLSL_TEXTURE ( u_color , hF ) ; } GLSL_OUT_FRAG_COLOR = aK ; }".split(" ")}]};a["postprocessing/postprocessing.glslf"]=
{a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"POST_EFFECT",b:["POST_EFFECT_NONE"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform vec2 u_texel_size ; uniform sampler2D u_color ;".split(" ")},{a:"cond",d:[{a:"if",e:["POST_EFFECT","FLIP_CUBEMAP_COORDS",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform int u_tex_number ; uniform vec2 u_delta ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["POST_EFFECT","POST_EFFECT_DOF_BLUR",{a:"equal_expr",i:2}],
h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_dof_bokeh_intensity",";"]}]}}]},{a:"txt",b:"GLSL_IN vec2 n ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) {".split(" ")},{a:"cond",d:[{a:"if",e:["POST_EFFECT","POST_EFFECT_NONE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , n ) ;".split(" ")}]}},{a:"elif",e:["POST_EFFECT","POST_EFFECT_GRAYSCALE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 db = GLSL_TEXTURE ( u_color , n ) ; GLSL_OUT_FRAG_COLOR . rgb = vec3 ( ( db . r + db . g + db . b ) / 3.0 ) ; GLSL_OUT_FRAG_COLOR . a = 1.0 ;".split(" ")}]}},
{a:"elif",e:["POST_EFFECT","POST_EFFECT_BLUR",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 fE = vec2 ( 0.0 , 0.0 ) ; vec2 cx = u_texel_size ; vec4 aK ; aK = GLSL_TEXTURE ( u_color , n ) ; GLSL_OUT_FRAG_COLOR = aK * 0.2270270270 ; fE += cx ; aK = GLSL_TEXTURE ( u_color , n + fE ) ; GLSL_OUT_FRAG_COLOR += aK * 0.1945945946 ; aK = GLSL_TEXTURE ( u_color , n - fE ) ; GLSL_OUT_FRAG_COLOR += aK * 0.1945945946 ; fE += cx ; aK = GLSL_TEXTURE ( u_color , n + fE ) ; GLSL_OUT_FRAG_COLOR += aK * 0.1216216216 ; aK = GLSL_TEXTURE ( u_color , n - fE ) ; GLSL_OUT_FRAG_COLOR += aK * 0.1216216216 ; fE += cx ; aK = GLSL_TEXTURE ( u_color , n + fE ) ; GLSL_OUT_FRAG_COLOR += aK * 0.0540540541 ; aK = GLSL_TEXTURE ( u_color , n - fE ) ; GLSL_OUT_FRAG_COLOR += aK * 0.0540540541 ; fE += cx ; aK = GLSL_TEXTURE ( u_color , n + fE ) ; GLSL_OUT_FRAG_COLOR += aK * 0.0162162162 ; aK = GLSL_TEXTURE ( u_color , n - fE ) ; GLSL_OUT_FRAG_COLOR += aK * 0.0162162162 ;".split(" ")}]}},
{a:"elif",e:["POST_EFFECT","POST_EFFECT_GLOW_BLUR",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 fE = vec2 ( 0.0 , 0.0 ) ; vec2 cx = u_texel_size ; vec4 aK ; aK = GLSL_TEXTURE ( u_color , n ) ; GLSL_OUT_FRAG_COLOR = aK * ( 1.0 - step ( 0.0 , - aK . a ) ) * 0.152507 ; fE += cx ; aK = GLSL_TEXTURE ( u_color , n + fE ) ; GLSL_OUT_FRAG_COLOR += aK * ( 1.0 - step ( 0.0 , - aK . a ) ) * 0.141763 ; aK = GLSL_TEXTURE ( u_color , n - fE ) ; GLSL_OUT_FRAG_COLOR += aK * ( 1.0 - step ( 0.0 , - aK . a ) ) * 0.141763 ; fE += cx ; aK = GLSL_TEXTURE ( u_color , n + fE ) ; GLSL_OUT_FRAG_COLOR += aK * ( 1.0 - step ( 0.0 , - aK . a ) ) * 0.113861 ; aK = GLSL_TEXTURE ( u_color , n - fE ) ; GLSL_OUT_FRAG_COLOR += aK * ( 1.0 - step ( 0.0 , - aK . a ) ) * 0.113861 ; fE += cx ; aK = GLSL_TEXTURE ( u_color , n + fE ) ; GLSL_OUT_FRAG_COLOR += aK * ( 1.0 - step ( 0.0 , - aK . a ) ) * 0.079019 ; aK = GLSL_TEXTURE ( u_color , n - fE ) ; GLSL_OUT_FRAG_COLOR += aK * ( 1.0 - step ( 0.0 , - aK . a ) ) * 0.079019 ; fE += cx ; aK = GLSL_TEXTURE ( u_color , n + fE ) ; GLSL_OUT_FRAG_COLOR += aK * ( 1.0 - step ( 0.0 , - aK . a ) ) * 0.047383 ; aK = GLSL_TEXTURE ( u_color , n - fE ) ; GLSL_OUT_FRAG_COLOR += aK * ( 1.0 - step ( 0.0 , - aK . a ) ) * 0.047383 ; fE += cx ; aK = GLSL_TEXTURE ( u_color , n + fE ) ; GLSL_OUT_FRAG_COLOR += aK * ( 1.0 - step ( 0.0 , - aK . a ) ) * 0.024549 ; aK = GLSL_TEXTURE ( u_color , n - fE ) ; GLSL_OUT_FRAG_COLOR += aK * ( 1.0 - step ( 0.0 , - aK . a ) ) * 0.024549 ; fE += cx ; aK = GLSL_TEXTURE ( u_color , n + fE ) ; GLSL_OUT_FRAG_COLOR += aK * ( 1.0 - step ( 0.0 , - aK . a ) ) * 0.01099 ; aK = GLSL_TEXTURE ( u_color , n - fE ) ; GLSL_OUT_FRAG_COLOR += aK * ( 1.0 - step ( 0.0 , - aK . a ) ) * 0.01099 ; fE += cx ; aK = GLSL_TEXTURE ( u_color , n + fE ) ; GLSL_OUT_FRAG_COLOR += aK * ( 1.0 - step ( 0.0 , - aK . a ) ) * 0.00425 ; aK = GLSL_TEXTURE ( u_color , n - fE ) ; GLSL_OUT_FRAG_COLOR += aK * ( 1.0 - step ( 0.0 , - aK . a ) ) * 0.00425 ; fE += cx ; aK = GLSL_TEXTURE ( u_color , n + fE ) ; GLSL_OUT_FRAG_COLOR += aK * ( 1.0 - step ( 0.0 , - aK . a ) ) * 0.00142 ; aK = GLSL_TEXTURE ( u_color , n - fE ) ; GLSL_OUT_FRAG_COLOR += aK * ( 1.0 - step ( 0.0 , - aK . a ) ) * 0.00142 ; GLSL_OUT_FRAG_COLOR = clamp ( GLSL_OUT_FRAG_COLOR , 0.0 , 1.0 ) ;".split(" ")}]}},
{a:"elif",e:["POST_EFFECT","POST_EFFECT_DOF_BLUR",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 fE = vec2 ( 0.0 , 0.0 ) ; vec2 cx = u_texel_size ; vec4 aK ; vec4 hG ; vec4 hH ; float gu ; float hI = u_dof_bokeh_intensity ; aK = GLSL_TEXTURE ( u_color , n ) ; hG = aK ; hH = aK ; gu = aK . a ; cx = gu * cx ; for ( int bQ = 0 ; bQ < 12 ; bQ += 2 ) { fE += cx ; aK = GLSL_TEXTURE ( u_color , n + fE ) ; hG += aK ; hH = max ( hH , aK ) ; aK = GLSL_TEXTURE ( u_color , n - fE ) ; hG += aK ; hH = max ( hH , aK ) ; } hG /= 13.0 ; GLSL_OUT_FRAG_COLOR = mix ( hG , hH , hI ) ;".split(" ")}]}},
{a:"elif",e:["POST_EFFECT","POST_EFFECT_ALPHA_BLUR",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 fE = vec2 ( 0.0 , 0.0 ) ; vec2 cx = u_texel_size ; vec4 aK ; vec4 hG ; vec4 hH ; aK = GLSL_TEXTURE ( u_color , n ) ; hH = max ( hH , aK ) ; hG = aK ; hG . a = aK . a * 0.2270270270 ; fE += cx ; aK = GLSL_TEXTURE ( u_color , n + fE ) ; hH . a = max ( hH . a , aK . a ) ; hG . a += aK . a * 0.1945945946 ; aK = GLSL_TEXTURE ( u_color , n - fE ) ; hH . a = max ( hH . a , aK . a ) ; hG . a += aK . a * 0.1945945946 ; fE += cx ; aK = GLSL_TEXTURE ( u_color , n + fE ) ; hH . a = max ( hH . a , aK . a ) ; hG . a += aK . a * 0.1216216216 ; aK = GLSL_TEXTURE ( u_color , n - fE ) ; hH . a = max ( hH . a , aK . a ) ; hG . a += aK . a * 0.1216216216 ; fE += cx ; aK = GLSL_TEXTURE ( u_color , n + fE ) ; hH . a = max ( hH . a , aK . a ) ; hG . a += aK . a * 0.0540540541 ; aK = GLSL_TEXTURE ( u_color , n - fE ) ; hH . a = max ( hH . a , aK . a ) ; hG . a += aK . a * 0.0540540541 ; fE += cx ; aK = GLSL_TEXTURE ( u_color , n + fE ) ; hH . a = max ( hH . a , aK . a ) ; hG . a += aK . a * 0.0162162162 ; aK = GLSL_TEXTURE ( u_color , n - fE ) ; hH . a = max ( hH . a , aK . a ) ; hG . a += aK . a * 0.0162162162 ; GLSL_OUT_FRAG_COLOR = mix ( hG , hH , 0.5 ) ;".split(" ")}]}},
{a:"elif",e:["POST_EFFECT","POST_EFFECT_EXTEND",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 cx = u_texel_size ; vec4 aK = GLSL_TEXTURE ( u_color , n ) ; GLSL_OUT_FRAG_COLOR = aK ; if ( aK . a == 0.0 ) { aK = GLSL_TEXTURE ( u_color , n + cx ) ; if ( aK . a > 0.0 ) GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , 1.0 , 1.0 , aK . a ) ; else { aK = GLSL_TEXTURE ( u_color , n - cx ) ; if ( aK . a > 0.0 ) GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , 1.0 , 1.0 , aK . a ) ; } }".split(" ")}]}},{a:"elif",e:["POST_EFFECT",
"FLIP_CUBEMAP_COORDS",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float hJ = u_delta [ 0 ] ; float hK = u_delta [ 1 ] ; float hL = 1.0 / 3.0 ; float hM = 0.5 ; vec2 hN = vec2 ( hL , hM ) ; if ( u_tex_number == 0 ) { vec2 bE = mat2 ( 0.0 , - 1.0 , 1.0 , 0.0 ) * n * hN + vec2 ( 2.0 * hL , hM ) ; bE [ 0 ] = max ( bE [ 0 ] , 2.0 * hL + hJ ) ; bE [ 1 ] = max ( bE [ 1 ] , hK ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( bE [ 0 ] , hM - bE [ 1 ] ) ) ; } else if ( u_tex_number == 1 ) { vec2 bE = mat2 ( 0.0 , - 1.0 , 1.0 , 0.0 ) * n * hN + vec2 ( 0.0 , hM ) ; bE [ 0 ] = max ( bE [ 0 ] , hJ ) ; bE [ 1 ] = min ( bE [ 1 ] , hM - hK ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( hL - bE [ 0 ] , bE [ 1 ] ) ) ; } else if ( u_tex_number == 2 ) { vec2 bE = n * hN + vec2 ( 2.0 * hL , hM ) ; bE [ 0 ] = max ( bE [ 0 ] , 2.0 * hL + hJ ) ; bE [ 1 ] = min ( bE [ 1 ] , 1.0 - hK ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( bE [ 0 ] , 1.5 - bE [ 1 ] ) ) ; } else if ( u_tex_number == 3 ) { vec2 bE = n * hN + vec2 ( hL , 0.0 ) ; bE [ 0 ] = max ( bE [ 0 ] , hL + hJ ) ; bE [ 0 ] = min ( bE [ 0 ] , 2.0 * hL - hJ ) ; bE [ 1 ] = min ( bE [ 1 ] , hM - hK ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( 1.0 - bE [ 0 ] , bE [ 1 ] ) ) ; } else if ( u_tex_number == 4 ) { vec2 bE = n * hN + vec2 ( hL , hM ) ; bE [ 0 ] = max ( bE [ 0 ] , hL + hJ ) ; bE [ 0 ] = min ( bE [ 0 ] , 2.0 * hL - hJ ) ; bE [ 1 ] = min ( bE [ 1 ] , 1.0 - hK ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( bE [ 0 ] , 3.0 * hM - bE [ 1 ] ) ) ; } else { vec2 bE = n * hN + vec2 ( 0.0 , hM ) ; bE [ 0 ] = max ( bE [ 0 ] , hJ ) ; bE [ 1 ] = min ( bE [ 1 ] , 1.0 - hK ) ; bE [ 1 ] = max ( bE [ 1 ] , hM + hK ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( hL - bE [ 0 ] , bE [ 1 ] ) ) ; }".split(" ")}]}}]},
{a:"txt",b:["}"]}]};a["postprocessing/postprocessing.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"std.glsl"},{a:"txt",b:"GLSL_IN vec2 a_position ; GLSL_OUT vec2 n ; void main ( ) { n = 2.0 * a_position ; gl_Position = vec4 ( 4.0 * ( a_position . xy - 0.25 ) , 0.0 , 1.0 ) ; }".split(" ")}]};a["postprocessing/smaa.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"SMAA_PASS",b:["SMAA_RESOLVE"]},{a:"var",c:"SMAA_REPROJECTION",b:["0"]},{a:"var",c:"SMAA_PREDICATION",
b:["0"]},{a:"var",c:"AA_METHOD",b:["AA_METHOD_SMAA_LOW"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"pack.glslf"},{a:"txt",b:["uniform","sampler2D","u_color",";"]},{a:"cond",d:[{a:"if",e:["SMAA_PASS","SMAA_RESOLVE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_color_prev",";"]}]}}]},{a:"cond",d:[{a:"if",e:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_blend",";"]}]}}]},
{a:"cond",d:[{a:"if",e:["SMAA_REPROJECTION"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_velocity_tex",";"]}]}}]},{a:"cond",d:[{a:"if",e:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",i:2},"SMAA_PREDICATION",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_predication_tex",";"]}]}}]},{a:"cond",d:[{a:"if",e:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform sampler2D u_search_tex ; uniform sampler2D u_area_tex ; uniform vec4 u_subsample_indices ;".split(" ")}]}}]},
{a:"txt",b:"uniform vec2 u_texel_size ; GLSL_IN vec2 n ;".split(" ")},{a:"cond",d:[{a:"if",e:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","hO",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec4 hP ; GLSL_IN vec4 hQ ; GLSL_IN vec4 hR ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","hS",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4",
"GLSL_OUT_FRAG_COLOR",";"]},{a:"cond",d:[{a:"if",e:["AA_METHOD","AA_METHOD_SMAA_LOW",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"SMAA_THRESHOLD",b:["0.15"]},{a:"define",c:"SMAA_DISABLE_DIAG_DETECTION",b:["1"]},{a:"define",c:"SMAA_DISABLE_CORNER_DETECTION",b:["1"]}]}},{a:"elif",e:["AA_METHOD","AA_METHOD_SMAA_MEDIUM",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"SMAA_THRESHOLD",b:["0.1"]},{a:"define",c:"SMAA_DISABLE_DIAG_DETECTION",b:["1"]},{a:"define",c:"SMAA_DISABLE_CORNER_DETECTION",
b:["1"]}]}},{a:"elif",e:["AA_METHOD","AA_METHOD_SMAA_HIGH",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"SMAA_THRESHOLD",b:["0.1"]},{a:"define",c:"SMAA_DISABLE_DIAG_DETECTION",b:["0"]},{a:"define",c:"SMAA_MAX_SEARCH_STEPS_DIAG",b:["8"]},{a:"define",c:"SMAA_CORNER_ROUNDING",b:["25"]}]}},{a:"elif",e:["AA_METHOD","AA_METHOD_SMAA_ULTRA",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"SMAA_THRESHOLD",b:["0.05"]},{a:"define",c:"SMAA_DISABLE_DIAG_DETECTION",b:["0"]},{a:"define",c:"SMAA_MAX_SEARCH_STEPS_DIAG",
b:["16"]},{a:"define",c:"SMAA_CORNER_ROUNDING",b:["25"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_THRESHOLD",h:{a:"grp",d:[{a:"define",c:"SMAA_THRESHOLD",b:["0.1"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_DEPTH_THRESHOLD",h:{a:"grp",d:[{a:"define",c:"SMAA_DEPTH_THRESHOLD",b:["(","0.1","*","SMAA_THRESHOLD",")"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_MAX_SEARCH_STEPS_DIAG",h:{a:"grp",d:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS_DIAG",b:["8"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_CORNER_ROUNDING",h:{a:"grp",
d:[{a:"define",c:"SMAA_CORNER_ROUNDING",b:["25"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR",h:{a:"grp",d:[{a:"define",c:"SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR",b:["2.0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_PREDICATION",h:{a:"grp",d:[{a:"define",c:"SMAA_PREDICATION",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_PREDICATION_THRESHOLD",h:{a:"grp",d:[{a:"define",c:"SMAA_PREDICATION_THRESHOLD",b:["0.01"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_PREDICATION_SCALE",h:{a:"grp",
d:[{a:"define",c:"SMAA_PREDICATION_SCALE",b:["2.0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_PREDICATION_STRENGTH",h:{a:"grp",d:[{a:"define",c:"SMAA_PREDICATION_STRENGTH",b:["0.4"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_REPROJECTION",h:{a:"grp",d:[{a:"define",c:"SMAA_REPROJECTION",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_REPROJECTION_WEIGHT_SCALE",h:{a:"grp",d:[{a:"define",c:"SMAA_REPROJECTION_WEIGHT_SCALE",b:["30.0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_MAX_SEARCH_STEPS",h:{a:"grp",d:[{a:"define",
c:"SMAA_MAX_SEARCH_STEPS",b:["16"]}]}}]},{a:"define",c:"SMAA_AREATEX_MAX_DISTANCE",b:["16"]},{a:"define",c:"SMAA_AREATEX_MAX_DISTANCE_DIAG",b:["20"]},{a:"define",c:"SMAA_AREATEX_PIXEL_SIZE",b:"( 1.0 / vec2 ( 160.0 , 560.0 ) )".split(" ")},{a:"define",c:"SMAA_AREATEX_SUBTEX_SIZE",b:["(","1.0","/","7.0",")"]},{a:"define",c:"SMAA_SEARCHTEX_SIZE",b:"vec2 ( 66.0 , 33.0 )".split(" ")},{a:"define",c:"SMAA_SEARCHTEX_PACKED_SIZE",b:"vec2 ( 64.0 , 16.0 )".split(" ")},{a:"define",c:"SMAA_CORNER_ROUNDING_NORM",
b:"( float ( SMAA_CORNER_ROUNDING ) / 100.0 )".split(" ")},{a:"cond",d:[{a:"if",e:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 hW ( vec2 bE , sampler2D hT ) { float p = GLSL_TEXTURE ( hT , bE ) . r ; float hU = GLSL_TEXTURE ( hT , hP . xy ) . r ; float hV = GLSL_TEXTURE ( hT , hP . zw ) . r ; return vec3 ( p , hU , hV ) ; }".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 h_ ( vec2 bE , sampler2D hX ) { vec3 hY = hW ( bE , hX ) ; vec2 cx = abs ( hY . xx - hY . yz ) ; vec2 hZ = step ( SMAA_PREDICATION_THRESHOLD , cx ) ; return SMAA_PREDICATION_SCALE * SMAA_THRESHOLD * ( 1.0 - SMAA_PREDICATION_STRENGTH * hZ ) ; }".split(" ")}]}}]},
{a:"txt",b:"void id ( bvec2 ia , inout vec2 ib , vec2 ic ) { if ( ia . x ) ib . x = ic . x ; if ( ia . y ) ib . y = ic . y ; } void id ( bvec4 ia , inout vec4 ib , vec4 ic ) { id ( ia . xy , ib . xy , ic . xy ) ; id ( ia . zw , ib . zw , ic . zw ) ; } vec2 ie ( vec2 x ) { return sign ( x ) * floor ( abs ( x ) + .5 ) ; } vec4 ie ( vec4 x ) { return sign ( x ) * floor ( abs ( x ) + .5 ) ; }".split(" ")},{a:"cond",d:[{a:"if",e:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:"vec2 it ( vec2 bE , sampler2D ig".split(" ")},{a:"cond",d:[{a:"if",e:["SMAA_PREDICATION"],h:{a:"grp",d:[{a:"txt",b:[",","sampler2D","hX"]}]}}]},{a:"txt",b:[")","{"]},{a:"cond",d:[{a:"if",e:["SMAA_PREDICATION"],h:{a:"grp",d:[{a:"txt",b:"vec2 ih = h_ ( bE , hX ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec2 ih = vec2 ( SMAA_THRESHOLD , SMAA_THRESHOLD ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 ii = vec3 ( 0.2126 , 0.7152 , 0.0722 ) ; float ij = dot ( GLSL_TEXTURE ( ig , bE ) . rgb , ii ) ; float ik = dot ( GLSL_TEXTURE ( ig , hP . xy ) . rgb , ii ) ; float il = dot ( GLSL_TEXTURE ( ig , hP . zw ) . rgb , ii ) ; vec4 cx ; cx . xy = abs ( ij - vec2 ( ik , il ) ) ; vec2 hZ = step ( ih , cx . xy ) ; if ( dot ( hZ , vec2 ( 1.0 , 1.0 ) ) == 0.0 ) discard ; float im = dot ( GLSL_TEXTURE ( ig , hQ . xy ) . rgb , ii ) ; float io = dot ( GLSL_TEXTURE ( ig , hQ . zw ) . rgb , ii ) ; cx . zw = abs ( ij - vec2 ( im , io ) ) ; vec2 ip = max ( cx . xy , cx . zw ) ; float iq = dot ( GLSL_TEXTURE ( ig , hR . xy ) . rgb , ii ) ; float ir = dot ( GLSL_TEXTURE ( ig , hR . zw ) . rgb , ii ) ; cx . zw = abs ( vec2 ( ik , il ) - vec2 ( iq , ir ) ) ; ip = max ( ip . xy , cx . zw ) ; float is = max ( ip . x , ip . y ) ; hZ . xy *= step ( is , SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR * cx . xy ) ; return hZ ; }".split(" ")}]}}]},
{a:"cond",d:[{a:"if",e:["SMAA_DISABLE_DIAG_DETECTION",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"vec2 iv ( vec2 iu ) { iu . r = iu . r * abs ( 5.0 * iu . r - 5.0 * 0.75 ) ; return ie ( iu ) ; } vec4 iv ( vec4 iu ) { iu . rb = iu . rb * abs ( 5.0 * iu . rb - 5.0 * 0.75 ) ; return ie ( iu ) ; } vec2 ix ( sampler2D iw , vec2 bE , vec2 da , out vec2 iu ) { vec4 fQ = vec4 ( bE , - 1.0 , 1.0 ) ; vec3 t = vec3 ( u_texel_size , 1.0 ) ; for ( int bQ = 0 ; bQ < SMAA_MAX_SEARCH_STEPS_DIAG ; bQ ++ ) { if ( fQ . z < float ( SMAA_MAX_SEARCH_STEPS_DIAG - 1 ) && fQ . w > 0.9 ) { fQ . xyz += t * vec3 ( da , 1.0 ) ; iu = GLSL_TEXTURE ( iw , fQ . xy , 0.0 ) . rg ; fQ . w = dot ( iu , vec2 ( 0.5 , 0.5 ) ) ; } } return fQ . zw ; } vec2 iy ( sampler2D iw , vec2 bE , vec2 da , out vec2 iu ) { vec4 fQ = vec4 ( bE , - 1.0 , 1.0 ) ; fQ . x += 0.25 * u_texel_size . x ; vec3 t = vec3 ( u_texel_size , 1.0 ) ; for ( int bQ = 0 ; bQ < SMAA_MAX_SEARCH_STEPS_DIAG ; bQ ++ ) { if ( fQ . z < float ( SMAA_MAX_SEARCH_STEPS_DIAG - 1 ) && fQ . w > 0.9 ) { fQ . xyz = t * vec3 ( da , 1.0 ) + fQ . xyz ; iu = GLSL_TEXTURE ( iw , fQ . xy , 0.0 ) . rg ; iu = iv ( iu ) ; fQ . w = dot ( iu , vec2 ( 0.5 , 0.5 ) ) ; } } return fQ . zw ; } vec2 iA ( sampler2D iz , vec2 aG , vec2 iu , float fE ) { vec2 bE = vec2 ( SMAA_AREATEX_MAX_DISTANCE_DIAG , SMAA_AREATEX_MAX_DISTANCE_DIAG ) * iu + aG ; bE = SMAA_AREATEX_PIXEL_SIZE * bE + 0.5 * SMAA_AREATEX_PIXEL_SIZE ; bE . x += 0.5 ; bE . y += SMAA_AREATEX_SUBTEX_SIZE * fE ; return GLSL_TEXTURE ( iz , bE , 0.0 ) . rg ; } vec2 iF ( sampler2D iw , sampler2D iz , vec2 bE , vec2 iu , vec4 iB ) { vec2 ii = vec2 ( 0.0 , 0.0 ) ; vec4 dg ; vec2 iC ; if ( iu . r > 0.0 ) { dg . xz = ix ( iw , bE , vec2 ( - 1.0 , 1.0 ) , iC ) ; dg . x += float ( iC . y > 0.9 ) ; } else dg . xz = vec2 ( 0.0 , 0.0 ) ; dg . yw = ix ( iw , bE , vec2 ( 1.0 , - 1.0 ) , iC ) ; if ( dg . x + dg . y > 2.0 ) { vec4 iD = vec4 ( - dg . x + 0.25 , dg . x , dg . y , - dg . y - 0.25 ) * u_texel_size . xyxy + bE . xyxy ; vec4 db ; db . xy = GLSL_TEXTURE ( iw , iD . xy + u_texel_size * vec2 ( - 1 , 0 ) , 0.0 ) . rg ; db . zw = GLSL_TEXTURE ( iw , iD . zw + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . rg ; db . yxwz = iv ( db . xyzw ) ; vec2 iE = vec2 ( 2.0 , 2.0 ) * db . xz + db . yw ; id ( bvec2 ( step ( 0.9 , dg . zw ) ) , iE , vec2 ( 0.0 , 0.0 ) ) ; ii += iA ( iz , dg . xy , iE , iB . z ) ; } dg . xz = iy ( iw , bE , vec2 ( - 1 , - 1 ) , iC ) ; if ( GLSL_TEXTURE ( iw , bE + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . r > 0.0 ) { dg . yw = iy ( iw , bE , vec2 ( 1 , 1 ) , iC ) ; dg . y += float ( iC . y > 0.9 ) ; } else dg . yw = vec2 ( 0.0 , 0.0 ) ; if ( dg . x + dg . y > 2.0 ) { vec4 iD = vec4 ( - dg . x , - dg . x , dg . y , dg . y ) * u_texel_size . xyxy + bE . xyxy ; vec4 db ; db . x = GLSL_TEXTURE ( iw , iD . xy + u_texel_size * vec2 ( - 1 , 0 ) , 0.0 ) . g ; db . y = GLSL_TEXTURE ( iw , iD . xy + u_texel_size * vec2 ( 0 , - 1 ) , 0.0 ) . r ; db . zw = GLSL_TEXTURE ( iw , iD . zw + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . gr ; vec2 iE = vec2 ( 2.0 , 2.0 ) * db . xz + db . yw ; id ( bvec2 ( step ( 0.9 , dg . zw ) ) , iE , vec2 ( 0 , 0 ) ) ; ii += iA ( iz , dg . xy , iE , iB . w ) . gr ; } return ii ; }".split(" ")}]}}]},
{a:"txt",b:"float iI ( sampler2D iG , vec2 iu , float fE ) { vec2 hN = SMAA_SEARCHTEX_SIZE * vec2 ( 0.5 , - 1.0 ) ; vec2 iH = SMAA_SEARCHTEX_SIZE * vec2 ( fE , 1.0 ) ; hN += vec2 ( - 1.0 , 1.0 ) ; iH += vec2 ( 0.5 , - 0.5 ) ; hN *= 1.0 / SMAA_SEARCHTEX_PACKED_SIZE ; iH *= 1.0 / SMAA_SEARCHTEX_PACKED_SIZE ; return GLSL_TEXTURE ( iG , hN * iu + iH , 0.0 ) . r ; } float iJ ( sampler2D iw , sampler2D iG , vec2 bE , float iC ) { vec2 iu = vec2 ( 0.0 , 1.0 ) ; for ( int bQ = 0 ; bQ < SMAA_MAX_SEARCH_STEPS ; bQ ++ ) { if ( bE . x > iC && iu . g > 0.8281 && iu . r == 0.0 ) { iu = GLSL_TEXTURE ( iw , bE , 0.0 ) . rg ; bE = - vec2 ( 2.0 , 0.0 ) * u_texel_size + bE ; } } float fE = - ( 255.0 / 127.0 ) * iI ( iG , iu , 0.0 ) + 3.25 ; return u_texel_size . x * fE + bE . x ; } float iK ( sampler2D iw , sampler2D iG , vec2 bE , float iC ) { vec2 iu = vec2 ( 0.0 , 1.0 ) ; for ( int bQ = 0 ; bQ < SMAA_MAX_SEARCH_STEPS ; bQ ++ ) { if ( bE . x < iC && iu . g > 0.8281 && iu . r == 0.0 ) { iu = GLSL_TEXTURE ( iw , bE , 0.0 ) . rg ; bE = vec2 ( 2.0 , 0.0 ) * u_texel_size + bE ; } } float fE = - ( 255.0 / 127.0 ) * iI ( iG , iu , 0.5 ) + 3.25 ; return - u_texel_size . x * fE + bE . x ; } float iL ( sampler2D iw , sampler2D iG , vec2 bE , float iC ) { vec2 iu = vec2 ( 1.0 , 0.0 ) ; for ( int bQ = 0 ; bQ < SMAA_MAX_SEARCH_STEPS ; bQ ++ ) { if ( bE . y > iC && iu . r > 0.8281 && iu . g == 0.0 ) { iu = GLSL_TEXTURE ( iw , bE , 0.0 ) . rg ; bE = - vec2 ( 0.0 , 2.0 ) * u_texel_size + bE ; } } float fE = - ( 255.0 / 127.0 ) * iI ( iG , iu . gr , 0.0 ) + 3.25 ; return u_texel_size . y * fE + bE . y ; } float iM ( sampler2D iw , sampler2D iG , vec2 bE , float iC ) { vec2 iu = vec2 ( 1.0 , 0.0 ) ; for ( int bQ = 0 ; bQ < SMAA_MAX_SEARCH_STEPS ; bQ ++ ) { if ( bE . y < iC && iu . r > 0.8281 && iu . g == 0.0 ) { iu = GLSL_TEXTURE ( iw , bE , 0.0 ) . rg ; bE = vec2 ( 0.0 , 2.0 ) * u_texel_size + bE ; } } float fE = - ( 255.0 / 127.0 ) * iI ( iG , iu . gr , 0.5 ) + 3.25 ; return - u_texel_size . y * fE + bE . y ; } vec2 iP ( sampler2D iz , vec2 aG , float iN , float iO , float fE ) { vec2 bE = vec2 ( SMAA_AREATEX_MAX_DISTANCE , SMAA_AREATEX_MAX_DISTANCE ) * ie ( 4.0 * vec2 ( iN , iO ) ) + aG ; bE = SMAA_AREATEX_PIXEL_SIZE * bE + 0.5 * SMAA_AREATEX_PIXEL_SIZE ; bE . y = SMAA_AREATEX_SUBTEX_SIZE * fE + bE . y ; return GLSL_TEXTURE ( iz , bE , 0.0 ) . rg ; } void iS ( sampler2D iw , inout vec2 ii , vec4 bE , vec2 dg ) {".split(" ")},
{a:"cond",d:[{a:"if",e:["SMAA_DISABLE_CORNER_DETECTION",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"vec2 iQ = step ( dg . xy , dg . yx ) ; vec2 iR = ( 1.0 - SMAA_CORNER_ROUNDING_NORM ) * iQ ; iR /= iQ . x + iQ . y ; vec2 aF = vec2 ( 1.0 , 1.0 ) ; aF . x -= iR . x * GLSL_TEXTURE ( iw , bE . xy + u_texel_size * vec2 ( 0 , 1 ) , 0.0 ) . r ; aF . x -= iR . y * GLSL_TEXTURE ( iw , bE . zw + u_texel_size * vec2 ( 1 , 1 ) , 0.0 ) . r ; aF . y -= iR . x * GLSL_TEXTURE ( iw , bE . xy + u_texel_size * vec2 ( 0 , - 2 ) , 0.0 ) . r ; aF . y -= iR . y * GLSL_TEXTURE ( iw , bE . zw + u_texel_size * vec2 ( 1 , - 2 ) , 0.0 ) . r ; ii *= clamp ( aF , 0.0 , 1.0 ) ;".split(" ")}]}}]},
{a:"txt",b:"} void iT ( sampler2D iw , inout vec2 ii , vec4 bE , vec2 dg ) {".split(" ")},{a:"cond",d:[{a:"if",e:["SMAA_DISABLE_CORNER_DETECTION",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"vec2 iQ = step ( dg . xy , dg . yx ) ; vec2 iR = ( 1.0 - SMAA_CORNER_ROUNDING_NORM ) * iQ ; iR /= iQ . x + iQ . y ; vec2 aF = vec2 ( 1.0 , 1.0 ) ; aF . x -= iR . x * GLSL_TEXTURE ( iw , bE . xy + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . g ; aF . x -= iR . y * GLSL_TEXTURE ( iw , bE . zw + u_texel_size * vec2 ( 1 , 1 ) , 0.0 ) . g ; aF . y -= iR . x * GLSL_TEXTURE ( iw , bE . xy + u_texel_size * vec2 ( - 2 , 0 ) , 0.0 ) . g ; aF . y -= iR . y * GLSL_TEXTURE ( iw , bE . zw + u_texel_size * vec2 ( - 2 , 1 ) , 0.0 ) . g ; ii *= clamp ( aF , 0.0 , 1.0 ) ;".split(" ")}]}}]},
{a:"txt",b:["}"]},{a:"cond",d:[{a:"if",e:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 iW ( vec2 bE , vec2 iU , sampler2D iw , sampler2D iz , sampler2D iG , vec4 iB ) { vec4 ii = vec4 ( 0.0 , 0.0 , 0.0 , 0.0 ) ; vec2 iu = GLSL_TEXTURE ( iw , bE ) . rg ; if ( iu . g > 0.0 ) {".split(" ")},{a:"cond",d:[{a:"if",e:["SMAA_DISABLE_DIAG_DETECTION",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"ii . rg = iF ( iw , iz , bE , iu , iB ) ; if ( ii . r == - ii . g ) {".split(" ")}]}}]},
{a:"txt",b:"vec2 dg ; vec3 iD ; iD . x = iJ ( iw , iG , hP . xy , hR . x ) ; iD . y = hQ . y ; dg . x = iD . x ; float iN = GLSL_TEXTURE ( iw , iD . xy , 0.0 ) . r ; iD . z = iK ( iw , iG , hP . zw , hR . y ) ; dg . y = iD . z ; dg = abs ( ie ( dg / u_texel_size . xx - iU . xx ) ) ; vec2 iV = sqrt ( dg ) ; float iO = GLSL_TEXTURE ( iw , iD . zy + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . r ; ii . rg = iP ( iz , iV , iN , iO , iB . y ) ; iD . y = bE . y ; iS ( iw , ii . rg , iD . xyzy , dg ) ;".split(" ")},
{a:"cond",d:[{a:"if",e:["SMAA_DISABLE_DIAG_DETECTION",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"} else iu . r = 0.0 ;".split(" ")}]}}]},{a:"txt",b:"} if ( iu . r > 0.0 ) { vec2 dg ; vec3 iD ; iD . y = iL ( iw , iG , hQ . xy , hR . z ) ; iD . x = hP . x ; dg . x = iD . y ; float iN = GLSL_TEXTURE ( iw , iD . xy , 0.0 ) . g ; iD . z = iM ( iw , iG , hQ . zw , hR . w ) ; dg . y = iD . z ; dg = abs ( ie ( dg / u_texel_size . yy - iU . yy ) ) ; vec2 iV = sqrt ( dg ) ; float iO = GLSL_TEXTURE ( iw , iD . xz + u_texel_size * vec2 ( 0 , 1 ) , 0.0 ) . g ; ii . ba = iP ( iz , iV , iN , iO , iB . x ) ; iD . x = bE . x ; iT ( iw , ii . ba , iD . xyxz , dg ) ; } return ii ; }".split(" ")}]}}]},
{a:"cond",d:[{a:"if",e:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 je ( vec2 bE , sampler2D ig , sampler2D iX".split(" ")},{a:"cond",d:[{a:"if",e:["SMAA_REPROJECTION"],h:{a:"grp",d:[{a:"txt",b:[",","sampler2D","iY"]}]}}]},{a:"txt",b:") { vec4 a ; a . x = GLSL_TEXTURE ( iX , hO . xy ) . a ; a . y = GLSL_TEXTURE ( iX , hO . zw ) . g ; a . wz = GLSL_TEXTURE ( iX , bE ) . xz ; if ( dot ( a , vec4 ( 1.0 , 1.0 , 1.0 , 1.0 ) ) < 1e-5 ) { vec4 aK = GLSL_TEXTURE ( ig , bE , 0.0 ) ;".split(" ")},
{a:"cond",d:[{a:"if",e:["SMAA_REPROJECTION"],h:{a:"grp",d:[{a:"txt",b:"vec4 iZ = GLSL_TEXTURE ( iY , n ) ; vec2 cS = 2.0 * i_ ( iZ ) - 1.0 ; aK . a = sqrt ( 2.0 * length ( cS ) ) ;".split(" ")}]}}]},{a:"txt",b:"return aK ; } else { bool bO = max ( a . x , a . z ) > max ( a . y , a . w ) ; vec4 ja = vec4 ( 0.0 , a . y , 0.0 , a . w ) ; vec2 jb = a . yw ; id ( bvec4 ( bO , bO , bO , bO ) , ja , vec4 ( a . x , 0.0 , a . z , 0.0 ) ) ; id ( bvec2 ( bO , bO ) , jb , a . xz ) ; jb /= dot ( jb , vec2 ( 1.0 , 1.0 ) ) ; vec4 jc = ja * vec4 ( u_texel_size , - u_texel_size ) + bE . xyxy ; vec4 aK = jb . x * GLSL_TEXTURE ( ig , jc . xy , 0.0 ) ; aK += jb . y * GLSL_TEXTURE ( ig , jc . zw , 0.0 ) ;".split(" ")},
{a:"cond",d:[{a:"if",e:["SMAA_REPROJECTION"],h:{a:"grp",d:[{a:"txt",b:"vec4 iZ = GLSL_TEXTURE ( iY , jc . xy ) ; vec2 jd = 2.0 * i_ ( iZ ) - 1.0 ; vec2 cS = jb . x * jd ; iZ = GLSL_TEXTURE ( iY , jc . zw ) ; jd = 2.0 * i_ ( iZ ) - 1.0 ; cS += jb . y * jd ; aK . a = sqrt ( 2.0 * length ( cS ) ) ;".split(" ")}]}}]},{a:"txt",b:["return","aK",";","}","}"]}]}}]},{a:"cond",d:[{a:"if",e:["SMAA_PASS","SMAA_RESOLVE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 jj ( vec2 bE , sampler2D jf , sampler2D jg".split(" ")},
{a:"cond",d:[{a:"if",e:["SMAA_REPROJECTION"],h:{a:"grp",d:[{a:"txt",b:[",","sampler2D","iY"]}]}}]},{a:"txt",b:[")","{"]},{a:"cond",d:[{a:"if",e:["SMAA_REPROJECTION"],h:{a:"grp",d:[{a:"txt",b:"vec4 iZ = GLSL_TEXTURE ( iY , n ) ; vec2 cS ; cS = 2.0 * i_ ( iZ ) - 1.0 ; vec4 jh = GLSL_TEXTURE ( jf , bE ) ; vec4 ji = GLSL_TEXTURE ( jg , bE - cS ) ; float cx = abs ( jh . a * jh . a - ji . a * ji . a ) / 2.0 ; float bU = 0.5 * clamp ( 1.0 - sqrt ( cx ) * SMAA_REPROJECTION_WEIGHT_SCALE , 0.0 , 1.0 ) ; vec4 aK = mix ( jh , ji , bU ) ; aK . a = 1.0 ; return aK ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 jh = GLSL_TEXTURE ( jf , bE ) ; vec4 ji = GLSL_TEXTURE ( jg , bE ) ; return mix ( jh , ji , 0.5 ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",e:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 aK = vec4 ( it ( n , u_color".split(" ")},{a:"cond",d:[{a:"if",e:["SMAA_PREDICATION"],h:{a:"grp",d:[{a:"txt",b:[",","u_predication_tex"]}]}}]},{a:"txt",b:") , 0.0 , 0.0 ) ;".split(" ")}]}},
{a:"elif",e:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 aK = iW ( n , hS , u_color , u_area_tex , u_search_tex , u_subsample_indices ) ;".split(" ")}]}},{a:"elif",e:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 aK = je ( n , u_color , u_blend".split(" ")},{a:"cond",d:[{a:"if",e:["SMAA_REPROJECTION"],h:{a:"grp",d:[{a:"txt",b:[",","u_velocity_tex"]}]}}]},{a:"txt",b:[")",";"]}]}},{a:"elif",e:["SMAA_PASS",
"SMAA_RESOLVE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 aK = vec4 ( jj ( n , u_color , u_color_prev".split(" ")},{a:"cond",d:[{a:"if",e:["SMAA_REPROJECTION"],h:{a:"grp",d:[{a:"txt",b:[",","u_velocity_tex"]}]}}]},{a:"txt",b:[")",")",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 aK = GLSL_TEXTURE ( u_color , n ) ;".split(" ")}]}}]},{a:"txt",b:["GLSL_OUT_FRAG_COLOR","=","aK",";","}"]}]};a["postprocessing/smaa.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"SMAA_PASS",
b:["SMAA_RESOLVE"]},{a:"var",c:"AA_METHOD",b:["AA_METHOD_SMAA_LOW"]},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform vec2 u_texel_size ; GLSL_IN vec2 a_position ; GLSL_OUT vec2 n ;".split(" ")},{a:"cond",d:[{a:"if",e:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","hO",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT vec4 hP ; GLSL_OUT vec4 hQ ; GLSL_OUT vec4 hR ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec2","hS",";"]}]}}]},{a:"cond",d:[{a:"if",e:["AA_METHOD","AA_METHOD_SMAA_LOW",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS",b:["4"]}]}},{a:"elif",e:["AA_METHOD","AA_METHOD_SMAA_MEDIUM",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS",b:["8"]}]}},{a:"elif",e:["AA_METHOD","AA_METHOD_SMAA_HIGH",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS",b:["16"]}]}},{a:"elif",
e:["AA_METHOD","AA_METHOD_SMAA_ULTRA",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS",b:["32"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_MAX_SEARCH_STEPS",h:{a:"grp",d:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS",b:["16"]}]}}]},{a:"cond",d:[{a:"if",e:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"void jk ( vec2 bE ) { hP = u_texel_size . xyxy * vec4 ( - 1.0 , 0.0 , 0.0 , - 1.0 ) + bE . xyxy ; hQ = u_texel_size . xyxy * vec4 ( 1.0 , 0.0 , 0.0 , 1.0 ) + bE . xyxy ; hR = u_texel_size . xyxy * vec4 ( - 2.0 , 0.0 , 0.0 , - 2.0 ) + bE . xyxy ; }".split(" ")}]}},
{a:"elif",e:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"void jl ( vec2 bE , out vec2 iU ) { iU = bE / u_texel_size ; hP = u_texel_size . xyxy * vec4 ( - 0.25 , - 0.125 , 1.25 , - 0.125 ) + bE . xyxy ; hQ = u_texel_size . xyxy * vec4 ( - 0.125 , - 0.25 , - 0.125 , 1.25 ) + bE . xyxy ; hR = u_texel_size . xxyy * vec4 ( - 2.0 , 2.0 , - 2.0 , 2.0 ) * float ( SMAA_MAX_SEARCH_STEPS ) + vec4 ( hP . xz , hQ . yw ) ; }".split(" ")}]}},{a:"elif",e:["SMAA_PASS",
"SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"void jm ( vec2 bE ) { hO = u_texel_size . xyxy * vec4 ( 1.0 , 0.0 , 0.0 , 1.0 ) + bE . xyxy ; }".split(" ")}]}}]},{a:"txt",b:"void main ( ) { n = 2.0 * a_position ;".split(" ")},{a:"cond",d:[{a:"if",e:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["jk","(","n",")",";"]}]}},{a:"elif",e:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"jl ( n , hS ) ;".split(" ")}]}},
{a:"elif",e:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["jm","(","n",")",";"]}]}}]},{a:"txt",b:"gl_Position = vec4 ( 4.0 * ( a_position . xy - 0.25 ) , 0.0 , 1.0 ) ; }".split(" ")}]};a["postprocessing/ssao.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"SSAO_WHITE",b:["0"]},{a:"var",c:"SSAO_QUALITY",b:["SSAO_QUALITY_8"]},{a:"var",c:"SSAO_HEMISPHERE",b:["0"]},{a:"txt",b:["precision","PRECISION","sampler2D",
";"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"depth_fetch.glslf"},{a:"txt",b:"uniform sampler2D u_color ; uniform sampler2D u_depth ; uniform sampler2D u_ssao_special_tex ; uniform vec2 u_camera_range ; uniform vec2 u_texel_size ; uniform float u_ssao_radius_increase ; uniform float u_ssao_influence ; uniform float u_ssao_dist_factor ; GLSL_IN vec2 n ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; float jn ( in vec2 fQ ) { return gs ( u_depth , fQ , u_camera_range ) ; } void main ( ) { vec3 gx = GLSL_TEXTURE ( u_color , n ) . rgb ;".split(" ")},
{a:"cond",d:[{a:"if",e:["SSAO_WHITE"],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( gx , 1.0 ) ; return ;".split(" ")}]}}]},{a:"txt",b:"vec3 jo = normalize ( 2.0 * GLSL_TEXTURE ( u_ssao_special_tex , n * 0.25 / u_texel_size ) . rgb - 1.0 ) ; float gt = jn ( n ) ; float jp = gt * ( u_camera_range . y - u_camera_range . x ) ;".split(" ")},{a:"cond",d:[{a:"if",e:["SSAO_QUALITY","SSAO_QUALITY_8",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"const float jq = 8.0 ; const int jr = 1 ;".split(" ")}]}},
{a:"elif",e:["SSAO_QUALITY","SSAO_QUALITY_16",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"const float jq = 16.0 ; const int jr = 2 ;".split(" ")}]}},{a:"elif",e:["SSAO_QUALITY","SSAO_QUALITY_24",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"const float jq = 24.0 ; const int jr = 3 ;".split(" ")}]}},{a:"elif",e:["SSAO_QUALITY","SSAO_QUALITY_32",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"const float jq = 32.0 ; const int jr = 4 ;".split(" ")}]}}]},{a:"txt",b:"float js = u_ssao_radius_increase * 0.001 ; const float jt = 1.0 + 2.4 / jq ; float ju = 0.0 ; for ( int bQ = 0 ; bQ < jr ; bQ ++ ) for ( int x = - 1 ; x <= 1 ; x += 2 ) for ( int y = - 1 ; y <= 1 ; y += 2 ) for ( int z = - 1 ; z <= 1 ; z += 2 ) { vec3 jv = reflect ( normalize ( vec3 ( x , y , z ) ) , jo ) * ( js *= jt ) ; vec3 jw = vec3 ( n , jp ) ; jw += vec3 ( jv . xy , jv . z * jp * 2.0 ) ;".split(" ")},
{a:"cond",d:[{a:"if",e:["SSAO_HEMISPHERE"],h:{a:"grp",d:[{a:"txt",b:"jw . z -= 1.4 * ( jw . z - jp ) * step ( jp , jw . z ) ;".split(" ")}]}}]},{a:"txt",b:"float jx = jn ( jw . xy ) * ( u_camera_range . y - u_camera_range . x ) ; float jy = clamp ( ( jp - jx ) / jx , 0.0 , 1.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",e:["SSAO_HEMISPHERE"],h:{a:"grp",d:[{a:"txt",b:"ju += mix ( 1.0 , jy , step ( jx , jw . z ) ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"ju += mix ( step ( jw . z , jx ) , 0.5 , jy ) ;".split(" ")}]}}]},
{a:"txt",b:"} ju = ju / jq ;".split(" ")},{a:"cond",d:[{a:"if",e:["SSAO_HEMISPHERE"],h:{a:"grp",d:[{a:"txt",b:"ju = clamp ( ju * ju + 0.6 * ju , 0.0 , 1.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"ju = clamp ( ju * ju + ju , 0.0 , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:"float jz = u_ssao_influence * ( 1.0 - u_ssao_dist_factor * gt ) ; ju = mix ( 1.0 , ju , jz ) ; GLSL_OUT_FRAG_COLOR = vec4 ( gx , ju ) ; }".split(" ")}]};a["postprocessing/ssao_blur.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},
{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"SSAO_BLUR_DEPTH",b:["0"]},{a:"txt",b:["precision","PRECISION","sampler2D",";"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",e:["SSAO_BLUR_DEPTH"],h:{a:"grp",d:[{a:"include",o:"depth_fetch.glslf"}]}}]},{a:"txt",b:"uniform sampler2D u_ssao_mask ; uniform vec2 u_texel_size ; GLSL_IN vec2 n ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},{a:"cond",d:[{a:"if",e:["SSAO_BLUR_DEPTH"],h:{a:"grp",d:[{a:"txt",
b:"uniform sampler2D u_depth ; uniform vec2 u_camera_range ; uniform float u_ssao_blur_discard_value ; float jn ( in vec2 fQ ) { return gs ( u_depth , fQ , u_camera_range ) ; }".split(" ")}]}}]},{a:"txt",b:"void main ( ) { float jA = 0.0 ;".split(" ")},{a:"cond",d:[{a:"if",e:["SSAO_BLUR_DEPTH"],h:{a:"grp",d:[{a:"txt",b:"float jB = jn ( n ) ; float bU = 0.0 ; float jC = u_ssao_blur_discard_value * 100.0 ;".split(" ")}]}}]},{a:"txt",b:"vec2 jD = vec2 ( - 2.0 ) ; for ( int bQ = 0 ; bQ < 4 ; ++ bQ ) { for ( int he = 0 ; he < 4 ; ++ he ) { vec2 fE = ( jD + vec2 ( float ( bQ ) , float ( he ) ) ) * u_texel_size ; float jE = GLSL_TEXTURE ( u_ssao_mask , n + fE ) . a ;".split(" ")},
{a:"cond",d:[{a:"if",e:["SSAO_BLUR_DEPTH"],h:{a:"grp",d:[{a:"txt",b:"float jF = jn ( n + fE ) ; float jG = 1.0 - clamp ( abs ( jF - jB ) * jC , 0.0 , 1.0 ) ; jA += jE * jG ; bU += jG ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["jA","+=","jE",";"]}]}}]},{a:"txt",b:["}","}"]},{a:"cond",d:[{a:"if",e:["SSAO_BLUR_DEPTH"],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( GLSL_TEXTURE ( u_ssao_mask , n ) . rgb , jA / bU ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( GLSL_TEXTURE ( u_ssao_mask , n ) . rgb , jA / 16.0 ) ;".split(" ")}]}}]},
{a:"txt",b:["}"]}]};a["postprocessing/stereo.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"ANAGLYPH",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"txt",b:"uniform sampler2D u_sampler_left ; uniform sampler2D u_sampler_right ; GLSL_IN vec2 n ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},{a:"cond",d:[{a:"if",e:["ANAGLYPH",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"uniform int u_enable_hmd_stereo ; uniform vec4 u_distortion_params ; uniform vec4 u_chromatic_aberration_coefs ; void jQ ( vec2 bE , vec2 ad , float cM , sampler2D jH ) { vec2 jI = ( bE - ad ) * 2.0 ; jI /= cM ; float jJ = jI . x * jI . x + jI . y * jI . y ; vec2 jK = jI * ( 1.0 + u_distortion_params [ 0 ] * jJ + u_distortion_params [ 1 ] * jJ * jJ ) ; vec2 jL = jK * 0.5 / ( 1.0 + u_distortion_params [ 0 ] + u_distortion_params [ 1 ] ) ; if ( length ( u_chromatic_aberration_coefs ) > 0.0 ) { vec2 jM = jL * ( 1.0 + u_chromatic_aberration_coefs [ 0 ] + jJ * u_chromatic_aberration_coefs [ 1 ] ) + ad ; vec2 jN = jL + ad ; vec2 jO = jL * ( 1.0 + u_chromatic_aberration_coefs [ 2 ] + jJ * u_chromatic_aberration_coefs [ 3 ] ) + ad ; if ( clamp ( jO , 0.0 , 1.0 ) != jO ) { GLSL_OUT_FRAG_COLOR = vec4 ( 0.0 ) ; } else { vec4 jP = GLSL_TEXTURE ( jH , jN ) ; GLSL_OUT_FRAG_COLOR [ 0 ] = GLSL_TEXTURE ( jH , jM ) . x ; GLSL_OUT_FRAG_COLOR [ 1 ] = jP . y ; GLSL_OUT_FRAG_COLOR [ 2 ] = GLSL_TEXTURE ( jH , jO ) . z ; GLSL_OUT_FRAG_COLOR [ 3 ] = jP . w ; } } else { jL = jL * cM + ad ; if ( clamp ( jL , 0.0 , 1.0 ) != jL ) { GLSL_OUT_FRAG_COLOR = vec4 ( 0.0 ) ; } else { GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( jH , jL ) ; } } }".split(" ")}]}}]},
{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",e:["ANAGLYPH"],h:{a:"grp",d:[{a:"txt",b:"vec4 jR = GLSL_TEXTURE ( u_sampler_left , n ) ; vec4 jS = GLSL_TEXTURE ( u_sampler_right , n ) ; vec3 jT = vec3 ( jR [ 0 ] , jR [ 1 ] , jR [ 2 ] ) ; bY ( jT ) ; vec3 jU = vec3 ( jS [ 0 ] , jS [ 1 ] , jS [ 2 ] ) ; bY ( jU ) ; mat3 jV = mat3 ( 0.437 , - 0.062 , - 0.048 , 0.449 , - 0.062 , - 0.050 , 0.164 , - 0.024 , - 0.017 ) ; mat3 jW = mat3 ( - 0.011 , 0.377 , - 0.026 , - 0.032 , 0.761 , - 0.093 , - 0.007 , 0.009 , 1.234 ) ; vec3 aK = clamp ( jV * jT , 0.0 , 1.0 ) + clamp ( jW * jU , 0.0 , 1.0 ) ; aQ ( aK ) ; GLSL_OUT_FRAG_COLOR = vec4 ( aK , jR [ 3 ] + jS [ 3 ] ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"if ( u_enable_hmd_stereo != 0 ) { if ( n [ 0 ] < 0.5 ) { vec2 bE = vec2 ( 2.0 * n [ 0 ] , n [ 1 ] ) ; vec2 ad = vec2 ( 0.5 - ( u_distortion_params [ 3 ] - 0.5 ) / 2.0 , u_distortion_params [ 2 ] ) ; float cM = 2.0 * u_distortion_params [ 3 ] ; jQ ( bE , ad , cM , u_sampler_left ) ; } else { vec2 bE = vec2 ( 2.0 * ( n [ 0 ] - 0.5 ) , n [ 1 ] ) ; vec2 ad = vec2 ( 0.5 + ( u_distortion_params [ 3 ] - 0.5 ) / 2.0 , u_distortion_params [ 2 ] ) ; float cM = 2.0 * u_distortion_params [ 3 ] ; jQ ( bE , ad , cM , u_sampler_right ) ; } } else { GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_sampler_left , n ) ; }".split(" ")}]}}]},
{a:"txt",b:["}"]}]};a["postprocessing/velocity.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"pack.glslf"},{a:"txt",b:"uniform sampler2D u_depth ; uniform mat4 u_view_proj_inverse ; uniform mat4 u_view_proj_prev ; GLSL_IN vec2 n ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { float gt = GLSL_TEXTURE ( u_depth , n ) . x ; vec4 jX = vec4 ( n * 2.0 - 1.0 , 2.0 * gt - 1.0 , 1.0 ) ; vec4 cd = u_view_proj_inverse * jX ; vec4 jY = cd / cd . w ; vec4 jZ = u_view_proj_prev * jY ; jZ /= jZ . w ; vec2 cS = ( jX . xy - jZ . xy ) / 4.0 + 0.5 ; cS = clamp ( cS , 0.0 , 1.0 ) ; GLSL_OUT_FRAG_COLOR = gy ( cS ) ; }".split(" ")}]};
a["include/blending.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"BLENDING_GLSLF",h:{a:"grp",d:[{a:"define",c:"BLENDING_GLSLF",b:[""]},{a:"txt",b:"vec3 ka ( vec3 rgb ) { vec4 j_ = vec4 ( _0_0 , - _1_0 / 3.0 , 2.0 / 3.0 , - _1_0 ) ; vec4 p = mix ( vec4 ( rgb . bg , j_ . wz ) , vec4 ( rgb . gb , j_ . xy ) , step ( rgb . b , rgb . g ) ) ; vec4 q = mix ( vec4 ( p . xyw , rgb . r ) , vec4 ( rgb . r , p . yzx ) , step ( p . x , rgb . r ) ) ; float dg = q . x - min ( q . w , q . y ) ; float iu = 1.0e-10 ; return vec3 ( abs ( q . z + ( q . w - q . y ) / ( 6.0 * dg + iu ) ) , dg / ( q . x + iu ) , q . x ) ; } vec3 kc ( vec3 kb ) { vec4 j_ = vec4 ( _1_0 , 2.0 / 3.0 , _1_0 / 3.0 , 3.0 ) ; vec3 p = abs ( fract ( vec3 ( kb . r , kb . r , kb . r ) + j_ . xyz ) * 6.0 - j_ . www ) ; return kb . b * mix ( j_ . xxx , clamp ( p - j_ . xxx , _0_0 , _1_0 ) , kb . g ) ; } vec3 dP ( vec3 dL , vec3 dM , float dO ) { return mix ( dL , dM , dO ) ; } vec3 dQ ( vec3 dL , vec3 dM , float dO ) { return dO * dL + dM ; } vec3 dR ( vec3 dL , vec3 dM , float dO ) { return dM - dO * dL ; } vec3 dS ( vec3 dL , vec3 dM , float dO ) { float kd = _1_0 - dO ; return ( vec3 ( kd ) + dO * dL ) * dM ; } vec3 dT ( vec3 dL , vec3 dM , float dO ) { vec3 kd = vec3 ( _1_0 - dO ) ; return vec3 ( _1_0 ) - ( kd + dO * ( vec3 ( _1_0 ) - dL ) ) * ( vec3 ( _1_0 ) - dM ) ; } vec3 dU ( vec3 dL , vec3 dM , float dO ) { vec3 kd = vec3 ( _1_0 - dO ) ; return mix ( dM * ( kd + 2.0 * dO * dL ) , vec3 ( _1_0 ) - ( kd + 2.0 * dO * ( vec3 ( _1_0 ) - dL ) ) * ( vec3 ( _1_0 ) - dM ) , step ( 0.5 , dM ) ) ; } vec3 dV ( vec3 dL , vec3 dM , float dO ) { return mix ( dM , abs ( dL - dM ) , dO ) ; } vec3 dW ( vec3 dL , vec3 dM , float dO ) { return mix ( dM , dM / ( dL + step ( dL , vec3 ( _0_0 ) ) ) , dO ) ; } vec3 dX ( vec3 dL , vec3 dM , float dO ) { return mix ( dM , min ( dL , dM ) , dO ) ; } vec3 dY ( vec3 dL , vec3 dM , float dO ) { return max ( dO * dL , dM ) ; } vec3 dZ ( vec3 dL , vec3 dM , float dO ) { vec3 ke = ka ( dM ) ; if ( ke . y != _0_0 ) { vec3 kf = ka ( dL ) ; vec3 kg = kc ( vec3 ( ke . x , kf . yz ) ) ; return mix ( dL , kg , dO ) ; } return dL ; } vec3 d_ ( vec3 dL , vec3 dM , float dO ) { vec3 ke = ka ( dL ) ; if ( ke . y != _0_0 ) { vec3 kf = ka ( dM ) ; return kc ( vec3 ( ke . x , mix ( ke . y , kf . y , dO ) , ke . z ) ) ; } return dL ; } vec3 ea ( vec3 dL , vec3 dM , float dO ) { vec3 ke = ka ( dL ) ; vec3 kf = ka ( dM ) ; return kc ( vec3 ( ke . xy , mix ( ke . z , kf . z , dO ) ) ) ; } vec3 eb ( vec3 dL , vec3 dM , float dO ) { vec3 ke = ka ( dM ) ; if ( ke . y != _0_0 ) { vec3 kf = ka ( dL ) ; vec3 kg = kc ( vec3 ( ke . xy , kf . z ) ) ; return mix ( dL , kg , dO ) ; } return dL ; } vec3 ec ( vec3 dL , vec3 dM , float dO ) { vec3 kh = vec3 ( _1_0 ) - ( vec3 ( _1_0 ) - dM ) * ( vec3 ( _1_0 ) - dL ) ; return mix ( dL , ( ( vec3 ( _1_0 ) - dL ) * dM * dL ) + dL * kh , dO ) ; } vec3 ed ( vec3 dL , vec3 dM , float dO ) { return dL + dO * ( 2.0 * dM - _1_0 ) ; } float eh ( float ef , float eg , float dO , float dN ) { float kd = _1_0 - dN ; return ( kd + dO * ef ) * eg ; } float ei ( float ef , float eg , float dO , float dN ) { float kd = _1_0 - dN ; return _1_0 - ( kd + dO * ( _1_0 - ef ) ) * ( _1_0 - eg ) ; } float ej ( float ef , float eg , float dO , float dN ) { float kd = _1_0 - dN ; return mix ( eg * ( kd + 2.0 * dO * ef ) , _1_0 - ( kd + 2.0 * dO * ( _1_0 - ef ) ) * ( _1_0 - eg ) , step ( 0.5 , eg ) ) ; }".split(" ")}]}}]}]};
a["include/caustics.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"CAUSTICS_GLSLF",h:{a:"grp",d:[{a:"define",c:"CAUSTICS_GLSLF",b:[""]},{a:"var",c:"SUN_NUM",b:["0"]},{a:"var",c:"CAUST_SCALE",b:["0.25"]},{a:"var",c:"CAUST_SPEED",b:["vec2","(","0.0",")"]},{a:"var",c:"CAUST_BRIGHT",b:["0.5"]},{a:"include",o:"procedural.glslf"},{a:"include",o:"math.glslv"},{a:"define",c:"CAUSTICS_VIEW_DISTANCE",b:["100.0"]},{a:"txt",b:"void bs ( inout vec3 aK , float ki , float fq , vec4 bq , vec3 Q , vec3 kj , vec3 kk , vec4 kl , vec3 bi , float bo ) { if ( bo > CAUSTICS_VIEW_DISTANCE ) return ; vec3 km = bi + Q ; km . xz = 10.0 * sin ( 0.1 * km . xz ) ; vec3 ko = P ( kn ( kl ) , km ) ; vec2 bE = ko . xz ; vec3 kp = kj ; float kq = max ( dot ( Q , kp ) , 0.0 ) ; float kr = 0.025 ; vec2 ks = CAUST_SPEED * fq ; bE . s += 0.25 * sin ( dot ( bi + fq , vec3 ( 1.0 ) ) ) ; bE . t += 0.35 * ( - sin ( dot ( bi - fq , vec3 ( - 0.7 ) ) ) ) ; bE . st += 0.15 * cos ( 4.0 * ki - ks . x ) + 1.5 * sin ( ki - 0.3 * ks . y ) ; float hN = CAUST_SCALE * ( 1.0 + max ( 0.1 * ki , 0.0 ) ) ; vec3 ku = kt ( ( bE / hN ) , kr ) ; ku *= CAUST_BRIGHT ; ku *= ku ; float kv = min ( 0.25 * ki , - ki ) + 1.0 ; kv = max ( kv , 0.0 ) ; float kw = bq [ SUN_NUM ] * kq ; float kx = max ( sign ( ki ) , 0.0 ) ; kw = kw + max ( 0.5 * sign ( - Q . y ) * kx , 0.0 ) ; kw = min ( kw , 1.0 ) ; aK += kk * ku * kv * kw ; }".split(" ")}]}}]}]};
a["include/color_util.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"COLOR_UTIL_GLSLF",h:{a:"grp",d:[{a:"define",c:"COLOR_UTIL_GLSLF",b:[""]},{a:"define",c:"GAMMA",b:["1"]},{a:"define",c:"PREMULTIPLY_ALPHA",b:["1"]},{a:"txt",b:"void bY ( inout vec3 aK ) {".split(" ")},{a:"cond",d:[{a:"if",e:["GAMMA"],h:{a:"grp",d:[{a:"txt",b:"aK = max ( vec3 ( 0.0 ) , aK ) ; aK = pow ( aK , vec3 ( 2.2 ) ) ;".split(" ")}]}}]},{a:"txt",b:"} void bY ( inout float aK ) {".split(" ")},{a:"cond",d:[{a:"if",e:["GAMMA"],
h:{a:"grp",d:[{a:"txt",b:"aK = pow ( max ( 0.0 , aK ) , 2.2 ) ;".split(" ")}]}}]},{a:"txt",b:"} void aQ ( inout vec3 aK ) {".split(" ")},{a:"cond",d:[{a:"if",e:["GAMMA"],h:{a:"grp",d:[{a:"txt",b:"aK = max ( vec3 ( 0.0 ) , aK ) ; aK = pow ( aK , vec3 ( 1.0 / 2.2 ) ) ;".split(" ")}]}}]},{a:"txt",b:"} void aR ( inout vec3 aK , in float L ) {".split(" ")},{a:"cond",d:[{a:"if",e:["PREMULTIPLY_ALPHA"],h:{a:"grp",d:[{a:"txt",b:"aK = aK * L ;".split(" ")}]}}]},{a:"txt",b:"} float es ( vec4 aK ) { vec3 ky = vec3 ( 0.299 , 0.587 , 0.114 ) ; float kz = dot ( aK . rgb , ky ) ; return kz ; }".split(" ")}]}}]}]};
a["include/depth_fetch.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"DEPTH_FETCH_GLSLF",h:{a:"grp",d:[{a:"define",c:"DEPTH_FETCH_GLSLF",b:[""]},{a:"txt",b:"float gs ( in sampler2D kA , in vec2 fQ , in vec2 kB ) { float gt = GLSL_TEXTURE ( kA , fQ ) . r ; float dk = kB . x ; float kC = kB . y ; float kD = 2.0 * dk / ( dk + kC - ( 2.0 * gt - 1.0 ) * ( kC - dk ) ) ; return kD ; }".split(" ")}]}}]}]};a["include/dynamic_grass.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"DYNAMIC_GRASS_GLSLV",h:{a:"grp",
d:[{a:"define",c:"DYNAMIC_GRASS_GLSLV",b:[""]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"cond",d:[{a:"if",e:["DYNAMIC_GRASS"],h:{a:"grp",d:[{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"txt",b:"vec2 kH ( vec3 O , float kE , vec2 kF ) { vec2 kG = vec2 ( ( O . x - kF . x ) / kE , ( O . y - kF . y ) / kE ) ; return fract ( kG ) ; } vec2 kI ( vec2 gP , float kE , vec2 kF ) { return vec2 ( gP . x * kE , gP . y * kE ) + kF ; } ak kJ ( ) { return ak ( vec3 ( - 10000.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) ) ; } ak aT ( vec3 O , vec3 R , vec3 kK , vec3 S , vec3 Q , vec3 ad , PRECISION sampler2D kL , sampler2D kM , vec3 kN , float kO , vec3 kP , vec4 kQ , mat3 N ) { vec3 kR = P ( kQ , vec3 ( 0.0 , 0.0 , - 1.0 ) ) ; float kS = - kR . x ; float kT = kR . y ; vec2 kF = vec2 ( kP . x - kO * ( 1.0 + kS ) / 2.0 , kP . y - kO * ( 1.0 - kT ) / 2.0 ) ; vec2 kU = kH ( ad , kO , kF ) ; float kV = kO / 2.0 ; vec2 kW = abs ( kI ( kU - vec2 ( 0.5 ) , kO , vec2 ( 0.0 ) ) ) ; float kX = kV * ( 1.0 + sqrt ( 2.0 ) ) / 2.0 ; if ( length ( kW ) > kX ) return kJ ( ) ; float kY = kO / kN . z ; vec2 kZ = ( kU - vec2 ( 0.5 ) ) * kY + vec2 ( 0.5 ) ; vec3 k_ = kR * ( kO / kN . z - 1.0 ) / 2.0 ; kZ . x += k_ . x ; kZ . y += k_ . y ; vec4 la = GLSL_TEXTURE ( kM , kZ ) ; float hN = la . r ; if ( hN < u_scale_threshold ) return kJ ( ) ; float lb = kN . y - kN . x ; float bN = kN . y - GLSL_TEXTURE ( kL , kZ ) . r * lb ; vec2 lc = O . xy - ad . xy ; ad . xy = kI ( kU , kO , kF ) ; ad . z = bN ; O . xy = ad . xy + lc ; O . z *= hN ; O . z += bN ; vec3 aK = la . gba ;".split(" ")},
{a:"cond",d:[{a:"if",e:["BILLBOARD"],h:{a:"grp",d:[{a:"txt",b:"O -= ad ; mat3 ld = ai ( kP , ad , N ) ; ak am = al ( O , ad , R , kK , S , Q , ld ) ; am . ad = ad ; am . aK = aK ; return le ( am ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"return le ( ak ( O , ad , R , kK , S , Q , aK ) ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]}}]}]};a["include/environment.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"ENVIRONMENT_GLSLF",h:{a:"grp",d:[{a:"define",c:"ENVIRONMENT_GLSLF",b:[""]},{a:"var",
c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"txt",b:"vec3 ce ( vec3 Q ) {".split(" ")},{a:"cond",d:[{a:"if",e:["USE_ENVIRONMENT_LIGHT"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["SKY_TEXTURE"],h:{a:"grp",d:[{a:"txt",b:"return GLSL_TEXTURE_CUBE ( u_sky_texture , Q ) . rgb ;".split(" ")}]}},{a:"elif",e:["SKY_COLOR"],h:{a:"grp",d:[{a:"txt",b:"float lf = 0.5 * Q . z + 0.5 ; return mix ( u_horizon_color , u_zenith_color , lf ) ;".split(" ")}]}},{a:"else",
h:{a:"grp",d:[{a:"txt",b:"return vec3 ( 1.0 ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"return vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]};a["include/fog.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"FOG_GLSLF",h:{a:"grp",d:[{a:"define",c:"FOG_GLSLF",b:[""]},{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"FOG_TYPE",b:["QUADRATIC"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"cond",
d:[{a:"if",e:["USE_FOG"],h:{a:"grp",d:[{a:"txt",b:"void lk ( inout vec3 aK , in float lg , in float bN , in vec4 lh ) { float li = clamp ( ( lg - u_fog_params . z ) / u_fog_params . y , 0.0 , 1.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",e:["FOG_TYPE","QUADRATIC",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["li","*=","li",";"]}]}},{a:"elif",e:["FOG_TYPE","LINEAR",{a:"equal_expr",i:2}],h:{a:"grp",d:[]}},{a:"elif",e:["FOG_TYPE","INVERSE_QUADRATIC",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"li = sqrt ( li ) ;".split(" ")}]}}]},
{a:"txt",b:"if ( u_fog_params . w > 0.0 ) { if ( bN > u_fog_params . w ) li = 0.0 ; else { float lj = ( u_fog_params . w - max ( bN , 0.0 ) ) / u_fog_params . w ; li *= lj * lj ; } } lh . a = 1.0 - ( 1.0 - li ) * ( 1.0 - u_fog_params . x ) ; aK = mix ( aK , lh . rgb , lh . a ) ; }".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["PROCEDURAL_FOG"],h:{a:"grp",d:[{a:"txt",b:"vec3 lp ( in mat4 ll , in vec3 u ) { vec3 lm = mix ( ll [ 0 ] . rgb , ll [ 1 ] . rgb , max ( sign ( u . x ) , 0.0 ) ) ; vec3 ln = mix ( ll [ 2 ] . rgb , ll [ 3 ] . rgb , max ( sign ( u . z ) , 0.0 ) ) ; vec3 lo = vec3 ( ll [ 0 ] . a , ll [ 1 ] . a , ll [ 2 ] . a ) ; vec3 aK = mix ( lm , ln , abs ( u . z ) ) ; aK = mix ( aK , lo , abs ( u . y ) ) ; bY ( aK ) ; return aK ; }".split(" ")}]}}]},
{a:"cond",d:[{a:"if",e:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"void lr ( inout float lq ) { lq -= 0.5 ; lq = 4.0 * ( lq * lq * lq ) + 0.5 ; } void lx ( inout vec3 aK , in float lg , in vec3 u , in float eu , in vec4 ls , in float fh ) { float lt = max ( u . z , 0.0 ) ; float lu = max ( lg - max ( eu / lt , 0.0 ) , 0.0 ) ; float lv = ls . w * lu ; vec3 ev = vec3 ( 0.0 , 0.02 , 0.05 ) ; vec3 lw = ls . rgb ; lv = min ( lv , 1.0 ) ; lr ( lv ) ; lv *= clamp ( 2.0 - fh , 0.0 , 1.0 ) ; vec3 ew = mix ( lw , ev , min ( lt , 1.0 ) ) ; eu = clamp ( - eu * 0.03 , 0.0 , 0.8 ) ; ew *= 1.0 - eu ; aK = mix ( aK , ew , lv ) ; }".split(" ")}]}}]},
{a:"txt",b:"void bt ( inout vec3 aK , float lg , vec3 u , float bp ) {".split(" ")},{a:"cond",d:[{a:"if",e:["USE_FOG"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["PROCEDURAL_FOG"],h:{a:"grp",d:[{a:"txt",b:"vec3 ll = lp ( u_cube_fog , u ) ; vec4 ew = vec4 ( ll , u_fog_color_density . a ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec4","ew","=","u_fog_color_density",";"]}]}}]},{a:"txt",b:"lk ( aK , lg , c . z , ew ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",
b:"lx ( aK , lg , u , u_cam_water_depth , u_underwater_fog_color_density , bp ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]};a["include/fxaa.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"FXAA_GLSLF",h:{a:"grp",d:[{a:"define",c:"FXAA_GLSLF",b:[""]},{a:"var",c:"FXAA_BLEND4WEB",b:["1"]},{a:"var",c:"FXAA_QUALITY_P12",b:["0.0"]},{a:"cond",d:[{a:"ifndef",c:"FXAA_PS3",h:{a:"grp",d:[{a:"define",c:"FXAA_PS3",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_360",h:{a:"grp",d:[{a:"define",c:"FXAA_360",b:["0"]}]}}]},
{a:"cond",d:[{a:"ifndef",c:"FXAA_360_OPT",h:{a:"grp",d:[{a:"define",c:"FXAA_360_OPT",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_PC",h:{a:"grp",d:[{a:"define",c:"FXAA_PC",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_PC_CONSOLE",h:{a:"grp",d:[{a:"define",c:"FXAA_PC_CONSOLE",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_GLSL_120",h:{a:"grp",d:[{a:"define",c:"FXAA_GLSL_120",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_GLSL_130",h:{a:"grp",d:[{a:"define",c:"FXAA_GLSL_130",b:["0"]}]}}]},{a:"cond",
d:[{a:"ifndef",c:"FXAA_HLSL_3",h:{a:"grp",d:[{a:"define",c:"FXAA_HLSL_3",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_HLSL_4",h:{a:"grp",d:[{a:"define",c:"FXAA_HLSL_4",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_HLSL_5",h:{a:"grp",d:[{a:"define",c:"FXAA_HLSL_5",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_GREEN_AS_LUMA",h:{a:"grp",d:[{a:"define",c:"FXAA_GREEN_AS_LUMA",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_EARLY_EXIT",h:{a:"grp",d:[{a:"define",c:"FXAA_EARLY_EXIT",b:["1"]}]}}]},{a:"cond",
d:[{a:"ifndef",c:"FXAA_DISCARD",h:{a:"grp",d:[{a:"define",c:"FXAA_DISCARD",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_FAST_PIXEL_OFFSET",h:{a:"grp",d:[{a:"cond",d:[{a:"ifdef",c:"GL_EXT_gpu_shader4",h:{a:"grp",d:[{a:"define",c:"FXAA_FAST_PIXEL_OFFSET",b:["1"]}]}}]},{a:"cond",d:[{a:"ifdef",c:"GL_NV_gpu_shader5",h:{a:"grp",d:[{a:"define",c:"FXAA_FAST_PIXEL_OFFSET",b:["1"]}]}}]},{a:"cond",d:[{a:"ifdef",c:"GL_ARB_gpu_shader5",h:{a:"grp",d:[{a:"define",c:"FXAA_FAST_PIXEL_OFFSET",b:["1"]}]}}]},{a:"cond",
d:[{a:"ifndef",c:"FXAA_FAST_PIXEL_OFFSET",h:{a:"grp",d:[{a:"define",c:"FXAA_FAST_PIXEL_OFFSET",b:["0"]}]}}]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_GATHER4_ALPHA",h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["FXAA_HLSL_5",1,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_GATHER4_ALPHA",b:["1"]}]}}]},{a:"cond",d:[{a:"ifdef",c:"GL_ARB_gpu_shader5",h:{a:"grp",d:[{a:"define",c:"FXAA_GATHER4_ALPHA",b:["1"]}]}}]},{a:"cond",d:[{a:"ifdef",c:"GL_NV_gpu_shader5",h:{a:"grp",d:[{a:"define",c:"FXAA_GATHER4_ALPHA",
b:["1"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_GATHER4_ALPHA",h:{a:"grp",d:[{a:"define",c:"FXAA_GATHER4_ALPHA",b:["0"]}]}}]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:[1],h:{a:"grp",d:[{a:"define",c:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",e:[0],h:{a:"grp",d:[{a:"define",c:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",b:["4.0"]}]}}]},{a:"cond",d:[{a:"if",e:[0],h:{a:"grp",d:[{a:"define",c:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",
b:["2.0"]}]}}]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_CONSOLE_PS3_EDGE_THRESHOLD",h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:[1],h:{a:"grp",d:[{a:"define",c:"FXAA_CONSOLE_PS3_EDGE_THRESHOLD",b:["0.125"]}]}},{a:"else",h:{a:"grp",d:[{a:"define",c:"FXAA_CONSOLE_PS3_EDGE_THRESHOLD",b:["0.25"]}]}}]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_QUALITY_PRESET",h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PRESET",b:["12"]}]}}]},{a:"cond",d:[{a:"if",e:["FXAA_QUALITY_PRESET",10,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",
c:"FXAA_QUALITY_PS",b:["3"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P1",b:["3.0"]},{a:"define",c:"FXAA_QUALITY_P2",b:["12.0"]}]}}]},{a:"cond",d:[{a:"if",e:["FXAA_QUALITY_PRESET",11,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["4"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["3.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["12.0"]}]}}]},{a:"cond",d:[{a:"if",e:["FXAA_QUALITY_PRESET",
12,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["5"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["12.0"]}]}}]},{a:"cond",d:[{a:"if",e:["FXAA_QUALITY_PRESET",13,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["6"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",
b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["12.0"]}]}}]},{a:"cond",d:[{a:"if",e:["FXAA_QUALITY_PRESET",14,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["7"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",
b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["12.0"]}]}}]},{a:"cond",d:[{a:"if",e:["FXAA_QUALITY_PRESET",15,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["8"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",
b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["12.0"]}]}}]},{a:"cond",d:[{a:"if",e:["FXAA_QUALITY_PRESET",20,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["3"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P1",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P2",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",e:["FXAA_QUALITY_PRESET",21,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["4"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",
c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",e:["FXAA_QUALITY_PRESET",22,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["5"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",e:["FXAA_QUALITY_PRESET",
23,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["6"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",e:["FXAA_QUALITY_PRESET",24,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["7"]},{a:"define",c:"FXAA_QUALITY_P0",
b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["3.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",e:["FXAA_QUALITY_PRESET",25,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["8"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",
b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",e:["FXAA_QUALITY_PRESET",26,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["9"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",
b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P8",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",e:["FXAA_QUALITY_PRESET",27,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["10"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",
b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P8",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P9",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",e:["FXAA_QUALITY_PRESET",28,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["11"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",
b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P8",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P9",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P10",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",e:["FXAA_QUALITY_PRESET",29,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["12"]},{a:"define",c:"FXAA_QUALITY_P0",
b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P8",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P9",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P10",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P11",b:["8.0"]}]}}]},{a:"cond",
d:[{a:"if",e:["FXAA_QUALITY_PRESET",39,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["12"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P2",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P6",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P8",b:["2.0"]},
{a:"define",c:"FXAA_QUALITY_P9",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P10",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P11",b:["8.0"]}]}}]},{a:"include",o:"color_util.glslf"},{a:"txt",b:"float ly ( float x ) { return clamp ( x , 0.0 , 1.0 ) ; }".split(" ")},{a:"cond",d:[{a:"if",e:["FXAA_BLEND4WEB",1,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 lz ( sampler2D t , vec2 p ) { return GLSL_TEXTURE ( t , p ) ; } vec4 lB ( sampler2D t , vec2 p , vec2 lA , vec2 r ) { return GLSL_TEXTURE ( t , p + ( lA * r ) ) ; }".split(" ")}]}}]},
{a:"txt",b:"vec4 gn ( vec2 fj , sampler2D hT , vec2 lC , float lD , float lE , float lF ) { vec2 lG ; lG . x = fj . x ; lG . y = fj . y ;".split(" ")},{a:"cond",d:[{a:"if",e:["FXAA_GATHER4_ALPHA",1,{a:"equal_expr",i:2}],h:{a:"grp",d:[]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 lH = lz ( hT , lG ) ; float fX = es ( lH ) ; float lI = es ( lB ( hT , lG , vec2 ( 0 , 1 ) , lC . xy ) ) ; float lJ = es ( lB ( hT , lG , vec2 ( 1 , 0 ) , lC . xy ) ) ; float lK = es ( lB ( hT , lG , vec2 ( 0 , - 1 ) , lC . xy ) ) ; float lL = es ( lB ( hT , lG , vec2 ( - 1 , 0 ) , lC . xy ) ) ;".split(" ")}]}}]},
{a:"txt",b:"float lM = max ( lI , fX ) ; float lN = min ( lI , fX ) ; float lO = max ( lJ , lM ) ; float lP = min ( lJ , lN ) ; float lQ = max ( lK , lL ) ; float lR = min ( lK , lL ) ; float lS = max ( lQ , lO ) ; float lT = min ( lR , lP ) ; float lU = lS * lE ; float lV = lS - lT ; float lW = max ( lF , lU ) ; bool lX = lV < lW ; if ( lX ) return lH ;".split(" ")},{a:"cond",d:[{a:"if",e:["FXAA_GATHER4_ALPHA",0,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float fY = es ( lB ( hT , lG , vec2 ( - 1 , - 1 ) , lC . xy ) ) ; float gc = es ( lB ( hT , lG , vec2 ( 1 , 1 ) , lC . xy ) ) ; float fZ = es ( lB ( hT , lG , vec2 ( 1 , - 1 ) , lC . xy ) ) ; float f_ = es ( lB ( hT , lG , vec2 ( - 1 , 1 ) , lC . xy ) ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[]}}]},{a:"txt",b:"float lY = lK + lI ; float lZ = lL + lJ ; float l_ = 1.0 / lV ; float ma = lY + lZ ; float mb = ( - 2.0 * fX ) + lY ; float mc = ( - 2.0 * fX ) + lZ ; float md = fZ + gc ; float me = fY + fZ ; float mf = ( - 2.0 * lJ ) + md ; float mg = ( - 2.0 * lK ) + me ; float mh = fY + f_ ; float mi = f_ + gc ; float mj = ( abs ( mb ) * 2.0 ) + abs ( mf ) ; float mk = ( abs ( mc ) * 2.0 ) + abs ( mg ) ; float ml = ( - 2.0 * lL ) + mh ; float mm = ( - 2.0 * lI ) + mi ; float mn = abs ( ml ) + mj ; float mo = abs ( mm ) + mk ; float mp = mh + md ; float mq = lC . x ; bool mr = mn >= mo ; float ms = ma * 2.0 + mp ; if ( ! mr ) lK = lL ; if ( ! mr ) lI = lJ ; if ( mr ) mq = lC . y ; float mt = ( ms * ( 1.0 / 12.0 ) ) - fX ; float mu = lK - fX ; float mv = lI - fX ; float mw = lK + fX ; float mx = lI + fX ; bool my = abs ( mu ) >= abs ( mv ) ; float mz = max ( abs ( mu ) , abs ( mv ) ) ; if ( my ) mq = - mq ; float mA = ly ( abs ( mt ) * l_ ) ; vec2 mB ; mB . x = lG . x ; mB . y = lG . y ; vec2 mC ; mC . x = ( ! mr ) ? 0.0 : lC . x ; mC . y = ( mr ) ? 0.0 : lC . y ; if ( ! mr ) mB . x += mq * 0.5 ; if ( mr ) mB . y += mq * 0.5 ; vec2 mD ; mD . x = mB . x - mC . x * FXAA_QUALITY_P0 ; mD . y = mB . y - mC . y * FXAA_QUALITY_P0 ; vec2 mE ; mE . x = mB . x + mC . x * FXAA_QUALITY_P0 ; mE . y = mB . y + mC . y * FXAA_QUALITY_P0 ; float mF = ( ( - 2.0 ) * mA ) + 3.0 ; float mG = es ( lz ( hT , mD ) ) ; float mH = mA * mA ; float mI = es ( lz ( hT , mE ) ) ; if ( ! my ) mw = mx ; float mJ = mz * 1.0 / 4.0 ; float mK = fX - mw * 0.5 ; float mL = mF * mH ; bool mM = mK < 0.0 ; mG -= mw * 0.5 ; mI -= mw * 0.5 ; bool mN = abs ( mG ) >= mJ ; bool mO = abs ( mI ) >= mJ ; if ( ! mN ) mD . x -= mC . x * FXAA_QUALITY_P1 ; if ( ! mN ) mD . y -= mC . y * FXAA_QUALITY_P1 ; bool mP = ( ! mN ) || ( ! mO ) ; if ( ! mO ) mE . x += mC . x * FXAA_QUALITY_P1 ; if ( ! mO ) mE . y += mC . y * FXAA_QUALITY_P1 ; if ( mP ) { if ( ! mN ) mG = es ( lz ( hT , mD . xy ) ) ; if ( ! mO ) mI = es ( lz ( hT , mE . xy ) ) ; if ( ! mN ) mG = mG - mw * 0.5 ; if ( ! mO ) mI = mI - mw * 0.5 ; mN = abs ( mG ) >= mJ ; mO = abs ( mI ) >= mJ ; if ( ! mN ) mD . x -= mC . x * FXAA_QUALITY_P2 ; if ( ! mN ) mD . y -= mC . y * FXAA_QUALITY_P2 ; mP = ( ! mN ) || ( ! mO ) ; if ( ! mO ) mE . x += mC . x * FXAA_QUALITY_P2 ; if ( ! mO ) mE . y += mC . y * FXAA_QUALITY_P2 ;".split(" ")},
{a:"cond",d:[{a:"if",e:["FXAA_QUALITY_PS",3,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mP ) { if ( ! mN ) mG = es ( lz ( hT , mD . xy ) ) ; if ( ! mO ) mI = es ( lz ( hT , mE . xy ) ) ; if ( ! mN ) mG = mG - mw * 0.5 ; if ( ! mO ) mI = mI - mw * 0.5 ; mN = abs ( mG ) >= mJ ; mO = abs ( mI ) >= mJ ; if ( ! mN ) mD . x -= mC . x * FXAA_QUALITY_P3 ; if ( ! mN ) mD . y -= mC . y * FXAA_QUALITY_P3 ; mP = ( ! mN ) || ( ! mO ) ; if ( ! mO ) mE . x += mC . x * FXAA_QUALITY_P3 ; if ( ! mO ) mE . y += mC . y * FXAA_QUALITY_P3 ;".split(" ")},
{a:"cond",d:[{a:"if",e:["FXAA_QUALITY_PS",4,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mP ) { if ( ! mN ) mG = es ( lz ( hT , mD . xy ) ) ; if ( ! mO ) mI = es ( lz ( hT , mE . xy ) ) ; if ( ! mN ) mG = mG - mw * 0.5 ; if ( ! mO ) mI = mI - mw * 0.5 ; mN = abs ( mG ) >= mJ ; mO = abs ( mI ) >= mJ ; if ( ! mN ) mD . x -= mC . x * FXAA_QUALITY_P4 ; if ( ! mN ) mD . y -= mC . y * FXAA_QUALITY_P4 ; mP = ( ! mN ) || ( ! mO ) ; if ( ! mO ) mE . x += mC . x * FXAA_QUALITY_P4 ; if ( ! mO ) mE . y += mC . y * FXAA_QUALITY_P4 ;".split(" ")},
{a:"cond",d:[{a:"if",e:["FXAA_QUALITY_PS",5,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mP ) { if ( ! mN ) mG = es ( lz ( hT , mD . xy ) ) ; if ( ! mO ) mI = es ( lz ( hT , mE . xy ) ) ; if ( ! mN ) mG = mG - mw * 0.5 ; if ( ! mO ) mI = mI - mw * 0.5 ; mN = abs ( mG ) >= mJ ; mO = abs ( mI ) >= mJ ; if ( ! mN ) mD . x -= mC . x * FXAA_QUALITY_P5 ; if ( ! mN ) mD . y -= mC . y * FXAA_QUALITY_P5 ; mP = ( ! mN ) || ( ! mO ) ; if ( ! mO ) mE . x += mC . x * FXAA_QUALITY_P5 ; if ( ! mO ) mE . y += mC . y * FXAA_QUALITY_P5 ;".split(" ")},
{a:"cond",d:[{a:"if",e:["FXAA_QUALITY_PS",6,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mP ) { if ( ! mN ) mG = es ( lz ( hT , mD . xy ) ) ; if ( ! mO ) mI = es ( lz ( hT , mE . xy ) ) ; if ( ! mN ) mG = mG - mw * 0.5 ; if ( ! mO ) mI = mI - mw * 0.5 ; mN = abs ( mG ) >= mJ ; mO = abs ( mI ) >= mJ ; if ( ! mN ) mD . x -= mC . x * FXAA_QUALITY_P6 ; if ( ! mN ) mD . y -= mC . y * FXAA_QUALITY_P6 ; mP = ( ! mN ) || ( ! mO ) ; if ( ! mO ) mE . x += mC . x * FXAA_QUALITY_P6 ; if ( ! mO ) mE . y += mC . y * FXAA_QUALITY_P6 ;".split(" ")},
{a:"cond",d:[{a:"if",e:["FXAA_QUALITY_PS",7,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mP ) { if ( ! mN ) mG = es ( lz ( hT , mD . xy ) ) ; if ( ! mO ) mI = es ( lz ( hT , mE . xy ) ) ; if ( ! mN ) mG = mG - mw * 0.5 ; if ( ! mO ) mI = mI - mw * 0.5 ; mN = abs ( mG ) >= mJ ; mO = abs ( mI ) >= mJ ; if ( ! mN ) mD . x -= mC . x * FXAA_QUALITY_P7 ; if ( ! mN ) mD . y -= mC . y * FXAA_QUALITY_P7 ; mP = ( ! mN ) || ( ! mO ) ; if ( ! mO ) mE . x += mC . x * FXAA_QUALITY_P7 ; if ( ! mO ) mE . y += mC . y * FXAA_QUALITY_P7 ;".split(" ")},
{a:"cond",d:[{a:"if",e:["FXAA_QUALITY_PS",8,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mP ) { if ( ! mN ) mG = es ( lz ( hT , mD . xy ) ) ; if ( ! mO ) mI = es ( lz ( hT , mE . xy ) ) ; if ( ! mN ) mG = mG - mw * 0.5 ; if ( ! mO ) mI = mI - mw * 0.5 ; mN = abs ( mG ) >= mJ ; mO = abs ( mI ) >= mJ ; if ( ! mN ) mD . x -= mC . x * FXAA_QUALITY_P8 ; if ( ! mN ) mD . y -= mC . y * FXAA_QUALITY_P8 ; mP = ( ! mN ) || ( ! mO ) ; if ( ! mO ) mE . x += mC . x * FXAA_QUALITY_P8 ; if ( ! mO ) mE . y += mC . y * FXAA_QUALITY_P8 ;".split(" ")},
{a:"cond",d:[{a:"if",e:["FXAA_QUALITY_PS",9,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mP ) { if ( ! mN ) mG = es ( lz ( hT , mD . xy ) ) ; if ( ! mO ) mI = es ( lz ( hT , mE . xy ) ) ; if ( ! mN ) mG = mG - mw * 0.5 ; if ( ! mO ) mI = mI - mw * 0.5 ; mN = abs ( mG ) >= mJ ; mO = abs ( mI ) >= mJ ; if ( ! mN ) mD . x -= mC . x * FXAA_QUALITY_P9 ; if ( ! mN ) mD . y -= mC . y * FXAA_QUALITY_P9 ; mP = ( ! mN ) || ( ! mO ) ; if ( ! mO ) mE . x += mC . x * FXAA_QUALITY_P9 ; if ( ! mO ) mE . y += mC . y * FXAA_QUALITY_P9 ;".split(" ")},
{a:"cond",d:[{a:"if",e:["FXAA_QUALITY_PS",10,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mP ) { if ( ! mN ) mG = es ( lz ( hT , mD . xy ) ) ; if ( ! mO ) mI = es ( lz ( hT , mE . xy ) ) ; if ( ! mN ) mG = mG - mw * 0.5 ; if ( ! mO ) mI = mI - mw * 0.5 ; mN = abs ( mG ) >= mJ ; mO = abs ( mI ) >= mJ ; if ( ! mN ) mD . x -= mC . x * FXAA_QUALITY_P10 ; if ( ! mN ) mD . y -= mC . y * FXAA_QUALITY_P10 ; mP = ( ! mN ) || ( ! mO ) ; if ( ! mO ) mE . x += mC . x * FXAA_QUALITY_P10 ; if ( ! mO ) mE . y += mC . y * FXAA_QUALITY_P10 ;".split(" ")},
{a:"cond",d:[{a:"if",e:["FXAA_QUALITY_PS",11,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mP ) { if ( ! mN ) mG = es ( lz ( hT , mD . xy ) ) ; if ( ! mO ) mI = es ( lz ( hT , mE . xy ) ) ; if ( ! mN ) mG = mG - mw * 0.5 ; if ( ! mO ) mI = mI - mw * 0.5 ; mN = abs ( mG ) >= mJ ; mO = abs ( mI ) >= mJ ; if ( ! mN ) mD . x -= mC . x * FXAA_QUALITY_P11 ; if ( ! mN ) mD . y -= mC . y * FXAA_QUALITY_P11 ; mP = ( ! mN ) || ( ! mO ) ; if ( ! mO ) mE . x += mC . x * FXAA_QUALITY_P11 ; if ( ! mO ) mE . y += mC . y * FXAA_QUALITY_P11 ;".split(" ")},
{a:"cond",d:[{a:"if",e:["FXAA_QUALITY_PS",12,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mP ) { if ( ! mN ) mG = es ( lz ( hT , mD . xy ) ) ; if ( ! mO ) mI = es ( lz ( hT , mE . xy ) ) ; if ( ! mN ) mG = mG - mw * 0.5 ; if ( ! mO ) mI = mI - mw * 0.5 ; mN = abs ( mG ) >= mJ ; mO = abs ( mI ) >= mJ ; if ( ! mN ) mD . x -= mC . x * FXAA_QUALITY_P12 ; if ( ! mN ) mD . y -= mC . y * FXAA_QUALITY_P12 ; mP = ( ! mN ) || ( ! mO ) ; if ( ! mO ) mE . x += mC . x * FXAA_QUALITY_P12 ; if ( ! mO ) mE . y += mC . y * FXAA_QUALITY_P12 ; }".split(" ")}]}}]},
{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:"} float mQ = lG . x - mD . x ; float mR = mE . x - lG . x ; if ( ! mr ) mQ = lG . y - mD . y ; if ( ! mr ) mR = mE . y - lG . y ; bool mS = ( mG < 0.0 ) != mM ; float mT = ( mR + mQ ) ; bool mU = ( mI < 0.0 ) != mM ; float mV = 1.0 / mT ; bool mW = mQ < mR ; float mX = min ( mQ , mR ) ; bool mY = mW ? mS : mU ; float mZ = mL * mL ; float m_ = ( mX * ( - mV ) ) + 0.5 ; float na = mZ * lD ; float nb = mY ? m_ : 0.0 ; float nc = max ( nb , na ) ; if ( ! mr ) lG . x += nc * mq ; if ( mr ) lG . y += nc * mq ;".split(" ")},
{a:"cond",d:[{a:"if",e:["FXAA_DISCARD",1,{a:"equal_expr",i:2},"FXAA_BLEND4WEB",1,{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return lz ( hT , lG ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"return vec4 ( lz ( hT , lG ) . xyz , fX ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]};a["include/halo_color.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"HALO_COLOR_GLSLF",h:{a:"grp",d:[{a:"define",c:"HALO_COLOR_GLSLF",b:[""]},{a:"var",c:"NUM_RINGS",b:["0"]},{a:"var",
c:"NUM_LINES",b:["0"]},{a:"var",c:"NUM_STARS",b:["0"]},{a:"var",c:"SKY_STARS",b:["0"]},{a:"var",c:"WAVES_HEIGHT",b:["1.0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"cond",d:[{a:"if",e:["NUM_RINGS","NUM_LINES",{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"const int nd = NUM_RINGS ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"const int nd = NUM_LINES ;".split(" ")}]}}]},{a:"txt",b:"float ne ( float x ) { return x - floor ( x * ( 1.0 / 0.01 ) ) * 0.01 ; }".split(" ")},
{a:"cond",d:[{a:"if",e:["NUM_RINGS"],h:{a:"grp",d:[{a:"txt",b:"void nl ( inout float nf , in float ng [ nd ] , in float nh ) { for ( int a = 0 ; a < NUM_RINGS ; a ++ ) { float ni = 40.0 * ng [ a ] ; float nj = 300.0 * ( ne ( ni ) - 0.005 ) ; float nk = ni ; float li = abs ( nk * ( u_halo_size * nj - nh ) ) ; nf += 1.0 - min ( li , 1.0 ) ; } }".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["NUM_LINES"],h:{a:"grp",d:[{a:"txt",b:"void nq ( inout float nm , in float ng [ nd ] , in float aG ) { for ( int a = 0 ; a < NUM_LINES ; a ++ ) { float nn = ng [ a ] ; float no = nn ; float np = 1000.0 * ( ne ( nn ) - 0.005 ) ; float li = 20.0 * abs ( no * n . x + np * n . y ) ; nm += 1.0 - min ( li , 1.0 ) ; } nm *= aG ; }".split(" ")}]}}]},
{a:"txt",b:"void nu ( inout float aG , in vec2 bE ) { float nr , bl ; bl = atan ( bE . y , bE . x ) ; bl *= ( 1.0 + 0.25 * float ( NUM_STARS ) ) ; float ns = cos ( bl ) ; float nt = sin ( bl ) ; bl = ( ns * bE . x + nt * bE . y ) * ( ns * bE . y - nt * bE . x ) ; nr = abs ( bl ) ; if ( nr < 1.0 ) { nr = ( 0.01 * u_halo_size ) / ( nr ) ; aG *= sqrt ( min ( nr , 1.0 ) ) ; } } vec4 aZ ( ) { float aG = ( n . x * n . x + n . y * n . y ) ; float nh = sqrt ( aG ) ; aG = max ( 1.0 - aG , 0.0 ) ; aG = pow ( aG , u_halo_hardness ) ; float L = u_diffuse_color . a ;".split(" ")},
{a:"cond",d:[{a:"if",e:["NUM_RINGS","NUM_LINES",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float ng [ nd ] ; for ( int bQ = 0 ; bQ < nd ; bQ ++ ) { ng [ bQ ] = fract ( aY / float ( bQ + 1 ) ) - 1.0 ; }".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["NUM_RINGS"],h:{a:"grp",d:[{a:"txt",b:"float nf = 0.0 ; nl ( nf , ng , nh ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["NUM_LINES"],h:{a:"grp",d:[{a:"txt",b:"float nm = 0.0 ; nq ( nm , ng , aG ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["NUM_STARS"],
h:{a:"grp",d:[{a:"txt",b:"nu ( aG , n ) ;".split(" ")}]}}]},{a:"txt",b:"aG *= L ; vec3 aK = u_diffuse_color . rgb ;".split(" ")},{a:"cond",d:[{a:"if",e:["NUM_RINGS"],h:{a:"grp",d:[{a:"txt",b:"nf *= aG ; aK += u_halo_rings_color * nf ; aG += nf ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["NUM_LINES"],h:{a:"grp",d:[{a:"txt",b:"nm *= L ; aK += u_halo_lines_color * nm ; aG += nm ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["SKY_STARS"],h:{a:"grp",d:[{a:"txt",b:"aG *= max ( 1.0 - 2.0 * u_sun_intensity . x , 0.0 ) ;".split(" ")},
{a:"cond",d:[{a:"if",e:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float kv = u_halo_stars_blend * ( aX . y - u_halo_stars_height ) ; aG *= clamp ( kv , 0.0 , 1.0 ) ; aG *= min ( u_cam_water_depth + 2.0 * WAVES_HEIGHT , 1.0 ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:"vec4 nv = vec4 ( aK , aG ) ; return nv ; }".split(" ")}]}}]}]};a["include/lighting_nodes.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"LIGHTING_NODES_GLSLF",h:{a:"grp",
d:[{a:"define",c:"LIGHTING_NODES_GLSLF",b:[""]},{a:"include",o:"std.glsl"},{a:"node",c:"LIGHTING_BEGIN",m:[],l:[{a:"node_out",c:"nI",g:["vec3"],f:!1},{a:"node_out",c:"nJ",g:["vec3"],f:!1},{a:"node_out",c:"nK",g:["vec3"],f:!1},{a:"node_out",c:"nL",g:["vec3"],f:!0},{a:"node_out",c:"nM",g:["vec3"],f:!0},{a:"node_out",c:"nN",g:["vec2"],f:!0},{a:"node_out",c:"nO",g:["vec2"],f:!0},{a:"node_out",c:"nP",g:["vec4"],f:!0},{a:"node_out",c:"nQ",g:["float"],f:!0},{a:"node_out",c:"nR",g:["vec4"],f:!0}],j:[{a:"txt",
b:"nI = nw ; nJ = nx ; nK = ny ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_nL"],j:[{a:"txt",b:["nL","=","nz",";"]}]}]},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_nM"],j:[{a:"txt",b:["nM","=","nB",";"]}]}]},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_nO"],j:[{a:"txt",b:["nO","=","nC",";"]}]}]},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_nN"],j:[{a:"txt",b:["nN","=","nD",";"]}]}]},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_nP"],j:[{a:"txt",b:["nP","=","nE",";"]}]}]},{a:"node_cond",d:[{a:"node_if",
e:["USE_OUT_nQ"],j:[{a:"txt",b:["nQ","=","nF",";"]}]}]},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_nR"],j:[{a:"txt",b:["nR","=","nG",";"]}]}]}]},{a:"node",c:"LIGHTING_AMBIENT",m:[],l:[{a:"node_in",c:"nS",g:["vec3"],f:!1},{a:"node_in",c:"nT",g:["vec3"],f:!1},{a:"node_in",c:"nU",g:["vec3"],f:!1},{a:"node_out",c:"nV",g:["vec4"],f:!1},{a:"node_out",c:"nW",g:["vec3"],f:!1}],j:[{a:"txt",b:"nV = vec4 ( nS + nU * nT , _0_0 ) ; nW = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"LIGHTING_LAMP",m:[{a:"node_var",
c:"LAMP_TYPE",b:["HEMI"]},{a:"node_var",c:"LAMP_IND",b:["0"]},{a:"node_var",c:"LAMP_LIGHT_FACT_IND",b:["0"]},{a:"node_var",c:"LAMP_FAC_CHANNELS",b:["rg"]},{a:"node_var",c:"LAMP_SPOT_SIZE",b:["0.8"]},{a:"node_var",c:"LAMP_SPOT_BLEND",b:["0.03"]},{a:"node_var",c:"LAMP_LIGHT_DIST",b:["30.0"]},{a:"node_var",c:"LAMP_SHADOW_MAP_IND",b:["-","1"]}],l:[{a:"node_in",c:"nX",g:["vec4"],f:!1},{a:"node_out",c:"nY",g:["vec3"],f:!1},{a:"node_out",c:"nZ",g:["vec2"],f:!1},{a:"node_out",c:"n_",g:["vec3"],f:!1},{a:"node_out",
c:"oa",g:["float"],f:!1}],j:[{a:"txt",b:"nZ = u_light_factors [ LAMP_LIGHT_FACT_IND ] . LAMP_FAC_CHANNELS ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["LAMP_TYPE","HEMI",{a:"equal_expr",i:2}],j:[{a:"txt",b:["oa","=","_0_5",";"]}]},{a:"node_else",j:[{a:"txt",b:["oa","=","_0_0",";"]}]}]},{a:"txt",b:"n_ = u_light_color_intensities [ LAMP_IND ] ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["LAMP_SHADOW_MAP_IND",1,{a:"negative_expr",i:1},{a:"non_equal_expr",i:2}],j:[{a:"txt",b:"n_ *= nX [ LAMP_SHADOW_MAP_IND ] ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",e:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2},"LAMP_TYPE","POINT",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"vec3 ob = u_light_positions [ LAMP_IND ] ; nY = ob - nA ; float aG = length ( nY ) ; n_ *= LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + aG * aG ) ; nY = normalize ( nY ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vec3 oc = u_light_directions [ LAMP_IND ] ; float od = dot ( nY , oc ) ; od *= smoothstep ( _0_0 , _1_0 , ( od - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; n_ *= od ;".split(" ")}]}]}]},
{a:"node_else",j:[{a:"txt",b:"nY = u_light_directions [ LAMP_IND ] ;".split(" ")}]}]}]},{a:"node",c:"DIFFUSE_FRESNEL",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oe",g:["vec3"],f:!1},{a:"node_in",c:"of",g:["vec2"],f:!1},{a:"node_in",c:"og",g:["vec3"],f:!1},{a:"node_in",c:"oh",g:["float"],f:!1},{a:"node_in",c:"oi",g:["vec2"],f:!1},{a:"node_out",c:"oj",g:["float"],f:!1}],j:[{a:"node_cond",d:[{a:"node_if",e:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 ok = cross ( oe , o . xyz ) ; og = cross ( ok , o . xyz ) ; og = - normalize ( og ) ;".split(" ")}]}]},
{a:"txt",b:"oj = _0_0 ; if ( of . r != _0_0 ) { float ol = ( _1_0 - oh ) * dot ( og , oe ) + oh ; if ( oi [ 0 ] == _0_0 ) { oj = _1_0 ; } else { float t = _1_0 + abs ( ol ) ; t = oi [ 1 ] + ( _1_0 - oi [ 1 ] ) * pow ( t , oi [ 0 ] ) ; oj = clamp ( t , _0_0 , _1_0 ) ; } oj = max ( oj , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_LAMBERT",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"om",g:["vec3"],f:!1},{a:"node_in",c:"on",g:["vec2"],f:!1},{a:"node_in",c:"oo",g:["vec3"],
f:!1},{a:"node_in",c:"op",g:["float"],f:!1},{a:"node_out",c:"oq",g:["float"],f:!1}],j:[{a:"node_cond",d:[{a:"node_if",e:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 ok = cross ( om , o . xyz ) ; oo = cross ( ok , o . xyz ) ; oo = - normalize ( oo ) ;".split(" ")}]}]},{a:"txt",b:"oq = _0_0 ; if ( on . r != _0_0 ) { float ol = ( _1_0 - op ) * dot ( oo , om ) + op ; oq = max ( ol , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_OREN_NAYAR",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",
c:"or",g:["vec3"],f:!1},{a:"node_in",c:"os",g:["vec2"],f:!1},{a:"node_in",c:"ot",g:["vec3"],f:!1},{a:"node_in",c:"ou",g:["float"],f:!1},{a:"node_in",c:"ov",g:["vec2"],f:!1},{a:"node_out",c:"ow",g:["float"],f:!1}],j:[{a:"node_cond",d:[{a:"node_if",e:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 ok = cross ( or , o . xyz ) ; ot = cross ( ok , o . xyz ) ; ot = - normalize ( ot ) ;".split(" ")}]}]},{a:"txt",b:"ow = _0_0 ; if ( os . r != _0_0 ) { float ol = ( _1_0 - ou ) * dot ( ot , or ) + ou ; if ( ov [ 0 ] > _0_0 ) { float ox = max ( dot ( ot , v ) , _0_0 ) ; float oy = ov [ 0 ] * ov [ 0 ] ; float cg = _1_0 - _0_5 * ( oy / ( oy + 0.33 ) ) ; vec3 oz = or - ol * ot ; vec3 oA = v - ox * ot ; if ( length ( oz ) == _0_0 || length ( oA ) == _0_0 || abs ( ol ) > _1_0 || abs ( ox ) > _1_0 ) ow = ol * cg ; else { float oB = acos ( ol ) ; float oC = acos ( ox ) ; vec3 oD = normalize ( oz ) ; vec3 oE = normalize ( oA ) ; float a , b ; a = max ( oB , oC ) ; b = min ( oB , oC ) ; b *= 0.95 ; float t = max ( dot ( oD , oE ) , _0_0 ) ; float oF = 0.45 * ( oy / ( oy + 0.09 ) ) ; ow = ol * ( cg + ( oF * t * sin ( a ) * tan ( b ) ) ) ; } } else ow = ol ; ow = max ( ow , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"DIFFUSE_MINNAERT",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oG",g:["vec3"],f:!1},{a:"node_in",c:"oH",g:["vec2"],f:!1},{a:"node_in",c:"oI",g:["vec3"],f:!1},{a:"node_in",c:"oJ",g:["float"],f:!1},{a:"node_in",c:"oK",g:["vec2"],f:!1},{a:"node_out",c:"oL",g:["float"],f:!1}],j:[{a:"node_cond",d:[{a:"node_if",e:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 ok = cross ( oG , o . xyz ) ; oI = cross ( ok , o . xyz ) ; oI = - normalize ( oI ) ;".split(" ")}]}]},{a:"txt",
b:"oL = _0_0 ; if ( oH . r != _0_0 ) { float ol = ( _1_0 - oJ ) * dot ( oI , oG ) + oJ ; float ox = max ( dot ( oI , v ) , _0_0 ) ; if ( oK [ 0 ] <= _1_0 ) oL = ol * pow ( max ( ox * ol , 0.1 ) , oK [ 0 ] - _1_0 ) ; else oL = ol * pow ( 1.0001 - ox , oK [ 0 ] - _1_0 ) ; oL = max ( oL , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_TOON",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oM",g:["vec3"],f:!1},{a:"node_in",c:"oN",g:["vec2"],f:!1},{a:"node_in",c:"oO",g:["vec3"],f:!1},
{a:"node_in",c:"oP",g:["float"],f:!1},{a:"node_in",c:"oQ",g:["vec2"],f:!1},{a:"node_out",c:"oR",g:["float"],f:!1}],j:[{a:"node_cond",d:[{a:"node_if",e:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 ok = cross ( oM , o . xyz ) ; oO = cross ( ok , o . xyz ) ; oO = - normalize ( oO ) ;".split(" ")}]}]},{a:"txt",b:"oR = _0_0 ; if ( oN . r != _0_0 ) { float ol = ( _1_0 - oP ) * dot ( oO , oM ) + oP ; float oS = acos ( ol ) ; if ( oS < oQ [ 0 ] ) oR = _1_0 ; else if ( oS > ( oQ [ 0 ] + oQ [ 1 ] ) || oQ [ 1 ] == _0_0 ) oR = _0_0 ; else oR = _1_0 - ( ( oS - oQ [ 0 ] ) / oQ [ 1 ] ) ; oR = max ( oR , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"SPECULAR_PHONG",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oT",g:["vec3"],f:!1},{a:"node_in",c:"oU",g:["vec2"],f:!1},{a:"node_in",c:"oV",g:["vec3"],f:!1},{a:"node_in",c:"oW",g:["float"],f:!1},{a:"node_in",c:"oX",g:["vec2"],f:!1},{a:"node_out",c:"oY",g:["float"],f:!1}],j:[{a:"txt",b:"oY = _0_0 ; if ( oU . g != _0_0 ) { vec3 oZ = normalize ( oT + v ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"if ( oW == _0_0 ) { oY = dot ( o . xyz , oZ ) ; oY = sqrt ( _1_0 - oY * oY ) ; }".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"oY = ( _1_0 - oW ) * max ( dot ( oV , oZ ) , _0_0 ) + oW ;".split(" ")}]}]},{a:"txt",b:"oY = pow ( oY , oX [ 0 ] ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_WARDISO",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"o_",g:["vec3"],f:!1},{a:"node_in",c:"pa",g:["vec2"],f:!1},{a:"node_in",c:"pb",g:["vec3"],f:!1},{a:"node_in",c:"pc",g:["float"],f:!1},{a:"node_in",c:"pd",g:["vec2"],f:!1},{a:"node_out",c:"pe",g:["float"],f:!1}],j:[{a:"txt",b:"pe = _0_0 ; if ( pa . g != _0_0 ) { vec3 oZ = normalize ( o_ + v ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",e:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float pf = _0_0 ; float ox = _0_0 ; float pg = _0_0 ; if ( pc == _0_0 ) { pf = dot ( o . xyz , oZ ) ; ox = dot ( o . xyz , v ) ; pg = dot ( o . xyz , o_ ) ; pf = sqrt ( _1_0 - pf * pf ) ; ox = sqrt ( _1_0 - ox * ox ) ; pg = sqrt ( _1_0 - pg * pg ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float pf = max ( dot ( pb , oZ ) , 0.01 ) ; float ox = max ( dot ( pb , v ) , 0.01 ) ; float pg = max ( dot ( pb , o_ ) , 0.01 ) ;".split(" ")}]}]},
{a:"txt",b:"float bl = tan ( acos ( pf ) ) ; float L = max ( pd [ 0 ] , 0.01 ) ; pe = pg * ( _1_0 / ( 4.0 * M_PI * L * L ) ) * ( exp ( - ( bl * bl ) / ( L * L ) ) / ( sqrt ( ox * pg ) ) ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_TOON",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"ph",g:["vec3"],f:!1},{a:"node_in",c:"pi",g:["vec2"],f:!1},{a:"node_in",c:"pj",g:["vec3"],f:!1},{a:"node_in",c:"pk",g:["float"],f:!1},{a:"node_in",c:"pl",g:["vec2"],f:!1},{a:"node_out",c:"pm",g:["float"],
f:!1}],j:[{a:"txt",b:"pm = _0_0 ; if ( pi . g != _0_0 ) { vec3 bO = normalize ( ph + v ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float pn = dot ( bO , o . xyz ) ; float bl = pl [ 0 ] + pl [ 1 ] ; if ( pk == _0_0 ) bl = acos ( sqrt ( _1_0 - pn * pn ) ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float bl = acos ( dot ( bO , pj ) ) ;".split(" ")}]}]},{a:"txt",b:"if ( bl < pl [ 0 ] ) pm = _1_0 ; else if ( bl >= pl [ 0 ] + pl [ 1 ] || pl [ 1 ] == _0_0 ) pm = _0_0 ; else pm = _1_0 - ( bl - pl [ 0 ] ) / pl [ 1 ] ; }".split(" ")}]},
{a:"node",c:"SPECULAR_BLINN",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"po",g:["vec3"],f:!1},{a:"node_in",c:"pr",g:["vec2"],f:!1},{a:"node_in",c:"pu",g:["vec3"],f:!1},{a:"node_in",c:"pv",g:["float"],f:!1},{a:"node_in",c:"pw",g:["vec2"],f:!1},{a:"node_out",c:"px",g:["float"],f:!1}],j:[{a:"txt",b:"px = _0_0 ; if ( pr . g != _0_0 ) { if ( pw [ 0 ] < 1.0 || pw [ 1 ] == _0_0 ) px = _0_0 ; else { if ( pw [ 1 ] < 100.0 ) pw [ 1 ] = sqrt ( 1.0 / pw [ 1 ] ) ; else pw [ 1 ] = 10.0 / pw [ 1 ] ; vec3 oZ = normalize ( v + po ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",e:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float pf = 0.0 ; if ( pv == _0_0 ) { float py = dot ( o . xyz , oZ ) ; pf = sqrt ( _1_0 - py * py ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float pf = ( _1_0 - pv ) * max ( dot ( pu , oZ ) , _0_0 ) + pv ;".split(" ")}]}]},{a:"txt",b:"if ( pf < _0_0 ) px = _0_0 ; else { float ox = max ( dot ( pu , v ) , 0.01 ) ; float pg = dot ( pu , po ) ; if ( pg <= 0.01 ) px = _0_0 ; else { float pz = max ( dot ( v , oZ ) , 0.01 ) ; float a = _1_0 ; float b = ( 2.0 * pf * ox ) / pz ; float db = ( 2.0 * pf * pg ) / pz ; float g = min ( min ( a , b ) , db ) ; float p = sqrt ( pow ( pw [ 0 ] , 2.0 ) + pow ( pz , 2.0 ) - _1_0 ) ; float lq = pow ( p - pz , 2.0 ) / pow ( p + pz , 2.0 ) * ( _1_0 + pow ( pz * ( p + pz ) - _1_0 , 2.0 ) / pow ( pz * ( p - pz ) + _1_0 , 2.0 ) ) ; float oS = acos ( pf ) ; px = max ( lq * g * exp ( - pow ( oS , 2.0 ) / ( 2.0 * pow ( pw [ 1 ] , 2.0 ) ) ) , _0_0 ) ; } } } }".split(" ")}]},
{a:"node",c:"LIGHTING_APPLY",m:[],l:[{a:"node_in",c:"pA",g:["vec4"],f:!1},{a:"node_in",c:"pB",g:["vec3"],f:!1},{a:"node_in",c:"pC",g:["float"],f:!1},{a:"node_in",c:"pD",g:["float"],f:!1},{a:"node_in",c:"pE",g:["vec3"],f:!1},{a:"node_in",c:"pF",g:["vec3"],f:!1},{a:"node_in",c:"pG",g:["vec4"],f:!1},{a:"node_in",c:"pH",g:["vec3"],f:!1},{a:"node_in",c:"pI",g:["vec3"],f:!1},{a:"node_in",c:"pJ",g:["vec3"],f:!1},{a:"node_in",c:"pK",g:["float"],f:!1},{a:"node_out",c:"pL",g:["vec4"],f:!1},{a:"node_out",c:"pM",
g:["vec3"],f:!1}],j:[{a:"txt",b:"pM = pB + pJ * pI * pD ; pL = pA + vec4 ( pJ * pH * pC , pD ) ;".split(" ")}]},{a:"node",c:"LIGHTING_END",m:[],l:[{a:"node_in",c:"pN",g:["vec4"],f:!1},{a:"node_in",c:"pO",g:["vec3"],f:!1}],j:[{a:"txt",b:"A = pN . rgb ; nH = pO ;".split(" ")}]},{a:"nodes_global"},{a:"txt",b:"void cp ( vec3 nw , vec3 nx , vec3 ny , vec3 nz , vec3 nA , vec3 nB , vec3 v , vec2 nC , vec2 nD , vec4 nE , float nF , vec4 nG , out vec3 A , out vec3 nH ) {".split(" ")},{a:"nodes_main"},{a:"txt",
b:["}"]}]}}]}]};a["include/math.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"MATH_GLSLV",h:{a:"grp",d:[{a:"define",c:"MATH_GLSLV",b:[""]},{a:"var",c:"EPSILON",b:["0.000001"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"include",o:"std.glsl"},{a:"txt",b:"struct ak { vec3 O ; vec3 ad ; vec3 R ; vec3 as ; vec3 S ; vec3 Q ; vec3 aK ; } ; bool eP ( vec3 a , vec3 b ) { return any ( lessThan ( abs ( a - b ) , vec3 ( EPSILON ) ) ) ; } vec3 P ( in vec4 q , in vec3 km ) { return km + 2.0 * cross ( q . xyz , cross ( q . xyz , km ) + q . w * km ) ; } vec4 kn ( in vec4 hk ) { return vec4 ( - hk . xyz , hk . w ) ; } vec4 pP ( in vec4 a , in vec4 b ) { vec4 hm ; hm . x = a . x * b . w + a . w * b . x + a . y * b . z - a . z * b . y ; hm . y = a . y * b . w + a . w * b . y + a . z * b . x - a . x * b . z ; hm . z = a . z * b . w + a . w * b . z + a . x * b . y - a . y * b . x ; hm . w = a . w * b . w - a . x * b . x - a . y * b . y - a . z * b . z ; return hm ; } vec4 cI ( in vec3 pQ , in float pR ) { vec4 hm ; pR = pR * 0.5 ; float s = sin ( pR ) ; hm . x = s * pQ [ 0 ] ; hm . y = s * pQ [ 1 ] ; hm . z = s * pQ [ 2 ] ; hm . w = cos ( pR ) ; return hm ; } vec4 pU ( in vec3 da , in vec3 pS ) { vec4 hm ; float dg = dot ( pS , da ) ; vec3 pT = cross ( pS , da ) ; hm . xyz = pT . xyz ; hm . w = 1.0 + dg ; return normalize ( hm ) ; } vec3 pW ( vec4 pV , vec4 hk , vec3 hl ) { vec3 hm = hl * pV . w ; hm = P ( hk , hm ) ; hm += pV . xyz ; return hm ; } vec3 ae ( mat3 pX , vec3 hl ) { vec3 hm = hl * pX [ 1 ] [ 0 ] ; vec4 hk = vec4 ( pX [ 1 ] [ 1 ] , pX [ 1 ] [ 2 ] , pX [ 2 ] [ 0 ] , pX [ 2 ] [ 1 ] ) ; hm = P ( hk , hm ) ; hm += pX [ 0 ] ; return hm ; } vec3 pY ( vec4 pV , vec4 hk , vec3 da ) { vec3 hm = da * pV . w ; hm = P ( hk , hm ) ; return hm ; } vec3 U ( mat3 pX , vec3 da ) { vec3 hm = da * pX [ 1 ] [ 0 ] ; vec4 hk = vec4 ( pX [ 1 ] [ 1 ] , pX [ 1 ] [ 2 ] , pX [ 2 ] [ 0 ] , pX [ 2 ] [ 1 ] ) ; hm = P ( hk , hm ) ; return hm ; } vec3 pZ ( vec4 pV , vec4 hk , vec3 hl ) { vec3 hm = hl - pV . xyz ; hm = P ( kn ( hk ) , hm ) ; hm /= pV . w ; return hm ; } vec3 p_ ( vec4 pV , vec4 hk , vec3 da ) { return P ( kn ( hk ) , da ) / pV . w ; } mat4 qa ( ) { return mat4 ( _1_0 , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 ) ; } mat4 qb ( float bl ) { return mat4 ( _1_0 , _0_0 , _0_0 , _0_0 , _0_0 , cos ( bl ) , sin ( bl ) , _0_0 , _0_0 , - sin ( bl ) , cos ( bl ) , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 ) ; } mat4 qc ( float bl ) { return mat4 ( cos ( bl ) , _0_0 , - sin ( bl ) , _0_0 , _0_0 , _1_0 , _0_0 , _0_0 , sin ( bl ) , _0_0 , cos ( bl ) , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 ) ; } mat4 qd ( float bl ) { return mat4 ( cos ( bl ) , sin ( bl ) , _0_0 , _0_0 , - sin ( bl ) , cos ( bl ) , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 ) ; } ak le ( in ak km ) { return ak ( km . O , km . ad , normalize ( km . R ) , normalize ( km . as ) , normalize ( km . S ) , normalize ( km . Q ) , km . aK ) ; }".split(" ")},
{a:"cond",d:[{a:"if",e:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2},"REFRACTIVE","USE_NODE_B4W_REFRACTION",{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:"vec3 bC ( vec4 at ) { float au = at . x ; float av = at . y ; float aw = at . w ; vec3 qe ; qe . x = ( au + aw ) / 2.0 ; qe . y = ( av + aw ) / 2.0 ; qe . z = aw ; return qe ; }".split(" ")}]}}]},{a:"txt",b:"mat3 cG ( ) { return mat3 ( _0_0 , _0_0 , _0_0 , _1_0 , _0_0 , _0_0 , _0_0 , _1_0 , _0_0 ) ; } mat4 aV ( mat3 t ) { mat4 qf ; qf [ 0 ] [ 0 ] = ( _1_0 - ( t [ 1 ] [ 2 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) + t [ 2 ] [ 0 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) ) ) * t [ 1 ] [ 0 ] ; qf [ 0 ] [ 1 ] = ( t [ 1 ] [ 1 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) + t [ 2 ] [ 1 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) ) * t [ 1 ] [ 0 ] ; qf [ 0 ] [ 2 ] = ( t [ 1 ] [ 1 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) - t [ 2 ] [ 1 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) ) * t [ 1 ] [ 0 ] ; qf [ 0 ] [ 3 ] = _0_0 ; qf [ 1 ] [ 0 ] = ( t [ 1 ] [ 1 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) - t [ 2 ] [ 1 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) ) * t [ 1 ] [ 0 ] ; qf [ 1 ] [ 1 ] = ( _1_0 - ( t [ 1 ] [ 1 ] * ( t [ 1 ] [ 1 ] + t [ 1 ] [ 1 ] ) + t [ 2 ] [ 0 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) ) ) * t [ 1 ] [ 0 ] ; qf [ 1 ] [ 2 ] = ( t [ 1 ] [ 2 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) + t [ 2 ] [ 1 ] * ( t [ 1 ] [ 1 ] + t [ 1 ] [ 1 ] ) ) * t [ 1 ] [ 0 ] ; qf [ 1 ] [ 3 ] = _0_0 ; qf [ 2 ] [ 0 ] = ( t [ 1 ] [ 1 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) + t [ 2 ] [ 1 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) ) * t [ 1 ] [ 0 ] ; qf [ 2 ] [ 1 ] = ( t [ 1 ] [ 2 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) - t [ 2 ] [ 1 ] * ( t [ 1 ] [ 1 ] + t [ 1 ] [ 1 ] ) ) * t [ 1 ] [ 0 ] ; qf [ 2 ] [ 2 ] = ( _1_0 - ( t [ 1 ] [ 1 ] * ( t [ 1 ] [ 1 ] + t [ 1 ] [ 1 ] ) + t [ 1 ] [ 2 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) ) ) * t [ 1 ] [ 0 ] ; qf [ 2 ] [ 3 ] = _0_0 ; qf [ 3 ] [ 0 ] = t [ 0 ] [ 0 ] ; qf [ 3 ] [ 1 ] = t [ 0 ] [ 1 ] ; qf [ 3 ] [ 2 ] = t [ 0 ] [ 2 ] ; qf [ 3 ] [ 3 ] = 1.0 ; return qf ; } mat3 aS ( in mat3 pX , in mat3 qg ) { mat3 hm ; vec3 hl = qg [ 0 ] ; vec4 pV = vec4 ( pX [ 0 ] , pX [ 1 ] [ 0 ] ) ; vec4 hk = vec4 ( pX [ 1 ] [ 1 ] , pX [ 1 ] [ 2 ] , pX [ 2 ] [ 0 ] , pX [ 2 ] [ 1 ] ) ; hm [ 0 ] = pW ( pV , hk , hl ) ; hm [ 1 ] [ 0 ] = pX [ 1 ] [ 0 ] * qg [ 1 ] [ 0 ] ; hm [ 1 ] [ 1 ] = pX [ 1 ] [ 1 ] * qg [ 2 ] [ 1 ] + pX [ 2 ] [ 1 ] * qg [ 1 ] [ 1 ] + pX [ 1 ] [ 2 ] * qg [ 2 ] [ 0 ] - pX [ 2 ] [ 0 ] * qg [ 1 ] [ 2 ] ; hm [ 1 ] [ 2 ] = pX [ 1 ] [ 2 ] * qg [ 2 ] [ 1 ] + pX [ 2 ] [ 1 ] * qg [ 1 ] [ 2 ] + pX [ 2 ] [ 0 ] * qg [ 1 ] [ 1 ] - pX [ 1 ] [ 1 ] * qg [ 2 ] [ 0 ] ; hm [ 2 ] [ 0 ] = pX [ 2 ] [ 0 ] * qg [ 2 ] [ 1 ] + pX [ 2 ] [ 1 ] * qg [ 2 ] [ 0 ] + pX [ 1 ] [ 1 ] * qg [ 1 ] [ 2 ] - pX [ 1 ] [ 2 ] * qg [ 1 ] [ 1 ] ; hm [ 2 ] [ 1 ] = pX [ 2 ] [ 1 ] * qg [ 2 ] [ 1 ] - pX [ 1 ] [ 1 ] * qg [ 1 ] [ 1 ] - pX [ 1 ] [ 2 ] * qg [ 1 ] [ 2 ] - pX [ 2 ] [ 0 ] * qg [ 2 ] [ 0 ] ; return hm ; } mat3 cK ( in vec4 hk , in mat3 pX ) { mat3 hm ; hm [ 0 ] = pX [ 0 ] ; hm [ 1 ] [ 0 ] = pX [ 1 ] [ 0 ] ; hm [ 1 ] [ 1 ] = hk [ 0 ] ; hm [ 1 ] [ 2 ] = hk [ 1 ] ; hm [ 2 ] [ 0 ] = hk [ 2 ] ; hm [ 2 ] [ 1 ] = hk [ 3 ] ; return hm ; }".split(" ")}]}}]}]};
a["include/mirror.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"MIRROR_GLSLF",h:{a:"grp",d:[{a:"define",c:"MIRROR_GLSLF",b:[""]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",e:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2},"REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2},{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"include",o:"color_util.glslf"},
{a:"include",o:"math.glslv"},{a:"define",c:"REFL_BUMP",b:["0.1"]},{a:"txt",b:"float qh ( in vec3 u , vec3 eD , float eJ , float eI ) { vec3 eG = normalize ( eD + u ) ; float eH = 1.0 - dot ( u , eG ) ; float r = eI + ( 1.0 - eI ) * pow ( eH , eJ ) ; return r ; } void cq ( inout vec3 qi , vec3 u , vec3 Q , float qj , mat3 N ) { vec3 eD = reflect ( - u , Q ) ; float eJ = u_fresnel_params [ 2 ] ; float eI = u_fresnel_params [ 3 ] ; float r = 1.0 ; if ( eJ != 0.0 ) r = qh ( u , eD , eJ , eI ) ;".split(" ")},
{a:"cond",d:[{a:"if",e:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 eF = GLSL_TEXTURE_CUBE ( u_cube_reflection , eD ) . xyz ;".split(" ")}]}},{a:"elif",e:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["REFLECTION_PASS","REFL_PASS_NONE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 qk = u_refl_plane . xyz * dot ( Q , u_refl_plane . xyz ) ; vec3 ql = Q - qk ; vec2 qm = U ( N , ql ) . xy ; vec2 qn = h . xy / h . z ; qn += qm * REFL_BUMP ; vec3 eF = GLSL_TEXTURE ( u_plane_reflection , qn ) . rgb ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 eF = vec3 ( 1.0 ) ; qj = 0.0 ;".split(" ")}]}}]}]}},{a:"elif",e:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 eF = GLSL_TEXTURE_CUBE ( u_mirrormap , eD ) . xyz ;".split(" ")}]}}]},{a:"txt",b:"bY ( eF . rgb ) ; qi = mix ( qi , eF , qj * r ) ; }".split(" ")}]}}]}]}}]}]};a["include/nodes.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"NODES_GLSLF",h:{a:"grp",d:[{a:"define",c:"NODES_GLSLF",b:[""]},{a:"var",c:"CAUSTICS",
b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"DOUBLE_SIDED_LIGHTING",b:["0"]},{a:"var",c:"INVERT_FRONTFACING",b:["0"]},{a:"var",c:"USE_REFRACTION",b:["0"]},{a:"var",c:"HAS_REFRACT_TEXTURE",b:["0"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"cond",d:[{a:"if",e:["USE_NODE_MATERIAL_BEGIN"],h:{a:"grp",d:[{a:"include",o:"mirror.glslf"},{a:"include",o:"shadow.glslf"},{a:"include",o:"environment.glslf"}]}}]},{a:"cond",d:[{a:"if",e:["USE_NODE_B4W_REFRACTION",
"USE_REFRACTION",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"refraction.glslf"}]}}]},{a:"include",o:"color_util.glslf"},{a:"include",o:"math.glslv"},{a:"cond",d:[{a:"if",e:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","qo",";"]}]}}]},{a:"cond",d:[{a:"if",e:["USE_NODE_B4W_REFRACTION"],h:{a:"grp",d:[{a:"txt",b:"vec3 qv ( in vec3 qr , in float qu ) { vec3 eX = vec3 ( _0_0 ) ;".split(" ")},{a:"cond",d:[{a:"if",e:["USE_REFRACTION"],
h:{a:"grp",d:[{a:"txt",b:"eX = cs ( h , qr . xy * qu ) ;".split(" ")}]}},{a:"elif",e:["HAS_REFRACT_TEXTURE"],h:{a:"grp",d:[{a:"txt",b:"eX = GLSL_TEXTURE ( u_refractmap , h . xy / h . z ) . rgb ; bY ( eX ) ;".split(" ")}]}}]},{a:"txt",b:["return","eX",";","}"]}]}}]},{a:"cond",d:[{a:"if",e:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_SEPHSV",{a:"logical_or_expr",i:6}],h:{a:"grp",d:[{a:"txt",b:"vec3 ka ( vec3 rgb ) { vec4 j_ = vec4 ( _0_0 , - _1_0 / 3.0 , 2.0 / 3.0 , - _1_0 ) ; vec4 p = mix ( vec4 ( rgb . bg , j_ . wz ) , vec4 ( rgb . gb , j_ . xy ) , step ( rgb . b , rgb . g ) ) ; vec4 q = mix ( vec4 ( p . xyw , rgb . r ) , vec4 ( rgb . r , p . yzx ) , step ( p . x , rgb . r ) ) ; float dg = q . x - min ( q . w , q . y ) ; float iu = 1.0e-10 ; return vec3 ( abs ( q . z + ( q . w - q . y ) / ( 6.0 * dg + iu ) ) , dg / ( q . x + iu ) , q . x ) ; }".split(" ")}]}}]},
{a:"cond",d:[{a:"if",e:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_COMBHSV",{a:"logical_or_expr",i:6}],h:{a:"grp",d:[{a:"txt",b:"vec3 kc ( vec3 kb ) { vec4 j_ = vec4 ( _1_0 , 2.0 / 3.0 , _1_0 / 3.0 , 3.0 ) ; vec3 p = abs ( fract ( vec3 ( kb . r , kb . r , kb . r ) + j_ . xyz ) * 6.0 - j_ . www ) ; return kb . b * mix ( j_ . xxx , clamp ( p - j_ . xxx , _0_0 , _1_0 ) , kb . g ) ; }".split(" ")}]}}]},{a:"cond",
d:[{a:"if",e:["USE_NODE_GEOMETRY_UV","USE_NODE_B4W_PARALLAX","USE_NODE_UV_MERGED",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"vec3 qw ( vec2 gP ) { return vec3 ( gP * 2.0 - vec2 ( _1_0 , _1_0 ) , _0_0 ) ; }".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["USE_NODE_TEXTURE_COLOR","USE_NODE_TEXTURE_NORMAL","USE_NODE_B4W_PARALLAX",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"vec2 qx ( vec3 hl ) { return vec2 ( hl . xy * _0_5 + vec2 ( _0_5 , _0_5 ) ) ; }".split(" ")}]}}]},{a:"node",c:"CAMERA",
m:[],l:[{a:"node_out",c:"qQ",g:["vec3"],f:!0},{a:"node_out",c:"qR",g:["float"],f:!0},{a:"node_out",c:"qS",g:["float"],f:!0}],j:[{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_qQ"],j:[{a:"txt",b:"qQ = normalize ( qN . xyz ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_qR"],j:[{a:"txt",b:"qR = abs ( qN . z ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_qS"],j:[{a:"txt",b:"qS = length ( qN . xyz ) ;".split(" ")}]}]}]},{a:"node",c:"COMBRGB",m:[],l:[{a:"node_in",c:"qT",g:["float"],
f:!1},{a:"node_in",c:"qU",g:["float"],f:!1},{a:"node_in",c:"qV",g:["float"],f:!1},{a:"node_out",c:"qW",g:["vec3"],f:!1}],j:[{a:"txt",b:"qW = vec3 ( qT , qU , qV ) ;".split(" ")}]},{a:"node",c:"COMBHSV",m:[],l:[{a:"node_in",c:"qX",g:["float"],f:!1},{a:"node_in",c:"qY",g:["float"],f:!1},{a:"node_in",c:"qZ",g:["float"],f:!1},{a:"node_out",c:"q_",g:["vec3"],f:!1}],j:[{a:"txt",b:"q_ = kc ( vec3 ( qX , qY , qZ ) ) ;".split(" ")}]},{a:"node",c:"EMPTY_UV",m:[],l:[{a:"node_out",c:"rc",g:["vec3"],f:!1}],j:[{a:"txt",
b:"rc = vec3 ( - _1_0 , - _1_0 , _0_0 ) ;".split(" ")}]},{a:"node",c:"EMPTY_VC",m:[],l:[{a:"node_out",c:"rd",g:["vec3"],f:!1}],j:[{a:"txt",b:"rd = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_UV",m:[],l:[{a:"node_out",c:"re",g:["vec3"],f:!1},{a:"node_param",c:"qy",g:["GLSL_IN","vec2"],f:!1}],j:[{a:"txt",b:"re = qw ( qy ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_OR",m:[],l:[{a:"node_out",c:"rf",g:["vec3"],f:!1}],j:[{a:"txt",b:"rf = 2.0 * qo - vec3 ( _1_0 ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC",
m:[],l:[{a:"node_out",c:"rh",g:["vec3"],f:!1},{a:"node_param",c:"qz",g:["GLSL_IN","vec3"],f:!1}],j:[{a:"txt",b:"rh = qz ; bY ( rh ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC1",m:[],l:[{a:"node_out",c:"ri",g:["float"],f:!1},{a:"node_param",c:"qA",g:["GLSL_IN","float"],f:!1}],j:[{a:"txt",b:"ri = qA ; bY ( ri ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC2",m:[],l:[{a:"node_out",c:"rj",g:["float"],f:!1},{a:"node_out",c:"rk",g:["float"],f:!1},{a:"node_param",c:"qB",g:["GLSL_IN","vec2"],f:!1}],j:[{a:"txt",
b:"rj = qB [ 0 ] ; rk = qB [ 1 ] ; bY ( rj ) ; bY ( rk ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC3",m:[],l:[{a:"node_out",c:"rl",g:["float"],f:!1},{a:"node_out",c:"rm",g:["float"],f:!1},{a:"node_out",c:"rn",g:["float"],f:!1},{a:"node_param",c:"qC",g:["GLSL_IN","vec3"],f:!1}],j:[{a:"txt",b:"rl = qC [ 0 ] ; rm = qC [ 1 ] ; rn = qC [ 2 ] ; bY ( rl ) ; bY ( rm ) ; bY ( rn ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_NO",m:[],l:[{a:"node_out",c:"ro",g:["vec3"],f:!1}],j:[{a:"txt",b:"ro = qL . xyz ;".split(" ")}]},
{a:"node",c:"GEOMETRY_FB",m:[],l:[{a:"node_out",c:"rp",g:["float"],f:!1}],j:[{a:"node_cond",d:[{a:"node_if",e:["INVERT_FRONTFACING"],j:[{a:"txt",b:"rp = ( gl_FrontFacing ) ? _0_0 : _1_0 ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"rp = ( gl_FrontFacing ) ? _1_0 : _0_0 ;".split(" ")}]}]}]},{a:"node",c:"GEOMETRY_VW",m:[],l:[{a:"node_out",c:"rq",g:["vec3"],f:!1}],j:[{a:"txt",b:"rq = - U ( F , v ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_LO",m:[],l:[{a:"node_out",c:"rs",g:["vec3"],f:!1}],j:[{a:"txt",
b:"rs [ 0 ] = qN [ 0 ] ; rs [ 1 ] = qN [ 1 ] ; rs [ 2 ] = qN [ 2 ] ;".split(" ")}]},{a:"node",c:"GEOMETRY_GL",m:[],l:[{a:"node_out",c:"rt",g:["vec3"],f:!1}],j:[{a:"txt",b:"rt = vec3 ( nA . r , nA . g , nA . b ) ;".split(" ")}]},{a:"node",c:"NEW_GEOMETRY",m:[],l:[{a:"node_out",c:"ru",g:["vec3"],f:!1},{a:"node_out",c:"rv",g:["vec3"],f:!1},{a:"node_out",c:"rw",g:["vec3"],f:!1},{a:"node_out",c:"rx",g:["vec3"],f:!1},{a:"node_out",c:"ry",g:["vec3"],f:!1},{a:"node_out",c:"rz",g:["vec3"],f:!1},{a:"node_out",
c:"rA",g:["float"],f:!1},{a:"node_out",c:"rB",g:["float"],f:!1}],j:[{a:"txt",b:"ru = vec3 ( _0_0 ) ; rv = vec3 ( _0_0 ) ; rw = vec3 ( _0_0 ) ; rx = vec3 ( _0_0 ) ; ry = vec3 ( _0_0 ) ; rz = vec3 ( _0_0 ) ; rA = _0_0 ; rB = _0_0 ;".split(" ")}]},{a:"node",c:"HUE_SAT",m:[],l:[{a:"node_in",c:"rC",g:["float"],f:!1},{a:"node_in",c:"rD",g:["float"],f:!1},{a:"node_in",c:"rE",g:["float"],f:!1},{a:"node_in",c:"rF",g:["float"],f:!1},{a:"node_in",c:"rG",g:["vec3"],f:!1},{a:"node_out",c:"rH",g:["vec3"],f:!1}],
j:[{a:"txt",b:"vec3 kb = ka ( rG ) ; kb [ 0 ] += ( rC - _0_5 ) ; if ( kb [ 0 ] > _1_0 ) kb [ 0 ] -= _1_0 ; else if ( kb [ 0 ] < _0_0 ) kb [ 0 ] += _1_0 ; kb *= vec3 ( _1_0 , rD , rE ) ; kb = mix ( vec3 ( _1_0 ) , mix ( vec3 ( _0_0 ) , kb , step ( vec3 ( _0_0 ) , kb ) ) , step ( kb , vec3 ( _1_0 ) ) ) ; rH = mix ( rG , kc ( kb ) , rF ) ;".split(" ")}]},{a:"node",c:"INVERT",m:[],l:[{a:"node_in",c:"rI",g:["float"],f:!1},{a:"node_in",c:"rJ",g:["vec3"],f:!1},{a:"node_out",c:"rK",g:["vec3"],f:!1}],j:[{a:"txt",
b:"rK = mix ( rJ , vec3 ( _1_0 ) - rJ , rI ) ;".split(" ")}]},{a:"node",c:"LAMP",m:[{a:"node_var",c:"LAMP_INDEX",b:["0"]}],l:[{a:"node_out",c:"rL",g:["vec3"],f:!0},{a:"node_out",c:"rM",g:["vec3"],f:!1},{a:"node_out",c:"rN",g:["float"],f:!1},{a:"node_out",c:"rO",g:["float"],f:!0}],j:[{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_rL"],j:[{a:"txt",b:"rL = u_lamp_light_color_intensities [ LAMP_INDEX ] ;".split(" ")}]}]},{a:"txt",b:"vec4 rP = u_lamp_light_factors [ LAMP_INDEX ] ; vec3 rQ = u_lamp_light_directions [ LAMP_INDEX ] ; vec3 rR = u_lamp_light_positions [ LAMP_INDEX ] ; float rS = rP . z ; if ( rS != - _1_0 ) { rM = - c + rR ; rN = length ( rM ) ; rM = normalize ( rM ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_rO"],j:[{a:"txt",b:"rO = rS / ( rS + rN * rN ) ; float rT = rP . x ; float rU = rP . y ; if ( rT > - _1_0 ) { float od = dot ( rM , rQ ) ; od *= smoothstep ( _0_0 , _1_0 , ( od - rT ) / rU ) ; rO *= od ; }".split(" ")}]}]},{a:"txt",b:["}","else","{"]},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_rM"],j:[{a:"txt",b:["rM","=","rQ",";"]}]}]},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_rN"],j:[{a:"txt",b:"rN = length ( rR - c ) ;".split(" ")}]}]},{a:"node_cond",
d:[{a:"node_if",e:["USE_OUT_rO"],j:[{a:"txt",b:["rO","=","_1_0",";"]}]}]},{a:"txt",b:["}"]}]},{a:"node",c:"NORMAL",m:[],l:[{a:"node_in",c:"rV",g:["vec3"],f:!1},{a:"node_out",c:"rW",g:["vec3"],f:!0},{a:"node_out",c:"rX",g:["float"],f:!0},{a:"node_param",c:"qD",g:["vec3"],f:!1}],j:[{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_rW"],j:[{a:"txt",b:["rW","=","qD",";"]}]}]},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_rX"],j:[{a:"txt",b:"rX = - dot ( rV , qD ) ;".split(" ")}]}]}]},{a:"node",c:"B4W_VECTOR_VIEW",
m:[],l:[{a:"node_in",c:"rY",g:["vec3"],f:!1},{a:"node_out",c:"rZ",g:["vec3"],f:!1}],j:[{a:"txt",b:"rZ = - U ( F , rY ) ;".split(" ")}]},{a:"node",c:"BSDF_ANISOTROPIC",m:[],l:[{a:"node_in",c:"r_",g:["vec3"],f:!1},{a:"node_in",c:"sa",g:["float"],f:!1},{a:"node_in",c:"sb",g:["float"],f:!1},{a:"node_in",c:"sc",g:["float"],f:!1},{a:"node_in",c:"sd",g:["vec3"],f:!1},{a:"node_in",c:"se",g:["vec3"],f:!1},{a:"node_out",c:"sf",g:["vec3"],f:!1}],j:[{a:"txt",b:"sf = r_ ; sa ; sb ; sc ; sd ; se ;".split(" ")}]},
{a:"node",c:"BSDF_DIFFUSE",m:[],l:[{a:"node_in",c:"sg",g:["vec3"],f:!1},{a:"node_in",c:"sh",g:["float"],f:!1},{a:"node_in",c:"si",g:["vec3"],f:!1},{a:"node_out",c:"sj",g:["vec3"],f:!1}],j:[{a:"txt",b:"sj = sg ; sh ; si ;".split(" ")}]},{a:"node",c:"BSDF_GLASS",m:[],l:[{a:"node_in",c:"sk",g:["vec3"],f:!1},{a:"node_in",c:"sl",g:["float"],f:!1},{a:"node_in",c:"sm",g:["float"],f:!1},{a:"node_in",c:"sn",g:["vec3"],f:!1},{a:"node_out",c:"so",g:["vec3"],f:!1}],j:[{a:"txt",b:"so = sk ; sl ; sm ; sn ;".split(" ")}]},
{a:"node",c:"BSDF_GLOSSY",m:[],l:[{a:"node_in",c:"sr",g:["vec3"],f:!1},{a:"node_in",c:"su",g:["float"],f:!1},{a:"node_in",c:"sv",g:["vec3"],f:!1},{a:"node_out",c:"sw",g:["vec3"],f:!1}],j:[{a:"txt",b:"sw = sr ; su ; sv ;".split(" ")}]},{a:"node",c:"BSDF_HAIR",m:[],l:[{a:"node_in",c:"sx",g:["vec3"],f:!1},{a:"node_in",c:"sy",g:["float"],f:!1},{a:"node_in",c:"sz",g:["float"],f:!1},{a:"node_in",c:"sA",g:["float"],f:!1},{a:"node_out",c:"sB",g:["vec3"],f:!1}],j:[{a:"txt",b:"sB = sx ; sy ; sz ; sA ;".split(" ")}]},
{a:"node",c:"BSDF_TRANSPARENT",m:[],l:[{a:"node_in",c:"sC",g:["vec3"],f:!1},{a:"node_out",c:"sD",g:["vec3"],f:!1}],j:[{a:"txt",b:["sD","=","sC",";"]}]},{a:"node",c:"BSDF_TRANSLUCENT",m:[],l:[{a:"node_in",c:"sE",g:["vec3"],f:!1},{a:"node_in",c:"sF",g:["vec3"],f:!1},{a:"node_out",c:"sG",g:["vec3"],f:!1}],j:[{a:"txt",b:"sG = sE ; sF ;".split(" ")}]},{a:"node",c:"BSDF_REFRACTION",m:[],l:[{a:"node_in",c:"sH",g:["vec3"],f:!1},{a:"node_in",c:"sI",g:["float"],f:!1},{a:"node_in",c:"sJ",g:["float"],f:!1},{a:"node_in",
c:"sK",g:["vec3"],f:!1},{a:"node_out",c:"sL",g:["vec3"],f:!1}],j:[{a:"txt",b:"sL [ 0 ] = sL [ 1 ] = sL [ 2 ] = _0_0 ; sH ; sI ; sJ ; sK ;".split(" ")}]},{a:"node",c:"BSDF_TOON",m:[],l:[{a:"node_in",c:"sM",g:["vec3"],f:!1},{a:"node_in",c:"sN",g:["float"],f:!1},{a:"node_in",c:"sO",g:["float"],f:!1},{a:"node_in",c:"sP",g:["vec3"],f:!1},{a:"node_out",c:"sQ",g:["vec3"],f:!1}],j:[{a:"txt",b:"sQ = sM ; sN ; sO ; sP ;".split(" ")}]},{a:"node",c:"BSDF_VELVET",m:[],l:[{a:"node_in",c:"sR",g:["vec3"],f:!1},{a:"node_in",
c:"sS",g:["float"],f:!1},{a:"node_in",c:"sT",g:["vec3"],f:!1},{a:"node_out",c:"sU",g:["vec3"],f:!1}],j:[{a:"txt",b:"sU = sR ; sS ; sT ;".split(" ")}]},{a:"node",c:"SUBSURFACE_SCATTERING",m:[],l:[{a:"node_in",c:"sV",g:["vec3"],f:!1},{a:"node_in",c:"sW",g:["float"],f:!1},{a:"node_in",c:"sX",g:["vec3"],f:!1},{a:"node_in",c:"sY",g:["float"],f:!1},{a:"node_in",c:"sZ",g:["float"],f:!1},{a:"node_in",c:"s_",g:["vec3"],f:!1},{a:"node_out",c:"ta",g:["vec3"],f:!1}],j:[{a:"txt",b:"ta [ 0 ] = ta [ 1 ] = ta [ 2 ] = _0_0 ; sV ; sX ; sY ; sZ ; s_ ; sW ;".split(" ")}]},
{a:"node",c:"EMISSION",m:[],l:[{a:"node_in",c:"tb",g:["vec3"],f:!1},{a:"node_in",c:"tc",g:["float"],f:!1},{a:"node_out",c:"td",g:["vec3"],f:!1}],j:[{a:"txt",b:"td = tb ; tc ;".split(" ")}]},{a:"node",c:"AMBIENT_OCCLUSION",m:[],l:[{a:"node_in",c:"te",g:["vec3"],f:!1},{a:"node_out",c:"tf",g:["vec3"],f:!1}],j:[{a:"txt",b:"tf [ 0 ] = tf [ 1 ] = tf [ 2 ] = _0_0 ; te ;".split(" ")}]},{a:"node",c:"HOLDOUT",m:[],l:[{a:"node_out",c:"tg",g:["vec3"],f:!1}],j:[{a:"txt",b:"tg [ 0 ] = tg [ 1 ] = tg [ 2 ] = _0_0 ;".split(" ")}]},
{a:"node",c:"VOLUME_ABSORPTION",m:[],l:[{a:"node_in",c:"th",g:["vec3"],f:!1},{a:"node_in",c:"ti",g:["float"],f:!1},{a:"node_out",c:"tj",g:["vec3"],f:!1}],j:[{a:"txt",b:"tj [ 0 ] = tj [ 1 ] = tj [ 2 ] = _0_0 ; th ; ti ;".split(" ")}]},{a:"node",c:"VOLUME_SCATTER",m:[],l:[{a:"node_in",c:"tk",g:["vec3"],f:!1},{a:"node_in",c:"tl",g:["float"],f:!1},{a:"node_in",c:"tm",g:["float"],f:!1},{a:"node_out",c:"tn",g:["vec3"],f:!1}],j:[{a:"txt",b:"tn [ 0 ] = tn [ 1 ] = tn [ 2 ] = _0_0 ; tk ; tl ; tm ;".split(" ")}]},
{a:"node",c:"BUMP",m:[],l:[{a:"node_in",c:"to",g:["float"],f:!1},{a:"node_in",c:"tr",g:["float"],f:!1},{a:"node_in",c:"tu",g:["float"],f:!1},{a:"node_in",c:"tv",g:["vec3"],f:!1},{a:"node_out",c:"tw",g:["vec3"],f:!1}],j:[{a:"txt",b:"tw = tv ; to ; tr ; tu ;".split(" ")}]},{a:"node",c:"NORMAL_MAP",m:[{a:"node_var",c:"SPACE",b:["NM_TANGENT"]}],l:[{a:"node_in",c:"tx",g:["float"],f:!1},{a:"node_in",c:"ty",g:["vec4"],f:!1},{a:"node_out",c:"tz",g:["vec3"],f:!1}],j:[{a:"txt",b:["vec3","tA","=","nB",";"]},
{a:"node_cond",d:[{a:"node_if",e:["SPACE","NM_TANGENT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"tz = qM * ( ty . xyz - _0_5 ) ;".split(" ")}]},{a:"node_elif",e:["SPACE","NM_OBJECT",{a:"equal_expr",i:2},"SPACE","NM_BLENDER_OBJECT",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"tz = ty . xyz - _0_5 ; tz . yz *= - 1.0 ; tz = U ( H , tz ) ;".split(" ")}]},{a:"node_elif",e:["SPACE","NM_WORLD",{a:"equal_expr",i:2},"SPACE","NM_BLENDER_WORLD",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",
b:"tz = ty . xyz - _0_5 ; tz . yz *= - 1.0 ;".split(" ")}]}]},{a:"txt",b:"tz = normalize ( mix ( tA , tz , tx ) ) ;".split(" ")}]},{a:"node",c:"VECT_TRANSFORM",m:[{a:"node_var",c:"CONVERT_TYPE",b:["VT_WORLD_TO_OBJECT"]},{a:"node_var",c:"VECTOR_TYPE",b:["VT_VECTOR"]}],l:[{a:"node_in",c:"tB",g:["vec3"],f:!1},{a:"node_out",c:"tC",g:["vec3"],f:!1}],j:[{a:"node_cond",d:[{a:"node_if",e:["CONVERT_TYPE","VT_WORLD_TO_WORLD",{a:"equal_expr",i:2},"CONVERT_TYPE","VT_OBJECT_TO_OBJECT",{a:"equal_expr",i:2},"CONVERT_TYPE",
"VT_CAMERA_TO_CAMERA",{a:"equal_expr",i:2},{a:"logical_or_expr",i:3}],j:[{a:"txt",b:["tC","=","tB",";"]}]},{a:"node_else",j:[{a:"node_cond",d:[{a:"node_if",e:["VECTOR_TYPE","VT_POINT",{a:"equal_expr",i:2}],j:[{a:"node_cond",d:[{a:"node_if",e:["CONVERT_TYPE","VT_WORLD_TO_CAMERA",{a:"equal_expr",i:2}],j:[{a:"txt",b:"tC = ae ( F , tB ) ;".split(" ")}]},{a:"node_elif",e:["CONVERT_TYPE","VT_WORLD_TO_OBJECT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"tC = ae ( I , tB ) ;".split(" ")}]},{a:"node_elif",e:["CONVERT_TYPE",
"VT_OBJECT_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"tC = ae ( H , tB ) ;".split(" ")}]},{a:"node_elif",e:["CONVERT_TYPE","VT_OBJECT_TO_CAMERA",{a:"equal_expr",i:2}],j:[{a:"txt",b:"tC = ae ( H , tB ) ; tC = ae ( F , tC ) ;".split(" ")}]},{a:"node_elif",e:["CONVERT_TYPE","VT_CAMERA_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"tC = ae ( G , tB ) ;".split(" ")}]},{a:"node_elif",e:["CONVERT_TYPE","VT_CAMERA_TO_OBJECT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"tC = ae ( G , tB ) ; tC = ae ( I , tC ) ;".split(" ")}]}]}]},
{a:"node_else",j:[{a:"node_cond",d:[{a:"node_if",e:["CONVERT_TYPE","VT_WORLD_TO_CAMERA",{a:"equal_expr",i:2}],j:[{a:"txt",b:"tC = U ( F , tB ) ;".split(" ")}]},{a:"node_elif",e:["CONVERT_TYPE","VT_WORLD_TO_OBJECT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"tC = U ( I , tB ) ;".split(" ")}]},{a:"node_elif",e:["CONVERT_TYPE","VT_OBJECT_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"tC = U ( H , tB ) ;".split(" ")}]},{a:"node_elif",e:["CONVERT_TYPE","VT_OBJECT_TO_CAMERA",{a:"equal_expr",i:2}],j:[{a:"txt",
b:"tC = U ( H , tB ) ; tC = U ( F , tC ) ;".split(" ")}]},{a:"node_elif",e:["CONVERT_TYPE","VT_CAMERA_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"tC = U ( G , tB ) ;".split(" ")}]},{a:"node_elif",e:["CONVERT_TYPE","VT_CAMERA_TO_OBJECT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"tC = U ( G , tB ) ; tC = U ( I , tC ) ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",e:["VECTOR_TYPE","VT_NORMAL",{a:"equal_expr",i:2}],j:[{a:"txt",b:"tC = normalize ( tC ) ;".split(" ")}]}]}]}]}]},{a:"node",c:"BLACKBODY",
m:[],l:[{a:"node_in",c:"tD",g:["float"],f:!1},{a:"node_out",c:"tE",g:["vec3"],f:!1}],j:[{a:"txt",b:"tE [ 0 ] = tE [ 1 ] = tE [ 2 ] = _0_0 ; tD ;".split(" ")}]},{a:"node",c:"WAVELENGTH",m:[],l:[{a:"node_in",c:"tF",g:["float"],f:!1},{a:"node_out",c:"tG",g:["vec3"],f:!1}],j:[{a:"txt",b:"tG [ 0 ] = tG [ 1 ] = tG [ 2 ] = _0_0 ; tF ;".split(" ")}]},{a:"node",c:"SEPXYZ",m:[],l:[{a:"node_in",c:"tH",g:["vec3"],f:!1},{a:"node_out",c:"tI",g:["float"],f:!1},{a:"node_out",c:"tJ",g:["float"],f:!1},{a:"node_out",
c:"tK",g:["float"],f:!1}],j:[{a:"txt",b:"tI = tH [ 0 ] ; tJ = tH [ 1 ] ; tK = tH [ 2 ] ;".split(" ")}]},{a:"node",c:"COMBXYZ",m:[],l:[{a:"node_in",c:"tL",g:["float"],f:!1},{a:"node_in",c:"tM",g:["float"],f:!1},{a:"node_in",c:"tN",g:["float"],f:!1},{a:"node_out",c:"tO",g:["vec3"],f:!1}],j:[{a:"txt",b:"tO [ 0 ] = tL ; tO [ 1 ] = tM ; tO [ 2 ] = tN ;".split(" ")}]},{a:"node",c:"BRIGHTCONTRAST",m:[],l:[{a:"node_in",c:"tP",g:["vec3"],f:!1},{a:"node_in",c:"tQ",g:["float"],f:!1},{a:"node_in",c:"tR",g:["float"],
f:!1},{a:"node_out",c:"tS",g:["vec3"],f:!1}],j:[{a:"txt",b:"float b = tQ - tR * _0_5 ; tS = max ( ( _1_0 + tR ) * tP + b , vec3 ( _0_0 ) ) ;".split(" ")}]},{a:"node",c:"LIGHT_FALLOFF",m:[],l:[{a:"node_in",c:"tT",g:["float"],f:!1},{a:"node_in",c:"tU",g:["float"],f:!1},{a:"node_out",c:"tV",g:["float"],f:!1},{a:"node_out",c:"tW",g:["float"],f:!1},{a:"node_out",c:"tX",g:["float"],f:!1}],j:[{a:"txt",b:"tV = tW = tX = _0_0 ; tT ; tU ;".split(" ")}]},{a:"node",c:"TEX_IMAGE",m:[],l:[{a:"node_in",c:"tY",g:["vec3"],
f:!1},{a:"node_out",c:"tZ",g:["vec3"],f:!1},{a:"node_out",c:"t_",g:["float"],f:!1}],j:[{a:"txt",b:"tZ [ 0 ] = tZ [ 1 ] = tZ [ 2 ] = _0_0 ; t_ = _1_0 ; tY ;".split(" ")}]},{a:"node",c:"TEX_ENVIRONMENT",m:[],l:[{a:"node_in",c:"ua",g:["vec3"],f:!1},{a:"node_out",c:"ub",g:["vec3"],f:!1}],j:[{a:"txt",b:"ub [ 0 ] = ub [ 1 ] = ub [ 2 ] = _0_0 ; ua ;".split(" ")}]},{a:"node",c:"TEX_SKY",m:[],l:[{a:"node_in",c:"uc",g:["vec3"],f:!1},{a:"node_out",c:"ud",g:["vec3"],f:!1}],j:[{a:"txt",b:"ud [ 0 ] = ud [ 1 ] = ud [ 2 ] = _0_0 ; uc ;".split(" ")}]},
{a:"node",c:"TEX_NOISE",m:[],l:[{a:"node_in",c:"ue",g:["vec3"],f:!1},{a:"node_in",c:"uf",g:["float"],f:!1},{a:"node_in",c:"ug",g:["float"],f:!1},{a:"node_in",c:"uh",g:["float"],f:!1},{a:"node_out",c:"ui",g:["vec3"],f:!1},{a:"node_out",c:"uj",g:["float"],f:!1}],j:[{a:"txt",b:"ui [ 0 ] = ui [ 1 ] = ui [ 2 ] = _0_0 ; uj = _1_0 ; ue ; uf ; ug ; uh ;".split(" ")}]},{a:"node",c:"TEX_WAVE",m:[],l:[{a:"node_in",c:"uk",g:["vec3"],f:!1},{a:"node_in",c:"ul",g:["float"],f:!1},{a:"node_in",c:"um",g:["float"],
f:!1},{a:"node_in",c:"un",g:["float"],f:!1},{a:"node_in",c:"uo",g:["float"],f:!1},{a:"node_out",c:"up",g:["vec3"],f:!1},{a:"node_out",c:"uq",g:["float"],f:!1}],j:[{a:"txt",b:"up [ 0 ] = up [ 1 ] = up [ 2 ] = _0_0 ; uq = _1_0 ; uk ; ul ; um ; un ; uo ;".split(" ")}]},{a:"node",c:"TEX_VORONOI",m:[],l:[{a:"node_in",c:"ur",g:["vec3"],f:!1},{a:"node_in",c:"us",g:["float"],f:!1},{a:"node_out",c:"ut",g:["vec3"],f:!1},{a:"node_out",c:"uu",g:["float"],f:!1}],j:[{a:"txt",b:"ut [ 0 ] = ut [ 1 ] = ut [ 2 ] = _0_0 ; uu = _1_0 ; ur ; us ;".split(" ")}]},
{a:"node",c:"TEX_MUSGRAVE",m:[],l:[{a:"node_in",c:"uv",g:["vec3"],f:!1},{a:"node_in",c:"uw",g:["float"],f:!1},{a:"node_in",c:"ux",g:["float"],f:!1},{a:"node_in",c:"uy",g:["float"],f:!1},{a:"node_in",c:"uz",g:["float"],f:!1},{a:"node_in",c:"uA",g:["float"],f:!1},{a:"node_in",c:"uB",g:["float"],f:!1},{a:"node_out",c:"uC",g:["vec3"],f:!1},{a:"node_out",c:"uD",g:["float"],f:!1}],j:[{a:"txt",b:"uC [ 0 ] = uC [ 1 ] = uC [ 2 ] = _0_0 ; uD = _1_0 ; uv ; uw ; ux ; uy ; uz ; uA ; uB ;".split(" ")}]},{a:"node",
c:"TEX_GRADIENT",m:[],l:[{a:"node_in",c:"uE",g:["vec3"],f:!1},{a:"node_out",c:"uF",g:["vec3"],f:!1},{a:"node_out",c:"uG",g:["float"],f:!1}],j:[{a:"txt",b:"uF [ 0 ] = uF [ 1 ] = uF [ 2 ] = _0_0 ; uG = _1_0 ; uE ;".split(" ")}]},{a:"node",c:"TEX_MAGIC",m:[],l:[{a:"node_in",c:"uH",g:["vec3"],f:!1},{a:"node_in",c:"uI",g:["float"],f:!1},{a:"node_in",c:"uJ",g:["float"],f:!1},{a:"node_out",c:"uK",g:["vec3"],f:!1},{a:"node_out",c:"uL",g:["float"],f:!1}],j:[{a:"txt",b:"uK [ 0 ] = uK [ 1 ] = uK [ 2 ] = _0_0 ; uL = _1_0 ; uH ; uI ; uJ ;".split(" ")}]},
{a:"node",c:"TEX_CHECKER",m:[],l:[{a:"node_in",c:"uM",g:["vec3"],f:!1},{a:"node_in",c:"uN",g:["vec3"],f:!1},{a:"node_in",c:"uO",g:["vec3"],f:!1},{a:"node_in",c:"uP",g:["float"],f:!1},{a:"node_out",c:"uQ",g:["vec3"],f:!1},{a:"node_out",c:"uR",g:["float"],f:!1}],j:[{a:"txt",b:"uQ [ 0 ] = uQ [ 1 ] = uQ [ 2 ] = _0_0 ; uR = _1_0 ; uM ; uN ; uO ; uP ;".split(" ")}]},{a:"node",c:"TEX_BRICK",m:[],l:[{a:"node_in",c:"uS",g:["vec3"],f:!1},{a:"node_in",c:"uT",g:["vec3"],f:!1},{a:"node_in",c:"uU",g:["vec3"],f:!1},
{a:"node_in",c:"uV",g:["vec3"],f:!1},{a:"node_in",c:"uW",g:["float"],f:!1},{a:"node_in",c:"uX",g:["float"],f:!1},{a:"node_in",c:"uY",g:["float"],f:!1},{a:"node_in",c:"uZ",g:["float"],f:!1},{a:"node_in",c:"u_",g:["float"],f:!1},{a:"node_out",c:"va",g:["vec3"],f:!1},{a:"node_out",c:"vb",g:["float"],f:!1}],j:[{a:"txt",b:"va [ 0 ] = va [ 1 ] = va [ 2 ] = _0_0 ; vb = _1_0 ; uS ; uT ; uU ; uV ; uW ; uX ; uY ; uZ ; u_ ;".split(" ")}]},{a:"node",c:"ADD_SHADER",m:[],l:[{a:"node_in",c:"vc",g:["vec3"],f:!1},
{a:"node_in",c:"vd",g:["vec3"],f:!1},{a:"node_out",c:"ve",g:["vec3"],f:!1}],j:[{a:"txt",b:"ve = clamp ( vc + vd , vec3 ( _0_0 ) , vec3 ( _1_0 ) ) ;".split(" ")}]},{a:"node",c:"MIX_SHADER",m:[],l:[{a:"node_in",c:"vf",g:["float"],f:!1},{a:"node_in",c:"vg",g:["vec3"],f:!1},{a:"node_in",c:"vh",g:["vec3"],f:!1},{a:"node_out",c:"vi",g:["vec3"],f:!1}],j:[{a:"txt",b:"float vj = clamp ( vf , _0_0 , _1_0 ) ; vi = vj * vg + ( _1_0 - vj ) * vh ;".split(" ")}]},{a:"node",c:"UV_MERGED",m:[],l:[{a:"node_out",c:"vk",
g:["vec3"],f:!1},{a:"node_out",c:"vl",g:["vec3"],f:!1},{a:"node_param",c:"qE",g:["GLSL_IN","vec2"],f:!1}],j:[{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_vk"],j:[{a:"txt",b:"vk = qw ( qE ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_vl"],j:[{a:"txt",b:"vl = vec3 ( qE , _0_0 ) ;".split(" ")}]}]}]},{a:"node",c:"TEX_COORD_UV",m:[],l:[{a:"node_out",c:"vm",g:["vec3"],f:!1},{a:"node_param",c:"qF",g:["GLSL_IN","vec2"],f:!1}],j:[{a:"txt",b:"vm = vec3 ( qF , _0_0 ) ;".split(" ")}]},{a:"node",
c:"TEX_COORD_NO",m:[],l:[{a:"node_out",c:"vn",g:["vec3"],f:!1}],j:[{a:"txt",b:["vn","=","nB",";"]}]},{a:"node",c:"TEX_COORD_GE",m:[],l:[{a:"node_out",c:"vo",g:["vec3"],f:!1}],j:[{a:"txt",b:["vo","=","qo",";"]}]},{a:"node",c:"TEX_COORD_OB",m:[],l:[{a:"node_out",c:"vp",g:["vec3"],f:!1}],j:[{a:"txt",b:"vp [ 0 ] = vp [ 1 ] = vp [ 2 ] = _1_0 ;".split(" ")}]},{a:"node",c:"TEX_COORD_CA",m:[],l:[{a:"node_out",c:"vq",g:["vec3"],f:!1}],j:[{a:"txt",b:"vq [ 0 ] = qN [ 0 ] ; vq [ 1 ] = qN [ 1 ] ; vq [ 2 ] = _1_0 ;".split(" ")}]},
{a:"node",c:"TEX_COORD_WI",m:[],l:[{a:"node_out",c:"vr",g:["vec3"],f:!1}],j:[{a:"txt",b:"vr [ 0 ] = vr [ 1 ] = vr [ 2 ] = _1_0 ;".split(" ")}]},{a:"node",c:"TEX_COORD_RE",m:[],l:[{a:"node_out",c:"vs",g:["vec3"],f:!1}],j:[{a:"txt",b:"vs [ 0 ] = vs [ 1 ] = vs [ 2 ] = _1_0 ;".split(" ")}]},{a:"node",c:"UVMAP",m:[],l:[{a:"node_out",c:"vt",g:["vec3"],f:!1},{a:"node_param",c:"qG",g:["GLSL_IN","vec2"],f:!1}],j:[{a:"txt",b:"vt = vec3 ( qG , _0_0 ) ;".split(" ")}]},{a:"node",c:"PARTICLE_INFO",m:[],l:[{a:"node_out",
c:"vu",g:["float"],f:!1},{a:"node_out",c:"vv",g:["float"],f:!1},{a:"node_out",c:"vw",g:["float"],f:!1},{a:"node_out",c:"vx",g:["vec3"],f:!1},{a:"node_out",c:"vy",g:["float"],f:!1},{a:"node_out",c:"vz",g:["vec3"],f:!1},{a:"node_out",c:"vA",g:["vec3"],f:!1}],j:[{a:"txt",b:"vu = _0_0 ; vv = _0_0 ; vw = _0_0 ; vx = vec3 ( _0_0 ) ; vy = _0_0 ; vz = vx ; vA = vx ;".split(" ")}]},{a:"node",c:"HAIR_INFO",m:[],l:[{a:"node_out",c:"vB",g:["float"],f:!1},{a:"node_out",c:"vC",g:["float"],f:!1},{a:"node_out",c:"vD",
g:["float"],f:!1},{a:"node_out",c:"vE",g:["vec3"],f:!1}],j:[{a:"txt",b:"vB = _0_0 ; vC = _0_0 ; vD = _0_0 ; vE = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"OBJECT_INFO",m:[],l:[{a:"node_out",c:"vF",g:["vec3"],f:!1},{a:"node_out",c:"vG",g:["float"],f:!1},{a:"node_out",c:"vH",g:["float"],f:!1},{a:"node_out",c:"vI",g:["float"],f:!1}],j:[{a:"txt",b:"vG = _0_0 ; vH = _0_0 ; vI = _0_0 ; vF = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"WIREFRAME",m:[],l:[{a:"node_in",c:"vJ",g:["float"],f:!1},{a:"node_out",
c:"vK",g:["float"],f:!1}],j:[{a:"txt",b:["vK","=","vJ",";"]}]},{a:"node",c:"TANGENT",m:[],l:[{a:"node_out",c:"vL",g:["vec3"],f:!1}],j:[{a:"txt",b:"vL = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"LAYER_WEIGHT",m:[],l:[{a:"node_in",c:"vM",g:["float"],f:!1},{a:"node_in",c:"vN",g:["vec3"],f:!1},{a:"node_out",c:"vO",g:["float"],f:!1},{a:"node_out",c:"vP",g:["float"],f:!1}],j:[{a:"txt",b:"vO = vP = _0_0 ; vN ; vM ;".split(" ")}]},{a:"node",c:"LIGHT_PATH",m:[],l:[{a:"node_out",c:"vQ",g:["float"],f:!1},
{a:"node_out",c:"vR",g:["float"],f:!1},{a:"node_out",c:"vS",g:["float"],f:!1},{a:"node_out",c:"vT",g:["float"],f:!1},{a:"node_out",c:"vU",g:["float"],f:!1},{a:"node_out",c:"vV",g:["float"],f:!1},{a:"node_out",c:"vW",g:["float"],f:!1},{a:"node_out",c:"vX",g:["float"],f:!1},{a:"node_out",c:"vY",g:["float"],f:!1},{a:"node_out",c:"vZ",g:["float"],f:!1}],j:[{a:"txt",b:"vQ = vR = vS = _0_0 ; vT = vU = vV = _0_0 ; vW = vW = vY = vZ = _0_0 ; vX = _0_0 ;".split(" ")}]},{a:"node",c:"ATTRIBUTE",m:[],l:[{a:"node_out",
c:"v_",g:["vec3"],f:!1},{a:"node_out",c:"wa",g:["vec3"],f:!1},{a:"node_out",c:"wb",g:["float"],f:!1}],j:[{a:"txt",b:"v_ = wa = vec3 ( _0_0 ) ; wb = _0_0 ;".split(" ")}]},{a:"node",c:"SCRIPT",m:[],l:[],j:[]},{a:"node",c:"CURVE_VEC",m:[{a:"node_var",c:"READ_R",b:["0"]},{a:"node_var",c:"READ_G",b:["0"]},{a:"node_var",c:"READ_B",b:["0"]},{a:"node_var",c:"NODE_TEX_ROW",b:["0.0"]}],l:[{a:"node_in",c:"wc",g:["float"],f:!1},{a:"node_in",c:"wd",g:["vec3"],f:!1},{a:"node_out",c:"we",g:["vec3"],f:!1}],j:[{a:"txt",
b:["we","=","wd",";"]},{a:"node_cond",d:[{a:"node_if",e:["READ_R"],j:[{a:"txt",b:"we . r = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( 0.5 * wd . r + 0.5 , NODE_TEX_ROW ) ) . r - 0.5 ) * 2.0 ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",e:["READ_G"],j:[{a:"txt",b:"we . g = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( 0.5 * wd . g + 0.5 , NODE_TEX_ROW ) ) . g - 0.5 ) * 2.0 ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",e:["READ_B"],j:[{a:"txt",b:"we . b = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( 0.5 * wd . b + 0.5 , NODE_TEX_ROW ) ) . b - 0.5 ) * 2.0 ;".split(" ")}]}]},
{a:"txt",b:"we = mix ( wd , we , wc ) ;".split(" ")}]},{a:"node",c:"CURVE_RGB",m:[{a:"node_var",c:"READ_A",b:["0"]},{a:"node_var",c:"READ_R",b:["0"]},{a:"node_var",c:"READ_G",b:["0"]},{a:"node_var",c:"READ_B",b:["0"]},{a:"node_var",c:"NODE_TEX_ROW",b:["0.0"]}],l:[{a:"node_in",c:"wf",g:["float"],f:!1},{a:"node_in",c:"wg",g:["vec3"],f:!1},{a:"node_out",c:"wh",g:["vec3"],f:!1}],j:[{a:"node_cond",d:[{a:"node_if",e:["READ_A"],j:[{a:"txt",b:"float r = GLSL_TEXTURE ( u_nodes_texture , vec2 ( wg . r , NODE_TEX_ROW ) ) . a ; float g = GLSL_TEXTURE ( u_nodes_texture , vec2 ( wg . g , NODE_TEX_ROW ) ) . a ; float b = GLSL_TEXTURE ( u_nodes_texture , vec2 ( wg . b , NODE_TEX_ROW ) ) . a ;".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"float r = wg . r ; float g = wg . g ; float b = wg . b ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",e:["READ_R"],j:[{a:"txt",b:"wh . r = GLSL_TEXTURE ( u_nodes_texture , vec2 ( r , NODE_TEX_ROW ) ) . r ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"wh . r = r ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",e:["READ_G"],j:[{a:"txt",b:"wh . g = GLSL_TEXTURE ( u_nodes_texture , vec2 ( g , NODE_TEX_ROW ) ) . g ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"wh . g = g ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",e:["READ_B"],j:[{a:"txt",b:"wh . b = GLSL_TEXTURE ( u_nodes_texture , vec2 ( b , NODE_TEX_ROW ) ) . b ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"wh . b = b ;".split(" ")}]}]},{a:"txt",b:"wh = mix ( wg , wh , wf ) ;".split(" ")}]},{a:"node",c:"VALTORGB",m:[{a:"node_var",c:"NODE_TEX_ROW",b:["0.0"]}],l:[{a:"node_in",c:"wi",g:["float"],f:!1},{a:"node_out",c:"wj",g:["vec3"],f:!1},{a:"node_out",c:"wk",g:["float"],f:!1}],j:[{a:"txt",b:"vec4 wl = GLSL_TEXTURE ( u_nodes_texture , vec2 ( wi , NODE_TEX_ROW ) ) ; wj = wl . rgb ; wk = wl . a ;".split(" ")}]},
{a:"node",c:"MAPPING",m:[{a:"node_var",c:"MAPPING_SCALE_DEF",b:["0"]},{a:"node_var",c:"MAPPING_SCALE",b:["vec3","(","1.0",")"]},{a:"node_var",c:"MAPPING_TRANS_DEF",b:["0"]},{a:"node_var",c:"MAPPING_TRANS",b:["vec3","(","0.0",")"]},{a:"node_var",c:"MAPPING_TRS_MATRIX_DEF",b:["0"]},{a:"node_var",c:"MAPPING_TRS_MATRIX",b:["mat4","(","1.0",")"]},{a:"node_var",c:"MAPPING_MIN_CLIP_DEF",b:["0"]},{a:"node_var",c:"MAPPING_MIN_CLIP",b:["vec3","(","0.0",")"]},{a:"node_var",c:"MAPPING_MAX_CLIP_DEF",b:["0"]},
{a:"node_var",c:"MAPPING_MAX_CLIP",b:["vec3","(","1.0",")"]},{a:"node_var",c:"MAPPING_IS_NORMAL",b:["0"]}],l:[{a:"node_in",c:"wm",g:["vec3"],f:!1},{a:"node_out",c:"wn",g:["vec3"],f:!1}],j:[{a:"txt",b:["wn","=","wm",";"]},{a:"node_cond",d:[{a:"node_if",e:["MAPPING_SCALE_DEF"],j:[{a:"txt",b:"wn = wn * MAPPING_SCALE ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",e:["MAPPING_TRANS_DEF"],j:[{a:"txt",b:"wn = wn + MAPPING_TRANS ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",e:["MAPPING_TRS_MATRIX_DEF"],
j:[{a:"txt",b:"wn = ( MAPPING_TRS_MATRIX * vec4 ( wn , _1_0 ) ) . xyz ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",e:["MAPPING_MIN_CLIP_DEF"],j:[{a:"txt",b:"wn = max ( wn , MAPPING_MIN_CLIP ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",e:["MAPPING_MAX_CLIP_DEF"],j:[{a:"txt",b:"wn = min ( wn , MAPPING_MAX_CLIP ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",e:["MAPPING_IS_NORMAL"],j:[{a:"txt",b:"wn = normalize ( wn ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ADD",m:[{a:"node_var",c:"MATH_USE_CLAMP",
b:["0"]}],l:[{a:"node_in",c:"wo",g:["float"],f:!1},{a:"node_in",c:"wp",g:["float"],f:!1},{a:"node_out",c:"wq",g:["float"],f:!1}],j:[{a:"txt",b:"wq = wo + wp ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["MATH_USE_CLAMP"],j:[{a:"txt",b:"wq = clamp ( wq , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_SUBTRACT",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"wr",g:["float"],f:!1},{a:"node_in",c:"ws",g:["float"],f:!1},{a:"node_out",c:"wt",g:["float"],f:!1}],j:[{a:"txt",b:"wt = wr - ws ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",e:["MATH_USE_CLAMP"],j:[{a:"txt",b:"wt = clamp ( wt , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MULTIPLY",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"wu",g:["float"],f:!1},{a:"node_in",c:"wv",g:["float"],f:!1},{a:"node_out",c:"wA",g:["float"],f:!1}],j:[{a:"txt",b:"wA = wu * wv ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["MATH_USE_CLAMP"],j:[{a:"txt",b:"wA = clamp ( wA , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_DIVIDE",
m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"wB",g:["float"],f:!1},{a:"node_in",c:"wC",g:["float"],f:!1},{a:"node_out",c:"wD",g:["float"],f:!1}],j:[{a:"txt",b:"wD = ( wC != _0_0 ) ? wB / wC : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["MATH_USE_CLAMP"],j:[{a:"txt",b:"wD = clamp ( wD , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_SINE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"wE",g:["float"],f:!1},{a:"node_in",c:"wF",g:["float"],f:!1},
{a:"node_out",c:"wG",g:["float"],f:!1}],j:[{a:"txt",b:"wG = sin ( wE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["MATH_USE_CLAMP"],j:[{a:"txt",b:"wG = clamp ( wG , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["wF",";"]}]},{a:"node",c:"MATH_COSINE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"wH",g:["float"],f:!1},{a:"node_in",c:"wI",g:["float"],f:!1},{a:"node_out",c:"wJ",g:["float"],f:!1}],j:[{a:"txt",b:"wJ = cos ( wH ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["MATH_USE_CLAMP"],
j:[{a:"txt",b:"wJ = clamp ( wJ , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["wI",";"]}]},{a:"node",c:"MATH_TANGENT",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"wK",g:["float"],f:!1},{a:"node_in",c:"wL",g:["float"],f:!1},{a:"node_out",c:"wM",g:["float"],f:!1}],j:[{a:"txt",b:"wM = tan ( wK ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["MATH_USE_CLAMP"],j:[{a:"txt",b:"wM = clamp ( wM , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["wL",";"]}]},{a:"node",c:"MATH_ARCSINE",m:[{a:"node_var",
c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"wN",g:["float"],f:!1},{a:"node_in",c:"wO",g:["float"],f:!1},{a:"node_out",c:"wP",g:["float"],f:!1}],j:[{a:"txt",b:"wP = ( wN <= _1_0 && wN >= - _1_0 ) ? asin ( wN ) : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["MATH_USE_CLAMP"],j:[{a:"txt",b:"wP = clamp ( wP , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["wO",";"]}]},{a:"node",c:"MATH_ARCCOSINE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"wQ",g:["float"],f:!1},{a:"node_in",
c:"wR",g:["float"],f:!1},{a:"node_out",c:"wS",g:["float"],f:!1}],j:[{a:"txt",b:"wS = ( wQ <= _1_0 && wQ >= - _1_0 ) ? acos ( wQ ) : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["MATH_USE_CLAMP"],j:[{a:"txt",b:"wS = clamp ( wS , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["wR",";"]}]},{a:"node",c:"MATH_ARCTANGENT",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"wT",g:["float"],f:!1},{a:"node_in",c:"wU",g:["float"],f:!1},{a:"node_out",c:"wV",g:["float"],f:!1}],j:[{a:"txt",
b:"wV = atan ( wT ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["MATH_USE_CLAMP"],j:[{a:"txt",b:"wV = clamp ( wV , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["wU",";"]}]},{a:"node",c:"MATH_POWER",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"wW",g:["float"],f:!1},{a:"node_in",c:"wX",g:["float"],f:!1},{a:"node_out",c:"wY",g:["float"],f:!1}],j:[{a:"txt",b:"if ( wW < _0_0 && wX != floor ( wX ) ) wY = _0_0 ; else if ( wX == _0_0 ) wY = _1_0 ; else if ( wW < _0_0 ) wY = mix ( _1_0 , - _1_0 , sign ( mod ( - wX , 2.0 ) ) ) * pow ( - wW , wX ) ; else if ( wW == _0_0 ) wY = _0_0 ; else wY = pow ( wW , wX ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",e:["MATH_USE_CLAMP"],j:[{a:"txt",b:"wY = clamp ( wY , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_LOGARITHM",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"wZ",g:["float"],f:!1},{a:"node_in",c:"w_",g:["float"],f:!1},{a:"node_out",c:"xa",g:["float"],f:!1}],j:[{a:"txt",b:"xa = ( wZ > _0_0 && w_ > _0_0 ) ? log2 ( wZ ) / log2 ( w_ ) : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["MATH_USE_CLAMP"],j:[{a:"txt",b:"xa = clamp ( xa , _0_0 , _1_0 ) ;".split(" ")}]}]}]},
{a:"node",c:"MATH_MINIMUM",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"xb",g:["float"],f:!1},{a:"node_in",c:"xc",g:["float"],f:!1},{a:"node_out",c:"xd",g:["float"],f:!1}],j:[{a:"txt",b:"xd = min ( xb , xc ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["MATH_USE_CLAMP"],j:[{a:"txt",b:"xd = clamp ( xd , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MAXIMUM",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"xe",g:["float"],f:!1},{a:"node_in",c:"xf",g:["float"],
f:!1},{a:"node_out",c:"xg",g:["float"],f:!1}],j:[{a:"txt",b:"xg = max ( xe , xf ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["MATH_USE_CLAMP"],j:[{a:"txt",b:"xg = clamp ( xg , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ROUND",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"xh",g:["float"],f:!1},{a:"node_in",c:"xi",g:["float"],f:!1},{a:"node_out",c:"xj",g:["float"],f:!1}],j:[{a:"txt",b:"xj = floor ( xh + _0_5 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["MATH_USE_CLAMP"],
j:[{a:"txt",b:"xj = clamp ( xj , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["xi",";"]}]},{a:"node",c:"MATH_LESS_THAN",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"xk",g:["float"],f:!1},{a:"node_in",c:"xl",g:["float"],f:!1},{a:"node_out",c:"xm",g:["float"],f:!1}],j:[{a:"txt",b:"xm = ( xk < xl ) ? _1_0 : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["MATH_USE_CLAMP"],j:[{a:"txt",b:"xm = clamp ( xm , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_GREATER_THAN",m:[{a:"node_var",
c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"xn",g:["float"],f:!1},{a:"node_in",c:"xo",g:["float"],f:!1},{a:"node_out",c:"xp",g:["float"],f:!1}],j:[{a:"txt",b:"xp = ( xn > xo ) ? _1_0 : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["MATH_USE_CLAMP"],j:[{a:"txt",b:"xp = clamp ( xp , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MODULO",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"xq",g:["float"],f:!1},{a:"node_in",c:"xr",g:["float"],f:!1},{a:"node_out",c:"xs",
g:["float"],f:!1}],j:[{a:"txt",b:"xs = abs ( xr ) > 0.000001 ? mod ( xq , xr ) : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["MATH_USE_CLAMP"],j:[{a:"txt",b:"xs = clamp ( xs , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ABSOLUTE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"xt",g:["float"],f:!1},{a:"node_in",c:"xu",g:["float"],f:!1},{a:"node_out",c:"xv",g:["float"],f:!1}],j:[{a:"txt",b:"xv = abs ( xt ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["MATH_USE_CLAMP"],
j:[{a:"txt",b:"xv = clamp ( xv , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["xu",";"]}]},{a:"node",c:"MIX_RGB_MIX",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"xA",g:["float"],f:!1},{a:"node_in",c:"xB",g:["vec3"],f:!1},{a:"node_in",c:"xC",g:["vec3"],f:!1},{a:"node_out",c:"xD",g:["vec3"],f:!1}],j:[{a:"txt",b:"float vj = clamp ( xA , _0_0 , _1_0 ) ; xD = mix ( xB , xC , vj ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"xD = clamp ( xD , _0_0 , _1_0 ) ;".split(" ")}]}]}]},
{a:"node",c:"MIX_RGB_ADD",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"xE",g:["float"],f:!1},{a:"node_in",c:"xF",g:["vec3"],f:!1},{a:"node_in",c:"xG",g:["vec3"],f:!1},{a:"node_out",c:"xH",g:["vec3"],f:!1}],j:[{a:"txt",b:"float vj = clamp ( xE , _0_0 , _1_0 ) ; xH = mix ( xF , xF + xG , vj ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"xH = clamp ( xH , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_MULTIPLY",m:[{a:"node_var",
c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"xI",g:["float"],f:!1},{a:"node_in",c:"xJ",g:["vec3"],f:!1},{a:"node_in",c:"xK",g:["vec3"],f:!1},{a:"node_out",c:"xL",g:["vec3"],f:!1}],j:[{a:"txt",b:"float vj = clamp ( xI , _0_0 , _1_0 ) ; xL = mix ( xJ , xJ * xK , vj ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"xL = clamp ( xL , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SUBTRACT",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",
c:"xM",g:["float"],f:!1},{a:"node_in",c:"xN",g:["vec3"],f:!1},{a:"node_in",c:"xO",g:["vec3"],f:!1},{a:"node_out",c:"xP",g:["vec3"],f:!1}],j:[{a:"txt",b:"float vj = clamp ( xM , _0_0 , _1_0 ) ; xP = mix ( xN , xN - xO , vj ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"xP = clamp ( xP , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SCREEN",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"xQ",g:["float"],f:!1},{a:"node_in",c:"xR",
g:["vec3"],f:!1},{a:"node_in",c:"xS",g:["vec3"],f:!1},{a:"node_out",c:"xT",g:["vec3"],f:!1}],j:[{a:"txt",b:"float vj = clamp ( xQ , _0_0 , _1_0 ) ; float xU = _1_0 - vj ; xT = vec3 ( _1_0 ) - ( vec3 ( xU ) + vj * ( vec3 ( _1_0 ) - xS ) ) * ( vec3 ( _1_0 ) - xR ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"xT = clamp ( xT , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DIVIDE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"xV",
g:["float"],f:!1},{a:"node_in",c:"xW",g:["vec3"],f:!1},{a:"node_in",c:"xX",g:["vec3"],f:!1},{a:"node_out",c:"xY",g:["vec3"],f:!1}],j:[{a:"txt",b:"float vj = clamp ( xV , _0_0 , _1_0 ) ; float xU = _1_0 - vj ; xX += step ( xX , vec3 ( _0_0 ) ) ; xY = xU * xW + vj * xW / xX ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"xY = clamp ( xY , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DIFFERENCE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",
c:"xZ",g:["float"],f:!1},{a:"node_in",c:"x_",g:["vec3"],f:!1},{a:"node_in",c:"ya",g:["vec3"],f:!1},{a:"node_out",c:"yb",g:["vec3"],f:!1}],j:[{a:"txt",b:"float vj = clamp ( xZ , _0_0 , _1_0 ) ; yb = mix ( x_ , abs ( x_ - ya ) , vj ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"yb = clamp ( yb , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DARKEN",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yc",g:["float"],f:!1},{a:"node_in",
c:"yd",g:["vec3"],f:!1},{a:"node_in",c:"ye",g:["vec3"],f:!1},{a:"node_out",c:"yf",g:["vec3"],f:!1}],j:[{a:"txt",b:"float vj = clamp ( yc , _0_0 , _1_0 ) ; yf = min ( yd . rgb , ye . rgb * vj ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"yf = clamp ( yf , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_LIGHTEN",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yg",g:["float"],f:!1},{a:"node_in",c:"yh",g:["vec3"],f:!1},{a:"node_in",
c:"yi",g:["vec3"],f:!1},{a:"node_out",c:"yj",g:["vec3"],f:!1}],j:[{a:"txt",b:"float vj = clamp ( yg , _0_0 , _1_0 ) ; yj = max ( yh . rgb , yi . rgb * vj ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"yj = clamp ( yj , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_OVERLAY",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yk",g:["float"],f:!1},{a:"node_in",c:"yl",g:["vec3"],f:!1},{a:"node_in",c:"ym",g:["vec3"],f:!1},{a:"node_out",
c:"yn",g:["vec3"],f:!1}],j:[{a:"txt",b:"float vj = clamp ( yk , _0_0 , _1_0 ) ; vec3 yo = vec3 ( _1_0 - vj ) ; yn = mix ( yl * ( yo + 2.0 * vj * ym ) , vec3 ( _1_0 ) - ( yo + 2.0 * vj * ( vec3 ( _1_0 ) - ym ) ) * ( vec3 ( _1_0 ) - yl ) , step ( _0_5 , yl ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"yn = clamp ( yn , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DODGE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yp",g:["float"],
f:!1},{a:"node_in",c:"yq",g:["vec3"],f:!1},{a:"node_in",c:"yr",g:["vec3"],f:!1},{a:"node_out",c:"ys",g:["vec3"],f:!1}],j:[{a:"txt",b:"float vj = clamp ( yp , _0_0 , _1_0 ) ; vec3 yt = vec3 ( _1_0 ) - vj * yr ; vec3 yu = clamp ( yq / yt , _0_0 , _1_0 ) ; ys = mix ( mix ( yu , vec3 ( _1_0 ) , step ( yt , vec3 ( _0_0 ) ) ) , yq , step ( yq , vec3 ( _0_0 ) ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"ys = clamp ( ys , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",
c:"MIX_RGB_BURN",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yv",g:["float"],f:!1},{a:"node_in",c:"yA",g:["vec3"],f:!1},{a:"node_in",c:"yB",g:["vec3"],f:!1},{a:"node_out",c:"yC",g:["vec3"],f:!1}],j:[{a:"txt",b:"float vj = clamp ( yv , _0_0 , _1_0 ) ; vec3 kd = vec3 ( _1_0 - vj ) ; vec3 yt = kd + vj * yB ; vec3 yu = clamp ( vec3 ( _1_0 ) - ( vec3 ( _1_0 ) - yA ) / yt , _0_0 , _1_0 ) ; yC = mix ( yu , vec3 ( _0_0 ) , step ( yt , vec3 ( _0_0 ) ) ) ;".split(" ")},{a:"node_cond",
d:[{a:"node_if",e:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"yC = clamp ( yC , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_HUE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yD",g:["float"],f:!1},{a:"node_in",c:"yE",g:["vec3"],f:!1},{a:"node_in",c:"yF",g:["vec3"],f:!1},{a:"node_out",c:"yG",g:["vec3"],f:!1}],j:[{a:"txt",b:"float vj = clamp ( yD , _0_0 , _1_0 ) ; vec3 kb , yH , yt ; yG = yE ; yH = ka ( yF ) ; if ( yH . y != _0_0 ) { kb = ka ( yG ) ; kb . x = yH . x ; yt = kc ( kb ) ; yG = mix ( yG , yt , vj ) ; }".split(" ")},
{a:"node_cond",d:[{a:"node_if",e:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"yG = clamp ( yG , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SATURATION",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yI",g:["float"],f:!1},{a:"node_in",c:"yJ",g:["vec3"],f:!1},{a:"node_in",c:"yK",g:["vec3"],f:!1},{a:"node_out",c:"yL",g:["vec3"],f:!1}],j:[{a:"txt",b:"float vj = clamp ( yI , _0_0 , _1_0 ) ; float xU = _1_0 - vj ; yL = yJ ; vec3 kb , yH ; kb = ka ( yL ) ; if ( kb . y != _0_0 ) { yH = ka ( yK ) ; kb . y = xU * kb . y + vj * yH . y ; yL = kc ( kb ) ; }".split(" ")},
{a:"node_cond",d:[{a:"node_if",e:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"yL = clamp ( yL , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_VALUE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yM",g:["float"],f:!1},{a:"node_in",c:"yN",g:["vec3"],f:!1},{a:"node_in",c:"yO",g:["vec3"],f:!1},{a:"node_out",c:"yP",g:["vec3"],f:!1}],j:[{a:"txt",b:"float vj = clamp ( yM , _0_0 , _1_0 ) ; float xU = _1_0 - vj ; vec3 kb , yH ; kb = ka ( yN ) ; yH = ka ( yO ) ; kb . z = xU * kb . z + vj * yH . z ; yP = kc ( kb ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",e:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"yP = clamp ( yP , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_COLOR",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yQ",g:["float"],f:!1},{a:"node_in",c:"yR",g:["vec3"],f:!1},{a:"node_in",c:"yS",g:["vec3"],f:!1},{a:"node_out",c:"yT",g:["vec3"],f:!1}],j:[{a:"txt",b:"float vj = clamp ( yQ , _0_0 , _1_0 ) ; vec3 kb , yH , yt ; yT = yR ; yH = ka ( yS ) ; if ( yH . y != _0_0 ) { kb = ka ( yT ) ; kb . x = yH . x ; kb . y = yH . y ; yt = kc ( kb ) ; yT = mix ( yT , yt , vj ) ; }".split(" ")},
{a:"node_cond",d:[{a:"node_if",e:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"yT = clamp ( yT , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SOFT_LIGHT",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yU",g:["float"],f:!1},{a:"node_in",c:"yV",g:["vec3"],f:!1},{a:"node_in",c:"yW",g:["vec3"],f:!1},{a:"node_out",c:"yX",g:["vec3"],f:!1}],j:[{a:"txt",b:"float vj = clamp ( yU , _0_0 , _1_0 ) ; float xU = _1_0 - vj ; vec3 yY = yW + yV - yW * yV ; yX = yV * ( vec3 ( xU ) + vec3 ( vj ) * ( ( vec3 ( _1_0 ) - yV ) * yW + yY ) ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",e:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"yX = clamp ( yX , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_LINEAR_LIGHT",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yZ",g:["float"],f:!1},{a:"node_in",c:"y_",g:["vec3"],f:!1},{a:"node_in",c:"za",g:["vec3"],f:!1},{a:"node_out",c:"zb",g:["vec3"],f:!1}],j:[{a:"txt",b:"float vj = clamp ( yZ , _0_0 , _1_0 ) ; zb = y_ + vj * ( 2.0 * za - vec3 ( _1_0 ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",
e:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"zb = clamp ( zb , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"OUTPUT",m:[],l:[{a:"node_in",c:"zc",g:["vec3"],f:!1},{a:"node_in",c:"zd",g:["float"],f:!1}],j:[{a:"txt",b:"A = zc ; E = zd ;".split(" ")}]},{a:"node",c:"MATERIAL_BEGIN",m:[{a:"node_var",c:"MATERIAL_EXT",b:["0"]},{a:"node_var",c:"USE_MATERIAL_NORMAL",b:["0"]},{a:"node_var",c:"USE_MATERIAL_DIFFUSE",b:["0"]},{a:"node_var",c:"SHADELESS_MAT",b:["0"]}],l:[{a:"node_in",c:"ze",g:["vec3"],f:!1},{a:"node_in",
c:"zf",g:["vec3"],f:!1},{a:"node_in",c:"zg",g:["float"],f:!1},{a:"node_in",c:"zh",g:["vec3"],f:!0},{a:"node_in",c:"zi",g:["float"],f:!0},{a:"node_out",c:"zj",g:["vec3"],f:!1},{a:"node_out",c:"zk",g:["vec3"],f:!1},{a:"node_out",c:"zl",g:["vec3"],f:!1},{a:"node_out",c:"zm",g:["vec3"],f:!1},{a:"node_out",c:"zn",g:["vec3"],f:!1},{a:"node_out",c:"zo",g:["vec2"],f:!1},{a:"node_out",c:"zp",g:["vec2"],f:!1},{a:"node_out",c:"zq",g:["vec4"],f:!1},{a:"node_param",c:"qH",g:["const","vec2"],f:!1},{a:"node_param",
c:"qI",g:["const","vec3"],f:!1}],j:[{a:"txt",b:"zl = clamp ( ze , _0_0 , _1_0 ) ; zm = qI [ 0 ] * clamp ( zf , _0_0 , _1_0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["USE_MATERIAL_NORMAL"],j:[{a:"txt",b:"zn = normalize ( zh ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:["zn","=","nB",";"]}]}]},{a:"node_cond",d:[{a:"node_if",e:["SHADELESS_MAT",{a:"logic_negative_expr",i:1}],j:[{a:"node_cond",d:[{a:"node_if",e:["MATERIAL_EXT"],j:[{a:"txt",b:"zj = zi * zl ;".split(" ")}]},{a:"node_else",j:[{a:"txt",
b:"zj = qO * zl ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",e:["USE_MATERIAL_DIFFUSE"],j:[{a:"txt",b:["zl","*=","zg",";"]}]}]},{a:"txt",b:"zk = qP * u_environment_energy * ce ( zn ) ; zq = ch ( zl ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["NUM_LIGHTS",0,{a:"g_expr",i:2}],j:[{a:"txt",b:"zo = vec2 ( qH [ 0 ] , qH [ 1 ] ) ; zp = vec2 ( qI [ 1 ] , qI [ 2 ] ) ;".split(" ")}]}]},{a:"txt",b:["D","=","zq",";"]}]},{a:"node_else",j:[{a:"txt",b:"zj = vec3 ( _0_0 ) ; zk = vec3 ( _1_0 ) ;".split(" ")}]}]}]},
{a:"node",c:"MATERIAL_END",m:[{a:"node_var",c:"MATERIAL_EXT",b:["0"]},{a:"node_var",c:"USE_MATERIAL_DIFFUSE",b:["0"]},{a:"node_var",c:"USE_MATERIAL_SPECULAR",b:["0"]}],l:[{a:"node_in",c:"zr",g:["vec4"],f:!1},{a:"node_in",c:"zs",g:["vec3"],f:!1},{a:"node_in",c:"zt",g:["vec3"],f:!1},{a:"node_in",c:"zu",g:["float"],f:!0},{a:"node_in",c:"zv",g:["float"],f:!0},{a:"node_in",c:"zA",g:["float"],f:!0},{a:"node_out",c:"zB",g:["vec3"],f:!0},{a:"node_out",c:"zC",g:["float"],f:!0},{a:"node_out",c:"zD",g:["vec3"],
f:!0},{a:"node_out",c:"zE",g:["vec3"],f:!0},{a:"node_out",c:"zF",g:["vec3"],f:!0},{a:"node_param",c:"qJ",g:["float"],f:!1},{a:"node_param",c:"qK",g:["float"],f:!1}],j:[{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_zB"],j:[{a:"node_cond",d:[{a:"node_if",e:["USE_MATERIAL_DIFFUSE"],j:[{a:"txt",b:"zB = zr . rgb ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"zB = vec3 ( _0_0 ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",e:["MATERIAL_EXT","REFLECTION_TYPE","REFL_NONE",{a:"non_equal_expr",i:2},{a:"logical_and_expr",
i:2}],j:[{a:"node_cond",d:[{a:"node_if",e:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],j:[{a:"txt",b:"cq ( zB , v , zt , zu , F ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"cq ( zB , v , zt , zu , mat3 ( _0_0 ) ) ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",e:["USE_MATERIAL_SPECULAR"],j:[{a:"txt",b:["zB","+=","zs",";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_zD"],j:[{a:"txt",b:["zD","=","zt",";"]}]}]},{a:"node_cond",d:[{a:"node_if",e:["MATERIAL_EXT"],j:[{a:"node_cond",
d:[{a:"node_if",e:["USE_OUT_zE"],j:[{a:"txt",b:"zE = zr . rgb ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_zF"],j:[{a:"txt",b:["zF","=","zs",";"]}]}]},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_zC"],j:[{a:"txt",b:"zC = clamp ( zA , _0_0 , _1_0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["USE_MATERIAL_SPECULAR"],j:[{a:"txt",b:"float t = max ( max ( zs . r , zs . g ) , zs . b ) * zv ; zC = clamp ( zA * ( _1_0 - t ) + t , _0_0 , _1_0 ) ;".split(" ")}]}]}]}]}]},{a:"node_else",
j:[{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_zC"],j:[{a:"txt",b:"zC = clamp ( qJ , _0_0 , _1_0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["USE_MATERIAL_SPECULAR"],j:[{a:"txt",b:"float t = max ( max ( zs . r , zs . g ) , zs . b ) * qK ; zC = qJ * ( _1_0 - t ) + t ;".split(" ")}]}]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",e:["USE_MATERIAL_SPECULAR"],j:[{a:"txt",b:["B","=","zs",";"]}]},{a:"node_else",j:[{a:"txt",b:"B = vec3 ( _0_0 ) ;".split(" ")}]}]},{a:"txt",b:["C","=","zt",";"]}]},{a:"node",
c:"LIGHTING_AMBIENT",m:[],l:[{a:"node_in",c:"nS",g:["vec3"],f:!1},{a:"node_in",c:"nT",g:["vec3"],f:!1},{a:"node_in",c:"nU",g:["vec3"],f:!1},{a:"node_out",c:"nV",g:["vec4"],f:!1},{a:"node_out",c:"nW",g:["vec3"],f:!1}],j:[{a:"txt",b:"nV = vec4 ( nS + nU * nT , _0_0 ) ; nW = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"LIGHTING_LAMP",m:[{a:"node_var",c:"LAMP_TYPE",b:["HEMI"]},{a:"node_var",c:"LAMP_IND",b:["0"]},{a:"node_var",c:"LAMP_LIGHT_FACT_IND",b:["0"]},{a:"node_var",c:"LAMP_FAC_CHANNELS",b:["rg"]},
{a:"node_var",c:"LAMP_SPOT_SIZE",b:["0.8"]},{a:"node_var",c:"LAMP_SPOT_BLEND",b:["0.03"]},{a:"node_var",c:"LAMP_LIGHT_DIST",b:["30.0"]},{a:"node_var",c:"LAMP_SHADOW_MAP_IND",b:["-","1"]}],l:[{a:"node_in",c:"nX",g:["vec4"],f:!1},{a:"node_out",c:"nY",g:["vec3"],f:!1},{a:"node_out",c:"nZ",g:["vec2"],f:!1},{a:"node_out",c:"n_",g:["vec3"],f:!1},{a:"node_out",c:"oa",g:["float"],f:!1}],j:[{a:"txt",b:"nZ = u_light_factors [ LAMP_LIGHT_FACT_IND ] . LAMP_FAC_CHANNELS ;".split(" ")},{a:"node_cond",d:[{a:"node_if",
e:["LAMP_TYPE","HEMI",{a:"equal_expr",i:2}],j:[{a:"txt",b:["oa","=","_0_5",";"]}]},{a:"node_else",j:[{a:"txt",b:["oa","=","_0_0",";"]}]}]},{a:"txt",b:"n_ = u_light_color_intensities [ LAMP_IND ] ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["LAMP_SHADOW_MAP_IND",1,{a:"negative_expr",i:1},{a:"non_equal_expr",i:2}],j:[{a:"txt",b:"n_ *= nX [ LAMP_SHADOW_MAP_IND ] ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",e:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2},"LAMP_TYPE","POINT",{a:"equal_expr",i:2},{a:"logical_or_expr",
i:2}],j:[{a:"txt",b:"vec3 ob = u_light_positions [ LAMP_IND ] ; nY = ob - nA ; float aG = length ( nY ) ; n_ *= LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + aG * aG ) ; nY = normalize ( nY ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vec3 oc = u_light_directions [ LAMP_IND ] ; float od = dot ( nY , oc ) ; od *= smoothstep ( _0_0 , _1_0 , ( od - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; n_ *= od ;".split(" ")}]}]}]},{a:"node_else",j:[{a:"txt",b:"nY = u_light_directions [ LAMP_IND ] ;".split(" ")}]}]}]},
{a:"node",c:"DIFFUSE_FRESNEL",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oe",g:["vec3"],f:!1},{a:"node_in",c:"of",g:["vec2"],f:!1},{a:"node_in",c:"og",g:["vec3"],f:!1},{a:"node_in",c:"oh",g:["float"],f:!1},{a:"node_in",c:"oi",g:["vec2"],f:!1},{a:"node_out",c:"oj",g:["float"],f:!1}],j:[{a:"txt",b:["vec3","zG","=","og",";"]},{a:"node_cond",d:[{a:"node_if",e:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 ok = cross ( oe , o . xyz ) ; zG = cross ( ok , o . xyz ) ; zG = - normalize ( zG ) ;".split(" ")}]}]},
{a:"txt",b:"oj = _0_0 ; if ( of . r != _0_0 ) { float ol = ( _1_0 - oh ) * dot ( zG , oe ) + oh ; if ( oi [ 0 ] == _0_0 ) { oj = _1_0 ; } else { float t = _1_0 + abs ( ol ) ; t = oi [ 1 ] + ( _1_0 - oi [ 1 ] ) * pow ( t , oi [ 0 ] ) ; oj = clamp ( t , _0_0 , _1_0 ) ; } oj = max ( oj , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_LAMBERT",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"om",g:["vec3"],f:!1},{a:"node_in",c:"on",g:["vec2"],f:!1},{a:"node_in",c:"oo",g:["vec3"],
f:!1},{a:"node_in",c:"op",g:["float"],f:!1},{a:"node_out",c:"oq",g:["float"],f:!1}],j:[{a:"txt",b:["vec3","zG","=","oo",";"]},{a:"node_cond",d:[{a:"node_if",e:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 ok = cross ( om , o . xyz ) ; zG = cross ( ok , o . xyz ) ; zG = - normalize ( zG ) ;".split(" ")}]}]},{a:"txt",b:"oq = _0_0 ; if ( on . r != _0_0 ) { float ol = ( _1_0 - op ) * dot ( zG , om ) + op ; oq = max ( ol , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_OREN_NAYAR",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",
b:["0"]}],l:[{a:"node_in",c:"or",g:["vec3"],f:!1},{a:"node_in",c:"os",g:["vec2"],f:!1},{a:"node_in",c:"ot",g:["vec3"],f:!1},{a:"node_in",c:"ou",g:["float"],f:!1},{a:"node_in",c:"ov",g:["vec2"],f:!1},{a:"node_out",c:"ow",g:["float"],f:!1}],j:[{a:"txt",b:["vec3","zG","=","ot",";"]},{a:"node_cond",d:[{a:"node_if",e:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 ok = cross ( or , o . xyz ) ; zG = cross ( ok , o . xyz ) ; zG = - normalize ( zG ) ;".split(" ")}]}]},{a:"txt",b:"ow = _0_0 ; if ( os . r != _0_0 ) { float ol = ( _1_0 - ou ) * dot ( zG , or ) + ou ; if ( ov [ 0 ] > _0_0 ) { float ox = max ( dot ( zG , v ) , _0_0 ) ; float oy = ov [ 0 ] * ov [ 0 ] ; float cg = _1_0 - _0_5 * ( oy / ( oy + 0.33 ) ) ; vec3 oz = or - ol * zG ; vec3 oA = v - ox * zG ; if ( length ( oz ) == _0_0 || length ( oA ) == _0_0 || abs ( ol ) > _1_0 || abs ( ox ) > _1_0 ) ow = ol * cg ; else { float oB = acos ( ol ) ; float oC = acos ( ox ) ; vec3 oD = normalize ( oz ) ; vec3 oE = normalize ( oA ) ; float a , b ; a = max ( oB , oC ) ; b = min ( oB , oC ) ; b *= 0.95 ; float t = max ( dot ( oD , oE ) , _0_0 ) ; float oF = 0.45 * ( oy / ( oy + 0.09 ) ) ; ow = ol * ( cg + ( oF * t * sin ( a ) * tan ( b ) ) ) ; } } else ow = ol ; ow = max ( ow , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"DIFFUSE_MINNAERT",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oG",g:["vec3"],f:!1},{a:"node_in",c:"oH",g:["vec2"],f:!1},{a:"node_in",c:"oI",g:["vec3"],f:!1},{a:"node_in",c:"oJ",g:["float"],f:!1},{a:"node_in",c:"oK",g:["vec2"],f:!1},{a:"node_out",c:"oL",g:["float"],f:!1}],j:[{a:"txt",b:["vec3","zG","=","oI",";"]},{a:"node_cond",d:[{a:"node_if",e:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 ok = cross ( oG , o . xyz ) ; zG = cross ( ok , o . xyz ) ; zG = - normalize ( zG ) ;".split(" ")}]}]},
{a:"txt",b:"oL = _0_0 ; if ( oH . r != _0_0 ) { float ol = ( _1_0 - oJ ) * dot ( zG , oG ) + oJ ; float ox = max ( dot ( zG , v ) , _0_0 ) ; if ( oK [ 0 ] <= _1_0 ) oL = ol * pow ( max ( ox * ol , 0.1 ) , oK [ 0 ] - _1_0 ) ; else oL = ol * pow ( 1.0001 - ox , oK [ 0 ] - _1_0 ) ; oL = max ( oL , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_TOON",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oM",g:["vec3"],f:!1},{a:"node_in",c:"oN",g:["vec2"],f:!1},{a:"node_in",c:"oO",g:["vec3"],
f:!1},{a:"node_in",c:"oP",g:["float"],f:!1},{a:"node_in",c:"oQ",g:["vec2"],f:!1},{a:"node_out",c:"oR",g:["float"],f:!1}],j:[{a:"txt",b:["vec3","zG","=","oO",";"]},{a:"node_cond",d:[{a:"node_if",e:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 ok = cross ( oM , o . xyz ) ; zG = cross ( ok , o . xyz ) ; zG = - normalize ( zG ) ;".split(" ")}]}]},{a:"txt",b:"oR = _0_0 ; if ( oN . r != _0_0 ) { float ol = ( _1_0 - oP ) * dot ( zG , oM ) + oP ; float oS = acos ( ol ) ; if ( oS < oQ [ 0 ] ) oR = _1_0 ; else if ( oS > ( oQ [ 0 ] + oQ [ 1 ] ) || oQ [ 1 ] == _0_0 ) oR = _0_0 ; else oR = _1_0 - ( ( oS - oQ [ 0 ] ) / oQ [ 1 ] ) ; oR = max ( oR , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"SPECULAR_PHONG",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oT",g:["vec3"],f:!1},{a:"node_in",c:"oU",g:["vec2"],f:!1},{a:"node_in",c:"oV",g:["vec3"],f:!1},{a:"node_in",c:"oW",g:["float"],f:!1},{a:"node_in",c:"oX",g:["vec2"],f:!1},{a:"node_out",c:"oY",g:["float"],f:!1}],j:[{a:"txt",b:"oY = _0_0 ; if ( oU . g == _1_0 ) { vec3 oZ = normalize ( oT + v ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"if ( oW == _0_0 ) { oY = dot ( o . xyz , oZ ) ; oY = sqrt ( _1_0 - oY * oY ) ; }".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"oY = ( _1_0 - oW ) * max ( dot ( oV , oZ ) , _0_0 ) + oW ;".split(" ")}]}]},{a:"txt",b:"oY = pow ( oY , oX [ 0 ] ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_WARDISO",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"o_",g:["vec3"],f:!1},{a:"node_in",c:"pa",g:["vec2"],f:!1},{a:"node_in",c:"pb",g:["vec3"],f:!1},{a:"node_in",c:"pc",g:["float"],f:!1},{a:"node_in",c:"pd",g:["vec2"],f:!1},{a:"node_out",c:"pe",g:["float"],f:!1}],j:[{a:"txt",b:"pe = _0_0 ; if ( pa . g == _1_0 ) { vec3 oZ = normalize ( o_ + v ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",e:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float pf = _0_0 ; float ox = _0_0 ; float pg = _0_0 ; if ( pc == _0_0 ) { pf = dot ( o . xyz , oZ ) ; ox = dot ( o . xyz , v ) ; pg = dot ( o . xyz , o_ ) ; pf = sqrt ( _1_0 - pf * pf ) ; ox = sqrt ( _1_0 - ox * ox ) ; pg = sqrt ( _1_0 - pg * pg ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float pf = max ( dot ( pb , oZ ) , 0.01 ) ; float ox = max ( dot ( pb , v ) , 0.01 ) ; float pg = max ( dot ( pb , o_ ) , 0.01 ) ;".split(" ")}]}]},
{a:"txt",b:"float bl = tan ( acos ( pf ) ) ; float L = max ( pd [ 0 ] , 0.01 ) ; pe = pg * ( _1_0 / ( 4.0 * M_PI * L * L ) ) * ( exp ( - ( bl * bl ) / ( L * L ) ) / ( sqrt ( ox * pg ) ) ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_TOON",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"ph",g:["vec3"],f:!1},{a:"node_in",c:"pi",g:["vec2"],f:!1},{a:"node_in",c:"pj",g:["vec3"],f:!1},{a:"node_in",c:"pk",g:["float"],f:!1},{a:"node_in",c:"pl",g:["vec2"],f:!1},{a:"node_out",c:"pm",g:["float"],
f:!1}],j:[{a:"txt",b:"pm = _0_0 ; if ( pi . g == _1_0 ) { vec3 bO = normalize ( ph + v ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float pn = dot ( bO , o . xyz ) ; float bl = pl [ 0 ] + pl [ 1 ] ; if ( pk == _0_0 ) bl = acos ( sqrt ( _1_0 - pn * pn ) ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float bl = acos ( dot ( bO , pj ) ) ;".split(" ")}]}]},{a:"txt",b:"if ( bl < pl [ 0 ] ) pm = _1_0 ; else if ( bl >= pl [ 0 ] + pl [ 1 ] || pl [ 1 ] == _0_0 ) pm = _0_0 ; else pm = _1_0 - ( bl - pl [ 0 ] ) / pl [ 1 ] ; }".split(" ")}]},
{a:"node",c:"SPECULAR_BLINN",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"po",g:["vec3"],f:!1},{a:"node_in",c:"pr",g:["vec2"],f:!1},{a:"node_in",c:"pu",g:["vec3"],f:!1},{a:"node_in",c:"pv",g:["float"],f:!1},{a:"node_in",c:"pw",g:["vec2"],f:!1},{a:"node_out",c:"px",g:["float"],f:!1}],j:[{a:"txt",b:"px = _0_0 ; if ( pr . g == _1_0 ) { if ( pw [ 0 ] < 1.0 || pw [ 1 ] == _0_0 ) px = _0_0 ; else { if ( pw [ 1 ] < 100.0 ) pw [ 1 ] = sqrt ( 1.0 / pw [ 1 ] ) ; else pw [ 1 ] = 10.0 / pw [ 1 ] ; vec3 oZ = normalize ( v + po ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",e:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float pf = 0.0 ; if ( pv == _0_0 ) { float py = dot ( o . xyz , oZ ) ; pf = sqrt ( _1_0 - py * py ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float pf = ( _1_0 - pv ) * max ( dot ( pu , oZ ) , _0_0 ) + pv ;".split(" ")}]}]},{a:"txt",b:"if ( pf < _0_0 ) px = _0_0 ; else { float ox = max ( dot ( pu , v ) , 0.01 ) ; float pg = dot ( pu , po ) ; if ( pg <= 0.01 ) px = _0_0 ; else { float pz = max ( dot ( v , oZ ) , 0.01 ) ; float a = _1_0 ; float b = ( 2.0 * pf * ox ) / pz ; float db = ( 2.0 * pf * pg ) / pz ; float g = min ( min ( a , b ) , db ) ; float p = sqrt ( pow ( pw [ 0 ] , 2.0 ) + pow ( pz , 2.0 ) - _1_0 ) ; float lq = pow ( p - pz , 2.0 ) / pow ( p + pz , 2.0 ) * ( _1_0 + pow ( pz * ( p + pz ) - _1_0 , 2.0 ) / pow ( pz * ( p - pz ) + _1_0 , 2.0 ) ) ; float oS = acos ( pf ) ; px = max ( lq * g * exp ( - pow ( oS , 2.0 ) / ( 2.0 * pow ( pw [ 1 ] , 2.0 ) ) ) , _0_0 ) ; } } } }".split(" ")}]},
{a:"node",c:"LIGHTING_APPLY",m:[],l:[{a:"node_in",c:"pA",g:["vec4"],f:!1},{a:"node_in",c:"pB",g:["vec3"],f:!1},{a:"node_in",c:"pC",g:["float"],f:!1},{a:"node_in",c:"pD",g:["float"],f:!1},{a:"node_in",c:"pE",g:["vec3"],f:!1},{a:"node_in",c:"pF",g:["vec3"],f:!1},{a:"node_in",c:"pG",g:["vec4"],f:!1},{a:"node_in",c:"pH",g:["vec3"],f:!1},{a:"node_in",c:"pI",g:["vec3"],f:!1},{a:"node_in",c:"pJ",g:["vec3"],f:!1},{a:"node_in",c:"pK",g:["float"],f:!1},{a:"node_out",c:"pL",g:["vec4"],f:!1},{a:"node_out",c:"pM",
g:["vec3"],f:!1}],j:[{a:"node_cond",d:[{a:"node_if",e:["USE_NODE_B4W_TRANSLUCENCY"],j:[{a:"txt",b:"if ( dot ( pE , pF ) * dot ( v , pF ) < _0_0 ) { float zH = pG . x ; float zI = pG . y ; float zJ = pG . z ; float zK = pG . w ; float zL = clamp ( abs ( dot ( pE , pF ) ) , _0_0 , _1_0 ) ; float zM = clamp ( dot ( v , - pE ) , _0_0 , _1_0 ) ; float zN = pow ( zM , zI ) ; pL = pA + pK * vec4 ( pJ * zL * pow ( pH , vec3 ( zH ) ) , _1_0 ) ; pL += zJ * mix ( vec4 ( pH , _1_0 ) , vec4 ( _1_0 ) , zK ) * pK * vec4 ( pJ * zL * vec3 ( zN ) , _1_0 ) ; pM = pB ; } else { pM = pB + pJ * pI * pD ; pL = pA + vec4 ( pJ * pH * pC , pD ) ; }".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"pM = pB + pJ * pI * pD ; pL = pA + vec4 ( pJ * pH * pC , pD ) ;".split(" ")}]}]}]},{a:"node",c:"RGB",m:[{a:"node_var",c:"RGB_IND",b:["0"]}],l:[{a:"node_out",c:"zO",g:["vec3"],f:!1}],j:[{a:"txt",b:"zO = u_node_rgbs [ RGB_IND ] ;".split(" ")}]},{a:"node",c:"RGBTOBW",m:[],l:[{a:"node_in",c:"zP",g:["vec3"],f:!1},{a:"node_out",c:"zQ",g:["float"],f:!1}],j:[{a:"txt",b:"zQ = dot ( zP , vec3 ( 0.35 , 0.45 , 0.2 ) ) ;".split(" ")}]},{a:"node",c:"SEPRGB",m:[],l:[{a:"node_in",c:"zR",
g:["vec3"],f:!1},{a:"node_out",c:"zS",g:["float"],f:!0},{a:"node_out",c:"zT",g:["float"],f:!0},{a:"node_out",c:"zU",g:["float"],f:!0}],j:[{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_zS"],j:[{a:"txt",b:"zS = zR . r ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_zT"],j:[{a:"txt",b:"zT = zR . g ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_zU"],j:[{a:"txt",b:"zU = zR . b ;".split(" ")}]}]}]},{a:"node",c:"SEPHSV",m:[],l:[{a:"node_in",c:"zV",g:["vec3"],f:!1},{a:"node_out",
c:"zW",g:["float"],f:!0},{a:"node_out",c:"zX",g:["float"],f:!0},{a:"node_out",c:"zY",g:["float"],f:!0}],j:[{a:"txt",b:"vec3 zZ = ka ( zV ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_zW"],j:[{a:"txt",b:"zW = zZ . r ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_zX"],j:[{a:"txt",b:"zX = zZ . g ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_zY"],j:[{a:"txt",b:"zY = zZ . b ;".split(" ")}]}]}]},{a:"node",c:"SQUEEZE",m:[],l:[{a:"node_in",c:"z_",g:["float"],f:!1},
{a:"node_in",c:"Aa",g:["float"],f:!1},{a:"node_in",c:"Ab",g:["float"],f:!1},{a:"node_out",c:"Ac",g:["float"],f:!1}],j:[{a:"txt",b:"Ac = _1_0 / ( _1_0 + pow ( 2.71828183 , - ( z_ - Ab ) * Aa ) ) ;".split(" ")}]},{a:"node",c:"GAMMA",m:[],l:[{a:"node_in",c:"Ad",g:["vec3"],f:!1},{a:"node_in",c:"Ae",g:["float"],f:!1},{a:"node_out",c:"Af",g:["vec3"],f:!1}],j:[{a:"txt",b:"Af = Ad ; if ( Af . x > _0_0 ) Af . x = pow ( Ad . x , Ae ) ; if ( Af . y > _0_0 ) Af . y = pow ( Ad . y , Ae ) ; if ( Af . z > _0_0 ) Af . z = pow ( Ad . z , Ae ) ;".split(" ")}]},
{a:"node",c:"B4W_SRGB_TO_LINEAR",m:[],l:[{a:"node_in",c:"Ag",g:["vec3"],f:!1},{a:"node_out",c:"Ah",g:["vec3"],f:!1}],j:[{a:"txt",b:"Ah = max ( vec3 ( _0_0 ) , Ag ) ; Ah = pow ( Ah , vec3 ( 2.2 ) ) ;".split(" ")}]},{a:"node",c:"B4W_LINEAR_TO_SRGB",m:[],l:[{a:"node_in",c:"Ai",g:["vec3"],f:!1},{a:"node_out",c:"Aj",g:["vec3"],f:!1}],j:[{a:"txt",b:"Aj = max ( vec3 ( _0_0 ) , Ai ) ; Aj = pow ( Aj , vec3 ( _1_0 / 2.2 ) ) ;".split(" ")}]},{a:"node",c:"TEXTURE_EMPTY",m:[],l:[{a:"node_out",c:"Ak",g:["vec3"],
f:!1},{a:"node_out",c:"Al",g:["vec3"],f:!1},{a:"node_out",c:"Am",g:["float"],f:!1}],j:[{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_Ak"],j:[{a:"txt",b:"Ak [ 2 ] = Ak [ 1 ] = Ak [ 0 ] = _0_0 ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_Al"],j:[{a:"txt",b:"Al [ 2 ] = Al [ 1 ] = Al [ 0 ] = _0_0 ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_Am"],j:[{a:"txt",b:["Am","=","_0_0",";"]}]}]}]},{a:"node",c:"TEXTURE_ENVIRONMENT",m:[],l:[{a:"node_in",c:"An",g:["vec3"],f:!1},{a:"node_out",
c:"Ao",g:["vec3"],f:!0},{a:"node_out",c:"Ap",g:["float"],f:!0},{a:"node_param",c:"node_TEXTURE_ENVIRONMENT_var_texture",g:["uniform","samplerCube"],f:!1}],j:[{a:"txt",b:"vec3 Aq = vec3 ( An . x , An . y , An . z ) ; vec4 wl = GLSL_TEXTURE_CUBE ( node_TEXTURE_ENVIRONMENT_var_texture , Aq ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_Ao"],j:[{a:"txt",b:"Ao = wl . xyz ; bY ( Ao ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_Ap"],j:[{a:"txt",b:"Ap = wl . w ;".split(" ")}]}]}]},
{a:"node",c:"TEXTURE_COLOR",m:[{a:"node_var",c:"NON_COLOR",b:["0"]},{a:"node_var",c:"USE_uv2",b:["0"]},{a:"node_var",c:"USE_uv3",b:["0"]},{a:"node_var",c:"USE_uv4",b:["0"]}],l:[{a:"node_in",c:"Ar",g:["vec3"],f:!0},{a:"node_in",c:"As",g:["vec3"],f:!0},{a:"node_in",c:"At",g:["vec3"],f:!0},{a:"node_in",c:"Au",g:["vec3"],f:!0},{a:"node_out",c:"Av",g:["vec3"],f:!0},{a:"node_out",c:"Aw",g:["float"],f:!0},{a:"node_out",c:"Ax",g:["vec3"],f:!0},{a:"node_out",c:"Ay",g:["float"],f:!0},{a:"node_out",c:"Az",g:["vec3"],
f:!0},{a:"node_out",c:"AA",g:["float"],f:!0},{a:"node_out",c:"AB",g:["vec3"],f:!0},{a:"node_out",c:"AC",g:["float"],f:!0},{a:"node_param",c:"node_TEXTURE_COLOR_var_texture",g:["uniform","sampler2D"],f:!1}],j:[{a:"txt",b:"vec4 wl = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qx ( Ar ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_Av"],j:[{a:"txt",b:"Av = wl . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["NON_COLOR",{a:"logic_negative_expr",i:1}],j:[{a:"txt",b:["bY","(","Av",
")",";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_Aw"],j:[{a:"txt",b:"Aw = wl . w ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",e:["USE_uv2"],j:[{a:"txt",b:"wl = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qx ( As ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_Ax"],j:[{a:"txt",b:"Ax = wl . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["NON_COLOR",{a:"logic_negative_expr",i:1}],j:[{a:"txt",b:["bY","(","Ax",")",";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_Ay"],
j:[{a:"txt",b:"Ay = wl . w ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",e:["USE_uv3"],j:[{a:"txt",b:"wl = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qx ( At ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_Az"],j:[{a:"txt",b:"Az = wl . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["NON_COLOR",{a:"logic_negative_expr",i:1}],j:[{a:"txt",b:["bY","(","Az",")",";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_AA"],j:[{a:"txt",b:"AA = wl . w ;".split(" ")}]}]}]}]},
{a:"node_cond",d:[{a:"node_if",e:["USE_uv4"],j:[{a:"txt",b:"wl = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qx ( Au ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_AB"],j:[{a:"txt",b:"AB = wl . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["NON_COLOR",{a:"logic_negative_expr",i:1}],j:[{a:"txt",b:["bY","(","AB",")",";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_AC"],j:[{a:"txt",b:"AC = wl . w ;".split(" ")}]}]}]}]}]},{a:"node",c:"TEXTURE_NORMAL",m:[{a:"node_var",
c:"USE_uv2",b:["0"]},{a:"node_var",c:"USE_uv3",b:["0"]},{a:"node_var",c:"USE_uv4",b:["0"]}],l:[{a:"node_in",c:"AD",g:["vec3"],f:!0},{a:"node_in",c:"AE",g:["vec3"],f:!0},{a:"node_in",c:"AF",g:["vec3"],f:!0},{a:"node_in",c:"AG",g:["vec3"],f:!0},{a:"node_out",c:"AH",g:["vec3"],f:!0},{a:"node_out",c:"AI",g:["float"],f:!0},{a:"node_out",c:"AJ",g:["vec3"],f:!0},{a:"node_out",c:"AK",g:["float"],f:!0},{a:"node_out",c:"AL",g:["vec3"],f:!0},{a:"node_out",c:"AM",g:["float"],f:!0},{a:"node_out",c:"AN",g:["vec3"],
f:!0},{a:"node_out",c:"AO",g:["float"],f:!0},{a:"node_param",c:"node_TEXTURE_NORMAL_var_texture",g:["uniform","sampler2D"],f:!1}],j:[{a:"txt",b:"vec4 wl = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qx ( AD ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_AH"],j:[{a:"txt",b:"AH = normalize ( qM * ( wl . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_AI"],j:[{a:"txt",b:"AI = wl . w ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",e:["USE_uv2"],j:[{a:"txt",
b:"wl = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qx ( AE ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_AJ"],j:[{a:"txt",b:"AJ = normalize ( qM * ( wl . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_AK"],j:[{a:"txt",b:"AK = wl . w ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",e:["USE_uv3"],j:[{a:"txt",b:"wl = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qx ( AF ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_AL"],j:[{a:"txt",
b:"AL = normalize ( qM * ( wl . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_AM"],j:[{a:"txt",b:"AM = wl . w ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",e:["USE_uv4"],j:[{a:"txt",b:"wl = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qx ( AG ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_AN"],j:[{a:"txt",b:"AN = normalize ( qM * ( wl . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_AO"],j:[{a:"txt",b:"AO = wl . w ;".split(" ")}]}]}]}]}]},
{a:"node",c:"VALUE",m:[{a:"node_var",c:"VALUE_IND",b:["0"]}],l:[{a:"node_out",c:"AP",g:["float"],f:!1}],j:[{a:"txt",b:"AP = u_node_values [ VALUE_IND ] ;".split(" ")}]},{a:"node",c:"VECT_MATH_ADD",m:[],l:[{a:"node_in",c:"AQ",g:["vec3"],f:!1},{a:"node_in",c:"AR",g:["vec3"],f:!1},{a:"node_out",c:"AS",g:["vec3"],f:!1},{a:"node_out",c:"AT",g:["float"],f:!0}],j:[{a:"txt",b:"AS = AQ + AR ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_AT"],j:[{a:"txt",b:"AT = ( abs ( AS [ 0 ] ) + abs ( AS [ 1 ] ) + abs ( AS [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},
{a:"node",c:"VECT_MATH_SUBTRACT",m:[],l:[{a:"node_in",c:"AU",g:["vec3"],f:!1},{a:"node_in",c:"AV",g:["vec3"],f:!1},{a:"node_out",c:"AW",g:["vec3"],f:!1},{a:"node_out",c:"AX",g:["float"],f:!0}],j:[{a:"txt",b:"AW = AU - AV ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_AX"],j:[{a:"txt",b:"AX = ( abs ( AW [ 0 ] ) + abs ( AW [ 1 ] ) + abs ( AW [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_AVERAGE",m:[],l:[{a:"node_in",c:"AY",g:["vec3"],f:!1},{a:"node_in",c:"AZ",g:["vec3"],f:!1},
{a:"node_out",c:"A_",g:["vec3"],f:!1},{a:"node_out",c:"Ba",g:["float"],f:!0}],j:[{a:"txt",b:"A_ = AY + AZ ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_Ba"],j:[{a:"txt",b:"Ba = length ( A_ ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_A_"],j:[{a:"txt",b:"A_ = normalize ( A_ ) ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_DOT_PRODUCT",m:[],l:[{a:"node_in",c:"Bb",g:["vec3"],f:!1},{a:"node_in",c:"Bc",g:["vec3"],f:!1},{a:"node_out",c:"Bd",g:["vec3"],f:!1},{a:"node_out",c:"Be",
g:["float"],f:!0}],j:[{a:"txt",b:"Bd = vec3 ( _0_0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_Be"],j:[{a:"txt",b:"Be = dot ( Bb , Bc ) ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_CROSS_PRODUCT",m:[],l:[{a:"node_in",c:"Bf",g:["vec3"],f:!1},{a:"node_in",c:"Bg",g:["vec3"],f:!1},{a:"node_out",c:"Bh",g:["vec3"],f:!1},{a:"node_out",c:"Bi",g:["float"],f:!0}],j:[{a:"txt",b:"Bh = cross ( Bf , Bg ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_Bi"],j:[{a:"txt",b:"Bi = length ( Bh ) ;".split(" ")}]}]}]},
{a:"node",c:"VECT_MATH_NORMALIZE",m:[],l:[{a:"node_in",c:"Bj",g:["vec3"],f:!1},{a:"node_in",c:"Bk",g:["vec3"],f:!1},{a:"node_out",c:"Bl",g:["vec3"],f:!1},{a:"node_out",c:"Bm",g:["float"],f:!0}],j:[{a:"txt",b:"Bl = normalize ( Bj ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_Bm"],j:[{a:"txt",b:"Bm = length ( Bj ) ;".split(" ")}]}]},{a:"txt",b:["Bk",";"]}]},{a:"node",c:"B4W_REFLECT",m:[],l:[{a:"node_in",c:"Bn",g:["vec3"],f:!1},{a:"node_in",c:"Bo",g:["vec3"],f:!1},{a:"node_out",c:"Bp",
g:["vec3"],f:!1}],j:[{a:"txt",b:"Bp = reflect ( U ( G , Bn ) , Bo ) ;".split(" ")}]},{a:"node",c:"B4W_REFLECT_WORLD",m:[],l:[{a:"node_in",c:"Bq",g:["vec3"],f:!1},{a:"node_out",c:"Br",g:["vec3"],f:!1}],j:[{a:"txt",b:"vec3 Bs = - v . xyz ; Br = reflect ( Bs , Bq ) ;".split(" ")}]},{a:"node",c:"B4W_PARALLAX",m:[],l:[{a:"node_in",c:"Bt",g:["vec3"],f:!1},{a:"node_in",c:"Bu",g:["float"],f:!1},{a:"node_in",c:"Bv",g:["const","float"],f:!1},{a:"node_in",c:"Bw",g:["const","float"],f:!1},{a:"node_out",c:"Bx",
g:["vec3"],f:!1},{a:"node_param",c:"node_B4W_PARALLAX_var_texture",g:["uniform","sampler2D"],f:!1}],j:[{a:"txt",b:"float bo = length ( qN ) ; if ( bo < Bw ) { vec2 bE = qx ( Bt ) ; float bI = clamp ( _0_5 * ( Bw - bo ) , _0_0 , _1_0 ) ; float hN = Bu * bI ; vec3 bK = normalize ( v * qM ) ; float bL = _1_0 / Bv ; vec2 bM = bK . xy * hN / ( Bv * bK . z ) ; float bN = _1_0 ; float bO = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bE ) . a ; for ( float bQ = 1.0 ; bQ <= Bv ; bQ ++ ) { if ( bO < bN ) { bN -= bL ; bE -= bM ; bO = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bE ) . a ; } } vec2 bR = bE + bM ; float bS = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bR ) . a - ( bN + bL ) ; float bT = bO - bN ; float bU = bT / ( bT - bS ) ; bE = bU * bR + ( _1_0 - bU ) * bE ; Bx = qw ( bE ) ; } else Bx = Bt ;".split(" ")}]},
{a:"node",c:"B4W_CLAMP",m:[],l:[{a:"node_in",c:"By",g:["vec3"],f:!1},{a:"node_out",c:"Bz",g:["vec3"],f:!1}],j:[{a:"txt",b:"Bz = clamp ( By , _0_0 , _1_0 ) ;".split(" ")}]},{a:"node",c:"B4W_REFRACTION",m:[],l:[{a:"node_in",c:"BA",g:["vec3"],f:!1},{a:"node_in",c:"BB",g:["float"],f:!1},{a:"node_out",c:"BC",g:["vec3"],f:!1}],j:[{a:"txt",b:"BC = qv ( BA , BB ) ;".split(" ")}]},{a:"node",c:"B4W_TRANSLUCENCY",m:[],l:[{a:"node_in",c:"BD",g:["float"],f:!1},{a:"node_in",c:"BE",g:["float"],f:!1},{a:"node_in",
c:"BF",g:["float"],f:!1},{a:"node_in",c:"BG",g:["float"],f:!1},{a:"node_in",c:"BH",g:["float"],f:!1},{a:"node_out",c:"BI",g:["float"],f:!0},{a:"node_out",c:"BJ",g:["vec4"],f:!0}],j:[{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_BI"],j:[{a:"txt",b:["BI","=","BD",";"]}]}]},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_BJ"],j:[{a:"txt",b:"BJ = vec4 ( BE , BF , BG , BH ) ;".split(" ")}]}]}]},{a:"node",c:"B4W_TIME",m:[],l:[{a:"node_out",c:"BK",g:["float"],f:!1}],j:[{a:"txt",b:["BK","=","u_time",";"]}]},{a:"node",
c:"B4W_SMOOTHSTEP",m:[],l:[{a:"node_in",c:"BL",g:["float"],f:!1},{a:"node_in",c:"BM",g:["float"],f:!1},{a:"node_in",c:"BN",g:["float"],f:!1},{a:"node_out",c:"BO",g:["float"],f:!1}],j:[{a:"txt",b:"BO = smoothstep ( BM , BN , BL ) ;".split(" ")}]},{a:"node",c:"B4W_GLOW_OUTPUT",m:[],l:[{a:"node_in",c:"BP",g:["vec3"],f:!1},{a:"node_in",c:"BQ",g:["float"],f:!1}],j:[{a:"txt",b:"A = BP ; E = BQ ;".split(" ")}]},{a:"node",c:"B4W_VECTOSCAL",m:[],l:[{a:"node_in",c:"BR",g:["vec3"],f:!1},{a:"node_out",c:"BS",
g:["float"],f:!1}],j:[{a:"txt",b:"BS = ( BR . r + BR . g + BR . b ) / 3.0 ;".split(" ")}]},{a:"node",c:"B4W_SCALTOVEC",m:[],l:[{a:"node_in",c:"BT",g:["float"],f:!1},{a:"node_out",c:"BU",g:["vec3"],f:!1}],j:[{a:"txt",b:"BU [ 0 ] = BT ; BU [ 1 ] = BT ; BU [ 2 ] = BT ;".split(" ")}]},{a:"nodes_global"},{a:"txt",b:"void J ( in vec3 v , in mat3 F , in mat3 G , in mat3 H , in mat3 I , out vec3 A , out vec3 B , out vec3 C , out vec4 D , out float E ) { A = vec3 ( _0_0 ) ; B = vec3 ( _0_0 ) ; C = vec3 ( _0_0 ) ; D = vec4 ( _0_0 ) ; E = _0_0 ;".split(" ")},
{a:"cond",d:[{a:"if",e:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","USE_NODE_TEX_COORD_NO","USE_NODE_NORMAL_MAP",{a:"logical_or_expr",i:6}],h:{a:"grp",d:[{a:"txt",b:"vec3 Q = normalize ( e ) ; vec3 bF = Q ;".split(" ")},{a:"cond",d:[{a:"if",e:["DOUBLE_SIDED_LIGHTING","USE_NODE_GEOMETRY_NO",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["INVERT_FRONTFACING"],h:{a:"grp",d:[{a:"txt",b:["if","(","!","gl_FrontFacing",")"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",
b:["if","(","gl_FrontFacing",")"]}]}}]},{a:"txt",b:"bF = bF ; else bF = - bF ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["DOUBLE_SIDED_LIGHTING"],h:{a:"grp",d:[{a:"txt",b:["vec3","nB","=","bF",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec3","nB","=","Q",";"]}]}}]},{a:"cond",d:[{a:"if",e:["USE_NODE_GEOMETRY_NO"],h:{a:"grp",d:[{a:"txt",b:["vec3","qL","=","bF",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",e:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:"vec3 S = cross ( bF , f . xyz ) * f . w ; S = normalize ( S ) ; vec3 R = cross ( S , bF ) * f . w ; mat3 qM = mat3 ( R , S , bF ) ;".split(" ")}]}}]},
{a:"txt",b:"vec3 nA = c ; vec4 qN = d ; float qO = u_emit ; float qP = u_ambient ;".split(" ")},{a:"nodes_main"},{a:"txt",b:["}"]}]}}]}]};a["include/nodes.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"NODES_GLSLV",h:{a:"grp",d:[{a:"define",c:"NODES_GLSLV",b:[""]},{a:"var",c:"PARTICLE_BATCH",b:["0"]},{a:"cond",d:[{a:"if",e:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",i:2},"PARTICLE_BATCH",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec3 a_orco_tex_coord ; GLSL_OUT vec3 qo ;".split(" ")}]}}]},
{a:"node",c:"TEX_COORD_UV",m:[],l:[{a:"node_param",c:"node_TEX_COORD_UV_var_a_uv",g:["GLSL_IN","vec2"],f:!1},{a:"node_param",c:"qF",g:["GLSL_OUT","vec2"],f:!1}],j:[{a:"txt",b:["qF","=","node_TEX_COORD_UV_var_a_uv",";"]}]},{a:"node",c:"UV_MERGED",m:[],l:[{a:"node_param",c:"node_UV_MERGED_var_a_uv",g:["GLSL_IN","vec2"],f:!1},{a:"node_param",c:"qE",g:["GLSL_OUT","vec2"],f:!1}],j:[{a:"txt",b:["qE","=","node_UV_MERGED_var_a_uv",";"]}]},{a:"node",c:"UVMAP",m:[],l:[{a:"node_param",c:"node_UVMAP_var_a_uv",
g:["GLSL_IN","vec2"],f:!1},{a:"node_param",c:"qG",g:["GLSL_OUT","vec2"],f:!1}],j:[{a:"txt",b:["qG","=","node_UVMAP_var_a_uv",";"]}]},{a:"node",c:"GEOMETRY_UV",m:[],l:[{a:"node_param",c:"node_GEOMETRY_UV_var_a_uv",g:["GLSL_IN","vec2"],f:!1},{a:"node_param",c:"qy",g:["GLSL_OUT","vec2"],f:!1}],j:[{a:"txt",b:["qy","=","node_GEOMETRY_UV_var_a_uv",";"]}]},{a:"node",c:"GEOMETRY_VC",m:[],l:[{a:"node_param",c:"node_GEOMETRY_VC_var_a_vertex_color",g:["GLSL_IN","vec3"],f:!1},{a:"node_param",c:"BV",g:["GLSL_OUT",
"vec3"],f:!1}],j:[{a:"txt",b:["BV","=","node_GEOMETRY_VC_var_a_vertex_color",";"]}]},{a:"node",c:"GEOMETRY_VC1",m:[],l:[{a:"node_param",c:"node_GEOMETRY_VC1_var_a_vertex_color",g:["GLSL_IN","float"],f:!1},{a:"node_param",c:"BW",g:["GLSL_OUT","float"],f:!1}],j:[{a:"txt",b:["BW","=","node_GEOMETRY_VC1_var_a_vertex_color",";"]}]},{a:"node",c:"GEOMETRY_VC2",m:[],l:[{a:"node_param",c:"node_GEOMETRY_VC2_var_a_vertex_color",g:["GLSL_IN","vec2"],f:!1},{a:"node_param",c:"BX",g:["GLSL_OUT","vec2"],f:!1}],j:[{a:"txt",
b:["BX","=","node_GEOMETRY_VC2_var_a_vertex_color",";"]}]},{a:"node",c:"GEOMETRY_VC3",m:[],l:[{a:"node_param",c:"node_GEOMETRY_VC3_var_a_vertex_color",g:["GLSL_IN","vec3"],f:!1},{a:"node_param",c:"BY",g:["GLSL_OUT","vec3"],f:!1}],j:[{a:"txt",b:["BY","=","node_GEOMETRY_VC3_var_a_vertex_color",";"]}]},{a:"nodes_global"},{a:"txt",b:["void","J","(",")","{"]},{a:"cond",d:[{a:"if",e:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["qo","=","a_orco_tex_coord",
";"]}]}}]},{a:"nodes_main"},{a:"txt",b:["}"]}]}}]}]};a["include/pack.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"PACK_GLSLF",h:{a:"grp",d:[{a:"define",c:"PACK_GLSLF",b:[""]},{a:"txt",b:"vec4 gy ( const in float ic ) { vec4 fm = vec4 ( _255_0 * _255_0 * _255_0 , _255_0 * _255_0 , _255_0 , _1_0 ) ; vec4 BZ = vec4 ( _0_0 , _1_0 / _255_0 , _1_0 / _255_0 , _1_0 / _255_0 ) ; vec4 ju = fract ( ic * fm ) ; ju -= ju . xxyz * BZ ; return ju ; } float cv ( const in vec4 B_ ) { float gt ; vec4 fm = vec4 ( _1_0 / ( _255_0 * _255_0 * _255_0 ) , _1_0 / ( _255_0 * _255_0 ) , _1_0 / _255_0 , _1_0 ) ; gt = dot ( B_ , fm ) ; return gt ; } vec4 gy ( const in vec2 hl ) { vec2 fm = vec2 ( _255_0 , _1_0 ) ; vec2 BZ = vec2 ( _0_0 , _1_0 / _255_0 ) ; vec4 ju = fract ( hl . xxyy * fm . xyxy ) ; ju -= ju . xxzz * BZ . xyxy ; if ( hl . r == _1_0 ) ju . rg = vec2 ( _0_0 , _1_0 ) ; if ( hl . g == _1_0 ) ju . ba = vec2 ( _0_0 , _1_0 ) ; return ju ; } vec2 i_ ( const in vec4 Ca ) { vec2 hl ; vec2 fm = vec2 ( _1_0 / _255_0 , _1_0 ) ; hl . r = dot ( Ca . rg , fm ) ; hl . g = dot ( Ca . ba , fm ) ; return hl ; }".split(" ")}]}}]}]};
a["include/particles.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"PARTICLES_GLSLV",h:{a:"grp",d:[{a:"define",c:"PARTICLES_GLSLV",b:[""]},{a:"var",c:"EPSILON",b:["0.000001"]},{a:"var",c:"COLOR_RAMP_LENGTH",b:["0"]},{a:"var",c:"WORLD_SPACE",b:["0"]},{a:"var",c:"USE_COLOR_RAMP",b:["0"]},{a:"include",o:"math.glslv"},{a:"txt",b:"struct cD { float cM ; vec3 O ; float L ; vec3 aK ; float bl ; vec3 cS ; vec3 cT ; float cU ; } ;".split(" ")},{a:"cond",d:[{a:"if",e:["COLOR_RAMP_LENGTH",0,{a:"g_expr",i:2}],
h:{a:"grp",d:[{a:"txt",b:"void Ce ( inout vec3 aK , float Cb , vec4 jV , vec4 jW ) { float Cc = jW . x - jV . x ; float Cd = ( Cb - jV . x ) / Cc ; aK = mix ( aK , jW . yzw , clamp ( Cd , 0.0 , 1.0 ) ) ; }".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["COLOR_RAMP_LENGTH",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 Ch ( float t , float Cf , vec4 Cg [ COLOR_RAMP_LENGTH ] ) { float Cb = t / Cf ; vec3 aK = Cg [ 0 ] . yzw ;".split(" ")},{a:"cond",d:[{a:"if",e:["COLOR_RAMP_LENGTH",1,{a:"g_expr",i:2}],
h:{a:"grp",d:[{a:"txt",b:"Ce ( aK , Cb , Cg [ 0 ] , Cg [ 1 ] ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["COLOR_RAMP_LENGTH",2,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"Ce ( aK , Cb , Cg [ 1 ] , Cg [ 2 ] ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["COLOR_RAMP_LENGTH",3,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"Ce ( aK , Cb , Cg [ 2 ] , Cg [ 3 ] ) ;".split(" ")}]}}]},{a:"txt",b:["return","aK",";","}"]}]}}]},{a:"txt",b:"float Cn ( float t , float Cf , float Ci , float Cj ) { float Ck = max ( 0.01 , min ( Cf , Ci ) ) ; float Cl = max ( 0.01 , min ( Cf , Cj ) ) ; float Cm = Cf - Cl ; float L = clamp ( t / Ck , 0.0 , 1.0 ) - step ( Cm , t ) * ( t - Cm ) / Cl ; return L ; } cD cE ( ) { cD sp ; float t ; float Cf = a_p_data [ 0 ] ; float Co = a_p_data [ 1 ] ; if ( u_p_cyclic == 1 ) { t = mod ( u_p_time , u_p_length ) - Co ; if ( t < 0.0 ) t += u_p_length ; } if ( u_p_cyclic != 1 ) { t = u_p_time - Co ; } if ( t < 0.0 || t >= Cf ) { sp . cM = 0.0001 ; sp . O = vec3 ( 99999.0 , 0.0 , 0.0 ) ; } if ( ! ( t < 0.0 || t >= Cf ) ) { vec3 by = P ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")},
{a:"cond",d:[{a:"if",e:["WORLD_SPACE"],h:{a:"grp",d:[{a:"txt",b:"vec3 fj = a_position ; vec3 zG = by ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 fj = ae ( u_model_tsr , a_position ) ; vec3 zG = U ( u_model_tsr , by ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 Cp = u_p_nfactor * zG ; Cp += a_p_vels . xyz ; Cp . z -= u_p_gravity * t / 2.0 ; float Cq = max ( u_p_mass , EPSILON ) ; Cp += ( u_p_wind_fac * u_wind / Cq ) * t / 2.0 ; sp . cU = t ; sp . cS = Cp ; sp . cT = by * a_p_vels . w ; sp . O = fj + Cp * t ; sp . bl = a_p_vels . w * t ;".split(" ")},
{a:"cond",d:[{a:"if",e:["USE_COLOR_RAMP"],h:{a:"grp",d:[{a:"txt",b:"sp . cM = GLSL_TEXTURE ( u_color_ramp_tex , vec2 ( t / u_p_max_lifetime , 0.5 ) ) . g ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"sp . cM = 1.0 ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["COLOR_RAMP_LENGTH",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"sp . aK = Ch ( t , u_p_max_lifetime , u_p_color_ramp ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"sp . aK = vec3 ( 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:"sp . L = Cn ( t , a_p_data [ 0 ] , u_p_fade_in , u_p_fade_out ) ; } return sp ; }".split(" ")}]}}]}]};
a["include/particles_nodes.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"PARTICLES_NODES_GLSLF",h:{a:"grp",d:[{a:"define",c:"PARTICLES_NODES_GLSLF",b:[""]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"DOUBLE_SIDED_LIGHTING",b:["0"]},{a:"var",c:"INVERT_FRONTFACING",b:["0"]},{a:"var",c:"PARTICLE_BATCH",b:["0"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"cond",d:[{a:"if",e:["USE_NODE_MATERIAL_BEGIN"],h:{a:"grp",d:[{a:"include",o:"environment.glslf"}]}}]},{a:"include",o:"color_util.glslf"},
{a:"include",o:"math.glslv"},{a:"cond",d:[{a:"if",e:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_SEPHSV",{a:"logical_or_expr",i:6}],h:{a:"grp",d:[{a:"txt",b:"vec3 ka ( vec3 rgb ) { vec4 j_ = vec4 ( _0_0 , - _1_0 / 3.0 , 2.0 / 3.0 , - _1_0 ) ; vec4 p = mix ( vec4 ( rgb . bg , j_ . wz ) , vec4 ( rgb . gb , j_ . xy ) , step ( rgb . b , rgb . g ) ) ; vec4 q = mix ( vec4 ( p . xyw , rgb . r ) , vec4 ( rgb . r , p . yzx ) , step ( p . x , rgb . r ) ) ; float dg = q . x - min ( q . w , q . y ) ; float iu = 1.0e-10 ; return vec3 ( abs ( q . z + ( q . w - q . y ) / ( 6.0 * dg + iu ) ) , dg / ( q . x + iu ) , q . x ) ; }".split(" ")}]}}]},
{a:"cond",d:[{a:"if",e:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_COMBHSV",{a:"logical_or_expr",i:6}],h:{a:"grp",d:[{a:"txt",b:"vec3 kc ( vec3 kb ) { vec4 j_ = vec4 ( _1_0 , 2.0 / 3.0 , _1_0 / 3.0 , 3.0 ) ; vec3 p = abs ( fract ( vec3 ( kb . r , kb . r , kb . r ) + j_ . xyz ) * 6.0 - j_ . www ) ; return kb . b * mix ( j_ . xxx , clamp ( p - j_ . xxx , _0_0 , _1_0 ) , kb . g ) ; }".split(" ")}]}}]},{a:"cond",
d:[{a:"if",e:["USE_NODE_GEOMETRY_UV","USE_NODE_B4W_PARALLAX","USE_NODE_UV_MERGED",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"vec3 qw ( vec2 gP ) { return vec3 ( gP * 2.0 - vec2 ( _1_0 , _1_0 ) , _0_0 ) ; }".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["USE_NODE_TEXTURE_COLOR","USE_NODE_TEXTURE_NORMAL","USE_NODE_B4W_PARALLAX",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"vec2 qx ( vec3 hl ) { return vec2 ( hl . xy * _0_5 + vec2 ( _0_5 , _0_5 ) ) ; }".split(" ")}]}}]},{a:"node",c:"CAMERA",
m:[],l:[{a:"node_out",c:"qQ",g:["vec3"],f:!0},{a:"node_out",c:"qR",g:["float"],f:!0},{a:"node_out",c:"qS",g:["float"],f:!0}],j:[{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_qQ"],j:[{a:"txt",b:"qQ = normalize ( qN . xyz ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_qR"],j:[{a:"txt",b:"qR = abs ( qN . z ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_qS"],j:[{a:"txt",b:"qS = length ( qN . xyz ) ;".split(" ")}]}]}]},{a:"node",c:"COMBRGB",m:[],l:[{a:"node_in",c:"qT",g:["float"],
f:!1},{a:"node_in",c:"qU",g:["float"],f:!1},{a:"node_in",c:"qV",g:["float"],f:!1},{a:"node_out",c:"qW",g:["vec3"],f:!1}],j:[{a:"txt",b:"qW = vec3 ( qT , qU , qV ) ;".split(" ")}]},{a:"node",c:"COMBHSV",m:[],l:[{a:"node_in",c:"qX",g:["float"],f:!1},{a:"node_in",c:"qY",g:["float"],f:!1},{a:"node_in",c:"qZ",g:["float"],f:!1},{a:"node_out",c:"q_",g:["vec3"],f:!1}],j:[{a:"txt",b:"q_ = kc ( vec3 ( qX , qY , qZ ) ) ;".split(" ")}]},{a:"node",c:"EMPTY_UV",m:[],l:[{a:"node_out",c:"rc",g:["vec3"],f:!1}],j:[{a:"txt",
b:"rc = vec3 ( - _1_0 , - _1_0 , _0_0 ) ;".split(" ")}]},{a:"node",c:"EMPTY_VC",m:[],l:[{a:"node_out",c:"rd",g:["vec3"],f:!1}],j:[{a:"txt",b:"rd = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_UV",m:[],l:[{a:"node_out",c:"re",g:["vec3"],f:!1}],j:[{a:"txt",b:"re = qw ( n ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_OR",m:[],l:[{a:"node_out",c:"rf",g:["vec3"],f:!1}],j:[{a:"txt",b:"rf = 2.0 * vec3 ( n , _0_0 ) - vec3 ( _1_0 ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC",m:[],l:[{a:"node_out",c:"rh",
g:["vec3"],f:!1}],j:[{a:"txt",b:"rh = vec3 ( _1_0 ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC1",m:[],l:[{a:"node_out",c:"ri",g:["float"],f:!1}],j:[{a:"txt",b:["ri","=","_1_0",";"]}]},{a:"node",c:"GEOMETRY_VC2",m:[],l:[{a:"node_out",c:"rj",g:["float"],f:!1},{a:"node_out",c:"rk",g:["float"],f:!1}],j:[{a:"txt",b:"rj = _1_0 ; rk = _1_0 ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC3",m:[],l:[{a:"node_out",c:"rl",g:["float"],f:!1},{a:"node_out",c:"rm",g:["float"],f:!1},{a:"node_out",c:"rn",g:["float"],f:!1}],
j:[{a:"txt",b:"rl = _1_0 ; rm = _1_0 ; rn = _1_0 ;".split(" ")}]},{a:"node",c:"GEOMETRY_NO",m:[],l:[{a:"node_out",c:"ro",g:["vec3"],f:!1}],j:[{a:"txt",b:"ro = qL . xyz ;".split(" ")}]},{a:"node",c:"GEOMETRY_FB",m:[],l:[{a:"node_out",c:"rp",g:["float"],f:!1}],j:[{a:"node_cond",d:[{a:"node_if",e:["INVERT_FRONTFACING"],j:[{a:"txt",b:"rp = ( gl_FrontFacing ) ? _0_0 : _1_0 ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"rp = ( gl_FrontFacing ) ? _1_0 : _0_0 ;".split(" ")}]}]}]},{a:"node",c:"GEOMETRY_VW",
m:[],l:[{a:"node_out",c:"rq",g:["vec3"],f:!1}],j:[{a:"txt",b:"rq = - U ( F , v ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_LO",m:[],l:[{a:"node_out",c:"rs",g:["vec3"],f:!1}],j:[{a:"txt",b:"rs [ 0 ] = qN [ 0 ] ; rs [ 1 ] = qN [ 1 ] ; rs [ 2 ] = qN [ 2 ] ;".split(" ")}]},{a:"node",c:"GEOMETRY_GL",m:[],l:[{a:"node_out",c:"rt",g:["vec3"],f:!1}],j:[{a:"txt",b:"rt = vec3 ( nA . r , - nA . b , nA . g ) ;".split(" ")}]},{a:"node",c:"NEW_GEOMETRY",m:[],l:[{a:"node_out",c:"ru",g:["vec3"],f:!1},{a:"node_out",c:"rv",
g:["vec3"],f:!1},{a:"node_out",c:"rw",g:["vec3"],f:!1},{a:"node_out",c:"rx",g:["vec3"],f:!1},{a:"node_out",c:"ry",g:["vec3"],f:!1},{a:"node_out",c:"rz",g:["vec3"],f:!1},{a:"node_out",c:"rA",g:["float"],f:!1},{a:"node_out",c:"rB",g:["float"],f:!1}],j:[{a:"txt",b:"ru = vec3 ( _0_0 ) ; rv = vec3 ( _0_0 ) ; rw = vec3 ( _0_0 ) ; rx = vec3 ( _0_0 ) ; ry = vec3 ( _0_0 ) ; rz = vec3 ( _0_0 ) ; rA = _0_0 ; rB = _0_0 ;".split(" ")}]},{a:"node",c:"HUE_SAT",m:[],l:[{a:"node_in",c:"rC",g:["float"],f:!1},{a:"node_in",
c:"rD",g:["float"],f:!1},{a:"node_in",c:"rE",g:["float"],f:!1},{a:"node_in",c:"rF",g:["float"],f:!1},{a:"node_in",c:"rG",g:["vec3"],f:!1},{a:"node_out",c:"rH",g:["vec3"],f:!1}],j:[{a:"txt",b:"vec3 kb = ka ( rG ) ; kb [ 0 ] += ( rC - _0_5 ) ; if ( kb [ 0 ] > _1_0 ) kb [ 0 ] -= _1_0 ; else if ( kb [ 0 ] < _0_0 ) kb [ 0 ] += _1_0 ; kb *= vec3 ( _1_0 , rD , rE ) ; kb = mix ( vec3 ( _1_0 ) , mix ( vec3 ( _0_0 ) , kb , step ( vec3 ( _0_0 ) , kb ) ) , step ( kb , vec3 ( _1_0 ) ) ) ; rH = mix ( rG , kc ( kb ) , rF ) ;".split(" ")}]},
{a:"node",c:"INVERT",m:[],l:[{a:"node_in",c:"rI",g:["float"],f:!1},{a:"node_in",c:"rJ",g:["vec3"],f:!1},{a:"node_out",c:"rK",g:["vec3"],f:!1}],j:[{a:"txt",b:"rK = mix ( rJ , vec3 ( _1_0 ) - rJ , rI ) ;".split(" ")}]},{a:"node",c:"LAMP",m:[],l:[{a:"node_out",c:"rL",g:["vec3"],f:!0},{a:"node_out",c:"rM",g:["vec3"],f:!1},{a:"node_out",c:"rN",g:["float"],f:!1},{a:"node_out",c:"rO",g:["float"],f:!0}],j:[{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_rL"],j:[{a:"txt",b:"rL = u_lamp_light_color_intensities [ LAMP_INDEX ] ;".split(" ")}]}]},
{a:"txt",b:"vec4 rP = u_lamp_light_factors [ LAMP_INDEX ] ; vec3 rQ = u_lamp_light_directions [ LAMP_INDEX ] ; vec3 rR = u_lamp_light_positions [ LAMP_INDEX ] ; float rS = rP . z ; if ( rS != - _1_0 ) { rM = c - rR ; rN = length ( rM ) ; rM = normalize ( rM ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_rO"],j:[{a:"txt",b:"rO = rS / ( rS + rN * rN ) ; float rT = rP . x ; float rU = rP . y ; if ( rT > - _1_0 ) { float od = dot ( - rM , rQ ) ; od *= smoothstep ( _0_0 , _1_0 , ( od - rT ) / rU ) ; rO *= od ; }".split(" ")}]}]},
{a:"txt",b:["}","else","{"]},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_rM"],j:[{a:"txt",b:["rM","=","rQ",";"]}]}]},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_rN"],j:[{a:"txt",b:"rN = length ( rR - c ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_rO"],j:[{a:"txt",b:["rO","=","_1_0",";"]}]}]},{a:"txt",b:["}"]}]},{a:"node",c:"NORMAL",m:[],l:[{a:"node_in",c:"rV",g:["vec3"],f:!1},{a:"node_out",c:"rW",g:["vec3"],f:!0},{a:"node_out",c:"rX",g:["float"],f:!0},{a:"node_param",c:"qD",g:["vec3"],
f:!1}],j:[{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_rW"],j:[{a:"txt",b:["rW","=","qD",";"]}]}]},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_rX"],j:[{a:"txt",b:"rX = - dot ( rV , qD ) ;".split(" ")}]}]}]},{a:"node",c:"B4W_VECTOR_VIEW",m:[],l:[{a:"node_in",c:"rY",g:["vec3"],f:!1},{a:"node_out",c:"rZ",g:["vec3"],f:!1}],j:[{a:"txt",b:"rZ = - U ( F , rY ) ;".split(" ")}]},{a:"node",c:"BSDF_ANISOTROPIC",m:[],l:[{a:"node_in",c:"r_",g:["vec3"],f:!1},{a:"node_in",c:"sa",g:["float"],f:!1},{a:"node_in",c:"sb",
g:["float"],f:!1},{a:"node_in",c:"sc",g:["float"],f:!1},{a:"node_in",c:"sd",g:["vec3"],f:!1},{a:"node_in",c:"se",g:["vec3"],f:!1},{a:"node_out",c:"sf",g:["vec3"],f:!1}],j:[{a:"txt",b:"sf = r_ ; sa ; sb ; sc ; sd ; se ;".split(" ")}]},{a:"node",c:"BSDF_DIFFUSE",m:[],l:[{a:"node_in",c:"sg",g:["vec3"],f:!1},{a:"node_in",c:"sh",g:["float"],f:!1},{a:"node_in",c:"si",g:["vec3"],f:!1},{a:"node_out",c:"sj",g:["vec3"],f:!1}],j:[{a:"txt",b:"sj = sg ; sh ; si ;".split(" ")}]},{a:"node",c:"BSDF_GLASS",m:[],l:[{a:"node_in",
c:"sk",g:["vec3"],f:!1},{a:"node_in",c:"sl",g:["float"],f:!1},{a:"node_in",c:"sm",g:["float"],f:!1},{a:"node_in",c:"sn",g:["vec3"],f:!1},{a:"node_out",c:"so",g:["vec3"],f:!1}],j:[{a:"txt",b:"so = sk ; sl ; sm ; sn ;".split(" ")}]},{a:"node",c:"BSDF_GLOSSY",m:[],l:[{a:"node_in",c:"sr",g:["vec3"],f:!1},{a:"node_in",c:"su",g:["float"],f:!1},{a:"node_in",c:"sv",g:["vec3"],f:!1},{a:"node_out",c:"sw",g:["vec3"],f:!1}],j:[{a:"txt",b:"sw = sr ; su ; sv ;".split(" ")}]},{a:"node",c:"BSDF_HAIR",m:[],l:[{a:"node_in",
c:"sx",g:["vec3"],f:!1},{a:"node_in",c:"sy",g:["float"],f:!1},{a:"node_in",c:"sz",g:["float"],f:!1},{a:"node_in",c:"sA",g:["float"],f:!1},{a:"node_out",c:"sB",g:["vec3"],f:!1}],j:[{a:"txt",b:"sB = sx ; sy ; sz ; sA ;".split(" ")}]},{a:"node",c:"BSDF_TRANSPARENT",m:[],l:[{a:"node_in",c:"sC",g:["vec3"],f:!1},{a:"node_out",c:"sD",g:["vec3"],f:!1}],j:[{a:"txt",b:["sD","=","sC",";"]}]},{a:"node",c:"BSDF_TRANSLUCENT",m:[],l:[{a:"node_in",c:"sE",g:["vec3"],f:!1},{a:"node_in",c:"sF",g:["vec3"],f:!1},{a:"node_out",
c:"sG",g:["vec3"],f:!1}],j:[{a:"txt",b:"sG = sE ; sF ;".split(" ")}]},{a:"node",c:"BSDF_REFRACTION",m:[],l:[{a:"node_in",c:"sH",g:["vec3"],f:!1},{a:"node_in",c:"sI",g:["float"],f:!1},{a:"node_in",c:"sJ",g:["float"],f:!1},{a:"node_in",c:"sK",g:["vec3"],f:!1},{a:"node_out",c:"sL",g:["vec3"],f:!1}],j:[{a:"txt",b:"sL [ 0 ] = sL [ 1 ] = sL [ 2 ] = _0_0 ; sH ; sI ; sJ ; sK ;".split(" ")}]},{a:"node",c:"BSDF_TOON",m:[],l:[{a:"node_in",c:"sM",g:["vec3"],f:!1},{a:"node_in",c:"sN",g:["float"],f:!1},{a:"node_in",
c:"sO",g:["float"],f:!1},{a:"node_in",c:"sP",g:["vec3"],f:!1},{a:"node_out",c:"sQ",g:["vec3"],f:!1}],j:[{a:"txt",b:"sQ = sM ; sN ; sO ; sP ;".split(" ")}]},{a:"node",c:"BSDF_VELVET",m:[],l:[{a:"node_in",c:"sR",g:["vec3"],f:!1},{a:"node_in",c:"sS",g:["float"],f:!1},{a:"node_in",c:"sT",g:["vec3"],f:!1},{a:"node_out",c:"sU",g:["vec3"],f:!1}],j:[{a:"txt",b:"sU = sR ; sS ; sT ;".split(" ")}]},{a:"node",c:"SUBSURFACE_SCATTERING",m:[],l:[{a:"node_in",c:"sV",g:["vec3"],f:!1},{a:"node_in",c:"sW",g:["float"],
f:!1},{a:"node_in",c:"sX",g:["vec3"],f:!1},{a:"node_in",c:"sY",g:["float"],f:!1},{a:"node_in",c:"sZ",g:["float"],f:!1},{a:"node_in",c:"s_",g:["vec3"],f:!1},{a:"node_out",c:"ta",g:["vec3"],f:!1}],j:[{a:"txt",b:"ta [ 0 ] = ta [ 1 ] = ta [ 2 ] = _0_0 ; sV ; sX ; sY ; sZ ; s_ ; sW ;".split(" ")}]},{a:"node",c:"EMISSION",m:[],l:[{a:"node_in",c:"tb",g:["vec3"],f:!1},{a:"node_in",c:"tc",g:["float"],f:!1},{a:"node_out",c:"td",g:["vec3"],f:!1}],j:[{a:"txt",b:"td = tb ; tc ;".split(" ")}]},{a:"node",c:"AMBIENT_OCCLUSION",
m:[],l:[{a:"node_in",c:"te",g:["vec3"],f:!1},{a:"node_out",c:"tf",g:["vec3"],f:!1}],j:[{a:"txt",b:"tf [ 0 ] = tf [ 1 ] = tf [ 2 ] = _0_0 ; te ;".split(" ")}]},{a:"node",c:"HOLDOUT",m:[],l:[{a:"node_out",c:"tg",g:["vec3"],f:!1}],j:[{a:"txt",b:"tg [ 0 ] = tg [ 1 ] = tg [ 2 ] = _0_0 ;".split(" ")}]},{a:"node",c:"VOLUME_ABSORPTION",m:[],l:[{a:"node_in",c:"th",g:["vec3"],f:!1},{a:"node_in",c:"ti",g:["float"],f:!1},{a:"node_out",c:"tj",g:["vec3"],f:!1}],j:[{a:"txt",b:"tj [ 0 ] = tj [ 1 ] = tj [ 2 ] = _0_0 ; th ; ti ;".split(" ")}]},
{a:"node",c:"VOLUME_SCATTER",m:[],l:[{a:"node_in",c:"tk",g:["vec3"],f:!1},{a:"node_in",c:"tl",g:["float"],f:!1},{a:"node_in",c:"tm",g:["float"],f:!1},{a:"node_out",c:"tn",g:["vec3"],f:!1}],j:[{a:"txt",b:"tn [ 0 ] = tn [ 1 ] = tn [ 2 ] = _0_0 ; tk ; tl ; tm ;".split(" ")}]},{a:"node",c:"BUMP",m:[],l:[{a:"node_in",c:"to",g:["float"],f:!1},{a:"node_in",c:"tr",g:["float"],f:!1},{a:"node_in",c:"tu",g:["float"],f:!1},{a:"node_in",c:"tv",g:["vec3"],f:!1},{a:"node_out",c:"tw",g:["vec3"],f:!1}],j:[{a:"txt",
b:"tw = tv ; to ; tr ; tu ;".split(" ")}]},{a:"node",c:"NORMAL_MAP",m:[{a:"node_var",c:"SPACE",b:["NM_TANGENT"]}],l:[{a:"node_in",c:"tx",g:["float"],f:!1},{a:"node_in",c:"ty",g:["vec3"],f:!1},{a:"node_out",c:"tz",g:["vec3"],f:!1}],j:[{a:"txt",b:["vec3","tA","=","nB",";"]},{a:"node_cond",d:[{a:"node_if",e:["SPACE","NM_TANGENT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"tz = qM * ( ty . xyz - _0_5 ) ;".split(" ")}]},{a:"node_elif",e:["SPACE","NM_OBJECT",{a:"equal_expr",i:2},"SPACE","NM_BLENDER_OBJECT",{a:"equal_expr",
i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"tz = ty . xyz - _0_5 ; tz . yz *= - 1.0 ; tz = U ( H , tz ) ;".split(" ")}]},{a:"node_elif",e:["SPACE","NM_WORLD",{a:"equal_expr",i:2},"SPACE","NM_BLENDER_WORLD",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"tz = ty . xyz - _0_5 ; tz . yz *= - 1.0 ;".split(" ")}]}]},{a:"txt",b:"tz = normalize ( mix ( tA , tz , tx ) ) ;".split(" ")}]},{a:"node",c:"VECT_TRANSFORM",m:[{a:"node_var",c:"CONVERT_TYPE",b:["VT_WORLD_TO_OBJECT"]},{a:"node_var",
c:"VECTOR_TYPE",b:["VT_VECTOR"]}],l:[{a:"node_in",c:"tB",g:["vec3"],f:!1},{a:"node_out",c:"tC",g:["vec3"],f:!1}],j:[{a:"node_cond",d:[{a:"node_if",e:["CONVERT_TYPE","VT_WORLD_TO_WORLD",{a:"equal_expr",i:2},"CONVERT_TYPE","VT_OBJECT_TO_OBJECT",{a:"equal_expr",i:2},"CONVERT_TYPE","VT_CAMERA_TO_CAMERA",{a:"equal_expr",i:2},{a:"logical_or_expr",i:3}],j:[{a:"txt",b:["tC","=","tB",";"]}]},{a:"node_else",j:[{a:"node_cond",d:[{a:"node_if",e:["VECTOR_TYPE","VT_POINT",{a:"equal_expr",i:2}],j:[{a:"node_cond",
d:[{a:"node_if",e:["CONVERT_TYPE","VT_WORLD_TO_CAMERA",{a:"equal_expr",i:2}],j:[{a:"txt",b:"tC = ae ( F , tB ) ;".split(" ")}]},{a:"node_elif",e:["CONVERT_TYPE","VT_WORLD_TO_OBJECT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"tC = ae ( I , tB ) ;".split(" ")}]},{a:"node_elif",e:["CONVERT_TYPE","VT_OBJECT_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"tC = ae ( H , tB ) ;".split(" ")}]},{a:"node_elif",e:["CONVERT_TYPE","VT_OBJECT_TO_CAMERA",{a:"equal_expr",i:2}],j:[{a:"txt",b:"tC = ae ( H , tB ) ; tC = ae ( F , tC ) ;".split(" ")}]},
{a:"node_elif",e:["CONVERT_TYPE","VT_CAMERA_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"tC = ae ( G , tB ) ;".split(" ")}]},{a:"node_elif",e:["CONVERT_TYPE","VT_CAMERA_TO_OBJECT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"tC = ae ( G , tB ) ; tC = ae ( I , tC ) ;".split(" ")}]}]}]},{a:"node_else",j:[{a:"node_cond",d:[{a:"node_if",e:["CONVERT_TYPE","VT_WORLD_TO_CAMERA",{a:"equal_expr",i:2}],j:[{a:"txt",b:"tC = U ( F , tB ) ;".split(" ")}]},{a:"node_elif",e:["CONVERT_TYPE","VT_WORLD_TO_OBJECT",{a:"equal_expr",
i:2}],j:[{a:"txt",b:"tC = U ( I , tB ) ;".split(" ")}]},{a:"node_elif",e:["CONVERT_TYPE","VT_OBJECT_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"tC = U ( H , tB ) ;".split(" ")}]},{a:"node_elif",e:["CONVERT_TYPE","VT_OBJECT_TO_CAMERA",{a:"equal_expr",i:2}],j:[{a:"txt",b:"tC = U ( H , tB ) ; tC = U ( F , tC ) ;".split(" ")}]},{a:"node_elif",e:["CONVERT_TYPE","VT_CAMERA_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"tC = U ( G , tB ) ;".split(" ")}]},{a:"node_elif",e:["CONVERT_TYPE","VT_CAMERA_TO_OBJECT",
{a:"equal_expr",i:2}],j:[{a:"txt",b:"tC = U ( G , tB ) ; tC = U ( I , tC ) ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",e:["VECTOR_TYPE","VT_NORMAL",{a:"equal_expr",i:2}],j:[{a:"txt",b:"tC = normalize ( tC ) ;".split(" ")}]}]}]}]}]},{a:"node",c:"BLACKBODY",m:[],l:[{a:"node_in",c:"tD",g:["float"],f:!1},{a:"node_out",c:"tE",g:["vec3"],f:!1}],j:[{a:"txt",b:"tE [ 0 ] = tE [ 1 ] = tE [ 2 ] = _0_0 ; tD ;".split(" ")}]},{a:"node",c:"WAVELENGTH",m:[],l:[{a:"node_in",c:"tF",g:["float"],f:!1},{a:"node_out",
c:"tG",g:["vec3"],f:!1}],j:[{a:"txt",b:"tG [ 0 ] = tG [ 1 ] = tG [ 2 ] = _0_0 ; tF ;".split(" ")}]},{a:"node",c:"SEPXYZ",m:[],l:[{a:"node_in",c:"tH",g:["vec3"],f:!1},{a:"node_out",c:"tI",g:["float"],f:!1},{a:"node_out",c:"tJ",g:["float"],f:!1},{a:"node_out",c:"tK",g:["float"],f:!1}],j:[{a:"txt",b:"tI = tH [ 0 ] ; tJ = tH [ 1 ] ; tK = tH [ 2 ] ;".split(" ")}]},{a:"node",c:"COMBXYZ",m:[],l:[{a:"node_in",c:"tL",g:["float"],f:!1},{a:"node_in",c:"tM",g:["float"],f:!1},{a:"node_in",c:"tN",g:["float"],f:!1},
{a:"node_out",c:"tO",g:["vec3"],f:!1}],j:[{a:"txt",b:"tO [ 0 ] = tL ; tO [ 1 ] = tM ; tO [ 2 ] = tN ;".split(" ")}]},{a:"node",c:"BRIGHTCONTRAST",m:[],l:[{a:"node_in",c:"tP",g:["vec3"],f:!1},{a:"node_in",c:"tQ",g:["float"],f:!1},{a:"node_in",c:"tR",g:["float"],f:!1},{a:"node_out",c:"tS",g:["vec3"],f:!1}],j:[{a:"txt",b:"float b = tQ - tR * _0_5 ; tS = max ( ( _1_0 + tR ) * tP + b , vec3 ( _0_0 ) ) ;".split(" ")}]},{a:"node",c:"LIGHT_FALLOFF",m:[],l:[{a:"node_in",c:"tT",g:["float"],f:!1},{a:"node_in",
c:"tU",g:["float"],f:!1},{a:"node_out",c:"tV",g:["float"],f:!1},{a:"node_out",c:"tW",g:["float"],f:!1},{a:"node_out",c:"tX",g:["float"],f:!1}],j:[{a:"txt",b:"tV = tW = tX = _0_0 ; tT ; tU ;".split(" ")}]},{a:"node",c:"TEX_IMAGE",m:[],l:[{a:"node_in",c:"tY",g:["vec3"],f:!1},{a:"node_out",c:"tZ",g:["vec3"],f:!1},{a:"node_out",c:"t_",g:["float"],f:!1}],j:[{a:"txt",b:"tZ [ 0 ] = tZ [ 1 ] = tZ [ 2 ] = _0_0 ; t_ = _1_0 ; tY ;".split(" ")}]},{a:"node",c:"TEX_ENVIRONMENT",m:[],l:[{a:"node_in",c:"ua",g:["vec3"],
f:!1},{a:"node_out",c:"ub",g:["vec3"],f:!1}],j:[{a:"txt",b:"ub [ 0 ] = ub [ 1 ] = ub [ 2 ] = _0_0 ; ua ;".split(" ")}]},{a:"node",c:"TEX_SKY",m:[],l:[{a:"node_in",c:"uc",g:["vec3"],f:!1},{a:"node_out",c:"ud",g:["vec3"],f:!1}],j:[{a:"txt",b:"ud [ 0 ] = ud [ 1 ] = ud [ 2 ] = _0_0 ; uc ;".split(" ")}]},{a:"node",c:"TEX_NOISE",m:[],l:[{a:"node_in",c:"ue",g:["vec3"],f:!1},{a:"node_in",c:"uf",g:["float"],f:!1},{a:"node_in",c:"ug",g:["float"],f:!1},{a:"node_in",c:"uh",g:["float"],f:!1},{a:"node_out",c:"ui",
g:["vec3"],f:!1},{a:"node_out",c:"uj",g:["float"],f:!1}],j:[{a:"txt",b:"ui [ 0 ] = ui [ 1 ] = ui [ 2 ] = _0_0 ; uj = _1_0 ; ue ; uf ; ug ; uh ;".split(" ")}]},{a:"node",c:"TEX_WAVE",m:[],l:[{a:"node_in",c:"uk",g:["vec3"],f:!1},{a:"node_in",c:"ul",g:["float"],f:!1},{a:"node_in",c:"um",g:["float"],f:!1},{a:"node_in",c:"un",g:["float"],f:!1},{a:"node_in",c:"uo",g:["float"],f:!1},{a:"node_out",c:"up",g:["vec3"],f:!1},{a:"node_out",c:"uq",g:["float"],f:!1}],j:[{a:"txt",b:"up [ 0 ] = up [ 1 ] = up [ 2 ] = _0_0 ; uq = _1_0 ; uk ; ul ; um ; un ; uo ;".split(" ")}]},
{a:"node",c:"TEX_VORONOI",m:[],l:[{a:"node_in",c:"ur",g:["vec3"],f:!1},{a:"node_in",c:"us",g:["float"],f:!1},{a:"node_out",c:"ut",g:["vec3"],f:!1},{a:"node_out",c:"uu",g:["float"],f:!1}],j:[{a:"txt",b:"ut [ 0 ] = ut [ 1 ] = ut [ 2 ] = _0_0 ; uu = _1_0 ; ur ; us ;".split(" ")}]},{a:"node",c:"TEX_MUSGRAVE",m:[],l:[{a:"node_in",c:"uv",g:["vec3"],f:!1},{a:"node_in",c:"uw",g:["float"],f:!1},{a:"node_in",c:"ux",g:["float"],f:!1},{a:"node_in",c:"uy",g:["float"],f:!1},{a:"node_in",c:"uz",g:["float"],f:!1},
{a:"node_in",c:"uA",g:["float"],f:!1},{a:"node_in",c:"uB",g:["float"],f:!1},{a:"node_out",c:"uC",g:["vec3"],f:!1},{a:"node_out",c:"uD",g:["float"],f:!1}],j:[{a:"txt",b:"uC [ 0 ] = uC [ 1 ] = uC [ 2 ] = _0_0 ; uD = _1_0 ; uv ; uw ; ux ; uy ; uz ; uA ; uB ;".split(" ")}]},{a:"node",c:"TEX_GRADIENT",m:[],l:[{a:"node_in",c:"uE",g:["vec3"],f:!1},{a:"node_out",c:"uF",g:["vec3"],f:!1},{a:"node_out",c:"uG",g:["float"],f:!1}],j:[{a:"txt",b:"uF [ 0 ] = uF [ 1 ] = uF [ 2 ] = _0_0 ; uG = _1_0 ; uE ;".split(" ")}]},
{a:"node",c:"TEX_MAGIC",m:[],l:[{a:"node_in",c:"uH",g:["vec3"],f:!1},{a:"node_in",c:"uI",g:["float"],f:!1},{a:"node_in",c:"uJ",g:["float"],f:!1},{a:"node_out",c:"uK",g:["vec3"],f:!1},{a:"node_out",c:"uL",g:["float"],f:!1}],j:[{a:"txt",b:"uK [ 0 ] = uK [ 1 ] = uK [ 2 ] = _0_0 ; uL = _1_0 ; uH ; uI ; uJ ;".split(" ")}]},{a:"node",c:"TEX_CHECKER",m:[],l:[{a:"node_in",c:"uM",g:["vec3"],f:!1},{a:"node_in",c:"uN",g:["vec3"],f:!1},{a:"node_in",c:"uO",g:["vec3"],f:!1},{a:"node_in",c:"uP",g:["float"],f:!1},
{a:"node_out",c:"uQ",g:["vec3"],f:!1},{a:"node_out",c:"uR",g:["float"],f:!1}],j:[{a:"txt",b:"uQ [ 0 ] = uQ [ 1 ] = uQ [ 2 ] = _0_0 ; uR = _1_0 ; uM ; uN ; uO ; uP ;".split(" ")}]},{a:"node",c:"TEX_BRICK",m:[],l:[{a:"node_in",c:"uS",g:["vec3"],f:!1},{a:"node_in",c:"uT",g:["vec3"],f:!1},{a:"node_in",c:"uU",g:["vec3"],f:!1},{a:"node_in",c:"uV",g:["vec3"],f:!1},{a:"node_in",c:"uW",g:["float"],f:!1},{a:"node_in",c:"uX",g:["float"],f:!1},{a:"node_in",c:"uY",g:["float"],f:!1},{a:"node_in",c:"uZ",g:["float"],
f:!1},{a:"node_in",c:"u_",g:["float"],f:!1},{a:"node_out",c:"va",g:["vec3"],f:!1},{a:"node_out",c:"vb",g:["float"],f:!1}],j:[{a:"txt",b:"va [ 0 ] = va [ 1 ] = va [ 2 ] = _0_0 ; vb = _1_0 ; uS ; uT ; uU ; uV ; uW ; uX ; uY ; uZ ; u_ ;".split(" ")}]},{a:"node",c:"ADD_SHADER",m:[],l:[{a:"node_in",c:"vc",g:["vec3"],f:!1},{a:"node_in",c:"vd",g:["vec3"],f:!1},{a:"node_out",c:"ve",g:["vec3"],f:!1}],j:[{a:"txt",b:"ve = clamp ( vc + vd , vec3 ( _0_0 ) , vec3 ( _1_0 ) ) ;".split(" ")}]},{a:"node",c:"MIX_SHADER",
m:[],l:[{a:"node_in",c:"vf",g:["float"],f:!1},{a:"node_in",c:"vg",g:["vec3"],f:!1},{a:"node_in",c:"vh",g:["vec3"],f:!1},{a:"node_out",c:"vi",g:["vec3"],f:!1}],j:[{a:"txt",b:"float vj = clamp ( vf , _0_0 , _1_0 ) ; vi = vj * vg + ( _1_0 - vj ) * vh ;".split(" ")}]},{a:"node",c:"UV_MERGED",m:[],l:[{a:"node_out",c:"vk",g:["vec3"],f:!1},{a:"node_out",c:"vl",g:["vec3"],f:!1}],j:[{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_vk"],j:[{a:"txt",b:"vk = qw ( n ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",
e:["USE_OUT_vl"],j:[{a:"txt",b:"vl = vec3 ( n , _0_0 ) ;".split(" ")}]}]}]},{a:"node",c:"TEX_COORD_UV",m:[],l:[{a:"node_out",c:"vm",g:["vec3"],f:!1}],j:[{a:"txt",b:"vm = vec3 ( n , _0_0 ) ;".split(" ")}]},{a:"node",c:"TEX_COORD_NO",m:[],l:[{a:"node_out",c:"vn",g:["vec3"],f:!1}],j:[{a:"txt",b:["vn","=","nB",";"]}]},{a:"node",c:"TEX_COORD_GE",m:[],l:[{a:"node_out",c:"vo",g:["vec3"],f:!1}],j:[{a:"txt",b:"vo = vec3 ( n , _0_0 ) ;".split(" ")}]},{a:"node",c:"TEX_COORD_OB",m:[],l:[{a:"node_out",c:"vp",
g:["vec3"],f:!1}],j:[{a:"txt",b:"vp [ 0 ] = vp [ 1 ] = vp [ 2 ] = _1_0 ;".split(" ")}]},{a:"node",c:"TEX_COORD_CA",m:[],l:[{a:"node_out",c:"vq",g:["vec3"],f:!1}],j:[{a:"txt",b:"vq [ 0 ] = qN [ 0 ] ; vq [ 1 ] = qN [ 1 ] ; vq [ 2 ] = _1_0 ;".split(" ")}]},{a:"node",c:"TEX_COORD_WI",m:[],l:[{a:"node_out",c:"vr",g:["vec3"],f:!1}],j:[{a:"txt",b:"vr [ 0 ] = vr [ 1 ] = vr [ 2 ] = _1_0 ;".split(" ")}]},{a:"node",c:"TEX_COORD_RE",m:[],l:[{a:"node_out",c:"vs",g:["vec3"],f:!1}],j:[{a:"txt",b:"vs [ 0 ] = vs [ 1 ] = vs [ 2 ] = _1_0 ;".split(" ")}]},
{a:"node",c:"UVMAP",m:[],l:[{a:"node_out",c:"vt",g:["vec3"],f:!1}],j:[{a:"txt",b:"vt = vec3 ( n , _0_0 ) ;".split(" ")}]},{a:"node",c:"PARTICLE_INFO",m:[],l:[{a:"node_out",c:"vu",g:["float"],f:!1},{a:"node_out",c:"vv",g:["float"],f:!1},{a:"node_out",c:"vw",g:["float"],f:!1},{a:"node_out",c:"vx",g:["vec3"],f:!1},{a:"node_out",c:"vy",g:["float"],f:!1},{a:"node_out",c:"vz",g:["vec3"],f:!1},{a:"node_out",c:"vA",g:["vec3"],f:!1},{a:"node_param",c:"Cr",g:["GLSL_IN","vec4"],f:!0},{a:"node_param",c:"Cs",
g:["GLSL_IN","vec3"],f:!0},{a:"node_param",c:"Ct",g:["GLSL_IN","vec3"],f:!0},{a:"node_param",c:"Cu",g:["GLSL_IN","vec3"],f:!0}],j:[{a:"node_cond",d:[{a:"node_if",e:["PARTICLE_BATCH"],j:[{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_vu"],j:[{a:"txt",b:"vu = Cr [ 0 ] ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_vv"],j:[{a:"txt",b:"vv = Cr [ 1 ] ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_vw"],j:[{a:"txt",b:"vw = Cr [ 2 ] ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",
e:["USE_OUT_vx"],j:[{a:"txt",b:"vx = vec3 ( Cs . r , - Cs . b , Cs . g ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_vy"],j:[{a:"txt",b:"vy = Cr [ 3 ] ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_vz"],j:[{a:"txt",b:"vz = vec3 ( Ct . r , - Ct . b , Ct . g ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_vA"],j:[{a:"txt",b:"vA = vec3 ( Cu . r , - Cu . b , Cu . g ) ;".split(" ")}]}]}]},{a:"node_else",j:[{a:"txt",b:"vu = _0_0 ; vv = _0_0 ; vw = _0_0 ; vx = vec3 ( _0_0 ) ; vy = _0_0 ; vz = vx ; vA = vx ;".split(" ")}]}]}]},
{a:"node",c:"HAIR_INFO",m:[],l:[{a:"node_out",c:"vB",g:["float"],f:!1},{a:"node_out",c:"vC",g:["float"],f:!1},{a:"node_out",c:"vD",g:["float"],f:!1},{a:"node_out",c:"vE",g:["vec3"],f:!1}],j:[{a:"txt",b:"vB = _0_0 ; vC = _0_0 ; vD = _0_0 ; vE = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"OBJECT_INFO",m:[],l:[{a:"node_out",c:"vF",g:["vec3"],f:!1},{a:"node_out",c:"vG",g:["float"],f:!1},{a:"node_out",c:"vH",g:["float"],f:!1},{a:"node_out",c:"vI",g:["float"],f:!1}],j:[{a:"txt",b:"vG = _0_0 ; vH = _0_0 ; vI = _0_0 ; vF = vec3 ( _0_0 ) ;".split(" ")}]},
{a:"node",c:"WIREFRAME",m:[],l:[{a:"node_in",c:"vJ",g:["float"],f:!1},{a:"node_out",c:"vK",g:["float"],f:!1}],j:[{a:"txt",b:["vK","=","vJ",";"]}]},{a:"node",c:"TANGENT",m:[],l:[{a:"node_out",c:"vL",g:["vec3"],f:!1}],j:[{a:"txt",b:"vL = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"LAYER_WEIGHT",m:[],l:[{a:"node_in",c:"vM",g:["float"],f:!1},{a:"node_in",c:"vN",g:["vec3"],f:!1},{a:"node_out",c:"vO",g:["float"],f:!1},{a:"node_out",c:"vP",g:["float"],f:!1}],j:[{a:"txt",b:"vO = vP = _0_0 ; vN ; vM ;".split(" ")}]},
{a:"node",c:"LIGHT_PATH",m:[],l:[{a:"node_out",c:"vQ",g:["float"],f:!1},{a:"node_out",c:"vR",g:["float"],f:!1},{a:"node_out",c:"vS",g:["float"],f:!1},{a:"node_out",c:"vT",g:["float"],f:!1},{a:"node_out",c:"vU",g:["float"],f:!1},{a:"node_out",c:"vV",g:["float"],f:!1},{a:"node_out",c:"vW",g:["float"],f:!1},{a:"node_out",c:"vX",g:["float"],f:!1},{a:"node_out",c:"vY",g:["float"],f:!1},{a:"node_out",c:"vZ",g:["float"],f:!1}],j:[{a:"txt",b:"vQ = vR = vS = _0_0 ; vT = vU = vV = _0_0 ; vW = vW = vY = vZ = _0_0 ; vX = _0_0 ;".split(" ")}]},
{a:"node",c:"ATTRIBUTE",m:[],l:[{a:"node_out",c:"v_",g:["vec3"],f:!1},{a:"node_out",c:"wa",g:["vec3"],f:!1},{a:"node_out",c:"wb",g:["float"],f:!1}],j:[{a:"txt",b:"v_ = wa = vec3 ( _0_0 ) ; wb = _0_0 ;".split(" ")}]},{a:"node",c:"SCRIPT",m:[],l:[],j:[]},{a:"node",c:"CURVE_VEC",m:[{a:"node_var",c:"READ_R",b:["0"]},{a:"node_var",c:"READ_G",b:["0"]},{a:"node_var",c:"READ_B",b:["0"]},{a:"node_var",c:"NODE_TEX_ROW",b:["0.0"]}],l:[{a:"node_in",c:"wc",g:["float"],f:!1},{a:"node_in",c:"wd",g:["vec3"],f:!1},
{a:"node_out",c:"we",g:["vec3"],f:!1}],j:[{a:"txt",b:["we","=","wd",";"]},{a:"node_cond",d:[{a:"node_if",e:["READ_R"],j:[{a:"txt",b:"we . r = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( 0.5 * wd . r + 0.5 , NODE_TEX_ROW ) ) . r - 0.5 ) * 2.0 ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",e:["READ_G"],j:[{a:"txt",b:"we . g = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( 0.5 * wd . g + 0.5 , NODE_TEX_ROW ) ) . g - 0.5 ) * 2.0 ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",e:["READ_B"],j:[{a:"txt",b:"we . b = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( 0.5 * wd . b + 0.5 , NODE_TEX_ROW ) ) . b - 0.5 ) * 2.0 ;".split(" ")}]}]},
{a:"txt",b:"we = mix ( wd , we , wc ) ;".split(" ")}]},{a:"node",c:"CURVE_RGB",m:[{a:"node_var",c:"READ_A",b:["0"]},{a:"node_var",c:"READ_R",b:["0"]},{a:"node_var",c:"READ_G",b:["0"]},{a:"node_var",c:"READ_B",b:["0"]},{a:"node_var",c:"NODE_TEX_ROW",b:["0.0"]}],l:[{a:"node_in",c:"wf",g:["float"],f:!1},{a:"node_in",c:"wg",g:["vec3"],f:!1},{a:"node_out",c:"wh",g:["vec3"],f:!1}],j:[{a:"node_cond",d:[{a:"node_if",e:["READ_A"],j:[{a:"txt",b:"float r = GLSL_TEXTURE ( u_nodes_texture , vec2 ( wg . r , NODE_TEX_ROW ) ) . a ; float g = GLSL_TEXTURE ( u_nodes_texture , vec2 ( wg . g , NODE_TEX_ROW ) ) . a ; float b = GLSL_TEXTURE ( u_nodes_texture , vec2 ( wg . b , NODE_TEX_ROW ) ) . a ;".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"float r = wg . r ; float g = wg . g ; float b = wg . b ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",e:["READ_R"],j:[{a:"txt",b:"wh . r = GLSL_TEXTURE ( u_nodes_texture , vec2 ( r , NODE_TEX_ROW ) ) . r ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"wh . r = r ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",e:["READ_G"],j:[{a:"txt",b:"wh . g = GLSL_TEXTURE ( u_nodes_texture , vec2 ( g , NODE_TEX_ROW ) ) . g ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"wh . g = g ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",e:["READ_B"],j:[{a:"txt",b:"wh . b = GLSL_TEXTURE ( u_nodes_texture , vec2 ( b , NODE_TEX_ROW ) ) . b ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"wh . b = b ;".split(" ")}]}]},{a:"txt",b:"wh = mix ( wg , wh , wf ) ;".split(" ")}]},{a:"node",c:"VALTORGB",m:[{a:"node_var",c:"NODE_TEX_ROW",b:["0.0"]}],l:[{a:"node_in",c:"wi",g:["float"],f:!1},{a:"node_out",c:"wj",g:["vec3"],f:!1},{a:"node_out",c:"wk",g:["float"],f:!1}],j:[{a:"txt",b:"vec4 wl = GLSL_TEXTURE ( u_nodes_texture , vec2 ( wi , NODE_TEX_ROW ) ) ; wj = wl . rgb ; wk = wl . a ;".split(" ")}]},
{a:"node",c:"MAPPING",m:[{a:"node_var",c:"MAPPING_SCALE_DEF",b:["0"]},{a:"node_var",c:"MAPPING_SCALE",b:["vec3","(","1.0",")"]},{a:"node_var",c:"MAPPING_TRANS_DEF",b:["0"]},{a:"node_var",c:"MAPPING_TRANS",b:["vec3","(","0.0",")"]},{a:"node_var",c:"MAPPING_TRS_MATRIX_DEF",b:["0"]},{a:"node_var",c:"MAPPING_TRS_MATRIX",b:["mat4","(","1.0",")"]},{a:"node_var",c:"MAPPING_MIN_CLIP_DEF",b:["0"]},{a:"node_var",c:"MAPPING_MIN_CLIP",b:["vec3","(","0.0",")"]},{a:"node_var",c:"MAPPING_MAX_CLIP_DEF",b:["0"]},
{a:"node_var",c:"MAPPING_MAX_CLIP",b:["vec3","(","1.0",")"]},{a:"node_var",c:"MAPPING_IS_NORMAL",b:["0"]}],l:[{a:"node_in",c:"wm",g:["vec3"],f:!1},{a:"node_out",c:"wn",g:["vec3"],f:!1}],j:[{a:"txt",b:["wn","=","wm",";"]},{a:"node_cond",d:[{a:"node_if",e:["MAPPING_SCALE_DEF"],j:[{a:"txt",b:"wn = wn * MAPPING_SCALE ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",e:["MAPPING_TRANS_DEF"],j:[{a:"txt",b:"wn = wn + MAPPING_TRANS ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",e:["MAPPING_TRS_MATRIX_DEF"],
j:[{a:"txt",b:"wn = ( MAPPING_TRS_MATRIX * vec4 ( wn , _1_0 ) ) . xyz ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",e:["MAPPING_MIN_CLIP_DEF"],j:[{a:"txt",b:"wn = max ( wn , MAPPING_MIN_CLIP ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",e:["MAPPING_MAX_CLIP_DEF"],j:[{a:"txt",b:"wn = min ( wn , MAPPING_MAX_CLIP ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",e:["MAPPING_IS_NORMAL"],j:[{a:"txt",b:"wn = normalize ( wn ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ADD",m:[{a:"node_var",c:"MATH_USE_CLAMP",
b:["0"]}],l:[{a:"node_in",c:"wo",g:["float"],f:!1},{a:"node_in",c:"wp",g:["float"],f:!1},{a:"node_out",c:"wq",g:["float"],f:!1}],j:[{a:"txt",b:"wq = wo + wp ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["MATH_USE_CLAMP"],j:[{a:"txt",b:"wq = clamp ( wq , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_SUBTRACT",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"wr",g:["float"],f:!1},{a:"node_in",c:"ws",g:["float"],f:!1},{a:"node_out",c:"wt",g:["float"],f:!1}],j:[{a:"txt",b:"wt = wr - ws ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",e:["MATH_USE_CLAMP"],j:[{a:"txt",b:"wt = clamp ( wt , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MULTIPLY",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"wu",g:["float"],f:!1},{a:"node_in",c:"wv",g:["float"],f:!1},{a:"node_out",c:"wA",g:["float"],f:!1}],j:[{a:"txt",b:"wA = wu * wv ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["MATH_USE_CLAMP"],j:[{a:"txt",b:"wA = clamp ( wA , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_DIVIDE",
m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"wB",g:["float"],f:!1},{a:"node_in",c:"wC",g:["float"],f:!1},{a:"node_out",c:"wD",g:["float"],f:!1}],j:[{a:"txt",b:"wD = ( wC != _0_0 ) ? wB / wC : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["MATH_USE_CLAMP"],j:[{a:"txt",b:"wD = clamp ( wD , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_SINE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"wE",g:["float"],f:!1},{a:"node_in",c:"wF",g:["float"],f:!1},
{a:"node_out",c:"wG",g:["float"],f:!1}],j:[{a:"txt",b:"wG = sin ( wE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["MATH_USE_CLAMP"],j:[{a:"txt",b:"wG = clamp ( wG , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["wF",";"]}]},{a:"node",c:"MATH_COSINE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"wH",g:["float"],f:!1},{a:"node_in",c:"wI",g:["float"],f:!1},{a:"node_out",c:"wJ",g:["float"],f:!1}],j:[{a:"txt",b:"wJ = cos ( wH ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["MATH_USE_CLAMP"],
j:[{a:"txt",b:"wJ = clamp ( wJ , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["wI",";"]}]},{a:"node",c:"MATH_TANGENT",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"wK",g:["float"],f:!1},{a:"node_in",c:"wL",g:["float"],f:!1},{a:"node_out",c:"wM",g:["float"],f:!1}],j:[{a:"txt",b:"wM = tan ( wK ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["MATH_USE_CLAMP"],j:[{a:"txt",b:"wM = clamp ( wM , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["wL",";"]}]},{a:"node",c:"MATH_ARCSINE",m:[{a:"node_var",
c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"wN",g:["float"],f:!1},{a:"node_in",c:"wO",g:["float"],f:!1},{a:"node_out",c:"wP",g:["float"],f:!1}],j:[{a:"txt",b:"wP = ( wN <= _1_0 && wN >= - _1_0 ) ? asin ( wN ) : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["MATH_USE_CLAMP"],j:[{a:"txt",b:"wP = clamp ( wP , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["wO",";"]}]},{a:"node",c:"MATH_ARCCOSINE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"wQ",g:["float"],f:!1},{a:"node_in",
c:"wR",g:["float"],f:!1},{a:"node_out",c:"wS",g:["float"],f:!1}],j:[{a:"txt",b:"wS = ( wQ <= _1_0 && wQ >= - _1_0 ) ? acos ( wQ ) : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["MATH_USE_CLAMP"],j:[{a:"txt",b:"wS = clamp ( wS , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["wR",";"]}]},{a:"node",c:"MATH_ARCTANGENT",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"wT",g:["float"],f:!1},{a:"node_in",c:"wU",g:["float"],f:!1},{a:"node_out",c:"wV",g:["float"],f:!1}],j:[{a:"txt",
b:"wV = atan ( wT ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["MATH_USE_CLAMP"],j:[{a:"txt",b:"wV = clamp ( wV , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["wU",";"]}]},{a:"node",c:"MATH_POWER",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"wW",g:["float"],f:!1},{a:"node_in",c:"wX",g:["float"],f:!1},{a:"node_out",c:"wY",g:["float"],f:!1}],j:[{a:"txt",b:"if ( wW < _0_0 && wX != floor ( wX ) ) wY = _0_0 ; else if ( wX == _0_0 ) wY = _1_0 ; else if ( wW < _0_0 ) wY = mix ( _1_0 , - _1_0 , sign ( mod ( - wX , 2.0 ) ) ) * pow ( - wW , wX ) ; else if ( wW == _0_0 ) wY = _0_0 ; else wY = pow ( wW , wX ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",e:["MATH_USE_CLAMP"],j:[{a:"txt",b:"wY = clamp ( wY , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_LOGARITHM",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"wZ",g:["float"],f:!1},{a:"node_in",c:"w_",g:["float"],f:!1},{a:"node_out",c:"xa",g:["float"],f:!1}],j:[{a:"txt",b:"xa = ( wZ > _0_0 && w_ > _0_0 ) ? log2 ( wZ ) / log2 ( w_ ) : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["MATH_USE_CLAMP"],j:[{a:"txt",b:"xa = clamp ( xa , _0_0 , _1_0 ) ;".split(" ")}]}]}]},
{a:"node",c:"MATH_MINIMUM",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"xb",g:["float"],f:!1},{a:"node_in",c:"xc",g:["float"],f:!1},{a:"node_out",c:"xd",g:["float"],f:!1}],j:[{a:"txt",b:"xd = min ( xb , xc ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["MATH_USE_CLAMP"],j:[{a:"txt",b:"xd = clamp ( xd , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MAXIMUM",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"xe",g:["float"],f:!1},{a:"node_in",c:"xf",g:["float"],
f:!1},{a:"node_out",c:"xg",g:["float"],f:!1}],j:[{a:"txt",b:"xg = max ( xe , xf ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["MATH_USE_CLAMP"],j:[{a:"txt",b:"xg = clamp ( xg , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ROUND",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"xh",g:["float"],f:!1},{a:"node_in",c:"xi",g:["float"],f:!1},{a:"node_out",c:"xj",g:["float"],f:!1}],j:[{a:"txt",b:"xj = floor ( xh + _0_5 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["MATH_USE_CLAMP"],
j:[{a:"txt",b:"xj = clamp ( xj , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["xi",";"]}]},{a:"node",c:"MATH_LESS_THAN",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"xk",g:["float"],f:!1},{a:"node_in",c:"xl",g:["float"],f:!1},{a:"node_out",c:"xm",g:["float"],f:!1}],j:[{a:"txt",b:"xm = ( xk < xl ) ? _1_0 : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["MATH_USE_CLAMP"],j:[{a:"txt",b:"xm = clamp ( xm , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_GREATER_THAN",m:[{a:"node_var",
c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"xn",g:["float"],f:!1},{a:"node_in",c:"xo",g:["float"],f:!1},{a:"node_out",c:"xp",g:["float"],f:!1}],j:[{a:"txt",b:"xp = ( xn > xo ) ? _1_0 : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["MATH_USE_CLAMP"],j:[{a:"txt",b:"xp = clamp ( xp , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MODULO",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"xq",g:["float"],f:!1},{a:"node_in",c:"xr",g:["float"],f:!1},{a:"node_out",c:"xs",
g:["float"],f:!1}],j:[{a:"txt",b:"xs = abs ( xr ) > 0.000001 ? mod ( xq , xr ) : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["MATH_USE_CLAMP"],j:[{a:"txt",b:"xs = clamp ( xs , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ABSOLUTE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"xt",g:["float"],f:!1},{a:"node_in",c:"xu",g:["float"],f:!1},{a:"node_out",c:"xv",g:["float"],f:!1}],j:[{a:"txt",b:"xv = abs ( xt ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["MATH_USE_CLAMP"],
j:[{a:"txt",b:"xv = clamp ( xv , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["xu",";"]}]},{a:"node",c:"MIX_RGB_MIX",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"xA",g:["float"],f:!1},{a:"node_in",c:"xB",g:["vec3"],f:!1},{a:"node_in",c:"xC",g:["vec3"],f:!1},{a:"node_out",c:"xD",g:["vec3"],f:!1}],j:[{a:"txt",b:"float vj = clamp ( xA , _0_0 , _1_0 ) ; xD = mix ( xB , xC , vj ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"xD = clamp ( xD , _0_0 , _1_0 ) ;".split(" ")}]}]}]},
{a:"node",c:"MIX_RGB_ADD",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"xE",g:["float"],f:!1},{a:"node_in",c:"xF",g:["vec3"],f:!1},{a:"node_in",c:"xG",g:["vec3"],f:!1},{a:"node_out",c:"xH",g:["vec3"],f:!1}],j:[{a:"txt",b:"float vj = clamp ( xE , _0_0 , _1_0 ) ; xH = mix ( xF , xF + xG , vj ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"xH = clamp ( xH , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_MULTIPLY",m:[{a:"node_var",
c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"xI",g:["float"],f:!1},{a:"node_in",c:"xJ",g:["vec3"],f:!1},{a:"node_in",c:"xK",g:["vec3"],f:!1},{a:"node_out",c:"xL",g:["vec3"],f:!1}],j:[{a:"txt",b:"float vj = clamp ( xI , _0_0 , _1_0 ) ; xL = mix ( xJ , xJ * xK , vj ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"xL = clamp ( xL , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SUBTRACT",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",
c:"xM",g:["float"],f:!1},{a:"node_in",c:"xN",g:["vec3"],f:!1},{a:"node_in",c:"xO",g:["vec3"],f:!1},{a:"node_out",c:"xP",g:["vec3"],f:!1}],j:[{a:"txt",b:"float vj = clamp ( xM , _0_0 , _1_0 ) ; xP = mix ( xN , xN - xO , vj ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"xP = clamp ( xP , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SCREEN",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"xQ",g:["float"],f:!1},{a:"node_in",c:"xR",
g:["vec3"],f:!1},{a:"node_in",c:"xS",g:["vec3"],f:!1},{a:"node_out",c:"xT",g:["vec3"],f:!1}],j:[{a:"txt",b:"float vj = clamp ( xQ , _0_0 , _1_0 ) ; float xU = _1_0 - vj ; xT = vec3 ( _1_0 ) - ( vec3 ( xU ) + vj * ( vec3 ( _1_0 ) - xS ) ) * ( vec3 ( _1_0 ) - xR ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"xT = clamp ( xT , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DIVIDE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"xV",
g:["float"],f:!1},{a:"node_in",c:"xW",g:["vec3"],f:!1},{a:"node_in",c:"xX",g:["vec3"],f:!1},{a:"node_out",c:"xY",g:["vec3"],f:!1}],j:[{a:"txt",b:"float vj = clamp ( xV , _0_0 , _1_0 ) ; float xU = _1_0 - vj ; xX += step ( xX , vec3 ( _0_0 ) ) ; xY = xU * xW + vj * xW / xX ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"xY = clamp ( xY , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DIFFERENCE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",
c:"xZ",g:["float"],f:!1},{a:"node_in",c:"x_",g:["vec3"],f:!1},{a:"node_in",c:"ya",g:["vec3"],f:!1},{a:"node_out",c:"yb",g:["vec3"],f:!1}],j:[{a:"txt",b:"float vj = clamp ( xZ , _0_0 , _1_0 ) ; yb = mix ( x_ , abs ( x_ - ya ) , vj ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"yb = clamp ( yb , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DARKEN",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yc",g:["float"],f:!1},{a:"node_in",
c:"yd",g:["vec3"],f:!1},{a:"node_in",c:"ye",g:["vec3"],f:!1},{a:"node_out",c:"yf",g:["vec3"],f:!1}],j:[{a:"txt",b:"float vj = clamp ( yc , _0_0 , _1_0 ) ; yf = min ( yd . rgb , ye . rgb * vj ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"yf = clamp ( yf , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_LIGHTEN",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yg",g:["float"],f:!1},{a:"node_in",c:"yh",g:["vec3"],f:!1},{a:"node_in",
c:"yi",g:["vec3"],f:!1},{a:"node_out",c:"yj",g:["vec3"],f:!1}],j:[{a:"txt",b:"float vj = clamp ( yg , _0_0 , _1_0 ) ; yj = max ( yh . rgb , yi . rgb * vj ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"yj = clamp ( yj , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_OVERLAY",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yk",g:["float"],f:!1},{a:"node_in",c:"yl",g:["vec3"],f:!1},{a:"node_in",c:"ym",g:["vec3"],f:!1},{a:"node_out",
c:"yn",g:["vec3"],f:!1}],j:[{a:"txt",b:"float vj = clamp ( yk , _0_0 , _1_0 ) ; vec3 yo = vec3 ( _1_0 - vj ) ; yn = mix ( yl * ( yo + 2.0 * vj * ym ) , vec3 ( _1_0 ) - ( yo + 2.0 * vj * ( vec3 ( _1_0 ) - ym ) ) * ( vec3 ( _1_0 ) - yl ) , step ( _0_5 , yl ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"yn = clamp ( yn , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DODGE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yp",g:["float"],
f:!1},{a:"node_in",c:"yq",g:["vec3"],f:!1},{a:"node_in",c:"yr",g:["vec3"],f:!1},{a:"node_out",c:"ys",g:["vec3"],f:!1}],j:[{a:"txt",b:"float vj = clamp ( yp , _0_0 , _1_0 ) ; vec3 yt = vec3 ( _1_0 ) - vj * yr ; vec3 yu = clamp ( yq / yt , _0_0 , _1_0 ) ; ys = mix ( mix ( yu , vec3 ( _1_0 ) , step ( yt , vec3 ( _0_0 ) ) ) , yq , step ( yq , vec3 ( _0_0 ) ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"ys = clamp ( ys , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",
c:"MIX_RGB_BURN",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yv",g:["float"],f:!1},{a:"node_in",c:"yA",g:["vec3"],f:!1},{a:"node_in",c:"yB",g:["vec3"],f:!1},{a:"node_out",c:"yC",g:["vec3"],f:!1}],j:[{a:"txt",b:"float vj = clamp ( yv , _0_0 , _1_0 ) ; vec3 kd = vec3 ( _1_0 - vj ) ; vec3 yt = kd + vj * yB ; vec3 yu = clamp ( vec3 ( _1_0 ) - ( vec3 ( _1_0 ) - yA ) / yt , _0_0 , _1_0 ) ; yC = mix ( yu , vec3 ( _0_0 ) , step ( yt , vec3 ( _0_0 ) ) ) ;".split(" ")},{a:"node_cond",
d:[{a:"node_if",e:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"yC = clamp ( yC , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_HUE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yD",g:["float"],f:!1},{a:"node_in",c:"yE",g:["vec3"],f:!1},{a:"node_in",c:"yF",g:["vec3"],f:!1},{a:"node_out",c:"yG",g:["vec3"],f:!1}],j:[{a:"txt",b:"float vj = clamp ( yD , _0_0 , _1_0 ) ; vec3 kb , yH , yt ; yG = yE ; yH = ka ( yF ) ; if ( yH . y != _0_0 ) { kb = ka ( yG ) ; kb . x = yH . x ; yt = kc ( kb ) ; yG = mix ( yG , yt , vj ) ; }".split(" ")},
{a:"node_cond",d:[{a:"node_if",e:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"yG = clamp ( yG , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SATURATION",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yI",g:["float"],f:!1},{a:"node_in",c:"yJ",g:["vec3"],f:!1},{a:"node_in",c:"yK",g:["vec3"],f:!1},{a:"node_out",c:"yL",g:["vec3"],f:!1}],j:[{a:"txt",b:"float vj = clamp ( yI , _0_0 , _1_0 ) ; float xU = _1_0 - vj ; yL = yJ ; vec3 kb , yH ; kb = ka ( yL ) ; if ( kb . y != _0_0 ) { yH = ka ( yK ) ; kb . y = xU * kb . y + vj * yH . y ; yL = kc ( kb ) ; }".split(" ")},
{a:"node_cond",d:[{a:"node_if",e:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"yL = clamp ( yL , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_VALUE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yM",g:["float"],f:!1},{a:"node_in",c:"yN",g:["vec3"],f:!1},{a:"node_in",c:"yO",g:["vec3"],f:!1},{a:"node_out",c:"yP",g:["vec3"],f:!1}],j:[{a:"txt",b:"float vj = clamp ( yM , _0_0 , _1_0 ) ; float xU = _1_0 - vj ; vec3 kb , yH ; kb = ka ( yN ) ; yH = ka ( yO ) ; kb . z = xU * kb . z + vj * yH . z ; yP = kc ( kb ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",e:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"yP = clamp ( yP , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_COLOR",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yQ",g:["float"],f:!1},{a:"node_in",c:"yR",g:["vec3"],f:!1},{a:"node_in",c:"yS",g:["vec3"],f:!1},{a:"node_out",c:"yT",g:["vec3"],f:!1}],j:[{a:"txt",b:"float vj = clamp ( yQ , _0_0 , _1_0 ) ; vec3 kb , yH , yt ; yT = yR ; yH = ka ( yS ) ; if ( yH . y != _0_0 ) { kb = ka ( yT ) ; kb . x = yH . x ; kb . y = yH . y ; yt = kc ( kb ) ; yT = mix ( yT , yt , vj ) ; }".split(" ")},
{a:"node_cond",d:[{a:"node_if",e:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"yT = clamp ( yT , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SOFT_LIGHT",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yU",g:["float"],f:!1},{a:"node_in",c:"yV",g:["vec3"],f:!1},{a:"node_in",c:"yW",g:["vec3"],f:!1},{a:"node_out",c:"yX",g:["vec3"],f:!1}],j:[{a:"txt",b:"float vj = clamp ( yU , _0_0 , _1_0 ) ; float xU = _1_0 - vj ; vec3 yY = yW + yV - yW * yV ; yX = yV * ( vec3 ( xU ) + vec3 ( vj ) * ( ( vec3 ( _1_0 ) - yV ) * yW + yY ) ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",e:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"yX = clamp ( yX , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_LINEAR_LIGHT",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yZ",g:["float"],f:!1},{a:"node_in",c:"y_",g:["vec3"],f:!1},{a:"node_in",c:"za",g:["vec3"],f:!1},{a:"node_out",c:"zb",g:["vec3"],f:!1}],j:[{a:"txt",b:"float vj = clamp ( yZ , _0_0 , _1_0 ) ; zb = y_ + vj * ( 2.0 * za - vec3 ( _1_0 ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",
e:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"zb = clamp ( zb , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"OUTPUT",m:[],l:[{a:"node_in",c:"zc",g:["vec3"],f:!1},{a:"node_in",c:"zd",g:["float"],f:!1}],j:[{a:"txt",b:"A = zc ; E = zd ;".split(" ")}]},{a:"node",c:"MATERIAL_BEGIN",m:[{a:"node_var",c:"MATERIAL_EXT",b:["0"]},{a:"node_var",c:"USE_MATERIAL_NORMAL",b:["0"]},{a:"node_var",c:"USE_MATERIAL_DIFFUSE",b:["0"]},{a:"node_var",c:"SHADELESS_MAT",b:["0"]}],l:[{a:"node_in",c:"ze",g:["vec3"],f:!1},{a:"node_in",
c:"zf",g:["vec3"],f:!1},{a:"node_in",c:"zg",g:["float"],f:!1},{a:"node_in",c:"zh",g:["vec3"],f:!0},{a:"node_in",c:"zi",g:["float"],f:!0},{a:"node_out",c:"zj",g:["vec3"],f:!1},{a:"node_out",c:"zk",g:["vec3"],f:!1},{a:"node_out",c:"zl",g:["vec3"],f:!1},{a:"node_out",c:"zm",g:["vec3"],f:!1},{a:"node_out",c:"zn",g:["vec3"],f:!1},{a:"node_out",c:"zo",g:["vec2"],f:!1},{a:"node_out",c:"zp",g:["vec2"],f:!1},{a:"node_out",c:"zq",g:["vec4"],f:!1},{a:"node_param",c:"qH",g:["const","vec2"],f:!0},{a:"node_param",
c:"qI",g:["const","vec3"],f:!1}],j:[{a:"txt",b:"zl = clamp ( ze , _0_0 , _1_0 ) ; zm = qI [ 0 ] * clamp ( zf , _0_0 , _1_0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["USE_MATERIAL_NORMAL"],j:[{a:"txt",b:"zn = normalize ( zh ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:["zn","=","nB",";"]}]}]},{a:"node_cond",d:[{a:"node_if",e:["SHADELESS_MAT",{a:"logic_negative_expr",i:1}],j:[{a:"node_cond",d:[{a:"node_if",e:["MATERIAL_EXT"],j:[{a:"txt",b:"zj = zi * zl ;".split(" ")}]},{a:"node_else",j:[{a:"txt",
b:"zj = qO * zl ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",e:["USE_MATERIAL_DIFFUSE"],j:[{a:"txt",b:["zl","*=","zg",";"]}]}]},{a:"txt",b:"zk = qP * u_environment_energy * ce ( zn ) ; zq = vec4 ( 1.0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["NUM_LIGHTS",0,{a:"g_expr",i:2}],j:[{a:"txt",b:"zo = vec2 ( qH [ 0 ] , qH [ 1 ] ) ; zp = vec2 ( qI [ 1 ] , qI [ 2 ] ) ;".split(" ")}]}]},{a:"txt",b:["D","=","zq",";"]}]},{a:"node_else",j:[{a:"txt",b:"zj = vec3 ( _0_0 ) ; zk = vec3 ( _1_0 ) ;".split(" ")}]}]}]},
{a:"node",c:"MATERIAL_END",m:[{a:"node_var",c:"MATERIAL_EXT",b:["0"]},{a:"node_var",c:"USE_MATERIAL_DIFFUSE",b:["0"]},{a:"node_var",c:"USE_MATERIAL_SPECULAR",b:["0"]}],l:[{a:"node_in",c:"zr",g:["vec4"],f:!1},{a:"node_in",c:"zs",g:["vec3"],f:!1},{a:"node_in",c:"zt",g:["vec3"],f:!1},{a:"node_in",c:"zu",g:["float"],f:!0},{a:"node_in",c:"zv",g:["float"],f:!0},{a:"node_in",c:"zA",g:["float"],f:!0},{a:"node_out",c:"zB",g:["vec3"],f:!0},{a:"node_out",c:"zC",g:["float"],f:!0},{a:"node_out",c:"zD",g:["vec3"],
f:!0},{a:"node_out",c:"zE",g:["vec3"],f:!0},{a:"node_out",c:"zF",g:["vec3"],f:!0},{a:"node_param",c:"qJ",g:["float"],f:!1},{a:"node_param",c:"qK",g:["float"],f:!1}],j:[{a:"txt",b:["zu",";"]},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_zB"],j:[{a:"node_cond",d:[{a:"node_if",e:["USE_MATERIAL_DIFFUSE"],j:[{a:"txt",b:"zB = zr . rgb ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"zB = vec3 ( _0_0 ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",e:["USE_MATERIAL_SPECULAR"],j:[{a:"txt",b:["zB","+=","zs",
";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_zD"],j:[{a:"txt",b:["zD","=","zt",";"]}]}]},{a:"node_cond",d:[{a:"node_if",e:["MATERIAL_EXT"],j:[{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_zE"],j:[{a:"txt",b:"zE = zr . rgb ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_zF"],j:[{a:"txt",b:["zF","=","zs",";"]}]}]},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_zC"],j:[{a:"txt",b:"zC = clamp ( zA , _0_0 , _1_0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["USE_MATERIAL_SPECULAR"],
j:[{a:"txt",b:"float t = max ( max ( zs . r , zs . g ) , zs . b ) * zv ; zC = clamp ( zA * ( _1_0 - t ) + t , _0_0 , _1_0 ) ;".split(" ")}]}]}]}]}]},{a:"node_else",j:[{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_zC"],j:[{a:"txt",b:"zC = clamp ( qJ , _0_0 , _1_0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["USE_MATERIAL_SPECULAR"],j:[{a:"txt",b:"float t = max ( max ( zs . r , zs . g ) , zs . b ) * qK ; zC = qJ * ( _1_0 - t ) + t ;".split(" ")}]}]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",e:["USE_MATERIAL_SPECULAR"],
j:[{a:"txt",b:["B","=","zs",";"]}]},{a:"node_else",j:[{a:"txt",b:"B = vec3 ( _0_0 ) ;".split(" ")}]}]},{a:"txt",b:["C","=","zt",";"]}]},{a:"node",c:"LIGHTING_AMBIENT",m:[],l:[{a:"node_in",c:"nS",g:["vec3"],f:!1},{a:"node_in",c:"nT",g:["vec3"],f:!1},{a:"node_in",c:"nU",g:["vec3"],f:!1},{a:"node_out",c:"nV",g:["vec4"],f:!1},{a:"node_out",c:"nW",g:["vec3"],f:!1}],j:[{a:"txt",b:"nV = vec4 ( nS + nU * nT , _0_0 ) ; nW = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"LIGHTING_LAMP",m:[{a:"node_var",c:"LAMP_TYPE",
b:["HEMI"]},{a:"node_var",c:"LAMP_IND",b:["0"]},{a:"node_var",c:"LAMP_LIGHT_FACT_IND",b:["0"]},{a:"node_var",c:"LAMP_FAC_CHANNELS",b:["rg"]},{a:"node_var",c:"LAMP_SPOT_SIZE",b:["0.8"]},{a:"node_var",c:"LAMP_SPOT_BLEND",b:["0.03"]},{a:"node_var",c:"LAMP_LIGHT_DIST",b:["30.0"]},{a:"node_var",c:"LAMP_SHADOW_MAP_IND",b:["-","1"]}],l:[{a:"node_in",c:"nX",g:["vec4"],f:!1},{a:"node_out",c:"nY",g:["vec3"],f:!1},{a:"node_out",c:"nZ",g:["vec2"],f:!1},{a:"node_out",c:"n_",g:["vec3"],f:!1},{a:"node_out",c:"oa",
g:["float"],f:!1}],j:[{a:"txt",b:"nZ = u_light_factors [ LAMP_LIGHT_FACT_IND ] . LAMP_FAC_CHANNELS ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["LAMP_TYPE","HEMI",{a:"equal_expr",i:2}],j:[{a:"txt",b:["oa","=","_0_5",";"]}]},{a:"node_else",j:[{a:"txt",b:["oa","=","_0_0",";"]}]}]},{a:"txt",b:"n_ = u_light_color_intensities [ LAMP_IND ] ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["LAMP_SHADOW_MAP_IND",1,{a:"negative_expr",i:1},{a:"non_equal_expr",i:2}],j:[{a:"txt",b:"n_ *= nX [ LAMP_SHADOW_MAP_IND ] ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",e:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2},"LAMP_TYPE","POINT",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"vec3 ob = u_light_positions [ LAMP_IND ] ; nY = ob - nA ; float aG = length ( nY ) ; n_ *= LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + aG * aG ) ; nY = normalize ( nY ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vec3 oc = u_light_directions [ LAMP_IND ] ; float od = dot ( nY , oc ) ; od *= smoothstep ( _0_0 , _1_0 , ( od - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; n_ *= od ;".split(" ")}]}]}]},
{a:"node_else",j:[{a:"txt",b:"nY = u_light_directions [ LAMP_IND ] ;".split(" ")}]}]}]},{a:"node",c:"DIFFUSE_FRESNEL",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oe",g:["vec3"],f:!1},{a:"node_in",c:"of",g:["vec2"],f:!1},{a:"node_in",c:"og",g:["vec3"],f:!1},{a:"node_in",c:"oh",g:["float"],f:!1},{a:"node_in",c:"oi",g:["vec2"],f:!1},{a:"node_out",c:"oj",g:["float"],f:!1}],j:[{a:"node_cond",d:[{a:"node_if",e:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 ok = cross ( oe , f . xyz ) ; og = cross ( ok , f . xyz ) ; og = - normalize ( og ) ;".split(" ")}]}]},
{a:"txt",b:"oj = _0_0 ; if ( of . r != _0_0 ) { float ol = ( _1_0 - oh ) * dot ( og , oe ) + oh ; if ( oi [ 0 ] == _0_0 ) { oj = _1_0 ; } else { float t = _1_0 + abs ( ol ) ; t = oi [ 1 ] + ( _1_0 - oi [ 1 ] ) * pow ( t , oi [ 0 ] ) ; oj = clamp ( t , _0_0 , _1_0 ) ; } oj = max ( oj , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_LAMBERT",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"om",g:["vec3"],f:!1},{a:"node_in",c:"on",g:["vec2"],f:!1},{a:"node_in",c:"oo",g:["vec3"],
f:!1},{a:"node_in",c:"op",g:["float"],f:!1},{a:"node_out",c:"oq",g:["float"],f:!1}],j:[{a:"node_cond",d:[{a:"node_if",e:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 ok = cross ( om , f . xyz ) ; oo = cross ( ok , f . xyz ) ; oo = - normalize ( oo ) ;".split(" ")}]}]},{a:"txt",b:"oq = _0_0 ; if ( on . r != _0_0 ) { float ol = ( _1_0 - op ) * dot ( oo , om ) + op ; oq = max ( ol , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_OREN_NAYAR",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",
c:"or",g:["vec3"],f:!1},{a:"node_in",c:"os",g:["vec2"],f:!1},{a:"node_in",c:"ot",g:["vec3"],f:!1},{a:"node_in",c:"ou",g:["float"],f:!1},{a:"node_in",c:"ov",g:["vec2"],f:!1},{a:"node_out",c:"ow",g:["float"],f:!1}],j:[{a:"node_cond",d:[{a:"node_if",e:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 ok = cross ( or , f . xyz ) ; ot = cross ( ok , f . xyz ) ; ot = - normalize ( ot ) ;".split(" ")}]}]},{a:"txt",b:"ow = _0_0 ; if ( os . r != _0_0 ) { float ol = ( _1_0 - ou ) * dot ( ot , or ) + ou ; if ( ov [ 0 ] > _0_0 ) { float ox = max ( dot ( ot , v ) , _0_0 ) ; float oy = ov [ 0 ] * ov [ 0 ] ; float cg = _1_0 - _0_5 * ( oy / ( oy + 0.33 ) ) ; vec3 oz = or - ol * ot ; vec3 oA = v - ox * ot ; if ( length ( oz ) == _0_0 || length ( oA ) == _0_0 || abs ( ol ) > _1_0 || abs ( ox ) > _1_0 ) ow = ol * cg ; else { float oB = acos ( ol ) ; float oC = acos ( ox ) ; vec3 oD = normalize ( oz ) ; vec3 oE = normalize ( oA ) ; float a , b ; a = max ( oB , oC ) ; b = min ( oB , oC ) ; b *= 0.95 ; float t = max ( dot ( oD , oE ) , _0_0 ) ; float oF = 0.45 * ( oy / ( oy + 0.09 ) ) ; ow = ol * ( cg + ( oF * t * sin ( a ) * tan ( b ) ) ) ; } } else ow = ol ; ow = max ( ow , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"DIFFUSE_MINNAERT",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oG",g:["vec3"],f:!1},{a:"node_in",c:"oH",g:["vec2"],f:!1},{a:"node_in",c:"oI",g:["vec3"],f:!1},{a:"node_in",c:"oJ",g:["float"],f:!1},{a:"node_in",c:"oK",g:["vec2"],f:!1},{a:"node_out",c:"oL",g:["float"],f:!1}],j:[{a:"node_cond",d:[{a:"node_if",e:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 ok = cross ( oG , f . xyz ) ; oI = cross ( ok , f . xyz ) ; oI = - normalize ( oI ) ;".split(" ")}]}]},{a:"txt",
b:"oL = _0_0 ; if ( oH . r != _0_0 ) { float ol = ( _1_0 - oJ ) * dot ( oI , oG ) + oJ ; float ox = max ( dot ( oI , v ) , _0_0 ) ; if ( oK [ 0 ] <= _1_0 ) oL = ol * pow ( max ( ox * ol , 0.1 ) , oK [ 0 ] - _1_0 ) ; else oL = ol * pow ( 1.0001 - ox , oK [ 0 ] - _1_0 ) ; oL = max ( oL , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_TOON",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oM",g:["vec3"],f:!1},{a:"node_in",c:"oN",g:["vec2"],f:!1},{a:"node_in",c:"oO",g:["vec3"],f:!1},
{a:"node_in",c:"oP",g:["float"],f:!1},{a:"node_in",c:"oQ",g:["vec2"],f:!1},{a:"node_out",c:"oR",g:["float"],f:!1}],j:[{a:"node_cond",d:[{a:"node_if",e:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 ok = cross ( oM , f . xyz ) ; oO = cross ( ok , f . xyz ) ; oO = - normalize ( oO ) ;".split(" ")}]}]},{a:"txt",b:"oR = _0_0 ; if ( oN . r != _0_0 ) { float ol = ( _1_0 - oP ) * dot ( oO , oM ) + oP ; float oS = acos ( ol ) ; if ( oS < oQ [ 0 ] ) oR = _1_0 ; else if ( oS > ( oQ [ 0 ] + oQ [ 1 ] ) || oQ [ 1 ] == _0_0 ) oR = _0_0 ; else oR = _1_0 - ( ( oS - oQ [ 0 ] ) / oQ [ 1 ] ) ; oR = max ( oR , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"SPECULAR_PHONG",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oT",g:["vec3"],f:!1},{a:"node_in",c:"oU",g:["vec2"],f:!1},{a:"node_in",c:"oV",g:["vec3"],f:!1},{a:"node_in",c:"oW",g:["float"],f:!1},{a:"node_in",c:"oX",g:["vec2"],f:!1},{a:"node_out",c:"oY",g:["float"],f:!1}],j:[{a:"txt",b:"oY = _0_0 ; if ( oU . g == _1_0 ) { vec3 oZ = normalize ( oT + v ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"if ( oW == _0_0 ) { oY = dot ( f . xyz , oZ ) ; oY = sqrt ( _1_0 - oY * oY ) ; }".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"oY = ( _1_0 - oW ) * max ( dot ( oV , oZ ) , _0_0 ) + oW ;".split(" ")}]}]},{a:"txt",b:"oY = pow ( oY , oX [ 0 ] ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_WARDISO",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"o_",g:["vec3"],f:!1},{a:"node_in",c:"pa",g:["vec2"],f:!1},{a:"node_in",c:"pb",g:["vec3"],f:!1},{a:"node_in",c:"pc",g:["float"],f:!1},{a:"node_in",c:"pd",g:["vec2"],f:!1},{a:"node_out",c:"pe",g:["float"],f:!1}],j:[{a:"txt",b:"pe = _0_0 ; if ( pa . g == _1_0 ) { vec3 oZ = normalize ( o_ + v ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",e:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float pf = _0_0 ; float ox = _0_0 ; float pg = _0_0 ; if ( pc == _0_0 ) { pf = dot ( f . xyz , oZ ) ; ox = dot ( f . xyz , v ) ; pg = dot ( f . xyz , o_ ) ; pf = sqrt ( _1_0 - pf * pf ) ; ox = sqrt ( _1_0 - ox * ox ) ; pg = sqrt ( _1_0 - pg * pg ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float pf = max ( dot ( pb , oZ ) , 0.01 ) ; float ox = max ( dot ( pb , v ) , 0.01 ) ; float pg = max ( dot ( pb , o_ ) , 0.01 ) ;".split(" ")}]}]},
{a:"txt",b:"float bl = tan ( acos ( pf ) ) ; float L = max ( pd [ 0 ] , 0.01 ) ; pe = pg * ( _1_0 / ( 4.0 * M_PI * L * L ) ) * ( exp ( - ( bl * bl ) / ( L * L ) ) / ( sqrt ( ox * pg ) ) ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_TOON",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"ph",g:["vec3"],f:!1},{a:"node_in",c:"pi",g:["vec2"],f:!1},{a:"node_in",c:"pj",g:["vec3"],f:!1},{a:"node_in",c:"pk",g:["float"],f:!1},{a:"node_in",c:"pl",g:["vec2"],f:!1},{a:"node_out",c:"pm",g:["float"],
f:!1}],j:[{a:"txt",b:"pm = _0_0 ; if ( pi . g == _1_0 ) { vec3 bO = normalize ( ph + v ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float pn = dot ( bO , f . xyz ) ; float bl = pl [ 0 ] + pl [ 1 ] ; if ( pk == _0_0 ) bl = acos ( sqrt ( _1_0 - pn * pn ) ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float bl = acos ( dot ( bO , pj ) ) ;".split(" ")}]}]},{a:"txt",b:"if ( bl < pl [ 0 ] ) pm = _1_0 ; else if ( bl >= pl [ 0 ] + pl [ 1 ] || pl [ 1 ] == _0_0 ) pm = _0_0 ; else pm = _1_0 - ( bl - pl [ 0 ] ) / pl [ 1 ] ; }".split(" ")}]},
{a:"node",c:"SPECULAR_BLINN",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"po",g:["vec3"],f:!1},{a:"node_in",c:"pr",g:["vec2"],f:!1},{a:"node_in",c:"pu",g:["vec3"],f:!1},{a:"node_in",c:"pv",g:["float"],f:!1},{a:"node_in",c:"pw",g:["vec2"],f:!1},{a:"node_out",c:"px",g:["float"],f:!1}],j:[{a:"txt",b:"px = _0_0 ; if ( pr . g == _1_0 ) { if ( pw [ 0 ] < 1.0 || pw [ 1 ] == _0_0 ) px = _0_0 ; else { if ( pw [ 1 ] < 100.0 ) pw [ 1 ] = sqrt ( 1.0 / pw [ 1 ] ) ; else pw [ 1 ] = 10.0 / pw [ 1 ] ; vec3 oZ = normalize ( v + po ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",e:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float pf = 0.0 ; if ( pv == _0_0 ) { float py = dot ( f . xyz , oZ ) ; pf = sqrt ( _1_0 - py * py ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float pf = ( _1_0 - pv ) * max ( dot ( pu , oZ ) , _0_0 ) + pv ;".split(" ")}]}]},{a:"txt",b:"if ( pf < _0_0 ) px = _0_0 ; else { float ox = max ( dot ( pu , v ) , 0.01 ) ; float pg = dot ( pu , po ) ; if ( pg <= 0.01 ) px = _0_0 ; else { float pz = max ( dot ( v , oZ ) , 0.01 ) ; float a = _1_0 ; float b = ( 2.0 * pf * ox ) / pz ; float db = ( 2.0 * pf * pg ) / pz ; float g = min ( min ( a , b ) , db ) ; float p = sqrt ( pow ( pw [ 0 ] , 2.0 ) + pow ( pz , 2.0 ) - _1_0 ) ; float lq = pow ( p - pz , 2.0 ) / pow ( p + pz , 2.0 ) * ( _1_0 + pow ( pz * ( p + pz ) - _1_0 , 2.0 ) / pow ( pz * ( p - pz ) + _1_0 , 2.0 ) ) ; float oS = acos ( pf ) ; px = max ( lq * g * exp ( - pow ( oS , 2.0 ) / ( 2.0 * pow ( pw [ 1 ] , 2.0 ) ) ) , _0_0 ) ; } } } }".split(" ")}]},
{a:"node",c:"LIGHTING_APPLY",m:[],l:[{a:"node_in",c:"pA",g:["vec4"],f:!1},{a:"node_in",c:"pB",g:["vec3"],f:!1},{a:"node_in",c:"pC",g:["float"],f:!1},{a:"node_in",c:"pD",g:["float"],f:!1},{a:"node_in",c:"pE",g:["vec3"],f:!1},{a:"node_in",c:"pF",g:["vec3"],f:!1},{a:"node_in",c:"pG",g:["vec4"],f:!1},{a:"node_in",c:"pH",g:["vec3"],f:!1},{a:"node_in",c:"pI",g:["vec3"],f:!1},{a:"node_in",c:"pJ",g:["vec3"],f:!1},{a:"node_in",c:"pK",g:["float"],f:!1},{a:"node_out",c:"pL",g:["vec4"],f:!1},{a:"node_out",c:"pM",
g:["vec3"],f:!1}],j:[{a:"node_cond",d:[{a:"node_if",e:["USE_NODE_B4W_TRANSLUCENCY"],j:[{a:"txt",b:"if ( dot ( pE , pF ) * dot ( v , pF ) < _0_0 ) { float zH = pG . x ; float zI = pG . y ; float zJ = pG . z ; float zK = pG . w ; float zL = clamp ( abs ( dot ( pE , pF ) ) , _0_0 , _1_0 ) ; float zM = clamp ( dot ( v , - pE ) , _0_0 , _1_0 ) ; float zN = pow ( zM , zI ) ; pL = pA + pK * vec4 ( pJ * zL * pow ( pH , vec3 ( zH ) ) , _1_0 ) ; pL += zJ * mix ( vec4 ( pH , _1_0 ) , vec4 ( _1_0 ) , zK ) * pK * vec4 ( pJ * zL * vec3 ( zN ) , _1_0 ) ; pM = pB ; } else { pM = pB + pJ * pI * pD ; pL = pA + vec4 ( pJ * pH * pC , pD ) ; }".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"pM = pB + pJ * pI * pD ; pL = pA + vec4 ( pJ * pH * pC , pD ) ;".split(" ")}]}]}]},{a:"node",c:"RGB",m:[{a:"node_var",c:"RGB_IND",b:["0"]}],l:[{a:"node_out",c:"zO",g:["vec3"],f:!1}],j:[{a:"txt",b:"zO = u_node_rgbs [ RGB_IND ] ;".split(" ")}]},{a:"node",c:"RGBTOBW",m:[],l:[{a:"node_in",c:"zP",g:["vec3"],f:!1},{a:"node_out",c:"zQ",g:["float"],f:!1}],j:[{a:"txt",b:"zQ = dot ( zP , vec3 ( 0.35 , 0.45 , 0.2 ) ) ;".split(" ")}]},{a:"node",c:"SEPRGB",m:[],l:[{a:"node_in",c:"zR",
g:["vec3"],f:!1},{a:"node_out",c:"zS",g:["float"],f:!0},{a:"node_out",c:"zT",g:["float"],f:!0},{a:"node_out",c:"zU",g:["float"],f:!0}],j:[{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_zS"],j:[{a:"txt",b:"zS = zR . r ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_zT"],j:[{a:"txt",b:"zT = zR . g ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_zU"],j:[{a:"txt",b:"zU = zR . b ;".split(" ")}]}]}]},{a:"node",c:"SEPHSV",m:[],l:[{a:"node_in",c:"zV",g:["vec3"],f:!1},{a:"node_out",
c:"zW",g:["float"],f:!0},{a:"node_out",c:"zX",g:["float"],f:!0},{a:"node_out",c:"zY",g:["float"],f:!0}],j:[{a:"txt",b:"vec3 zZ = ka ( zV ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_zW"],j:[{a:"txt",b:"zW = zZ . r ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_zX"],j:[{a:"txt",b:"zX = zZ . g ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_zY"],j:[{a:"txt",b:"zY = zZ . b ;".split(" ")}]}]}]},{a:"node",c:"SQUEEZE",m:[],l:[{a:"node_in",c:"z_",g:["float"],f:!1},
{a:"node_in",c:"Aa",g:["float"],f:!1},{a:"node_in",c:"Ab",g:["float"],f:!1},{a:"node_out",c:"Ac",g:["float"],f:!1}],j:[{a:"txt",b:"Ac = _1_0 / ( _1_0 + pow ( 2.71828183 , - ( z_ - Ab ) * Aa ) ) ;".split(" ")}]},{a:"node",c:"GAMMA",m:[],l:[{a:"node_in",c:"Ad",g:["vec3"],f:!1},{a:"node_in",c:"Ae",g:["float"],f:!1},{a:"node_out",c:"Af",g:["vec3"],f:!1}],j:[{a:"txt",b:"Af = Ad ; if ( Af . x > _0_0 ) Af . x = pow ( Ad . x , Ae ) ; if ( Af . y > _0_0 ) Af . y = pow ( Ad . y , Ae ) ; if ( Af . z > _0_0 ) Af . z = pow ( Ad . z , Ae ) ;".split(" ")}]},
{a:"node",c:"B4W_SRGB_TO_LINEAR",m:[],l:[{a:"node_in",c:"Ag",g:["vec3"],f:!1},{a:"node_out",c:"Ah",g:["vec3"],f:!1}],j:[{a:"txt",b:"Ah = max ( vec3 ( _0_0 ) , Ag ) ; Ah = pow ( Ah , vec3 ( 2.2 ) ) ;".split(" ")}]},{a:"node",c:"B4W_LINEAR_TO_SRGB",m:[],l:[{a:"node_in",c:"Ai",g:["vec3"],f:!1},{a:"node_out",c:"Aj",g:["vec3"],f:!1}],j:[{a:"txt",b:"Aj = max ( vec3 ( _0_0 ) , Ai ) ; Aj = pow ( Aj , vec3 ( _1_0 / 2.2 ) ) ;".split(" ")}]},{a:"node",c:"TEXTURE_EMPTY",m:[],l:[{a:"node_out",c:"Ak",g:["vec3"],
f:!1},{a:"node_out",c:"Al",g:["vec3"],f:!1},{a:"node_out",c:"Am",g:["float"],f:!1}],j:[{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_Ak"],j:[{a:"txt",b:"Ak [ 2 ] = Ak [ 1 ] = Ak [ 0 ] = _0_0 ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_Al"],j:[{a:"txt",b:"Al [ 2 ] = Al [ 1 ] = Al [ 0 ] = _0_0 ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_Am"],j:[{a:"txt",b:["Am","=","_0_0",";"]}]}]}]},{a:"node",c:"TEXTURE_ENVIRONMENT",m:[],l:[{a:"node_in",c:"An",g:["vec3"],f:!1},{a:"node_out",
c:"Ao",g:["vec3"],f:!0},{a:"node_out",c:"Ap",g:["float"],f:!0},{a:"node_param",c:"node_TEXTURE_ENVIRONMENT_var_texture",g:["uniform","samplerCube"],f:!1}],j:[{a:"txt",b:"vec4 wl = GLSL_TEXTURE_CUBE ( node_TEXTURE_ENVIRONMENT_var_texture , An ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_Ao"],j:[{a:"txt",b:"Ao = wl . xyz ; bY ( Ao ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_Ap"],j:[{a:"txt",b:"Ap = wl . w ;".split(" ")}]}]}]},{a:"node",c:"TEXTURE_COLOR",m:[{a:"node_var",
c:"NON_COLOR",b:["0"]},{a:"node_var",c:"USE_uv2",b:["0"]},{a:"node_var",c:"USE_uv3",b:["0"]},{a:"node_var",c:"USE_uv4",b:["0"]}],l:[{a:"node_in",c:"Ar",g:["vec3"],f:!0},{a:"node_in",c:"As",g:["vec3"],f:!0},{a:"node_in",c:"At",g:["vec3"],f:!0},{a:"node_in",c:"Au",g:["vec3"],f:!0},{a:"node_out",c:"Av",g:["vec3"],f:!0},{a:"node_out",c:"Aw",g:["float"],f:!0},{a:"node_out",c:"Ax",g:["vec3"],f:!0},{a:"node_out",c:"Ay",g:["float"],f:!0},{a:"node_out",c:"Az",g:["vec3"],f:!0},{a:"node_out",c:"AA",g:["float"],
f:!0},{a:"node_out",c:"AB",g:["vec3"],f:!0},{a:"node_out",c:"AC",g:["float"],f:!0},{a:"node_param",c:"node_TEXTURE_COLOR_var_texture",g:["uniform","sampler2D"],f:!1}],j:[{a:"txt",b:"vec4 wl = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qx ( Ar ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_Av"],j:[{a:"txt",b:"Av = wl . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["NON_COLOR",{a:"logic_negative_expr",i:1}],j:[{a:"txt",b:["bY","(","Av",")",";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",
e:["USE_OUT_Aw"],j:[{a:"txt",b:"Aw = wl . w ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",e:["USE_uv2"],j:[{a:"txt",b:"wl = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qx ( As ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_Ax"],j:[{a:"txt",b:"Ax = wl . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["NON_COLOR",{a:"logic_negative_expr",i:1}],j:[{a:"txt",b:["bY","(","Ax",")",";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_Ay"],j:[{a:"txt",b:"Ay = wl . w ;".split(" ")}]}]}]}]},
{a:"node_cond",d:[{a:"node_if",e:["USE_uv3"],j:[{a:"txt",b:"wl = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qx ( At ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_Az"],j:[{a:"txt",b:"Az = wl . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["NON_COLOR",{a:"logic_negative_expr",i:1}],j:[{a:"txt",b:["bY","(","Az",")",";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_AA"],j:[{a:"txt",b:"AA = wl . w ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",e:["USE_uv4"],j:[{a:"txt",
b:"wl = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qx ( Au ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_AB"],j:[{a:"txt",b:"AB = wl . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["NON_COLOR",{a:"logic_negative_expr",i:1}],j:[{a:"txt",b:["bY","(","AB",")",";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_AC"],j:[{a:"txt",b:"AC = wl . w ;".split(" ")}]}]}]}]}]},{a:"node",c:"TEXTURE_NORMAL",m:[{a:"node_var",c:"USE_uv2",b:["0"]},{a:"node_var",c:"USE_uv3",b:["0"]},
{a:"node_var",c:"USE_uv4",b:["0"]}],l:[{a:"node_in",c:"AD",g:["vec3"],f:!0},{a:"node_in",c:"AE",g:["vec3"],f:!0},{a:"node_in",c:"AF",g:["vec3"],f:!0},{a:"node_in",c:"AG",g:["vec3"],f:!0},{a:"node_out",c:"AH",g:["vec3"],f:!0},{a:"node_out",c:"AI",g:["float"],f:!0},{a:"node_out",c:"AJ",g:["vec3"],f:!0},{a:"node_out",c:"AK",g:["float"],f:!0},{a:"node_out",c:"AL",g:["vec3"],f:!0},{a:"node_out",c:"AM",g:["float"],f:!0},{a:"node_out",c:"AN",g:["vec3"],f:!0},{a:"node_out",c:"AO",g:["float"],f:!0},{a:"node_param",
c:"node_TEXTURE_NORMAL_var_texture",g:["uniform","sampler2D"],f:!1}],j:[{a:"txt",b:"vec4 wl = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qx ( AD ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_AH"],j:[{a:"txt",b:"AH = normalize ( qM * ( wl . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_AI"],j:[{a:"txt",b:"AI = wl . w ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",e:["USE_uv2"],j:[{a:"txt",b:"wl = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qx ( AE ) ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_AJ"],j:[{a:"txt",b:"AJ = normalize ( qM * ( wl . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_AK"],j:[{a:"txt",b:"AK = wl . w ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",e:["USE_uv3"],j:[{a:"txt",b:"wl = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qx ( AF ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_AL"],j:[{a:"txt",b:"AL = normalize ( qM * ( wl . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",
d:[{a:"node_if",e:["USE_OUT_AM"],j:[{a:"txt",b:"AM = wl . w ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",e:["USE_uv4"],j:[{a:"txt",b:"wl = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qx ( AG ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_AN"],j:[{a:"txt",b:"AN = normalize ( qM * ( wl . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_AO"],j:[{a:"txt",b:"AO = wl . w ;".split(" ")}]}]}]}]}]},{a:"node",c:"VALUE",m:[],l:[{a:"node_out",c:"AP",g:["float"],
f:!1}],j:[{a:"txt",b:"AP = u_node_values [ VALUE_IND ] ;".split(" ")}]},{a:"node",c:"VECT_MATH_ADD",m:[],l:[{a:"node_in",c:"AQ",g:["vec3"],f:!1},{a:"node_in",c:"AR",g:["vec3"],f:!1},{a:"node_out",c:"AS",g:["vec3"],f:!1},{a:"node_out",c:"AT",g:["float"],f:!0}],j:[{a:"txt",b:"AS = AQ + AR ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_AT"],j:[{a:"txt",b:"AT = ( abs ( AS [ 0 ] ) + abs ( AS [ 1 ] ) + abs ( AS [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_SUBTRACT",m:[],l:[{a:"node_in",
c:"AU",g:["vec3"],f:!1},{a:"node_in",c:"AV",g:["vec3"],f:!1},{a:"node_out",c:"AW",g:["vec3"],f:!1},{a:"node_out",c:"AX",g:["float"],f:!0}],j:[{a:"txt",b:"AW = AU - AV ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_AX"],j:[{a:"txt",b:"AX = ( abs ( AW [ 0 ] ) + abs ( AW [ 1 ] ) + abs ( AW [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_AVERAGE",m:[],l:[{a:"node_in",c:"AY",g:["vec3"],f:!1},{a:"node_in",c:"AZ",g:["vec3"],f:!1},{a:"node_out",c:"A_",g:["vec3"],f:!1},{a:"node_out",
c:"Ba",g:["float"],f:!0}],j:[{a:"txt",b:"A_ = AY + AZ ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_Ba"],j:[{a:"txt",b:"Ba = length ( A_ ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_A_"],j:[{a:"txt",b:"A_ = normalize ( A_ ) ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_DOT_PRODUCT",m:[],l:[{a:"node_in",c:"Bb",g:["vec3"],f:!1},{a:"node_in",c:"Bc",g:["vec3"],f:!1},{a:"node_out",c:"Bd",g:["vec3"],f:!1},{a:"node_out",c:"Be",g:["float"],f:!0}],j:[{a:"txt",b:"Bd = vec3 ( _0_0 ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_Be"],j:[{a:"txt",b:"Be = dot ( Bb , Bc ) ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_CROSS_PRODUCT",m:[],l:[{a:"node_in",c:"Bf",g:["vec3"],f:!1},{a:"node_in",c:"Bg",g:["vec3"],f:!1},{a:"node_out",c:"Bh",g:["vec3"],f:!1},{a:"node_out",c:"Bi",g:["float"],f:!0}],j:[{a:"txt",b:"Bh = cross ( Bf , Bg ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_Bi"],j:[{a:"txt",b:"Bi = length ( Bh ) ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_NORMALIZE",m:[],l:[{a:"node_in",
c:"Bj",g:["vec3"],f:!1},{a:"node_in",c:"Bk",g:["vec3"],f:!1},{a:"node_out",c:"Bl",g:["vec3"],f:!1},{a:"node_out",c:"Bm",g:["float"],f:!0}],j:[{a:"txt",b:"Bl = normalize ( Bj ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_Bm"],j:[{a:"txt",b:"Bm = length ( Bj ) ;".split(" ")}]}]},{a:"txt",b:["Bk",";"]}]},{a:"node",c:"B4W_REFLECT",m:[],l:[{a:"node_in",c:"Bn",g:["vec3"],f:!1},{a:"node_in",c:"Bo",g:["vec3"],f:!1},{a:"node_out",c:"Bp",g:["vec3"],f:!1}],j:[{a:"txt",b:"Bp = reflect ( U ( G , Bn ) , Bo ) ;".split(" ")}]},
{a:"node",c:"B4W_REFLECT_WORLD",m:[],l:[{a:"node_in",c:"Bq",g:["vec3"],f:!1},{a:"node_out",c:"Br",g:["vec3"],f:!1}],j:[{a:"txt",b:"vec3 Bs = - v . xyz ; Br = reflect ( Bs , Bq ) ;".split(" ")}]},{a:"node",c:"B4W_PARALLAX",m:[],l:[{a:"node_in",c:"Bt",g:["vec3"],f:!1},{a:"node_in",c:"Bu",g:["float"],f:!1},{a:"node_in",c:"Bv",g:["const","float"],f:!1},{a:"node_in",c:"Bw",g:["const","float"],f:!1},{a:"node_out",c:"Bx",g:["vec3"],f:!1},{a:"node_param",c:"node_B4W_PARALLAX_var_texture",g:["uniform","sampler2D"],
f:!1}],j:[{a:"txt",b:"float bo = length ( qN ) ; if ( bo < Bw ) { vec2 bE = qx ( Bt ) ; float bI = clamp ( _0_5 * ( Bw - bo ) , _0_0 , _1_0 ) ; float hN = Bu * bI ; vec3 bK = normalize ( v * qM ) ; float bL = _1_0 / Bv ; vec2 bM = bK . xy * hN / ( Bv * bK . z ) ; float bN = _1_0 ; float bO = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bE ) . a ; for ( float bQ = 1.0 ; bQ <= Bv ; bQ ++ ) { if ( bO < bN ) { bN -= bL ; bE -= bM ; bO = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bE ) . a ; } } vec2 bR = bE + bM ; float bS = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bR ) . a - ( bN + bL ) ; float bT = bO - bN ; float bU = bT / ( bT - bS ) ; bE = bU * bR + ( _1_0 - bU ) * bE ; Bx = qw ( bE ) ; } else Bx = Bt ;".split(" ")}]},
{a:"node",c:"B4W_CLAMP",m:[],l:[{a:"node_in",c:"By",g:["vec3"],f:!1},{a:"node_out",c:"Bz",g:["vec3"],f:!1}],j:[{a:"txt",b:"Bz = clamp ( By , _0_0 , _1_0 ) ;".split(" ")}]},{a:"node",c:"B4W_REFRACTION",m:[],l:[{a:"node_in",c:"BA",g:["vec3"],f:!1},{a:"node_in",c:"BB",g:["float"],f:!1},{a:"node_out",c:"BC",g:["vec3"],f:!1}],j:[{a:"txt",b:["BC","=","BA",";"]}]},{a:"node",c:"B4W_TRANSLUCENCY",m:[],l:[{a:"node_in",c:"BD",g:["float"],f:!1},{a:"node_in",c:"BE",g:["float"],f:!1},{a:"node_in",c:"BF",g:["float"],
f:!1},{a:"node_in",c:"BG",g:["float"],f:!1},{a:"node_in",c:"BH",g:["float"],f:!1},{a:"node_out",c:"BI",g:["float"],f:!0},{a:"node_out",c:"BJ",g:["vec4"],f:!0}],j:[{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_BI"],j:[{a:"txt",b:["BI","=","BD",";"]}]}]},{a:"node_cond",d:[{a:"node_if",e:["USE_OUT_BJ"],j:[{a:"txt",b:"BJ = vec4 ( BE , BF , BG , BH ) ;".split(" ")}]}]}]},{a:"node",c:"B4W_TIME",m:[],l:[{a:"node_out",c:"BK",g:["float"],f:!1}],j:[{a:"txt",b:["BK","=","u_time",";"]}]},{a:"node",c:"B4W_SMOOTHSTEP",
m:[],l:[{a:"node_in",c:"BL",g:["float"],f:!1},{a:"node_in",c:"BM",g:["float"],f:!1},{a:"node_in",c:"BN",g:["float"],f:!1},{a:"node_out",c:"BO",g:["float"],f:!1}],j:[{a:"txt",b:"BO = smoothstep ( BM , BN , BL ) ;".split(" ")}]},{a:"node",c:"B4W_GLOW_OUTPUT",m:[],l:[{a:"node_in",c:"BP",g:["vec3"],f:!1},{a:"node_in",c:"BQ",g:["float"],f:!1}],j:[{a:"txt",b:"A = BP ; E = BQ ;".split(" ")}]},{a:"node",c:"B4W_VECTOSCAL",m:[],l:[{a:"node_in",c:"BR",g:["vec3"],f:!1},{a:"node_out",c:"BS",g:["float"],f:!1}],
j:[{a:"txt",b:"BS = ( BR . r + BR . g + BR . b ) / 3.0 ;".split(" ")}]},{a:"node",c:"B4W_SCALTOVEC",m:[],l:[{a:"node_in",c:"BT",g:["float"],f:!1},{a:"node_out",c:"BU",g:["vec3"],f:!1}],j:[{a:"txt",b:"BU [ 0 ] = BT ; BU [ 1 ] = BT ; BU [ 2 ] = BT ;".split(" ")}]},{a:"nodes_global"},{a:"txt",b:"void J ( in vec3 v , in mat3 F , in mat3 G , in mat3 H , in mat3 I , out vec3 A , out vec3 B , out vec3 C , out vec4 D , out float E ) { A = vec3 ( _0_0 ) ; B = vec3 ( _0_0 ) ; C = vec3 ( _0_0 ) ; D = vec4 ( _0_0 ) ; E = _0_0 ;".split(" ")},
{a:"cond",d:[{a:"if",e:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","USE_NODE_TEX_COORD_NO","USE_NODE_NORMAL_MAP",{a:"logical_or_expr",i:6}],h:{a:"grp",d:[{a:"txt",b:"vec3 Q = normalize ( e ) ; vec3 bF = Q ;".split(" ")},{a:"cond",d:[{a:"if",e:["DOUBLE_SIDED_LIGHTING","USE_NODE_GEOMETRY_NO",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["INVERT_FRONTFACING"],h:{a:"grp",d:[{a:"txt",b:["if","(","!","gl_FrontFacing",")"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",
b:["if","(","gl_FrontFacing",")"]}]}}]},{a:"txt",b:"bF = bF ; else bF = - bF ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["DOUBLE_SIDED_LIGHTING"],h:{a:"grp",d:[{a:"txt",b:["vec3","nB","=","bF",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec3","nB","=","Q",";"]}]}}]},{a:"cond",d:[{a:"if",e:["USE_NODE_GEOMETRY_NO"],h:{a:"grp",d:[{a:"txt",b:["vec3","qL","=","bF",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",e:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:"vec3 S = cross ( bF , f . xyz ) * f . w ; S = normalize ( S ) ; vec3 R = cross ( S , bF ) * f . w ; mat3 qM = mat3 ( R , S , bF ) ;".split(" ")}]}}]},
{a:"txt",b:"vec3 nA = c ; vec4 qN = d ; float qO = u_emit ; float qP = u_ambient ;".split(" ")},{a:"nodes_main"},{a:"txt",b:["}"]}]}}]}]};a["include/particles_nodes.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"PARTICLES_NODES_GLSLV",h:{a:"grp",d:[{a:"define",c:"PARTICLES_NODES_GLSLV",b:[""]},{a:"node",c:"TEX_COORD_UV",m:[],l:[],j:[{a:"txt",b:"n = CA + 0.5 ;".split(" ")}]},{a:"node",c:"UV_MERGED",m:[],l:[],j:[{a:"txt",b:"n = CA + 0.5 ;".split(" ")}]},{a:"node",c:"UVMAP",m:[],l:[],j:[{a:"txt",b:"n = CA + 0.5 ;".split(" ")}]},
{a:"node",c:"GEOMETRY_UV",m:[],l:[],j:[{a:"txt",b:"n = CA + 0.5 ;".split(" ")}]},{a:"node",c:"PARTICLE_INFO",m:[{a:"node_var",c:"PART_INFO_SIZE",b:["0"]},{a:"node_var",c:"PART_INFO_AGE",b:["0"]},{a:"node_var",c:"PART_INFO_LT",b:["0"]},{a:"node_var",c:"PART_INFO_LOC",b:["0"]},{a:"node_var",c:"PART_INFO_IND",b:["0"]},{a:"node_var",c:"PART_INFO_VEL",b:["0"]},{a:"node_var",c:"PART_INFO_A_VEL",b:["0"]}],l:[{a:"node_param",c:"Cr",g:["GLSL_OUT","vec4"],f:!0},{a:"node_param",c:"Cs",g:["GLSL_OUT","vec3"],
f:!0},{a:"node_param",c:"Ct",g:["GLSL_OUT","vec3"],f:!0},{a:"node_param",c:"Cu",g:["GLSL_OUT","vec3"],f:!0},{a:"node_param",c:"node_PARTICLE_INFO_var_a_p_indices",g:["GLSL_IN","float"],f:!0}],j:[{a:"node_cond",d:[{a:"node_if",e:["PART_INFO_SIZE"],j:[{a:"txt",b:"Cr [ 3 ] = Cz ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",e:["PART_INFO_AGE"],j:[{a:"txt",b:"Cr [ 1 ] = Cy ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",e:["PART_INFO_LT"],j:[{a:"txt",b:"Cr [ 2 ] = CB ;".split(" ")}]}]},{a:"node_cond",
d:[{a:"node_if",e:["PART_INFO_LOC"],j:[{a:"txt",b:["Cs","=","Cv",";"]}]}]},{a:"node_cond",d:[{a:"node_if",e:["PART_INFO_IND"],j:[{a:"txt",b:"Cr [ 0 ] = node_PARTICLE_INFO_var_a_p_indices ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",e:["PART_INFO_VEL"],j:[{a:"txt",b:["Ct","=","Cw",";"]}]}]},{a:"node_cond",d:[{a:"node_if",e:["PART_INFO_A_VEL"],j:[{a:"txt",b:["Cu","=","Cx",";"]}]}]}]},{a:"nodes_global"},{a:"txt",b:"void J ( in vec3 Cv , in vec3 Cw , in vec3 Cx , in float Cy , in float Cz , in vec2 CA , in float CB ) {".split(" ")},
{a:"cond",d:[{a:"if",e:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"n = CA + 0.5 ;".split(" ")}]}}]},{a:"nodes_main"},{a:"txt",b:["}"]}]}}]}]};a["include/precision_statement.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"PRECISION_STATEMENT_GLSLF",h:{a:"grp",d:[{a:"define",c:"PRECISION_STATEMENT_GLSLF",b:[""]},{a:"var",c:"PRECISION",b:["highp"]},{a:"txt",b:["precision","PRECISION","float",";"]}]}}]}]};a["include/procedural.glslf"]={a:"grp",
d:[{a:"cond",d:[{a:"ifndef",c:"PROCEDURAL_GLSLF",h:{a:"grp",d:[{a:"define",c:"PROCEDURAL_GLSLF",b:[""]},{a:"txt",b:"vec4 CC ( vec4 x ) { return x - floor ( x * ( _1_0 / 289.0 ) ) * 289.0 ; } vec3 CC ( vec3 x ) { return x - floor ( x * ( _1_0 / 289.0 ) ) * 289.0 ; } vec2 CC ( vec2 x ) { return x - floor ( x * ( _1_0 / 289.0 ) ) * 289.0 ; } vec4 CD ( vec4 x ) { return x - floor ( x * ( _1_0 / 7.0 ) ) * 7.0 ; } vec4 CE ( vec4 x ) { return CC ( ( 34.0 * x + 5.0 ) * x ) ; }".split(" ")},{a:"define",c:"K",
b:["0.142857142857"]},{a:"define",c:"K2",b:["0.0714285714285"]},{a:"define",c:"JITTER",b:["0.7"]},{a:"txt",b:"vec2 fC ( vec2 CF ) { vec2 CG = CC ( floor ( CF ) ) ; vec2 CH = fract ( CF ) ; vec4 CI = CH . x + vec4 ( - 0.5 , - 1.5 , - 0.5 , - 1.5 ) ; vec4 CJ = CH . y + vec4 ( - 0.5 , - 0.5 , - 1.5 , - 1.5 ) ; vec4 p = CE ( CG . x + vec4 ( _0_0 , _1_0 , _0_0 , _1_0 ) ) ; p = CE ( p + CG . y + vec4 ( _0_0 , _0_0 , _1_0 , _1_0 ) ) ; vec4 CK = CD ( p ) * K + K2 ; vec4 CL = CD ( floor ( p * K ) ) * K + K2 ; vec4 CM = CI + JITTER * CK ; vec4 CN = CJ + JITTER * CL ; vec4 dg = CM * CM + CN * CN ;".split(" ")},
{a:"cond",d:[{a:"if",e:[1],h:{a:"grp",d:[{a:"txt",b:"dg . xy = min ( dg . xy , dg . zw ) ; dg . x = min ( dg . x , dg . y ) ; return dg . xx ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"dg . xy = ( dg . x < dg . y ) ? dg . xy : dg . yx ; dg . xz = ( dg . x < dg . z ) ? dg . xz : dg . zx ; dg . xw = ( dg . x < dg . w ) ? dg . xw : dg . wx ; dg . y = min ( dg . y , dg . z ) ; dg . y = min ( dg . y , dg . w ) ; return sqrt ( dg . xy ) ;".split(" ")}]}}]},{a:"txt",b:"} vec3 kt ( vec2 CF , float CO ) { vec2 CG = CC ( floor ( CF ) ) ; vec2 CH = fract ( CF ) ; vec4 CI = CH . x + vec4 ( - 0.5 , - 1.5 , - 0.5 , - 1.5 ) ; vec4 CJ = CH . y + vec4 ( - 0.5 , - 0.5 , - 1.5 , - 1.5 ) ; vec4 p = CE ( CG . x + vec4 ( _0_0 , _1_0 , _0_0 , _1_0 ) ) ; p = CE ( p + CG . y + vec4 ( _0_0 , _0_0 , _1_0 , _1_0 ) ) ; vec4 CK = CD ( p ) * K + K2 ; vec4 CL = CD ( floor ( p * K ) ) * K + K2 ; vec4 CM = CI + JITTER * CK ; vec4 CN = CJ + JITTER * CL ; vec4 CP = CM * CM + CN * CN ; CM += CO ; CN += CO ; vec4 CQ = CM * CM + CN * CN ; CM += CO ; CN += CO ; vec4 CR = CM * CM + CN * CN ; CP . xy = min ( CP . xy , CP . zw ) ; CP . x = min ( CP . x , CP . y ) ; CQ . xy = min ( CQ . xy , CQ . zw ) ; CQ . x = min ( CQ . x , CQ . y ) ; CR . xy = min ( CR . xy , CR . zw ) ; CR . x = min ( CR . x , CR . y ) ; return vec3 ( CP . x , CQ . x , CR . x ) ; } vec3 CS ( vec3 x ) { return CC ( ( ( x * 34.0 ) + _1_0 ) * x ) ; } float fr ( vec2 km ) { const vec4 CT = vec4 ( 0.211324865405187 , 0.366025403784439 , - 0.577350269189626 , 0.024390243902439 ) ; vec2 bQ = floor ( km + dot ( km , CT . yy ) ) ; vec2 CU = km - bQ + dot ( bQ , CT . xx ) ; vec2 CV ; CV = ( CU . x > CU . y ) ? vec2 ( _1_0 , _0_0 ) : vec2 ( _0_0 , _1_0 ) ; vec4 CW = CU . xyxy + CT . xxzz ; CW . xy -= CV ; bQ = CC ( bQ ) ; vec3 p = CS ( CS ( bQ . y + vec3 ( _0_0 , CV . y , _1_0 ) ) + bQ . x + vec3 ( _0_0 , CV . x , _1_0 ) ) ; vec3 aq = max ( 0.5 - vec3 ( dot ( CU , CU ) , dot ( CW . xy , CW . xy ) , dot ( CW . zw , CW . zw ) ) , _0_0 ) ; aq = aq * aq ; aq = aq * aq ; vec3 x = 2.0 * fract ( p * CT . www ) - _1_0 ; vec3 bO = abs ( x ) - 0.5 ; vec3 CK = floor ( x + 0.5 ) ; vec3 CX = x - CK ; aq *= 1.79284291400159 - 0.85373472095314 * ( CX * CX + bO * bO ) ; vec3 g ; g . x = CX . x * CU . x + bO . x * CU . y ; g . yz = CX . yz * CW . xz + bO . yz * CW . yw ; return 130.0 * dot ( aq , g ) ; } vec2 C_ ( vec2 fQ ) { float CP = dot ( fQ , vec2 ( 12.9898 , 78.233 ) ) ; float CQ = dot ( fQ , vec2 ( 12.9898 , 78.233 ) * 2.0 ) ; float CY = fract ( sin ( CP ) * 43758.5453 ) * 2.0 - _1_0 ; float CZ = fract ( sin ( CQ ) * 43758.5453 ) * 2.0 - _1_0 ; return vec2 ( CY , CZ ) ; }".split(" ")}]}}]}]};
a["include/refraction.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"REFRACTION_GLSLF",h:{a:"grp",d:[{a:"define",c:"REFRACTION_GLSLF",b:[""]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"cond",d:[{a:"if",e:["REFRACTIVE"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["USE_REFRACTION_CORRECTION"],h:{a:"grp",d:[{a:"include",o:"pack.glslf"}]}}]},{a:"include",o:"color_util.glslf"},{a:"cond",d:[{a:"if",e:["USE_REFRACTION_CORRECTION"],h:{a:"grp",d:[{a:"txt",b:"float eS ( in float cw , inout vec2 eR , in vec2 eA ) { vec4 Da = GLSL_TEXTURE ( u_scene_depth , eR ) ; float eT = cv ( Da ) ; if ( eT < i ) { eR = eA ; return cw ; } else { return eT ; } return cw ; }".split(" ")}]}}]},
{a:"txt",b:"vec3 cs ( in vec3 qe , in vec2 Db ) { vec2 eA = qe . xy / qe . z ; vec2 eR = eA + Db ;".split(" ")},{a:"cond",d:[{a:"if",e:["USE_REFRACTION_CORRECTION"],h:{a:"grp",d:[{a:"txt",b:"vec4 cu = GLSL_TEXTURE_PROJ ( u_scene_depth , qe ) ; float cw = cv ( cu ) ; eS ( cw , eR , eA ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 eX = GLSL_TEXTURE ( u_refractmap , eR ) . rgb ; bY ( eX ) ; return eX ; }".split(" ")}]}}]}]}}]}]};a["include/scale_texcoord.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"SCALE_TEXCOORD_GLSLV",
h:{a:"grp",d:[{a:"define",c:"SCALE_TEXCOORD_GLSLV",b:[""]},{a:"txt",b:"vec2 ap ( vec2 bE , vec3 Dc ) { return ( bE + 0.5 ) * Dc . xy - 0.5 ; }".split(" ")}]}}]}]};a["include/shadow.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"SHADOW_GLSLF",h:{a:"grp",d:[{a:"define",c:"SHADOW_GLSLF",b:[""]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"SHADOW_TEX_RES",b:["2048.0"]},{a:"var",c:"CSM_FADE_LAST_CASCADE",b:["0"]},{a:"var",c:"CSM_BLEND_BETWEEN_CASCADES",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},
{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"POISSON_DISK_NUM",b:["NO_SOFT_SHADOWS"]},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",e:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"procedural.glslf"}]}}]},{a:"cond",d:[{a:"if",e:["SHADOW_USAGE","SHADOW_MASK_GENERATION",
{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"const float Dd = 0.1 ; const float De = 0.1 ; const float Df = - 0.01 ; const float Dg = 0.05 ;".split(" ")},{a:"cond",d:[{a:"if",e:["POISSON_DISK_NUM","POISSON_X_16",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 Dh = vec4 ( 0.14383161 , 0.34495938 , - 0.38277543 , - 0.26496911 ) ; vec4 Di = vec4 ( 0.53742981 , 0.19984126 , 0.79197514 , - 0.094184101 ) ; vec4 Dj = vec4 ( - 0.94201624 , - 0.91588581 , - 0.2418884 , 0.44323325 ) ; vec4 Dk = vec4 ( - 0.81544232 , 0.94558609 , - 0.81409955 , 0.97484398 ) ; vec4 Dl = vec4 ( - 0.1410079 , 0.2938776 , 0.27676845 , - 0.41893023 ) ; vec4 Dm = vec4 ( - 0.4737342 , 0.78641367 , 0.19090188 , - 0.9293887 ) ; vec4 Dn = vec4 ( - 0.39906216 , 0.45771432 , 0.99706507 , - 0.97511554 ) ; vec4 Do = vec4 ( - 0.87912464 , - 0.76890725 , 0.9143759 , 0.7564837 ) ;".split(" ")}]}},
{a:"elif",e:["POISSON_DISK_NUM","POISSON_X_8",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 Dh = vec2 ( - 0.37192261 , 0.47109537 ) ; vec2 Di = vec2 ( - 0.6807477 , 0.69048062 ) ; vec2 Dj = vec2 ( 0.11615683 , - 0.91318524 ) ; vec2 Dk = vec2 ( 0.93688596 , - 0.16948928 ) ; vec2 Dl = vec2 ( - 0.89699117 , 0.74092316 ) ; vec2 Dm = vec2 ( 0.38263656 , - 0.66119884 ) ; vec2 Dn = vec2 ( - 0.08193062 , - 0.21275223 ) ; vec2 Do = vec2 ( 0.05578877 , 0.84225623 ) ;".split(" ")}]}},{a:"elif",e:["POISSON_DISK_NUM",
"POISSON_X_4",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 Dh = vec2 ( - 0.51808083 , 0.0 ) ; vec2 Di = vec2 ( 0.5741194 , 0.0 ) ; vec2 Dj = vec2 ( - 0.68048857 , 0.0 ) ; vec2 Dk = vec2 ( 0.82934988 , 0.0 ) ; vec2 Dl = vec2 ( 0.70009436 , 0.0 ) ; vec2 Dm = vec2 ( - 0.78790467 , 0.0 ) ; vec2 Dn = vec2 ( - 0.58619489 , 0.0 ) ; vec2 Do = vec2 ( 0.41902178 , 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"bool Dq ( vec2 iD , float Dp ) { return all ( lessThanEqual ( iD , vec2 ( 1.0 + Dp ) ) ) && all ( greaterThanEqual ( iD , vec2 ( 0.0 - Dp ) ) ) ; } float Dx ( float Dr , float Ds , mat2 Dt , vec3 Du , float Dv , PRECISION GLSL_SMPLR2D_SHDW Dw ) {".split(" ")},
{a:"cond",d:[{a:"if",e:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 iD , fE ; fE . x = Dr ; fE . y = Ds ; fE = Dt * fE ; iD = Du . xy + fE * Dv / SHADOW_TEX_RES ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec2 iD = Du . xy ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["CSM_SECTION1",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"if ( ! Dq ( iD , Df ) ) return 1.0 ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["GLSL3"],h:{a:"grp",d:[{a:"txt",
b:"return GLSL_TEXTURE ( Dw , vec3 ( iD , Du . z ) ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"return step ( Du . z , GLSL_TEXTURE ( Dw , iD ) . r ) ;".split(" ")}]}}]},{a:"txt",b:"} float DC ( vec3 Du , PRECISION GLSL_SMPLR2D_SHDW Dw , float Dv ) { float Dy = 0.0 ; Du . z = clamp ( Du . z , 0.0 , 1.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",e:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float Dz = C_ ( Du . xy ) . x * M_PI ; float DA = cos ( Dz ) ; float DB = sin ( Dz ) ; mat2 Dt = mat2 ( DA , DB , - DB , DA ) ; for ( int bQ = 0 ; bQ < POISSON_DISK_NUM ; bQ ++ ) { Dy += Dx ( Dh [ bQ ] , Dl [ bQ ] , Dt , Du , Dv , Dw ) ; Dy += Dx ( Di [ bQ ] , Dm [ bQ ] , Dt , Du , Dv , Dw ) ; Dy += Dx ( Dj [ bQ ] , Dn [ bQ ] , Dt , Du , Dv , Dw ) ; Dy += Dx ( Dk [ bQ ] , Do [ bQ ] , Dt , Du , Dv , Dw ) ; } return clamp ( Dy / ( float ( POISSON_DISK_NUM ) * 4.0 ) , 0.0 , 1.0 ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"return Dx ( 0.0 , 0.0 , mat2 ( 0.0 ) , Du , Dv , Dw ) ;".split(" ")}]}}]},{a:"txt",b:"} float DL ( vec3 DD , PRECISION GLSL_SMPLR2D_SHDW DE , vec3 DF , PRECISION GLSL_SMPLR2D_SHDW DG , float DH , float DI , float aF ) { float DJ , DK ; DD . z = clamp ( DD . z , 0.0 , 1.0 ) ; DF . z = clamp ( DF . z , 0.0 , 1.0 ) ; DJ = 0.0 ; DK = 0.0 ;".split(" ")},{a:"cond",d:[{a:"if",e:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float Dz = C_ ( DD . xy ) . x * M_PI ; float DA = cos ( Dz ) ; float DB = sin ( Dz ) ; mat2 Dt = mat2 ( DA , DB , - DB , DA ) ; for ( int bQ = 0 ; bQ < POISSON_DISK_NUM ; bQ ++ ) { DJ += Dx ( Dh [ bQ ] , Dl [ bQ ] , Dt , DD , DH , DE ) ; DJ += Dx ( Di [ bQ ] , Dm [ bQ ] , Dt , DD , DH , DE ) ; DJ += Dx ( Dj [ bQ ] , Dn [ bQ ] , Dt , DD , DH , DE ) ; DJ += Dx ( Dk [ bQ ] , Do [ bQ ] , Dt , DD , DH , DE ) ; } for ( int bQ = 0 ; bQ < POISSON_DISK_NUM ; bQ ++ ) { DK += Dx ( Dh [ bQ ] , Dl [ bQ ] , Dt , DF , DI , DG ) ; DK += Dx ( Di [ bQ ] , Dm [ bQ ] , Dt , DF , DI , DG ) ; DK += Dx ( Dj [ bQ ] , Dn [ bQ ] , Dt , DF , DI , DG ) ; DK += Dx ( Dk [ bQ ] , Do [ bQ ] , Dt , DF , DI , DG ) ; } DJ = mix ( DJ , DK , aF ) ; DJ /= ( float ( POISSON_DISK_NUM ) * 4.0 ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"DJ += Dx ( 0.0 , 0.0 , mat2 ( 0.0 ) , DD , DH , DE ) ; DK += Dx ( 0.0 , 0.0 , mat2 ( 0.0 ) , DF , DI , DG ) ; DJ = mix ( DJ , DK , aF ) ;".split(" ")}]}}]},{a:"txt",b:"return clamp ( DJ , 0.0 , 1.0 ) ; } float DM ( vec2 iD ) { float a = min ( iD . x , iD . y ) ; float b = min ( 1.0 - iD . x , 1.0 - iD . y ) ; return min ( a , b ) ; } float DP ( float DN , float DO ) { if ( DO >= 0.0 && DO <= De ) DN = ( DN - 1.0 ) / De * DO + 1.0 ; return DN ; } float DU ( vec3 DQ , vec3 DR , PRECISION GLSL_SMPLR2D_SHDW DE , PRECISION GLSL_SMPLR2D_SHDW DG , float DH , float DI , float DS , float gt ) { float DN ;".split(" ")},
{a:"cond",d:[{a:"if",e:["CSM_BLEND_BETWEEN_CASCADES"],h:{a:"grp",d:[{a:"txt",b:"float DO = DM ( DQ . xy ) ; if ( - gt > DS && DO >= 0.0 && DO <= Dd && Dq ( DR . xy , 0.0 ) ) { float DT = 1.0 - DO / Dd ; DN = DL ( DQ , DE , DR , DG , DH , DI , DT ) ; } else".split(" ")}]}}]},{a:"txt",b:"DN = DC ( DQ , DE , DH ) ; return DN ; } float DW ( vec3 DV , PRECISION GLSL_SMPLR2D_SHDW Dw , float Dv , float DS , float gt ) { float DN = DC ( DV , Dw , Dv ) ;".split(" ")},{a:"cond",d:[{a:"if",e:["CSM_FADE_LAST_CASCADE"],
h:{a:"grp",d:[{a:"txt",b:"if ( - gt > DS ) { float DO = DM ( DV . xy ) ; DN = DP ( DN , DO ) ; }".split(" ")}]}}]},{a:"txt",b:"return DN ; } vec4 dE ( float gt ) { float DN = 1.0 ;".split(" ")},{a:"cond",d:[{a:"if",e:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["vec4","DX","=","u_pcf_blur_radii",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 DX = vec4 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 DD = j . xyz / j . w ; if ( j . w < 0.0 ) DD . z = 0.0 ;".split(" ")},
{a:"cond",d:[{a:"if",e:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 DF = k . xyz / k . w ; if ( k . w < 0.0 ) DF . z = 0.0 ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 DY = l . xyz / l . w ; if ( l . w < 0.0 ) DY . z = 0.0 ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 DZ = m . xyz / m . w ; if ( m . w < 0.0 ) DZ . z = 0.0 ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["CSM_SECTION1"],h:{a:"grp",d:[{a:"txt",b:"if ( Dq ( DD . xy , 0.0 ) ) { DN = DU ( DD , DF , u_shadow_map0 , u_shadow_map1 , DX [ 0 ] , DX [ 1 ] , u_csm_center_dists [ 0 ] , gt ) ; }".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"if ( Dq ( DD . xy , Dg ) ) { DN = DW ( DD , u_shadow_map0 , DX [ 0 ] , u_csm_center_dists [ 0 ] , gt ) ; }".split(" ")}]}}]},{a:"cond",
d:[{a:"if",e:["CSM_SECTION1"],h:{a:"grp",d:[{a:"txt",b:"else { if ( Dq ( DF . xy , 0.0 ) ) {".split(" ")},{a:"cond",d:[{a:"if",e:["CSM_SECTION2"],h:{a:"grp",d:[{a:"txt",b:"DN = DU ( DF , DY , u_shadow_map1 , u_shadow_map2 , DX [ 1 ] , DX [ 2 ] , u_csm_center_dists [ 1 ] , gt ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"DN = DW ( DF , u_shadow_map1 , DX [ 1 ] , u_csm_center_dists [ 1 ] , gt ) ;".split(" ")}]}}]},{a:"txt",b:["}"]},{a:"cond",d:[{a:"if",e:["CSM_SECTION2"],h:{a:"grp",d:[{a:"txt",
b:"else { if ( Dq ( DY . xy , 0.0 ) ) {".split(" ")},{a:"cond",d:[{a:"if",e:["CSM_SECTION3"],h:{a:"grp",d:[{a:"txt",b:"DN = DU ( DY , DZ , u_shadow_map2 , u_shadow_map3 , DX [ 2 ] , DX [ 3 ] , u_csm_center_dists [ 2 ] , gt ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"DN = DW ( DY , u_shadow_map2 , DX [ 2 ] , u_csm_center_dists [ 2 ] , gt ) ;".split(" ")}]}}]},{a:"txt",b:["}"]},{a:"cond",d:[{a:"if",e:["CSM_SECTION3"],h:{a:"grp",d:[{a:"txt",b:"else { if ( Dq ( DZ . xy , 0.0 ) ) DN = DW ( DZ , u_shadow_map3 , DX [ 3 ] , u_csm_center_dists [ 3 ] , gt ) ; }".split(" ")}]}}]},
{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"cond",d:[{a:"if",e:["NUM_CAST_LAMPS",1,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float D_ = DC ( DF , u_shadow_map1 , DX [ 0 ] ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["float","D_","=","0.0",";"]}]}}]},{a:"cond",d:[{a:"if",e:["NUM_CAST_LAMPS",2,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float Ea = DC ( DY , u_shadow_map2 , DX [ 0 ] ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["float","Ea","=","0.0",";"]}]}}]},{a:"cond",
d:[{a:"if",e:["NUM_CAST_LAMPS",3,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float Eb = DC ( DZ , u_shadow_map3 , DX [ 0 ] ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["float","Eb","=","1.0",";"]}]}}]},{a:"txt",b:"return vec4 ( DN , D_ , Ea , Eb ) ; }".split(" ")}]}}]},{a:"txt",b:"vec4 ch ( inout vec3 cd ) {".split(" ")},{a:"cond",d:[{a:"if",e:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 Dy = GLSL_TEXTURE ( u_shadow_mask , h . xy / h . z ) ;".split(" ")},
{a:"cond",d:[{a:"if",e:["NUM_CAST_LAMPS",3,{a:"l_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"cd *= Dy . a ;".split(" ")}]}}]},{a:"txt",b:["return","Dy",";"]}]}},{a:"elif",e:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 Dy = dE ( d . z ) ; return Dy ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"return vec4 ( 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]};a["include/shadow.glslv"]=
{a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"SHADOW_GLSLV",h:{a:"grp",d:[{a:"define",c:"SHADOW_GLSLV",b:[""]},{a:"var",c:"MAC_OS_SHADOW_HACK",b:["0"]},{a:"var",c:"SHADOW_TEX_RES",b:["2048.0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",e:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE",
"SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"math.glslv"},{a:"txt",b:"vec4 Ef ( mat4 Ec , vec4 Ed , mat4 Ee ) { vec2 dG = ( Ec * Ee [ 3 ] ) . xy ; float dH = SHADOW_TEX_RES / 2.0 ; dG = floor ( dG * dH + 0.5 ) / dH - dG ; vec4 Du = Ec * Ed ; Du . xy += dG ; Du . xyz = 0.5 * ( Du . xyz + Du . w ) ; return Du ; } void bD ( vec3 fj , vec3 Eg ) {".split(" ")},{a:"cond",d:[{a:"if",e:["MAC_OS_SHADOW_HACK"],h:{a:"grp",d:[{a:"txt",b:"mat4 Ee = aV ( u_v_light_tsr [ 0 ] ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"mat4 Ee = aV ( mat3 ( u_v_light_ts [ 0 ] , u_v_light_r [ 0 ] , 0.0 ) ) ;".split(" ")}]}}]},{a:"txt",b:"vec4 Eh = Ee * vec4 ( fj + u_normal_offset * Eg , 1.0 ) ; j = Ef ( u_p_light_matrix0 , Eh , Ee ) ;".split(" ")},{a:"cond",d:[{a:"if",e:["NUM_CAST_LAMPS",1,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["MAC_OS_SHADOW_HACK"],h:{a:"grp",d:[{a:"txt",b:"Ee = aV ( u_v_light_tsr [ 1 ] ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"Ee = aV ( mat3 ( u_v_light_ts [ 1 ] , u_v_light_r [ 1 ] , 0.0 ) ) ;".split(" ")}]}}]},
{a:"txt",b:"Eh = Ee * vec4 ( fj + u_normal_offset * Eg , 1.0 ) ; k = Ef ( u_p_light_matrix1 , Eh , Ee ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["NUM_CAST_LAMPS",2,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["MAC_OS_SHADOW_HACK"],h:{a:"grp",d:[{a:"txt",b:"Ee = aV ( u_v_light_tsr [ 2 ] ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"Ee = aV ( mat3 ( u_v_light_ts [ 2 ] , u_v_light_r [ 2 ] , 0.0 ) ) ;".split(" ")}]}}]},{a:"txt",b:"Eh = Ee * vec4 ( fj + u_normal_offset * Eg , 1.0 ) ; l = Ef ( u_p_light_matrix2 , Eh , Ee ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",e:["NUM_CAST_LAMPS",3,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["MAC_OS_SHADOW_HACK"],h:{a:"grp",d:[{a:"txt",b:"Ee = aV ( u_v_light_tsr [ 3 ] ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"Ee = aV ( mat3 ( u_v_light_ts [ 3 ] , u_v_light_r [ 3 ] , 0.0 ) ) ;".split(" ")}]}}]},{a:"txt",b:"Eh = Ee * vec4 ( fj + u_normal_offset * Eg , 1.0 ) ; m = Ef ( u_p_light_matrix3 , Eh , Ee ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["CSM_SECTION1"],h:{a:"grp",d:[{a:"txt",
b:"k = Ef ( u_p_light_matrix1 , Eh , Ee ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["CSM_SECTION2"],h:{a:"grp",d:[{a:"txt",b:"l = Ef ( u_p_light_matrix2 , Eh , Ee ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["CSM_SECTION3"],h:{a:"grp",d:[{a:"txt",b:"m = Ef ( u_p_light_matrix3 , Eh , Ee ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]}}]}]};a["include/skin.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"SKIN_GLSLV",h:{a:"grp",d:[{a:"define",c:"SKIN_GLSLV",b:[""]},{a:"var",c:"DISABLE_TANGENT_SKINNING",
b:["0"]},{a:"var",c:"SKINNED",b:["0"]},{a:"var",c:"FRAMES_BLENDING",b:["0"]},{a:"cond",d:[{a:"if",e:["SKINNED"],h:{a:"grp",d:[{a:"include",o:"math.glslv"},{a:"define",c:"SKIN_SLERP",b:["0"]},{a:"cond",d:[{a:"if",e:["SKIN_SLERP"],h:{a:"grp",d:[{a:"txt",b:"vec4 Ep ( in vec4 hk , in vec4 Ei , in float Ej ) { float Ek = hk [ 0 ] * Ei [ 0 ] + hk [ 1 ] * Ei [ 1 ] + hk [ 2 ] * Ei [ 2 ] + hk [ 3 ] * Ei [ 3 ] ; if ( Ek < 0.0 ) { Ei *= - 1.0 ; Ek = - Ek ; } if ( abs ( Ek ) >= 1.0 ) return hk ; float El = acos ( Ek ) ; float Em = sqrt ( 1.0 - Ek * Ek ) ; if ( abs ( Em ) < 0.001 ) return vec4 ( hk * 0.5 + Ei * 0.5 ) ; float En = sin ( ( 1.0 - Ej ) * El ) / Em ; float Eo = sin ( Ej * El ) / Em ; return hk * En + Ei * Eo ; }".split(" ")}]}}]},
{a:"cond",d:[{a:"if",e:["FRAMES_BLENDING"],h:{a:"grp",d:[{a:"txt",b:"vec3 ED ( in vec3 O , in vec4 Eq , in vec4 Er , in vec4 Es , in vec4 Et , in float Eu ) { vec3 Ev = pW ( u_arm_rel_trans , u_arm_rel_quat , O ) ;".split(" ")},{a:"cond",d:[{a:"if",e:["SKIN_SLERP"],h:{a:"grp",d:[{a:"txt",b:"vec4 hk = Ep ( Eq , Er , Eu ) ; vec4 Ew = mix ( Es , Et , Eu ) ; vec3 Ex = P ( hk , Ev ) ; vec3 Ey = Ex * Ew . w + Ew . xyz ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Ez = P ( Eq , Ev ) ; vec3 EA = P ( Er , Ev ) ; vec3 EB = Ez * Es . w + Es . xyz ; vec3 EC = EA * Et . w + Et . xyz ; vec3 Ey = mix ( EB , EC , Eu ) ;".split(" ")}]}}]},
{a:"txt",b:"return pZ ( u_arm_rel_trans , u_arm_rel_quat , Ey ) ; } vec3 EJ ( in vec3 EE , in vec4 Eq , in vec4 Er , in float Eu ) { vec3 EF = pY ( u_arm_rel_trans , u_arm_rel_quat , EE ) ;".split(" ")},{a:"cond",d:[{a:"if",e:["SKIN_SLERP"],h:{a:"grp",d:[{a:"txt",b:"vec4 hk = Ep ( Eq , Er , Eu ) ; vec3 EG = P ( hk , EF ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 EH = P ( Eq , EF ) ; vec3 EI = P ( Er , EF ) ; vec3 EG = mix ( EH , EI , Eu ) ;".split(" ")}]}}]},{a:"txt",b:"return p_ ( u_arm_rel_trans , u_arm_rel_quat , EG ) ; }".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 ED ( in vec3 O , in vec4 Eq , in vec4 Es ) { vec3 Ev = pW ( u_arm_rel_trans , u_arm_rel_quat , O ) ; vec3 Ex = P ( Eq , Ev ) ; vec3 Ey = Ex * Es . w + Es . xyz ; return pZ ( u_arm_rel_trans , u_arm_rel_quat , Ey ) ; } vec3 EJ ( in vec3 EE , in vec4 Eq ) { vec3 EF = pY ( u_arm_rel_trans , u_arm_rel_quat , EE ) ; vec3 EG = P ( Eq , EF ) ; return p_ ( u_arm_rel_trans , u_arm_rel_quat , EG ) ; }".split(" ")}]}}]},{a:"txt",b:"void ac ( inout vec3 O , inout vec3 R , inout vec3 S , inout vec3 Q ) {".split(" ")},
{a:"cond",d:[{a:"if",e:["FRAMES_BLENDING"],h:{a:"grp",d:[{a:"txt",b:["float","EK","=","u_frame_factor",";"]}]}}]},{a:"txt",b:"if ( a_influence . y > 0.0 ) { vec3 jw = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec3 EL = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec3 EM = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec3 EN = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec4 EO = a_influence ; for ( int bQ = 0 ; bQ < 4 ; bQ ++ ) { int EP = int ( EO [ bQ ] ) ; float EQ = fract ( EO [ bQ ] ) ;".split(" ")},{a:"cond",d:[{a:"if",e:["FRAMES_BLENDING"],h:{a:"grp",d:[{a:"txt",
b:"EL += EQ * EJ ( R , u_quatsb [ EP ] , u_quatsa [ EP ] , EK ) ; EM += EQ * EJ ( S , u_quatsb [ EP ] , u_quatsa [ EP ] , EK ) ; EN += EQ * EJ ( Q , u_quatsb [ EP ] , u_quatsa [ EP ] , EK ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"jw += EQ * ED ( O , u_quatsb [ EP ] , u_transb [ EP ] ) ; EN += EQ * EJ ( Q , u_quatsb [ EP ] ) ;".split(" ")},{a:"cond",d:[{a:"if",e:["DISABLE_TANGENT_SKINNING",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"EL += EQ * EJ ( R , u_quatsb [ EP ] ) ; EM += EQ * EJ ( S , u_quatsb [ EP ] ) ;".split(" ")}]}}]}]}}]},
{a:"txt",b:["}"]},{a:"cond",d:[{a:"if",e:["FRAMES_BLENDING"],h:{a:"grp",d:[{a:"txt",b:"int EP = int ( EO [ 0 ] ) ; float EQ = fract ( EO [ 0 ] ) ; jw += EQ * ED ( O , u_quatsb [ EP ] , u_quatsa [ EP ] , u_transb [ EP ] , u_transa [ EP ] , EK ) ; EP = int ( EO [ 1 ] ) ; EQ = fract ( EO [ 1 ] ) ; jw += EQ * ED ( O , u_quatsb [ EP ] , u_quatsa [ EP ] , u_transb [ EP ] , u_transa [ EP ] , EK ) ; EP = int ( EO [ 2 ] ) ; EQ = fract ( EO [ 2 ] ) ; jw += EQ * ED ( O , u_quatsb [ EP ] , u_quatsa [ EP ] , u_transb [ EP ] , u_transa [ EP ] , EK ) ; EP = int ( EO [ 3 ] ) ; EQ = fract ( EO [ 3 ] ) ; jw += EQ * ED ( O , u_quatsb [ EP ] , u_quatsa [ EP ] , u_transb [ EP ] , u_transa [ EP ] , EK ) ;".split(" ")}]}}]},
{a:"txt",b:"O = jw ; Q = EN ;".split(" ")},{a:"cond",d:[{a:"if",e:["DISABLE_TANGENT_SKINNING",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"R = EL ; S = EM ;".split(" ")}]}}]},{a:"txt",b:"} if ( ! ( a_influence . y > 0.0 ) ) { int ER = int ( a_influence [ 0 ] - 1.0 ) ; if ( ER > - 1 ) {".split(" ")},{a:"cond",d:[{a:"if",e:["FRAMES_BLENDING"],h:{a:"grp",d:[{a:"txt",b:"O = ED ( O , u_quatsb [ ER ] , u_quatsa [ ER ] , u_transb [ ER ] , u_transa [ ER ] , EK ) ; R = EJ ( R , u_quatsb [ ER ] , u_quatsa [ ER ] , EK ) ; S = EJ ( S , u_quatsb [ ER ] , u_quatsa [ ER ] , EK ) ; Q = EJ ( Q , u_quatsb [ ER ] , u_quatsa [ ER ] , EK ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"O = ED ( O , u_quatsb [ ER ] , u_transb [ ER ] ) ; Q = EJ ( Q , u_quatsb [ ER ] ) ;".split(" ")},{a:"cond",d:[{a:"if",e:["DISABLE_TANGENT_SKINNING",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"R = EJ ( R , u_quatsb [ ER ] ) ; S = EJ ( S , u_quatsb [ ER ] ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:["}","}","}"]}]}}]}]}}]}]};a["include/std.glsl"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"STD_ENUMS_GLSL",h:{a:"grp",d:[{a:"define",c:"STD_ENUMS_GLSL",b:[""]},{a:"var",
c:"CONSTANTS_HACK",b:["0"]},{a:"define",c:"TEXTURE_COORDS_NONE",b:["0"]},{a:"define",c:"TEXTURE_COORDS_UV_ORCO",b:["1"]},{a:"define",c:"TEXTURE_COORDS_NORMAL",b:["2"]},{a:"define",c:"TEXTURE_BLEND_TYPE_MIX",b:["1"]},{a:"define",c:"TEXTURE_BLEND_TYPE_MULTIPLY",b:["2"]},{a:"define",c:"SHADOW_SRC_NONE",b:["1"]},{a:"define",c:"SHADOW_SRC_DEPTH",b:["2"]},{a:"define",c:"SHADOW_SRC_MASK",b:["3"]},{a:"define",c:"SHADOW_DST_NONE",b:["1"]},{a:"define",c:"SHADOW_DST_DEPTH",b:["2"]},{a:"define",c:"SHADOW_DST_MASK",
b:["3"]},{a:"define",c:"NO_SHADOWS",b:["1"]},{a:"define",c:"SHADOW_CASTING",b:["2"]},{a:"define",c:"SHADOW_MASK_GENERATION",b:["3"]},{a:"define",c:"SHADOW_MAPPING_OPAQUE",b:["4"]},{a:"define",c:"SHADOW_MAPPING_BLEND",b:["5"]},{a:"define",c:"POISSON_X_16",b:["4"]},{a:"define",c:"POISSON_X_8",b:["2"]},{a:"define",c:"POISSON_X_4",b:["1"]},{a:"define",c:"NO_SOFT_SHADOWS",b:["0"]},{a:"define",c:"SPECULAR_PHONG",b:["1"]},{a:"define",c:"SPECULAR_COOKTORR",b:["2"]},{a:"define",c:"SPECULAR_WARDISO",b:["3"]},
{a:"define",c:"SPECULAR_BLINN",b:["4"]},{a:"define",c:"SPECULAR_TOON",b:["5"]},{a:"define",c:"DIFFUSE_LAMBERT",b:["1"]},{a:"define",c:"DIFFUSE_OREN_NAYAR",b:["2"]},{a:"define",c:"DIFFUSE_FRESNEL",b:["3"]},{a:"define",c:"DIFFUSE_MINNAERT",b:["4"]},{a:"define",c:"DIFFUSE_TOON",b:["5"]},{a:"define",c:"MIX",b:["0"]},{a:"define",c:"ADD",b:["1"]},{a:"define",c:"SUBTRACT",b:["2"]},{a:"define",c:"MULTIPLY",b:["3"]},{a:"define",c:"SCREEN",b:["4"]},{a:"define",c:"OVERLAY",b:["5"]},{a:"define",c:"DIFFERENCE",
b:["6"]},{a:"define",c:"DIVIDE",b:["7"]},{a:"define",c:"DARKEN",b:["8"]},{a:"define",c:"LIGHTEN",b:["9"]},{a:"define",c:"HUE",b:["10"]},{a:"define",c:"SATURATION",b:["11"]},{a:"define",c:"VALUE",b:["12"]},{a:"define",c:"COLOR",b:["13"]},{a:"define",c:"SOFT_LIGHT",b:["14"]},{a:"define",c:"LINEAR_LIGHT",b:["15"]},{a:"define",c:"REFL_NONE",b:["0"]},{a:"define",c:"REFL_MIRRORMAP",b:["1"]},{a:"define",c:"REFL_PLANE",b:["2"]},{a:"define",c:"REFL_CUBE",b:["3"]},{a:"define",c:"INVERSE_QUADRATIC",b:["0"]},
{a:"define",c:"LINEAR",b:["1"]},{a:"define",c:"QUADRATIC",b:["2"]},{a:"define",c:"HEMI",b:["1"]},{a:"define",c:"SPOT",b:["2"]},{a:"define",c:"POINT",b:["3"]},{a:"define",c:"SUN",b:["4"]},{a:"define",c:"DOF_SIMPLE",b:["0"]},{a:"define",c:"DOF_BOKEH",b:["1"]},{a:"define",c:"COC_ALL",b:["0"]},{a:"define",c:"COC_FOREGROUND",b:["1"]},{a:"define",c:"COC_COMBINE",b:["2"]},{a:"define",c:"VT_WORLD_TO_WORLD",b:["0"]},{a:"define",c:"VT_WORLD_TO_OBJECT",b:["1"]},{a:"define",c:"VT_WORLD_TO_CAMERA",b:["2"]},{a:"define",
c:"VT_OBJECT_TO_WORLD",b:["3"]},{a:"define",c:"VT_OBJECT_TO_OBJECT",b:["4"]},{a:"define",c:"VT_OBJECT_TO_CAMERA",b:["5"]},{a:"define",c:"VT_CAMERA_TO_WORLD",b:["6"]},{a:"define",c:"VT_CAMERA_TO_OBJECT",b:["7"]},{a:"define",c:"VT_CAMERA_TO_CAMERA",b:["8"]},{a:"define",c:"VT_POINT",b:["0"]},{a:"define",c:"VT_VECTOR",b:["1"]},{a:"define",c:"VT_NORMAL",b:["2"]},{a:"define",c:"NM_TANGENT",b:["0"]},{a:"define",c:"NM_OBJECT",b:["1"]},{a:"define",c:"NM_WORLD",b:["2"]},{a:"define",c:"NM_BLENDER_OBJECT",b:["3"]},
{a:"define",c:"NM_BLENDER_WORLD",b:["4"]},{a:"define",c:"BILLBOARD_ALIGN_VIEW",b:["1"]},{a:"define",c:"BILLBOARD_ALIGN_XY",b:["2"]},{a:"define",c:"BILLBOARD_ALIGN_YZ",b:["3"]},{a:"define",c:"BILLBOARD_ALIGN_ZX",b:["4"]},{a:"define",c:"POST_EFFECT_NONE",b:["1"]},{a:"define",c:"POST_EFFECT_GRAYSCALE",b:["2"]},{a:"define",c:"POST_EFFECT_BLUR",b:["3"]},{a:"define",c:"POST_EFFECT_GLOW_BLUR",b:["4"]},{a:"define",c:"POST_EFFECT_DOF_BLUR",b:["5"]},{a:"define",c:"POST_EFFECT_ALPHA_BLUR",b:["6"]},{a:"define",
c:"POST_EFFECT_EXTEND",b:["7"]},{a:"define",c:"FLIP_CUBEMAP_COORDS",b:["8"]},{a:"define",c:"DV_NONE",b:["0"]},{a:"define",c:"DV_OPAQUE_WIREFRAME",b:["1"]},{a:"define",c:"DV_TRANSPARENT_WIREFRAME",b:["2"]},{a:"define",c:"DV_FRONT_BACK_VIEW",b:["3"]},{a:"define",c:"DV_BOUNDINGS",b:["4"]},{a:"define",c:"DV_CLUSTERS_VIEW",b:["5"]},{a:"define",c:"DV_BATCHES_VIEW",b:["6"]},{a:"define",c:"DV_RENDER_TIME",b:["7"]},{a:"define",c:"SSAO_QUALITY_8",b:["1"]},{a:"define",c:"SSAO_QUALITY_16",b:["2"]},{a:"define",
c:"SSAO_QUALITY_24",b:["3"]},{a:"define",c:"SSAO_QUALITY_32",b:["4"]},{a:"define",c:"AA_METHOD_FXAA_LIGHT",b:["1"]},{a:"define",c:"AA_METHOD_FXAA_QUALITY",b:["2"]},{a:"define",c:"AA_QUALITY_LOW",b:["0"]},{a:"define",c:"AA_QUALITY_MEDIUM",b:["1"]},{a:"define",c:"AA_QUALITY_HIGH",b:["2"]},{a:"define",c:"SMAA_RESOLVE",b:["1"]},{a:"define",c:"SMAA_EDGE_DETECTION",b:["2"]},{a:"define",c:"SMAA_BLENDING_WEIGHT_CALCULATION",b:["3"]},{a:"define",c:"SMAA_NEIGHBORHOOD_BLENDING",b:["4"]},{a:"define",c:"AA_METHOD_SMAA_LOW",
b:["1"]},{a:"define",c:"AA_METHOD_SMAA_MEDIUM",b:["2"]},{a:"define",c:"AA_METHOD_SMAA_HIGH",b:["3"]},{a:"define",c:"AA_METHOD_SMAA_ULTRA",b:["4"]},{a:"define",c:"REFL_PASS_NONE",b:["0"]},{a:"define",c:"REFL_PASS_PLANE",b:["1"]},{a:"define",c:"REFL_PASS_CUBE",b:["2"]},{a:"define",c:"M_PI",b:["3.14159265359"]},{a:"define",c:"M_PI_4",b:["0.785398163"]},{a:"define",c:"INV_PI",b:["0.318309886"]},{a:"define",c:"UP_VECTOR",b:"vec3 ( 0.0 , 0.0 , 1.0 )".split(" ")},{a:"define",c:"RIGHT_VECTOR",b:"vec3 ( 1.0 , 0.0 , 0.0 )".split(" ")},
{a:"define",c:"TOWARD_VECTOR",b:"vec3 ( 0.0 , - 1.0 , 0.0 )".split(" ")},{a:"cond",d:[{a:"if",e:["CONSTANTS_HACK"],h:{a:"grp",d:[{a:"txt",b:"float _0_0 = 0.0 ; float _0_5 = 0.5 ; float _1_0 = 1.0 ; float _255_0 = 255.0 ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"define",c:"_0_0",b:["0.0"]},{a:"define",c:"_0_5",b:["0.5"]},{a:"define",c:"_1_0",b:["1.0"]},{a:"define",c:"_255_0",b:["255.0"]}]}}]}]}}]}]};a["include/to_world.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"TO_WORLD_GLSLV",h:{a:"grp",d:[{a:"define",
c:"TO_WORLD_GLSLV",b:[""]},{a:"include",o:"math.glslv"},{a:"var",c:"BILLBOARD_ALIGN",b:["BILLBOARD_ALIGN_VIEW"]},{a:"var",c:"USE_INSTANCED_PARTCLS",b:["0"]},{a:"var",c:"BILLBOARD_SPHERICAL",b:["0"]},{a:"var",c:"BILLBOARD_RANDOM",b:["0"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"var",c:"BILLBOARD_PRES_GLOB_ORIENTATION",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"define",c:"MAX_BILLBOARD_ANGLE",b:["M_PI_4"]},{a:"cond",d:[{a:"if",e:["BILLBOARD_SPHERICAL","BILLBOARD",
{a:"logic_negative_expr",i:1},"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"mat3 bc ( vec3 ES , mat3 N ) { vec4 ET = vec4 ( N [ 1 ] [ 1 ] , N [ 1 ] [ 2 ] , N [ 2 ] [ 0 ] , N [ 2 ] [ 1 ] ) ; vec4 EU = cI ( RIGHT_VECTOR , M_PI / 2.0 ) ; ET = pP ( EU , ET ) ; ET = kn ( ET ) ; mat3 bd = cG ( ) ; bd [ 0 ] = ES ; bd = cK ( ET , bd ) ; return bd ; }".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"mat3 EW ( vec3 kP , vec3 ES ) { vec3 EV = kP - ES ; EV . z = 0.0 ; EV = normalize ( EV ) ; vec4 ET = pU ( EV , TOWARD_VECTOR ) ; mat3 bd = cG ( ) ; bd [ 0 ] = ES ; bd = cK ( ET , bd ) ; return bd ; }".split(" ")}]}}]},
{a:"cond",d:[{a:"if",e:["BILLBOARD_JITTERED"],h:{a:"grp",d:[{a:"txt",b:"mat3 aj ( in vec3 EX , float EY , float EZ , float E_ , vec3 aU , mat3 T ) { float Fa = fract ( length ( aU ) / 0.17 ) ; float Fb = E_ + Fa / 10.0 ; float Fc = Fa ; if ( E_ != 0.0 ) Fc /= E_ ; EX *= 1.0 + 0.5 * sin ( EY ) ; float Fd = length ( EX ) * EZ * sin ( 2.0 * 3.14 * EY * Fb + Fc ) ; vec4 Fe = cI ( TOWARD_VECTOR , Fd ) ; vec4 Ff = vec4 ( T [ 1 ] [ 1 ] , T [ 1 ] [ 2 ] , T [ 2 ] [ 0 ] , T [ 2 ] [ 1 ] ) ; Ff = pP ( Ff , Fe ) ; T = cK ( Ff , T ) ; return T ; }".split(" ")}]}}]},
{a:"txt",b:"mat3 ai ( in vec3 kP , in vec3 af , in mat3 N ) {".split(" ")},{a:"cond",d:[{a:"if",e:["BILLBOARD_SPHERICAL","BILLBOARD",{a:"logic_negative_expr",i:1},"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"mat3 ld = bc ( af , N ) ;".split(" ")}]}},{a:"elif",e:["BILLBOARD_RANDOM"],h:{a:"grp",d:[{a:"txt",b:"float Fa = fract ( ( af . x * 1.43 - af . z * 0.123 + af . y * 6.1 ) ) ; float Fg = 2.0 * M_PI * Fa ; vec4 Fh = vec4 ( N [ 1 ] [ 1 ] , N [ 1 ] [ 2 ] , N [ 2 ] [ 0 ] , N [ 2 ] [ 1 ] ) ; float Fi = asin ( 2.0 * ( Fh . x * Fh . y - Fh . z * Fh . w ) ) ; float hB = Fi - Fg ; if ( hB < 0.0 ) hB = 2.0 * M_PI + hB ; float Fj = Fg ; if ( hB <= MAX_BILLBOARD_ANGLE ) Fj += hB ; else if ( hB <= M_PI - MAX_BILLBOARD_ANGLE ) Fj += MAX_BILLBOARD_ANGLE * ( 2.0 * hB - M_PI ) / ( 2.0 * MAX_BILLBOARD_ANGLE - M_PI ) ; else if ( hB <= M_PI + MAX_BILLBOARD_ANGLE ) Fj += hB - M_PI ; else if ( hB <= 2.0 * M_PI - MAX_BILLBOARD_ANGLE ) Fj += MAX_BILLBOARD_ANGLE * ( 2.0 * hB - M_PI ) / ( 2.0 * MAX_BILLBOARD_ANGLE - M_PI ) + M_PI ; else Fj += hB - 2.0 * M_PI ; vec4 Fk = cI ( UP_VECTOR , Fj ) ; mat3 ld ; ld [ 0 ] = af ; ld [ 1 ] [ 0 ] = 1.0 ; ld = cK ( Fk , ld ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"mat3 ld = EW ( kP , af ) ;".split(" ")}]}}]},{a:"txt",b:["return","ld",";","}"]},{a:"cond",d:[{a:"if",e:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2},"USE_INSTANCED_PARTCLS",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"mat3 ah ( in vec3 kP , in vec3 af , in mat3 N , in mat3 T ) { mat3 ld = ai ( kP , af , N ) ; T [ 0 ] = vec3 ( 0.0 , 0.0 , 0.0 ) ; ld = aS ( ld , T ) ; return ld ; }".split(" ")}]}}]},
{a:"txt",b:"ak al ( in vec3 fj , in vec3 Fl , in vec3 Fm , in vec3 Fn , in vec3 Fo , in vec3 Fp , in mat3 T ) { fj = ae ( T , fj ) ; Fl = ae ( T , Fl ) ; Fm = U ( T , Fm ) ; Fn = U ( T , Fn ) ; Fo = U ( T , Fo ) ; Fp = U ( T , Fp ) ; return le ( ak ( fj , Fl , Fm , Fn , Fo , Fp , vec3 ( 0.0 ) ) ) ; }".split(" ")}]}}]}]};a["include/wind_bending.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"WIND_BENDING_GLSLV",h:{a:"grp",d:[{a:"define",c:"WIND_BENDING_GLSLV",b:[""]},{a:"var",c:"WIND_BEND",b:["0"]},
{a:"var",c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"var",c:"BEND_CENTER_ONLY",b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",e:["WIND_BEND"],h:{a:"grp",d:[{a:"txt",b:"void FC ( inout vec3 bi , in vec3 Fq , in float Fr , in float Fs , in float fq , in vec3 EX , in float Ft , in mat4 bx ) {".split(" ")},{a:"cond",d:[{a:"if",e:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2},"BILLBOARD",
{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 Fu = ( bx * vec4 ( bi , 1.0 ) ) . xyz ; vec3 Fv = ( bx * vec4 ( Fq , 1.0 ) ) . xyz ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Fu = bi ; vec3 Fv = Fq ;".split(" ")}]}}]},{a:"txt",b:"float dh = length ( Fv ) ; float Fw = Fs * ( 1.0 + 0.1 * fract ( dh ) ) ; float Fx = Fr * Ft * ( 1.0 + sin ( 2.0 * 3.14 * fq * Fw + dh ) ) ; float Fy = ( Fu . z - Fv . z ) * abs ( Fx ) ; Fy += 1.0 ; Fy *= Fy ; Fy = Fy * Fy - Fy ; vec3 Fz = Fu ; Fz . x += EX . x * Fy * sign ( Fx ) ; Fz . y -= EX . y * Fy * sign ( Fx ) ; vec3 FA = Fz - Fv ; if ( all ( equal ( FA , vec3 ( 0.0 ) ) ) ) bi = Fq ; else {".split(" ")},
{a:"cond",d:[{a:"if",e:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2},"BILLBOARD",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"FA = ( bx * vec4 ( FA , 0.0 ) ) . xyz ;".split(" ")}]}}]},{a:"txt",b:"float FB = length ( Fu - Fv ) ; bi = Fq + normalize ( FA ) * FB ; } }".split(" ")},{a:"cond",d:[{a:"if",e:["DETAIL_BEND"],h:{a:"grp",d:[{a:"txt",b:"vec4 FD ( vec4 x ) { return x * x * ( 3.0 - 2.0 * x ) ; } vec4 FE ( vec4 x ) { return abs ( fract ( x + 0.5 ) * 2.0 - 1.0 ) ; } vec4 FF ( vec4 x ) { return FD ( FE ( x ) ) ; } void FR ( inout vec3 bi , in float fq , in vec3 Q , in vec3 EX , in vec3 Fq , in float FG , in float FH , in float FI , in vec3 FJ , in mat4 bx ) { float FK ; float FL ; float FM ; vec2 FN ; vec4 FO ; vec2 FP ; vec3 FQ ;".split(" ")},
{a:"cond",d:[{a:"if",e:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2},"BILLBOARD",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 Fu = ( bx * vec4 ( bi , 1.0 ) ) . xyz ; vec3 Fv = ( bx * vec4 ( Fq , 1.0 ) ) . xyz ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Fu = bi ; vec3 Fv = Fq ;".split(" ")}]}}]},{a:"txt",b:"FK = dot ( Fv , vec3 ( 1.0 ) ) ; FL = FK + FJ . g ; FM = dot ( Fu , vec3 ( FJ . g ) ) ; FN = ( fq + vec2 ( FM , FL ) ) ; FO = ( ( fract ( ( FN . xxyy * vec4 ( 1.975 , 0.793 , 0.375 , 0.193 ) ) ) * 2.0 ) - 1.0 ) * length ( EX ) * FG ; FO = FF ( FO ) ; FP = FO . xz + FO . yw ; FP . y = 0.5 - FP . y ; FQ = FP . xxy * FJ . rrb * vec3 ( FH * Q . x , FH * Q . y , FI ) ;".split(" ")},
{a:"cond",d:[{a:"if",e:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2},"BILLBOARD",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"FQ = ( bx * vec4 ( FQ , 0.0 ) ) . xyz ;".split(" ")}]}}]},{a:"txt",b:["bi","+=","FQ",";","}"]}]}}]},{a:"txt",b:"void an ( inout vec3 O , inout vec3 ad , in vec3 Q , in mat4 bx ) { vec3 FS = u_wind * 1.0 + 0.7 * sin ( u_time ) ;".split(" ")},{a:"cond",d:[{a:"if",e:["BEND_CENTER_ONLY"],h:{a:"grp",d:[{a:"txt",b:"vec3 FT = ad ; vec3 FU = a_emitter_center ;".split(" ")},
{a:"cond",d:[{a:"if",e:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2},"BILLBOARD",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"FU = ( bx * vec4 ( FU , 1.0 ) ) . xyz ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 FT = O ; vec3 FU = ad ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["MAIN_BEND_COL"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",e:["DETAIL_BEND"],h:{a:"grp",d:[{a:"txt",b:"FR ( FT , u_time , Q , FS , FU , au_detail_bending_freq , au_detail_bending_amp , au_branch_bending_amp , a_bending_col_detail , bx ) ;".split(" ")}]}}]},
{a:"txt",b:"FC ( FT , FU , au_wind_bending_amp , au_wind_bending_freq , u_time , FS , a_bending_col_main , bx ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"FC ( FT , FU , au_wind_bending_amp , au_wind_bending_freq , u_time , FS , 1.0 , bx ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",e:["BEND_CENTER_ONLY"],h:{a:"grp",d:[{a:"txt",b:"O += FT - ad ; ad = FT ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"O = FT ; ad = FU ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]}}]}]}};b4w.module.animation=function(a,q){var e=q("__animation"),c=q("__armature"),b=q("__obj_util"),n=q("__print"),f=q("__tsr");a.SLOT_0=e.SLOT_0;a.SLOT_1=e.SLOT_1;a.SLOT_2=e.SLOT_2;a.SLOT_3=e.SLOT_3;a.SLOT_4=e.SLOT_4;a.SLOT_5=e.SLOT_5;a.SLOT_6=e.SLOT_6;a.SLOT_7=e.SLOT_7;a.SLOT_ALL=e.SLOT_ALL;a.OBJ_ANIM_TYPE_NONE=e.OBJ_ANIM_TYPE_NONE;a.OBJ_ANIM_TYPE_ARMATURE=e.OBJ_ANIM_TYPE_ARMATURE;a.OBJ_ANIM_TYPE_OBJECT=e.OBJ_ANIM_TYPE_OBJECT;a.OBJ_ANIM_TYPE_VERTEX=e.OBJ_ANIM_TYPE_VERTEX;a.OBJ_ANIM_TYPE_SOUND=e.OBJ_ANIM_TYPE_SOUND;
a.OBJ_ANIM_TYPE_PARTICLES=e.OBJ_ANIM_TYPE_PARTICLES;a.OBJ_ANIM_TYPE_MATERIAL=e.OBJ_ANIM_TYPE_MATERIAL;a.AB_CYCLIC=e.AB_CYCLIC;a.AB_FINISH_RESET=e.AB_FINISH_RESET;a.AB_FINISH_STOP=e.AB_FINISH_STOP;var t=f.create();a.is_animated=function(a){return e.is_animated(a)};a.get_anim_names=function(a){return e.iB(a)?e.get_anim_names(a):[]};a.get_current_anim_name=function(a,b){if(!e.is_animated(a))return null;b=b||e.SLOT_0;return e.LJ(a,b)};a.apply=function(a,b,c){if(c>e.SLOT_7)n.error("Can't apply animation to slot "+
c+' for object "'+a.name+'". Object can have maximum of 8 animation slots');else{c=c||e.SLOT_0;if(e.is_animated(a)){var f=e.get_slot_num_by_anim(a,b);if(-1!=f&&f!=c){n.error('Animation "'+b+'" is already applied to object "'+a.name+'" (slot "'+f+'").');return}}e.gD(a,b)?e.apply(a,null,b,c):n.error('No fcurves in action "'+b+'"')}};a.apply_ext=function(a,b,c){if(c>e.SLOT_7)n.error("Can't apply animation to slot "+c+' for object "'+a.name+'". Object can have maximum of 8 animation slots');else{c=c||
e.SLOT_0;var f=b[0];if(e.is_animated(a)){var d=e.get_slot_num_by_anim(a,f);if(-1!=d&&d!=c){n.error('Animation "'+f+'" is already applied to object "'+a.name+'" (slot "'+d+'").');return}}e.gD(a,f)?e.apply(a,b.slice(1),f,c):n.error('No fcurves in action "'+f+'"')}};a.remove=function(a){e.remove(a)};a.remove_slot_animation=function(a,b){e.is_animated(a)&&(b=b||e.SLOT_0,e.remove_slot_animation(a,b))};a.apply_def=function(a){e.apply_def(a)};a.play=function(a,b,c){e.is_animated(a)?(c=c||e.SLOT_0,e.play(a,
b,c),e.yO(a,0,c,!0)):n.error('Object "'+a.name+'" has no applied animation')};a.stop=function(a,b){e.is_animated(a)&&(b=b||e.SLOT_0,e.stop(a,b))};a.is_play=function(a,b){if(!e.is_animated(a))return!1;b=b||e.SLOT_0;return e.is_play(a,b)};a.set_frame=function(a,b,c){e.is_animated(a)&&(c=c||e.SLOT_0,e.set_frame(a,b,c))};a.set_first_frame=function(a,b){e.is_animated(a)&&e.set_first_frame(a,b)};a.set_last_frame=function(a,b){if(e.is_animated(a)){b=b||e.SLOT_0;var c=e.get_anim_start_frame(a,b),f=e.get_anim_length(a,
b);e.set_frame(a,c+f-e.$D,b)}};a.get_frame=function(a,b){if(!e.is_animated(a))return 0;b=b||e.SLOT_0;return e.Uz(a,b)};a.set_speed=function(a,b,c){e.is_animated(a)&&(c=c||e.SLOT_0,e.set_speed(a,b||1,c))};a.get_speed=function(a,b){if(!e.is_animated(a))return 0;b=b||e.SLOT_0;return a.X[b]?e.get_speed(a,b):0};a.get_anim_start_frame=function(a,b){return e.is_animated(a)&&(b=b||e.SLOT_0,a.X[b])?e.get_anim_start_frame(a,b):-1};a.get_anim_length=function(a,b){return e.is_animated(a)&&(b=b||e.SLOT_0,a.X[b])?
e.get_anim_length(a,b):-1};a.set_behavior=function(a,b,c){e.is_animated(a)&&(c=c||e.SLOT_0,e.set_behavior(a,b,c))};a.get_behavior=function(a,b){if(!e.is_animated(a))return null;b=b||e.SLOT_0;return e.get_behavior(a,b)};a.apply_smoothing=function(a,b,c,f){f=f||e.SLOT_0;e.is_animated(a)&&e.apply_smoothing(a,b,c,f)};a.frame_to_sec=function(a){return e.frame_to_sec(a)};a.get_bone_translation=function(a,e,f){n.tb("get_bone_translation","armature.get_bone_tsr");if(!b.is_armature(a))return null;if(!c.An(a,
e))return n.error('There is no bone: "',e,'" in "',a.name,'".'),null;f||(f=new Float32Array(3));c.get_bone_tsr(a,e,!1,!1,t);f[0]=t[0];f[1]=t[1];f[2]=t[2];return f};a.get_first_armature_object=function(){n.uc("get_first_armature_object() deprecated");return null};a.get_slot_num_by_anim=function(a,b){return e.is_animated(a)&&b?e.get_slot_num_by_anim(a,b):null};a.get_anim_type=function(a,b){return e.is_animated(a)?e.get_anim_type(a,b):null};a.apply_to_first_empty_slot=function(a,b){return e.apply_to_first_empty_slot(a,
b)};a.get_skel_mix_factor=function(a){return a.k.qg};a.set_skel_mix_factor=function(a,c,f){b.is_armature(a)?(c=Math.min(Math.max(c,0),1),a.k.qg!=c&&e.set_skel_mix_factor(a,c,f||0)):n.error("Can't blend animation. Object \""+a.name+'" is not armature')}};b4w.module.anchors=function(a,q){var e=q("__anchors");q("__print");a.attach_move_cb=e.attach_move_cb;a.detach_move_cb=e.detach_move_cb;a.is_anchor=e.is_anchor;a.get_element_id=e.get_element_id};b4w.module.armature=function(a,q){var e=q("__armature"),c=q("__obj_util"),b=q("__transform"),n=q("__print");a.get_bone_tsr=function(a,b,g){if(!c.is_armature(a))return null;if(!e.An(a,b))return n.error('There is no bone: "',b,'" in "',a.name,'".'),null;g||(g=new Float32Array(8));e.get_bone_tsr(a,b,!1,!1,g);return g};a.get_bone_tsr_rel=function(a,b,g){if(!c.is_armature(a))return null;if(!e.An(a,b))return n.error('There is no bone: "',b,'" in "',a.name,'".'),null;g||(g=new Float32Array(8));e.get_bone_tsr(a,
b,!1,!0,g);return g};a.set_bone_tsr=function(a,q,g){c.is_armature(a)&&(e.An(a,q)?(e.set_bone_tsr(a,q,g,!1),b.A(a)):n.error('There is no bone: "',q,'" in "',a.name,'".'))};a.set_bone_tsr_rel=function(a,q,g){c.is_armature(a)&&(e.An(a,q)?(e.set_bone_tsr(a,q,g,!0),b.A(a)):n.error('There is no bone: "',q,'" in "',a.name,'".'))}};b4w.module.assets=function(a,q){var e=q("__assets");a.AT_ARRAYBUFFER=e.AT_ARRAYBUFFER;a.AT_JSON=e.AT_JSON;a.AT_TEXT=e.AT_TEXT;a.AT_AUDIOBUFFER=e.AT_AUDIOBUFFER;a.AT_IMAGE_ELEMENT=e.AT_IMAGE_ELEMENT;a.AT_AUDIO_ELEMENT=e.AT_AUDIO_ELEMENT;a.enqueue=function(a,b,n,f){if(a.length)if(a.id)e.enqueue(a,b,n,f);else{for(var q=[],g=0;g<a.length;g++){var m=a[g];q.push({id:m[0],type:m[1],url:m[2],qe:m.qe?m.qe:"GET",Ti:null,Fh:null,Mb:m[3]})}e.enqueue(q,b,n,f)}}};b4w.module.camera=function(a,q){function e(a,b){v.tb("camera.set_pivot","camera.target_set_trans_pivot");c.is_target_camera(a)?(C.copy(b,a.k.pivot),d.A(a),m.sync_transform(a)):v.error("set_pivot(): Wrong object or camera move style")}var c=q("__camera");q("__config");var b=q("__constraints"),n=q("__container"),f=q("__mat4"),t=q("__math"),g=q("__obj_util"),m=q("__physics"),v=q("__print"),x=q("__scenes"),d=q("__transform"),k=q("__tsr"),r=q("__util"),C=q("__vec3"),B=q("__vec4"),F=new Float32Array(2),
D=new Float32Array(3),y=new Float32Array(3),A=new Float32Array(4);new Float32Array(9);var H={},w={};a.MS_STATIC=c.MS_STATIC;a.MS_TARGET_CONTROLS=c.MS_TARGET_CONTROLS;a.MS_EYE_CONTROLS=c.MS_EYE_CONTROLS;a.MS_HOVER_CONTROLS=c.MS_HOVER_CONTROLS;a.static_setup=function(a,b){if(g.is_camera(a)){c.bt(a);a.k.pb=c.MS_STATIC;if(b){var e=b.pos||k.get_trans_view(a.k.n);b.look_at?c.set_look_at(a,e,b.look_at):d.set_translation(a,e)}d.A(a);m.sync_transform(a);c.uo(a)}else v.error("static_setup(): Wrong camera object")};
a.static_set_look_at=function(a,b,e){c.is_static_camera(a)?(b=b||k.get_trans_view(a.k.n),e?c.set_look_at(a,b,e):d.set_translation(a,b),d.A(a),m.sync_transform(a)):v.error("static_set_look_at(): Wrong camera object or camera move style")};a.static_set_rotation=function(a,b){c.is_static_camera(a)?(d.set_rotation(a,b),d.A(a),m.sync_transform(a)):v.error("static_set_rotation(): Wrong camera object or camera move style")};a.static_get_rotation=function(a,b){if(!c.is_static_camera(a))return v.error("static_get_rotation(): Wrong camera object or camera move style"),
null;b=b||new Float32Array(4);return d.get_rotation(a,b)};a.eye_setup=function(a,b){if(g.is_camera(a))if(b&&b.horiz_rot_lim&&("number"!=typeof b.horiz_rot_lim.left||"number"!=typeof b.horiz_rot_lim.right))v.error("eye_setup(): Wrong horizontal limits object.");else if(b&&b.vert_rot_lim&&("number"!=typeof b.vert_rot_lim.down||"number"!=typeof b.vert_rot_lim.up))v.error("eye_setup(): Wrong vertical limits object.");else{c.bt(a);a.k.pb=c.MS_EYE_CONTROLS;if(b){var e=b.pos||k.get_trans_view(a.k.n);c.nN(a,
e,b.look_at,b.horiz_rot_lim,b.vert_rot_lim)}d.A(a);m.sync_transform(a);c.uo(a)}else v.error("eye_setup(): Wrong camera object")};a.eye_set_look_at=function(a,e,f){c.is_eye_camera(a)?(e=e||k.get_trans_view(a.k.n),f?c.ZM(a,e,f):d.set_translation(a,e),b.correct_up(a,a.k.xe,!0),d.A(a),m.sync_transform(a)):v.error("eye_set_look_at(): Wrong camera object or camera move style")};a.eye_rotate=function(a,b,e,f,g){c.is_eye_camera(a)?(c.rotate_eye_camera(a,b,e,f||!1,g||!1),d.A(a),m.sync_transform(a)):v.error("eye_rotate(): Wrong camera object or camera move style")};
a.eye_set_vertical_limits=function(a,b){c.is_eye_camera(a)?!b||"number"==typeof b.down&&"number"==typeof b.up?(c.WB(a,b),d.A(a),m.sync_transform(a)):v.error("eye_set_vertical_limits(): Incorrect limits object."):v.error("eye_set_vertical_limits(): Wrong camera object or camera move style")};a.eye_get_vertical_limits=function(a,b,d){if(!c.is_eye_camera(a))return v.error("eye_get_vertical_limits(): Wrong camera object or camera move style"),null;a=a.k;return a.oa?(b=b||{},d?(b.down=a.oa.Cl,b.up=a.oa.Mm):
(b.down=a.oa.down,b.up=a.oa.up),b.camera_space=d||!1,b):null};a.eye_set_horizontal_limits=function(a,b){c.is_eye_camera(a)?!b||"number"==typeof b.left&&"number"==typeof b.right?(c.TB(a,b),d.A(a),m.sync_transform(a)):v.error("eye_set_horizontal_limits(): Incorrect limits object."):v.error("eye_set_horizontal_limits(): Wrong camera object or camera move style")};a.eye_get_horizontal_limits=function(a,b,d){if(!c.is_eye_camera(a))return v.error("eye_get_horizontal_limits(): Wrong camera object or camera move style"),
null;a=a.k;return a.gb?(b=b||{},d?(b.left=a.gb.Yl,b.right=a.gb.pm):(b.left=a.gb.left,b.right=a.gb.right),b.camera_space=d||!1,b):null};a.target_setup=function(a,b){if(g.is_camera(a))if(!b.horiz_rot_lim||"number"==typeof b.horiz_rot_lim.left&&"number"==typeof b.horiz_rot_lim.right)if(!b.vert_rot_lim||"number"==typeof b.vert_rot_lim.down&&"number"==typeof b.vert_rot_lim.up){if(b.dist_lim){if("number"!=typeof b.dist_lim.min||"number"!=typeof b.dist_lim.max||b.dist_lim.min>b.dist_lim.max){v.error("target_setup(): Wrong distance limits object");
return}b.dist_lim.min=Math.max(b.dist_lim.min,0);b.dist_lim.max=Math.max(b.dist_lim.max,0)}if(b.Ro&&("number"!=typeof b.Ro.min_y||"number"!=typeof b.Ro.max_y||b.Ro.min_y>b.Ro.max_y))v.error("target_setup(): Wrong pivot limits object");else{c.bt(a);a.k.pb=c.MS_TARGET_CONTROLS;var e=b.pos||k.get_trans_view(a.k.n);c.pN(a,e,b.pivot,b.horiz_rot_lim,b.vert_rot_lim,b.dist_lim,b.Ro,b.use_panning||!1);d.A(a);m.sync_transform(a);c.uo(a)}}else v.error("target_setup(): Wrong vertical limits object");else v.error("target_setup(): Wrong horizontal limits object");
else v.error("target_setup(): Wrong camera object")};a.target_rotate=function(a,b,e,f,g){c.is_target_camera(a)?(c.rotate_target_camera(a,b,e,f||!1,g||!1),d.A(a),m.sync_transform(a)):v.error("target_rotate(): Wrong camera object or camera move style")};a.target_set_trans_pivot=function(a,b,e){c.is_target_camera(a)?(b=b||k.get_trans_view(a.k.n),e=e||a.k.pivot,c.set_trans_pivot(a,b,e),d.A(a),m.sync_transform(a)):v.error("target_set_trans_pivot(): Wrong camera object or camera move style")};a.target_set_pivot_translation=
function(a,b){c.is_target_camera(a)?(c.gN(a,b),d.A(a),m.sync_transform(a)):v.error("target_set_pivot_translation(): Wrong camera object or camera move style")};a.target_set_distance=function(a,b){if(c.is_target_camera(a)){var e=d.im(a,a.k.pivot),f=Math.max(0,b);d.move_local(a,0,0,f-e);d.A(a);m.sync_transform(a)}else v.error("target_set_distance(): Wrong camera object or camera move style")};a.target_get_distance=function(a){return c.is_target_camera(a)?d.im(a,a.k.pivot):(v.error("target_get_distance(): Wrong camera object or camera move style"),
0)};a.target_zoom_object=function(a,b){if(c.is_target_camera(a)){var e=d.get_object_center(b,!1,D),f=d.get_object_size(b),n=x.get_active(),n=g.ga(a,n).R[0],n=c.Pz(n)/2,f=f/Math.sin(n),n=d.im(a,e);c.set_trans_pivot(a,k.get_trans_view(a.k.n),e);d.A(a);d.move_local(a,0,0,f-n);d.A(a);m.sync_transform(a)}else v.error("target_zoom_object(): Wrong camera object or camera move style")};a.target_get_pivot=function(a,b){if(!c.is_target_camera(a))return v.error("target_get_pivot(): Wrong camera object or camera move style"),
null;b=b||new Float32Array(3);C.copy(a.k.pivot,b);return b};a.target_set_distance_limits=function(a,b){if(c.is_target_camera(a)){if(b){if("number"!=typeof b.min||"number"!=typeof b.max||b.min>b.max){v.error("target_set_distance_limits(): Wrong limits object");return}b.min=Math.max(b.min,0);b.max=Math.max(b.max,0)}c.KM(a,b);d.A(a);m.sync_transform(a)}else v.error("target_set_distance_limits(): Wrong camera object or camera move style")};a.target_get_distance_limits=function(a,b){if(!c.is_target_camera(a))return v.error("target_get_distance_limits(): Wrong camera object or camera move style"),
null;var d=a.k;return d.kb?(b=b||{},b.min=d.kb.min,b.max=d.kb.max,b):null};a.target_set_vertical_limits=function(a,b){c.is_target_camera(a)?!b||"number"==typeof b.down&&"number"==typeof b.up?(c.WB(a,b),d.A(a),m.sync_transform(a)):v.error("target_set_vertical_limits(): Wrong limits object"):v.error("target_set_vertical_limits(): Wrong camera object or camera move style")};a.target_get_vertical_limits=function(a,b,d){if(!c.is_target_camera(a))return v.error("target_get_vertical_limits(): Wrong camera object or camera move style"),
null;a=a.k;return a.oa?(b=b||{},d?(b.down=a.oa.Cl,b.up=a.oa.Mm):(b.down=a.oa.down,b.up=a.oa.up),b.camera_space=d||!1,b):null};a.target_set_horizontal_limits=function(a,b){c.is_target_camera(a)?!b||"number"==typeof b.left&&"number"==typeof b.right?(c.TB(a,b),d.A(a),m.sync_transform(a)):v.error("target_set_horizontal_limits(): Wrong limits object"):v.error("target_set_horizontal_limits(): Wrong camera object or camera move style")};a.target_get_horizontal_limits=function(a,b,d){if(!c.is_target_camera(a))return v.error("target_get_horizontal_limits(): Wrong camera object or camera move style"),
null;a=a.k;return a.gb?(b=b||{},d?(b.left=a.gb.Yl,b.right=a.gb.pm):(b.left=a.gb.left,b.right=a.gb.right),b.camera_space=d||!1,b):null};a.target_set_pivot_limits=function(a,b){c.is_target_camera(a)?b&&("number"!=typeof b.min_z||"number"!=typeof b.max_z||b.min_z>b.max_z)?v.error("target_set_pivot_limits(): Wrong limits object"):(c.bN(a,b),d.A(a),m.sync_transform(a)):v.error("target_set_pivot_limits(): Wrong camera object or camera move style")};a.target_get_pivot_limits=function(a,b){if(!c.is_target_camera(a))return v.error("target_get_pivot_limits(): Wrong camera object or camera move style"),
null;var d=a.k;return d.oe?(b=b||{},b.min_z=d.oe.min_z,b.max_z=d.oe.max_z,b):null};a.target_pan_pivot=function(a,b,e){if(c.is_target_camera(a)){var f=a.k;f.use_panning&&(D[0]=b,D[1]=-e,D[2]=0,k.transform_dir_vec3(D,f.n,D),C.add(f.pivot,D,f.pivot),b=k.get_trans_view(f.n),C.add(b,D,b),d.A(a),m.sync_transform(a))}else v.error("target_pan_pivot(): wrong object")};a.target_switch_panning=function(a,b){if(!c.is_target_camera(a))return v.error("target_switch_panning(): Wrong camera object or camera move style"),
null;a.k.use_panning=b};a.hover_setup_rel=function(b,e){a.hover_setup(b,{pos:e.pos,pivot:e.pivot});var f="undefined"==typeof e.dist_interval?0:Math.max(e.dist_interval,0),g="undefined"==typeof e.angle_interval?0:Math.max(e.angle_interval,0),k="undefined"==typeof e.t?.5:r.clamp(e.t,0,1),l=a.hover_get_distance_limits(b,H);l.min=Math.max(l.min-k*f,0);l.max+=(1-k)*f;f=a.hover_get_vertical_limits(b,w);f.down=r.clamp(f.down+k*g,-Math.PI/2,0);f.up=r.clamp(f.up-(1-k)*g,-Math.PI/2,0);c.hover_set_distance_limits(b,
l);c.hover_set_vertical_limits(b,f);d.A(b);m.sync_transform(b);c.uo(b)};a.hover_setup=function(a,b){if(g.is_camera(a)){if(b.dist_lim){if("number"!=typeof b.dist_lim.min||"number"!=typeof b.dist_lim.max||b.dist_lim.min>b.dist_lim.max){v.error("hover_setup(): Wrong distance limits object");return}b.dist_lim.min=Math.max(b.dist_lim.min,0);b.dist_lim.max=Math.max(b.dist_lim.max,0)}if(b.hover_angle_lim&&("number"!=typeof b.hover_angle_lim.down||"number"!=typeof b.hover_angle_lim.up||b.hover_angle_lim.down<
b.hover_angle_lim.up))v.error("hover_setup(): Wrong hover angle limits object");else if(b.horiz_trans_lim&&("number"!=typeof b.horiz_trans_lim.min||"number"!=typeof b.horiz_trans_lim.max||b.horiz_trans_lim.min>b.horiz_trans_lim.max))v.error("hover_setup(): Wrong horizontal translation limits object");else if(b.vert_trans_lim&&("number"!=typeof b.vert_trans_lim.min||"number"!=typeof b.vert_trans_lim.max||b.vert_trans_lim.min>b.vert_trans_lim.max))v.error("hover_setup(): Wrong vertical translation limits object");
else{c.bt(a);a.k.pb=c.MS_HOVER_CONTROLS;var e=b.pos||k.get_trans_view(a.k.n);c.oN(a,e,b.pivot,b.dist_lim,b.hover_angle_lim,b.horiz_trans_lim,b.vert_trans_lim,b.enable_horiz_rot||!1);d.A(a);m.sync_transform(a);c.uo(a)}}else v.error("hover_setup(): Wrong camera object")};a.hover_rotate=function(a,b,e,f,g){c.is_hover_camera(a)?(c.rotate_hover_camera(a,b,e,f||!1,g||!1),d.A(a),m.sync_transform(a)):v.error("hover_rotate(): Wrong camera object or camera move style")};a.hover_set_pivot_translation=function(a,
b){c.is_hover_camera(a)?(c.set_hover_pivot(a,b),d.A(a),m.sync_transform(a)):v.error("hover_set_pivot_translation(): Wrong camera object or camera move style")};a.hover_get_pivot=function(a,b){if(!c.is_hover_camera(a))return v.error("hover_get_pivot(): Wrong camera object or camera move style"),null;b=b||new Float32Array(3);C.copy(a.k.yb,b);return b};a.hover_get_distance=function(a){return c.is_hover_camera(a)?d.im(a,a.k.yb):(v.error("hover_get_distance(): Wrong camera object or camera move style"),
0)};a.hover_set_vertical_limits=function(a,b){c.is_hover_camera(a)?"number"!=typeof b.down||"number"!=typeof b.up||b.down<b.up?v.error("hover_set_vertical_limits(): Wrong limits object"):(c.hover_set_vertical_limits(a,b),d.A(a),m.sync_transform(a)):v.error("hover_set_vertical_limits(): Wrong camera object or camera move style")};a.hover_get_vertical_limits=function(a,b){if(!c.is_hover_camera(a))return v.error("hover_get_vertical_limits(): Wrong camera object or camera move style"),null;var d=a.k;
b=b||{};b.down=d.oa.down;b.up=d.oa.up;return b};a.hover_set_distance_limits=function(a,b){c.is_hover_camera(a)?"number"!=typeof b.min||"number"!=typeof b.max||b.min>b.max?v.error("hover_set_distance_limits(): Wrong limits object"):(b.min=Math.max(b.min,0),b.max=Math.max(b.max,0),c.hover_set_distance_limits(a,b),d.A(a),m.sync_transform(a)):v.error("hover_set_distance_limits(): Wrong camera object or camera move style")};a.hover_get_distance_limits=function(a,b){if(!c.is_hover_camera(a))return v.error("hover_get_distance_limits(): Wrong camera object or camera move style"),
null;var d=a.k;b=b||{};b.min=d.kb.min;b.max=d.kb.max;return b};a.hover_set_vert_trans_limits=function(a,b){c.is_hover_camera(a)?b&&("number"!=typeof b.min||"number"!=typeof b.max||b.min>b.max)?v.error("hover_set_vert_trans_limits(): Wrong limits object"):(c.jN(a,b),d.A(a),m.sync_transform(a)):v.error("hover_set_vert_trans_limits(): Wrong camera object or camera move style")};a.hover_get_vert_trans_limits=function(a,b){if(!c.is_hover_camera(a))return v.error("hover_get_vert_trans_limits(): Wrong camera object or camera move style"),
null;var d=a.k;return d.Fc?(b=b||{},b.min=d.Fc.min,b.max=d.Fc.max,b):null};a.hover_set_horiz_trans_limits=function(a,b){c.is_hover_camera(a)?b&&("number"!=typeof b.min||"number"!=typeof b.max||b.min>b.max)?v.error("hover_set_horiz_trans_limits(): Wrong limits object"):(c.TM(a,b),d.A(a),m.sync_transform(a)):v.error("hover_set_horiz_trans_limits(): Wrong camera object or camera move style")};a.hover_get_horiz_trans_limits=function(a,b){if(!c.is_hover_camera(a))return v.error("hover_get_horiz_trans_limits(): Wrong camera object or camera move style"),
null;var d=a.k;return d.Ec?(b=b||{},b.min=d.Ec.min,b.max=d.Ec.max,b):null};a.hover_switch_horiz_rotation=function(a,b){if(!c.is_hover_camera(a))return v.error("hover_switch_horiz_rotation(): Wrong camera object or camera move style"),null;a.k.Zj=b};a.is_static_camera=c.is_static_camera;a.is_target_camera=c.is_target_camera;a.is_eye_camera=c.is_eye_camera;a.is_hover_camera=c.is_hover_camera;a.set_move_style=function(a,b){if(!g.is_camera(a))return v.error("set_move_style(): Wrong camera object"),!1;
if(b!=c.MS_STATIC&&b!=c.MS_EYE_CONTROLS&&b!=c.MS_TARGET_CONTROLS&&b!=c.MS_HOVER_CONTROLS)return v.error("set_move_style(): Wrong move style"),!1;c.set_move_style(a,b);d.A(a);m.sync_transform(a);return!0};a.get_move_style=function(a){return g.is_camera(a)?c.get_move_style(a):(v.error("get_move_style(): Wrong camera object"),null)};a.set_translation=function(a,b){if(g.is_camera(a)){var e=a.k;if(c.is_target_camera(a)){var f=k.get_trans_view(e.n),f=C.subtract(b,f,D);C.add(f,e.pivot,e.pivot)}else c.is_hover_camera(a)&&
(f=k.get_trans_view(e.n),f=C.subtract(b,f,D),C.add(f,e.yb,e.yb));d.set_translation(a,b);d.A(a);m.sync_transform(a)}else v.error("set_translation(): Wrong camera object")};a.get_translation=function(a,b){if(!g.is_camera(a))return v.error("get_translation(): Wrong camera object"),null;b=b||new Float32Array(3);return d.get_translation(a,b)};a.rotate_camera=function(a,b,e,f,k){g.is_camera(a)?(f=f||!1,k=k||!1,c.is_target_camera(a)?c.rotate_target_camera(a,b,e,f,k):c.is_eye_camera(a)?c.rotate_eye_camera(a,
b,e,f,k):c.is_hover_camera(a)?c.rotate_hover_camera(a,b,e,f,k):c.is_static_camera(a)?v.warn("rotate_camera(): not supported for STATIC cameras"):v.error("rotate_camera(): Wrong camera move style"),d.A(a),m.sync_transform(a)):v.error("rotate_camera(): Wrong camera object")};a.set_velocities=function(a,b){if(g.is_camera(a)){var c=a.k;"number"==typeof b.trans&&(c.Xk=r.clamp(b.trans,0,Infinity));"number"==typeof b.rot&&(c.Wk=r.clamp(b.rot,0,Infinity));"number"==typeof b.zoom&&(c.Yk=r.clamp(b.zoom,0,.99))}else v.error("set_velocities(): Wrong camera object")};
a.get_velocities=function(a,b){if(!g.is_camera(a))return v.error("get_velocities(): Wrong camera object"),null;var c=a.k;b=b||{};b.trans=c.Xk;b.rot=c.Wk;b.zoom=c.Yk;return b};a.is_look_up=function(a){if(!g.is_camera(a))return v.error("is_look_up(): Wrong camera object"),!1;a=k.get_quat_view(a.k.n);return 0<=r.quat_to_dir(a,r.AXIS_MZ,D)[1]};a.get_camera_angles=function(a,b){if(!g.is_camera(a))return v.error("get_camera_angles(): Wrong camera object"),null;b=b||new Float32Array(2);c.get_camera_angles(a,
b);return b};a.get_camera_angles_char=function(a,b){if(!g.is_camera(a))return v.error("get_camera_angles_char(): Wrong camera object"),null;b=b||new Float32Array(2);c.get_camera_angles_char(a,b);return b};a.set_stereo_distance=function(a,b){if(g.is_camera(a))for(var d=x.get_active(),d=g.ga(a,d).R,e=0;e<d.length;e++){var f=d[e];f.type!=c.pc&&f.type!=c.Bc&&f.type!=c.Wd&&f.type!=c.Xd||c.fN(f,b,f.te)}else v.error("set_stereo_distance(): Wrong camera object")};a.get_stereo_distance=function(a){if(!g.is_camera(a))return v.error("get_stereo_distance(): Wrong camera object"),
0;var b=x.get_active();a=g.ga(a,b).R;for(b=0;b<a.length;b++){var d=a[b];if(d.type==c.pc||d.type==c.Bc)return d.dj}return 0};a.set_eye_distance=function(a,b){if(g.is_camera(a)){var d=x.get_active(),d=g.ga(a,d).R;c.set_eye_distance(d,b)}else v.error("set_eye_distance(): Wrong camera object")};a.get_eye_distance=function(a){if(!g.is_camera(a))return v.error("get_eye_distance(): Wrong camera object"),0;var b=x.get_active();a=g.ga(a,b).R;for(b=0;b<a.length;b++){var d=a[b];if(d.type==c.pc||d.type==c.Bc||
d.type==c.Wd||d.type==c.Xd)return d.te}return 0};a.set_vertical_axis=function(a,b){g.is_camera(a)?(C.copy(b,a.k.xe),d.A(a),m.sync_transform(a)):v.error("set_vertical_axis(): Wrong camera object")};a.get_vertical_axis=function(a,b){if(g.is_camera(a))return b||(b=C.create()),C.copy(a.k.xe,b),b;v.error("get_vertical_axis(): Wrong camera object")};a.translate_view=function(a,b,d,e){if(g.is_camera(a)){var k=x.get_active();a=g.ga(a,k).R;for(k=0;k<a.length;k++){var l=a[k];l.Nb||c.aj(l,l.bb);var m=D;m[0]=
-b;m[1]=-d;m[2]=0;f.translate(l.ab,m,l.ab);f.rotateZ(l.ab,e,l.ab);c.yy(l);c.Mt(l)}}else v.error("translate_view(): Wrong camera object")};a.get_view_vector=function(a,b){if(!g.is_camera(a))return v.error("get_view_vector(): Wrong camera object"),null;b=b||new Float32Array(3);var c=k.get_quat_view(a.k.n);r.quat_to_dir(c,r.AXIS_MZ,b);return b};a.get_fov=function(a){if(!g.is_camera(a))return v.error("get_fov(): Wrong camera object"),0;var b=x.get_active();a=g.ga(a,b).R;return r.deg_to_rad(a[0].od)};
a.set_fov=function(a,b){if(g.is_camera(a))for(var d=x.get_active(),d=g.ga(a,d).R,e=0;e<d.length;e++){var f=d[e];f.od=r.rad_to_deg(b);f.Nb||c.aj(f,f.bb);c.yy(f);c.Mt(f)}else v.error("set_fov(): Wrong camera object")};a.set_hmd_fov=function(a,b,d){var e;if(!(e=g.is_camera(a)))a:{if(g.is_camera(a)){e=x.get_active();e=g.ga(a,e).R;for(var f=0;f<e.length;f++){var k=e[f];if(k.type==c.Wd||k.type==c.Xd){e=!0;break a}}}else v.error("is_hmd_camera(): Wrong camera object");e=!1}e?b&&d&&c.set_hmd_fov(a,b,d):v.error("set_hmd_fov(): Wrong camera object")};
a.correct_up=function(a,c,e){g.is_camera(a)?(c=c||a.k.xe,b.correct_up(a,c,e||!1),d.A(a),m.sync_transform(a)):v.error("correct_up(): Wrong camera object")};a.set_ortho_scale=function(a,b){if(g.is_camera(a)&&c.is_ortho_camera(a)){var d=a.k;if(c.is_target_camera(a)){var e=k.get_trans_view(d.n),e=C.dist(e,d.pivot);d.zi=b/2*d.yi/e}else c.is_hover_camera(a)?(e=k.get_trans_view(d.n),e=C.distance(e,d.yb),d.zi=b/2*d.yi/e):(d=x.get_active(),g.ga(a,d).R[0].top=b/2);c.BO(a)}else v.error("set_ortho_scale(): Wrong camera object")};
a.get_ortho_scale=function(a){if(!g.is_camera(a)||!c.is_ortho_camera(a))return v.error("get_ortho_scale(): Wrong camera object"),0;var b=x.get_active();return 2*g.ga(a,b).R[0].top};a.is_ortho_camera=function(a){return g.is_camera(a)?c.is_ortho_camera(a):(v.error("is_ortho_camera(): Wrong camera object"),!1)};a.calc_ray=function(a,b,e,f){if(!g.is_camera(a))return v.error("calc_ray(): Wrong camera object"),null;var m=x.get_active(),l=g.ga(a,m).R[0];f&&3==f.length?v.uc('dest parameter in the function "calc_ray" should be type of parametric line.'):
f=f||new Float32Array(6);switch(l.type){case c.hd:case c.ng:case c.pc:case c.Bc:var q=Math.tan(l.od*Math.PI/360),w=q*l.bb,m=D;b=n.jq(b,e,F,l);m[0]=(2*b[0]/l.width-1)*w;m[1]=(1-2*b[1]/l.height)*q;m[2]=-1;k.transform_dir_vec3(m,a.k.n,m);C.normalize(m,m);3==f.length?C.copy(m,f):(a=d.get_translation(a,y),t.set_pline_initial_point(f,a),t.set_pline_directional_vec(f,m));return f;case c.Yd:return m=D,b=n.jq(b,e,F,l),m[0]=(2*b[0]/l.width-1)*l.top*l.bb,m[1]=(1-2*b[1]/l.height)*l.top,m[2]=0,k.transform_vec3(m,
a.k.n,m),C.copy(m,f),a=k.get_quat_view(a.k.n,A),C.transformQuat(r.AXIS_MZ,a,m),t.set_pline_directional_vec(f,m),f;default:return v.error("calc_ray(): Non-compatible camera"),f}};a.project_point=function(a,b,d){if(!g.is_camera(a))return v.error("project_point(): Wrong camera object"),null;d=d||new Float32Array(2);return c.project_point(a,b,d)};a.has_distance_limits=function(a){return(c.is_target_camera(a)||c.is_hover_camera(a))&&null!==a.k.kb};a.has_vertical_rot_limits=function(a){return(c.is_eye_camera(a)||
c.is_target_camera(a)||c.is_hover_camera(a))&&null!==a.k.oa};a.has_vertical_limits=function(a){v.tb("has_vertical_limits","has_vertical_rot_limits");return c.is_target_camera(a)||c.is_eye_camera(a)?null!==a.k.oa:(v.error("has_vertical_limits(): Wrong camera object"),!1)};a.has_horizontal_rot_limits=function(a){return(c.is_target_camera(a)||c.is_eye_camera(a))&&null!==a.k.gb};a.has_horizontal_limits=function(a){v.tb("has_horizontal_limits","has_horizontal_rot_limits");return c.is_target_camera(a)||
c.is_eye_camera(a)?null!==a.k.gb:(v.error("has_horizontal_limits(): Wrong camera object"),!1)};a.has_vertical_trans_limits=function(a){return c.is_hover_camera(a)&&null!==a.k.Fc};a.has_horizontal_trans_limits=function(a){return c.is_hover_camera(a)&&null!==a.k.Ec};a.move_pivot=function(a,b,e){v.tb("move_pivot","target_pan_pivot");if(c.is_target_camera(a)){var f=a.k;if(f.use_panning){var g=k.get_trans_view(f.n),l=C.subtract(g,f.pivot,y);D[0]=b;D[1]=0;D[2]=e;C.scale(D,C.len(l),D);k.transform_dir_vec3(D,
f.n,D);C.add(f.pivot,D,f.pivot);C.add(g,D,g);d.A(a);m.sync_transform(a)}}else v.error("move_pivot(): wrong object")};a.set_velocity_params=function(a,b){v.tb("set_velocity_params","set_velocities");if(g.is_camera(a)){var c=a.k;c.Xk=r.clamp(b[0],0,Infinity);c.Wk=r.clamp(b[1],0,Infinity);c.Yk=r.clamp(b[2],0,.99)}else v.error("set_velocity_params(): Wrong camera object")};a.get_velocity_params=function(a,b){v.tb("get_velocity_params","get_velocities");if(!g.is_camera(a))return v.error("get_velocity_params(): Wrong camera object"),
null;b=b||new Float32Array(3);var c=a.k;b[0]=c.Xk;b[1]=c.Wk;b[2]=c.Yk;return b};a.clear_horizontal_limits=function(a){v.uc('camera.clear_horizontal_limits() deprecated, use camera.target_set_horizontal_limits(), camera.eye_set_horizontal_limits() or camera.hover_set_horiz_trans_limits() with passing null as the "limits" argument.');g.is_camera(a)?c.is_target_camera(a)||c.is_eye_camera(a)?a.k.gb=null:c.is_hover_camera(a)&&(a.k.Ec=null):v.error("clear_horizontal_limits(): Wrong camera object")};a.clear_vertical_limits=
function(a){v.uc('camera.clear_vertical_limits() deprecated, use camera.target_set_vertical_limits(), camera.eye_set_vertical_limits() or camera.hover_set_vert_trans_limits() with passing null as the "limits" argument.');g.is_camera(a)?c.is_target_camera(a)||c.is_eye_camera(a)?a.k.oa=null:c.is_hover_camera(a)&&(a.k.Fc=null):v.error("clear_vertical_limits(): Wrong camera object")};a.clear_hover_angle_limits=function(){v.uc("camera.clear_hover_angle_limits() deprecated, HOVER camera always has hover angle limits")};
a.set_look_at=function(a,e,f,k){v.yg("camera.set_look_at",["camera.static_set_look_at","camera.eye_set_look_at"]);k=k||a.k.xe;c.set_look_at(a,e,f);b.correct_up(a,k,!0);d.A(a);m.sync_transform(a)};a.rotate_eye_camera=function(a,b,e,f,k){v.yg("camera.rotate_eye_camera",["camera.eye_rotate","camera.rotate_camera"]);c.is_eye_camera(a)?(c.rotate_eye_camera(a,b,e,f,k),d.A(a),m.sync_transform(a)):v.error("rotate_eye_camera(): wrong object")};a.rotate_target_camera=function(a,b,e,f,k){v.yg("camera.rotate_target_camera",
["camera.target_rotate","camera.rotate_camera"]);c.is_target_camera(a)?(c.rotate_target_camera(a,b,e,f,k),d.A(a),m.sync_transform(a)):v.error("rotate_target_camera(): wrong object")};a.set_trans_pivot=function(a,b,e){v.tb("camera.set_trans_pivot","camera.target_set_trans_pivot");c.is_target_camera(a)?(c.set_trans_pivot(a,b,e),d.A(a),m.sync_transform(a)):v.error("set_trans_pivot(): Wrong object or camera move style")};a.zoom_object=function(a,b){v.tb("camera.zoom_object","camera.target_zoom_object");
if(c.is_target_camera(a)){d.get_object_center(b,!1,D);e(a,D);d.A(a);var f=d.get_object_size(b),k=x.get_active(),k=g.ga(a,k).R[0],k=c.Pz(k)/2,f=f/Math.sin(k),k=d.im(a,D);d.move_local(a,0,0,f-k);d.A(a);m.sync_transform(a)}else v.error("zoom_object(): wrong object")};a.set_pivot=e;a.rotate_hover_camera=function(a,b,e,f,k){v.tb("camera.rotate_hover_camera","camera.hover_rotate");c.is_hover_camera(a)?(c.rotate_hover_camera(a,b,e,f,k),d.A(a),m.sync_transform(a)):v.error("rotate_hover_camera(): wrong object")};
a.get_hover_cam_pivot=function(a,b){v.tb("camera.get_hover_cam_pivot","camera.hover_get_pivot");if(!c.is_hover_camera(a))return v.error("get_hover_cam_pivot(): wrong object"),null;b||(b=new Float32Array(3));C.copy(a.k.yb,b);return b};a.get_eye=function(a,b){v.tb("camera.get_eye","camera.get_translation");return g.is_camera(a)?c.get_eye(a,b):(v.error("get_eye(): Wrong object"),null)};a.get_pivot=function(a,b){v.tb("camera.get_pivot","camera.target_get_pivot");if(!c.is_target_camera(a))return v.error("get_pivot(): Wrong object or camera move style"),
null;b||(b=new Float32Array(3));C.copy(a.k.pivot,b);return b};a.hover_cam_set_translation=function(a,b){v.tb("camera.hover_cam_set_translation","camera.set_translation");if(c.is_hover_camera(a)){var e=a.k,f=k.get_trans_view(e.n),f=C.subtract(b,f,D);C.add(f,e.yb,e.yb);d.set_translation(a,b);d.A(a);m.sync_transform(a)}else v.error("hover_cam_set_translation(): wrong object")};a.set_hover_pivot=function(a,b){v.tb("camera.set_hover_pivot","camera.hover_set_pivot_translation");c.is_hover_camera(a)?(c.set_hover_pivot(a,
b),d.A(a),m.sync_transform(a)):v.error("set_hover_pivot(): Wrong object or camera move style")};a.get_hover_angle_limits=function(a,b){v.tb("camera.get_hover_angle_limits","camera.hover_get_vertical_limits");if(!c.is_hover_camera(a))return v.error("get_hover_angle_limits(): wrong object"),null;b=b||new Float32Array(2);b[0]=a.k.oa.down;b[1]=a.k.oa.up;return b};a.get_cam_dist_limits=function(a,b){v.yg("camera.get_cam_dist_limits",["camera.hover_get_distance_limits","camera.target_get_distance_limits"]);
if(!c.is_hover_camera(a)&&!c.is_target_camera(a))return v.error("get_cam_dist_limits(): wrong object"),null;if(a.k.kb)b=b||new Float32Array(2),b[0]=a.k.kb.max,b[1]=a.k.kb.min;else return null;return b};a.apply_vertical_limits=function(b,e,f,k){v.yg("camera.apply_vertical_limits",["camera.eye_set_vertical_limits","camera.target_set_vertical_limits","camera.hover_set_vert_trans_limits"]);if(c.is_target_camera(b)){var g=H;g.down=e;g.up=f;g.camera_space=k==d.SPACE_LOCAL;a.target_set_vertical_limits(b,
g)}else c.is_eye_camera(b)?(g=H,g.down=e,g.up=f,g.camera_space=k==d.SPACE_LOCAL,a.eye_set_vertical_limits(b,g)):c.is_hover_camera(b)?(g=H,g.min=e,g.max=f,a.hover_set_vert_trans_limits(b,g)):v.error("apply_vertical_limits(): wrong object")};a.apply_hover_angle_limits=function(b,c,d){v.tb("camera.apply_hover_angle_limits","camera.hover_set_vertical_limits");H.down=c;H.up=d;a.hover_set_vertical_limits(b,H)};a.apply_distance_limits=function(b,d,e){v.yg("camera.apply_distance_limits",["camera.target_set_distance_limits",
"camera.hover_set_distance_limits"]);if(c.is_target_camera(b)){var f=H;f.min=d;f.max=e;a.target_set_distance_limits(b,f)}else c.is_hover_camera(b)?(f=H,f.min=d,f.max=e,a.hover_set_distance_limits(b,f)):v.error("apply_distance_limits(): wrong object")};a.clear_distance_limits=function(b){v.tb("camera.clear_distance_limits","camera.target_set_distance_limits");a.target_set_distance_limits(b,null)};a.get_vertical_limits=function(a,b){v.yg("camera.get_vertical_limits",["camera.eye_get_vertical_limits",
"camera.target_get_vertical_limits","camera.hover_get_vert_trans_limits"]);if(!c.is_target_camera(a)&&!c.is_eye_camera(a)&&!c.is_hover_camera(a))return v.error("get_vertical_limits(): wrong object"),null;var d=a.k;b=b||new Float32Array(2);if(c.is_eye_camera(a)||c.is_target_camera(a)){if(d.oa)return b[0]=d.oa.down,b[1]=d.oa.up,b}else if(c.is_hover_camera(a)&&d.Fc)return b[0]=d.Fc.min,b[1]=d.Fc.max,b;return null};a.apply_horizontal_limits=function(b,e,f,k){v.yg("camera.apply_horizontal_limits",["camera.eye_set_horizontal_limits",
"camera.target_set_horizontal_limits","camera.hover_set_horiz_trans_limits"]);if(c.is_target_camera(b)){var g=H;g.left=e;g.right=f;g.camera_space=k==d.SPACE_LOCAL;a.target_set_horizontal_limits(b,g)}else c.is_eye_camera(b)?(g=H,g.left=e,g.right=f,g.camera_space=k==d.SPACE_LOCAL,a.eye_set_horizontal_limits(b,g)):c.is_hover_camera(b)?(g=H,g.min=e,g.max=f,a.hover_set_horiz_trans_limits(b,g)):v.error("apply_horizontal_limits(): wrong object")};a.get_horizontal_limits=function(a,b){v.yg("camera.get_horizontal_limits",
["camera.eye_get_horizontal_limits","camera.target_get_horizontal_limits","camera.hover_get_horiz_trans_limits"]);if(!c.is_target_camera(a)&&!c.is_eye_camera(a)&&!c.is_hover_camera(a))return v.error("get_horizontal_limits(): wrong object"),null;var d=a.k;b=b||new Float32Array(2);if(c.is_eye_camera(a)||c.is_target_camera(a)){if(d.gb)return b[0]=d.gb.left,b[1]=d.gb.right,b}else if(c.is_hover_camera(a)&&d.Ec)return b[0]=d.Ec.min,b[1]=d.Ec.max,b;return null};a.get_frustum_planes=function(a,b){if(!g.is_camera(a))return v.error("get_frustum_planes(): Wrong camera object"),
null;var c=x.get_active(),c=g.ga(a,c).R[0].Ag;B.copy(c.left,b.left);B.copy(c.right,b.right);B.copy(c.top,b.top);B.copy(c.bottom,b.bottom);B.copy(c.near,b.near);B.copy(c.far,b.far);return b}};b4w.module.config=function(a,q){var e=q("__config"),c=q("__compat"),b=q("__debug"),n=q("__data"),f=q("__print");a.P_LOW=e.P_LOW;a.P_HIGH=e.P_HIGH;a.P_ULTRA=e.P_ULTRA;a.P_CUSTOM=e.P_CUSTOM;a.P_AUTO=e.P_AUTO;a.set=e.set;a.get=e.get;a.reset=e.reset;a.reset_limits=e.reset_limits;a.get_std_assets_path=e.get_std_assets_path;a.apply_quality=function(a){n.is_primary_loaded()?f.error("Cannot change quality profile after a scene is loaded."):(e.set("quality",a),b.Rq()&&(e.apply_quality(),c.SB(b.Rq(),!1)))}};b4w.module.controls=function(a,q){var e=q("__controls"),c=q("__print");a.CT_POSITIVE=e.CT_POSITIVE;a.CT_CONTINUOUS=e.CT_CONTINUOUS;a.CT_TRIGGER=e.CT_TRIGGER;a.CT_SHOT=e.CT_SHOT;a.CT_LEVEL=e.CT_LEVEL;a.CT_CHANGE=e.CT_CHANGE;a.KEY_BACKSPACE=8;a.KEY_TAB=9;a.KEY_ENTER=13;a.KEY_SHIFT=16;a.KEY_CTRL=17;a.KEY_ALT=18;a.KEY_PAUSE=19;a.KEY_CAPSLOCK=20;a.KEY_ESC=27;a.KEY_SPACE=32;a.KEY_LEFT=37;a.KEY_UP=38;a.KEY_RIGHT=39;a.KEY_DOWN=40;a.KEY_1=49;a.KEY_2=50;a.KEY_3=51;a.KEY_4=52;a.KEY_5=53;a.KEY_6=54;a.KEY_7=55;
a.KEY_8=56;a.KEY_9=57;a.KEY_A=65;a.KEY_B=66;a.KEY_C=67;a.KEY_D=68;a.KEY_E=69;a.KEY_F=70;a.KEY_G=71;a.KEY_H=72;a.KEY_I=73;a.KEY_J=74;a.KEY_K=75;a.KEY_L=76;a.KEY_M=77;a.KEY_N=78;a.KEY_O=79;a.KEY_P=80;a.KEY_Q=81;a.KEY_R=82;a.KEY_S=83;a.KEY_T=84;a.KEY_U=85;a.KEY_V=86;a.KEY_W=87;a.KEY_X=88;a.KEY_Y=89;a.KEY_Z=90;a.KEY_NUM0=96;a.KEY_NUM1=97;a.KEY_NUM2=98;a.KEY_NUM3=99;a.KEY_NUM4=100;a.KEY_NUM5=101;a.KEY_NUM6=102;a.KEY_NUM7=103;a.KEY_NUM8=104;a.KEY_NUM9=105;a.KEY_MULT=106;a.KEY_ADD=107;a.KEY_SUB=109;a.KEY_DEC_POINT=
110;a.KEY_DIV=111;a.KEY_SEMI_COLON=186;a.KEY_EQUAL_SIGN=187;a.KEY_COMMA=188;a.KEY_DASH=189;a.KEY_PERIOD=190;a.KEY_FORWARD_SLASH=191;a.KEY_GRAVE_ACCENT=192;a.KEY_LEFT_SQ_BRACKET=219;a.KEY_BACK_SLASH=220;a.KEY_RIGHT_SQ_BRACKET=221;a.KEY_SINGLE_QUOTE=222;a.PL_SINGLE_TOUCH_MOVE=e.PL_SINGLE_TOUCH_MOVE;a.PL_MULTITOUCH_MOVE_ZOOM=e.PL_MULTITOUCH_MOVE_ZOOM;a.PL_MULTITOUCH_MOVE_PAN=e.PL_MULTITOUCH_MOVE_PAN;a.PL_MULTITOUCH_MOVE_ROTATE=e.PL_MULTITOUCH_MOVE_ROTATE;a.create_gamepad_btn_sensor=e.create_gamepad_btn_sensor;
a.create_gamepad_axis_sensor=e.create_gamepad_axis_sensor;a.create_custom_sensor=e.create_custom_sensor;a.create_keyboard_sensor=e.create_keyboard_sensor;a.create_collision_sensor=function(a,c,f){return e.create_collision_sensor(a,c||"ANY",f||!1)};a.create_collision_impulse_sensor=e.create_collision_impulse_sensor;a.create_ray_sensor=function(a,c,f,q,g,m,v){return e.create_ray_sensor(a,c,f,q||"ANY",g||!1,m||!1,v||!1)};a.create_mouse_click_sensor=e.create_mouse_click_sensor;a.create_mouse_wheel_sensor=
e.create_mouse_wheel_sensor;a.create_mouse_move_sensor=e.create_mouse_move_sensor;a.create_touch_move_sensor=e.create_touch_move_sensor;a.create_touch_zoom_sensor=e.create_touch_zoom_sensor;a.create_touch_rotate_sensor=e.create_touch_rotate_sensor;a.create_touch_click_sensor=e.create_touch_click_sensor;a.create_motion_sensor=e.create_motion_sensor;a.create_vertical_velocity_sensor=e.create_vertical_velocity_sensor;a.create_gyro_angles_sensor=e.create_gyro_angles_sensor;a.create_gyro_quat_sensor=e.create_gyro_quat_sensor;
a.create_gyro_delta_sensor=e.create_gyro_delta_sensor;a.create_hmd_quat_sensor=e.create_hmd_quat_sensor;a.create_hmd_position_sensor=e.create_hmd_position_sensor;a.create_timer_sensor=function(a,c){return e.create_timer_sensor(a,c||!1)};a.reset_timer_sensor=e.reset_timer_sensor;a.create_elapsed_sensor=e.create_elapsed_sensor;a.create_timeline_sensor=e.create_timeline_sensor;a.create_selection_sensor=function(a,c){return e.create_selection_sensor(a,c||!1)};a.create_callback_sensor=function(a,c){return e.create_callback_sensor(a,
c||0)};a.set_custom_sensor=function(a,c){e.CM(a,c)};a.get_custom_sensor=function(a){return a.value};a.get_sensor_value=e.get_sensor_value;a.get_sensor_payload=e.get_sensor_payload;a.create_sensor_manifold=function(a,c,f,q,g,m,v){g=g||e.hz;e.create_sensor_manifold(a,c,f,q,g,m,void 0===v?null:v)};a.create_kb_sensor_manifold=function(a,c,f,q,g,m){q=e.create_keyboard_sensor(q);e.create_sensor_manifold(a,c,f,[q],e.hz,g,void 0===m?null:m)};a.check_sensor_manifolds=function(a){return e.check_sensor_manifold(a,
null)};a.check_sensor_manifold=e.check_sensor_manifold;a.remove_sensor_manifold=e.remove_sensor_manifold;a.reset=e.reset;a.register_keyboard_events=function(){c.uc("controls.register_keyboard_events() deprecated")};a.register_mouse_events=function(){c.uc("controls.register_mouse_events() deprecated")};a.register_wheel_events=function(){c.uc("controls.register_wheel_events() deprecated")};a.register_touch_events=function(){c.uc("controls.register_touch_events() deprecated")};a.register_device_orientation=
function(){c.uc("controls.register_device_orientation() deprecated")};a.unregister_keyboard_events=function(){c.uc("controls.unregister_keyboard_events() deprecated")};a.unregister_mouse_events=function(){c.uc("controls.unregister_mouse_events() deprecated")};a.unregister_wheel_events=function(){c.uc("controls.unregister_wheel_events() deprecated")};a.unregister_touch_events=function(){c.uc("controls.unregister_touch_events() deprecated")};a.unregister_device_orientation=function(){c.uc("controls.unregister_device_orientation() deprecated")}};b4w.module.constraints=function(a,q){var e=q("__camera"),c=q("__constraints"),b=q("__obj_util"),n=q("__physics"),f=q("__print"),t=q("__transform");a.append_stiff=function(a,b,e,f,d){d=d||1;b instanceof Array&&2==b.length?c.RF(a,b[0],b[1],e,f,d):c.Zx(a,b,e,f,d);t.A(a);n.sync_transform(a)};a.append_semi_stiff=function(a,b,e,f){c.PF(a,b,e,f);t.A(a);n.sync_transform(a)};a.append_semi_stiff_cam=function(a,b,q,x,d,k,r,C){e.is_eye_camera(a)?(d=d||-Math.PI/2,k=k||Math.PI/2,r=r||Math.PI/2,C=C||-Math.PI/2,
c.OF(a,b,q,x,d,k,r,C),t.A(a),n.sync_transform(a)):f.error("append_semi_stiff_cam(): wrong object type, only EYE camera objects can be parented.")};a.append_semi_soft_cam=function(a,b,q,x){if(e.is_eye_camera(a)){if(!x||0>x)x=.25;c.NF(a,b,q,x);t.A(a);n.sync_transform(a)}else f.error("append_semi_soft_cam(): wrong object type, only EYE camera objects can be parented.")};a.append_stiff_trans=function(a,b,e){c.TF(a,b,e);t.A(a);n.sync_transform(a)};a.append_copy_trans=function(a,b,e){c.HF(a,b,e);t.A(a);
n.sync_transform(a)};a.append_stiff_trans_rot=function(a,b,e,f){c.UF(a,b,e,f);t.A(a);n.sync_transform(a)};a.append_track=function(a,b){3==b.length?c.YF(a,b):c.XF(a,b);t.A(a);n.sync_transform(a)};a.append_follow=function(a,b,e,f){3==b.length?c.KF(a,b,e,f):c.JF(a,b,e,f);t.A(a);n.sync_transform(a)};a.append_stiff_viewport=function(a,b,e){c.append_stiff_viewport(a,b,e);t.A(a);n.sync_transform(a)};a.remove=function(a){a.Kb&&c.remove(a)};a.get_parent=function(a){f.tb("constraints.get_parent","objects.get_parent");
return b.get_parent(a)}};b4w.module.container=function(a,q){var e=q("__container"),c=q("__print");a.get_canvas=e.get_canvas;a.get_canvas_hud=e.get_canvas_hud;a.get_container=e.get_container;a.insert_to_container=function(a,n){2!=arguments.length?c.error("insert_to_container(): two arguments required"):a&&n&&e.insert_to_container(a,n)};a.set_canvas_offsets=e.set_canvas_offsets;a.update_canvas_offsets=e.update_canvas_offsets;a.client_to_canvas_coords=e.client_to_canvas_coords;a.force_offsets_updating=e.force_offsets_updating;
a.resize=function(a,n,f){a&&n||c.warn("Wrong canvas container dimensions: "+a+"x"+n+". Zero dimensions aren't allowed. Resized to: "+e.jt+"x"+e.it+".");e.resize(a,n,f)};a.resize_to_container=function(a){e.resize_to_container(a||!1)}};b4w.module.data=function(a,q){var e=q("__data"),c=q("__loader");q("__print");a.load=e.load;a.unload=function(a){e.unload(a|0)};a.set_debug_resources_root=e.set_debug_resources_root;a.is_primary_loaded=e.is_primary_loaded;a.is_idle=c.qk;a.load_and_add_new=e.load;a.cleanup=a.unload;a.activate_media=e.activate_media};b4w.module.debug=function(a,q){function e(a){var b={};if(!a)return b;a=a.split("\n");for(var c=0;c<a.length;c++){var d=a[c];if(-1!=d.search(new RegExp(/^[A-Z.]+ ?/))){var e=d.split(" ")[0];e in b||(b[e]=0);b[e]++}}d=c=a=0;for(e in b)switch(e){case "KIL":case "TEX":case "TXB":case "TXP":case "KIL.F":case "TEX.F":case "TXB.F":case "TXD.F":case "TXL.F":case "TXQ.F":case "TXP.F":c+=b[e];a+=b[e];break;case "ATTRIB":d+=b[e];break;case "ADDRESS":case "PARAM":case "TEMP":case "ALIAS":case "OUTPUT":break;
case "END":break;default:a+=b[e]}b.ALL_OPS=a;b.TEX_OPS=c;b.ATTRIBS=d;return b}function c(a,b){var c=new XMLHttpRequest;c.open("POST",a,!1);c.send(b);if(200==c.status)return c.responseText;D.error(c.responseText);throw"Error POST XHR: "+c.status;}function b(a){a.sort(function(a,b){return b.Eu.ALL_OPS-a.Eu.ALL_OPS});for(var b=0;b<a.length;b++){var c=a[b],d=c.Eu,e=c.lP,f=n(c.wI),f=f.length?"\t\t("+f.join(", ")+")":"\t\t(NA)";D.groupCollapsed("VERT ->","OPS",e.ALL_OPS,"ATT",e.ATTRIBS,"TEX",e.TEX_OPS,
"\t\tFRAG ->","OPS",d.ALL_OPS,"TEX",d.TEX_OPS,f);D.groupCollapsed("directives");for(var k=c.qb.qi.slice().sort(),f=0;f<k.length;f++){var g=k[f];D.le(g[0],g[1])}D.groupEnd();D.groupCollapsed("node elements");k=c.qb.Vf;for(f=0;f<k.length;f++)D.le(k[f]);D.groupEnd();D.groupCollapsed("vert source");D.le(c.jP);D.groupEnd();D.groupCollapsed("vert translated source");D.le(c.kP);D.groupEnd();f=["ALL_OPS","TEX_OPS","ATTRIBS"];D.groupCollapsed("vert ops stats");for(var h in e)-1==f.indexOf(h)&&D.le(h,e[h]);
D.groupEnd();D.groupCollapsed("vert assembly");D.le(c.iP);D.groupEnd();D.groupCollapsed("frag source");D.le(c.vJ);D.groupEnd();D.groupCollapsed("frag translated source");D.le(c.wJ);D.groupEnd();D.groupCollapsed("frag ops stats");for(h in d)-1==f.indexOf(h)&&D.le(h,d[h]);D.groupEnd();D.groupCollapsed("frag assembly");D.le(c.mJ);D.groupEnd();D.groupEnd()}}function n(a){for(var b=[],c=A.mo(),d=0;d<c.length;d++)for(var e=c[d],f=C.xb(e,"MESH",C.DATA_ID_ALL),k=0;k<f.length;k++){var g=B.ga(f[k],e);if(g&&
g.U.length)for(var g=g.U,h=0;h<g.length;h++){var l=g[h];if(l.Qa==a)for(var m=0;m<l.cc.length;m++){var n=l.cc[m];-1==b.indexOf(n)&&b.push(n)}}}return b}function f(a,b){function c(){M.push(c);E=b;return a.apply(a,arguments)}return c}function t(a,b,c){if(typeof b!=typeof a)throw"Wrong expected data type.";if(a.length!=b.length)throw"Wrong expected vector length.";c=c?c:1E-6;for(var d=0;d<a.length;d++)if(b[d]>a[d]+c||b[d]<a[d]-c)throw"Wrong result.";}var g=q("__config"),m=q("__compat"),v=q("__controls"),
x=q("__container"),d=q("__debug"),k=q("__extensions"),r=q("__loader"),C=q("__objects"),B=q("__obj_util"),F=q("__physics"),D=q("__print"),y=q("__renderer"),A=q("__scenes"),H=q("__scenegraph"),w=q("__sfx"),h=q("__shaders"),u=q("__subscene"),P=q("__textures"),p=q("__util"),z=q("__vec3"),l=g.v,M=[],E="",W=!0,G=new Float32Array(2);a.DV_NONE=d.DV_NONE;a.DV_OPAQUE_WIREFRAME=d.DV_OPAQUE_WIREFRAME;a.DV_TRANSPARENT_WIREFRAME=d.DV_TRANSPARENT_WIREFRAME;a.DV_FRONT_BACK_VIEW=d.DV_FRONT_BACK_VIEW;a.DV_BOUNDINGS=
d.DV_BOUNDINGS;a.DV_CLUSTERS_VIEW=d.DV_CLUSTERS_VIEW;a.DV_BATCHES_VIEW=d.DV_BATCHES_VIEW;a.DV_RENDER_TIME=d.DV_RENDER_TIME;a.physics_stats=function(){F.DI()};a.physics_id=function(a){D.log("O",F.iJ(a));for(var b=F.JJ().Wb.ka,c=0;c<b.length;c++){var d=b[c];d.B.N==a&&D.log("B",d)}};a.visible_objects=function(){for(var a=A.get_active(),b=C.xb(a,"MESH",C.DATA_ID_ALL),a=[A.Da(a,u.sb),A.Da(a,u.gc),A.Da(a,u.qd)],c=0;c<a.length;c++){var d=a[c],e=subs.Ea;if(e.length){D.group(d.type,"DYNAMIC");for(var f=0;f<
b.length;f++){var k=b[f],g=k.k;if("DYNAMIC"==g.type)for(var h=!1,l=0;l<e.length;l++){for(var m=e[l].ka,n=0;n<m.length;n++){var p=m[n];if(p.vb&&p.Ig==g){D.le(k.name,k);h=!0;break}}if(h)break}}D.groupEnd();D.groupCollapsed(d.type,"STATIC");for(f=0;f<b.length;f++)if(k=b[f],g=k.k,"DYNAMIC"!=g.type)for(h=!1,l=0;l<e.length;l++){m=e[l].ka;for(n=0;n<m.length;n++)if(p=m[n],p.vb&&p.Ig==g){D.le(k.name,k);h=!0;break}if(h)break}D.groupEnd()}}};a.object_info=function(a){for(var b=A.get_active(),c=C.xb(b,"MESH",
C.DATA_ID_ALL),d=0;d<c.length;d++){var e=c[d];if(e.name==a){D.log("Object",e);for(var f=A.Hu(b),k=0;k<f.length;k++){for(var g=f[k],h=[],l=g.Ea,m=0;m<l.length;m++)for(var n=l[m].ka,p=0;p<n.length;p++)n[p].Ig==e.k&&h.push(n[p]);D.log("Subscene "+g.type,h)}}}};a.objects_stat=function(){var a=A.get_active();console.log("Armatures: "+C.xb(a,"ARMATURE",C.DATA_ID_ALL).length);console.log("Cameras: "+C.xb(a,"CAMERA",C.DATA_ID_ALL).length);console.log("Curves: "+C.xb(a,"CURVE",C.DATA_ID_ALL).length);console.log("Empties: "+
C.xb(a,"EMPTY",C.DATA_ID_ALL).length);console.log("Lamps: "+C.xb(a,"LAMP",C.DATA_ID_ALL).length);console.log("Meshes: "+C.xb(a,"MESH",C.DATA_ID_ALL).length);console.log("Speakers: "+C.xb(a,"SPEAKER",C.DATA_ID_ALL).length)};a.num_vertices=function(){for(var a=0,b=A.get_active(),b=[A.Da(b,u.sb),A.Da(b,u.gc),A.Da(b,u.qd)],c=0;c<b.length;c++){var d=b[c];if(d)for(var d=d.Ea,e=0;e<d.length;e++)for(var f=d[e].ka,k=0;k<f.length;k++){var g=f[k].pa;g&&(a+=g.num_vertices)}}return a};a.num_triangles=function(){for(var a=
0,b=A.get_active(),b=[A.Da(b,u.sb),A.Da(b,u.gc),A.Da(b,u.qd)],c=0;c<b.length;c++){var d=b[c];if(d)for(var d=d.Ea,e=0;e<d.length;e++)for(var f=d[e].ka,k=0;k<f.length;k++){var g=f[k].pa;g&&(a+=g.num_triangles)}}return a};a.num_draw_calls=function(){for(var a=A.get_active(),b=A.Gw(a,[u.sb,u.gc,u.qd,u.Wc,u.Ae]),c=0,d=0;d<b.length;d++)for(var e=b[d],e=e.Ea,f=0;f<e.length;f++)c+=e[f].ka.length;a=A.Gw(a,[u.Jc,u.Vd]);for(d=0;d<a.length;d++)for(e=a[d],e=e.Ea,f=0;f<e.length;f++)c+=6*e[f].ka.length;return c};
a.num_shaders=function(){return p.no(h.Tz())};a.geometry_stats=function(){for(var a=A.get_active(),b=A.Hu(a),a={},c=0;c<b.length;c++){var d=b[c];if(d.type!=u.kl&&d.type!=u.ze)for(var e=d.Ea,f=0;f<e.length;f++)for(var k=e[f].ka,g=0;g<k.length;g++){var h=k[g].pa,l=k[g].Ig;h&&(d.type!=u.Ud&&d.type!=u.Ud||l.km||l.jm)&&(a[h.id]=h)}}var e=d=c=b=0,m;for(m in a)h=a[m],h=h.ja,h.yl&&(d++,e+=h.yl/1048576),b++,c+=h.yq/1048576;return{vbo_number:b,vbo_memory:c,ibo_number:d,ibo_memory:e}};a.num_textures=function(){for(var a=
[],b=0,c=A.get_active(),c=[A.Da(c,u.sb),A.Da(c,u.gc),A.Da(c,u.qd)],d=0;d<c.length;d++){var e=c[d];if(e)for(var e=e.Ea,f=0;f<e.length;f++)for(var k=e[f].ka,g=0;g<k.length;g++){var h=k[g].pa;if(h)for(var h=h.T,l=0;l<h.length;l++){var m=h[l];if("IMAGE"===m.source||"ENVIRONMENT_MAP"===m.source){var n=m.Za;-1===a.indexOf(n)&&(a.push(n),m=m.width*m.height*4/1048576/m.Ln,m*=1.3333,b+=m)}}}}return{number:a.length,memory:b}};a.num_render_targets=function(){for(var a=[],b=0,c=A.get_active(),c=A.Hu(c),d=0;d<
c.length;d++){var e=c[d];if(e.type!=u.kl){var f=e.p,k=[f.Zb,f.ee];k.push.apply(k,e.Sg);for(e=0;e<k.length;e++){var g=k[e];P.Ul(g)&&-1==a.indexOf(g)&&(a.push(g),b+=f.width*f.height*P.lK(g))}}}return{number:a.length,memory:b/1024/1024}};a.make_camera_frustum_shot=function(){var a=A.get_active();(a=A.Da(a,u.sb))&&A.PA(a.p,a,[1,1,0])};a.make_light_frustum_shot=function(){var a=A.get_active(),b=A.Da(a,u.sb),a=A.Gw(a,[u.Ac]);if(b)for(var c=0;c<a.length;c++){var d=a[c],e;switch(c){case 0:e=[1,0,0];break;
case 1:e=[0,1,0];break;case 2:e=[0,0,1];break;default:e=[1,0,1]}A.PA(d.p,b,e)}};a.scenegraph_to_dot=function(){for(var a=A.mo(),b=0;b<a.length;b++)D.log("\n"+H.BI(A.Mu(a[b])))};a.scenes_to_dot=function(){};a.loading_graph_to_dot=function(){D.log("\n"+r.pK())};a.controls_info=v.debug;a.object_distance=function(a,b){var c=m_tsr.get_trans_view(a.k.n),d=m_tsr.get_trans_view(b.k.n);return z.dist(c,d)};a.msg=d.msg;a.fbmsg=d.fbmsg;a.print_telemetry=d.print_telemetry;a.plot_telemetry=d.plot_telemetry;a.fbres=
function(a,b){function c(){d.fbmsg("FBRES",a());setTimeout(c,b)}b||(b=16);c()};a.assert_constants=function(){var a=new Float32Array(3),b=new Float32Array([0,0,0,1]),c=new Float32Array([1,0,0]),d=new Float32Array([0,1,0]),e=new Float32Array([0,0,1]),f=new Float32Array([-1,0,0]),k=new Float32Array([0,-1,0]),g=new Float32Array([0,0,-1]);if(!p.li(a,p.Nx))throw"Wrong VEC3_IDENT";if(!p.li(b,p.il))throw"Wrong QUAT4_IDENT";if(!p.li(c,p.AXIS_X))throw"Wrong AXIS_X";if(!p.li(d,p.AXIS_Y))throw"Wrong AXIS_Y";
if(!p.li(e,p.AXIS_Z))throw"Wrong AXIS_Z";if(!p.li(f,p.AXIS_MX))throw"Wrong AXIS_MX";if(!p.li(k,p.AXIS_MY))throw"Wrong AXIS_MY";if(!p.li(g,p.AXIS_MZ))throw"Wrong AXIS_MZ";};a.mute_music=function(){for(var a=w.get_speaker_objects(),b=0;b<a.length;b++){var c=a[b];"BACKGROUND_MUSIC"==w.Pu(c)&&w.mute(c,!0)}};a.check_finite=function(a){d.check_finite(a)};a.set_debug_params=function(a){var b=A.get_active();if(b=A.Da(b,u.ze)){if("number"==typeof a.debug_view_mode)switch(a.debug_view_mode){case d.DV_NONE:case d.DV_OPAQUE_WIREFRAME:case d.DV_TRANSPARENT_WIREFRAME:case d.DV_FRONT_BACK_VIEW:case d.DV_BOUNDINGS:case d.DV_CLUSTERS_VIEW:case d.DV_BATCHES_VIEW:case d.DV_RENDER_TIME:A.HM(b,
a.debug_view_mode);break;default:D.error("set_debug_params(): Wrong debug view mode")}"number"==typeof a.debug_colors_seed&&A.GM(b,a.debug_colors_seed);"number"==typeof a.oM&&A.eN(b,a.oM);"object"==typeof a.wireframe_edge_color&&A.lN(b,p.f32(a.wireframe_edge_color))}else D.error("Debugging is not available on the scene.")};a.get_error_quantity=function(){return D.WJ()};a.get_warning_quantity=function(){return D.nK()};a.clear_errors_warnings=function(){return D.clear_errors_warnings()};a.analyze_shaders=
function(a){var f=h.Tz(),g=0,l;for(l in f)a&&-1===l.indexOf(a)||g++;var g="of "+g+" analyzing...",n={};for(l in f)if(!a||-1!==l.indexOf(a)){var p=f[l],r;var q=p.Ws;r=p.Nq;var t=k.TJ();if(t){var u=t.getTranslatedShaderSource(q),t=t.getTranslatedShaderSource(r);if(m.detect_mobile())var u=u.replace("#version","#version 300 //"),t=t.replace("#version","#version 300 //"),v=c("/analyze_shader/vert_gles",u),w=c("/analyze_shader/frag_gles",t);else u=u.replace("#version","#version 400 //"),t=t.replace("#version",
"#version 400 //"),v=c("/analyze_shader/vert",u),w=c("/analyze_shader/frag",t);var z=e(v),B=e(w);r={jP:d.Rq().getShaderSource(q),kP:u,iP:v,lP:z,vJ:d.Rq().getShaderSource(r),wJ:t,mJ:w,Eu:B}}else D.error("WEBGL_debug_shaders extension not found"),r=void 0;u=p.qb;q=u.Wg+" + "+u.kf;r.wI=p;r.qb=u;p=n[q]=n[q]||[];p.push(r);D.le(g)}for(q in n)D.group("%c"+q,"color: #800"),p=n[q],b(p),D.groupEnd()};a.fake_load=d.fake_load;a.test_performance=function(b){if(h.Jy())if(k.Ju()){var c=l.gl_debug;l.gl_debug=!0;
var e=H.KH();A.Lz(e);for(var f=H.$b(e,u.an),g=f.p,e=0;5>e;e++)y.Dl(f);l.gl_debug=c;window.setTimeout(function(){d.bM(f);var a=f.Ie;b(a,g.width*g.height*40/(a/1E3)/Math.pow(10,9))},100)}else b(0,0);else window.setTimeout(function(){a.test_performance(b)},100)};a.start_debug=function(a){M=[];W=!0;a=q(a);for(var b in a)"function"===typeof a[b]&&(a[b]=f(a[b],b))};a.check_debug_result=function(){return W};a.test=function(a,b){try{return b(),!0}catch(c){return W=!1,console.error(a+" test was failed. ",
c),!1}};a.pix=function(a){var b=x.fA(),c=x.eA(),d=b/2,e=c/2;x.resize(b,c,!1);b=A.get_active().q.Pa;(c=H.jJ(b))||p.r("Couldn't find onscreen subscene");b=c.p;d=x.jq(d,e,G,c.p);d[1]=b.height-d[1];d=y.aw(b.he,d[0],d[1]);t(a,d,1)};a.eqs=function(a,b){if(JSON.stringify(a)!=JSON.stringify(b))throw"Wrong result. Function: "+E;};a.eqv=t;a.eqf=function(a,b,c){if("number"!=typeof b)throw"Wrong expected data type.";c=c?c:1E-6;if(b>a+c||b<a-c)throw"Wrong result.";};a.eq=function(a,b){if(a!==b)throw"Wrong result.";
};a.stat=function(a){a=q(a);for(var b in a)-1==M.indexOf(a[b])&&console.warn(b+" function wasn't called.")};a.ok=function(a){if(!Boolean(a))throw"Wrong result. Function: "+E;}};b4w.module.geometry=function(a,q){var e=q("__batch"),c=q("__geometry"),b=q("__print"),n=q("__renderer"),f=q("__util");a.extract_vertex_array=function(a,f,m){if(!c.Ol(a))return b.error("Wrong object:",a.name),null;if(a=e.Ra(a,f,"MAIN")){if((f=a.ja)&&f.zb&&f.zb[m])return c.bJ(f,m);b.error("Attribute not found:"+m);return null}b.error("Wrong material:",f);return null};a.extract_index_array=function(a,f){if(!c.Ol(a))return b.error("Wrong object:",a.name),null;var m=e.Ra(a,f,"MAIN");if(m){if((m=m.ja)&&
m.zb)return m.ie;b.error("Buffer data not found");return null}b.error("Wrong material:",f);return null};a.update_vertex_array=function(a,f,m,n){var q=["MAIN","SHADOW","COLOR_ID"];if(c.Ol(a))for(var d=0;d<q.length;d++){var k=e.Ra(a,f,q[d]);k&&(k=k.ja)&&k.zb&&k.zb[m]&&c.TC(k,m,0,n)}else b.error("Wrong object:",a.name)};a.override_geometry=function(a,g,m,q,x){var d=["MAIN","SHADOW","COLOR_ID"];if(c.Ol(a))if(m instanceof Uint16Array||m instanceof Uint32Array)if(q instanceof Float32Array)for(var k=0;k<
d.length;k++){var r=e.Ra(a,g,d[k]);if(r){var C=r.ja;if(C){c.UC(C,r.Lf,m);var B=0,F;for(F in C.zb)var D=C.zb[F],B=B+q.length/3*D.Lb;C.Hc=new Float32Array(B);var B=C.Hc,y=0;for(F in C.zb)switch(D=C.zb[F],F){case "a_position":B.set(q,y);D.offset=y;D.length=q.length;y+=D.length;break;case "a_tbn_quat":var A;x&&(A=c.vy(m,q,q));var H=c.uy(m,q,A);D.length=q.length/3*D.Lb;for(var w=new Float32Array(D.length),h=0;h<w.length;h+=4)w[h]=1,w[h+3]=1;H=f.gen_tbn_quats(H,w);B.set(H,y);D.offset=y;y+=D.length;break;
default:D.offset=y,D.length=q.length/3*D.Lb,H=new Float32Array(D.length),B.set(H,y),y+=D.length}c.ex(C);n.Ct(r);(r=e.Le(a,r))&&r.ja&&(r.ja=C)}}}else b.error("Wrong positions_array type");else b.error("Wrong ibo_array type");else b.error("Wrong object:",a.name)};a.set_shape_key_value=function(a,e,f){c.check_shape_keys(a)?c.Vu(a,e)?c.$x(a,e,parseFloat(f)):b.error("Wrong key name:",e):b.error("Wrong object:",a.name)};a.check_shape_keys=function(a){return c.check_shape_keys(a)};a.get_shape_keys_names=
function(a){return c.check_shape_keys(a)?c.get_shape_keys_names(a):(b.error("Wrong object:",a.name),null)};a.get_shape_key_value=function(a,e){return c.check_shape_keys(a)?c.Vu(a,e)?c.get_shape_key_value(a,e):(b.error("Wrong key name:",e),null):(b.error("Wrong object:",a.name),null)};a.draw_line=function(a,f,m){m=m||!1;if(f instanceof Float32Array){if(a=e.Lu(a))c.draw_line(a,f,m),n.Ct(a)}else b.error("Wrong positions type")}};b4w.module.hud=function(a,q){var e=q("__hud");q("__print");a.draw_mixer_strip=e.draw_mixer_strip;a.plot_array=e.plot_array};b4w.module.input=function(a,q){function e(a){var c=b.get_device_by_type_element(b.DEVICE_HMD);if(!c||!c.bg)return!1;if(r)return!0;var e=b.get_vector_param(c,b.CD,d),f=b.get_vector_param(c,b.DD,k);n.set_hmd_fov(a,e,f);if(e=b.get_value_param(c,F))f=v.get_active(),a=g.ga(a,f).R,n.set_eye_distance(a,e);a={base_line_factor:.5,inter_lens_factor:.5,enable_hmd_stereo:!0};b.get_value_param(b.HMD_WEBVR_TYPE)!==b.HMD_WEBVR1&&(a.distortion_coefs=[c.distortion_coefs[0],c.distortion_coefs[1]],a.chromatic_aberration_coefs=
[c.chromatic_aberration_coefs[0],c.chromatic_aberration_coefs[1],c.chromatic_aberration_coefs[2],c.chromatic_aberration_coefs[3]],c.Vm||(c.ei&&c.xi&&c.gi?a.base_line_factor=(c.ei-c.gi)/c.xi:c.gi||(a.base_line_factor=c.ei/c.xi)),c.uh&&c.cl&&!c.Vm&&(a.inter_lens_factor=c.uh/c.cl),C.enabled||(e=1+c.distortion_coefs[0]+c.distortion_coefs[1],v.WA(e,e)));v.set_hmd_params(a);t.resize_to_container(!0);b.reset_device(c);return r=!0}function c(){for(var a=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?
navigator.webkitGetGamepads:[],b=[],c=0;c<a.length;c++)a[c]&&b.push(c);return b}var b=q("__input"),n=q("__camera"),f=q("__config"),t=q("__container"),g=q("__obj_util"),m=q("__print"),v=q("__scenes"),x=q("__vec4"),d=x.create(),k=x.create(),r=!1,C=f.xq,B=f.v;a.GMPD_BUTTON_12=b.GMPD_BUTTON_12;a.GMPD_BUTTON_13=b.GMPD_BUTTON_13;a.GMPD_BUTTON_15=b.GMPD_BUTTON_15;a.GMPD_BUTTON_14=b.GMPD_BUTTON_14;a.GMPD_BUTTON_3=b.GMPD_BUTTON_3;a.GMPD_BUTTON_0=b.GMPD_BUTTON_0;a.GMPD_BUTTON_1=b.GMPD_BUTTON_1;a.GMPD_BUTTON_2=
b.GMPD_BUTTON_2;a.GMPD_BUTTON_5=b.GMPD_BUTTON_5;a.GMPD_BUTTON_7=b.GMPD_BUTTON_7;a.GMPD_BUTTON_4=b.GMPD_BUTTON_4;a.GMPD_BUTTON_6=b.GMPD_BUTTON_6;a.GMPD_BUTTON_8=b.GMPD_BUTTON_8;a.GMPD_BUTTON_9=b.GMPD_BUTTON_9;a.GMPD_BUTTON_10=b.GMPD_BUTTON_10;a.GMPD_BUTTON_11=b.GMPD_BUTTON_11;a.GMPD_BUTTON_16=b.GMPD_BUTTON_16;a.GMPD_BUTTON_17=b.GMPD_BUTTON_17;a.GMPD_BUTTON_18=b.GMPD_BUTTON_18;a.GMPD_BUTTON_19=b.GMPD_BUTTON_19;a.GMPD_BUTTON_20=b.GMPD_BUTTON_20;a.GMPD_BUTTON_21=b.GMPD_BUTTON_21;a.GMPD_BUTTON_22=b.GMPD_BUTTON_22;
a.GMPD_BUTTON_23=b.GMPD_BUTTON_23;a.GMPD_BUTTON_24=b.GMPD_BUTTON_24;a.GMPD_BUTTON_25=b.GMPD_BUTTON_25;a.GMPD_AXIS_0=b.GMPD_AXIS_0;a.GMPD_AXIS_1=b.GMPD_AXIS_1;a.GMPD_AXIS_2=b.GMPD_AXIS_2;a.GMPD_AXIS_3=b.GMPD_AXIS_3;a.GMPD_AXIS_4=b.GMPD_AXIS_4;a.GMPD_AXIS_5=b.GMPD_AXIS_5;a.GMPD_AXIS_6=b.GMPD_AXIS_6;a.GMPD_AXIS_7=b.GMPD_AXIS_7;a.GMPD_AXIS_8=b.GMPD_AXIS_8;a.GMPD_AXIS_9=b.GMPD_AXIS_9;a.GMPD_AXIS_10=b.GMPD_AXIS_10;a.GMPD_AXIS_11=b.GMPD_AXIS_11;a.HMD_ORIENTATION_QUAT=b.HMD_ORIENTATION_QUAT;a.HMD_POSITION=
b.HMD_POSITION;a.HMD_WEBVR_TYPE=b.HMD_WEBVR_TYPE;a.HMD_WEBVR_DESKTOP=b.HMD_WEBVR_DESKTOP;a.HMD_WEBVR_MOBILE=b.HMD_WEBVR_MOBILE;a.HMD_NON_WEBVR=b.HMD_NON_WEBVR;a.HMD_WEBVR1=b.HMD_WEBVR1;var F=b.HMD_EYE_DISTANCE;a.HMD_EYE_DISTANCE=F;a.HMD_DISTORTION=b.HMD_DISTORTION;a.HMD_BASELINE_DIST=b.HMD_BASELINE_DIST;a.HMD_SCREEN_LENSE_DIST=b.HMD_SCREEN_LENSE_DIST;a.HMD_SCREEN_WIDTH=b.HMD_SCREEN_WIDTH;a.HMD_SCREEN_HEIGHT=b.HMD_SCREEN_HEIGHT;a.HMD_BEVEL_SIZE=b.HMD_BEVEL_SIZE;a.MOUSE_LOCATION=b.MOUSE_LOCATION;a.MOUSE_DOWN_WHICH=
b.MOUSE_DOWN_WHICH;a.MOUSE_UP_WHICH=b.MOUSE_UP_WHICH;a.MOUSE_WHEEL=b.MOUSE_WHEEL;a.KEYBOARD_UP=b.KEYBOARD_UP;a.KEYBOARD_DOWN=b.KEYBOARD_DOWN;a.TOUCH_START=b.TOUCH_START;a.TOUCH_MOVE=b.TOUCH_MOVE;a.TOUCH_END=b.TOUCH_END;a.GYRO_ORIENTATION_QUAT=b.GYRO_ORIENTATION_QUAT;a.GYRO_ORIENTATION_ANGLES=b.GYRO_ORIENTATION_ANGLES;var D={};D[b.DEVICE_HMD]=[b.HMD_ORIENTATION_QUAT,b.HMD_POSITION];D[b.DEVICE_MOUSE]=[b.MOUSE_LOCATION];var y={};y[b.DEVICE_HMD]=[b.HMD_WEBVR_TYPE];var A={};A[b.DEVICE_MOUSE]=[b.MOUSE_LOCATION,
b.MOUSE_DOWN_WHICH,b.MOUSE_UP_WHICH,b.MOUSE_WHEEL];A[b.DEVICE_KEYBOARD]=[b.KEYBOARD_UP,b.KEYBOARD_DOWN];A[b.DEVICE_TOUCH]=[b.TOUCH_START,b.TOUCH_MOVE,b.TOUCH_END];A[b.DEVICE_GYRO]=[b.GYRO_ORIENTATION_QUAT,b.GYRO_ORIENTATION_ANGLES];var H={};H[b.DEVICE_HMD]=[b.HMD_DISTORTION,b.HMD_EYE_DISTANCE,b.HMD_BASELINE_DIST,b.HMD_SCREEN_LENSE_DIST,b.HMD_SCREEN_WIDTH,b.HMD_SCREEN_HEIGHT,b.HMD_BEVEL_SIZE];a.DEVICE_GYRO=b.DEVICE_GYRO;a.DEVICE_HMD=b.DEVICE_HMD;a.DEVICE_MOUSE=b.DEVICE_MOUSE;a.DEVICE_KEYBOARD=b.DEVICE_KEYBOARD;
a.DEVICE_TOUCH=b.DEVICE_TOUCH;a.can_use_device=b.can_use_device;a.get_device_by_type_element=b.get_device_by_type_element;a.switch_prevent_default=function(a,c){a&&b.switch_prevent_default(a,c)};a.register_device=function(){m.uc("input.register_device() deprecated")};a.reset_device=function(a){a&&a.type==b.DEVICE_HMD?b.reset_device(a):m.error("reset_device is undefined for device.")};a.get_vector_param=function(a,c,d){if(a&&a.type in D&&0<=D[a.type].indexOf(c))return b.get_vector_param(a,c,d);m.error("device hasn't param: ",
c)};a.get_value_param=function(a,c){if(a&&a.type in y&&0<=y[a.type].indexOf(c))return b.get_value_param(a,c);m.error("device hasn't param: ",c)};a.attach_param_cb=function(a,c,d){if(a&&a.type in A&&0<=A[a.type].indexOf(c))return b.attach_param_cb(a,c,d);m.error("device hasn't param: ",c)};a.detach_param_cb=function(a,c,d){if(a&&a.type in A&&0<=A[a.type].indexOf(c))return b.detach_param_cb(a,c,d);m.error("device hasn't param: ",c)};a.set_config=function(a,c,d){if(a&&a.type in H&&0<=H[a.type].indexOf(c))return b.set_config(a,
c,d);m.error("device hasn't config: ",c)};a.request_fullscreen_hmd=function(){if(v.Ba()){var a=v.hk(v.get_active());if(a&&(e(a),a=b.get_device_by_type_element(b.DEVICE_HMD))){var c=a.af;c&&!c.isPresenting&&(c.capabilities.canPresent?(a=t.get_canvas(),c.requestPresent([{source:a}]).then(function(){if(!B.is_mobile_device){var a=c.getEyeParameters("left"),b=c.getEyeParameters("right");t.resize(2*Math.max(a.renderWidth,b.renderWidth),Math.max(a.renderHeight,b.renderHeight),!1)}},function(){m.error("HMD fullscreen request failed.")})):
m.error("HMD fullscreen request failed."))}}};a.enable_split_screen=e;a.disable_split_screen=function(){var a=b.get_device_by_type_element(b.DEVICE_HMD);if(!(r||a&&a.bg))return!1;v.set_hmd_params({enable_hmd_stereo:!1});a=1/(1+a.distortion_coefs[0]+a.distortion_coefs[1]);v.WA(a,a);t.resize_to_container(!0);return!0};a.set_gamepad_key=function(a,d,e){c();switch(a){case 0:a=b.Fp;break;case 1:a=b.kt;break;case 2:a=b.lt;break;case 3:a=b.mt;break;default:a=b.Fp}a=b.get_device_by_type_element(a);b.set_config(a,
d,e)};a.get_pressed_gmpd_btn=b.get_pressed_gmpd_btn;a.get_moved_gmpd_axis=b.get_moved_gmpd_axis;a.check_enable_gamepad_indices=c};b4w.module.lights=function(a,q){function e(a){for(var c=g.get_active(),e=n.xb(c,"LAMP",n.DATA_ID_ALL),f=0;f<e.length;f++){var r=e[f];if("SUN"==r.Ta.type){var q=r;break}}if(!q)t.error("There is no sun on the scene");else if("number"==typeof a.hor_position&&"number"==typeof a.vert_position){e=x.deg_to_rad(180-a.hor_position);a=x.deg_to_rad(90-a.vert_position);f=q.k;m.set_rotation_euler(q,[a,0,e]);e=new Float32Array(3);r=v.get_quat_view(f.n);x.quat_to_dir(r,x.AXIS_Z,e);f=v.get_trans_view(f.n);f=d.length(f);
d.copy(e,k);d.scale(k,f,k);m.set_translation(q,k);m.A(q);e=q.Ta;if(e.rz){var w=c.world.light_settings.environment_energy,f=c.world.horizon_color,r=c.world.zenith_color,h=Math.cos(Math.abs(a));a=Math.max(Math.min(3*h,1),0)*e.jz;w*=Math.max(h,.1);b.set_light_energy(e,a);g.set_environment_colors(c,w,f,r)}g.Nm(q,c)}}function c(a){if(f.is_lamp(a))return a.Ta.type;t.error("get_light_type(): Wrong object");return!1}var b=q("__lights"),n=q("__objects"),f=q("__obj_util"),t=q("__print"),g=q("__scenes"),m=q("__transform"),
v=q("__tsr"),x=q("__util"),d=q("__vec3"),k=new Float32Array(3),r,C=60;a.get_lamps=function(a){var b=g.get_active(),b=n.xb(b,"LAMP",n.DATA_ID_ALL);if(!a)return b;for(var c=[],d=0;d<b.length;d++){var e=b[d];e.Ta.type===a&&c.push(e)}return c};a.get_sun_params=function(){for(var a=g.get_active(),a=n.xb(a,"LAMP",n.DATA_ID_ALL),b=null,c=0;c<a.length;c++){var d=a[c];if("SUN"==d.Ta.type){b=d;break}}return b?(b=b.Ta.direction,a=x.rad_to_deg(Math.atan2(-b[1],b[0]))+90,180<a&&(a-=360),b=x.rad_to_deg(Math.atan2(b[2],
Math.sqrt(b[0]*b[0]+b[1]*b[1]))),c={},c.hor_position=a,c.vert_position=b,c):null};a.set_sun_params=e;a.set_day_time=function(a){for(var b=g.get_active(),b=n.xb(b,"LAMP",n.DATA_ID_ALL),c=0;c<b.length;c++){var d=b[c];if("SUN"==d.Ta.type){var f=d;break}}f?(f=-Math.cos(a/12*Math.PI)*C,b={},b.hor_position=12>a?15*a:15*(a-24),b.vert_position=f,e(b)):t.error("There is no sun on the scene")};a.set_date=function(a){(r=a.getDate())?1582==r&&10==a.yR&&4<a.AI&&15>a.AI&&t.error("The dates 5 through 14 October, 1582, do not exist in the Gregorian system!"):
t.error("There is no year 0 in the Julian system!")};a.set_max_sun_angle=function(a){C=Math.min(Math.max(a,0),90)};a.get_light_params=function(a){if(f.is_lamp(a))var b=a.Ta;else return t.error("get_light_params(): Wrong object"),null;if(a=c(a))switch(a){case "SPOT":var d={light_type:a,light_color:new Float32Array(3),light_energy:b.Je,light_spot_blend:b.mp,light_spot_size:b.Pk,light_distance:b.distance};d.light_color.set(b.color);break;case "POINT":d={light_type:a,light_color:new Float32Array(3),light_energy:b.Je,
light_distance:b.distance};d.light_color.set(b.color);break;default:d={light_type:a,light_color:new Float32Array(3),light_energy:b.Je},d.light_color.set(b.color)}return d?d:null};a.get_light_type=c;a.set_light_params=function(a,c){if(f.is_lamp(a)){var d=a.Ta,e=g.get_active(),k=!1;"number"==typeof c.light_energy&&b.set_light_energy(d,c.light_energy);"object"==typeof c.light_color&&b.set_light_color(d,c.light_color);"number"==typeof c.light_spot_blend&&(b.WM(d,c.light_spot_blend),k=!0);"number"==typeof c.light_spot_size&&
(b.XM(d,c.light_spot_size),k=!0);"number"==typeof c.light_distance&&(b.VM(d,c.light_distance),k=!0);g.Nm(a,e);k&&g.gO(e)}else t.error("set_light_params(): Wrong object")};a.get_light_energy=function(a){return f.is_lamp(a)?a.Ta.Je:(t.error("get_light_energy(): Wrong object"),0)};a.set_light_energy=function(a,c){if(f.is_lamp(a)){var d=g.get_active();b.set_light_energy(a.Ta,c);g.Nm(a,d)}else t.error("set_light_energy(): Wrong object")};a.get_light_color=function(a,b){if(!f.is_lamp(a))return t.error("get_light_color(): Wrong object"),
null;b=b||new Float32Array(3);b.set(a.Ta.color);return b};a.set_light_color=function(a,c){if(f.is_lamp(a)){var d=g.get_active();b.set_light_color(a.Ta,c);g.Nm(a,d)}else t.error("set_light_color(): Wrong object")}};b4w.module.logic_nodes=function(a,q){var e=q("__logic_nodes");a.append_custom_callback=function(a,b){e.IF(a,b)};a.remove_custom_callback=function(a){e.gM(a)};a.run_entrypoint=function(a,b){e.yM(a,b)}};b4w.module.material=function(a,q){function e(a,b){for(var c=a.D[0].U,d=0;d<c.length;d++){var e=c[d];if(-1<e.cc.indexOf(b)&&"MAIN"==e.type)return!0}return!1}function c(a,b){var c=n.Ra(a,b,"MAIN");return Boolean(c&&c.Bd[0])}function b(a,b){var c=n.Ra(a,b,"MAIN");return Boolean(c&&c.Bd[1])}var n=q("__batch"),f=q("__config"),t=q("__obj_util"),g=q("__print"),m=q("__shaders"),v=q("__util"),x=q("__scenes"),d=f.v;a.inherit_material=function(a,b,c,d){t.pk(c)&&t.pk(a)?n.inherit_material(a,b,c,d):g.error("Wrong or batched object(s)")};
a.get_materials_names=function(a){var b=[];a=a.D;for(var c=0;c<a.length;c++)for(var d=a[c].U,e=0;e<d.length;e++)for(var f=0;f<d[e].cc.length;f++)-1==b.indexOf(d[e].cc[f])&&b.push(d[e].cc[f]);return b};a.set_diffuse_color=function(a,b,c){var d=n.Ra(a,b,"MAIN");d?(d.Zc.set(c),(a=n.Le(a,b,"MAIN"))&&a.Zc.set(c)):g.error('Couldn\'t set property "diffuse_color"!')};a.get_diffuse_color=function(a,b){var c=n.Ra(a,b,"MAIN");if(c){var d=new Float32Array(4);d.set(c.Zc);return d}g.error('Couldn\'t get property "diffuse_color"!')};
a.set_diffuse_intensity=function(a,b,c){var d=n.Ra(a,b,"MAIN");if(d){if(d.wg=c,a=n.Le(a,b,"MAIN"))a.wg=c}else g.error('Couldn\'t set property "diffuse_color"!')};a.get_diffuse_intensity=function(a,b){var c=n.Ra(a,b,"MAIN");if(c)return c.wg;g.error('Couldn\'t get property "diffuse_intensity"!')};a.set_specular_color=function(a,b,c){var d=n.Ra(a,b,"MAIN");d?(d.zf.set(c),(a=n.Le(a,b,"MAIN"))&&a.zf.set(c)):g.error('Couldn\'t set property "specular_color"!')};a.get_specular_color=function(a,b){var c=n.Ra(a,
b,"MAIN");if(c){var d=Array(3);d[0]=c.zf[0];d[1]=c.zf[1];d[2]=c.zf[2];return d}g.error('Couldn\'t get property "specular_color"!')};a.set_specular_color_factor=function(a,b,c){var d=n.Ra(a,b,"MAIN");if(d){if(d.Mh=c,a=n.Le(a,b,"MAIN"))a.Mh=c}else g.error('Couldn\'t set property "specular_color_factor"!')};a.get_specular_color_factor=function(a,b){var c=n.Ra(a,b,"MAIN");if(c)return c.Mh;g.error('Couldn\'t get property "specular_color_factor"!')};a.set_specular_intensity=function(a,b,d){c(a,b)||g.error('Property "specular_intensity" is missing!');
n.Ra(a,b,"MAIN").Bd[0]=d;(a=n.Le(a,b,"MAIN"))&&(a.Bd[0]=d)};a.get_specular_intensity=function(a,b){c(a,b)||g.error('Property "specular_intensity" is missing!');return n.Ra(a,b,"MAIN").Bd[0]};a.check_specular_intensity=c;a.set_specular_hardness=function(a,c,d){b(a,c)||g.error('Property "specular_hardness" is missing!');n.Ra(a,c,"MAIN").Bd[1]=d;(a=n.Le(a,c,"MAIN"))&&(a.Bd[1]=d)};a.get_specular_hardness=function(a,c){b(a,c)||g.error('Property "specular_hardness" is missing!');return n.Ra(a,c,"MAIN").Bd[1]};
a.check_specular_hardness=b;a.set_emit_factor=function(a,b,c){var d=n.Ra(a,b,"MAIN");if(d){if(d.Mf=c,a=n.Le(a,b,"MAIN"))a.Mf=c}else g.error('Couldn\'t set property "emit_factor"!')};a.get_emit_factor=function(a,b){var c=n.Ra(a,b,"MAIN");if(c)return c.Mf;g.error('Couldn\'t get property "emit_factor"!')};a.set_ambient_factor=function(a,b,c){var d=n.Ra(a,b,"MAIN");if(d){if(d.Ff=c,a=n.Le(a,b,"MAIN"))a.Ff=c}else g.error('Couldn\'t set property "ambient_factor"!')};a.get_ambient_factor=function(a,b){var c=
n.Ra(a,b,"MAIN");if(c)return c.Ff;g.error('Couldn\'t get property "ambient_factor"!')};a.set_diffuse_color_factor=function(a,b,c){var d=n.Ra(a,b,"MAIN");if(d){if(d.vg=c,a=n.Le(a,b,"MAIN"))a.vg=c}else g.error('Couldn\'t set property "diffuse_color_factor"!')};a.get_diffuse_color_factor=function(a,b){var c=n.Ra(a,b,"MAIN");if(c)return c.vg;g.error('Couldn\'t get property "diffuse_color_factor"!')};a.set_alpha_factor=function(a,b,c){var d=n.Ra(a,b,"MAIN");if(d){if(d.og=c,a=n.Le(a,b,"MAIN"))a.og=c}else g.error('Couldn\'t set property "alpha_factor"!')};
a.get_alpha_factor=function(a,b){var c=n.Ra(a,b,"MAIN");if(c)return c.og;g.error('Couldn\'t get property "alpha_factor"!')};a.get_material_extended_params=function(a,b){if(!a||!b)return g.error("missing arguments in get_material_params"),null;if(!e(a,b))return null;var c=n.Ra(a,b,"MAIN");if(!c)return null;var d={};"MAIN"==c.type&&(d.reflect_factor=c.reflect_factor,d.fresnel=c.Me[2],d.fresnel_factor=5*(1-c.Me[3]),d.parallax_scale=c.parallax_scale,d.parallax_steps=n.ad(c,"PARALLAX_STEPS")[1]);return d};
a.get_water_material_params=function(a,b){if(!a||!b)return g.error("missing arguments in get_water_material_params"),null;if(!e(a,b))return null;var c=n.Ra(a,b,"MAIN");if(!c||!c.Xg)return null;if(!c)return g.error("material not found"),null;var f={};if("MAIN"==c.type){if(d.qm){var m=f.shallow_water_col=Array(3);m[0]=c.shallow_water_col[0];m[1]=c.shallow_water_col[1];m[2]=c.shallow_water_col[2];m=f.shore_water_col=Array(3);m[0]=c.shore_water_col[0];m[1]=c.shore_water_col[1];m[2]=c.shore_water_col[2];
f.shallow_water_col_fac=c.shallow_water_col_fac;f.shore_water_col_fac=c.shore_water_col_fac}f.foam_factor=c.foam_factor;f.norm_uv_velocity=c.pj;f.absorb_factor=n.ad(c,"ABSORB")[1];f.sss_strength=n.ad(c,"SSS_STRENGTH")[1];f.sss_width=n.ad(c,"SSS_WIDTH")[1];f.dst_noise_scale0=n.ad(c,"DST_NOISE_SCALE_0")[1];f.dst_noise_scale1=n.ad(c,"DST_NOISE_SCALE_1")[1];f.dst_noise_freq0=n.ad(c,"DST_NOISE_FREQ_0")[1];f.dst_noise_freq1=n.ad(c,"DST_NOISE_FREQ_1")[1];f.dir_min_shore_fac=n.ad(c,"DIR_MIN_SHR_FAC")[1];
f.dir_freq=n.ad(c,"DIR_FREQ")[1];f.dir_noise_scale=n.ad(c,"DIR_NOISE_SCALE")[1];f.dir_noise_freq=n.ad(c,"DIR_NOISE_FREQ")[1];f.dir_min_noise_fac=n.ad(c,"DIR_MIN_NOISE_FAC")[1];f.dst_min_fac=n.ad(c,"DST_MIN_FAC")[1];f.waves_hor_fac=n.ad(c,"WAVES_HOR_FAC")[1]}return f};a.set_material_extended_params=function(a,b,c){if(a&&b&&c)if(e(a,b)){var d=n.Ra(a,b,"MAIN");if(d){var f=[d];(d=n.Le(a,b,"MAIN"))&&f.push(d);for(a=0;a<f.length;a++)d=f[a],"number"==typeof c.material_reflectivity&&(d.reflect_factor=c.material_reflectivity),
"number"==typeof c.material_fresnel&&(d.Me[2]=c.material_fresnel),"number"==typeof c.material_fresnel_factor&&(d.Me[3]=1-c.material_fresnel_factor/5),"number"==typeof c.material_parallax_scale&&(d.parallax_scale=c.material_parallax_scale),"number"==typeof c.material_parallax_steps&&(b=m.F(parseFloat(c.material_parallax_steps)),n.Va(d,"PARALLAX_STEPS",b),n.fc(d),x.EB(d))}else g.error("material not found")}else g.error("setting material params is not possible");else g.error("missing arguments in set_material_params")};
a.set_water_material_params=function(a,b,c){if(a&&b&&c)if(e(a,b)){var f=n.Ra(a,b,"MAIN");if(f){var q=[f];(f=n.Le(a,b,"MAIN"))&&q.push(f);for(a=0;a<q.length;a++)f=q[a],d.qm&&("object"==typeof c.shallow_water_col&&f.shallow_water_col.set(c.shallow_water_col),"number"==typeof c.shallow_water_col_fac&&(f.shallow_water_col_fac=c.shallow_water_col_fac),"object"==typeof c.shore_water_col&&f.shore_water_col.set(c.shore_water_col),"number"==typeof c.shore_water_col_fac&&(f.shore_water_col_fac=c.shore_water_col_fac)),
d.shore_smoothing&&f.Um&&("boolean"==typeof c.shore_smoothing&&(c.shore_smoothing?n.Va(f,"SHORE_SMOOTHING",1):n.Va(f,"SHORE_SMOOTHING",0)),"number"==typeof c.absorb_factor&&(b=m.F(parseFloat(c.absorb_factor)),n.Va(f,"ABSORB",b))),"number"==typeof c.foam_factor&&d.Il&&(f.foam_factor=c.foam_factor),"number"==typeof c.norm_uv_velocity&&(f.pj=c.norm_uv_velocity),d.water_dynamic&&f.water_dynamic&&("boolean"==typeof c.water_dynamic&&(c.water_dynamic?n.Va(f,"DYNAMIC",1):n.Va(f,"DYNAMIC",0)),"number"==typeof c.waves_height&&
(b=m.F(parseFloat(c.waves_height)),n.Va(f,"WAVES_HEIGHT",b)),"number"==typeof c.waves_length&&(b=m.F(parseFloat(c.waves_length)),n.Va(f,"WAVES_LENGTH",b)),"number"==typeof c.sss_strength&&(b=m.F(parseFloat(c.sss_strength)),n.Va(f,"SSS_STRENGTH",b)),"number"==typeof c.sss_width&&(b=m.F(parseFloat(c.sss_width)),n.Va(f,"SSS_WIDTH",b)),"number"==typeof c.dst_noise_scale0&&(b=m.F(parseFloat(c.dst_noise_scale0)),n.Va(f,"DST_NOISE_SCALE_0",b)),"number"==typeof c.dst_noise_scale1&&(b=m.F(parseFloat(c.dst_noise_scale1)),
n.Va(f,"DST_NOISE_SCALE_1",b)),"number"==typeof c.dst_noise_freq0&&(b=m.F(parseFloat(c.dst_noise_freq0)),n.Va(f,"DST_NOISE_FREQ_0",b)),"number"==typeof c.dst_noise_freq1&&(b=m.F(parseFloat(c.dst_noise_freq1)),n.Va(f,"DST_NOISE_FREQ_1",b)),"number"==typeof c.dir_min_shore_fac&&(b=m.F(parseFloat(c.dir_min_shore_fac)),n.Va(f,"DIR_MIN_SHR_FAC",b)),"number"==typeof c.dir_freq&&(b=m.F(parseFloat(c.dir_freq)),n.Va(f,"DIR_FREQ",b)),"number"==typeof c.dir_noise_scale&&(b=m.F(parseFloat(c.dir_noise_scale)),
n.Va(f,"DIR_NOISE_SCALE",b)),"number"==typeof c.dir_noise_freq&&(b=m.F(parseFloat(c.dir_noise_freq)),n.Va(f,"DIR_NOISE_FREQ",b)),"number"==typeof c.dir_min_noise_fac&&(b=m.F(parseFloat(c.dir_min_noise_fac)),n.Va(f,"DIR_MIN_NOISE_FAC",b)),"number"==typeof c.dst_min_fac&&(b=m.F(parseFloat(c.dst_min_fac)),n.Va(f,"DST_MIN_FAC",b)),"number"==typeof c.waves_hor_fac&&(b=m.F(parseFloat(c.waves_hor_fac)),n.Va(f,"WAVES_HOR_FAC",b))),n.fc(f),x.EB(f)}else g.error("material not found")}else g.error("setting water material params is not possible");
else g.error("missing arguments in set_water_material_params")};a.set_line_params=function(a,b){var c=n.Lu(a);c?(v.of(b.color)&&c.Zc.set(b.color),v.of(b.width)&&(c.Zl=b.width)):g.error("Couldn't set line params!")};a.get_line_params=function(a){if(a=n.Lu(a))return{color:new Float32Array(a.Zc),width:a.Zl};g.error("Couldn't get line params");return null}};b4w.module.math=function(a,q){var e=q("__vec3"),c=q("__util"),b=q("__math"),n=new Float32Array(3);a.create_pline_from_points=function(a,c){var g=new Float32Array(6);b.cN(g,a);e.subtract(c,a,n);b.set_pline_directional_vec(g,n);return g};a.create_pline_from_point_vec=function(a,c){var e=new Float32Array(6);b.cN(e,a);b.set_pline_directional_vec(e,c);return e};a.create_pline=function(){return new Float32Array(6)};a.get_pline_directional_vec=b.get_pline_directional_vec;a.get_pline_initial_point=b.get_pline_initial_point;
a.set_pline_initial_point=b.set_pline_initial_point;a.set_pline_directional_vec=b.set_pline_directional_vec;a.line_plane_intersect=c.line_plane_intersect;a.calc_pline_point=b.calc_pline_point;a.point_plane_dist=b.point_plane_dist};b4w.module.particles=function(a,q){var e=q("__particles"),c=q("__print");a.set_size=function(a,n,f){e.hm(a)?e.set_size(a,n,f):c.error('"',a.name,'" has no particle systems')};a.set_normal_factor=function(a,n,f){e.hm(a)?e.set_normal_factor(a,n,f):c.error('"',a.name,'" has no particle systems')};a.set_factor=function(a,n,f){e.hm(a)?(f=Math.min(f,1),f=Math.max(f,0),e.set_factor(a,n,f)):c.error('"',a.name,'" has no particle systems')}};b4w.module.physics=function(a,q){q("__config");var e=q("__ipc"),c=q("__physics"),b=q("__print"),n=q("__util");a.CM_WALK=0;a.CM_RUN=1;a.CM_CLIMB=2;a.CM_FLY=3;a.enable_simulation=function(a){c.ha(a)?c.enable_simulation(a):b.error("No physics for object "+a.name)};a.disable_simulation=function(a){c.ha(a)?c.disable_simulation(a):b.error("No physics for object "+a.name)};a.has_physics=function(a){return c.ha(a)};a.has_simulated_physics=function(a){return c.has_simulated_physics(a)};a.has_dynamic_physics=
function(a){return c.has_dynamic_physics(a)};a.set_gravity=function(a,e){c.ha(a)?c.set_gravity(a,e):b.error("No physics for object "+a.name)};a.set_damping=function(a,e,g){c.ha(a)?c.S("set_damping",a.B.N,e,g):b.error("No physics for object "+a.name)};a.reset_damping=function(a){if(c.ha(a)){var e=a.$f;c.S("set_damping",a.B.N,e.ou,e.kw)}else b.error("No physics for object "+a.name)};a.set_transform=function(a,e,g){c.ha(a)?c.set_transform(a,e,g):b.error("No physics for object "+a.name)};a.sync_transform=
function(a){c.ha(a)?c.sync_transform(a):b.error("No physics for object "+a.name)};a.apply_velocity=function(a,e,g,m){c.ha(a)?c.apply_velocity(a,e,g,m):b.error("No physics for object "+a.name)};a.apply_velocity_world=function(a,e,g,m){c.ha(a)?c.apply_velocity_world(a,e,g,m):b.error("No physics for object "+a.name)};a.apply_force=function(a,e,g,m){c.ha(a)?c.apply_force(a,e,g,m,!1):b.error("No physics for object "+a.name)};a.apply_force_world=function(a,e,g,m){c.ha(a)?c.apply_force(a,e,g,m,!0):b.error("No physics for object "+
a.name)};a.apply_torque=function(a,e,g,m){c.ha(a)?c.apply_torque(a,e,g,m):b.error("No physics for object "+a.name)};a.vehicle_throttle=function(a,e){c.ha(a)?(c.is_vehicle_chassis(a)||c.is_vehicle_hull(a)||b.error("Wrong object"),c.vehicle_throttle(a,n.clamp(e,-1,1))):b.error("No physics for object "+a.name)};a.vehicle_throttle_inc=function(a,e,g){if(c.ha(a)){c.is_vehicle_chassis(a)||c.is_vehicle_hull(a)||b.error("Wrong object");e=n.clamp(e,0,1);var m=a.u.El;-1==g||1==g?m=Math.max(-1,Math.min(m+g*
e,1)):0==g&&0<=m?(m-=e,m=Math.max(0,m)):0==g&&0>m?(m+=e,m=Math.min(0,m)):b.error("Wrong steering direction");c.vehicle_throttle(a,n.clamp(m,-1,1))}else b.error("No physics for object "+a.name)};a.vehicle_steer=function(a,e){c.ha(a)?(c.is_vehicle_chassis(a)||c.is_vehicle_hull(a)||b.error("Wrong object"),c.vehicle_steer(a,n.clamp(e,-1,1))):b.error("No physics for object "+a.name)};a.vehicle_steer_inc=function(a,e,g){if(c.ha(a)){c.is_vehicle_chassis(a)||c.is_vehicle_hull(a)||b.error("Wrong object");
e=n.clamp(e,0,1);var m=a.u.zm;-1==g||1==g?m=Math.max(-1,Math.min(m+g*e,1)):0==g&&0<=m?(m-=e,m=Math.max(0,m)):0==g&&0>m?(m+=e,m=Math.min(0,m)):b.error("Wrong steering direction");c.vehicle_steer(a,n.clamp(m,-1,1))}else b.error("No physics for object "+a.name)};a.vehicle_brake=function(a,e){c.ha(a)?(c.is_vehicle_chassis(a)||c.is_vehicle_hull(a)||b.error("Wrong object"),c.vehicle_brake(a,n.clamp(e,0,1))):b.error("No physics for object "+a.name)};a.vehicle_brake_inc=function(a,e){if(c.ha(a)){c.is_vehicle_chassis(a)||
c.is_vehicle_hull(a)||b.error("Wrong object");e=n.clamp(e,-1,1);var g=a.u.un;c.vehicle_brake(a,n.clamp(g+g*e,0,1))}else b.error("No physics for object "+a.name)};a.is_vehicle_chassis=function(a){return c.is_vehicle_chassis(a)};a.is_vehicle_hull=function(a){return c.is_vehicle_hull(a)};a.get_vehicle_name=function(a){if(!c.ha(a))return b.error("No physics for object "+a.name),null;if(c.is_vehicle_chassis(a)||c.is_vehicle_hull(a))return a.we.name;b.error("Wrong object");return null};a.get_vehicle_throttle=
function(a){if(!c.ha(a))return b.error("No physics for object "+a.name),null;if(c.is_vehicle_chassis(a)||c.is_vehicle_hull(a))return a.u.El;b.error("Wrong object");return null};a.get_vehicle_steering=function(a){if(!c.ha(a))return b.error("No physics for object "+a.name),null;if(c.is_vehicle_chassis(a)||c.is_vehicle_hull(a))return a.u.zm;b.error("Wrong object")};a.get_vehicle_brake=function(a){if(!c.ha(a))return b.error("No physics for object "+a.name),null;if(c.is_vehicle_chassis(a)||c.is_vehicle_hull(a))return a.u.un;
b.error("Wrong object")};a.get_vehicle_speed=function(a){if(!c.ha(a))return b.error("No physics for object "+a.name),null;if(c.is_vehicle_chassis(a)||c.is_vehicle_hull(a))return c.get_vehicle_speed(a);b.error("Wrong object")};a.is_character=function(a){return c.is_character(a)};a.set_character_move_dir=function(a,e,g){c.ha(a)?c.set_character_move_dir(a,e,g):b.error("No physics for object "+a.name)};a.set_character_move_type=function(a,e){c.ha(a)?c.set_character_move_type(a,e):b.error("No physics for object "+
a.name)};a.set_character_walk_velocity=function(a,e){c.ha(a)?c.set_character_walk_velocity(a,e):b.error("No physics for object "+a.name)};a.set_character_run_velocity=function(a,e){c.ha(a)?c.set_character_run_velocity(a,e):b.error("No physics for object "+a.name)};a.set_character_fly_velocity=function(a,e){c.ha(a)?c.set_character_fly_velocity(a,e):b.error("No physics for object "+a.name)};a.character_jump=function(a){c.ha(a)?c.character_jump(a):b.error("No physics for object "+a.name)};a.character_rotation_inc=
function(a,e,g){c.ha(a)?c.character_rotation_inc(a,e,g):b.error("No physics for object "+a.name)};a.set_character_rotation=function(a,e,g){c.ha(a)?c.set_character_rotation(a,e,g):b.error("No physics for object "+a.name)};a.set_character_rotation_v=function(a,e){c.ha(a)?c.set_character_rotation_v(a,e):b.error("No physics for object "+a.name)};a.set_character_rotation_h=function(a,e){c.ha(a)?c.set_character_rotation_h(a,e):b.error("No physics for object "+a.name)};a.append_collision_test=function(a,
e,g,m){c.ha(a)?c.append_collision_test(a,e,g,m||!1):b.error("No physics for object "+a.name)};a.remove_collision_test=function(a,e,g){c.ha(a)?c.remove_collision_test(a,e||"ANY",g):b.error("No physics for object "+a.name)};a.apply_collision_impulse_test=function(a,e){c.ha(a)?c.apply_collision_impulse_test(a,e):b.error("No physics for object "+a.name)};a.clear_collision_impulse_test=function(a){c.ha(a)?c.clear_collision_impulse_test(a):b.error("No physics for object "+a.name)};a.append_ray_test=function(a,
e,g,m,n,q){a=a||null;if(null==a||c.ha(a))return c.append_ray_test(a,e,g,m,n,q||!1,!1,!1,!1);b.error("No physics for object "+a.name)};a.append_ray_test_ext=function(a,e,g,m,n,q,d,k,r){a=a||null;if(null==a||c.ha(a))return c.append_ray_test(a,e,g,m,n,q||!1,d||!1,k||!1,r||!1);b.error("No physics for object "+a.name)};a.remove_ray_test=function(a){c.wA(a)?c.remove_ray_test(a):b.error("Wrong ray test ID")};a.change_ray_test_from_to=function(a,e,g){c.wA(a)?c.change_ray_test_from_to(a,e,g):b.error("Wrong ray test ID")};
a.apply_constraint=function(a,e,g,m,n,q,d,k,r,C){c.ha(e)&&c.ha(n)?c.apply_constraint(a,e,g,m,n,q,d,k,r,C):b.error("Wrong objects")};a.clear_constraint=function(a){c.ha(a)&&c.sK(a)?c.clear_constraint(a):b.error("Wrong object")};a.pull_to_constraint_pivot=function(a,e,g,m,n,q){c.ha(a)&&c.ha(m)?c.pull_to_constraint_pivot(a,e,g,m,n,q):b.error("Wrong objects")};a.get_worker_listeners=e.get_worker_listeners};b4w.module.rgb=function(a,q){q("__print");var e=q("__util"),c=new Float32Array(3);a.create=function(){return new Float32Array(3)};a.from_values=function(a,c,e){var q=new Float32Array(3);q[0]=a;q[1]=c;q[2]=e;return q};a.set=function(a,c,e,q){q[0]=a;q[1]=c;q[2]=e;return q};a.css_to_rgb=function(a,c,f,q){q=q||new Float32Array(3);q[0]=a/255;q[1]=c/255;q[2]=f/255;e.oC(q,q);return q};a.rgb_to_css=function(a){a=e.jv(a,c);return[Math.round(255*a[0]),Math.round(255*a[1]),Math.round(255*a[2])]};a.rgb_to_css_hex=
function(a){function n(a){a=Math.round(255*a).toString(16);return 1==a.length?"0"+a:a}a=e.jv(a,c);return"#"+n(a[0])+n(a[1])+n(a[2])}};
b4w.module.rgba=function(a,q){q("__print");var e=q("__util"),c=new Float32Array(3);a.create=function(){var a=new Float32Array(4);a[3]=1;return a};a.from_values=function(a,c,e,q){var g=new Float32Array(4);g[0]=a;g[1]=c;g[2]=e;g[3]=q;return g};a.set=function(a,c,e,q,g){g[0]=a;g[1]=c;g[2]=e;g[3]=q;return g};a.css_to_rgba=function(a,c,f,q,g){g=g||new Float32Array(4);g[0]=a/255;g[1]=c/255;g[2]=f/255;g[3]=q;e.oC(g,g);return g};a.rgba_to_css=function(a){var n=e.jv(a,c);return[Math.round(255*n[0]),Math.round(255*
n[1]),Math.round(255*n[2]),a[3]]}};b4w.module.scenes=function(a,q){var e=q("__batch"),c=q("__camera"),b=q("__data"),n=q("__graph"),f=q("__objects"),t=q("__obj_util");q("__physics");var g=q("__print"),m=q("__scenes"),v=q("__subscene"),x=q("__util");a.DATA_ID_ALL=f.DATA_ID_ALL;a.set_active=function(a){var b=m.mo();m.set_active(x.keysearch("name",a,b))};a.get_active=function(){return m.Ba()?m.get_active().name:""};a.get_scenes=function(){for(var a=m.mo(),b=[],c=0;c<a.length;c++)b.push(a[c].name);return b};a.get_active_camera=function(){if(m.Ba())return m.hk(m.get_active());
g.error("No active scene");return!1};a.get_object_by_name=function(a,b){var c=f.wc(f.ot,a,b|0);if(c)return c;g.error("get object "+a+": not found")};a.get_object_by_dupli_name=function(a,b,c){if(a=f.wc(f.nt,a,b,c|0))return a;g.error("get object "+b+": not found")};a.get_object_by_dupli_name_list=function(a,b){var c=f.wc(f.Vc,a,b|0);if(c)return c;g.error("get object "+a+": not found")};a.get_world_by_name=function(a,b){var c=f.get_world_by_name(a,b|0);if(c)return c;g.error("get object "+a+": not found")};
a.get_object_data_id=function(a){return t.get_object_data_id(a)};a.pick_object=f.pick_object;a.outlining_is_enabled=function(a){return a&&a.k&&a.k.ec};a.set_outline_intensity=function(a,b){a&&a.k&&a.k.ec?f.set_outline_intensity(a,b):g.error("set_outline_intensity(): wrong object")};a.get_outline_intensity=function(a){if(a&&a.k&&a.k.ec)return a.k.Zf;g.error("get_outline_intensity(): wrong object")};a.apply_outline_anim=function(a,b,c,e){a&&a.k&&a.k.ec?f.apply_outline_anim(a,b,c,e):g.error("apply_outline_anim(): wrong object")};
a.apply_outline_anim_def=function(a){if(a&&a.k&&a.k.ec){var b=a.k.uf;f.apply_outline_anim(a,b.Ni,b.Oi,b.Pi)}else g.error("apply_outline_anim_def(): wrong object")};a.clear_outline_anim=function(a){a&&a.k&&a.k.ec?f.clear_outline_anim(a):g.error("clear_outline_anim(): wrong object")};a.set_outline_color=m.set_outline_color;a.get_outline_color=function(a){var b=m.get_active();if(b=m.Da(b,v.hl))return a=a||new Float32Array(3),a.set(b.Eh),a};a.set_hmd_params=function(a){m.Ba()?a&&(!a.distortion_coefs||
a.distortion_coefs instanceof Array||(a.distortion_coefs=null),!a.chromatic_aberration_coefs||a.chromatic_aberration_coefs instanceof Array||(a.chromatic_aberration_coefs=null),"number"!=typeof a.base_line_factor&&(a.base_line_factor=null),"number"!=typeof a.inter_lens_factor&&(a.inter_lens_factor=null),"boolean"!=typeof a.enable_hmd_stereo&&(a.enable_hmd_stereo=null),m.set_hmd_params(a)):g.error("No active scene")};a.get_shadow_params=function(){if(!m.Ba())return g.error("No active scene"),!1;var a=
m.get_active(),b=m.Da(a,v.Ac);if(!b)return null;var c=a.q.Sc,e=m.Da(a,v.sb),f=m.Da(a,v.Ce),n={};n.csm_resolution=c.csm_resolution;n.self_shadow_polygon_offset=b.self_shadow_polygon_offset;f&&(n.self_shadow_normal_offset=f.self_shadow_normal_offset);n.enable_csm=c.enable_csm;n.csm_num=c.csm_num;n.csm_first_cascade_border=c.csm_first_cascade_border;n.first_cascade_blur_radius=c.first_cascade_blur_radius;n.csm_last_cascade_border=c.csm_last_cascade_border;n.last_cascade_blur_radius=c.last_cascade_blur_radius;
n.fade_last_cascade=c.fade_last_cascade;n.blend_between_cascades=c.blend_between_cascades;c.enable_csm?(n.csm_borders=m.SJ(a,e.p),n.blur_radii=new Float32Array(c.csm_num),n.blur_radii.set(e.p.lm.subarray(0,c.csm_num))):(n.csm_borders=null,n.blur_radii=null);return n};a.set_shadow_params=function(a){if(m.Ba()){var b=m.get_active();"number"==typeof a.self_shadow_polygon_offset&&n.na(b.q.Pa,function(b,c){c.type==v.Ac&&(c.self_shadow_polygon_offset=a.self_shadow_polygon_offset)});var f=m.Da(b,v.Ce);f&&
("number"==typeof a.self_shadow_normal_offset&&(f.self_shadow_normal_offset=a.self_shadow_normal_offset),"number"==typeof a.pcf_blur_radius&&(f.pcf_blur_radius=a.pcf_blur_radius));var q=m.Da(b,v.gc);q&&("number"==typeof a.self_shadow_normal_offset&&(q.self_shadow_normal_offset=a.self_shadow_normal_offset),"number"==typeof a.pcf_blur_radius&&(q.pcf_blur_radius=a.pcf_blur_radius),q.wa=!0);q=b.q.Sc;"number"==typeof a.csm_first_cascade_border&&(q.csm_first_cascade_border=a.csm_first_cascade_border);"number"==
typeof a.first_cascade_blur_radius&&(q.first_cascade_blur_radius=a.first_cascade_blur_radius);"number"==typeof a.csm_last_cascade_border&&(q.csm_last_cascade_border=a.csm_last_cascade_border);"number"==typeof a.last_cascade_blur_radius&&(q.last_cascade_blur_radius=a.last_cascade_blur_radius);if(f){for(var x=f.Ea,F=0;F<x.length;F++)for(var D=x[F].ka,y=0;y<D.length;y++){var A=D[y];if(A.Ig.Tc){var H=A.pa;e.by(H,q);e.fc(H);v.rc(f,A)}}f.wa=!0}f=t.ga(b.ci,b).R;for(F=0;F<f.length;F++)c.cx(f[F],q);m.nw(b)}else g.error("No active scene")};
a.get_environment_colors=function(){if(!m.Ba())return g.error("No active scene"),!1;var a=m.get_active();return m.get_environment_colors(a)};a.set_environment_colors=function(a,b,c){if(m.Ba()){var e=m.get_active(),f=m.Da(e,v.sb);m.set_environment_colors(e,a||0==a?parseFloat(a):f.qh,b||0==b?b:f.Pe,c||0==c?c:f.cf)}else g.error("No active scene")};a.get_fog_color_density=function(a){if(!m.Ba())return g.error("No active scene"),!1;var b=m.get_active();return m.get_fog_color_density(b,a)};a.set_fog_color_density=
function(a){if(m.Ba()){var b=m.get_active();m.set_fog_color_density(b,a)}else g.error("No active scene")};a.get_ssao_params=function(){if(!m.Ba())return g.error("No active scene"),!1;var a=m.get_active();return m.get_ssao_params(a)};a.set_ssao_params=function(a){if(m.Ba()){var b=m.get_active();m.set_ssao_params(b,a)}else g.error("No active scene")};a.get_color_correction_params=function(){if(!m.Ba())return g.error("No active scene"),null;var a=m.get_active(),a=m.Da(a,v.gt);if(!a)return null;var b=
{};b.brightness=a.brightness;b.contrast=a.contrast;b.exposure=a.exposure;b.saturation=a.saturation;return b};a.set_color_correction_params=function(a){if(m.Ba()){var b=m.get_active();if(b=m.Da(b,v.gt))"number"==typeof a.brightness&&(b.brightness=a.brightness),"number"==typeof a.contrast&&(b.contrast=a.contrast),"number"==typeof a.exposure&&(b.exposure=a.exposure),"number"==typeof a.saturation&&(b.saturation=a.saturation),b.wa=!0}else g.error("No active scene")};a.get_sky_params=function(){if(!m.Ba())return g.error("No active scene"),
!1;var a=m.get_active();return m.get_sky_params(a)};a.set_sky_params=function(a){if(m.Ba()){var b=m.get_active();m.set_sky_params(b,a)}else g.error("No active scene")};a.get_dof_params=function(){if(!m.Ba())return g.error("No active scene"),!1;var a=m.get_active();return m.Da(a,v.Zm)?m.get_dof_params(a):null};a.set_dof_params=function(a){if(m.Ba()){var b=m.get_active();m.set_dof_params(b,a)}else g.error("No active scene")};a.get_god_rays_params=function(){if(!m.Ba())return g.error("No active scene"),
!1;var a=m.get_active();return m.Da(a,v.Yh)?m.get_god_rays_params(a):null};a.set_god_rays_params=function(a){if(m.Ba()){var b=m.get_active();m.set_god_rays_params(b,a)}else g.error("No active scene")};a.get_bloom_params=function(){if(!m.Ba())return g.error("No active scene"),!1;var a=m.get_active();return m.Da(a,v.Wm)?m.get_bloom_params(a):null};a.set_bloom_params=function(a){if(m.Ba()){var b=m.get_active();m.set_bloom_params(b,a)}else g.error("No active scene")};a.get_glow_material_params=function(){if(!m.Ba())return g.error("No active scene"),
!1;var a=m.get_active();return m.Da(a,v.$m)?m.get_glow_material_params(a):null};a.set_glow_material_params=function(a){if(m.Ba()){var b=m.get_active();m.set_glow_material_params(b,a)}else g.error("No active scene")};a.get_wind_params=function(){if(!m.Ba())return g.error("No active scene"),!1;var a=m.get_active();return m.get_wind_params(a)};a.set_wind_params=function(a){if(m.Ba()){var b=m.get_active();f.set_wind_params(b,a)}else g.error("No active scene")};a.get_water_surface_level=function(a,b){if(!m.Ba())return g.error("No active scene"),
0;var c=m.get_active();return c.q.oc?m.get_water_surface_level(c,a,b):(g.error("No water parameters on the active scene"),0)};a.set_water_params=function(a){if(m.Ba()){var b=m.get_active();m.set_water_params(b,a)}else g.error("No active scene")};a.get_water_mat_params=function(a){if(m.Ba()){var b=m.get_active();m.get_water_mat_params(b,a)}else g.error("No active scene")};a.update_scene_materials_params=function(){if(m.Ba()){var a=m.get_active();m.ZC(a)}else g.error("No active scene")};a.hide_object=
function(a,b){b=b||!1;!t.is_mesh(a)&&!t.is_empty(a)||t.Fa(a)?b?m.zn(a,!0):m.Dy(a,!0):g.error("show/hide is only supported for dynamic objects.")};a.show_object=function(a,b){b=b||!1;!t.is_mesh(a)&&!t.is_empty(a)||t.Fa(a)?b?m.zn(a,!1):m.Dy(a,!1):g.error("show/hide is only supported for dynamic objects.")};a.is_hidden=function(a){if(t.pk(a)||t.is_empty(a)||t.is_lamp(a))return m.is_hidden(a);g.error("show/hide is only supported for dynamic meshes/empties and lamps");return!1};a.is_visible=function(a){return a.k.is_visible};
a.check_object=function(a){g.tb("scenes.check_object","scenes.check_object_by_name");return m.Ba()?f.KL(a,m.get_active()):(g.error("No active scene"),!1)};a.check_object_by_name=function(a,b){return f.wc(f.ot,a,b|0)?!0:!1};a.check_object_by_dupli_name=function(a,b,c){return f.wc(f.nt,a,b,c|0)?!0:!1};a.check_object_by_dupli_name_list=function(a,b){return f.wc(f.Vc,a,b|0)?!0:!1};a.get_all_objects=function(a,b){var c=m.get_active();a||(a="ALL");b||0===b||(b=f.DATA_ID_ALL);return f.xb(c,a,b)};a.get_object_name=
function(a){return a?a.Ak:(g.error("Wrong object name"),"")};a.get_object_name_hierarchy=function(a){if(!a)return g.error("Wrong object name"),null;for(var b=[];a;)b.push(a.Ak),a=t.get_dg_parent(a);return b.reverse()};a.get_object_type=function(a){return a&&a.type?a.type:(g.error("Wrong object"),"UNDEFINED")};a.get_object_dg_parent=function(a){g.tb("scenes.get_object_dg_parent","objects.get_dg_parent");return t.get_dg_parent(a)};a.get_object_children=function(a){return a.be.slice(0)};a.get_first_character=
function(){return f.get_first_character(m.get_active())};a.get_shore_dist=function(a,b){b||0===b||(b=1);if(!m.Ba())return g.error("No active scene"),!1;var c=m.get_active();return m.get_shore_dist(c,a,b)};a.get_cam_water_depth=function(){return m.get_cam_water_depth()};a.get_type_mesh_object=function(a){return t.is_mesh(a)?a.k.type:null};a.get_meta_tags=function(){if(!m.Ba())return g.error("No active scene"),!1;var a=m.get_active();return m.get_meta_tags(a)};a.append_object=function(a,b){if(a.k.mr){if(b)var c=
m.mo(),c=x.keysearch("name",b,c);else c=m.get_active();m.append_object(c,a,!0)}else g.error('object "'+a.name+'" has been created not by coping.')};a.remove_object=function(a){(t.is_mesh(a)||t.is_empty(a))&&t.Fa(a)?(f.Qr(a,!1,a.k.nr,!1,!1),b.$L(a),f.Qr(a,!0,!0,!0,!0),f.remove_object(a)):g.error("Can't remove object \""+a.name+'". It must be dynamic and type of MESH or EMPTY.')};a.marker_frame=function(a){var b=m.get_active();if(b.timeline_markers&&a in b.timeline_markers)return m.marker_frame(b,a);
g.error('"'+a+'" marker not found.');return 0};a.get_mb_params=function(){var a=m.get_active();return(a=m.Da(a,v.Zh))?{mb_factor:a.mb_factor,mb_decay_threshold:a.mb_decay_threshold}:null};a.set_mb_params=function(a){var b=m.get_active();(b=m.Da(b,v.Zh))?("number"==typeof a.mb_decay_threshold&&(b.mb_decay_threshold=a.mb_decay_threshold),"number"==typeof a.mb_factor&&(b.mb_factor=a.mb_factor)):g.error("The motion blur subscene doesn't exist.")};a.can_select_objects=function(){var a=m.get_active();return Boolean(m.Da(a,
v.Ud))}};b4w.module.sfx=function(a,q){var e=q("__obj_util"),c=q("__scenes"),b=q("__sfx"),n=q("__print");a.play=function(a,c,e){b.play(a,c||0,e||0)};a.play_def=function(a){b.play_def(a)};a.is_play=function(a){return b.is_playing(a)};a.is_playing=function(a){return b.is_playing(a)};a.stop=function(a){b.stop(a)};a.pause=function(a){b.BN(a)};a.resume=function(a){b.DN(a)};a.loop_stop=function(a,c,e){b.loop_stop(a,c||0,e||!1)};a.playrate=function(a,c){b.playrate(a,c)};a.get_playrate=function(a){return b.get_playrate(a)};
a.cyclic=function(a,c){b.cyclic(a,c)};a.is_cyclic=function(a){return b.is_cyclic(a)};a.listener_reset_speed=function(){b.listener_stride()};a.listener_stride=function(){b.listener_stride()};a.speaker_reset_speed=function(a){b.speaker_stride(a)};a.speaker_stride=function(a){b.speaker_stride(a)};a.get_volume=function(a){return a&&"object"===typeof a?b.get_volume(a):b.eK()};a.set_volume=function(a,c){a&&"object"===typeof a?b.set_volume(a,c):b.$M(c)};a.mute=function(a,c){a&&"object"===typeof a?b.mute(a,
c):b.EL(c)};a.is_muted=function(a){return a&&"object"===typeof a?b.is_muted(a):b.JK()};a.get_speaker_objects=function(){return b.get_speaker_objects().slice(0)};a.check_active_speakers=b.check_active_speakers;a.set_compressor_params=function(a){b.set_compressor_params(c.get_active(),a)};a.get_compressor_params=function(){return b.get_compressor_params(c.get_active())};a.duck=function(a,c,e){a&&"object"===typeof a?b.duck(a,c,e):b.OI(c,e)};a.unduck=function(a){a&&"object"===typeof a?b.unduck(a):b.fO()};
a.apply_playlist=b.apply_playlist;a.clear_playlist=b.clear_playlist;a.detect_audio_container=b.detect_audio_container;a.detect_video_container=b.detect_video_container;a.set_positional_params=b.set_positional_params;a.get_positional_params=b.get_positional_params;a.set_filter_params=b.set_filter_params;a.get_filter_params=b.get_filter_params;a.get_filter_freq_response=b.get_filter_freq_response;a.get_duration=function(a){if(a&&e.is_speaker(a))return b.get_duration(a);n.error('Object "'+(a?a.name:
void 0)+'" is not a valid speaker')}};b4w.module.textures=function(a,q){var e=q("__print"),c=q("__scenes"),b=q("__textures"),n=q("__obj_util"),f=q("__assets");a.play_video=function(a,f){f||(f=0);c.get_active().b4w_use_nla&&b.kx(a,f)?e.error("NLA texture can't be controlled directly through API."):b.play_video(a,f)||e.error('Texture with name "'+a+'" not found!')};a.pause_video=function(a,f){f||(f=0);c.get_active().b4w_use_nla&&b.kx(a,f)?e.error("NLA texture can't be controlled directly through API."):b.pause_video(a,f)||e.error('Texture with name "'+
a+'" not found!')};a.reset_video=function(a,f){f||(f=0);c.get_active().b4w_use_nla&&b.kx(a,f)?e.error("NLA texture can't be controlled directly through API."):b.reset_video(a,f)||e.error('Texture with name "'+a+'" not found!')};a.get_canvas_ctx=function(a,c){if(n.is_mesh(a)){var f=b.PJ(a,c);if(f)return f;e.error("Couldn't find canvas texture with this name: "+c)}else e.error("Object must be type of mesh.");return null};a.update_canvas_ctx=function(a,c){if(n.is_mesh(a)){if(b.sO(a,c))return!0;e.error("Couldn't find canvas texture with this name: "+
c)}else e.error("Object must be type of mesh.");return!1};a.change_image=function(a,c,m,n){n=n||function(){};f.enqueue([{id:m,type:f.AT_IMAGE_ELEMENT,url:m,qe:"GET",Ti:null,Fh:null,FR:null}],function(f){f&&(b.change_image(a,c,f)?n():e.error("Couldn't find texture with this name: "+c))},null,null)};a.get_texture_names=function(a){if(n.is_mesh(a))return b.get_texture_names(a);e.error("Object must be type of mesh.")}};b4w.module.time=function(a,q){var e=q("__time");a.set_timeout=e.set_timeout;a.clear_timeout=e.clear_timeout;a.get_timeline=e.get_timeline;a.animate=e.animate;a.clear_animation=e.clear_animation};b4w.module.transform=function(a,q){var e=q("__obj_util"),c=q("__physics"),b=q("__print"),n=q("__quat"),f=q("__transform"),t=q("__tsr"),g=q("__util"),m=t.create(),v=new Float32Array(3),x=new Float32Array(4);a.SPACE_LOCAL=f.SPACE_LOCAL;a.SPACE_WORLD=f.SPACE_WORLD;a.set_translation=function(a,g,m,n){e.Fa(a)?(v[0]=g,v[1]=m,v[2]=n,f.set_translation(a,v),f.A(a),c.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_translation_rel=function(a,g,m,n){e.Fa(a)?(v[0]=g,v[1]=m,v[2]=
n,f.set_translation_rel(a,v),f.A(a),c.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_translation_v=function(a,g){e.Fa(a)?(f.set_translation(a,g),f.A(a),c.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_translation_rel_v=function(a,g){e.Fa(a)?(f.set_translation_rel(a,g),f.A(a),c.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_translation_obj_rel=function(a,k,m,n,q){e.Fa(a)?(v[0]=k,v[1]=m,v[2]=n,k=t.get_trans_view(q.k.n),
q=t.get_quat_view(q.k.n),g.transform_vec3(v,1,q,k,v),f.set_translation(a,v),f.A(a),c.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.get_translation=function(a,b){b||(b=new Float32Array(3));f.get_translation(a,b);return b};a.get_translation_rel=function(a,b){b||(b=new Float32Array(3));f.get_translation_rel(a,b);return b};a.set_rotation=function(a,g,m,n,q){e.Fa(a)?(x[0]=g,x[1]=m,x[2]=n,x[3]=q,f.set_rotation(a,x),f.A(a),c.sync_transform(a)):b.error('Wrong object: "'+a.name+
'" is not dynamic.')};a.set_rotation_rel=function(a,g,m,n,q){e.Fa(a)?(x[0]=g,x[1]=m,x[2]=n,x[3]=q,f.set_rotation_rel(a,x),f.A(a),c.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_rotation_v=function(a,g){e.Fa(a)?(f.set_rotation(a,g),f.A(a),c.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_rotation_rel_v=function(a,g){e.Fa(a)?(f.set_rotation_rel(a,g),f.A(a),c.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.get_rotation=
function(a,b){b||(b=new Float32Array(4));f.get_rotation(a,b);return b};a.get_rotation_rel=function(a,b){b||(b=new Float32Array(4));f.get_rotation_rel(a,b);return b};a.set_rotation_euler=function(a,g,m,n){e.Fa(a)?(v[0]=g,v[1]=m,v[2]=n,f.set_rotation_euler(a,v),f.A(a),c.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_rotation_euler_rel=function(a,g,m,n){e.Fa(a)?(v[0]=g,v[1]=m,v[2]=n,f.set_rotation_euler_rel(a,v),f.A(a),c.sync_transform(a)):b.error('Wrong object: "'+a.name+
'" is not dynamic.')};a.set_rotation_euler_v=function(a,g){e.Fa(a)?(f.set_rotation_euler(a,g),f.A(a),c.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_rotation_euler_rel_v=function(a,g){e.Fa(a)?(f.set_rotation_euler_rel(a,g),f.A(a),c.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_scale=function(a,c){e.Fa(a)?(f.set_scale(a,c),f.A(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_scale_rel=function(a,c){e.Fa(a)?(f.set_scale_rel(a,
c),f.A(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.get_scale=function(a){return f.get_scale(a)};a.get_scale_rel=function(a){return f.get_scale_rel(a)};a.empty_reset_transform=function(a){if("EMPTY"!=a.type)b.error("Wrong object: "+a.name);else{for(var g=0;g<a.be.length;g++)if(!e.Fa(a.be[g])){b.error('Wrong object: "'+a.be[g].name+'" is not dynamic.');return}f.set_translation(a,[0,0,0]);f.set_rotation(a,[0,0,0,1]);f.set_scale(a,1);f.A(a);c.sync_transform(a)}};a.get_object_size=function(a){return e.is_mesh(a)?
f.get_object_size(a):(b.error("Wrong object: "+a.name),0)};a.get_object_center=function(a,c,g){if(!e.is_mesh(a))return b.error("Wrong object: "+a.name),null;g||(g=new Float32Array(3));return f.get_object_center(a,c,g)};a.move_local=function(a,g,m,n){e.Fa(a)?(f.move_local(a,g,m,n),f.A(a),c.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.rotate_x_local=function(a,k){if(e.Fa(a)){var m=n.setAxisAngle(g.AXIS_X,k,x);f.jw(a,m);f.A(a);c.sync_transform(a)}else b.error('Wrong object: "'+
a.name+'" is not dynamic.')};a.rotate_y_local=function(a,k){if(e.Fa(a)){var m=n.setAxisAngle(g.AXIS_MY,k,x);f.jw(a,m);f.A(a);c.sync_transform(a)}else b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.rotate_z_local=function(a,k){if(e.Fa(a)){var m=n.setAxisAngle(g.AXIS_Z,k,x);f.jw(a,m);f.A(a);c.sync_transform(a)}else b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.get_object_bounding_box=function(a){return f.get_object_bounding_box(a)};a.set_tsr=function(a,g){e.Fa(a)?(f.set_tsr(a,g),
f.A(a),c.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_tsr_rel=function(a,g){e.Fa(a)?(f.set_tsr_rel(a,g),f.A(a),c.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.get_tsr=function(a,b){b||(b=new Float32Array(8));f.get_tsr(a,b);return b};a.get_tsr_rel=function(a,b){b||(b=new Float32Array(8));f.get_tsr_rel(a,b);return b};a.distance=function(a,b){return f.distance(a,b)};a.set_matrix=function(a,g){e.Fa(a)?(t.from_mat4(g,m),f.set_tsr(a,m),f.A(a),
c.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_matrix_rel=function(a,g){e.Fa(a)?(t.from_mat4(g,m),f.set_tsr_rel(a,m),f.A(a),c.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.get_matrix=function(a,b){b||(b=new Float32Array(16));f.get_tsr(a,m);t.to_mat4(m,b);return b};a.get_matrix_rel=function(a,b){b||(b=new Float32Array(16));f.get_tsr_rel(a,m);t.to_mat4(m,b);return b}};b4w.module.tsr=function(a,q){function e(a,b,c,m){m||(m=n.create());e(a,b,c,m);return m}var c=q("__mat4"),b=q("__print"),n=q("__tsr");a.create=n.create;a.from_values=n.from_values;a.copy=n.copy;a.identity=n.identity;a.create_sep=function(a,c,g,m){b.tb("create_sep","set_sep");return e(a,c,g,m)};a.set_sep=n.set_sep;a.set_trans=n.set_trans;a.set_scale=n.set_scale;a.set_transcale=n.set_transcale;a.set_quat=n.set_quat;a.get_trans_view=n.get_trans_view;a.get_scale=n.get_scale;a.get_quat_view=n.get_quat_view;
a.invert=n.invert;a.to_mat4=function(a,b){b||(b=c.create());n.to_mat4(a,b);return b};a.from_mat4=n.from_mat4;a.multiply=n.multiply;a.transform_vec3=n.transform_vec3;a.transform_vec3_inv=n.transform_vec3_inv;a.transform_vectors=n.transform_vectors;a.transform_dir_vectors=n.transform_dir_vectors;a.transform_dir_vec3=n.transform_dir_vec3;a.transform_tangents=n.transform_tangents;a.translate=n.translate;a.interpolate=function(a,b,c,e){e||(e=n.create());n.interpolate(a,b,c,e);return e}};b4w.module.util=function(a,q){var e=q("__compat"),c=q("__obj_util"),b=q("__print"),n=q("__quat"),f=q("__util"),t=q("__vec3"),g=new Float32Array(6);a.AXIS_X=new Float32Array([1,0,0]);a.AXIS_Y=new Float32Array([0,1,0]);a.AXIS_Z=new Float32Array([0,0,1]);a.AXIS_MX=new Float32Array([-1,0,0]);a.AXIS_MY=new Float32Array([0,-1,0]);a.AXIS_MZ=new Float32Array([0,0,-1]);a.XYX=f.XYX;a.YZY=f.YZY;a.ZXZ=f.ZXZ;a.XZX=f.XZX;a.YXY=f.YXY;a.ZYZ=f.ZYZ;a.XYZ=f.XYZ;a.YZX=f.YZX;a.ZXY=f.ZXY;a.XZY=f.XZY;a.YXZ=f.YXZ;a.ZYX=
f.ZYX;a.f32=function(a){return f.f32(a||0)};a.assert=f.assert;a.keyfind=f.keyfind;a.keysearch=f.keysearch;a.matrix_to_quat=function(a){return f.matrix_to_quat(a)};a.euler_to_quat=function(a,b){b||(b=new Float32Array(4));return f.euler_to_quat(a,b)};a.ordered_angles_to_quat=function(a,b,c){c||(c=n.create());return f.ordered_angles_to_quat(a,b,c)};a.quat_to_ordered_angles=function(a,b,c){c||(c=t.create());return f.quat_to_ordered_angles(a,b,c)};a.quat_to_euler=function(a,b){b||(b=new Float32Array(3));
return f.quat_to_euler(a,b)};a.sign=f.sign;a.clamp=f.clamp;a.quat_to_dir=f.quat_to_dir;a.ground_project_quat=function(a,b){return f.quat_project(a,f.AXIS_MZ,f.AXIS_Z,f.AXIS_Y,b)};a.cam_quat_to_mesh_quat=function(a,b){return f.cam_quat_to_mesh_quat(a,b)};a.quat_project=function(a,c,e,d,g){return 0!=t.dot(e,d)?(b.error("Wrong in-plane direction"),null):f.quat_project(a,c,e,d,g)};a.hash_code=f.hash_code;a.smooth=f.smooth;a.smooth_v=f.smooth_v;a.is_vector=f.is_vector;a.correct_cam_quat_up=f.correct_cam_quat_up;
a.quat_to_angle_axis=f.quat_to_angle_axis;a.random_from_array=f.random_from_array;a.horizontal_direction=f.horizontal_direction;a.line_plane_intersect=function(a,c,e,d,k){b.tb("util.line_plane_intersect","math.line_plane_intersect");g[0]=e[0];g[1]=e[1];g[2]=e[2];g[3]=d[0];g[4]=d[1];g[5]=d[2];return f.line_plane_intersect(a,c,g,k)};a.is_mesh=function(a){b.tb("util.is_mesh","objects.is_mesh");return c.is_mesh(a)};a.is_armature=function(a){b.tb("util.is_armature","objects.is_armature");return c.is_armature(a)};
a.angle_wrap_0_2pi=f.angle_wrap_0_2pi;a.angle_wrap_periodic=f.angle_wrap_periodic;a.smooth_step=f.smooth_step;a.lerp=f.lerp;a.deg_to_rad=f.deg_to_rad;a.rad_to_deg=f.rad_to_deg;a.dir_to_quat=f.dir_to_quat;a.is_ie11=e.is_ie11;a.gen_tbn_quats=f.gen_tbn_quats};"object"==typeof module&&module.Au&&(GLOBAL.b4w={module:{}});b4w.module.version=function(a,q){q("__print");var e=q("__version");a.version=e.version;a.version_str=e.version_str;a.type=e.type;a.date=e.date;a.date_str=e.date_str};"object"==typeof module&&module.Au&&b4w.module.version(exports);b4w.module.objects=function(a,q){var e=q("__geometry"),c=q("__objects"),b=q("__batch"),n=q("__obj_util"),f=q("__print"),t=q("__scenes");a.get_meta_tags=function(a){if(a)return c.get_meta_tags(a)};a.copy=function(a,b,q){return n.is_mesh(a)?n.Fa(a)?e.Ol(a)||e.check_shape_keys(a)||!q?-1==c.xb(t.get_active(),"MESH",c.DATA_ID_ALL).indexOf(a)?(f.error('object "'+a.name+'" does not belong to the active scene.'),!1):c.copy(a,b||"",q):(f.error('object "'+a.name+'" has not dynamic geometry for deep copying.'),
!1):(f.error('object "'+a.name+'" is not dynamic.'),!1):(f.error('object "'+a.name+'" is not of type "MESH".'),!1)};a.set_nodemat_value=function(a,c,e){if(n.pk(a)){var q=c[0],d=b.Ra(a,q,"MAIN");if(null===d)return f.error('Material "'+q+'" was not found in the object "'+a.name+'".'),null;d=b.Nl(d.Xf,c);if(null===d)return f.error('Value node "'+c[c.length-1]+'" was not found in the object "'+a.name+'".'),null;b.set_nodemat_value(a,q,d,e)}else f.error('The type of the object "'+a.name+'" is not "MESH" or it is not dynamic.')};
a.get_nodemat_value=function(a,c){if(!n.pk(a))return f.error('The type of the object "'+a.name+'" is not "MESH" or it is not dynamic.'),null;var e=c[0],q=b.Ra(a,e,"MAIN");if(null===q)return f.error('Material "'+e+'" was not found in the object "'+a.name+'".'),null;e=b.Nl(q.Xf,c);return null===e?(f.error('Value node "'+c[c.length-1]+'" was not found in the object "'+a.name+'".'),null):b.get_nodemat_value(q,e)};a.set_nodemat_rgb=function(a,c,e,q,d){if(n.pk(a)){var k=c[0],r=b.Ra(a,k,"MAIN");null===r?
f.error('Material "'+k+'" was not found in the object "'+a.name+'".'):(r=b.Nl(r.Wf,c),null===r?f.error('RGB node "'+c[c.length-1]+'" was not found in the object "'+a.name+'".'):b.set_nodemat_rgb(a,k,r,e,q,d))}else f.error('The type of the object "'+a.name+'" is not "MESH" or it is not dynamic.')};a.get_nodemat_rgb=function(a,c,e){if(!n.pk(a))return f.error('The type of the object "'+a.name+'" is not "MESH" or it is not dynamic.'),null;var q=c[0],d=b.Ra(a,q,"MAIN");if(null===d)return f.error('Material "'+
q+'" was not found in the object "'+a.name+'".'),null;q=b.Nl(d.Wf,c);if(null===q)return f.error('RGB node "'+c[c.length-1]+'" was not found in the object "'+a.name+'".'),null;e||(e=new Float32Array(3));return b.get_nodemat_rgb(d,q,e)};a.update_boundings=function(a){n.is_mesh(a)?e.Ol(a)||e.check_shape_keys(a)?c.update_boundings(a):f.error('object "'+a.name+'" has not dynamic geometry.'):f.error('The type of the object "'+a.name+'" is not "MESH".')};a.get_parent=n.get_parent;a.get_dg_parent=n.get_dg_parent;
a.is_mesh=n.is_mesh;a.is_armature=n.is_armature;a.is_speaker=n.is_speaker;a.is_camera=n.is_camera;a.is_lamp=n.is_lamp;a.is_empty=n.is_empty;a.is_line=n.is_line;a.is_world=n.is_world;a.get_selectable_objects=function(){return c.get_selectable_objects()};a.get_outlining_objects=function(){return c.get_outlining_objects()}};b4w.module.main=function(a,q){function e(){}function c(){}function b(){}function n(){window.performance||(E.log("Apply performance workaround"),window.performance={});var a=Date.now();window.performance.now||(E.log("Apply performance.now() workaround"),window.performance.now=function(){return Date.now()-a});O.VB(0)}function f(a,b){for(var c=null,d=b?oa:ea,e=0;e<d.length;e++){var f=d[e];try{c=a.getContext(f,Q)}catch(g){}if(c)break}c&&F.HI(c);return c}function t(a,b,e){a.addEventListener("webglcontextlost",
function(a){a.preventDefault();E.error("WebGL context lost");m()},!1);w.Ue(e);var f=w.get_renderer_info();f&&E.log("%cRENDERER INFO:","color: #00a",e.getParameter(f.UNMASKED_VENDOR_WEBGL)+", "+e.getParameter(f.UNMASKED_RENDERER_WEBGL));W.Ue(e);h.Ue(e);L.Ue(e);Z.Ue(e);H.Ue(e);D.Ue(e);A.mN(a);D.init(a,b);G.XB(a.width,a.height,1);J.init();c=d();x()}function g(){e=function(){}}function m(){v()||(qa=performance.now()/1E3,J.pause(),M.pause(),L.pause(),k.pause())}function v(){return na<qa}function x(){var a=
"HMD"===ta.stereo&&u.gA();a?a.requestAnimationFrame(x):I(x);var b=performance.now()/1E3;ha||(ha=b);var d=b-ha;if(!(d<1/ta.max_fps)){for(var f=O.get_timeline(),g=0;g<ra.length;g++)ra[g](f,d);v()||(na>ha&&(d-=na-Math.max(qa,ha)),f+=d,O.VB(f),H.update(),C.update(),A.update(),g=d,A.is_primary_loaded()&&(P.reset(),U.update(g),z.update(f,g),p.update(f,g),J.update(f,g),g&&r.update(g),A.is_primary_loaded()&&(M.update(f,g),A.is_primary_loaded()&&(u.update(f),y.update(f,g),A.is_primary_loaded()&&(k.update(),
l.update(f,g),ca.update(),e(g,f),A.is_primary_loaded()&&(G.update(f,g),k.bD(),sa&&(sa(K.toDataURL()),sa=null)))))),c(d));ha=b;a&&a.isPresenting&&a.submitFrame()}}function d(){var a=60,c=0,d=ta.Ez,e=ta.nJ;return function(f){f<1/ta.max_fps||(a=ga.smooth(1/f,a,f,d),f=M.YJ(),c=(c+1)%e,0==c&&b(Math.round(a),f))}}var k=q("__anchors"),r=q("__animation"),C=q("__assets"),B=q("__config"),F=q("__compat"),D=q("__container"),y=q("__controls"),A=q("__data"),H=q("__debug"),w=q("__extensions"),h=q("__geometry"),
u=q("__input"),P=q("__hud"),p=q("__nla"),z=q("__logic_nodes"),l=q("__objects"),M=q("__physics"),E=q("__print"),W=q("__renderer"),G=q("__scenes"),J=q("__sfx"),Z=q("__shaders"),L=q("__textures"),O=q("__time"),U=q("__transform"),ga=q("__util"),R=q("__version"),ca=q("__particles"),Q=B.context,ta=B.v,K=null,N=null,ha=0,qa=0,na=0,ra=[],sa=null,ea=["webgl","experimental-webgl"],oa=["webgl2","experimental-webgl2"],pa=null,I=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||
window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){return window.setTimeout(a,1E3/ta.max_fps)}}();a.init=function(a,b){B.aN();E.iN(ta.console_verbose);var c=R.version_str()+" "+R.type()+" ("+R.date_str()+")";E.log("%cINIT ENGINE","color: #00a",c);E.log("%cUSER AGENT:","color: #00a",navigator.userAgent);if(!window.WebGLRenderingContext)return null;n();K=a;b?(P.init(b),N=b):(B.v.show_hud_debug_info=!1,B.M.Ir=!1);F.aG();F.Rt("Chrome")||F.Rt("Firefox")||
(ta.Vb=!1);c=f(a,ta.Vb);!c&&ta.Vb&&(ta.Vb=!1,c=f(a,!1));if(!c)return null;E.log("%cINIT WEBGL "+(ta.Vb?"2":"1"),"color: #00a");pa=c;t(K,N,c);B.apply_quality();F.SB(c,!0);Z.fL();ta.gr&&(a.style["touch-action"]="none");E.log("%cSET PRECISION:","color: #00a",ta.precision);return c};a.resize=function(a,b,c){E.tb("main.resize","container.resize");D.resize(a,b,c)};a.set_fps_callback=function(a){b=a};a.clear_fps_callback=function(){b=function(){}};a.set_render_callback=function(a){e=a};a.clear_render_callback=
function(){g()};a.global_timeline=function(){E.tb("main.global_timeline","time.get_timeline");return O.get_timeline()};a.pause=m;a.resume=function(){v()&&(na=performance.now()/1E3,J.resume(),M.resume(),L.play(!0),k.resume())};a.is_paused=v;a.reset=function(){A.unload(0);A.reset();w.reset();W.reset();h.reset();L.tM();Z.reset();H.reset();D.reset();A.reset();D.reset();O.reset();J.reset();N=K=null;na=qa=ha=0;b=function(){};c=function(){};e=function(){};ra.length=0;pa=null};a.canvas_data_url=function(a){sa=
a};a.get_canvas_elem=function(){E.tb("main.get_canvas_elem","container.get_canvas");return K};a.detect_mobile=function(){return F.detect_mobile()};a.append_loop_cb=function(a){for(var b=0;b<ra.length;b++)if(ra[b]==a)return;ra.push(a)};a.remove_loop_cb=function(a){for(var b=0;b<ra.length;b++)if(ra[b]==a){ra.splice(b,1);break}};a.get_renderer_info=function(){var a=w.get_renderer_info();return a?{vendor:pa.getParameter(a.UNMASKED_VENDOR_WEBGL),renderer:pa.getParameter(a.UNMASKED_RENDERER_WEBGL)}:null}};b4w.module.nla=function(a,q){var e=q("__nla"),c=q("__time"),b=q("__print"),n=q("__util");a.set_frame=function(a){a=n.clamp(a,e.get_frame_start(),e.get_frame_end());e.check_logic_nodes()?b.error("The active scene is using NLA script."):e.set_frame(a,c.get_timeline())};a.get_frame=function(){return e.get_frame(c.get_timeline())};a.stop=function(){e.check_logic_nodes()?b.error("The active scene is using NLA script."):e.Dw()};a.play=function(a){e.check_logic_nodes()?b.error("The active scene is using NLA script."):
e.tB(a)};a.is_play=function(){return e.is_play()};a.get_frame_start=function(){return e.get_frame_start()};a.get_frame_end=function(){return e.get_frame_end()};a.check_nla=function(){return e.check_nla()};a.check_nla_scripts=function(){return e.check_logic_nodes()};a.check_logic_nodes=function(){return e.check_logic_nodes()};a.set_range=function(a,c){e.check_logic_nodes()?b.error("The active scene is using NLA script."):(c=parseFloat(c)||e.get_frame_end(),a=parseFloat(a)||e.get_frame_end(),c=n.clamp(c,
e.get_frame_start(),e.get_frame_end()),a=n.clamp(a,e.get_frame_start(),c),e.set_range(a,c))};a.reset_range=function(){e.check_logic_nodes()?b.error("The active scene is using NLA script."):e.reset_range()};a.set_cyclic=function(a){e.check_logic_nodes()?b.error("The active scene is using NLA script."):e.set_cyclic(a)};a.clear_callback=function(){e.check_logic_nodes()?b.error("The active scene is using NLA script."):e.clear_callback()}};b4w.module.app=function(a,q){function e(){var a=z.is_paused();document.addEventListener("visibilitychange",function(){document.hidden?(a=z.is_paused(),z.pause()):a||z.resume()},!1)}function c(){var a=0,b=w.get_container(),c=z.is_paused(),d=!0;z.append_loop_cb(function(){if(0==a%10){var e=b.getBoundingClientRect();e.top>window.innerHeight||0>e.bottom?(d&&(c=z.is_paused()),z.pause(),d=!1):c||d||(z.resume(),d=!0)}a++})}function b(a,b,c,d){var e=document.createElement("canvas"),f=document.getElementById(a);
e.style.position="absolute";e.style.left=0;e.style.top=0;e.style.width=f.offsetWidth+"px";e.style.height=f.offsetHeight+"px";e.width=f.offsetWidth*window.devicePixelRatio;e.height=f.offsetHeight*window.devicePixelRatio;b?(b=document.createElement("canvas"),b.style.position="absolute",e.style.left=0,e.style.top=0,b.style.pointerEvents="none"):b=null;f||(M.error('Warning: canvas container "'+a+'" not found, appending to body'),f=document.body);f.appendChild(e);if(!z.init(e,b))return c&&F("Browser could not initialize WebGL",
"For more info visit","https://www.blend4web.com/doc/en/problems_and_solutions.html",d),!1;b&&w.insert_to_container(b,"LAST");return!0}function n(a,b){a?(b&&(document.getElementById(b).style.display="block"),L=document.getElementById(a)):(L=document.createElement("div"),L.innerHTML=0,L.style.cssText="position:absolute;top: 23px;right: 20px;text-shadow: 0px 0px 6px #fff;font-size: 40px;line-height: 50px;font-weight: bold;color: #000;",w.insert_to_container(L,"JUST_AFTER_CANVAS"))}function f(a,b){var c=
String(a);b&&(c+="/"+String(b));L.innerHTML=c}function t(a){a=document.getElementById(a);var b=a.cloneNode(!0);a.parentNode.replaceChild(b,a);return b}function g(a,b,c){var d=Math.max(y.hover_get_distance(a),1),e=W.get_rotation(a,K);b=G.quat_to_dir(e,b,Q);b[2]=0;J.normalize(b,b);J.scale(b,d*c,b);c=W.get_translation(a,ta);J.add(c,b,c);y.set_translation(a,c)}function m(a,b){var c=y.hover_get_vertical_limits(a,ha);if(c.up!=c.down){var d=y.get_camera_angles(a,ca)[1],c=(c.down-d)/(c.down-c.up),d=y.hover_get_distance_limits(a,
ha),c=Math.max(c,2/d.max);y.hover_rotate(a,0,c*b)}}function v(a,b,c,d){W.move_local(a,5*b,5*c,5*d)}function x(a,b,c){var d=y.target_get_distance(a),e=Math.abs(b);c=Math.pow(e*c,1-Math.pow(e*c,.15));W.move_local(a,0,0,0>b?.001<d?-d*c:0:c/(1-c)*d)}function d(a,b,c,d){for(var e=c*b;0<a;--a)c+=e,d+=e,e=c*b;return d}function k(a,b,c,e,f){f?(f=y.target_get_pivot(a,Q),a=y.get_translation(a),a=J.dist(f,a)+e,e=0<b?d(b,-c,a,e):d(-b,c/(1-c),a,e)):e-=2*b*c;return e}function r(a,b,c,d,e){function f(a,b,c,d){if(1==
c){y.get_velocities(a,X);var e=P?.003*X.trans:.003*X.rot;c=h.get_sensor_value(a,b,0);h.get_sensor_payload(a,b,0)===h.PL_SINGLE_TOUCH_MOVE?(Qa+="X"==d?-c*e:0,gb+="Y"==d?-c*e:0):h.get_sensor_payload(a,b,0)===h.PL_MULTITOUCH_MOVE_PAN&&(a=P?.003*X.rot:7.5E-4*X.trans,La+="X"==d?-c*a:0,Ta+="Y"==d?-c*a:0)}}function n(a){y.get_velocities(a,X);qb-=.05*X.zoom}function q(a){y.get_velocities(a,X);wa-=.002*X.trans}function r(a){y.get_velocities(a,X);qb+=.05*X.zoom}function u(a){y.get_velocities(a,X);wa+=.002*
X.trans}function t(a,b,c,d){if(1==c){c=h.get_sensor_value(a,b,1);y.get_velocities(a,X);if(P)e=.003*X.trans,f=7.5E-4*X.rot;else var e=.003*X.rot,f=7.5E-4*X.trans;if(1===h.get_sensor_payload(a,b,0))Ja+="X"==d?-c*e:0,Ka+="Y"==d?-c*e:0;else if(2===h.get_sensor_payload(a,b,0)||3===h.get_sensor_payload(a,b,0))pb+="X"==d?-c*f:0,Na+="Y"==d?-c*f:0}}function z(a){return a[0]&&(a[1]||a[2]||-.1>a[3])}function w(a){return a[0]&&(a[1]||a[2]||.1<a[3])}function B(a){return a[0]&&(a[1]||-.1>a[2])}function A(a){return a[0]&&
(a[1]||.1<a[2])}function L(a){return a[0]&&(a[1]||a[2]||a[3])}function M(a,b,c){if(1==c)switch(c=h.get_sensor_value(a,b,0),y.get_velocities(a,X),b){case "FORWARD":K?Ha[0]=1:P?(b=y.get_camera_angles(a,ca)[1],b=Math.abs(b)>=Math.PI/4?G.AXIS_Y:G.AXIS_MZ,g(a,b,.5*X.trans*c)):F?x(a,-X.zoom,c):v(a,0,0,-X.trans*c);break;case "BACKWARD":K?Ha[0]=-1:P?(b=y.get_camera_angles(a,ca)[1],b=Math.abs(b)>=Math.PI/4?G.AXIS_MY:G.AXIS_Z,g(a,b,.5*X.trans*c)):F?x(a,X.zoom,c):v(a,0,0,X.trans*c);break;case "UP":P?m(a,30*
-X.zoom*c):K||v(a,0,X.trans*c,0);break;case "DOWN":P?m(a,30*X.zoom*c):K||v(a,0,-X.trans*c,0);break;case "LEFT":K?Ha[1]=1:P?g(a,G.AXIS_MX,.5*X.trans*c):v(a,-X.trans*c,0,0);break;case "RIGHT":K?Ha[1]=-1:P?g(a,G.AXIS_X,.5*X.trans*c):v(a,X.trans*c,0,0);break;case "ROT_LEFT":F?y.target_rotate(a,.75*-X.rot*c,0):y.eye_rotate(a,.75*X.rot*c,0);break;case "ROT_RIGHT":F?y.target_rotate(a,.75*X.rot*c,0):y.eye_rotate(a,.75*-X.rot*c,0);break;case "ROT_UP":F?y.target_rotate(a,0,.75*-X.rot*c):y.eye_rotate(a,0,.75*
X.rot*c);break;case "ROT_DOWN":F?y.target_rotate(a,0,.75*X.rot*c):y.eye_rotate(a,0,.75*-X.rot*c)}else switch(b){case "FORWARD":case "BACKWARD":K&&(Ha[0]=0);break;case "LEFT":case "RIGHT":K&&(Ha[1]=0)}K&&(l.set_character_move_dir(K,Ha[0],Ha[1]),a=y.get_camera_angles_char(a,R),l.set_character_rotation(K,a[0],a[1]))}O=a;U=b;ga=c;var D=E.get_active_camera();C(D);var F=!1,K=null,P=!1;switch(y.get_move_style(D)){case y.MS_TARGET_CONTROLS:F=!a;break;case y.MS_EYE_CONTROLS:K=E.get_first_character();break;
case y.MS_STATIC:return;case y.MS_HOVER_CONTROLS:P=!0}var X=y.get_velocities(D,N);a=h.create_elapsed_sensor();if(l.has_simulated_physics(D)){var ha=h.create_collision_sensor(D,null,!0);h.create_sensor_manifold(D,"CAMERA_COLLISION",h.CT_POSITIVE,[ha],null,function(a,b){var c=h.get_sensor_payload(a,b,0).coll_dist;if(0>c){var d=h.get_sensor_payload(a,b,0).coll_norm,e=Q;J.scale(d,-.25*c,e);c=W.get_translation(a,ta);J.add(c,e,c);W.set_translation_v(a,c)}})}if(K){var ha=W.get_translation(D),Fa=W.get_rotation(D),
Fa=G.cam_quat_to_mesh_quat(Fa);ha[2]-=.5;l.set_transform(K,ha,Fa);H.append_stiff_trans(D,K,[0,0,.5]);var Ha=new Float32Array(2),za=!0;l.set_character_move_type(K,l.CM_FLY);h.create_kb_sensor_manifold(D,"TOGGLE_CHAR_MOVE_TYPE",h.CT_SHOT,h.KEY_C,function(){za=!za;l.set_character_move_type(K,za?l.CM_FLY:l.CM_WALK)})}var Ga=p.check_enable_gamepad_indices(),ha=Ga.length?Ga[Ga.length-1]:0,Sa,Ba,da,ba,Oa,Ca;b?Sa=Ba=da=ba=Oa=Ca=b=ha=h.create_custom_sensor(0):(Sa=h.create_keyboard_sensor(h.KEY_W),Ba=h.create_keyboard_sensor(h.KEY_S),
da=h.create_keyboard_sensor(h.KEY_A),ba=h.create_keyboard_sensor(h.KEY_D),Oa=h.create_keyboard_sensor(h.KEY_R),Ca=h.create_keyboard_sensor(h.KEY_F),b=h.create_gamepad_btn_sensor(p.GMPD_BUTTON_6,ha),ha=h.create_gamepad_btn_sensor(p.GMPD_BUTTON_7,ha));var Ia=h.create_keyboard_sensor(h.KEY_UP),Ra=h.create_keyboard_sensor(h.KEY_DOWN),fa=h.create_keyboard_sensor(h.KEY_LEFT),Nb=h.create_keyboard_sensor(h.KEY_RIGHT),Fa=h.create_gamepad_axis_sensor(p.GMPD_AXIS_0,Ga),ja=h.create_gamepad_axis_sensor(p.GMPD_AXIS_1,
Ga),S=h.create_gamepad_axis_sensor(p.GMPD_AXIS_2,Ga),Ga=h.create_gamepad_axis_sensor(p.GMPD_AXIS_3,Ga);P||(h.create_sensor_manifold(D,"FORWARD",h.CT_CONTINUOUS,[a,Sa,ja],B,M),h.create_sensor_manifold(D,"BACKWARD",h.CT_CONTINUOUS,[a,Ba,ja],A,M));F?(h.create_sensor_manifold(D,"ROT_UP",h.CT_CONTINUOUS,[a,Ia,Oa,Ga],z,M),h.create_sensor_manifold(D,"ROT_DOWN",h.CT_CONTINUOUS,[a,Ra,Ca,Ga],w,M),h.create_sensor_manifold(D,"ROT_LEFT",h.CT_CONTINUOUS,[a,fa,da,S],z,M),h.create_sensor_manifold(D,"ROT_RIGHT",h.CT_CONTINUOUS,
[a,Nb,ba,S],w,M)):P?(h.create_sensor_manifold(D,"LEFT",h.CT_CONTINUOUS,[a,fa,da,Fa],z,M),h.create_sensor_manifold(D,"RIGHT",h.CT_CONTINUOUS,[a,Nb,ba,Fa],w,M),h.create_sensor_manifold(D,"FORWARD",h.CT_CONTINUOUS,[a,Ia,Sa,ja],z,M),h.create_sensor_manifold(D,"BACKWARD",h.CT_CONTINUOUS,[a,Ra,Ba,ja],w,M),h.create_sensor_manifold(D,"UP",h.CT_CONTINUOUS,[a,Ca,Ga],A,M),h.create_sensor_manifold(D,"DOWN",h.CT_CONTINUOUS,[a,Oa,Ga],B,M)):(h.create_sensor_manifold(D,"UP",h.CT_CONTINUOUS,[a,Oa,b],L,M),h.create_sensor_manifold(D,
"DOWN",h.CT_CONTINUOUS,[a,Ca,ha],L,M),h.create_sensor_manifold(D,"LEFT",h.CT_CONTINUOUS,[a,da,Fa],B,M),h.create_sensor_manifold(D,"RIGHT",h.CT_CONTINUOUS,[a,ba,Fa],A,M),h.create_sensor_manifold(D,"ROT_UP",h.CT_CONTINUOUS,[a,Ia,Ga],B,M),h.create_sensor_manifold(D,"ROT_DOWN",h.CT_CONTINUOUS,[a,Ra,Ga],A,M),h.create_sensor_manifold(D,"ROT_LEFT",h.CT_CONTINUOUS,[a,fa,S],B,M),h.create_sensor_manifold(D,"ROT_RIGHT",h.CT_CONTINUOUS,[a,Nb,S],A,M));if(!c){var Wa=0;c=h.create_mouse_wheel_sensor(d);var Da=0,
Ga=h.create_touch_zoom_sensor(d);h.create_sensor_manifold(D,"MOUSE_WHEEL",h.CT_LEVEL,[c],null,function(a,b,c){1==c&&(b=h.get_sensor_value(a,b,0),y.get_velocities(a,X),F||P?Wa=k(a,b,X.zoom,Wa,F):(X.trans*=1+b*X.zoom,y.set_velocities(a,X)))});h.create_sensor_manifold(D,"TOUCH_ZOOM",h.CT_LEVEL,[Ga],null,function(a,b,c){1==c&&(c=h.get_sensor_value(a,b,0),y.get_velocities(a,X),h.get_sensor_payload(a,b,0)===h.PL_MULTITOUCH_MOVE_ZOOM&&(Da=k(a,c,.03*X.zoom,Da,F)))});h.create_sensor_manifold(D,"ZOOM_INTERPOL",
h.CT_POSITIVE,[a],null,function(a,b){if(F||P)if(1E-5<Math.abs(Wa)||1E-5<Math.abs(Da)){var c=h.get_sensor_value(a,b,0),d=G.smooth(Wa,0,c,.1*Z);Wa-=d;c=G.smooth(Da,0,c,.15*Z);Da-=c;P?m(a,-(d+c)):(d=y.target_get_distance(a)+d+c,d=Math.max(d,.001),y.target_set_distance(a,d))}else Da=Wa=0})}var Ja=0,Ka=0,pb=0,Na=0,wa=0,qb=0;F?(h.create_sensor_manifold(D,"GMPD_PAN_Y_POS",h.CT_CONTINUOUS,[b],null,r),h.create_sensor_manifold(D,"GMPD_PAN_Y_NEG",h.CT_CONTINUOUS,[ha],null,n),h.create_sensor_manifold(D,"GMPD_PAN_X_POS",
h.CT_CONTINUOUS,[Fa],function(a){return-.1>a[0]},q),h.create_sensor_manifold(D,"GMPD_PAN_X_NEG",h.CT_CONTINUOUS,[Fa],function(a){return.1<a[0]},u)):P&&(h.create_sensor_manifold(D,"GMPD_PAN_X_POS",h.CT_CONTINUOUS,[S],function(a){return-.1>a[0]},q),h.create_sensor_manifold(D,"GMPD_PAN_X_NEG",h.CT_CONTINUOUS,[S],function(a){return.1<a[0]},u));if(e){e=h.create_mouse_move_sensor("X",window);c=h.create_mouse_move_sensor("Y",window);b=h.create_mouse_click_sensor(d);var ha=h.create_mouse_click_sensor(window),
Bb=!1,Fa=function(a){a[2]?Bb=!0:a[0]||(Bb=!1);return Bb&&a[0]};h.create_sensor_manifold(D,"MOUSE_X",h.CT_POSITIVE,[ha,e,b],Fa,t,"X");h.create_sensor_manifold(D,"MOUSE_Y",h.CT_POSITIVE,[ha,c,b],Fa,t,"Y");e=p.get_device_by_type_element(p.DEVICE_MOUSE,window);p.switch_prevent_default(e,!1)}else e=h.create_mouse_move_sensor("X",d),c=h.create_mouse_move_sensor("Y",d),b=h.create_mouse_click_sensor(d),h.create_sensor_manifold(D,"MOUSE_X",h.CT_LEVEL,[b,e],null,t,"X"),h.create_sensor_manifold(D,"MOUSE_Y",
h.CT_LEVEL,[b,c],null,t,"Y");var Qa=0,gb=0,La=0,Ta=0;e=h.create_touch_move_sensor("X",d);d=h.create_touch_move_sensor("Y",d);h.create_sensor_manifold(D,"TOUCH_X",h.CT_LEVEL,[e],null,f,"X");h.create_sensor_manifold(D,"TOUCH_Y",h.CT_LEVEL,[d],null,f,"Y");h.create_sensor_manifold(D,"ROT_TRANS_INTERPOL",h.CT_POSITIVE,[a],null,function(a,b){if(1E-5<Math.abs(Ja)||1E-5<Math.abs(Ka)||1E-5<Math.abs(Qa)||1E-5<Math.abs(gb)||1E-5<Math.abs(pb)||1E-5<Math.abs(Na)||1E-5<Math.abs(La)||1E-5<Math.abs(Ta)||1E-5<Math.abs(wa)||
1E-5<Math.abs(qb)){var c=h.get_sensor_value(a,b,0),d=G.smooth(Ja,0,c,.08*Z),e=G.smooth(Ka,0,c,.08*Z);Ja-=d;Ka-=e;var f=G.smooth(Qa,0,c,.12*Z),k=G.smooth(gb,0,c,.12*Z);Qa-=f;gb-=k;var m=G.smooth(pb,0,c,.08*Z),n=G.smooth(Na,0,c,.08*Z);pb-=m;Na-=n;var p=G.smooth(La,0,c,.12*Z),q=G.smooth(Ta,0,c,.12*Z);La-=p;Ta-=q;var r=G.smooth(wa,0,c,.08*Z),c=G.smooth(qb,0,c,.08*Z);wa-=r;qb-=c;F?(y.target_rotate(a,d+f,e+k),e=y.target_get_distance(a),y.target_pan_pivot(a,e*(m+p+r),e*(n+q+c))):P?(d+f&&g(a,G.AXIS_X,.2*
(d+f)),e+k&&(n=y.get_camera_angles(a,ca)[1],g(a,Math.abs(n)>Math.PI/4?G.AXIS_MY:G.AXIS_Z,.2*(e+k))),y.hover_rotate(a,m+p+r,0)):(y.eye_rotate(a,.5*(d+f),.5*(e+k)),K&&(m=y.get_camera_angles_char(a,R),l.set_character_rotation(K,m[0],m[1])))}});h.create_kb_sensor_manifold(D,"DEC_STEREO_DIST",h.CT_SHOT,h.KEY_LEFT_SQ_BRACKET,function(a){var b=y.get_stereo_distance(a);y.set_stereo_distance(a,.9*b)});h.create_kb_sensor_manifold(D,"INC_STEREO_DIST",h.CT_SHOT,h.KEY_RIGHT_SQ_BRACKET,function(a){var b=y.get_stereo_distance(a);
y.set_stereo_distance(a,1.1*b)})}function C(a){var b=y.get_move_style(a),c=h.create_callback_sensor(function(){var c=y.get_move_style(a),d=c!=b;b=c;return d});h.create_sensor_manifold(a,"CHANGE_MOVE_STYLE",h.CT_POSITIVE,[c],null,function(){B();r(O,U,ga)})}function B(){for(var a=E.get_active_camera(),b="FORWARD BACKWARD ROT_UP ROT_DOWN ROT_LEFT ROT_RIGHT UP DOWN LEFT RIGHT MOUSE_WHEEL TOUCH_ZOOM ZOOM_INTERPOL MOUSE_X MOUSE_Y TOUCH_X TOUCH_Y ROT_TRANS_INTERPOL CHANGE_MOVE_STYLE".split(" "),c=0;c<b.length;c++)h.remove_sensor_manifold(a,
b[c]);y.get_move_style(a)==y.MS_EYE_CONTROLS&&E.get_first_character()&&H.remove(a)}function F(a,b,c,d){var e=document.createElement("div"),f=document.createElement("div"),g=document.createElement("div");if(d)for(var h=0;h<d.length;h++){var k=document.getElementById(d[h]);k&&k.parentNode.removeChild(k)}e.style.cssText="z-index:10;width:100%;height:auto;position:absolute;top:50%;margin-top:150px;text-align:center;";f.style.cssText="color:#fff;font-size:24px;";g.style.cssText="color:#fff;font-size:20px;";
f.innerHTML=a;g.innerHTML=b+'   <a style="color:#fff;font-size:20px;width:100%;" href="'+c+'">'+c.replace("https://www.","")+"</a>";e.appendChild(f);e.appendChild(g);document.body.appendChild(e)}function D(a,b,c,d,e){function f(){var h=performance.now()-g;e(b+h*(c-b)/d);(h>=d||!a.parentNode)&&z.remove_loop_cb(f)}var g=performance.now();z.append_loop_cb(f)}q("animation");var y=q("camera"),A=q("config"),H=q("constraints"),w=q("container"),h=q("controls"),u=q("data"),P=q("debug"),p=q("input"),z=q("main"),
l=q("physics"),M=q("print"),E=q("scenes"),W=q("transform"),G=q("util"),J=q("vec3"),Z=1,L=null,O=!1,U=!1,ga=!1,R=new Float32Array(2),ca=new Float32Array(2),Q=new Float32Array(3),ta=new Float32Array(3);new Float32Array(3);var K=new Float32Array(4),N={},ha={};a.init=function(a){function d(){var a=b(m,F,B,p),g=w.get_canvas();if(a){var h=w.get_container();w.resize_to_container();E&&(n(q,t),z.set_fps_callback(f));x&&(e(),c());r&&z.append_loop_cb(function(){h.style.height=h.clientWidth/r+"px"});l&&z.append_loop_cb(function(){w.resize_to_container()});
D&&z.append_loop_cb(function(){w.force_offsets_updating()});y&&A.reset_limits();O==A.P_AUTO?P.test_performance(function(a,b){0==a?(M.log("QUALITY TEST RESULT: UNSUPPORTED, using HIGH"),A.apply_quality(A.P_HIGH)):1.5>b?(M.log("QUALITY TEST RESULT: LOW ("+b.toFixed(1)+" GB/s)"),A.apply_quality(A.P_LOW)):(M.log("QUALITY TEST RESULT: HIGH ("+b.toFixed(1)+" GB/s)"),A.apply_quality(A.P_HIGH));k(g,!0)}):k(g,!0)}else k(g,!1)}function g(a){a.keyCode==h.KEY_P&&(z.is_paused()?z.resume():z.pause())}function k(){}
a=a||{};var l=!1,m=null,p=null,q=null,r=0,t=null,v=!0,y=!1,x=!0,B=!0,C=!1,E=!1,G=!1,D=!1,O=A.get("quality"),L;for(L in a)switch(L){case "canvas_container_id":m=a.canvas_container_id;break;case "callback":k=a.callback;break;case "autoresize":l=a.autoresize;break;case "do_not_use_onload":break;case "show_hud_debug_info":G=a.show_hud_debug_info;break;case "sfx_mix_mode":C=a.sfx_mix_mode;break;case "show_fps":E=a.show_fps;break;case "track_container_position":D=a.track_container_position;break;case "fps_wrapper_id":t=
a.fps_wrapper_id;break;case "fps_elem_id":q=a.fps_elem_id;break;case "error_purge_elements":p=a.error_purge_elements;break;case "report_init_failure":B=a.report_init_failure;break;case "pause_invisible":x=a.pause_invisible;break;case "key_pause_enabled":v=a.key_pause_enabled;break;case "force_container_ratio":r=a.force_container_ratio;break;case "min_capabilities":y=a.min_capabilities;break;case "quality":O=a.quality;break;default:A.set(L,a[L])}v&&document.addEventListener("keydown",g,!1);A.set("show_hud_debug_info",
G);A.set("sfx_mix_mode",C);var F=G||C||null;"complete"==document.readyState?window.setTimeout(d,0):window.addEventListener("load",d,!1);window.addEventListener("unload",function(){u.cleanup()},!1)};a.resize_to_container=function(){M.tb("app.resize_to_container","container.resize_to_container");w.resize_to_container()};a.set_onclick=function(a,b){var c=t(a);c.addEventListener("mouseup",function(){b(c.value)},!1)};a.set_onchange=function(a,b){var c=t(a);c.addEventListener("change",function(){var a=
c.checked;b(void 0!=a?a:c.value)},!1)};a.set_onkeypress=function(a,b){var c=t(a);c.addEventListener("keypress",function(a){b(a.keyCode,c.value)},!1)};a.enable_camera_controls=r;a.disable_camera_controls=B;a.set_camera_move_style=function(a){M.yg("app.set_camera_move_style",["camera.static_setup","camera.eye_setup","camera.target_setup","camera.hover_setup","camera.hover_setup_rel"]);var b=E.get_active_camera();y.set_move_style(b,a)};a.enable_object_controls=function(a){function b(a){return a[0]&&
(a[1]||a[2])}function c(a,b,e){if(1==e)switch(e=h.get_sensor_value(a,b,0),b){case "FORWARD":d?l.vehicle_throttle(a,1):W.move_local(a,0,-1*e,0);break;case "BACKWARD":d?l.vehicle_throttle(a,-1):W.move_local(a,0,1*e,0);break;case "LEFT":d?l.vehicle_steer(a,-1):W.move_local(a,1*e,0,0);break;case "RIGHT":d?l.vehicle_steer(a,1):W.move_local(a,-1*e,0,0)}else switch(b){case "FORWARD":case "BACKWARD":d&&l.vehicle_throttle(a,0);break;case "LEFT":case "RIGHT":d&&l.vehicle_steer(a,0)}}var d=l.is_vehicle_chassis(a)||
l.is_vehicle_hull(a),e=h.create_elapsed_sensor(),f=h.create_keyboard_sensor(h.KEY_W),g=h.create_keyboard_sensor(h.KEY_S),k=h.create_keyboard_sensor(h.KEY_A),m=h.create_keyboard_sensor(h.KEY_D),n=h.create_keyboard_sensor(h.KEY_UP),p=h.create_keyboard_sensor(h.KEY_DOWN),q=h.create_keyboard_sensor(h.KEY_LEFT),r=h.create_keyboard_sensor(h.KEY_RIGHT);h.create_sensor_manifold(a,"FORWARD",h.CT_CONTINUOUS,[e,f,n],b,c);h.create_sensor_manifold(a,"BACKWARD",h.CT_CONTINUOUS,[e,g,p],b,c);h.create_sensor_manifold(a,
"LEFT",h.CT_CONTINUOUS,[e,k,q],b,c);h.create_sensor_manifold(a,"RIGHT",h.CT_CONTINUOUS,[e,m,r],b,c)};a.disable_object_controls=function(a){for(var b=["FORWARD","BACKWARD","LEFT","RIGHT"],c=0;c<b.length;c++)h.remove_sensor_manifold(a,b[c])};a.enable_controls=function(){M.uc("app.enable_controls() deprecated")};a.disable_controls=function(){M.uc("app.disable_controls() deprecated")};a.enable_debug_controls=function(){h.create_kb_sensor_manifold(null,"CAMERA_SHOT",h.CT_SHOT,h.KEY_K,function(){P.make_camera_frustum_shot()});
h.create_kb_sensor_manifold(null,"LIGHT_SHOT",h.CT_SHOT,h.KEY_L,function(){P.make_light_frustum_shot()});h.create_kb_sensor_manifold(null,"TELEMETRY",h.CT_SHOT,h.KEY_T,function(){P.plot_telemetry()})};a.request_fullscreen=function(a,b,c){function d(){document.fullscreenElement===a||document.webkitFullScreenElement===a||document.mozFullScreenElement===a||document.webkitIsFullScreen||document.msFullscreenElement===a?b():(document.removeEventListener("fullscreenchange",d,!1),document.removeEventListener("webkitfullscreenchange",
d,!1),document.removeEventListener("mozfullscreenchange",d,!1),document.removeEventListener("MSFullscreenChange",d,!1),c())}b=b||function(){};c=c||function(){};document.addEventListener("fullscreenchange",d,!1);document.addEventListener("webkitfullscreenchange",d,!1);document.addEventListener("mozfullscreenchange",d,!1);document.addEventListener("MSFullscreenChange",d,!1);a.requestFullScreen=a.requestFullScreen||a.webkitRequestFullScreen||a.mozRequestFullScreen||a.msRequestFullscreen;a.requestFullScreen?
a.requestFullScreen():M.error("B4W App: request fullscreen method is not supported")};a.exit_fullscreen=function(){var a=document.exitFullscreen||document.webkitExitFullscreen||document.mozCancelFullScreen||document.msExitFullscreen;"function"!=typeof a&&M.error("B4W App: exit fullscreen method is not supported");a.apply(document)};a.check_fullscreen=function(){return window.document.fullscreenEnabled||window.document.mozFullScreenEnabled||window.document.msFullscreenEnabled||window.document.webkitFullscreenEnabled?
!0:!1};a.report_app_error=F;a.get_url_params=function(a){a=!!a;var b=decodeURIComponent(location.href.toString());if(-1==b.indexOf("?"))return null;for(var b=b.split("?")[1].split("&"),c={},d=0;d<b.length;d++){var e=b[d].split("="),f=e[0];1<e.length?(e=e[1],a?f in c?c[f].push(e):c[f]=[e]:c[f]=e):a?f in c||(c[f]=[]):c[f]=""}return c};a.css_animate=function(a,b,c,d,e,f,g,h){function k(e){a&&(l[b]=f+e+g,c>d&&e<=d||c<d&&e>=d)&&(l[b]=f+d+g,h())}if(a&&b&&isFinite(c)&&isFinite(d)&&isFinite(e)){f=f||"";g=
g||"";h=h||function(){};var l=a.style,m=b.charAt(0).toUpperCase()+b.slice(1);if(void 0==l[b])if(void 0!=l["webkit"+m])b="webkit"+m;else if(void 0!=l["ms"+m])b="ms"+m;else if(void 0!=l["moz"+m])b="moz"+m;else return;D(a,c,d,e,k)}};a.attr_animate=function(a,b,c,d,e,f){function g(e){a&&(0<=e&&a.setAttribute(b,e),c>d&&e<=d||c<d&&e>=d)&&(a.setAttribute(b,d),f())}a&&b&&isFinite(c)&&isFinite(d)&&isFinite(e)&&(f=f||function(){},D(a,c,d,e,g))};a.queue_animate=function(b){if(b.length){var c=b.shift(),d=c.elem,
e=c.prop,f=c.from,g=c.to,h=c.duration,k=c.opt_prefix,l=c.opt_suffix,m=function(){c.cb&&c.cb();a.queue_animate(b)};"css"==c.type?a.css_animate(d,e,f,g,h,k,l,m):"attr"==c.type&&a.attr_animate(d,e,f,g,h,m)}};a.set_camera_smooth_factor=function(a){Z=a};a.get_camera_smooth_factor=function(){return Z}};b4w.module.camera_anim=function(a,q){function e(a,b,d,e,f){d=v.angle_wrap_0_2pi(b-d);d=Math.min(d,2*Math.PI-d);b=v.angle_wrap_0_2pi(e-b);b=Math.min(b,2*Math.PI-b);if(1E-6>Math.abs(d)||1E-6>2*Math.PI-Math.abs(d))d=0;if(1E-6>Math.abs(b)||1E-6>2*Math.PI-Math.abs(b))b=0;c.is_eye_camera(a)?(f[0]=b,f[1]=d):(f[0]=d,f[1]=b);return f}var c=q("camera"),b=q("controls"),n=q("print"),f=q("scenes"),t=q("time"),g=q("transform"),m=q("tsr"),v=q("util"),x=q("vec3"),d=q("quat"),k=new Float32Array(2),r=new Float32Array(2),
C=new Float32Array(3),B=new Float32Array(3),F=new Float32Array(3),D=new Float32Array(4),y=m.create(),A=m.create(),H=m.create(),w={},h=!1,u=!1,P=!1,p=!1;a.track_to_target=function(a,e,f,h,m,p,q,r){if(!c.is_eye_camera(a))n.error("track_to_target(): wrong object");else if(a&&e){if(v.is_vector(e))var u=e;else u=F,g.get_object_center(e,!1,u);e=f||1;f=h||2;var t=m||1;m=p||1;B[0]=0;B[1]=-1;B[2]=0;var w=g.get_rotation(a);p=v.quat_to_dir(w,B);h=c.get_camera_angles(a,k);var y=g.get_translation(a);x.subtract(u,
y,C);x.normalize(C,C);var A=d.rotationTo(p,C,d.create());d.multiply(A,w,D);v.correct_cam_quat_up(D,!1);x.subtract(u,y,B);var H=x.length(B)*(1-1/f),u=Math.asin(C[1]);f=Math.acos(-C[2]/Math.abs(Math.cos(u)));0<C[0]&&(f=2*Math.PI-f);var Q=f-h[0],P=u-h[1];F[0]=0;F[1]=0;F[2]=-1;f=g.get_rotation(a);0>v.quat_to_dir(f,F)[1]?(P=0<p[1]?u-Math.PI+h[1]:u+Math.PI+h[1],Q=0<Q?-Math.PI+Q:Math.PI+Q):Math.abs(Q)>Math.PI&&(Q=0<Q?Q-2*Math.PI:Q+2*Math.PI);var K=0,u=b.create_elapsed_sensor();p=Math.abs(Q/e);e=Math.abs(P/
e);var N=p>e?p:e,ha=N+t,qa=ha+m,na=qa+t,ra=Q,sa=P,ea=H,oa=function(){b.remove_sensor_manifold(a,"TRACK_TO_TARGET");q&&q()};b.create_sensor_manifold(a,"TRACK_TO_TARGET",b.CT_CONTINUOUS,[u],null,function(a,d,e){if(e)if(c.is_eye_camera(a))if(e=b.get_sensor_value(a,d,0),K+=e,K<N){var f=Q/N*e;e*=P/N;d=K/N;d=6*d*(1-d);f*=d;e*=d;ra-=f;sa-=e;c.eye_rotate(a,f,e)}else K<ha?(ra&&(c.eye_rotate(a,ra,sa),ra=0,r&&r()),d=(K-N)/t,e=-H*e/t,ea-=f,g.move_local(a,0,6*e*d*(1-d),0)):K<qa?ea&&(g.move_local(a,0,ea,0),ea=
0):K<na?(d=(K-qa)/t,e=H*e/t,e=6*e*d*(1-d),g.move_local(a,0,e,0)):(g.set_translation_v(a,y),oa());else oa()})}};a.auto_rotate=function(a,d,g){function h(d,f,g){if(1==g)if(g=c.get_move_style(d),g==c.MS_STATIC)m();else if(g!=c.MS_TARGET_CONTROLS&&g!=c.MS_EYE_CONTROLS||!c.has_horizontal_rot_limits(d))q=null,f=b.get_sensor_value(d,f,0),c.rotate_camera(d,f*a,0);else{g=g==c.MS_EYE_CONTROLS?c.eye_get_horizontal_limits(d,w):c.target_get_horizontal_limits(d,w);if(null===q||g.left!=q.left||g.right!=q.right){q=
q||{};q.left=g.left;q.right=g.right;u=Math.min(.2,v.angle_wrap_0_2pi(q.right-q.left)/2);g=p;var l=q,n=c.get_camera_angles(g,k)[0];g=e(g,n,l.left,l.right,r);t=a*Math.min(1,g[0]/.2,g[1]/.2)}f=b.get_sensor_value(d,f,0);g=c.get_camera_angles(d,k)[0];g=e(d,g,q.left,q.right,r);g[1]>u&&g[0]>u?t=v.sign(t)*a:g[1]<u?t-=Math.pow(a,2)/.4*f:g[0]<u&&(t+=Math.pow(a,2)/.4*f);c.rotate_camera(d,f*t,0)}}function m(){b.remove_sensor_manifold(p,"AUTO_ROTATE");b.remove_sensor_manifold(p,"DISABLE_AUTO_ROTATE");d()}d=d||
function(){};var p=f.get_active_camera();if(c.is_static_camera(p))n.error("auto_rotate(): Wrong camera move style");else{var q={},u=0,t=0;if(b.check_sensor_manifold(p,"AUTO_ROTATE"))m();else{var y=b.create_mouse_move_sensor("X"),x=b.create_mouse_move_sensor("Y"),B=b.create_mouse_click_sensor(),A=b.create_touch_move_sensor(),C=b.create_touch_zoom_sensor(),D=b.create_elapsed_sensor();g=g?b.create_mouse_wheel_sensor():b.create_custom_sensor(0);b.create_sensor_manifold(p,"DISABLE_AUTO_ROTATE",b.CT_LEVEL,
[y,x,B,A,C,g],function(a){return a[0]&&a[2]||a[1]&&a[2]||a[3]||a[4]||a[5]},m);b.create_sensor_manifold(p,"AUTO_ROTATE",b.CT_CONTINUOUS,[D],function(a){return a[0]},h)}}};a.is_auto_rotate=function(){var a=f.get_active_camera();return b.check_sensor_manifold(a,"AUTO_ROTATE")};a.check_auto_rotate=function(){var a=f.get_active_camera();return c.get_move_style(a)==c.MS_STATIC?!1:!0};a.move_camera_to_point=function(a,b,d,e,f){if(c.get_move_style(a)!=c.MS_STATIC)n.error("move_camera_to_point(): wrong camera type");
else if(!h)if(a)if(b){d=d||1;e=e||.01;var k=v.is_vector(a)?a:g.get_tsr(a,y),p=v.is_vector(b)?b:g.get_tsr(b,A);b=x.distance(m.get_trans_view(k),m.get_trans_view(p))/d;d=v.quat_to_dir(m.get_quat_view(k),v.AXIS_MZ,C);var q=v.quat_to_dir(m.get_quat_view(p),v.AXIS_MZ,B);d=Math.min(Math.abs(x.dot(d,q)),1);e=1E3*Math.max(b,Math.acos(d)/e);h=!0;var r=t.animate(0,1,e,function(b){var c=m.interpolate(k,p,v.smooth_step(b),H);P?(t.clear_animation(r),h=P=!1):(g.set_tsr(a,c),1==b&&(h=!1,f&&f()))})}else n.error("move_camera_to_point(): you must specify the point object");
else n.error("move_camera_to_point(): you must specify the camera object")};a.rotate_camera=function(a,b,d,e,f){if(c.get_move_style(a)==c.MS_STATIC)n.error("rotate_camera(): not supported for STATIC cameras");else if(!u)if(a)if(b||d){u=!0;var g=0,h=0,k=0!=b?b:d,m=t.animate(0,k,e||1E3,function(e){p?(t.clear_animation(m),u=p=!1):(g-=e,h-=e,d&&b?c.rotate_camera(a,g,h):d?c.rotate_camera(a,0,h):b&&c.rotate_camera(a,g,0),h=g=e,e==k&&(u=!1,f&&f()))})}else n.error("rotate_camera(): you must specify the rotation angle");
else n.error("rotate_camera(): you must specify the camera object")};a.stop_cam_moving=function(){P=!0};a.stop_cam_rotating=function(){p=!0};a.is_moving=function(){return h};a.is_rotating=function(){return u}};b4w.module.gp_conf=function(a,q){function e(){l.length=0;for(var a=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads:[],b=0;b<a.length;b++)a[b]&&l.push(a[b]);return l}function c(a){var b=C.get(a+"_gmpd_stngs","b4w");if(b){var b=JSON.parse(b),c;for(c in b)r.set_gamepad_key(a,c,b[c])}else c=JSON.stringify(F),C.set(a+"_gmpd_stngs",c,"b4w")}function b(a){G=!0;var b=document.createElement("div"),c=document.createElement("div"),d=document.createElement("div"),
e=document.createElement("div"),f=document.createElement("div"),g=document.createElement("div"),k=document.createElement("div"),l=document.createElement("div"),n=document.createElement("div"),p=document.createElement("div"),q=document.createElement("div"),u=document.createElement("div"),t=document.createElement("div"),v=document.createElement("div"),w=document.createElement("div"),z=document.createElement("div"),y=document.createElement("div"),x=document.createElement("div"),A=document.createElement("div"),
C=document.createElement("div"),F=document.createElement("div"),H=document.createElement("div");h=b;b.style.cssText="position: absolute;height: auto;background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg26627" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="128.51mm" viewBox="0 0 636.63517 455.33329" width="179.67mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:dc="http://purl.org/dc/elements/1.1/"><defs id="defs26629"><linearGradient id="linearGradient4691"><stop id="stop4693" offset="0"/><stop id="stop4695" stop-opacity="0" offset="1"/></linearGradient><linearGradient id="linearGradient4358"><stop id="stop4360" stop-color="#2e2e2e" offset="0"/><stop id="stop4362" stop-color="#2e2e2e" stop-opacity="0" offset="1"/></linearGradient><linearGradient id="linearGradient4364" x1="1141.5" xlink:href="#linearGradient4358" gradientUnits="userSpaceOnUse" y1="255.95" gradientTransform="matrix(-1 0 0 1 1531.4 560.1)" x2="1165.2" y2="309.88"/><linearGradient id="linearGradient4368" x1="1141.5" xlink:href="#linearGradient4358" gradientUnits="userSpaceOnUse" y1="255.95" gradientTransform="translate(-896.37 560.1)" x2="1165.2" y2="309.88"/><linearGradient id="linearGradient4430" x1="959.32" gradientUnits="userSpaceOnUse" y1="653.07" gradientTransform="matrix(-1 0 0 1 1531.4 70.097)" x2="1467.6" y2="653.07"><stop id="stop4426" stop-color="#4f4f4f" offset="0"/><stop id="stop4428" stop-color="#4f4f4f" stop-opacity="0" offset="1"/></linearGradient><linearGradient id="linearGradient4701" x1="529.91" xlink:href="#linearGradient4691" gradientUnits="userSpaceOnUse" y1="111.1" gradientTransform="translate(-52.276 546.89)" x2="481.49" y2="85.746"/><linearGradient id="linearGradient4713" x1="529.91" xlink:href="#linearGradient4691" gradientUnits="userSpaceOnUse" y1="111.1" gradientTransform="matrix(-1 0 0 1 689.01 546.89)" x2="481.49" y2="85.746"/><linearGradient id="linearGradient4725" x1="367.39" xlink:href="#linearGradient4691" gradientUnits="userSpaceOnUse" y1="125.6" gradientTransform="matrix(-1.3272 0 0 .68317 806.95 579.14)" x2="367.39" y2="116.11"/></defs><metadata id="metadata26632"><rdf:RDF><cc:Work rdf:about="">    <dc:format>image/svg+xml</dc:format>    <dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/>    <dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -597.03)"><g id="g20" fill-rule="evenodd"><path id="path4209" fill="#434343" d="m576.71 1052.4c42.015-1.9097 64.296-46.468 59.204-122.86-5.0928-76.387-27.374-175.69-44.562-224.7-17.188-49.015-25.501-62.531-26.737-65.565-3.7697-9.2504-11.278-19.949-62.379-27.691-28.97-4.3891-16.697-7.9577-27.084-9.4696-17.96-2.6141-43.609-1.229-52.203 1.6354-8.594 2.8645-12.709 29.16-24.486 35.207-11.777 6.0473-19.416 10.185-80.149 10.185s-68.372-4.1376-80.149-10.185c-11.777-6.0473-18.113-32.099-25.736-36.993-11.183-7.1796-26.985-5.6722-54.891-0.57481-5.64 1.0302-1.1304 7.6212-18.165 12.509-32.913 9.4438-52.094 3.7056-65.087 20.831-1.9807 2.6106-11.822 21.096-29.01 70.111-17.179 48.95-39.46 148.25-44.553 224.64-5.0929 76.39 17.188 120.99 59.204 122.89 73.339-1.7 55.219-116.53 258.4-116.53s185.05 114.82 258.4 116.49z"/><path id="path4366" fill="url(#linearGradient4368)" d="m249.77 838.51c-107.76 0-171.55 96.288-176.84 121.23-5.2294 24.634-17.658 55.705 3.8195 53.789 9.6996-0.8655 18.053-15.713 37.559-38.193 18.78-21.643 41.379-54.425 96.763-54.425s73.209-44.877 75.119-53.152c1.9098-8.2752 2.4146-27.976-36.418-29.25z"/><path id="path4217" fill="url(#linearGradient4364)" d="m385.23 838.51c107.76 0 171.55 96.288 176.84 121.23 5.2293 24.634 17.658 55.705-3.8195 53.789-9.6996-0.8655-18.053-15.713-37.559-38.193-18.78-21.643-41.379-54.425-96.763-54.425s-73.209-44.877-75.119-53.152c-1.9098-8.2752-2.4146-27.976 36.418-29.25z"/><path id="path4370" fill="url(#linearGradient4430)" d="m572.06 654.81c-60.48-19.09-76.79-18.6-89.84-17.96-13.05 0.63657-22.638 16.617-45.237 49.4s-67.48 125.27-116.23 125.27c-48.746 0-93.626-92.491-116.23-125.27-22.599-32.783-32.008-48.942-45.059-49.579-13.05-0.63648-35.251 1.8354-95.728 20.932l1.1161-2.3404c60.494-19.1 81.754-20.83 94.804-20.19 13.05 0.63657 22.281 13.049 44.88 45.832s67.48 123.49 116.23 123.49c48.746 0 93.626-90.709 116.23-123.49 22.599-32.783 31.83-45.195 44.88-45.832 13.05-0.63648 28.783-1.6248 89.26 17.472"/><path id="path4315" fill="#343434" d="m570.99 652.48c-60.477-19.097-76.074-18.269-89.124-17.633-13.05 0.63658-22.281 14.832-44.88 47.614-22.599 32.783-67.48 125.27-116.23 125.27-48.746 0-93.626-92.491-116.23-125.27-22.599-32.783-31.83-46.978-44.88-47.614-13.05-0.63648-34.715 1.2996-95.192 20.396l1.1161-2.3404c60.474-19.1 81.024-22.26 94.074-21.62 13.05 0.63658 22.281 13.049 44.88 45.832s67.48 123.49 116.23 123.49c48.746 0 93.626-90.709 116.23-123.49 22.599-32.783 31.83-45.195 44.88-45.832 13.05-0.63647 27.71-0.17274 88.186 18.924"/></g><g id="g15645" transform="matrix(.75439 0 0 1 1558.5 -6638.3)" fill-rule="evenodd"><rect id="rect15584" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="2" ry="1.8461" height="44.307" width="570" y="6558.3" x="100.71" fill="#4164bb"/><rect id="rect15331" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="2" ry="1.8461" height="44.307" width="570" y="6554.6" x="100.71" fill="#5276cf"/></g><text id="text15623-9" style="word-spacing:0px;letter-spacing:0px" font-weight="300" xml:space="preserve" font-size="22px" line-height="430.99999428%" y="-53.755863" x="1792.7805" font-family="&apos;Noto Sans CJK TC&apos;" fill="#ffffff"><tspan id="tspan15625-5" y="-53.755863" x="1792.7805"/></text><text id="text15657" style="word-spacing:0px;letter-spacing:0px" font-weight="300" xml:space="preserve" font-size="13px" line-height="430.99999428%" y="-3.7607465" x="1670.2437" font-family="&apos;Noto Sans CJK TC&apos;" fill="#828282"><tspan id="tspan15659" y="-3.7607465" x="1670.2437"/></text><g id="g34" fill-rule="evenodd"><path id="path4675" fill="#303030" d="m551.75 628.4c9.3003 4.1796 8.2375 11.558 2.1302 9.9581-6.1073-1.6003-33.792-9.1405-46.239-11.577-12.446-2.4363-34.904-3.0623-36.951-4.0165-2.0474-0.95416 0.93313-7.7247 5.491-7.3449 23.258 0.91012 59.905 6.0339 75.569 12.98z"/><path id="path4677" fill="#303030" d="m474.88 602.61c3.6488 0.63684 4.1169 1.3708 2.4115 5.2499-0.80967 1.8416-1.261 3.904-3.4715 3.7336-4.456-0.34344-16.578-1.2846-25.692-1.3764-9.1139-0.0918-23.83 1.217-25.307 0.79399-1.4771-0.42301-1.8834-4.9141 1.7769-6.7458 4.6221-1.3593 38.698-3.2021 50.281-1.6553z"/><path id="path4699" opacity=".384" fill="url(#linearGradient4701)" d="m475.53 611.7c-11.693-0.63604-8.4597-0.73151-44.068 54.448-6.5182 8.6489-22.874 37.231-36.865 35.326-6.7491-1.4177 15.436-67.299 22.724-75.767 11.112-12.911 19.255-16.122 58.209-14.007z"/><path id="path4703" fill="#303030" d="m84.068 628.4c-9.3003 4.1796-8.2375 11.558-2.1302 9.9581 6.1073-1.6003 33.792-9.1405 46.239-11.577 12.446-2.4363 34.904-3.0623 36.951-4.0165 2.0474-0.95416-0.93313-7.7247-5.491-7.3449-23.258 0.91012-59.905 6.0339-75.569 12.98z"/><path id="path4705" fill="#303030" d="m161.86 602.61c-3.6488 0.63684-4.1169 1.3708-2.4115 5.2499 0.80967 1.8416 1.261 3.904 3.4715 3.7336 4.456-0.34344 16.578-1.2846 25.692-1.3764 9.1139-0.0918 23.83 1.217 25.307 0.79399 1.4771-0.42301 1.8834-4.9141-1.7769-6.7458-4.6221-1.3593-38.698-3.2021-50.281-1.6553z"/><path id="path4711" opacity=".384" fill="url(#linearGradient4713)" d="m161.2 611.7c11.693-0.63604 8.4597-0.73151 44.068 54.448 6.5182 8.6489 22.874 37.231 36.865 35.326 6.7491-1.4177-15.436-67.299-22.724-75.767-11.112-12.911-19.255-16.122-58.209-14.007z"/><path id="path4717" opacity=".115" fill="url(#linearGradient4725)" d="m413.37 645.84c-9.0496 10.007-29.401 19.937-36.775 19.937h-52.205c-31.171 0-37.359 0.34506-47.75 0.51758-10.39 0.17253-18.682 0.65628-23.653-3.278-5.0513-3.9977-24-15.425-24-15.425 53.346 4.1464 144.49 4.3368 184.38-1.7523z"/></g></g><g id="layer1-0" fill-rule="evenodd" transform="translate(159.08 -720.76)"><g id="g4527-3" transform="translate(-961.22,330.69)"><ellipse id="circle4233-8" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="66.284" ry="66.279" cy="655.39" cx="1027.5" fill="#303030"/><ellipse id="circle4235-8" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="62.007" ry="62.003" cy="655.39" cx="1027.5" fill="#4c4c4c"/><ellipse id="circle4237-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="43.41" ry="43.408" cy="655.39" cx="1027.5" fill="#303030"/></g><g id="g4523-1" transform="translate(-961.22,330.69)"><ellipse id="circle4239-4" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="40.057" ry="40.054" cy="655.39" cx="1027.5" fill="#3b63c9"/><ellipse id="circle4243-3" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="36.23" ry="36.228" cy="655.39" cx="1027.5" fill="#5276cf"/></g><g id="g3506" transform="translate(-961.22,330.69)"><ellipse id="ellipse3508" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="66.284" ry="66.279" cy="655.39" cx="1027.5" fill="#303030"/><ellipse id="ellipse3510" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="62.007" ry="62.003" cy="655.39" cx="1027.5" fill="#4c4c4c"/><ellipse id="ellipse3512" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="43.41" ry="43.408" cy="655.39" cx="1027.5" fill="#303030"/></g></g><g id="layer1-7" fill-rule="evenodd" transform="translate(352.57 -719.72)"><g id="g4527-3-4" transform="translate(-961.22,330.69)"><ellipse id="circle4233-8-8" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="66.284" ry="66.279" cy="655.39" cx="1027.5" fill="#303030"/><ellipse id="circle4235-8-9" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="62.007" ry="62.003" cy="655.39" cx="1027.5" fill="#4c4c4c"/><ellipse id="circle4237-7-3" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="43.41" ry="43.408" cy="655.39" cx="1027.5" fill="#303030"/></g><g id="g4523-1-1" transform="translate(-961.22,330.69)"><ellipse id="circle4239-4-4" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="40.057" ry="40.054" cy="655.39" cx="1027.5" fill="#3b63c9"/><ellipse id="circle4243-3-5" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="36.23" ry="36.228" cy="655.39" cx="1027.5" fill="#5276cf"/></g><g id="g3506-2" transform="translate(-961.22,330.69)"><ellipse id="ellipse3508-1" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="66.284" ry="66.279" cy="655.39" cx="1027.5" fill="#303030"/><ellipse id="ellipse3510-1" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="62.007" ry="62.003" cy="655.39" cx="1027.5" fill="#4c4c4c"/><ellipse id="ellipse3512-4" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="43.41" ry="43.408" cy="655.39" cx="1027.5" fill="#303030"/></g></g></svg>')+
"');width: 637px;height: 455px;background-size: 100% 100%;left: 50%;margin-bottom: 40px;-moz-transform: translateX(-50%);-ms-transform: translateX(-50%);-webkit-transform: translateX(-50%);bottom: 0px;";c.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3904" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="35.924mm" width="35.926mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 127.29808 127.28933"><metadata id="metadata3909"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" fill-rule="evenodd" transform="translate(0 -925.07)"><ellipse id="circle4330" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="63.649" ry="63.645" cy="988.72" cx="63.649" fill="#303030"/><ellipse id="circle4223" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="59.705" ry="59.701" cy="988.72" cx="63.649" fill="#4c4c4c"/></g></svg>')+
"');position: absolute;top: 47px;left: 65px;width: 135px;height: 135px;";d.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3754" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.711mm" width="9.9653mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 35.3101 37.950677"><metadata id="metadata3759"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1014.4)"><path id="path4326" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m34.81 1017.1c-15.254-3.8172-24.634-1.7612-34.31 0v16.247h0.015c-0.013 0.097-0.013 0.1951-0.015 0.2928 0.0006 9.4753 7.6813 18.256 17.156 18.256 9.4739-0.0005 17.154-8.7813 17.154-18.256 0-0.097-0.014-0.1952-0.014-0.2928h0.014z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>')+
"');width: 36px;height: 38px;left: 49px;top: 8px;position: absolute;";e.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3790" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.9646mm" width="10.711mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 37.953175 35.3077"><metadata id="metadata3795"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1017.1)"><path id="path4324" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m35.298 1017.6c3.8175 15.253 1.7611 24.633 0 34.308h-16.248v-0.015c-0.098 0.01-0.1952 0.01-0.2928 0.015-9.476-0.0006-18.258-7.6807-18.257-17.154 0.0005-9.4733 8.7818-17.153 18.257-17.153 0.098 0 0.1952 0.01 0.2928 0.011v-0.011z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>')+
"');width: 38px;height: 36px;top: 47px;left: 84px;position: absolute;";f.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3754" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.711mm" width="9.9653mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 35.3101 37.950677"><metadata id="metadata3759"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1014.4)"><path id="path4328" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m34.81 1049.7c-15.254 3.8172-24.634 1.7612-34.31 0v-16.247h0.015c-0.013-0.097-0.013-0.1951-0.015-0.2928 0.0006-9.4753 7.6813-18.256 17.156-18.256 9.4739 0.0005 17.154 8.7813 17.154 18.256 0 0.097-0.014 0.1952-0.014 0.2928h0.014z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>')+
"');width: 36px;height: 38px;bottom: 11px;left: 51px;position: absolute;";g.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3790" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.9646mm" width="10.711mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 37.953175 35.3077"><metadata id="metadata3795"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1017.1)"><path id="path4324" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m2.6552 1051.9c-3.8175-15.253-1.7611-24.633 0-34.308h16.248v0.015c0.098-0.01 0.1952-0.01 0.2928-0.015 9.476 0.0006 18.258 7.6807 18.257 17.154-0.0005 9.4733-8.7818 17.153-18.257 17.153-0.098 0-0.1952-0.01-0.2928-0.011v0.011z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>')+
"');width: 38px;height: 36px;top: 47px;left: 13px;position: absolute;";k.style.cssText="position: absolute;top: 55px;left: 434px;width: 150px;height: 150px;";l.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3548" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="13.417mm" width="13.418mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 47.543997 47.542"><metadata id="metadata3553"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1004.8)"><ellipse id="circle4271" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="23.772" ry="23.771" cy="1028.6" cx="23.772" fill="#303030"/><ellipse id="circle4273" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="18.668" ry="18.667" stroke="#3b63c9" cy="1028.6" cx="23.772" fill="#5276cf"/></g></svg>')+
"');width: 50px;height: 50px;left: 53px;top: 0px;position: absolute;";n.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3548" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="13.417mm" width="13.418mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 47.543997 47.542"><metadata id="metadata3553"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1004.8)"><ellipse id="circle4271" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="23.772" ry="23.771" cy="1028.6" cx="23.772" fill="#303030"/><ellipse id="circle4273" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="18.668" ry="18.667" stroke="#3b63c9" cy="1028.6" cx="23.772" fill="#5276cf"/></g></svg>')+
"');width: 50px;height: 50px;left: 107px;top: 51px;position: absolute;";p.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3548" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="13.417mm" width="13.418mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 47.543997 47.542"><metadata id="metadata3553"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1004.8)"><ellipse id="circle4271" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="23.772" ry="23.771" cy="1028.6" cx="23.772" fill="#303030"/><ellipse id="circle4273" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="18.668" ry="18.667" stroke="#3b63c9" cy="1028.6" cx="23.772" fill="#5276cf"/></g></svg>')+
"');width: 50px;height: 50px;left: 53px;bottom: 0px;position: absolute;";q.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3548" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="13.417mm" width="13.418mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 47.543997 47.542"><metadata id="metadata3553"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1004.8)"><ellipse id="circle4271" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="23.772" ry="23.771" cy="1028.6" cx="23.772" fill="#303030"/><ellipse id="circle4273" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="18.668" ry="18.667" stroke="#3b63c9" cy="1028.6" cx="23.772" fill="#5276cf"/></g></svg>')+
"');width: 50px;height: 50px;top: 51px;position: absolute;";u.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3461" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="22.608mm" width="22.61mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 80.114398 80.108405"><metadata id="metadata3466"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(.0000019915 -972.25)"><g id="g3514-7" fill-rule="evenodd" transform="translate(-987.45 356.91)"><ellipse id="ellipse3516-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="40.057" ry="40.054" cy="655.39" cx="1027.5" fill="#3b63c9"/><ellipse id="ellipse3518-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="36.23" ry="36.228" cy="655.39" cx="1027.5" fill="#5276cf"/></g></g></svg>')+
"');position: absolute;top: 222px;left: 183px;width: 85px;height: 85px;";t.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3461" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="22.608mm" width="22.61mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 80.114398 80.108405"><metadata id="metadata3466"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(.0000019915 -972.25)"><g id="g3514-7" fill-rule="evenodd" transform="translate(-987.45 356.91)"><ellipse id="ellipse3516-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="40.057" ry="40.054" cy="655.39" cx="1027.5" fill="#3b63c9"/><ellipse id="ellipse3518-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="36.23" ry="36.228" cy="655.39" cx="1027.5" fill="#5276cf"/></g></g></svg>')+
"');position: absolute;top: 223px;left: 376px;width: 85px;height: 85px;";v.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3699" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.2811mm" width="9.2817mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 32.8879 32.88565"><metadata id="metadata3704"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" fill-rule="evenodd" transform="translate(0 -1019.5)"><ellipse id="ellipse4575" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="16.444" ry="16.443" cy="1035.9" cx="16.444" fill="#2e2e2e"/><ellipse id="ellipse4577" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="15.112" ry="15.11" stroke="#4364b2" cy="1035.9" cx="16.444" fill="#5276cf"/><ellipse id="ellipse4579" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="11.867" ry="11.866" cy="1035.9" cx="16.444" fill="#434343"/></g></svg>')+
"');position: absolute;top: 76px;left: 227px;width: 34px;height: 34px;";w.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3699" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.2811mm" width="9.2817mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 32.8879 32.88565"><metadata id="metadata3704"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" fill-rule="evenodd" transform="translate(0 -1019.5)"><ellipse id="ellipse4575" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="16.444" ry="16.443" cy="1035.9" cx="16.444" fill="#2e2e2e"/><ellipse id="ellipse4577" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="15.112" ry="15.11" stroke="#4364b2" cy="1035.9" cx="16.444" fill="#5276cf"/><ellipse id="ellipse4579" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="11.867" ry="11.866" cy="1035.9" cx="16.444" fill="#434343"/></g></svg>')+
"');position: absolute;top: 76px;left: 376px;width: 34px;height: 34px;";z.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="21.241671mm" height="8.8544388mm" viewBox="0 0 75.265762 31.373996" id="svg3447" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="l1.svg"><defs id="defs3449" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="1.4" inkscape:cx="-254.57869" inkscape:cy="228.81952" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3452"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(1.5000945e-8,-1020.9882)"><path style="fill:#5276cf;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:0.99999994px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1" d="m 11.026383,1051.1651 c -7.4440599,1.9144 -7.5133499,2.2466 -9.7963799,-4.4934 -1.81058997,-5.3452 -2.44278,-8.8152 4.01547,-12.116 2.74038,-1.4007 13.7365799,-5.877 38.4768299,-10.72 24.26031,-4.749 25.16653,-2.7967 26.79132,0.3418 1.15503,2.2311 1.8961,4.1561 2.94279,6.651 3.08552,8.5188 2.92609,8.5778 -6.08214,9.5501 -19.09891,2.1414 -37.95723,5.8307 -56.34789,10.7865 z" id="path4289" inkscape:connector-curvature="0" sodipodi:nodetypes="cssssccc" /></g></svg>')+
"');position: absolute;top: 4px;left: 78px;width: 79px;height: 33px;";y.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3447" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="8.8544mm" width="21.242mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 75.265762 31.373996"><metadata id="metadata3452"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(1.5001e-8 -1021)"><path id="path4715" d="m64.239 1051.2c7.4441 1.9144 7.5134 2.2466 9.7964-4.4934 1.8106-5.3452 2.4428-8.8152-4.0155-12.116-2.7404-1.4007-13.737-5.877-38.477-10.72-24.26-4.749-25.167-2.7967-26.791 0.3418-1.155 2.2311-1.8961 4.1561-2.9428 6.651-3.0855 8.5188-2.9261 8.5778 6.0822 9.5501 19.099 2.1414 37.957 5.8307 56.348 10.786z" fill-rule="evenodd" fill="#5276cf"/></g></svg>')+
"');position: absolute;top: 4px;left: 477px;width: 79px;height: 33px;";x.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3560" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="4.7796mm" width="13.57mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 48.082162 16.935645"><metadata id="metadata3565"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1035.4)"><path id="path4727" d="m42.857 1052.2c4.7071 0.4081 4.7981 0.6563 5.1414-4.9139 0.16344-2.6517 0.16699-6.1108-0.72615-8.0342-0.59471-1.2808-1.7793-2.049-3.7642-2.4662-2.5264-0.531-16.253-1.4345-26.685-1.3241-15.118 0.16-15.362 1.4769-15.855 4.1522-0.35071 1.9018-0.5016 3.5056-0.74837 5.5967-0.55261 7.0693-0.44908 7.0921 5.0452 6.5411 11.661-1.1062 25.929-0.7359 37.592 0.4484z" fill-rule="evenodd" fill="#5276cf"/></g></svg>')+
"');position: absolute;top: -7px;left: 425px;width: 50px;height: 17px;";A.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3560" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="4.7796mm" width="13.57mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 48.082162 16.935645"><metadata id="metadata3565"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1035.4)"><path id="path4727" d="m42.857 1052.2c4.7071 0.4081 4.7981 0.6563 5.1414-4.9139 0.16344-2.6517 0.16699-6.1108-0.72615-8.0342-0.59471-1.2808-1.7793-2.049-3.7642-2.4662-2.5264-0.531-16.253-1.4345-26.685-1.3241-15.118 0.16-15.362 1.4769-15.855 4.1522-0.35071 1.9018-0.5016 3.5056-0.74837 5.5967-0.55261 7.0693-0.44908 7.0921 5.0452 6.5411 11.661-1.1062 25.929-0.7359 37.592 0.4484z" fill-rule="evenodd" fill="#5276cf"/></g></svg>')+
"');position: absolute;top: -7px;left: 164px;width: 50px;height: 17px;";C.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="24.603382mm" height="24.601696mm" viewBox="0 0 87.177338 87.171363" id="svg3640" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="main.svg"><defs id="defs3642" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="1.979899" inkscape:cx="61.113463" inkscape:cy="69.71796" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3645"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(0,-965.19093)"><ellipse ry="43.585682" rx="43.588669" style="color:#000000;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:#000000;solid-opacity:1;fill:#2e2e2e;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:0.99999994;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate" id="ellipse4372" cx="43.588669" cy="1008.7766" /><ellipse cy="1008.7766" cx="43.588669" id="circle4239-1" style="color:#000000;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:#000000;solid-opacity:1;fill:#5276cf;fill-opacity:1;fill-rule:evenodd;stroke:#4364b2;stroke-width:0.99999994;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate" rx="40.056705" ry="40.053959" /><ellipse style="color:#000000;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:#000000;solid-opacity:1;fill:#434343;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:0.99999994;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate" id="circle4243-0" cx="43.588669" cy="1008.7766" rx="31.455994" ry="31.453836" /></g></svg>')+
"');position: absolute;top: 68px;left: 274px;width: 92px;height: 92px;";F.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3407" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="41.787mm" width="41.786mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 148.0624 148.06251"><metadata id="metadata3412"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -904.3)" fill="#e6e6e6"><path id="rect4545" d="m74.031 904.3-14.469 22.156h8.0313v8.2187h12.875v-8.2187h8.0625l-14.5-22.156z"/><path id="rect4603" d="m125.94 963.86v8.0313h-8.25v12.906h8.25v8.0313l22.125-14.5-22.125-14.469z"/><path id="rect4609" d="m67.594 1022v8.25h-8.0313l14.469 22.125 14.5-22.125h-8.0625v-8.25h-12.875z"/><path id="rect4615" d="m22.156 963.86-22.156 14.47l22.156 14.5v-8.2188h8.2188v-12.906h-8.2188v-7.8438z"/><path id="path4619" style="color:#000000;text-indent:0;block-progression:tb;text-decoration-line:none;text-transform:none" d="m54.393 924.58c-15.821 5.7885-28.404 18.385-34.188 34.219h11.156c4.6667-10.175 12.865-18.361 23.031-23.031v-11.188zm39.219 0.031v11.156c10.167 4.6713 18.361 12.86 23.031 23.031h11.156c-5.7846-15.821-18.379-28.393-34.188-34.188zm-73.375 73.438c5.7899 15.816 18.348 28.403 34.156 34.188v-11.156c-10.163-4.6691-18.364-12.861-23.031-23.031h-11.125zm96.406 0c-4.6712 10.167-12.868 18.361-23.031 23.031v11.125c15.796-5.7901 28.366-18.352 34.156-34.156h-11.125z"/></g></svg>')+
"');position: absolute;top: 186px;left: 148px;width: 157px;height: 157px;";H.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3407" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="41.787mm" width="41.786mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 148.0624 148.06251"><metadata id="metadata3412"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -904.3)" fill="#e6e6e6"><path id="rect4545" d="m74.031 904.3-14.469 22.156h8.0313v8.2187h12.875v-8.2187h8.0625l-14.5-22.156z"/><path id="rect4603" d="m125.94 963.86v8.0313h-8.25v12.906h8.25v8.0313l22.125-14.5-22.125-14.469z"/><path id="rect4609" d="m67.594 1022v8.25h-8.0313l14.469 22.125 14.5-22.125h-8.0625v-8.25h-12.875z"/><path id="rect4615" d="m22.156 963.86-22.156 14.47l22.156 14.5v-8.2188h8.2188v-12.906h-8.2188v-7.8438z"/><path id="path4619" style="color:#000000;text-indent:0;block-progression:tb;text-decoration-line:none;text-transform:none" d="m54.393 924.58c-15.821 5.7885-28.404 18.385-34.188 34.219h11.156c4.6667-10.175 12.865-18.361 23.031-23.031v-11.188zm39.219 0.031v11.156c10.167 4.6713 18.361 12.86 23.031 23.031h11.156c-5.7846-15.821-18.379-28.393-34.188-34.188zm-73.375 73.438c5.7899 15.816 18.348 28.403 34.156 34.188v-11.156c-10.163-4.6691-18.364-12.861-23.031-23.031h-11.125zm96.406 0c-4.6712 10.167-12.868 18.361-23.031 23.031v11.125c15.796-5.7901 28.366-18.352 34.156-34.156h-11.125z"/></g></svg>')+
"');position: absolute;top: 187px;left: 339px;width: 157px;height: 157px;";b.appendChild(F);b.appendChild(H);c.appendChild(d);c.appendChild(e);c.appendChild(f);c.appendChild(g);b.appendChild(c);k.appendChild(l);k.appendChild(n);k.appendChild(p);k.appendChild(q);b.appendChild(k);b.appendChild(u);b.appendChild(t);b.appendChild(v);b.appendChild(w);b.appendChild(z);b.appendChild(y);b.appendChild(x);a.appendChild(b);b.appendChild(A);b.appendChild(C);M.length=0;D.length=0;E.length=0;W.length=0;M.push(p,
n,q,l,z,y,A,x,v,w,u,t,d,f,g,e,C);D.push('<svg id="svg3548" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="13.417mm" width="13.418mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 47.543997 47.542"><metadata id="metadata3553"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1004.8)"><ellipse id="circle4271" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="23.772" ry="23.771" cy="1028.6" cx="23.772" fill="#303030"/><ellipse id="circle4273" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="18.668" ry="18.667" stroke="#3b63c9" cy="1028.6" cx="23.772" fill="#5276cf"/></g></svg>',
'<svg id="svg3548" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="13.417mm" width="13.418mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 47.543997 47.542"><metadata id="metadata3553"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1004.8)"><ellipse id="circle4271" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="23.772" ry="23.771" cy="1028.6" cx="23.772" fill="#303030"/><ellipse id="circle4273" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="18.668" ry="18.667" stroke="#3b63c9" cy="1028.6" cx="23.772" fill="#5276cf"/></g></svg>',
'<svg id="svg3548" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="13.417mm" width="13.418mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 47.543997 47.542"><metadata id="metadata3553"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1004.8)"><ellipse id="circle4271" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="23.772" ry="23.771" cy="1028.6" cx="23.772" fill="#303030"/><ellipse id="circle4273" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="18.668" ry="18.667" stroke="#3b63c9" cy="1028.6" cx="23.772" fill="#5276cf"/></g></svg>',
'<svg id="svg3548" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="13.417mm" width="13.418mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 47.543997 47.542"><metadata id="metadata3553"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1004.8)"><ellipse id="circle4271" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="23.772" ry="23.771" cy="1028.6" cx="23.772" fill="#303030"/><ellipse id="circle4273" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="18.668" ry="18.667" stroke="#3b63c9" cy="1028.6" cx="23.772" fill="#5276cf"/></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="21.241671mm" height="8.8544388mm" viewBox="0 0 75.265762 31.373996" id="svg3447" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="l1.svg"><defs id="defs3449" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="1.4" inkscape:cx="-254.57869" inkscape:cy="228.81952" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3452"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(1.5000945e-8,-1020.9882)"><path style="fill:#5276cf;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:0.99999994px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1" d="m 11.026383,1051.1651 c -7.4440599,1.9144 -7.5133499,2.2466 -9.7963799,-4.4934 -1.81058997,-5.3452 -2.44278,-8.8152 4.01547,-12.116 2.74038,-1.4007 13.7365799,-5.877 38.4768299,-10.72 24.26031,-4.749 25.16653,-2.7967 26.79132,0.3418 1.15503,2.2311 1.8961,4.1561 2.94279,6.651 3.08552,8.5188 2.92609,8.5778 -6.08214,9.5501 -19.09891,2.1414 -37.95723,5.8307 -56.34789,10.7865 z" id="path4289" inkscape:connector-curvature="0" sodipodi:nodetypes="cssssccc" /></g></svg>',
'<svg id="svg3447" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="8.8544mm" width="21.242mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 75.265762 31.373996"><metadata id="metadata3452"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(1.5001e-8 -1021)"><path id="path4715" d="m64.239 1051.2c7.4441 1.9144 7.5134 2.2466 9.7964-4.4934 1.8106-5.3452 2.4428-8.8152-4.0155-12.116-2.7404-1.4007-13.737-5.877-38.477-10.72-24.26-4.749-25.167-2.7967-26.791 0.3418-1.155 2.2311-1.8961 4.1561-2.9428 6.651-3.0855 8.5188-2.9261 8.5778 6.0822 9.5501 19.099 2.1414 37.957 5.8307 56.348 10.786z" fill-rule="evenodd" fill="#5276cf"/></g></svg>',
'<svg id="svg3560" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="4.7796mm" width="13.57mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 48.082162 16.935645"><metadata id="metadata3565"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1035.4)"><path id="path4727" d="m42.857 1052.2c4.7071 0.4081 4.7981 0.6563 5.1414-4.9139 0.16344-2.6517 0.16699-6.1108-0.72615-8.0342-0.59471-1.2808-1.7793-2.049-3.7642-2.4662-2.5264-0.531-16.253-1.4345-26.685-1.3241-15.118 0.16-15.362 1.4769-15.855 4.1522-0.35071 1.9018-0.5016 3.5056-0.74837 5.5967-0.55261 7.0693-0.44908 7.0921 5.0452 6.5411 11.661-1.1062 25.929-0.7359 37.592 0.4484z" fill-rule="evenodd" fill="#5276cf"/></g></svg>',
'<svg id="svg3560" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="4.7796mm" width="13.57mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 48.082162 16.935645"><metadata id="metadata3565"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1035.4)"><path id="path4727" d="m42.857 1052.2c4.7071 0.4081 4.7981 0.6563 5.1414-4.9139 0.16344-2.6517 0.16699-6.1108-0.72615-8.0342-0.59471-1.2808-1.7793-2.049-3.7642-2.4662-2.5264-0.531-16.253-1.4345-26.685-1.3241-15.118 0.16-15.362 1.4769-15.855 4.1522-0.35071 1.9018-0.5016 3.5056-0.74837 5.5967-0.55261 7.0693-0.44908 7.0921 5.0452 6.5411 11.661-1.1062 25.929-0.7359 37.592 0.4484z" fill-rule="evenodd" fill="#5276cf"/></g></svg>',
'<svg id="svg3699" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.2811mm" width="9.2817mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 32.8879 32.88565"><metadata id="metadata3704"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" fill-rule="evenodd" transform="translate(0 -1019.5)"><ellipse id="ellipse4575" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="16.444" ry="16.443" cy="1035.9" cx="16.444" fill="#2e2e2e"/><ellipse id="ellipse4577" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="15.112" ry="15.11" stroke="#4364b2" cy="1035.9" cx="16.444" fill="#5276cf"/><ellipse id="ellipse4579" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="11.867" ry="11.866" cy="1035.9" cx="16.444" fill="#434343"/></g></svg>',
'<svg id="svg3699" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.2811mm" width="9.2817mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 32.8879 32.88565"><metadata id="metadata3704"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" fill-rule="evenodd" transform="translate(0 -1019.5)"><ellipse id="ellipse4575" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="16.444" ry="16.443" cy="1035.9" cx="16.444" fill="#2e2e2e"/><ellipse id="ellipse4577" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="15.112" ry="15.11" stroke="#4364b2" cy="1035.9" cx="16.444" fill="#5276cf"/><ellipse id="ellipse4579" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="11.867" ry="11.866" cy="1035.9" cx="16.444" fill="#434343"/></g></svg>',
'<svg id="svg3461" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="22.608mm" width="22.61mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 80.114398 80.108405"><metadata id="metadata3466"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(.0000019915 -972.25)"><g id="g3514-7" fill-rule="evenodd" transform="translate(-987.45 356.91)"><ellipse id="ellipse3516-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="40.057" ry="40.054" cy="655.39" cx="1027.5" fill="#3b63c9"/><ellipse id="ellipse3518-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="36.23" ry="36.228" cy="655.39" cx="1027.5" fill="#5276cf"/></g></g></svg>',
'<svg id="svg3461" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="22.608mm" width="22.61mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 80.114398 80.108405"><metadata id="metadata3466"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(.0000019915 -972.25)"><g id="g3514-7" fill-rule="evenodd" transform="translate(-987.45 356.91)"><ellipse id="ellipse3516-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="40.057" ry="40.054" cy="655.39" cx="1027.5" fill="#3b63c9"/><ellipse id="ellipse3518-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="36.23" ry="36.228" cy="655.39" cx="1027.5" fill="#5276cf"/></g></g></svg>',
'<svg id="svg3754" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.711mm" width="9.9653mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 35.3101 37.950677"><metadata id="metadata3759"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1014.4)"><path id="path4326" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m34.81 1017.1c-15.254-3.8172-24.634-1.7612-34.31 0v16.247h0.015c-0.013 0.097-0.013 0.1951-0.015 0.2928 0.0006 9.4753 7.6813 18.256 17.156 18.256 9.4739-0.0005 17.154-8.7813 17.154-18.256 0-0.097-0.014-0.1952-0.014-0.2928h0.014z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>',
'<svg id="svg3754" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.711mm" width="9.9653mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 35.3101 37.950677"><metadata id="metadata3759"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1014.4)"><path id="path4328" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m34.81 1049.7c-15.254 3.8172-24.634 1.7612-34.31 0v-16.247h0.015c-0.013-0.097-0.013-0.1951-0.015-0.2928 0.0006-9.4753 7.6813-18.256 17.156-18.256 9.4739 0.0005 17.154 8.7813 17.154 18.256 0 0.097-0.014 0.1952-0.014 0.2928h0.014z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>',
'<svg id="svg3790" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.9646mm" width="10.711mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 37.953175 35.3077"><metadata id="metadata3795"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1017.1)"><path id="path4324" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m2.6552 1051.9c-3.8175-15.253-1.7611-24.633 0-34.308h16.248v0.015c0.098-0.01 0.1952-0.01 0.2928-0.015 9.476 0.0006 18.258 7.6807 18.257 17.154-0.0005 9.4733-8.7818 17.153-18.257 17.153-0.098 0-0.1952-0.01-0.2928-0.011v0.011z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>',
'<svg id="svg3790" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.9646mm" width="10.711mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 37.953175 35.3077"><metadata id="metadata3795"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1017.1)"><path id="path4324" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m35.298 1017.6c3.8175 15.253 1.7611 24.633 0 34.308h-16.248v-0.015c-0.098 0.01-0.1952 0.01-0.2928 0.015-9.476-0.0006-18.258-7.6807-18.257-17.154 0.0005-9.4733 8.7818-17.153 18.257-17.153 0.098 0 0.1952 0.01 0.2928 0.011v-0.011z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="24.603382mm" height="24.601696mm" viewBox="0 0 87.177338 87.171363" id="svg3640" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="main.svg"><defs id="defs3642" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="1.979899" inkscape:cx="61.113463" inkscape:cy="69.71796" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3645"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(0,-965.19093)"><ellipse ry="43.585682" rx="43.588669" style="color:#000000;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:#000000;solid-opacity:1;fill:#2e2e2e;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:0.99999994;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate" id="ellipse4372" cx="43.588669" cy="1008.7766" /><ellipse cy="1008.7766" cx="43.588669" id="circle4239-1" style="color:#000000;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:#000000;solid-opacity:1;fill:#5276cf;fill-opacity:1;fill-rule:evenodd;stroke:#4364b2;stroke-width:0.99999994;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate" rx="40.056705" ry="40.053959" /><ellipse style="color:#000000;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:#000000;solid-opacity:1;fill:#434343;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:0.99999994;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate" id="circle4243-0" cx="43.588669" cy="1008.7766" rx="31.455994" ry="31.453836" /></g></svg>');
E.push(u,u,t,t);W.push(F,H);for(a=0;a<M.length;a++)M[a].setAttribute("id","pad_btn_"+a),M[a].setAttribute("data-colorstate","B"),M[a].setAttribute("data-key",a),M[a].setAttribute("data-svgid",a);F.setAttribute("id","pad_left_axis");F.setAttribute("data-colorstate","GR");F.setAttribute("data-key",r.GMPD_AXIS_0);F.setAttribute("data-svgid",D.length);H.setAttribute("id","pad_right_axis");H.setAttribute("data-colorstate","GR");H.setAttribute("data-key",r.GMPD_AXIS_2);H.setAttribute("data-svgid",D.length+
1);D.push('<svg id="svg3407" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="41.787mm" width="41.786mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 148.0624 148.06251"><metadata id="metadata3412"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -904.3)" fill="#e6e6e6"><path id="rect4545" d="m74.031 904.3-14.469 22.156h8.0313v8.2187h12.875v-8.2187h8.0625l-14.5-22.156z"/><path id="rect4603" d="m125.94 963.86v8.0313h-8.25v12.906h8.25v8.0313l22.125-14.5-22.125-14.469z"/><path id="rect4609" d="m67.594 1022v8.25h-8.0313l14.469 22.125 14.5-22.125h-8.0625v-8.25h-12.875z"/><path id="rect4615" d="m22.156 963.86-22.156 14.47l22.156 14.5v-8.2188h8.2188v-12.906h-8.2188v-7.8438z"/><path id="path4619" style="color:#000000;text-indent:0;block-progression:tb;text-decoration-line:none;text-transform:none" d="m54.393 924.58c-15.821 5.7885-28.404 18.385-34.188 34.219h11.156c4.6667-10.175 12.865-18.361 23.031-23.031v-11.188zm39.219 0.031v11.156c10.167 4.6713 18.361 12.86 23.031 23.031h11.156c-5.7846-15.821-18.379-28.393-34.188-34.188zm-73.375 73.438c5.7899 15.816 18.348 28.403 34.156 34.188v-11.156c-10.163-4.6691-18.364-12.861-23.031-23.031h-11.125zm96.406 0c-4.6712 10.167-12.868 18.361-23.031 23.031v11.125c15.796-5.7901 28.366-18.352 34.156-34.156h-11.125z"/></g></svg>',
'<svg id="svg3407" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="41.787mm" width="41.786mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 148.0624 148.06251"><metadata id="metadata3412"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -904.3)" fill="#e6e6e6"><path id="rect4545" d="m74.031 904.3-14.469 22.156h8.0313v8.2187h12.875v-8.2187h8.0625l-14.5-22.156z"/><path id="rect4603" d="m125.94 963.86v8.0313h-8.25v12.906h8.25v8.0313l22.125-14.5-22.125-14.469z"/><path id="rect4609" d="m67.594 1022v8.25h-8.0313l14.469 22.125 14.5-22.125h-8.0625v-8.25h-12.875z"/><path id="rect4615" d="m22.156 963.86-22.156 14.47l22.156 14.5v-8.2188h8.2188v-12.906h-8.2188v-7.8438z"/><path id="path4619" style="color:#000000;text-indent:0;block-progression:tb;text-decoration-line:none;text-transform:none" d="m54.393 924.58c-15.821 5.7885-28.404 18.385-34.188 34.219h11.156c4.6667-10.175 12.865-18.361 23.031-23.031v-11.188zm39.219 0.031v11.156c10.167 4.6713 18.361 12.86 23.031 23.031h11.156c-5.7846-15.821-18.379-28.393-34.188-34.188zm-73.375 73.438c5.7899 15.816 18.348 28.403 34.156 34.188v-11.156c-10.163-4.6691-18.364-12.861-23.031-23.031h-11.125zm96.406 0c-4.6712 10.167-12.868 18.361-23.031 23.031v11.125c15.796-5.7901 28.366-18.352 34.156-34.156h-11.125z"/></g></svg>');
m(M,B);m(W,"#e6e6e6")}function n(a){return[k.create_gamepad_btn_sensor(r.GMPD_BUTTON_0,a),k.create_gamepad_btn_sensor(r.GMPD_BUTTON_1,a),k.create_gamepad_btn_sensor(r.GMPD_BUTTON_2,a),k.create_gamepad_btn_sensor(r.GMPD_BUTTON_3,a),k.create_gamepad_btn_sensor(r.GMPD_BUTTON_4,a),k.create_gamepad_btn_sensor(r.GMPD_BUTTON_5,a),k.create_gamepad_btn_sensor(r.GMPD_BUTTON_6,a),k.create_gamepad_btn_sensor(r.GMPD_BUTTON_7,a),k.create_gamepad_btn_sensor(r.GMPD_BUTTON_8,a),k.create_gamepad_btn_sensor(r.GMPD_BUTTON_9,
a),k.create_gamepad_btn_sensor(r.GMPD_BUTTON_10,a),k.create_gamepad_btn_sensor(r.GMPD_BUTTON_11,a),k.create_gamepad_btn_sensor(r.GMPD_BUTTON_12,a),k.create_gamepad_btn_sensor(r.GMPD_BUTTON_13,a),k.create_gamepad_btn_sensor(r.GMPD_BUTTON_14,a),k.create_gamepad_btn_sensor(r.GMPD_BUTTON_15,a),k.create_gamepad_btn_sensor(r.GMPD_BUTTON_16,a),k.create_gamepad_btn_sensor(r.GMPD_BUTTON_17,a),k.create_gamepad_btn_sensor(r.GMPD_BUTTON_18,a),k.create_gamepad_btn_sensor(r.GMPD_BUTTON_19,a),k.create_gamepad_btn_sensor(r.GMPD_BUTTON_20,
a),k.create_gamepad_btn_sensor(r.GMPD_BUTTON_21,a),k.create_gamepad_btn_sensor(r.GMPD_BUTTON_22,a),k.create_gamepad_btn_sensor(r.GMPD_BUTTON_23,a),k.create_gamepad_btn_sensor(r.GMPD_BUTTON_24,a),k.create_gamepad_btn_sensor(r.GMPD_BUTTON_25,a)]}function f(a){return[k.create_gamepad_axis_sensor(r.GMPD_AXIS_0,a),k.create_gamepad_axis_sensor(r.GMPD_AXIS_1,a),k.create_gamepad_axis_sensor(r.GMPD_AXIS_2,a),k.create_gamepad_axis_sensor(r.GMPD_AXIS_3,a),k.create_gamepad_axis_sensor(r.GMPD_AXIS_4,a),k.create_gamepad_axis_sensor(r.GMPD_AXIS_5,
a),k.create_gamepad_axis_sensor(r.GMPD_AXIS_6,a),k.create_gamepad_axis_sensor(r.GMPD_AXIS_7,a),k.create_gamepad_axis_sensor(r.GMPD_AXIS_8,a),k.create_gamepad_axis_sensor(r.GMPD_AXIS_9,a),k.create_gamepad_axis_sensor(r.GMPD_AXIS_10,a),k.create_gamepad_axis_sensor(r.GMPD_AXIS_11,a)]}function t(a,b){var c=document.createElement("input");c.style.cssText="display: inline-block;position = relative;";c.setAttribute("type","radio");c.setAttribute("name","choice");var d=document.createElement("label");d.textContent=
b;d.style.cssText="position = relative;display: inline-block;color: white;";a.appendChild(c);a.appendChild(d);return c}function g(a){w.removeChild(h);h=null;switch(a){case "PAD":p.checked=!0;b(w);break;case "WHEEL":P.checked=!0;var c=w;G=!1;var d=document.createElement("div"),e=document.createElement("div"),f=document.createElement("div"),g=document.createElement("div"),k=document.createElement("div"),l=document.createElement("div"),n=document.createElement("div"),q=document.createElement("div"),
u=document.createElement("div"),t=document.createElement("div"),v=document.createElement("div"),z=document.createElement("div"),y=document.createElement("div"),x=document.createElement("div"),A=document.createElement("div"),C=document.createElement("div"),F=document.createElement("div"),H=document.createElement("div"),J=document.createElement("div"),ka=document.createElement("div"),Aa=document.createElement("div"),V=document.createElement("div"),ua=document.createElement("div"),ia=document.createElement("div");
a=document.createElement("div");var Y=document.createElement("div"),aa=document.createElement("div"),T=document.createElement("div"),xa=document.createElement("div"),la=document.createElement("div");h=d;var ma="position: absolute;height: auto;background-image: url('data:image/svg+xml;base64,"+btoa('<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>')+
"');width: 19px;height: 19px;background-size: 100% 100%;";d.style.cssText="position: absolute;background-image: url('data:image/svg+xml;base64,"+btoa('<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="112.08413mm" height="128.46834mm" viewBox="0 0 397.14849 455.20277" id="svg3440" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel.svg"><defs id="defs3442" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="0.98994949" inkscape:cx="421.01508" inkscape:cy="52.510802" inkscape:document-units="px" inkscape:current-layer="g87" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3445"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title /></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(-2.3645008e-8,-597.15942)"><path inkscape:connector-curvature="0" style="fill:#4d4d4d;stroke:#6e6e6e;stroke-width:2.99125171;stroke-miterlimit:4;stroke-dasharray:none" id="path4140" d="m 307.84153,715.52552 c -4.35995,43.11849 -2.78952,86.66385 -15.90234,128.54337 -10.85452,25.86023 -13.33477,47.2976 6.91492,61.09536 7.23778,50.7442 78.38013,47.39232 82.20535,0 23.06079,-14.19054 13.49405,-42.79138 6.91492,-61.09536 -17.40045,-40.83001 -4.82581,-86.43019 -15.90235,-128.54337 -8.3177,-20.33228 -56.75348,-20.7661 -64.22927,0 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#cccccc;stroke:#1a1a1a;stroke-width:2.09465766;stroke-miterlimit:4;stroke-dasharray:none" id="path4266" d="m 313.11812,724.1957 -3.84514,68.80568 c 4.64168,13.40814 62.19981,10.8172 61.83082,0 l -3.84515,-68.80568 c -4.46942,-24.00369 -52.58756,-18.95946 -54.13979,0 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#353535;stroke:#2c2c2c;stroke-width:2.11880326;stroke-miterlimit:4;stroke-dasharray:none" id="path4156" d="m 304.91419,870.673 c -12.36924,67.40381 80.42804,69.69607 70.55134,0 -6.57605,-36.5947 -65.0964,-34.8253 -70.55134,0 z m 60.53812,3.9862 c 8.65841,48.24354 -57.58987,49.86644 -50.52489,0 4.7009,-26.27069 46.6394,-24.84292 50.52489,0 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#e6e6e6;stroke:#969696;stroke-width:2.99125171;stroke-miterlimit:4;stroke-dasharray:none" id="path4011" d="m 106.04576,696.97906 c -11.197076,4.25792 -17.123706,8.24834 -17.123706,8.24834 l -66.18493,16.33946 1.40291,30.64619 46.54715,-7.67623 c 17.00932,-1.6438 32.551896,8.94676 38.302026,23.34506 l 2.78663,65.4778 27.6363,0 2.78663,-65.4778 c 8.0428,-15.3291 20.46247,-27.10803 38.30202,-23.34506 l 46.54716,7.67623 1.40291,-30.64619 -66.18493,-16.33946 c 0,0 -5.92627,-3.99074 -17.12371,-8.24834 -13.45408,-4.31874 -26.62772,-4.20804 -39.08982,0 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#252525;stroke:#6e6e6e;stroke-width:2.99125171;stroke-miterlimit:4;stroke-dasharray:none" id="path2996" d="m 38.311064,931.09899 c -8.01574,5.05649 -22.76006,21.74743 -26.34852,58.0567 -4.1290804,35.18581 -4.8394604,60.59901 28.55878,61.68771 l 162.934726,0 c 39.19437,1.1693 30.46155,-41.5992 28.55878,-61.68771 -3.58839,-36.30927 -18.33277,-52.99983 -26.34851,-58.0567 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#373737;stroke:#6e6e6e;stroke-width:2.83429575;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none" id="path3019" d="m 26.230254,979.1291 c -11.50334,14.44882 -11.98241,47.3999 -0.33519,57.1202 l 191.802226,0 c 12.10111,-12.3068 9.93082,-46.99573 -0.33518,-57.1202 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#808080;stroke:#1a1a1a;stroke-width:2.14882827;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0" id="path4133" d="m 360.82498,854.6914 a 20.634815,21.265151 0 1 1 -41.269,0 20.634815,21.265151 0 1 1 41.269,0 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#333333;stroke:#000000;stroke-width:2.11880326;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0" id="path4280" d="m 351.64051,761.132 a 11.444622,11.75148 0 1 1 -22.88896,0 11.444622,11.75148 0 1 1 22.88896,0 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#313131;stroke:#565656;stroke-width:2.93434715;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0" id="path3993" d="m 125.52855,598.62659 c -68.528026,0 -124.0613764,57.81925 -124.0613764,129.13695 0,71.31265 55.5370404,129.13696 124.0613764,129.13696 68.52804,0 124.07984,-57.81926 124.07984,-129.13696 0,-71.31264 -55.55611,-129.13695 -124.07984,-129.13695 z m -1.00095,23.63932 c 10.01261,0.0734 20.238,1.32074 28.95237,3.51006 11.62203,3.80301 21.53624,8.52304 31.01135,16.15381 26.21752,19.0207 43.36275,50.36277 43.36275,85.83029 0,58.01564 -45.80548,105.05244 -102.30928,105.05244 -56.500726,0 -102.309276,-47.03364 -102.309276,-105.05244 0,-32.14848 14.06783,-60.91918 36.22336,-80.19121 11.45168,-11.11714 23.14136,-17.13322 37.3943,-21.79731 7.855846,-2.48302 17.655666,-3.5835 27.668276,-3.51006 z" stroke-miterlimit="4" /><g style="stroke-miterlimit:4;stroke-dasharray:none" id="g4127" stroke-miterlimit="4" transform="matrix(0.61498728,0,0,0.63147657,-18.171616,453.28593)"><g id="g4111"><path style="fill:#808080;stroke:#373737;stroke-width:3.56837296" inkscape:connector-curvature="0" id="rect3040" d="m 110.97,771.16 31.694,4.8776 1.3007,44.257 -32.995,0 z" /><path style="fill:#b3b3b3;stroke:#565656;stroke-width:3.4000001;stroke-linecap:butt;stroke-linejoin:miter" inkscape:connector-curvature="0" id="path3024" d="m 96.83,686.82 58.353,-5.0761 c 15.608,27.569 6.8304,64.333 -5.0761,90.545 l -53.841,-2.538 z" /></g><g id="g4115" transform="translate(97.984785,0)"><path style="fill:#808080;stroke:#373737;stroke-width:3.56837296" inkscape:connector-curvature="0" id="path4117" d="m 110.97,771.16 31.694,4.8776 1.3007,44.257 -32.995,0 z" /><path style="fill:#b3b3b3;stroke:#565656;stroke-width:3.4000001;stroke-linecap:butt;stroke-linejoin:miter" inkscape:connector-curvature="0" id="path4119" d="m 96.83,686.82 58.353,-5.0761 c 15.608,27.569 6.8304,64.333 -5.0761,90.545 l -53.841,-2.538 z" /></g><g id="g4121" transform="translate(195.96959,0)"><path style="fill:#808080;stroke:#373737;stroke-width:3.56837296" inkscape:connector-curvature="0" id="path4123" d="m 110.97,771.16 31.694,4.8776 1.3007,44.257 -32.995,0 z" /><path style="fill:#b3b3b3;stroke:#565656;stroke-width:3.4000001;stroke-linecap:butt;stroke-linejoin:miter" inkscape:connector-curvature="0" id="path4125" d="m 96.83,686.82 58.353,-5.0761 c 15.608,27.569 6.8304,64.333 -5.0761,90.545 l -53.841,-2.538 z" /></g></g><g style="fill:#666666;stroke:#969696;stroke-width:3.99777174;stroke-miterlimit:4;stroke-dasharray:none" id="g4051" transform="translate(-42.878584,98.083591)" stroke-miterlimit="4"><g id="g4437" transform="matrix(0.74686368,0,0,0.74686368,-73.374214,285.30447)"><path inkscape:connector-curvature="0" id="rect4348" style="color:#000000;text-indent:0;text-transform:none;block-progression:tb;fill:#ffffff" d="m 567.31,584.22 0,42.25 0,3.4062 0,42.25 3.375,0 0,-42.25 27.062,0 0,42.25 3.375,0 0,-42.25 27.062,0 0,42.25 3.375,0 0,-42.25 27.062,0 0,42.25 3.4062,0 0,-43.969 0,-1.6875 -1.7188,0 -28.75,0 0,-42.25 -3.375,0 0,42.25 -27.062,0 0,-42.25 -3.375,0 0,42.25 -27.062,0 0,-42.25 -3.375,0 z" /><g style="fill:#a02c2c;stroke:#ffffff;stroke-width:3.4000001;stroke-linecap:square" id="g87" /></g></g></g></svg>')+
"');width: 397px;height: 455px;-moz-transform: translateX(-50%);-ms-transform: translateX(-50%);-webkit-transform: translateX(-50%);transform: translateX(-50%);background-size: 100% 100%;left: 50%;margin-left: 25px;margin-bottom: 40px;bottom: 0px;";e.style.cssText=ma+"top: 132px;left: 331px;";f.style.cssText=ma+"top: 122px;left: 315px;";g.style.cssText=ma+"top: 122px;left: 347px;";k.style.cssText=ma+"top: 113px;left: 331px;";l.style.cssText="position: absolute;height: auto;background-image: url('data:image/svg+xml;base64,"+
btoa('<svg id="svg3400" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.507mm" width="15.1mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 53.504016 37.228838"><metadata id="metadata3405"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(-2.847e-7 -1015.1)"><path id="path4049" d="m26.584 1016.1c-12.631 0-23.15 9.858-25.478 22.922l50.705 12.18c0.47921-2.1565 0.73023-4.4099 0.73023-6.7204 0-15.677-11.621-28.382-25.957-28.382z" stroke="#5276cf" stroke-linecap="square" stroke-width="1.9247" fill="#666"/></g></svg>')+
"');width: 54px;height: 37px;background-size: 100% 100%;top: 84px;left: 166px;";n.style.cssText="position: absolute;height: auto;background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3400" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.507mm" width="15.1mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 53.504016 37.228838"><metadata id="metadata3405"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(-2.847e-7 -1015.1)"><path id="path4033" d="m26.92 1016.1c-14.337 0-25.957 12.707-25.957 28.382 0 2.3225 0.26742 4.5784 0.74876 6.7386l50.681-12.18c-2.321-13.072-12.841-22.944-25.476-22.944z" stroke="#5276cf" stroke-linecap="square" stroke-width="1.9247" fill="#666"/></g></svg>')+
"');width: 54px;height: 37px;background-size: 100% 100%;top: 84px;left: 36px;";q.style.cssText=ma+"top: 107px;left: 141px;";u.style.cssText=ma+"top: 107px;left: 90px;";t.style.cssText=ma+"top: 185px;left: 321px;";v.style.cssText=ma+"top: 185px;left: 340px;";z.style.cssText=ma+"top: 179px;left: 358px;";y.style.cssText=ma+"top: 178px;left: 303px;";x.style.cssText=ma+"top: 210px;left: 299px;";A.style.cssText=ma+"top: 279px;left: 299px;";C.style.cssText=ma+"top: 210px;left: 321px;";F.style.cssText=ma+
"top: 279px;left: 321px;";H.style.cssText=ma+"top: 210px;left: 344px;";J.style.cssText=ma+"top: 278px;left: 344px;";ka.style.cssText=ma+"top: 124px;left: 147px;";Aa.style.cssText=ma+"top: 138px;left: 133px;";V.style.cssText=ma+"top: 124px;left: 82px;";ua.style.cssText=ma+"top: 138px;left: 96px;";ia.style.cssText=ma+"top: 278px;left: 367px;";ma="position: absolute;background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3386" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="12.859mm" width="5.2917mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 18.749999 45.562501"><metadata id="metadata3391"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1006.8)"><path id="rect4575" d="m9.3125 1006.8-9.3125 14.25h5.3125v17.094h-5.1875l9.3125 14.219 9.3125-14.219h-5.1562v-17.094h5.0312l-9.3125-14.25z" fill="#e6e6e6"/></g></svg>')+
"');width: 19px;height: 46px;background-size: 100% 100%;";a.style.cssText=ma+"top: 291px;left: 50px;";Y.style.cssText=ma+"top: 291px;left: 111px;";aa.style.cssText=ma+"top: 291px;left: 171px;";T.style.cssText="position: absolute;background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3458" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="50.447mm" width="83.899mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 297.28131 178.75"><metadata id="metadata3463"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -873.61)" fill="#e6e6e6"><path id="path4535" style="color:#000000;text-indent:0;block-progression:tb;text-decoration-line:none;text-transform:none" d="m33.875 873.61-18.5 8.8125 5.0626 3.0625c-12.899 22.78-20.438 49.17-20.438 77.44 0 28.284 7.5315 54.691 20.438 77.469l-5.0626 3.0625 18.5 8.8125 0.6563-20.469-5.531 3.3c-12.002-21.2-18.937-45.8-18.937-72.18 0-26.362 6.9415-50.99 18.937-72.188l5.5313 3.3438-0.6563-20.469z"/><path id="path4551" style="color:#000000;text-indent:0;block-progression:tb;text-decoration-line:none;text-transform:none" d="m263.38 873.71-0.6562 20.469 5.5312-3.3438c11.996 21.198 18.969 45.825 18.969 72.188 0 26.371-6.9672 51.011-18.969 72.219l-5.5312-3.3437 0.6562 20.469 18.5-8.8125-5.0312-3.0625c12.906-22.778 20.438-49.184 20.438-77.469 0-28.275-7.5391-54.665-20.438-77.438l5.0312-3.0625-18.5-8.8125z"/></g></svg>')+
"');width: 297px;height: 179px;background-size: 100% 100%;top: 43px;left: -25px;";xa.style.cssText="position: absolute;background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3378" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="2.9016mm" width="9.2516mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 32.781198 10.281199"><metadata id="metadata3383"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1042.1)"><path id="rect4585" d="m32.781 1047.2-7.875-5.125v2.8437h-17.031v-2.8437l-7.875 5.1 7.875 5.1562v-2.8437h17.031v2.8437z" fill="#e6e6e6"/></g></svg>')+
"');width: 33px;height: 10px;background-size: 100% 100%;top: 159px;left: 324px;";la.style.cssText="position: absolute;background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3378" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.2516mm" width="2.9016mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 10.281248 32.7812"><metadata id="metadata3383"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1019.6)"><path id="rect4585" d="m5.125 1019.6-5.125 7.9h2.8437v17.031h-2.8437l5.125 7.875 5.1562-7.875h-2.8438v-17.031h2.8438z" fill="#e6e6e6"/></g></svg>')+
"');width: 10px;height: 33px;background-size: 100% 100%;top: 148px;left: 335px;";c.appendChild(d);d.appendChild(a);d.appendChild(Y);d.appendChild(aa);d.appendChild(T);d.appendChild(xa);d.appendChild(la);d.appendChild(e);d.appendChild(f);d.appendChild(g);d.appendChild(k);d.appendChild(l);d.appendChild(n);d.appendChild(q);d.appendChild(u);d.appendChild(t);d.appendChild(v);d.appendChild(z);d.appendChild(y);d.appendChild(x);d.appendChild(A);d.appendChild(C);d.appendChild(F);d.appendChild(H);d.appendChild(J);
d.appendChild(ka);d.appendChild(Aa);d.appendChild(V);d.appendChild(ua);d.appendChild(ia);M.length=0;D.length=0;E.length=0;W.length=0;M.push(e,f,g,k,l,n,q,u,t,v,z,y,x,A,C,F,H,J,ka,Aa,V,ua,ia);D.push('<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg id="svg3400" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.507mm" width="15.1mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 53.504016 37.228838"><metadata id="metadata3405"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(-2.847e-7 -1015.1)"><path id="path4049" d="m26.584 1016.1c-12.631 0-23.15 9.858-25.478 22.922l50.705 12.18c0.47921-2.1565 0.73023-4.4099 0.73023-6.7204 0-15.677-11.621-28.382-25.957-28.382z" stroke="#5276cf" stroke-linecap="square" stroke-width="1.9247" fill="#666"/></g></svg>',
'<svg id="svg3400" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.507mm" width="15.1mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 53.504016 37.228838"><metadata id="metadata3405"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(-2.847e-7 -1015.1)"><path id="path4033" d="m26.92 1016.1c-14.337 0-25.957 12.707-25.957 28.382 0 2.3225 0.26742 4.5784 0.74876 6.7386l50.681-12.18c-2.321-13.072-12.841-22.944-25.476-22.944z" stroke="#5276cf" stroke-linecap="square" stroke-width="1.9247" fill="#666"/></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>');
W.push(T,a,aa,Y,xa,la);for(c=0;c<M.length;c++)M[c].setAttribute("id","wheel_btn_"+c),M[c].setAttribute("data-colorstate","B"),M[c].setAttribute("data-key",c),M[c].setAttribute("data-svgid",c);for(c=0;c<W.length;c++)M[c].setAttribute("id","wheel_axis_"+c),M[c].setAttribute("data-colorstate","GR");T.setAttribute("data-key",r.GMPD_AXIS_0);T.setAttribute("data-svgid",D.length);a.setAttribute("data-key",r.GMPD_AXIS_1);a.setAttribute("data-svgid",D.length+1);aa.setAttribute("data-key",r.GMPD_AXIS_2);aa.setAttribute("data-svgid",
D.length+2);Y.setAttribute("data-key",r.GMPD_AXIS_3);Y.setAttribute("data-svgid",D.length+3);xa.setAttribute("data-key",r.GMPD_AXIS_4);xa.setAttribute("data-svgid",D.length+4);la.setAttribute("data-key",r.GMPD_AXIS_5);la.setAttribute("data-svgid",D.length+5);D.push('<svg id="svg3458" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="50.447mm" width="83.899mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 297.28131 178.75"><metadata id="metadata3463"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -873.61)" fill="#e6e6e6"><path id="path4535" style="color:#000000;text-indent:0;block-progression:tb;text-decoration-line:none;text-transform:none" d="m33.875 873.61-18.5 8.8125 5.0626 3.0625c-12.899 22.78-20.438 49.17-20.438 77.44 0 28.284 7.5315 54.691 20.438 77.469l-5.0626 3.0625 18.5 8.8125 0.6563-20.469-5.531 3.3c-12.002-21.2-18.937-45.8-18.937-72.18 0-26.362 6.9415-50.99 18.937-72.188l5.5313 3.3438-0.6563-20.469z"/><path id="path4551" style="color:#000000;text-indent:0;block-progression:tb;text-decoration-line:none;text-transform:none" d="m263.38 873.71-0.6562 20.469 5.5312-3.3438c11.996 21.198 18.969 45.825 18.969 72.188 0 26.371-6.9672 51.011-18.969 72.219l-5.5312-3.3437 0.6562 20.469 18.5-8.8125-5.0312-3.0625c12.906-22.778 20.438-49.184 20.438-77.469 0-28.275-7.5391-54.665-20.438-77.438l5.0312-3.0625-18.5-8.8125z"/></g></svg>',
'<svg id="svg3386" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="12.859mm" width="5.2917mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 18.749999 45.562501"><metadata id="metadata3391"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1006.8)"><path id="rect4575" d="m9.3125 1006.8-9.3125 14.25h5.3125v17.094h-5.1875l9.3125 14.219 9.3125-14.219h-5.1562v-17.094h5.0312l-9.3125-14.25z" fill="#e6e6e6"/></g></svg>',
'<svg id="svg3386" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="12.859mm" width="5.2917mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 18.749999 45.562501"><metadata id="metadata3391"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1006.8)"><path id="rect4575" d="m9.3125 1006.8-9.3125 14.25h5.3125v17.094h-5.1875l9.3125 14.219 9.3125-14.219h-5.1562v-17.094h5.0312l-9.3125-14.25z" fill="#e6e6e6"/></g></svg>',
'<svg id="svg3386" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="12.859mm" width="5.2917mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 18.749999 45.562501"><metadata id="metadata3391"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1006.8)"><path id="rect4575" d="m9.3125 1006.8-9.3125 14.25h5.3125v17.094h-5.1875l9.3125 14.219 9.3125-14.219h-5.1562v-17.094h5.0312l-9.3125-14.25z" fill="#e6e6e6"/></g></svg>',
'<svg id="svg3378" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="2.9016mm" width="9.2516mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 32.781198 10.281199"><metadata id="metadata3383"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1042.1)"><path id="rect4585" d="m32.781 1047.2-7.875-5.125v2.8437h-17.031v-2.8437l-7.875 5.1 7.875 5.1562v-2.8437h17.031v2.8437z" fill="#e6e6e6"/></g></svg>',
'<svg id="svg3378" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.2516mm" width="2.9016mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 10.281248 32.7812"><metadata id="metadata3383"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1019.6)"><path id="rect4585" d="m5.125 1019.6-5.125 7.9h2.8437v17.031h-2.8437l5.125 7.875 5.1562-7.875h-2.8438v-17.031h2.8438z" fill="#e6e6e6"/></g></svg>');
m(M,B);m(W,"#e6e6e6")}}function m(a,b){function c(a){a=a.target;if(!(0>y||"G"==a.dataset.Nj))if(0!=H){if("R"==a.dataset.Nj&&(A=null,document.getElementById("action_label").textContent="Click on the buttons & arrows to setup your controller",H=0),"B"==a.dataset.Nj||"GR"==a.dataset.Nj){var d=parseFloat(A.dataset.Es);A.style.backgroundImage="url('data:image/svg+xml;base64,"+btoa(D[d])+"')";A.setAttribute("data-colorstate",a.dataset.Nj);A=a;d=parseFloat(a.dataset.Es);a.style.backgroundImage="url('data:image/svg+xml;base64,"+
btoa(D[d].replace(b,"#ff0000"))+"')";a.setAttribute("data-colorstate","R")}}else{var d=parseFloat(a.dataset.Es),e="B"==a.dataset.Nj?1:2;H=e;a.style.backgroundImage="url('data:image/svg+xml;base64,"+btoa(D[d].replace(b,"#ff0000"))+"')";a.setAttribute("data-colorstate","R");document.getElementById("action_label").textContent=1==e?"Now press the button on the device":"Now move the axis on the device";A=a}}for(var d=0;d<a.length;d++)a[d].addEventListener("click",c,!1)}function v(a){var b=document.createElement("label");
b.style.cssText="position: relative;display: inline-block;width: 50px;color: white;margin: 0 10px;font-size: 36px;line-height: 50px;background-color: black;border: 3px solid white;border-radius: 5px;height: 50px;";b.textContent=a;return b}function x(){var a=window.innerWidth,b=window.innerHeight;w.style.zoom=750>=b&&400<b||750>=a&&400<a?"0.5":400>=a||400>=b?"0.3":"1"}q("config");var d=q("container"),k=q("controls"),r=q("input"),C=q("storage"),B=/#5276cf/g,F={};F[r.GMPD_BUTTON_12]=r.GMPD_BUTTON_12;
F[r.GMPD_BUTTON_13]=r.GMPD_BUTTON_13;F[r.GMPD_BUTTON_15]=r.GMPD_BUTTON_15;F[r.GMPD_BUTTON_14]=r.GMPD_BUTTON_14;F[r.GMPD_BUTTON_3]=r.GMPD_BUTTON_3;F[r.GMPD_BUTTON_0]=r.GMPD_BUTTON_0;F[r.GMPD_BUTTON_1]=r.GMPD_BUTTON_1;F[r.GMPD_BUTTON_2]=r.GMPD_BUTTON_2;F[r.GMPD_BUTTON_5]=r.GMPD_BUTTON_5;F[r.GMPD_BUTTON_7]=r.GMPD_BUTTON_7;F[r.GMPD_BUTTON_4]=r.GMPD_BUTTON_4;F[r.GMPD_BUTTON_6]=r.GMPD_BUTTON_6;F[r.GMPD_BUTTON_8]=r.GMPD_BUTTON_8;F[r.GMPD_BUTTON_9]=r.GMPD_BUTTON_9;F[r.GMPD_BUTTON_10]=r.GMPD_BUTTON_10;F[r.GMPD_BUTTON_11]=
r.GMPD_BUTTON_11;F[r.GMPD_BUTTON_16]=r.GMPD_BUTTON_16;var D=[],y=-1,A=null,H=0,w=null,h=null,u=null,P=null,p=null,z=null,l=[],M=[],E=[],W=[],G=!0,J={};J[r.GMPD_AXIS_0]=-2;J[r.GMPD_AXIS_1]=-2;J[r.GMPD_AXIS_2]=-2;J[r.GMPD_AXIS_3]=-2;J[r.GMPD_AXIS_4]=-2;J[r.GMPD_AXIS_5]=-2;J[r.GMPD_AXIS_6]=-2;J[r.GMPD_AXIS_7]=-2;J[r.GMPD_AXIS_8]=-2;J[r.GMPD_AXIS_9]=-2;J[r.GMPD_AXIS_10]=-2;J[r.GMPD_AXIS_11]=-2;J[r.NP]=-2;a.show=function(){var a=document.createElement("div");w=a;a.style.cssText="position: absolute;width: 720px;height: 750px;top: 50%;left: 50%;-moz-transform: translateY(-50%) translateX(-50%);-ms-transform: translateY(-50%) translateX(-50%);-webkit-transform: translateY(-50%) translateX(-50%);transform: translateY(-50%) translateX(-50%);background-color: black;border: 4px solid white;border-radius: 35px;box-shadow: 0px 0px 20px 0px rgba(50, 50, 50, 1);";
d.insert_to_container(a,"LAST");b(a);var h=document.createElement("div");h.style.cssText="position: absolute;width: 637px;top: 0px;font-family: sans-serif;text-align: center;margin-top: 40px;-moz-transform: translateX(-50%);-ms-transform: translateX(-50%);-webkit-transform: translateX(-50%);transform: translateX(-50%);left: 50%;";var l=document.createElement("div");l.innerHTML="Select a device";l.style.cssText="color: #fff;display: inline-block;";h.appendChild(l);for(l=0;4>l;l++){var m=n(l),q=function(){return!0},
F=function(a,b){if(b==y)for(var c=0;c<M.length;c++){var d=M[c],e=k.get_sensor_value(a,b,c),f=c;if(0==H){if(e&&"B"==d.dataset.Nj){var g=D[f];d.style.backgroundImage="url('data:image/svg+xml;base64,"+btoa(g.replace(B,"#00ff00"))+"')";d.setAttribute("data-colorstate","G")}e||"B"==d.dataset.Nj||(g=D[f],d.style.backgroundImage="url('data:image/svg+xml;base64,"+btoa(g)+"')",d.setAttribute("data-colorstate","B"))}else e=r.get_pressed_gmpd_btn(y),0<=e&&A&&1==H&&(d=A.dataset.key,r.set_gamepad_key(y,d,e),f=
C.get(y+"_gmpd_stngs","b4w")||"{}",f=JSON.parse(f),f[d]=e,C.set(y+"_gmpd_stngs",JSON.stringify(f),"b4w"),A=null,document.getElementById("action_label").textContent="Click on the buttons & arrows to setup your controller",H=0)}};k.create_sensor_manifold(null,l,k.CT_CONTINUOUS,m,q,F)}0<e().length&&(y=0);var ca=[],l=document.createElement("div");l.style.cssText="margin-top: 20px;";for(m=0;4>m;m++)F=v(m),m==y&&(F.style.backgroundColor="green",u=F),c(m),l.appendChild(F),F.setAttribute("data-device_type",
"PAD"),ca.push(F),F.addEventListener("click",function(a){var b=e();a=a.target;for(var d=0;d<b.length;d++)ca[d]==a&&(y=d,u=a,c(y),g(a.dataset.BQ))},!1);h.appendChild(l);z=document.createElement("label");z.style.cssText="position: relative;display: block;color: white;";h.appendChild(z);l=document.createElement("div");l.style.cssText="margin-top: 20px;";m=t(l,"Pad");F=t(l,"Wheel");m.setAttribute("checked","true");m.onchange=function(){g("PAD");u&&u.setAttribute("data-device_type","PAD")};F.onchange=
function(){g("WHEEL");u&&u.setAttribute("data-device_type","WHEEL")};m.setAttribute("id","test");p=m;P=F;m=document.createElement("label");m.style.cssText+="color: #fff;display: block;";l.appendChild(m);m.textContent="Click on the buttons & arrows to setup your controller";m.setAttribute("id","action_label");h.appendChild(l);a.appendChild(h);a=k.create_elapsed_sensor();k.create_sensor_manifold(null,"UPDATE_GAMEPAD_DATA",k.CT_CONTINUOUS,[a],q,function(){var a=e(),b=a.length;-1==y&&a.length&&(y=a[0].index,
u=ca[y]);for(var c=0;c<ca.length;c++)c<b?(ca[c].textContent=a[c].index,ca[c]==u?(ca[c].style.backgroundColor="green",z.textContent="Selected device: "+a[c].index+". Data: "+a[c].id):ca[c].style.backgroundColor="blue"):ca[c].style.backgroundColor="black";b||(y=-1,z.textContent="")});for(l=0;4>l;l++)m=f(l),q=function(){return!0},F=function(a,b){if(b=="AXES"+y){for(var c=0;c<E.length;c+=2){var d=E[c],e=a,f=b,g=c,h=20*k.get_sensor_value(e,f,g),e=20*k.get_sensor_value(e,f,g+1);d.style.transform="translate3d("+
h+"px, "+e+"px, 0px) rotate(0rad)"}if(G)for(c=0;12>c;c+=2){if(e=a,f=b,d=c,!(d+1>2*W.length)){h=k.get_sensor_value(e,f,d);e=k.get_sensor_value(e,f,d+1);if(-2<J[d]){var l=h-J[d],m=e-J[d+1],f=W[Math.floor(d/2)],g=f.dataset.Es;0==H?f.style.backgroundImage=l||m?"url('data:image/svg+xml;base64,"+btoa(D[g].replace("#e6e6e6","#00ff00"))+"')":"url('data:image/svg+xml;base64,"+btoa(D[g])+"')":2==H&&(l=r.get_moved_gmpd_axis(y),0<=l&&(0!=l%2&&l--,H=0,f.style.backgroundImage="url('data:image/svg+xml;base64,"+
btoa(D[g])+"')",f=parseFloat(A.dataset.key),r.set_gamepad_key(y,f,l),r.set_gamepad_key(y,f+1,l+1),A=null,document.getElementById("action_label").textContent="Click on the buttons & arrows to setup your controller"))}J[d]=h;J[d+1]=e}}else for(c=0;12>c;c++)d=c,d>=W.length||(h=k.get_sensor_value(a,b,d),-2<J[d]&&(g=h-J[d],e=W[d],f=e.dataset.Es,0==H?e.style.backgroundImage=g?"url('data:image/svg+xml;base64,"+btoa(D[f].replace("#e6e6e6","#00ff00"))+"')":"url('data:image/svg+xml;base64,"+btoa(D[f])+"')":
2==H&&(g=r.get_moved_gmpd_axis(y),0<=g&&(H=0,e.style.backgroundImage="url('data:image/svg+xml;base64,"+btoa(D[f])+"')",r.set_gamepad_key(y,parseFloat(A.dataset.key),g),A=null,document.getElementById("action_label").textContent="Click on the buttons & arrows to setup your controller"))),J[d]=h)}},k.create_sensor_manifold(null,"AXES"+l,k.CT_CONTINUOUS,m,q,F);x();window.addEventListener("resize",x)};a.hide=function(){H=0;y=-1;p=P=A=u=null;E.length=0;M.length=0;W.length=0;d.get_container().removeChild(w);
w=null;k.remove_sensor_manifold(null,"UPDATE_GAMEPAD_DATA");for(var a=0;4>a;a++)k.remove_sensor_manifold(null,a),k.remove_sensor_manifold(null,"AXES"+a);window.removeEventListener("resize",x)};a.update=function(){for(var a=0;4>a;a++)c(a)}};b4w.module.gyroscope=function(a,q){function e(a){var e=b.create_gyro_angles_sensor(),n=b.create_gyro_quat_sensor(),q=!0;b.create_sensor_manifold(a,"CAMERA_ROTATE_GYRO",b.CT_CONTINUOUS,[e,n],null,function(a,e,n){if(0<n)if(c.is_eye_camera(a))e=b.get_sensor_payload(a,e,1),n=g.transformQuat(t.AXIS_MY,e,x),c.set_vertical_axis(a,n),f.set_rotation_v(a,e);else{v=b.get_sensor_payload(a,e,0);q&&(m[0]=v[0],m[1]=v[1],m[2]=v[2],q=!1);n=e=0;0==window.orientation&&(e=v[1]-m[1],n=v[0]-m[0],v[1]>k&&v[1]<d&&(n=0));
if(180==window.orientation){e=v[1]-m[1];0>v[1]&&(e=-e);n=m[0]-v[0];if(e>Math.PI/2||e<-Math.PI/2)e=0;v[1]>-d&&v[1]<-k&&(n=0)}if(-90==window.orientation){e=v[0]-m[0];if(e>Math.PI/2||e<-Math.PI/2)e=0;n=m[1]-v[1];if(v[0]>r||v[0]<C)n=0}if(90==window.orientation){e=m[0]-v[0];if(e>Math.PI/2||e<-Math.PI/2)e=0;n=v[1]-m[1];if(v[0]>r||v[0]<C)n=0}c.rotate_camera(a,n,e);m[0]=v[0];m[1]=v[1];m[2]=v[2]}})}var c=q("camera"),b=q("controls"),n=q("scenes"),f=q("transform"),t=q("util"),g=q("vec3"),m=new Float32Array(3),
v=new Float32Array(3),x=g.create(),d=t.deg_to_rad(110),k=t.deg_to_rad(70),r=t.deg_to_rad(70),C=-t.deg_to_rad(70);a.enable_camera_rotation=function(){var a=n.get_active_camera();e(a)};a.disable_camera_rotation=function(){var a=n.get_active_camera();b.remove_sensor_manifold(a,"CAMERA_ROTATE_GYRO")}};b4w.module.hmd_conf=function(a,q){function e(a){a=a.target.value;var b=h[a],c;for(c in H)if(c in b){var d=document.getElementById(c+"_slider");d&&(d.disabled="custom"!==a,d.value=b[c]);if(d=document.getElementById(c+"_number"))d.disabled="custom"!==a,d.value=b[c]}}function c(){x.remove_sensor_manifold(null,"UPDATE_HMD_RENDERING");n();t();B&&(B=!1,v.get_container().removeChild(F),document.head.removeChild(D),D=y=F=null)}function b(){n(!0);t();for(var a in H){var b=document.getElementById(a+"_slider");
b&&(b.value=H[a]);if(b=document.getElementById(a+"_number"))b.value=H[a]}}function n(a){var b=navigator.userAgent||navigator.vendor||window.opera,c=Math.max(window.screen.width,window.screen.height)*window.devicePixelRatio,d=Math.min(window.screen.width,window.screen.height)*window.devicePixelRatio,e=0,f=0,g=0;a:{var h=P;if(1==h.format&&h.devices&&h.devices.length)for(var m=0;m<h.devices.length;m++){var n=h.devices[m];if(n.rules&&("ios"==n.type&&w||"android"==n.type)){for(var q=!1,u=0;u<n.rules.length;u++){var t=
n.rules[u],v=c,y=d;if(t.ua&&0<=b.indexOf(t.ua)||!t.ua&&t.res&&t.res[0]&&t.res[1]&&Math.min(v,y)==Math.min(t.res[0],t.res[1])&&Math.max(v,y)==Math.max(t.res[0],t.res[1])){q=!0;break}}if(q){b=m;break a}}}else k.error("DPDB isn't correct.");b=-1}-1!=b&&(g=P.devices[b],f=g.dpi[1]||g.dpi,e=Math.round(25.4*c/(g.dpi[0]||g.dpi)),f=Math.round(25.4*d/f),g=Math.round(g.bw));c=r.get("hmd_conf","b4w");c=JSON.parse(c?c:"{}");a?(H.first_distortion=.34,H.second_distortion=.55,H.bevel_size=g||4,H.screen_width=e||
110,H.screen_height=f||65,H.screen_lense=50,H.ipd=64,H.baseline=32):(H.first_distortion="first_distortion"in c?parseFloat(c.first_distortion):.34,H.second_distortion="second_distortion"in c?parseFloat(c.second_distortion):.55,H.bevel_size="bevel_size"in c?parseFloat(c.bevel_size):g||4,H.screen_width="screen_width"in c?parseFloat(c.screen_width):e||110,H.screen_height="screen_height"in c?parseFloat(c.screen_height):f||65,H.screen_lense="screen_lense"in c?parseFloat(c.screen_lense):50,H.ipd="ipd"in
c?parseFloat(c.ipd):64,H.baseline="baseline"in c?parseFloat(c.baseline):32);A=!0}function f(){r.set("hmd_conf",JSON.stringify(H),"b4w");c()}function t(){if(A){var a=d.get_device_by_type_element(d.DEVICE_HMD);a&&(d.set_config(a,d.HMD_DISTORTION,[H.first_distortion,H.second_distortion]),d.get_value_param(a,d.HMD_WEBVR_TYPE)!=d.HMD_WEBVR_DESKTOP&&(d.set_config(a,d.HMD_BEVEL_SIZE,.001*H.bevel_size),d.set_config(a,d.HMD_SCREEN_WIDTH,.001*H.screen_width),d.set_config(a,d.HMD_SCREEN_HEIGHT,.001*H.screen_height),
d.set_config(a,d.HMD_SCREEN_LENSE_DIST,.001*H.screen_lense),d.set_config(a,d.HMD_EYE_DISTANCE,.001*H.ipd),d.set_config(a,d.HMD_BASELINE_DIST,.001*H.baseline)));A=!1}}function g(a){var b=a.target.id.split("_"),b=b.splice(0,b.length-1).join("_");b in H&&H[b]!=a.target.value&&(A=!0,H[b]=a.target.value,document.getElementById(b+"_slider").value=a.target.value,document.getElementById(b+"_number").value=a.target.value)}function m(a,b){var c=document.createElement("button");c.onclick=a;c.style.cssText="display: inline-block;";
c.innerHTML=b;return c}q("config");var v=q("container"),x=q("controls"),d=q("input"),k=q("print");q("scenes");var r=q("storage"),C=q("util"),B=!1,F=null,D=null,y=null,A=!0,H={profile:"custom",first_distortion:0,second_distortion:0,bevel_size:0,screen_width:0,screen_height:0,screen_lense:0,ipd:0,baseline:0},w=/iPad|iPhone|iPod/.test(navigator.platform),h={oculus_dk2:{name:"Oculus Rift DK2",type:2,first_distortion:.22,second_distortion:.28},cardboard_1:{name:"Cardboard (2014)",type:1,ipd:60,baseline:35,
screen_lense:42,first_distortion:.441,second_distortion:.156},cardboard_2:{name:"Cardboard (2015)",type:1,ipd:64,baseline:35,screen_lense:39,first_distortion:.34,second_distortion:.55},custom:{name:"Custom",type:0,ipd:64,baseline:35,screen_lense:39,first_distortion:0,second_distortion:0}},u=[{label:"Tray to lens-center distance.",Rl:!0,K:[{id:"baseline",max:"50",step:"0.5"}]},{label:"Interpupillary distance.",Rl:!0,K:[{id:"ipd",max:"100",step:"1"}]},{label:"Screen to lense distance.",Rl:!0,K:[{id:"screen_lense",
max:"100",step:"1"}]},{label:"Screen height.",Rl:!0,K:[{id:"screen_height",max:"150",step:"1"}]},{label:"Screen width.",Rl:!0,K:[{id:"screen_width",max:"200",step:"1"}]},{label:"Bevel width.",Rl:!0,K:[{id:"bevel_size",max:"20",step:"1"}]},{label:"Distortion coefficients.",K:[{id:"first_distortion",max:"1.0",step:"0.01"},{id:"second_distortion",max:"1.0",step:"0.01"}]}];a.check=function(){return d.can_use_device(d.DEVICE_HMD)};a.show=function(a){D=document.createElement("style");D.innerHTML="html{-webkit-tap-highlight-color:rgba(0,0,0,0);}input[type=range]:focus{outline:0}input[type=range]::-webkit-slider-runnable-track{width:100%;height:8.4px;cursor:pointer;box-shadow:0 0 10px 0 rgba(50,50,50,1);background:#000;border-radius:1.3px;border:.2px solid #010101}input[type=range]::-webkit-slider-thumb{box-shadow:0 0 10px 0 rgba(50,50,50,1);border:1px solid #000;height:36px;width:16px;border-radius:3px;background:#fff;cursor:pointer;-webkit-appearance:none;margin-top:-14px}input[type=range]:focus::-webkit-slider-runnable-track{background:#000}input[type=range]::-moz-range-track{width:100%;height:8.4px;cursor:pointer;box-shadow:0 0 10px 0 rgba(50,50,50,1);background:#000;border-radius:1.3px;border:.2px solid #010101}input[type=range]::-moz-range-thumb{box-shadow:0 0 10px 0 rgba(50,50,50,1);border:1px solid #000;height:36px;width:16px;border-radius:3px;background:#fff;cursor:pointer}input[type=range]::-ms-track{width:100%;height:8.4px;cursor:pointer;background:0 0;border-color:transparent;color:transparent}input[type=range]::-ms-fill-lower{background:#000;border:.2px solid #010101;border-radius:2.6px;box-shadow:0 0 10px 0 rgba(50,50,50,1)}input[type=range]::-ms-fill-upper{background:#000;border:.2px solid #010101;border-radius:2.6px;box-shadow:0 0 10px 0 rgba(50,50,50,1)}input[type=range]::-ms-thumb{box-shadow:0 0 10px 0 rgba(50,50,50,1);border:1px solid #000;height:36px;width:16px;border-radius:3px;background:#fff;cursor:pointer}.text_label,.value_label{display:inline-block;text-decoration:none;height:30px;line-height:28px;position:relative;text-align:center;font-family:Arial;font-size:15px}input[type=range]:focus::-ms-fill-lower{background:#000}input[type=range]:focus::-ms-fill-upper{background:#000}.text_label{float:left;color:#fff;width:auto;padding:0 10px;background-color:#000;border:3px solid #fff;border-radius:15px;box-shadow:0 0 10px 0 rgba(50,50,50,1);margin-right:15px}.input_text,.value_label{border:3px solid #fff;background-color:#000;color:#fff;box-shadow:0 0 10px 0 rgba(50,50,50,1)}.value_label{right:0;width:40px;border-radius:15px;margin-left:15px}.slider{position:relative;cursor:pointer}.border{position:relative;width:100%;height:50px}.input_slider,.input_text{margin:13.8px 0;-webkit-appearance:none;width:50%;position:relative;display:inline-block}.input_text{border-radius:4px;padding-left:4px}.input_slider,_:-moz-tree-row(hover){-webkit-appearance:none;width:50%;margin:-4.8px 0;position:relative;display:inline-block}:root .input_slider,_:-ms-fullscreen{-webkit-appearance:none;width:50%;margin:-2.8px 0;position:relative;display:inline-block}button,select{display:block}button{background-color:#000;color:#fff;width:100px;border:3px solid #fff;text-align:center;font-family:Arial;border-radius:15px;box-shadow:0 0 10px 0 rgba(50,50,50,1);font-size:15px;line-height:30px;margin-right:10px}select{clear:both}";
document.head.appendChild(D);var k=d.get_device_by_type_element(d.DEVICE_HMD);if(!B&&k){B=!0;n();var l=v.get_container(),q=d.get_device_by_type_element(d.DEVICE_MOUSE,l);d.switch_prevent_default(q,!1);q=d.get_device_by_type_element(d.DEVICE_TOUCH,l);d.switch_prevent_default(q,!1);F=document.createElement("div");F.mQ=a;l.appendChild(F);y=document.createElement("div");F.appendChild(y);y.style.cssText="position: absolute;background-color: #fff;left: 10px;top: 10px;right: 10px;bottom: 10px;bottom: 10px;min-width: 300px;overflow: auto;padding: 10px;border: 1px solid #ddd;border-radius: 4px;bottom: 10px;";
a=r.get("hmd_conf","b4w");a=JSON.parse(a?a:"{}").profile||"custom";l=document.createElement("div");q=document.createElement("label");q.innerHTML="Profile: ";q.className="text_label";l.appendChild(q);q=document.createElement("select");l.appendChild(q);l.style.cssText="margin: 20px 0;padding: 10px;";var w=d.get_device_by_type_element(d.DEVICE_HMD);if(w)for(var A in h)if(0==h[A].type||d.get_value_param(w,d.HMD_WEBVR_TYPE)==d.HMD_WEBVR_DESKTOP^1==h[A].type){var G=document.createElement("option");G.value=
A;G.text=h[A].name;q.appendChild(G)}q.value=a;C.is_ie11()?q.onchange=e:q.oninput=e;y.appendChild(l);for(A=0;A<u.length;A++)if(d.get_value_param(k,d.HMD_WEBVR_TYPE)!=d.HMD_WEBVR_DESKTOP||!u[A].Rl){a=u[A];l=document.createElement("div");q=document.createElement("label");q.className="text_label";q.textContent=a.label;l.appendChild(q);l.style.cssText="margin: 20px 0;float: left;display: inline-block;width: 50%;border: 1px solid #ddd;box-sizing: border-box;-webkit-box-sizing: border-box;padding: 10px;";
for(q=0;q<a.K.length;q++){w=a.K[q];G=document.createElement("div");G.style.cssText+="clear: both; margin-bottom: 10px;";var J=document.createElement("input");J.className="input_slider";J.setAttribute("id",w.id+"_slider");J.setAttribute("type","range");J.setAttribute("min","0.00");J.setAttribute("step",w.step);J.setAttribute("value",H[w.id]);J.setAttribute("max",w.max);J.style.cssText="float: left;";G.appendChild(J);var P=document.createElement("input");P.className="input_text";P.setAttribute("id",
w.id+"_number");P.setAttribute("type","number");P.setAttribute("min","0.00");P.setAttribute("step",w.step);P.setAttribute("value",H[w.id]);P.setAttribute("max",w.max);G.appendChild(P);C.is_ie11()?(J.onchange=g,P.onchange=g):(J.oninput=g,P.oninput=g);l.appendChild(G)}y.appendChild(l)}k=document.createElement("div");A=m(f,"SAVE");a=m(c,"CANCEL");l=m(b,"RESET");k.style.clear="both";k.appendChild(A);k.appendChild(a);k.appendChild(l);y.appendChild(k);k=x.create_timeline_sensor();x.create_sensor_manifold(null,
"UPDATE_HMD_RENDERING",x.CT_CONTINUOUS,[k],null,t)}};a.hide=c;a.reset=b;a.update=function(){n();t()};var P={_comment:"AUTOMATICALLY GENERATED BY generate_dpdb.py. DO NOT EDIT.",format:1,last_updated:"2016-01-26T23:11:18Z",devices:[{type:"android",rules:[{mdmh:"asus/*/Nexus 7/*"},{ua:"Nexus 7"}],dpi:[320.8,323],bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_Z00AD/*"},{ua:"ASUS_Z00AD"}],dpi:[403,404.6],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"HTC/*/HTC6435LVW/*"},{ua:"HTC6435LVW"}],dpi:[449.7,
443.3],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"HTC/*/HTC One XL/*"},{ua:"HTC One XL"}],dpi:[315.3,314.6],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"htc/*/Nexus 9/*"},{ua:"Nexus 9"}],dpi:289,bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One M9/*"},{ua:"HTC One M9"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One_M8/*"},{ua:"HTC One_M8"}],dpi:[449.7,447.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One/*"},{ua:"HTC One"}],dpi:472.8,bw:3,ac:1E3},{type:"android",
rules:[{mdmh:"Huawei/*/Nexus 6P/*"},{ua:"Nexus 6P"}],dpi:[515.1,518],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5X/*"},{ua:"Nexus 5X"}],dpi:[422,419.9],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"LGE/*/LGMS345/*"},{ua:"LGMS345"}],dpi:[221.7,219.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D800/*"},{ua:"LG-D800"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D850/*"},{ua:"LG-D850"}],dpi:[537.9,541.9],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/VS985 4G/*"},
{ua:"VS985 4G"}],dpi:[537.9,535.6],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5/*"},{ua:"Nexus 5 B"}],dpi:[442.4,444.8],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 4/*"},{ua:"Nexus 4"}],dpi:[319.8,318.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"LGE/*/LG-P769/*"},{ua:"LG-P769"}],dpi:[240.6,247.5],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"LGE/*/LGMS323/*"},{ua:"LGMS323"}],dpi:[206.6,204.6],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"LGE/*/LGLS996/*"},{ua:"LGLS996"}],dpi:[403.4,
401.5],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Micromax/*/4560MMX/*"},{ua:"4560MMX"}],dpi:[240,219.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Micromax/*/A250/*"},{ua:"Micromax A250"}],dpi:[480,446.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Micromax/*/Micromax AQ4501/*"},{ua:"Micromax AQ4501"}],dpi:240,bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/DROID RAZR/*"},{ua:"DROID RAZR"}],dpi:[368.1,256.7],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"motorola/*/XT830C/*"},{ua:"XT830C"}],dpi:[254,
255.9],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"motorola/*/XT1021/*"},{ua:"XT1021"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1023/*"},{ua:"XT1023"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1028/*"},{ua:"XT1028"}],dpi:[326.6,327.6],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"motorola/*/XT1034/*"},{ua:"XT1034"}],dpi:[326.6,328.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1053/*"},{ua:"XT1053"}],dpi:[315.3,316.1],bw:3,ac:1E3},
{type:"android",rules:[{mdmh:"motorola/*/XT1562/*"},{ua:"XT1562"}],dpi:[403.4,402.7],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"motorola/*/Nexus 6/*"},{ua:"Nexus 6 B"}],dpi:[494.3,489.7],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"motorola/*/XT1063/*"},{ua:"XT1063"}],dpi:[295,296.6],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"motorola/*/XT1064/*"},{ua:"XT1064"}],dpi:[295,295.6],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1092/*"},{ua:"XT1092"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",
rules:[{mdmh:"motorola/*/XT1095/*"},{ua:"XT1095"}],dpi:[422,423.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"OnePlus/*/A0001/*"},{ua:"A0001"}],dpi:[403.4,401],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1005/*"},{ua:"ONE E1005"}],dpi:[442.4,441.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2005/*"},{ua:"ONE A2005"}],dpi:[391.9,405.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"OPPO/*/X909/*"},{ua:"X909"}],dpi:[442.4,444.1],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9082/*"},
{ua:"GT-I9082"}],dpi:[184.7,185.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-G360P/*"},{ua:"SM-G360P"}],dpi:[196.7,205.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/Nexus S/*"},{ua:"Nexus S"}],dpi:[234.5,229.8],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[304.8,303.9],bw:5,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-T230NU/*"},{ua:"SM-T230NU"}],dpi:216,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SGH-T399/*"},{ua:"SGH-T399"}],
dpi:[217.7,231.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-N9005/*"},{ua:"SM-N9005"}],dpi:[386.4,387],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SM-N900A/*"},{ua:"SAMSUNG-SM-N900A"}],dpi:[386.4,387.7],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9500/*"},{ua:"GT-I9500"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/GT-I9505/*"},{ua:"GT-I9505"}],dpi:439.4,bw:4,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900F/*"},{ua:"SM-G900F"}],
dpi:[415.6,431.6],bw:5,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900M/*"},{ua:"SM-G900M"}],dpi:[415.6,431.6],bw:5,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-G800F/*"},{ua:"SM-G800F"}],dpi:326.8,bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-G906S/*"},{ua:"SM-G906S"}],dpi:[562.7,572.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[306.7,304.8],bw:5,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-T535/*"},{ua:"SM-T535"}],dpi:[142.6,
136.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-N920C/*"},{ua:"SM-N920C"}],dpi:[515.1,518.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300I/*"},{ua:"GT-I9300I"}],dpi:[304.8,305.8],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9195/*"},{ua:"GT-I9195"}],dpi:[249.4,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SPH-L520/*"},{ua:"SPH-L520"}],dpi:[249.4,255.9],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SGH-I717/*"},{ua:"SAMSUNG-SGH-I717"}],
dpi:285.8,bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SPH-D710/*"},{ua:"SPH-D710"}],dpi:[217.7,204.2],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/GT-N7100/*"},{ua:"GT-N7100"}],dpi:265.1,bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SCH-I605/*"},{ua:"SCH-I605"}],dpi:265.1,bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/Galaxy Nexus/*"},{ua:"Galaxy Nexus"}],dpi:[315.3,314.2],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910H/*"},{ua:"SM-N910H"}],dpi:[515.1,518],
bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910C/*"},{ua:"SM-N910C"}],dpi:[515.2,520.2],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G130M/*"},{ua:"SM-G130M"}],dpi:[165.9,164.8],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G928I/*"},{ua:"SM-G928I"}],dpi:[515.1,518.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-G920F/*"},{ua:"SM-G920F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G920P/*"},{ua:"SM-G920P"}],dpi:[522.5,577],bw:3,ac:1E3},
{type:"android",rules:[{mdmh:"samsung/*/SM-G925F/*"},{ua:"SM-G925F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G925V/*"},{ua:"SM-G925V"}],dpi:[522.5,576.6],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Sony/*/C6903/*"},{ua:"C6903"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"Sony/*/D6653/*"},{ua:"D6653"}],dpi:[428.6,427.6],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Sony/*/E6653/*"},{ua:"E6653"}],dpi:[428.6,425.7],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Sony/*/E6853/*"},
{ua:"E6853"}],dpi:[403.4,401.9],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Sony/*/SGP321/*"},{ua:"SGP321"}],dpi:[224.7,224.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"TCT/*/ALCATEL ONE TOUCH Fierce/*"},{ua:"ALCATEL ONE TOUCH Fierce"}],dpi:[240,247.5],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"THL/*/thl 5000/*"},{ua:"thl 5000"}],dpi:[480,443.3],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"ZTE/*/ZTE Blade L2/*"},{ua:"ZTE Blade L2"}],dpi:240,bw:3,ac:500},{type:"ios",rules:[{res:[640,960]}],dpi:[325.1,
328.4],bw:4,ac:1E3},{type:"ios",rules:[{res:[640,1136]}],dpi:[317.1,320.2],bw:3,ac:1E3},{type:"ios",rules:[{res:[750,1334]}],dpi:326.4,bw:4,ac:1E3},{type:"ios",rules:[{res:[1242,2208]}],dpi:[453.6,458.4],bw:4,ac:1E3},{type:"ios",rules:[{res:[1125,2001]}],dpi:[410.9,415.4],bw:4,ac:1E3}]}};b4w.module.hmd=function(a,q){function e(a,e){if(e){var q=t.get_active_camera();if(q){c.is_eye_camera(q)||(k=c.is_target_camera(q),r=c.is_hover_camera(q),C=c.is_static_camera(q),c.eye_setup(q));var q=b.create_elapsed_sensor(),P=!1;b.create_sensor_manifold(null,"HMD_ROTATE_CAMERA",b.CT_CONTINUOUS,[q,e],null,function(e,h,k){if(0<k&&(k=t.get_active_camera())&&(!P&&n.enable_split_screen(k)&&(x=g.get_rotation(k,x),P=!0),P&&c.is_eye_camera(k)&&(e=b.get_sensor_payload(e,h,1))))if(1==a){var q=v.transformQuat(m.AXIS_MY,
e,B);c.set_vertical_axis(k,q);g.set_rotation_v(k,e)}else if(2==a||3==a){h=g.get_rotation(k,A);h=f.invert(h,A);var r=f.multiply(x,h,A);h=c.get_vertical_axis(k,B);Math.abs(h[2])<Math.PI/4?q=v.cross(h,m.AXIS_MY,F):Math.abs(h[1])<Math.PI/4&&(q=v.cross(h,m.AXIS_Z,F));v.normalize(q,q);var r=v.transformQuat(q,r,D),u=v.dot(h,r),r=v.scaleAndAdd(r,h,-u,D);v.normalize(r,r);h=v.cross(h,q,B);q=Math.acos(m.clamp(v.dot(q,r),0,1));h=m.sign(v.dot(r,h));d+=q*h;q=f.setAxisAngle(m.AXIS_Z,-d,A);3!=a&&(h=m.quat_project(e,
m.AXIS_MZ,m.AXIS_Z,m.AXIS_Y,H),h=f.invert(h,H),e=f.multiply(h,e,H));e=f.multiply(q,e,y);q=v.transformQuat(m.AXIS_MY,e,B);c.set_vertical_axis(k,q);g.set_rotation_v(k,e);f.copy(e,x)}})}}}var c=q("camera"),b=q("controls"),n=q("input"),f=q("quat"),t=q("scenes"),g=q("transform"),m=q("util"),v=q("vec3"),x=f.create(),d=0,k=!1,r=!1,C=!1,B=v.create(),F=v.create(),D=v.create(),y=f.create(),A=f.create(),H=f.create();a.HMD_NONE_MOUSE_ALL_AXES=0;a.HMD_ALL_AXES_MOUSE_NONE=1;a.HMD_ROLL_PITCH_MOUSE_YAW=2;a.HMD_ALL_AXES_MOUSE_YAW=
3;a.enable_hmd=function(a){var c=null;if(c=n.get_device_by_type_element(n.DEVICE_HMD))c=n.get_value_param(c,n.HMD_WEBVR_TYPE)==n.HMD_WEBVR_DESKTOP||n.get_value_param(c,n.HMD_WEBVR_TYPE)==n.HMD_WEBVR1?b.create_hmd_quat_sensor():b.create_gyro_quat_sensor(),e(a,c)};a.check_browser_support=function(){return Boolean(n.can_use_device(n.DEVICE_HMD))};a.get_hmd_device=function(){return null};a.reset=function(){n.reset_device(n.DEVICE_HMD)};a.disable_hmd=function(){b.remove_sensor_manifold(null,"HMD_ROTATE_CAMERA");
n.disable_split_screen();var a=t.get_active_camera();k?c.target_setup(a):r?c.hover_setup(a):C&&c.static_setup(a);c.set_vertical_axis(a,m.AXIS_Z);var d=g.get_rotation(a,y);g.set_rotation_v(a,d)}};b4w.module.mixer=function(a,q){function e(){D=F.length=0;y=c();A=new Float32Array(y.length);H=new Float32Array(y.length);var a=r.get_speaker_objects();if(a.length){F.push(b());for(var d=0;d<a.length;d++)F.push(f(a[d]));F.sort(function(a,b){return"MASTER"==a.id?-1:"MASTER"==b.id?1:"COMPRESSOR"==a.id?-1:"COMPRESSOR"==b.id?1:a.id.toUpperCase()<b.id.toUpperCase()?-1:a.id.toUpperCase()>b.id.toUpperCase()?1:0})}}function c(){for(var a=new Float32Array(100),b=0,c=0;100>c;c++)a[c]=20*Math.pow(1E3,b),b+=1/
99;return a}function b(){var a=n("MASTER"),b=r.get_compressor_params();b&&(a.V.push(["THRESHOLD",b.threshold,-100,0,100,!1]),a.V.push(["KNEE",b.knee,0,40,40,!1]),a.V.push(["RATIO",b.ratio,1,20,20,!1]),a.V.push(["ATTACK",b.attack,0,1,1E3,!1]),a.V.push(["RELEASE",b.release,0,1,1E3,!1]));a.V.push(["VOLUME",r.get_volume(null),0,1,50,!1]);a.mute=r.is_muted(null)?1:0;a.yf=-1;return a}function n(a){return{id:a,V:[],uj:0,mute:-1,yf:-1,Cb:null}}function f(a){var b=n(k.get_object_name(a));b.mute=r.is_muted(a)?
1:0;b.yf=0;b.Cb=a;return b}function t(a){if(a.Cb){a.V.length=0;var b=r.get_positional_params(a.Cb);b&&(a.V.push(["DIST_REF",b.dist_ref,0,1E3,1E4,!1]),a.V.push(["ATTENUATION",b.attenuation,0,50,1E3,!1]),a.V.push(["DIST_MAX",b.dist_max,0,1E4,1E4,!1]));if(b=r.get_filter_params(a.Cb))a.V.push(["EQ_FREQ",b.freq,20,2E4,100,!0]),a.V.push(["EQ_Q",b.Q,0,10,100,!1]),a.V.push(["EQ_GAIN",b.gain,-70,30,100,!1]);a.V.push(["VOLUME",r.get_volume(a.Cb),0,1,50,!1]);C.clamp(a.uj,0,a.V.length-1)}}function g(a){for(var b=
0;b<F.length;b++){var c=F[b];if(c!=a&&1==c.yf)return!0}return!1}function m(a){for(var b=0;b<F.length;b++){var c=F[b];c!=a&&0==c.mute&&0==c.yf&&r.mute(c.Cb,!1)}}function v(){if(0==F.length)return[0,-1];var a=8*Math.floor(D/8),b=a+7,a=C.clamp(a,0,F.length-1),b=C.clamp(b,0,F.length-1);return[a,b]}var x=q("controls"),d=q("hud"),k=q("scenes"),r=q("sfx"),C=q("util"),B="SWITCH_STRIP SWITCH_STRIP_HOLD SWITCH_PARAM INC_DEC INC_DEC_HOLD MUTE_SOLO".split(" "),F=[],D=0,y=null,A=null,H=null;a.enable_mixer_controls=
function(){function a(b,c,d){if(1==d){var e=Boolean(x.get_sensor_value(b,c,0))?-1:1,f=F[D];if(f)switch(d=f.V[f.uj],d[1]=d[5]?d[1]*Math.pow(d[3]/d[2],e/d[4]):d[1]+(d[3]-d[2])/d[4]*e,d[1]=C.clamp(d[1],d[2],d[3]),d[0]){case "VOLUME":"MASTER"!=f.id?r.set_volume(f.Cb,d[1]):r.set_volume(null,d[1]);break;case "DIST_REF":e=r.get_positional_params(f.Cb);e.dist_ref=d[1];r.set_positional_params(f.Cb,e);break;case "ATTENUATION":e=r.get_positional_params(f.Cb);e.attenuation=d[1];r.set_positional_params(f.Cb,e);
break;case "DIST_MAX":e=r.get_positional_params(f.Cb);e.dist_max=d[1];r.set_positional_params(f.Cb,e);break;case "EQ_FREQ":e=r.get_filter_params(f.Cb);e.freq=d[1];r.set_filter_params(f.Cb,e);break;case "EQ_Q":e=r.get_filter_params(f.Cb);e.Q=d[1];r.set_filter_params(f.Cb,e);break;case "EQ_GAIN":e=r.get_filter_params(f.Cb);e.gain=d[1];r.set_filter_params(f.Cb,e);break;case "THRESHOLD":f=r.get_compressor_params();f.threshold=d[1];r.set_compressor_params(f);break;case "KNEE":f=r.get_compressor_params();
f.knee=d[1];r.set_compressor_params(f);break;case "RATIO":f=r.get_compressor_params();f.ratio=d[1];r.set_compressor_params(f);break;case "ATTACK":f=r.get_compressor_params();f.attack=d[1];r.set_compressor_params(f);break;case "RELEASE":f=r.get_compressor_params();f.release=d[1];r.set_compressor_params(f);break;default:C.r("Unknown strip param")}"INC_DEC"==c?x.reset_timer_sensor(b,c,2,.35):x.reset_timer_sensor(b,c,2,.05)}else x.reset_timer_sensor(b,c,2,10)}function b(a,c,d){if(1==d){d=Boolean(x.get_sensor_value(a,
c,0))?-1:1;if(F.length){1==d&&D<F.length-1?D++:-1==d&&0<D&&D--;d=v();for(var e=d[0];e<=d[1];e++)t(F[e])}"SWITCH_STRIP"==c?x.reset_timer_sensor(a,c,2,.15+.3):x.reset_timer_sensor(a,c,2,.15)}else x.reset_timer_sensor(a,c,2,10)}e();var c=x.create_keyboard_sensor(x.KEY_NUM4),f=x.create_keyboard_sensor(x.KEY_NUM6),k=x.create_keyboard_sensor(x.KEY_NUM8),n=x.create_keyboard_sensor(x.KEY_NUM2),l=x.create_keyboard_sensor(x.KEY_ADD),q=x.create_keyboard_sensor(x.KEY_SUB),B=x.create_keyboard_sensor(x.KEY_NUM7),
W=x.create_keyboard_sensor(x.KEY_NUM9),G=x.create_timer_sensor(.15,!0),J=x.create_timer_sensor(.05,!0),c=[c,f,G];x.create_sensor_manifold(null,"SWITCH_STRIP",x.CT_TRIGGER,c,function(a){return a[0]||a[1]},b);x.create_sensor_manifold(null,"SWITCH_STRIP_HOLD",x.CT_SHOT,c,function(a){return(a[0]||a[1])&&a[2]},b);x.create_sensor_manifold(null,"SWITCH_PARAM",x.CT_SHOT,[k,n],function(a){return a[0]||a[1]},function(a,b){var c=Boolean(x.get_sensor_value(a,b,0))?-1:1,d=F[D];d&&(1==c&&d.uj<d.V.length-1?d.uj++:
-1==c&&0<d.uj&&d.uj--)});k=[q,l,J];x.create_sensor_manifold(null,"INC_DEC",x.CT_TRIGGER,k,function(a){return a[0]||a[1]},a);x.create_sensor_manifold(null,"INC_DEC_HOLD",x.CT_SHOT,k,function(a){return(a[0]||a[1])&&a[2]},a);x.create_sensor_manifold(null,"MUTE_SOLO",x.CT_SHOT,[B,W],function(a){return a[0]||a[1]},function(a,b){if(Boolean(x.get_sensor_value(a,b,0))){var c=F[D];c&&0<=c.mute&&("MASTER"!=c.id?0==c.mute?(c.mute=1,r.mute(c.Cb,!0),1==c.yf&&(c.yf=0,g(c)||m(c))):(c.mute=0,g(c)||r.mute(c.Cb,!1)):
0==c.mute?(c.mute=1,r.mute(null,!0)):(c.mute=0,r.mute(null,!1)))}else if((c=F[D])&&0<=c.yf)if(0==c.yf){c.yf=1;r.mute(c.Cb,!1);1==c.mute&&(c.mute=0);for(var d=0;d<F.length;d++){var e=F[d];e!=c&&0==e.mute&&0==e.yf&&r.mute(e.Cb,!0)}}else c.yf=0,g(c)?r.mute(c.Cb,!0):m(c)});B=x.create_elapsed_sensor();x.create_sensor_manifold(null,"MIXER_DRAW",x.CT_CONTINUOUS,[B],null,function(){if(F[D])for(var a=v(),b=a[0];b<=a[1];b++){var c=F[b];d.draw_mixer_strip(c.id,b==D,b%8,c.V,c.uj,c.mute,c.yf);if(c.Cb&&r.get_filter_params(c.Cb)){r.get_filter_freq_response(c.Cb,
y,A,H);for(c=0;c<A.length;c++)A[c]=20*Math.log(A[c])/Math.LN10;d.plot_array("EQ",b%8,A,20,2E4,-10,10)}}});B=x.create_timer_sensor(1,!0);x.create_sensor_manifold(null,"MIXER_UPDATE",x.CT_TRIGGER,[B],null,function(){for(var a=v(),b=a[0];b<=a[1];b++)t(F[b])})};a.disable_mixer_controls=function(){for(var a=0;B.length;a++)x.remove_sensor_manifold(null,B[a])}};b4w.module.npc_ai=function(a,q){function e(a,b){var c=b.destination,d=F;k.get_translation(b.empty,d);var e=D;k.get_translation(b.collider,e);var f=0;b.Rm?f=b.Rm:b.Wh&&(f=b.Wh,b.type==u&&(f*=.5),b.type==p&&(f*=a));switch(b.type){case u:if(b.random&&b.Vi){c[0]=(12*Math.random()-6)*b.speed+d[0];c[1]=-(12*Math.random()-6)*b.speed+d[1];var m=w,d=y,n=b.speed,q=b.rot_speed;k.get_rotation(b.collider,m);C.transformQuat(r.AXIS_MY,m,d);d[2]=0;C.normalize(d,d);m=.5*n/Math.sin(q/2);n=C.dist(c,e);n<2*m&&C.scaleAndAdd(c,
d,2*m-n,c);b.Vi=!1}c[2]=e[2];f&&(c[2]+=f);break;case P:case p:b.random&&b.Vi&&(b.type==p?(b.speed=Math.random()+.1,m=b.uL-b.AL):m=b.max_height-b.min_height,c[0]=10*Math.random()-5+d[0],c[2]=e[2]-(Math.random()*m-.5*m),c[1]=10*Math.random()-5+d[1],b.Vi=!1),f&&(c[2]=e[2]+f)}var c=F,d=D,n=y,e=h,x=b.rig,m=b.collider,f=b.destination,B=b.speed,ga=b.actions,R=g.get_current_anim_name(x);if(!g.is_play(x)||!ga.so||-1==ga.so.indexOf(R)){k.get_translation(m,c);var q=f[0]-c[0],ca=f[1]-c[1],q=Math.sqrt(q*q+ca*
ca);if(q>2*B*a)b.state=20,r.horizontal_direction(f,c,n),ga=b.rig,g.is_animated(ga)&&(x=b.speed,B=g.get_frame(ga),ga=g.get_anim_length(ga),x*=ga/24*(1-B/ga),.9>q/x&&C.scaleAndAdd(f,n,x-q,f)),q=w,x=A,k.get_rotation(b.collider,q),C.transformQuat(r.AXIS_MY,q,d),x[0]=d[0],x[1]=d[1],x[2]=0,C.normalize(x,x),B=C.dot(x,n),ga=a/(Math.abs(Math.acos(B))/Math.PI)*b.rot_speed*b.lw,v.rotationTo(x,n,e),v.rotationTo(r.AXIS_MY,x,q),1<=Math.abs(B)?v.copy(q,e):(v.multiply(e,q,e),v.slerp(q,e,Math.min(ga,1),e)),n=a,b.type!=
P&&(n=Math.max(n,1/60),q=H,x=w,v.setAxisAngle(r.AXIS_X,-Math.asin(-d[2]),x),v.setAxisAngle(r.AXIS_X,-Math.atan(b.Wh/(b.speed*n)),q),v.slerp(x,q,n,q),v.multiply(e,q,e)),k.set_rotation_v(m,e),d=y,m=A,r.quat_to_dir(e,r.AXIS_MY,d),C.scale(d,b.speed*a,m),C.add(m,c,m),m[2]=b.type!=u?(f[2]-c[2])*a*.1+c[2]:f[2],k.set_translation_v(b.collider,m);else if(b.type==u)ga.move?R&&-1!=ga.move.indexOf(R)&&g.is_play(x)?b.state=20:(b.state=10,b.Vi=!0):(b.state=10,b.Vi=!0);else if(b.type==p||b.type==P)b.Vi=!0;if(t(b)&&
(c=b.rig,!g.is_play(c))){e=null;switch(b.state){case 10:e=b.actions;e=e.so?r.random_from_array(e.so):null;break;case 20:e=g.get_current_anim_name(b.rig),d=f=b.actions,d.Bh&&-1==d.Bh.indexOf(e)&&d.move&&-1!=d.move.indexOf(e)&&.33<Math.random()?(f=b.actions,e=f.Bh[f.move.indexOf(e)]):(d=b.actions,d.move&&(-1!=d.move.indexOf(e)||!d.Bh&&!d.Gi||!d.Gi&&!e||d.Bh&&-1!=d.Bh.indexOf(e)||d.Gi&&-1!=d.Gi.indexOf(e))?(f=b.actions,f.Bh?(d=f.Bh.indexOf(e),-1!=d?(e=d+1,e=e<f.move.length?e:0,e=f.move[e]):e=-1!=f.move.indexOf(e)?
e:r.random_from_array(f.move)):e=r.random_from_array(f.move)):(d=b.actions,e=d.Gi&&-1==d.Gi.indexOf(e)&&d.move&&-1==d.move.indexOf(e)?r.random_from_array(f.Gi):null))}e&&(g.apply(c,e),g.set_behavior(c,g.AB_FINISH_RESET),g.set_frame(c,0),g.play(c))}}}function c(a,b,c,d){if(d)if(1==c)switch(d.type){case P:a:{for(c=0;3>c;c++){var e=m.get_sensor_payload(a,b,c).hit_fract;if(e){b=e;break a}}b=void 0}a=100*b;d.Wh=a<d.min_height?10:a>d.max_height?-10:0;break;case u:a=m.get_sensor_payload(a,b,0).hit_fract;
d.Wh=d.wB==a?0:1-100*a;d.wB=a;break;case p:a=m.get_sensor_payload(a,b,0).hit_fract,"CLOSE_GROUND"==b?(d.Wh=100*a-1,d.Wh=.1>d.Wh?.05:0):"CLOSE_WATER"==b&&(d.Rm=100*a,d.Rm=d.Rm<d.AL?-.02:d.Rm>d.uL?.02:0)}else d.Wh=0}function b(){for(var a=0;a<B.length;a++){var b=B[a];n(b);f(b);b.rig&&g.get_current_anim_name(b.rig)&&g.play(b.rig)}}function n(a){var b=C.create(),d=a.collider;switch(a.type){case P:var e=m.create_ray_sensor(d,b,[0,0,-100],"TERRAIN",!0),f=m.create_ray_sensor(d,b,[0,0,-100],"STONE",!0),b=
m.create_ray_sensor(d,b,[0,0,-100],"WATER",!0),e=[e,f,b];m.create_sensor_manifold(d,"CLOSE_GROUND",m.CT_CONTINUOUS,e,function(a){return a[0]||a[1]||a[2]},c,a);break;case u:e=m.create_ray_sensor(d,[0,0,1],[0,0,-99],"TERRAIN",!0);e=[e];m.create_sensor_manifold(d,"CLOSE_GROUND",m.CT_CONTINUOUS,e,null,c,a);break;case p:e=m.create_ray_sensor(d,[0,0,1],[0,0,-99],"TERRAIN",!0),b=m.create_ray_sensor(d,b,[0,0,100],"WATER",!0),e=[e],m.create_sensor_manifold(d,"CLOSE_WATER",m.CT_CONTINUOUS,[b],null,c,a),m.create_sensor_manifold(d,
"CLOSE_GROUND",m.CT_CONTINUOUS,e,null,c,a)}}function f(a){function b(c,d,e){1==e?(k.get_translation(a.empty,a.destination),a.lw=4):a.lw=1}var c=a.collider;if(a.type==u){var d=m.create_collision_sensor(c,"CONSTRUCTION",!1);m.create_sensor_manifold(c,"CONSTRUCTION_COLL",m.CT_CONTINUOUS,[d],null,b)}}function t(a){var b=a.rig;if(!g.is_play(b))return!0;b=g.get_current_anim_name(b);if(!b)return!0;var c=a.actions;switch(a.state){case 10:if(!c.so)return!1;if(-1==c.so.indexOf(b))break;break;case 20:if(!c.move||
-1!=c.move.indexOf(b)||c.Gi&&-1!=c.Gi.indexOf(b)||c.Bh&&-1!=c.Bh.indexOf(b))return!1;break;default:return!1}return!0}var g=q("animation"),m=q("controls"),v=q("quat"),x=q("scenes"),d=q("time"),k=q("transform"),r=q("util"),C=q("vec3"),B=[];new Float32Array(9);var F=new Float32Array(3),D=new Float32Array(3),y=new Float32Array(3),A=new Float32Array(3),H=new Float32Array(4),w=new Float32Array(4),h=new Float32Array(4),u=a.NT_WALKING=10,P=a.NT_FLYING=20,p=a.NT_SWIMMING=30;a.new_event_track=function(a){a.destination=
new Float32Array(3);a.start=[];a.ended=[];a.Jq=[];a.Wh=null;a.wB=null;a.Rm=null;a.Vi=!0;a.lw=1;if(!a.random)for(var b=0;b<a.path.length;b++)a.start[b]=-1,a.ended[b]=!1,a.Jq[b]=!1;B.push(a)};a.enable_animation=function(){if(B.length){b();var a=m.create_elapsed_sensor();m.create_sensor_manifold(B[0].collider,"ELAPSED",m.CT_CONTINUOUS,[a],function(a){return a[0]},function(a,b,c){if(1==c)for(a=m.get_sensor_value(a,b,0),b=0;b<B.length;b++){c=B[b];var f=a;if(x.is_visible(c.obj))if(c.random)e(f,c);else{for(var g=
d.get_timeline(),h=0;h<c.path.length;h++)if(!c.ended[h]){c.Jq[h]||(c.Jq[h]=!0,c.destination[0]=c.path[h][0],c.destination[1]=c.path[h][1],c.destination[2]=c.path[h][2],c.start[h]=g+c.delay[h]);if(g<c.start[h])break;e(f,c);c.ended[h]=c.Vi;break}a:{for(f=0;f<c.path.length;f++)if(0==c.ended[f]){f=!1;break a}f=!0}if(f)for(f=0;f<c.path.length;f++)c.Jq[f]=!1,c.ended[f]=!1}}})}};a.disable_animation=function(){if(!(0>=B.length))for(var a=0;a<B.length;a++){var b=B[a];m.check_sensor_manifolds(b.collider)&&
m.remove_sensor_manifold(b.collider);g.is_play(b.rig)&&g.stop(b.rig)}}};b4w.module.mouse=function(a,q){function e(){1==P&&(P=0);var a=document.exitPointerLock||document.webkitExitPointerLock||document.mozExitPointerLock;"function"===typeof a&&a.apply(document);d.remove_sensor_manifold(C.get_active_camera(),"SMOOTH_PL")}function c(a){2==P&&(P=0);a.removeEventListener("mousedown",n,!1);a.removeEventListener("mouseup",f,!1);a.removeEventListener("mousemove",b,!1);d.remove_sensor_manifold(C.get_active_camera(),"SMOOTH_DRAG")}function b(a){h()&&(H[0]+=2*(a.clientX-y),H[1]+=
2*(a.clientY-A),y=a.clientX,A=a.clientY);a.preventDefault()}function n(a){y=a.clientX;A=a.clientY;a.currentTarget.addEventListener("mousemove",b,!1);a.preventDefault()}function f(a){a.currentTarget.removeEventListener("mousemove",b,!1);a.preventDefault()}function t(a,b,c,e){if(.01<Math.abs(H[0])||.01<Math.abs(H[1]))b=d.get_sensor_value(a,b,0),a=B.smooth(H[0],0,b,.1*D),b=B.smooth(H[1],0,b,.1*D),H[0]-=a,H[1]-=b,e(4E-4*-a,4E-4*-b)}function g(a,b){var c=C.get_first_character(),d=C.get_active_camera();
v.eye_rotate(d,a,b);c&&(d=v.get_camera_angles_char(d,w),k.set_character_rotation(c,d[0],d[1]))}function m(a){a=x.client_to_canvas_coords(a.clientX,a.clientY,w);(a=C.pick_object(a[0],a[1]))?(C.outlining_is_enabled(a)&&C.set_outline_intensity(a,1),C.outlining_is_enabled(u)&&a!=u&&C.set_outline_intensity(u,0)):C.outlining_is_enabled(u)&&C.set_outline_intensity(u,0);u=a}var v=q("camera"),x=q("container"),d=q("controls"),k=q("physics"),r=q("print"),C=q("scenes"),B=q("util"),F=q("main"),D=1,y=0,A=0,H=new Float32Array(2),
w=new Float32Array(2),h=null,u=null,P=0;a.request_pointerlock=function(a,b,e,f,h,k){function m(){if(document.pointerLockElement===a||document.webkitPointerLockElement===a||document.mozPointerLockElement===a){c(a);a.addEventListener("mousemove",f,!1);var g=C.get_active_camera();if(!d.check_sensor_manifold(g,"SMOOTH_PL")){var h=d.create_elapsed_sensor();d.create_sensor_manifold(g,"SMOOTH_PL",d.CT_CONTINUOUS,[h],null,t,k)}b()}else a.removeEventListener("mousemove",f,!1),P=0,document.removeEventListener("pointerlockchange",
m,!1),document.removeEventListener("webkitpointerlockchange",m,!1),document.removeEventListener("mozpointerlockchange",m,!1),e()}if(1!=P){P=1;b=b||function(){};e=e||function(){};k=k||g;h=h||function(){return!0};f=f||function(a){if(h()){if("number"==typeof a.movementX){var b=a.movementX;a=a.movementY}else"number"==typeof a.webkitMovementX?(b=a.webkitMovementX,a=a.webkitMovementY):"number"==typeof a.mozMovementX?(b=a.mozMovementX,a=a.mozMovementY):a=b=0;H[0]+=b;H[1]+=a}};document.addEventListener("pointerlockchange",
m,!1);document.addEventListener("webkitpointerlockchange",m,!1);document.addEventListener("mozpointerlockchange",m,!1);var n=a.requestPointerLock||a.webkitRequestPointerLock||a.mozRequestPointerLock;"function"===typeof n?n.apply(a):r.error("Pointer lock is not available")}};a.exit_pointerlock=e;a.check_pointerlock=function(a){return"function"===typeof(a.requestPointerLock||a.webkitRequestPointerLock||a.mozRequestPointerLock)?!0:!1};a.request_mouse_drag=function(a,b,c){2!=P&&(P=2,e(),h=b||function(){return!0},
c=c||g,a.addEventListener("mousedown",n,!1),a.addEventListener("mouseup",f,!1),a=C.get_active_camera(),d.check_sensor_manifold(a,"SMOOTH_DRAG")||(b=d.create_elapsed_sensor(),d.create_sensor_manifold(a,"SMOOTH_DRAG",d.CT_CONTINUOUS,[b],null,t,c)))};a.exit_mouse_drag=c;a.enable_mouse_hover_outline=function(){F.detect_mobile()||x.get_canvas().addEventListener("mousemove",m)};a.disable_mouse_hover_outline=function(){F.detect_mobile()||(x.get_canvas().removeEventListener("mousemove",m),u&&C.set_outline_intensity(u,
0))};a.get_coords_x=function(a,b){var c=b?a.targetTouches:a.touches;return"clientX"in a?a.clientX:c&&"clientX"in c[0]?c[0].clientX:-1};a.get_coords_y=function(a,b){var c=b?a.targetTouches:a.touches;return"clientY"in a?a.clientY:c&&"clientY"in c[0]?c[0].clientY:-1};a.set_plock_smooth_factor=function(a){D=a};a.get_plock_smooth_factor=function(){return D}};b4w.module.preloader=function(a,q){var e=q("container"),c,b,n,f,t,g,m,v,x=null;a.create_preloader=function(a){var g="#000",m="#5276cf",q="#fff",t="#fff",v;for(v in a)switch(v){case "container_color":g=a.container_color;break;case "bar_color":m=a.bar_color;break;case "frame_color":q=a.frame_color;break;case "font_color":t=a.font_color}a=document.createElement("div");v=a.cloneNode();var x=a.cloneNode(),y=a.cloneNode(),A=e.get_container();x.appendChild(v);x.appendChild(y);a.appendChild(x);A.appendChild(a);
a.style.cssText="background-color: "+g+";width: 100%;height: 100%;position: absolute;top: 0;left: 0;";x.style.cssText="position: absolute;left: 50%;top: 50%;margin-left: -150px;margin-top: -30px;width: 300px;height: 28px;border: 2px solid "+q+";";v.style.cssText="position: absolute;width: 0%;top: 0;left: 0;background-color: "+m+";height: 100%;";y.style.cssText="font-family: Arial, sans-serif;line-height: 28px;height: 100%;width: 100%;top: 0;left: 0;text-align: center;position: absolute;font-size: 16px;color: "+
t+";";c=v;b=y;n=a;f="DEFAULT"};a.create_simple_preloader=function(a){var e=null,g=null,m="#bf9221",q="#000",v;for(v in a)switch(v){case "canvas_container_id":e=a.canvas_container_id;break;case "background_container_id":g=a.background_container_id;break;case "bg_color":q=a.bg_color;break;case "bar_color":m=a.bar_color}a=document.createElement("div");v=document.createElement("div");a.id="simple_preloader_container";var D=document.createElement("div"),y=document.createElement("div"),g=document.getElementById(g);
x=document.getElementById(e);a.style.cssText="z-index: 4;background-color: "+q+";width: 100%;height: 100%;position: absolute;margin: 0;padding: 0;top: 0;left: 0;";v.style.cssText="position: absolute;left: 50%;top: 82%;width: 300px;height: 20px;margin-left: -150px;margin-top: -10px;border-style:solid;border-width:4px;border-color: #000;border-radius: 0px;";D.style.cssText="position: absolute;left: 0px;top: 1px;width: 0px;height: 18px;background-color: "+m+";border-radius: 0px;";y.style.cssText="position: absolute;left: 50%;top: 50%;width: 100%;height: 100%;margin-left: -150px;margin-top: -10px;text-align: center;font-size: 17px;font-weight: bold;color: #000;font-family: Verdana;"+
v.appendChild(D);v.appendChild(y);a.appendChild(v);document.body.appendChild(a);f="SIMPLE";n=a;c=D;b=y;t=g};a.create_rotation_preloader=function(a){var c=null,e=null,m="rgba(0,0,0,0)",q="",v="",D="rgba(0,0,0,0)",y;for(y in a)switch(y){case "canvas_container_id":c=a.canvas_container_id;break;case "background_container_id":e=a.background_container_id;break;case "frame_bg_color":m=a.frame_bg_color;break;case "bg_color":D=a.bg_color;break;case "frame_class":q=a.frame_class;break;case "anim_elem_class":v=
a.anim_elem_class}a=document.createElement("div");y=document.createElement("div");var A=document.createElement("div"),H=document.createElement("div"),e=document.getElementById(e);x=document.getElementById(c);a.style.cssText="z-index: 4;background-color: "+D+";width: 100%;height: 100%;position: absolute;margin: 0;padding: 0;top: 0;left: 0;";y.style.cssText="position: absolute;left: 50%;top: 50%;width: 117px;height: 117px;margin-left: -58px;margin-top: -58px;background-color: "+m+";";A.style.cssText=
"position: absolute;left: 0px;top: 0px;width: 100%;height: 100%;background-position: center;background-repeat: no-repeat;";H.style.cssText="position: absolute;width: 100%;height: 100%;text-align: center;margin-top: 38px;font-size: 36px;color: #ffffff;font-family: Arial;font-weight: bold;";A.className=v;y.appendChild(A);y.className=q;y.appendChild(H);a.appendChild(y);x.appendChild(a);f="ROTATION";n=a;g=A;b=H;t=e};a.create_advanced_preloader=function(a){var e=a.preloader_width,e=e/(e-a.img_width),g=
document.getElementById(a.preloader_bar_id),q=document.getElementById(a.fill_band_id),B=document.getElementById(a.preloader_caption_id),F=document.getElementById(a.preloader_container_id),D=document.getElementById(a.background_container_id);x=document.getElementById(a.canvas_container_id);f="ADVANCED";c=g;m=q;v=e;b=B;n=F;t=D};a.update_preloader=function(a){b.innerHTML=a+"%";"SIMPLE"==f?c.style.width=a+"%":"ADVANCED"==f?(c.style.width=a/v+"%",m.style.width=100-a+"%"):"ROTATION"==f?g.style.transform=
"rotate("+a+"deg)":"DEFAULT"==f&&(c.style.width=a+"%");100==a&&(n.parentNode.removeChild(n),t&&t.parentNode.removeChild(t))}};b4w.module.storage=function(a,q){function e(a){return n[a?a:b]?JSON.parse(n[a?a:b]):{}}var c=q("__print"),b="b4w",n=null;a.init=function(a){a?"b4w"!==a?b=a:c.error("b4w prefix denied"):c.warn("Prefix should be a string. Last declared storage prefix will be used.")};a.set=function(a,c,f){var q=e(f);q[a]=String(c);n[f?f:b]=JSON.stringify(q)};a.cleanup=function(a){delete n[a?a:b]};a.get=function(a,b){var c=e(b);return c[a]?c[a]:""};a.debug=function(a){c.log(e(a?a:b))};try{n=window.localStorage;try{n.tmp=
null,delete n.tmp}catch(f){c.warn("localStorage quota is limited. Disabling localStorage"),n=null}}catch(t){c.warn("Applying chrome localStorage bug workaround"),n=null}n||(c.warn("localStorage is not available, initializing temporary storage"),n={})};b4w.module.screenshooter=function(a,q){var e=q("main");a.shot=function(){e.canvas_data_url(function(a){var b=window.document.createElement("a");document.body.appendChild(b);b.style.display="none";b.href=a;b.download="screenshot.png";b.click();document.body.removeChild(b)})}};
